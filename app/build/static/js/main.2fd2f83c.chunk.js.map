{"version":3,"sources":["client/styled/Colors.js","client/styled/icon/Arrow.js","client/styled/icon/ArrowSmall.js","client/styled/icon/Roll.js","client/styled/icon/X.js","client/styled/icon/Evade.js","client/styled/icon/Pivot.js","client/styled/icon/Cancel.js","client/styled/icon/CheckMark.js","client/styled/icon/Play.js","client/styled/icon/Pause.js","client/styled/icon/Replay.js","client/styled/IconAndLabel.js","client/styled/Container.js","client/styled/Text.js","client/styled/Title.js","client/styled/Clickable.js","client/styled/Error.js","client/styled/InputAndLabel.js","client/styled/Tooltip.js","client/styled/Button.js","client/styled/Link.js","model/gameConfig.mjs","model/hexagon/Offset.mjs","model/hexagon/Cube.mjs","model/hexagon/index.mjs","model/utils/HexagonMath.mjs","model/utils/math.mjs","model/utils/CoordinateConverter.mjs","model/utils/Vector.mjs","client/view/game/animation/Animation.js","client/view/game/animation/particle/BaseParticle.js","client/view/game/renderer/shader/effectVertexShader.js","client/view/game/renderer/shader/effectFragmentShader.js","client/view/game/renderer/shader/spriteFragmentShader.js","client/view/game/renderer/shader/spriteVertexShader.js","client/view/game/renderer/shader/line2dVertexShader.js","client/view/game/renderer/shader/line2dFragmentShader.js","client/view/game/animation/particle/ParticleEmitter.js","client/view/game/animation/particle/BoltParticleEmitter/BoltInstance.js","client/view/game/animation/particle/BoltParticleEmitter/BoltContainer.js","client/view/game/utils/objectLoader.js","client/view/game/animation/particle/BoltParticleEmitter/BoltInstanceFactory.js","client/view/game/renderer/shader/boltVertexShader.js","client/view/game/renderer/shader/boltFragmentShader.js","client/view/game/animation/particle/ParticleEmitterContainer.js","client/view/game/animation/particle/StarParticle.js","client/view/game/animation/particle/StarParticleEmitter.js","client/view/game/renderer/shader/starVertexShader.js","client/view/game/renderer/shader/starFragmentShader.js","client/view/game/terrain/StarField.js","client/view/home/HomeScene.js","client/view/home/HomeSceneComponent.js","client/config.js","client/api/user.js","client/api/game.js","model/User.mjs","client/state/actions.js","client/state/StoreProvider.js","client/view/login/Login.js","client/view/login/LoginFloater.js","client/view/home/Home.js","client/view/home/index.js","client/view/game/components/GameSceneComponent.js","model/movement/RequiredThrust.mjs","model/movement/MovementOrder.mjs","model/movement/MovementTypes.mjs","model/movement/MovementResolver.mjs","model/movement/ThrustBill.mjs","model/movement/ThrustAssignment.mjs","model/movement/MovementService.mjs","model/unit/ShipPower.mjs","model/unit/system/DamageEntry.mjs","model/unit/system/criticals/Critical.mjs","model/unit/system/criticals/OutputReduced.mjs","model/unit/system/criticals/OutputReduced2.mjs","model/unit/system/criticals/OutputReduced4.mjs","model/unit/system/criticals/OutputReduced6.mjs","model/unit/system/criticals/OutputReduced8.mjs","model/unit/system/criticals/LoadingTimeIncreased.mjs","model/unit/system/criticals/ForcedOffline.mjs","model/unit/system/criticals/ForcedOfflineOverheat.mjs","model/unit/system/criticals/ThrustChannelHeatIncreased.mjs","model/unit/system/SystemDamage.mjs","model/unit/system/PowerEntry.mjs","model/unit/system/SystemPower.mjs","model/unit/system/SystemHeat.mjs","model/unit/system/ShipSystemLog/ShipSystemLogEntry.mjs","model/utils/format.mjs","model/unit/system/ShipSystemLog/ShipSystemLogEntryHeat.mjs","model/unit/system/ShipSystemLog/ShipSystemLogEntryCriticalHit.mjs","model/unit/system/ShipSystemLog/ShipSystemLogEntryDamage.mjs","model/unit/system/ShipSystemLog/systemLogEntryClasses.mjs","model/unit/system/ShipSystemLog/ShipSystemLog.mjs","model/unit/system/ShipSystem.mjs","model/unit/system/strategy/ShipSystemStrategy.mjs","model/unit/system/cargo/CargoEntity.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo158.mjs","model/unit/system/strategy/weapon/utils/HitSystemRandomizer.mjs","model/combatLog/CombatLogDamageEntry.mjs","model/unit/system/strategy/weapon/StandardDamageStrategy.mjs","model/unit/system/weapon/ammunition/torpedo/torpedoDamageStrategy/MSVTorpedoDamageStrategy.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo158MSV.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo158MSV2.mjs","model/unit/system/weapon/ammunition/torpedo/torpedoDamageStrategy/HETorpedoDamageStrategy.mjs","model/unit/system/strategy/weapon/ExplosiveDamageStrategy.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo158Nuclear.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo72.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo72MSV.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo72HE.mjs","model/unit/system/weapon/ammunition/torpedo/Torpedo158HE.mjs","model/unit/system/weapon/ammunition/Ammo.mjs","model/unit/system/weapon/ammunition/conventional/Ammo30mm.mjs","model/unit/system/weapon/ammunition/conventional/Ammo85mmHE.mjs","model/unit/system/weapon/ammunition/conventional/Ammo85mmAP.mjs","model/unit/system/weapon/ammunition/conventional/Ammo140mmAP.mjs","model/unit/system/weapon/ammunition/conventional/Ammo140mmHE.mjs","model/unit/system/weapon/ammunition/conventional/Ammo120mmAP.mjs","model/unit/system/weapon/ammunition/conventional/Ammo120mmHE.mjs","model/unit/system/weapon/ammunition/NoAmmunitionLoaded.mjs","model/unit/system/weapon/ammunition/index.mjs","model/unit/system/cargo/cargo.mjs","model/unit/system/strategy/CargoBaySystemStrategy.mjs","model/unit/system/strategy/StoreHeatStrategy.mjs","model/unit/system/strategy/RadiateHeatStrategy.mjs","model/unit/system/structure/Structure.mjs","model/unit/system/systemSection/SystemSection.mjs","model/unit/system/systemSection/systemLocation.mjs","model/unit/system/systemSection/PrimarySection.mjs","model/unit/system/systemSection/AftSection.mjs","model/unit/system/systemSection/FrontSection.mjs","model/unit/system/systemSection/PortAftSection.mjs","model/unit/system/systemSection/PortFrontSection.mjs","model/unit/system/systemSection/StarboardFrontSection.mjs","model/unit/system/systemSection/StarboardAftSection.mjs","model/unit/system/ShipSystemSections.mjs","model/unit/ShipSystems.mjs","model/electronicWarfare/ElectronicWarfareEntry.mjs","model/electronicWarfare/electronicWarfareTypes.mjs","model/unit/ShipCurrentElectronicWarfare.mjs","model/unit/ShipElectronicWarfare.mjs","model/unit/ShipPlayer.mjs","model/unit/ShipMovement.mjs","model/unit/Ship.mjs","model/weapon/FireOrder.mjs","model/weapon/WeaponFireService.mjs","client/view/game/phase/PhaseState.js","client/view/game/renderer/sprite/LineSprite.js","client/view/game/renderer/sprite/Sprite.js","client/view/game/utils/graphics.js","client/view/game/utils/abstractCanvas.js","client/view/game/renderer/hexgrid/HexagonTexture.js","client/view/game/renderer/sprite/HexagonSprite.js","client/view/game/renderer/sprite/DottedCircleSprite.js","client/view/game/renderer/sprite/TextSprite.js","client/view/game/renderer/sprite/ShipMapSprite.js","client/view/game/renderer/Line.js","client/view/game/renderer/shader/lineVertexShader.js","client/view/game/renderer/shader/lineFragmentShader.js","client/view/game/renderer/object3d/Object3d.js","client/view/game/renderer/ships/ShipMapIcon.js","client/view/game/renderer/ships/ShipObject.js","client/view/game/renderer/ships/uc/Gunship.js","client/view/game/renderer/ships/uc/Rhino.js","client/view/game/renderer/ships/uc/Capital.js","client/view/game/renderer/ships/uc/Haka.js","client/view/game/renderer/ships/protectorate/Caliope.js","client/view/game/renderer/ships/protectorate/Fulcrum.js","client/view/game/renderer/ships/protectorate/Mouros.js","client/view/game/renderer/ships/federation/Impetous.js","client/view/game/renderer/icon/ShipIconContainer.js","client/view/game/renderer/electronicWarfare/OEWIndicator.js","client/view/game/renderer/electronicWarfare/ShipEWIndicators.js","client/view/game/renderer/electronicWarfare/CurrentOEWIndicator.js","client/view/game/renderer/electronicWarfare/ShipCurrentEWIndicators.js","client/view/game/renderer/electronicWarfare/ElectronicWarfareIndicatorService.js","client/view/game/renderer/TerrainRenderer.js","client/view/game/ui/shipWindow/ShipWindowManager.js","client/view/game/movement/MovementPath.js","client/view/game/movement/MovementPathService.js","client/view/game/phase/phaseStrategy/PhaseStrategy.js","client/view/game/phase/phaseStrategy/LobbyPhaseStrategy.js","client/view/game/ui/uiStrategy/UiStrategy.js","client/view/game/ui/uiStrategy/MouseOverShowsMovementPath.js","client/view/game/ui/uiStrategy/HighlightSelectedShip.js","client/view/game/ui/uiStrategy/movement/SelectedShipMovementUi.js","client/view/game/ui/uiStrategy/ShowDeploymentAreas.js","client/view/game/animation/ShipMovementAnimation/PivotSteps.js","client/view/game/animation/ShipMovementAnimation/index.js","client/view/game/animation/ShipMovementAnimation/ShipMovementAnimation.js","client/view/game/animation/ShipIdleMovementAnimation.js","client/view/game/animation/ShipSystemAnimation.js","client/view/game/animation/effect/BoltEffect.js","client/view/game/animation/effect/ExplosionEffect.js","client/view/game/animation/ShipWeaponAnimation/ShipWeaponAnimation.js","client/view/game/animation/ShipWeaponAnimation/index.js","client/view/game/animation/ShipWeaponAnimation/ShipWeaponBoltAnimation.js","client/view/game/animation/ShipWeaponAnimation/ShipWeaponBoltBurstAnimation.js","client/view/game/animation/ShipWeaponAnimation/ShipWeaponUniversalBoltAnimation.js","client/view/game/ui/uiStrategy/AnimationUiStrategy.js","client/view/game/ui/uiStrategy/ShowShipObjects.js","client/view/game/ui/uiStrategy/RightClickShowsShipWindow.js","client/view/game/ui/uiStrategy/MouseOverShowsShipTooltip.js","client/view/game/ui/uiStrategy/MouseOverHighlightsShip.js","client/view/game/ui/uiStrategy/deployment/SelectUndeployedShip.js","client/view/game/ui/uiStrategy/deployment/DeployShipOnHexClick.js","client/view/game/ui/uiStrategy/deployment/AllowSubmittingWhenDeploymentDone.js","client/view/game/ui/uiStrategy/deployment/SelectedShipDeploymentMovementUi.js","client/view/game/ui/uiStrategy/ShowWaitingStatus.js","client/view/game/ui/uiStrategy/SelectFirstActiveShip.js","client/view/game/ui/uiStrategy/AllShipsMovementPaths.js","client/view/game/ui/gameUiModes.js","client/view/game/ui/uiStrategy/AllowSubmittingOnValidGameState.js","client/view/game/ui/uiStrategy/replay/AutomaticReplay.js","client/view/game/ui/uiStrategy/replay/ShowReplayUi.js","client/view/game/ui/electronicWarfare/OEWButtons.js","client/view/game/ui/GamePositionComponent.js","client/view/game/ui/system/SystemInfoWeaponTargeting.js","client/view/game/ui/system/SystemStrategyUi/cargo/CargoTooltip.js","client/view/game/ui/system/SystemStrategyUi/cargo/CargoItem.js","client/view/game/ui/system/SystemStrategyUi/cargo/CargoList.js","client/view/game/ui/system/SystemStrategyUi/torpedo/TorpedoLauncher.js","client/view/game/ui/system/SystemStrategyUi/ammo/Ammo.js","client/view/game/ui/system/SystemStrategyUi/range/RangePenalty.js","client/view/game/ui/system/SystemStrategyUi/index.js","client/view/game/ui/system/SystemInfo.js","client/view/game/ui/system/SystemIcon.js","client/view/game/ui/system/StructureIcon.js","client/view/game/ui/shipWindow/ShipSection.js","client/view/game/ui/shipWindow/ShipWindow.js","client/view/game/ui/shipTooltip/WeaponTargeting.js","client/view/game/ui/shipTooltip/WeaponTargetingList.js","model/weapon/TorpedoAttackService.mjs","client/view/game/ui/shipTooltip/TorpedoAttackTooltip.js","model/movement/TorpedoMovementService.mjs","model/unit/TorpedoFlight.mjs","client/view/game/ui/shipTooltip/TorpedoAttack.js","client/view/game/ui/shipTooltip/ShipTooltipDetails.js","client/view/game/ui/shipTooltip/ShipTooltip.js","client/view/game/ui/electronicWarfare/CCEWButtons.js","client/view/game/ui/shipTooltip/GameShipTooltipMenu.js","client/view/game/ui/uiStrategy/GameShipTooltipMenuStrategy.js","client/view/game/ui/uiStrategy/ShowUiModeButtons.js","client/view/game/ui/uiStrategy/electronicWarfare/OwnedShipEw.js","client/view/game/ui/uiStrategy/ShipClickSelectsShip.js","client/view/game/ui/uiStrategy/electronicWarfare/CurrentEW.js","client/view/game/ui/uiStrategy/weapon/WeaponArcsOnSystemMouseOver.js","client/view/game/ui/uiStrategy/weapon/SelectWeaponOnSystemClick.js","client/view/game/ui/uiStrategy/weapon/SelectedShipSystemList.js","client/view/game/ui/system/GameSystemTooltipMenu.js","client/view/game/ui/uiStrategy/GameSystemInfoMenuStrategy.js","client/view/game/ui/uiStrategy/SystemClickShowsSystemMenu.js","client/view/game/ui/uiStrategy/electronicWarfare/SelectedShipEwList.js","client/view/game/ui/uiStrategy/UnderHexForShips.js","client/view/game/ui/uiStrategy/ShowMapIcons.js","client/view/game/ui/uiStrategy/ShowShipBadges.js","client/view/game/ui/uiStrategy/ShowTorpedoObjects.js","client/view/game/phase/phaseStrategy/DeploymentPhaseStrategy.js","client/view/game/phase/phaseStrategy/ReplayPhaseStrategy.js","client/view/game/phase/phaseStrategy/WaitingPhaseStrategy.js","client/view/game/phase/phaseStrategy/GamePhaseStrategy.js","client/view/game/animation/ShipVelocityAnimation.js","client/view/game/phase/phaseStrategy/AutomaticReplayPhaseStrategy/ReplayContext.js","client/view/game/ui/uiStrategy/replay/ShipWeaponAnimationService.js","model/combatLog/CombatLogShipMovement.mjs","model/combatLog/CombatLogShipVelocity.mjs","client/view/game/animation/CameraPositionAnimation.js","model/weapon/WeaponHitChange.mjs","model/combatLog/CombatLogWeaponFireHitResult.mjs","model/combatLog/CombatLogWeaponFire.mjs","model/combatLog/CombatLogGroupedWeaponFire.mjs","client/view/game/animation/SystemDestroyedTextAnimation.js","client/view/game/animation/TorpedoMovementAnimation.js","model/combatLog/CombatLogTorpedoMove.mjs","model/combatLog/CombatLogTorpedoAttack.mjs","model/combatLog/CombatLogGroupedTorpedoAttack.mjs","client/view/game/animation/TorpedoExplosion/TorpedoExplosionHE.js","client/view/game/animation/TorpedoExplosion/TorpedoExplosionMSV.js","client/view/game/ui/uiStrategy/replay/ReplayTurnActions.js","client/view/game/phase/phaseStrategy/AutomaticReplayPhaseStrategy/AutomaticReplayPhaseStrategy.js","client/view/game/phase/phaseStrategy/AutomaticReplayPhaseStrategy/index.js","client/view/game/phase/GameDataCache.js","model/game/GameSlot.mjs","model/game/GameSlots.mjs","model/unit/system/strategy/BoostableSystemStrategy.mjs","model/unit/system/strategy/ThrustOutputSystemStrategy.mjs","model/unit/system/strategy/RequiresPowerSystemStrategy.mjs","model/unit/system/strategy/PowerOutputSystemStrategy.mjs","model/unit/system/strategy/ThrustChannelSystemStrategy.mjs","model/unit/system/strategy/AllowsEvasionSystemStrategy.mjs","model/unit/system/strategy/ElectronicWarfareProvider.mjs","model/unit/system/strategy/LargerHitProfileOnlineSystemStrategy.mjs","model/unit/system/strategy/BoostablePlusOneOutputSystemStrategy.mjs","model/unit/system/strategy/ArmorBoostOfflineSystemStrategy.mjs","model/unit/system/strategy/OutputHeatOnlineStrategy.mjs","model/unit/system/strategy/FireOrderHeatStrategy.mjs","model/unit/system/strategy/AlwaysTargetableSystemStrategy.mjs","model/unit/system/strategy/weapon/StandardHitStrategy.mjs","model/unit/system/strategy/weapon/StandardRangeStrategy.mjs","model/combatLog/CombatLogWeaponOutOfArc.mjs","model/unit/system/strategy/weapon/FireOrderStrategy.mjs","model/unit/system/strategy/weapon/StandardLoadingStrategy.mjs","model/unit/system/strategy/weapon/WeaponArcStrategy.mjs","model/unit/system/reactor/Reactor.mjs","model/unit/system/strategy/weapon/TestDamageStrategy.mjs","model/unit/system/strategy/weapon/BurstDamageStrategy.mjs","model/unit/system/strategy/weapon/PiercingDamageStrategy.mjs","model/unit/system/strategy/weapon/InterceptorStrategy.mjs","model/unit/system/thruster/ManeuveringThruster.mjs","model/unit/system/thruster/Thruster.mjs","model/unit/system/thruster/ManeuveringThrusterLeft.mjs","model/unit/system/thruster/ManeuveringThrusterRight.mjs","model/unit/system/engine/Engine.mjs","model/unit/system/electronicWarfare/EwArray.mjs","model/unit/system/electronicWarfare/CQEWArray.mjs","model/unit/system/electronicWarfare/ElintArray.mjs","model/unit/system/electronicWarfare/OEWArray.mjs","model/unit/system/weapon/Weapon.mjs","model/unit/system/weapon/TestWeapon.mjs","model/unit/system/strategy/weapon/WeaponAnimationStrategy.mjs","model/unit/system/weapon/coilgun/CoilgunLightFixed.mjs","model/unit/system/weapon/coilgun/MediumCoilcunTurretedUC.mjs","model/unit/system/weapon/coilgun/RailgunTurreted64gw.mjs","model/unit/system/weapon/coilgun/RailgunTurreted32gw.mjs","model/cargo/CargoService.mjs","model/unit/system/strategy/weapon/AmmunitionStrategy.mjs","model/unit/system/weapon/pdc/PDC30mm.mjs","model/unit/system/weapon/railgun/RailgunFixed120mm.mjs","model/unit/system/weapon/railgun/RailgunTurreted2x140mm.mjs","model/unit/system/weapon/railgun/RailgunTurreted140mmUC.mjs","model/unit/system/strategy/weapon/TorpedoLauncherStrategy.mjs","model/unit/system/weapon/launcher/TorpedoLauncher158.mjs","model/unit/system/weapon/launcher/TorpedoLauncherDual72.mjs","model/unit/system/weapon/launcher/TorpedoLauncherDual158.mjs","model/unit/system/weapon/launcher/TorpedoLauncherQuadruple158.mjs","model/unit/system/weapon/autocannon/AutoCannon85mm.mjs","model/unit/system/weapon/index.mjs","model/unit/system/heat/Radiator.mjs","model/unit/system/heat/HeatSink.mjs","model/unit/system/heat/Radiator5x40.mjs","model/unit/system/heat/Radiator10x40.mjs","model/unit/system/heat/Radiator10x50.mjs","model/unit/system/cargo/CargoBay.mjs","model/unit/system/index.mjs","model/unit/ships/uc/UcRhino.mjs","model/unit/ships/uc/Haka.mjs","model/unit/ships/test/TestShip.mjs","model/unit/ships/protectorate/Caliope.mjs","model/unit/ships/protectorate/Mouros.mjs","model/unit/ships/protectorate/Fulcrum.mjs","model/unit/system/weapon/pdc/X2PDC30mm.mjs","model/unit/ships/federation/Impetous.mjs","model/unit/ships/index.mjs","model/unit/createShipObject.mjs","model/game/GameShips.mjs","model/game/GameActiveShips.mjs","model/game/GameTerrainEntity.mjs","model/utils/ARKStep.mjs","model/utils/ARK.mjs","model/game/GameTerrain.mjs","model/game/GameTorpedos.mjs","model/combatLog/CombatLogTorpedoLaunch.mjs","model/combatLog/CombatLogTorpedoIntercept.mjs","model/combatLog/CombatLogTorpedoOutOfTime.mjs","model/combatLog/CombatLogTorpedoNotArmed.mjs","model/combatLog/combatLogClasses.mjs","model/combatLog/CombatLogData.mjs","model/game/GameData.mjs","model/game/gamePhases.mjs","model/game/gameStatuses.mjs","client/view/game/renderer/ships/TorpedoObject.js","client/view/game/renderer/icon/TorpedoIconContainer.js","client/view/game/phase/PhaseDirector.js","client/view/game/utils/PositionObject.js","client/view/game/GameSettings.js","client/view/game/GameConnector.js","model/game/gameMessage.mjs","client/view/game/renderer/hexgrid/HexGridRender.js","client/view/game/GameCamera.js","client/view/game/GameScene.js","client/view/game/Game.js","client/view/game/ui/UIState.js","client/view/game/components/lobby/FleetList.js","client/view/createGame/Slot.js","client/view/game/components/lobby/LobbySlots.js","model/unit/ships/factions.mjs","client/view/game/components/lobby/Faction.js","client/view/game/components/lobby/FleetStore.js","client/view/game/components/lobby/Lobby.js","client/view/game/components/lobby/index.js","client/view/game/ui/shipTooltip/index.js","client/view/game/ui/TurnHeader.js","client/view/game/ui/movement/Movement.js","client/view/game/ui/movement/Container.js","client/view/game/ui/movement/ThrustButton.js","client/view/game/ui/movement/RevertButton.js","client/view/game/ui/movement/CancelButton.js","client/view/game/ui/movement/PivotButton.js","client/view/game/ui/movement/RollButton.js","client/view/game/ui/movement/EvadeButton.js","client/view/game/ui/movement/GameMovement.js","client/view/game/ui/movement/DeploymentPivotButton.js","client/view/game/ui/movement/DeploymentMovement.js","client/view/game/ui/GameUiModeButtons.js","client/view/game/ui/electronicWarfare/EwList.js","client/view/game/ui/system/SystemList.js","client/view/game/ui/leftPanel/LeftPanel.js","client/view/game/ui/replay/ReplayUI.js","client/view/game/ui/combatLog/styled.js","client/view/game/ui/combatLog/HitChange.js","client/view/game/ui/combatLog/DamageLine.js","client/view/game/ui/combatLog/CombatLogLine.js","client/view/game/ui/combatLog/CombatLog.js","client/view/game/ui/shipBadge/ShipBadge.js","client/view/game/GameStoreProvider.js","client/view/game/components/GameUiComponent.js","client/view/game/index.js","client/view/game/components/GameComponent.js","client/view/logout/index.js","client/view/register/Register.js","client/view/logout/Logout.js","client/view/createGame/Slots.js","client/view/createGame/CreateGame.js","client/view/createGame/index.js","client/Router.js","client/App.js","client/serviceWorker.js","index.js"],"names":["blue","darkBlue","border","borderDark","text","textDanger","lightBlue","systemWindowBorder","systemWindowPrimaryBorder","systemBorder","tooltipButtonColor","Arrow","this","props","size","id","xmlns","width","height","viewBox","d","React","ArrowSmall","color","fill","Roll","X","Evade","Pivot","Cancel","CheckMark","Play","PureComponent","Pause","Replay","IconAndLabel","styled","div","background","Container","defaultPadding","css","defaultWidth","DarkContainer","PanelContainer","Section","SectionRight","Cell50","p","Label","span","Value","Title","SubTitle","Clickable","disabled","Error","colors","InputAndLabel","label","type","value","placeholder","onKeyDown","onChange","error","rest","SubContainer","htmlFor","Input","tabIndex","input","Component","children","className","TooltipContainer","Tooltip","RelativeTooltipContainer","Object","keys","position","reduce","style","key","TooltipValue","RelativeTooltip","element","boundingBox","getBoundingClientRect","get","top","window","innerHeight","bottom","left","innerWidth","right","getPosition","TooltipHeader","TooltipSubHeader","TooltipValueHeader","TooltipEntry","noMargin","important","space","clickable","CenteredTooltipEntry","InlineTooltipEntry","TooltipMenu","selectedTooltipButton","disabledTooltipButton","hoverTooltipButton","TooltipButton","button","img","selected","buildTooltipEntries","entries","subKey","sort","a","b","map","index","header","replace","Array","isArray","greyButton","iconStyle","IconContainer","ButtonContainer","icon","buttonStyle","Button","Link","RouterLink","COLOR_FRIENDLY","THREE","Color","COLOR_ENEMY","COLOR_FRIENDLY_HIGHLIGHT","clone","multiplyScalar","COLOR_ENEMY_HIGHLIGHT","COLOR_OEW_FRIENDLY","COLOR_OEW_ENEMY","NEIGHBOURS","q","r","Offset","undefined","console","trace","offset","neighbours","forEach","neighbour","push","add","heading","toCube","toOffset","subtract","scale","direction","steps","moveToDirection","getNeighbours","target","distanceTo","radius","ring","cube","spiral","x","z","Cube","round","distance","drawLine","facing","rotate","normalize","lerp","t","cubeLerp","y","_formatNumber","_validate","rx","Math","ry","rz","x_diff","abs","y_diff","z_diff","max","delta","some","hex","i","equals","results","j","k","concat","number","parseFloat","toFixed","n","result","getHexA","hexSize","sin","PI","getHexB","cos","getHexHeight","getHexWidth","floor","hexCountWidth","hexCountHeight","x1","y1","x2","y2","sqrt","pow","getSeededRandomGenerator","seed","c","seedGenerator","str","h","length","imul","charCodeAt","xmur3","addToDirection","current","addToHexFacing","getPointInDirection","cx","cy","noRound","radianToDegree","angle","degreeToRadian","getCompassHeadingOfPoint","observer","atan2","hexFacingToAngle","angleToHexFacing","getShipIcon","object3d","userData","parent","coordinateConverter","hexlenght","zoom","camera","scene","raycaster","Raycaster","fromGameToViewPort","fromHexToGame","HexagonMath","hex1","hexagon","hex2","getNeighbourAtDirection","gameCoordinates","offsetHex","Vector","pos","setFromCamera","xR","yR","getCamera","intersectObjects","intersected","object","name","point","intersects","includes","vector","Vector3","set","project","helperA","helperB","Vector2","dot","sub","scalar","matrix","applyMatrix4","fromGameToHex","Animation","getRandom","random","active","started","done","callback","startCallback","doneCallback","total","time","duration","gameData","now","last","goingBack","changeAttribute","geometry","values","attributes","array","needsUpdate","BaseParticle","material","texture","gas","bolt","glow","starLine","setPosition","setColor","setOpacity","setFadeIn","setFadeOut","setSize","setSizeChange","setAngle","setAngleChange","setActivationTime","setVelocity","setAcceleration","setTexture","frequency","amplitude","tex","g","opacity","speed","velocity","acceleration","setInitialValues","gameTime","effectVertexShader","effectFragmentShader","spriteFragmentShader","spriteVertexShader","line2dVertexShader","line2dFragmentShader","load","ParticleEmitter","particleCount","args","blending","free","effects","uniforms","zoomLevel","particleGeometry","addAttribute","Float32Array","setDynamic","dynamic","setDrawRange","particleMaterial","vertexShader","fragmentShader","transparent","depthWrite","depthTest","flyParticle","create","mesh","frustumCulled","dispose","remove","pop","particleIndices","BoltInstance","boltContainer","setScale","rotation","quaternion","setFromUnitVectors","setQuaternion","fade","setDeactivationTime","BoltContainer","offsetAttribute","opacityAttribute","textureNumberAttribute","scaleAttribute","quaternionAttribute","colorAttribute","velocityAttribute","activationGameTimeAttribute","deactivationGameTimeAttribute","deactivationFadeAttribute","amount","numberCreated","flyBolt","order","used","opacitys","setArray","filter","setX","setIndex","setXYZ","setXYZW","w","loader","GLTFLoader","entities","cloneObject","source","cloneMaterial","sourceLookup","Map","cloneLookup","animations","parallelTraverse","sourceNode","clonedNode","traverse","node","isSkinnedMesh","clonedMesh","sourceMesh","sourceBones","skeleton","bones","bindMatrix","copy","bone","bind","isMesh","loadObject","url","async","cached","find","entity","Promise","resolve","reject","loadedCube","BoltInstanceFactory","ready","loadCube","side","start","Date","makeInstanced","cubeGeometry","original","uv","offsets","textureNumbers","scales","quaternions","velocitys","activations","deactivations","fades","ParticleEmitterContainer","defaultParticleAmount","boltInstanceFactory","reservations","emitters","star","effect","_isReady","readyPromise","createStarParticleEmitter","createBoltParticleEmitter","createEffectParticleEmitter","StarParticleEmitter","reserver","emitter","hasFree","createParticleEmitter","particle","getParticle","cleanUp","reservation","freeParticles","payload","render","StarParticle","setParallaxFactor","setSineFrequency","setSineAmplitude","parallaxFactor","sineFrequency","sineAmplitude","StarField","gameId","starCount","emitterContainer","lastAnimationTime","totalAnimationTime","zoomChanged","stars","createStar","createShiningStar","getTime","release","isReady","deltaTime","getStarParticle","shines","angleChange","getRandomBand","iterations","createGasCloudPart","min","baseRotation","createGas","HomeScene","starFieldScene","starFieldCamera","starField","initialized","lookAt","renderer","alpha","antialias","setPixelRatio","devicePixelRatio","autoClear","context","getExtension","gammaOutput","gammaFactor","appendChild","domElement","clear","requestAnimationFrame","resize","WebglCanvas","HomeSceneComponent","canvasRef","addEventListener","onResize","sceneElement","init","getDimensions","offsetWidth","offsetHeight","removeEventListener","dimensions","nextProps","nextState","ref","SERVER_URL","axiosConfig","withCredentials","headers","login","username","password","axios","post","response","register","getCurrentUser","logout","createGame","serialize","User","accessLevel","data","actionTypes","dispatch","user","reducer","state","action","deserialize","currentUser","StateStore","createContext","DispatchStore","initialState","StoreProvider","useReducer","useEffect","Provider","Login","useContext","initialValues","onSubmit","setSubmitting","loginUser","log","validationSchema","Yup","shape","required","touched","errors","isSubmitting","handleChange","handleBlur","handleSubmit","as","onBlur","onClick","e","preventDefault","stopPropagation","alert","LoginFloaterContainer","LoginFloater","Logo","SuperContainer","ContainerLeft","ContainerRight","Home","to","ClickCatcher","getMousePositionInObservedElement","event","touches","originalEvent","pageX","pageY","clientX","clientY","GameSceneComponent","onTouchStart","onWheel","stopImmediatePropagation","game","sign","deltaY","onMouseWheel","clickCatcherRef","mouseDownPosition","lastDraggingPosition","draggingThreshold","document","onKeyUp","initRender","onMouseUp","onDrag","onMouseMove","onMouseOut","onMouseDown","onContextMenu","RequiredThrust","ship","move","requirements","fullfilments","0","1","2","3","4","5","6","7","8","movementTypes","SPEED","requireSpeed","PIVOT","requirePivot","ROLL","requireRoll","EVADE","requireEvade","getFulfilledAmount","every","getRequirement","thruster","thrusterId","entry","fulfillment","rollcost","evasioncost","movement","isRolled","pivotcost","actualDirection","accelcost","MovementOrder","rolled","turn","requiredThrust","req","roundToHexCenter","DEPLOY","START","END","isSpeed","isPivot","isEvade","isRoll","MovementResolver","movementService","bill","commit","pay","newMovement","getMoves","replaceMovement","shipStateChanged","roll","rollMove","getRollMove","endMove","getLastEndMoveOrSurrogate","movements","getMovement","playerAdded","isPlayerAdded","nonPlayerAdded","ThrustBill","getThrustOutput","billAndPay","step","evade","evadeMove","getEvadeMove","getMaxEvasion","pivotDirection","pivot","lastMove","getLastMove","pivotMove","maxPivots","thrust","thrustMove","getHexVelocity","isCancellable","toCancel","removeMovement","thrustAvailable","thrusters","systems","getSystems","system","callHandler","isDisabled","ThrustAssignment","buildRequiredThrust","paid","cost","directionsRequired","getRequiredThrustDirections","accumulator","accumulate","totalRequired","getCurrentThrustRequired","capacity","getThrustCapacity","isDirection","sortThrusters","aHeat","getOverheat","bHeat","channeled","isOverBudget","getTotalThrustRequired","process","isPaid","message","parseInt","useThrusters","assigned","getAllUsableThrusters","channel","errorIfOverBudget","setRequiredThrust","fulfill","addAssigned","isFulfilled","directions","heat","MovementService","gamedata","phaseDirector","end","getLastEndMove","getMostRecentMove","ships","ship2","isDestroyed","terrain","startMove","getVelocity","getGravityVectorForTurn","deployMove","getDeployMove","replaceDeployMove","addMovement","newfacing","currentTurn","relayEvent","canThrust","canCancel","canRevert","cancel","revert","turnDirection","canPivot","canRoll","getEvasion","canEvade","ShipPower","shipSystems","acc","power","getPowerOutput","isOffline","getPowerRequirement","getPowerRequired","getRemainingPowerOutput","canSetOffline","canSetOnline","otherSystem","getSystemById","isGoingOffline","setOffline","isGoingOnline","setOnline","shuffleArray","isValidPower","DamageEntry","armor","uuidv4","destroyedSystem","new","Critical","Number","isInteger","turnsRemaining","getClassName","critical","constructor","OutputReduced","outputReduction","getDuration","OutputReduced2","OutputReduced4","OutputReduced6","OutputReduced8","LoadingTimeIncreased","loadingTimeIncrease","ForcedOffline","ForcedOfflineOverheat","getOverheatPercentage","ThrustChannelHeatIncreased","heatMultiplier","SystemDamage","criticals","damage","setSystem","old","isReplacedBy","crit","getDamage","hitpoints","getTotalDamage","advanceTurn","Boolean","isFixed","PowerEntry","powerType","SystemPower","forceOffline","SystemHeat","overheat","heatTransferPerStructure","overheatLimitPerStructure","overheatTransferRatio","heatTransferred","isHeatStorage","getMaxTransferHeat","overheatTransfer","getTransferOverHeat","getHeat","newHeat","getHeatGenerated","getMaxHeatStoreCapacity","change","extra","getOverheatTreshold","ShipSystemLogEntry","messages","formatNumber","ShipSystemLogEntryHeat","initialOverheat","initialOverheatPercentage","heatGenerated","heatCooled","heatRadiated","overheatPercentage","isForcedOffline","intialHeatStored","newHeatStored","heatGivenToRadiators","percentage","isRadiator","isStorage","getHeatStorageMessage","getRadiatorMessage","getRegularMessage","heatMessage","ShipSystemLogEntryCriticalHit","newDamagePoints","overHeatPoints","oldDamagePoints","criticalMessage","extraPoints","ShipSystemLogEntryDamage","blockedByArmor","wasDestroyed","damageEntry","addBlockedByArmor","systemLogEntryClasses","ShipSystemLog","isOpen","isTurn","all","getMessage","turns","turnEntry","setTurn","ShipSystem","strategies","strategy","heatMessages","shouldDisplayHeat","getRemainingHitpoints","getArmor","armorMod","shipWasDestroyed","systemWasDestroyed","addDamage","setDestroyedSystem","getOpenLogEntryByClass","markDestroyedThisTurn","addCritical","hasAnyCritical","hasCritical","instance","endTurn","ShipSystemStrategy","diceRoller","dice","DiceRoller","previousResponse","hasHandler","CargoEntity","Torpedo","deltaVelocityPerTurn","turnsToLive","maxInterceptVelocity","hitSize","evasion","armingTime","damageStrategy","visuals","engineColor","explosionType","explosionSize","flight","effectiveness","tries","getMessages","Torpedo158","HitSystemRandomizer","totalStructure","ceil","getSystemHitSize","rollForSystem","tested","CombatLogDamageEntry","notes","note","logEntryClass","systemId","damageIds","damageId","getDamageById","StandardDamageStrategy","damageFormula","armorPiercingFormula","hitSystemRandomizer","ammo","join","_getDamageTypeMessage","_getDamageMessage","_getArmorPiercingMessage","fireOrder","combatLogEntry","hit","hitResolution","setShots","_doDamage","shooterPosition","shooter","damageResult","lastSection","armorPiercing","_getArmorPiercing","_getDamageForWeaponHit","hitSystem","_chooseHitSystem","_doDamageToSystem","overkillSystem","_findOverkillStructure","sections","getSectionBySystem","addNote","structure","getStructure","finalArmor","armorPiercingLeft","randomizeHitSystem","getSystemsForHit","requiredToHit","rolledToHit","getArmorPiercing","MSVTorpedoDamageStrategy","rangePenalty","numberOfShots","strikeHitChange","minStrikeDistance","torpedoFlight","strikeEffectiveness","getHitProfile","launchPosition","getHitChange","combatLogEvent","attackPosition","shots","getStrikeDistance","hitChance","hits","Torpedo158MSV","Torpedo158MSV2","HETorpedoDamageStrategy","numberOfHitsFormula","numberOfDamagesFormula","numberOfDamages","_getNumberOfDamagesForWeaponHit","Torpedo158Nuclear","Torpedo72","Torpedo72MSV","Torpedo72HE","Torpedo158HE","Ammo","Ammo30mm","Ammo85mmHE","Ammo85mmAP","Ammo140mmAP","Ammo140mmHE","Ammo120mmAP","Ammo120mmHE","NoAmmunitionLoaded","ammunition","torpedoes","conventional","cargoClasses","CargoBaySystemStrategy","cargo","list","cargoBaySystemStrategy","getCargoSpaceUsed","getSpaceRequired","getAvailableCargoSpace","stored","parentClass","getCargoEntry","hasSpaceFor","StoreHeatStrategy","heatCapacity","RadiateHeatStrategy","radiationCapacity","undamaged","getPercentUnDamaged","heatLeft","getHeatRadiationCapacity","Structure","cargoSpace","heatStorage","radiator","addStrategy","SystemSection","location","PrimarySection","AftSection","FrontSection","PortAftSection","PortFrontSection","StarboardFrontSection","StarboardAftSection","ShipSystemSections","shipPosition","shipFacing","section","intervening","getOffsetHex","getNeighbourAtHeading","blockingSection","hasUndestroyedStructure","getHitSectionHeading","getSectionsThatCanBeHit","newSection","getNextSectionForHit","getSection","ShipSystems","systemsAsArray","structuresDestroyed","structures","primaryStructure","getPrimarySection","getHitSections","getFacing","getSectionsForHit","addSystem","addShipSystemsReference","getFrontSection","getAftSection","getStarboardFrontSection","getStarboardAftSection","getPortFrontSection","getPortAftSection","systemData","clientShip","clientSystem","mine","heatTransfer","getRadiateHeatCapacity","ElectronicWarfareEntry","targetShipId","ShipCurrentElectronicWarfare","dew","ccew","ElectornicWarfareEntry","getFromEntries","combined","getType","existing","combinedEntry","Ship","getAmount","UnableToAssignEw","ShipElectronicWarfare","inEffect","getDefensiveEw","getCcEw","getAllEntries","canAssignEw","assingEw","getEw","getEwArrays","assignEntries","allowIncomplete","removeAll","negativeEntries","negativeEntry","assignPositiveEW","availableSystems","getAvailableSystemsForEntry","shift","aValidTypes","bValidTypes","ShipPlayer","ShipMovement","moves","buildIndex","toDelete","other","isEnd","isDeploy","isStart","deploy","newMove","lastIndex","callAllSystemHandlers","getFulfilments","fulfilment","slice","reverse","getStartMove","getTotalAmountRequired","getThrustRequired","otherShip","getHexPosition","otherShipPosition","otherShipFacing","hexSizes","otherHex","hasValidMovement","replaceLastMove","moveData","pointCost","frontHitProfile","sideHitProfile","shipModel","shipTypeName","setShipProperties","front","getFrontHitProfile","getSideHitProfile","getFinalPosition","hexDistanceTo","closest","getFinalHexPosition","_calculateHexDistanceTo","hexFacing","shipData","shipClass","slotId","player","electronicWarfare","destroyedThisTurn","removeMovementExceptEnd","censorForUser","removeMovementForOtherTurns","activatePlannedElectronicWarfare","receivePlayerData","FireOrder","shooterId","targetId","weaponId","weaponSettigs","resolved","WeaponFireService","getShips","getAllFireOrdersForShip","getAllFireOrders","fireOrders","weapon","canFire","PhaseState","GEOMETRY","getTexture","LineSprite","lineWidth","textureRepeat","pulse","pulseAmount","pulseSpeed","update","animate","wrapT","minFilter","textureSize","roundTestureRepeate","force","setY","testureRepeat","visible","textureLoader","geometries","baseMaterial","Sprite","image","overlayAlpha","overlayColor","m","getMaterial","drawCircleSegment","canvas","r2","s","beginPath","arc","p1","mathlib","lineTo","p2","closePath","stroke","drawCenteredHexagon","l","leftside","topleft","topright","drawHexagon","p3","p4","p5","p6","moveTo","debug","createElement","zIndex","body","createCanvas","abstractCanvas","gridWidth","gridHeight","wrapS","repeat","getHorizontalRepeat","getVerticalRepeat","hexagons","renderHexGrid","canvasSize","lineColor","fillColor","hl","getContext","fillStyle","strokeStyle","canvas2","drawImage","TEXTURE","createTexture","HexagonTexture","getStrokeColor","getFillColor","HexagonSprite","segments","gapratio","deg","gap","drawDottedCircle","TEXTURE_SIZE","DottedCircleSprite","TextSprite","fontSize","font","save","textAlign","textBaseline","shadowOffsetX","shadowOffsetY","shadowColor","shadowBlur","fillText","restore","textureMovementTarget","ShipMapSprite","movementTarget","hexagonMesh","Line","dashSize","subVectors","resolveReady","currentRotationMatrix","getGeometry","pulseAttribute","getVertexAmount","setXY","pulses","dashAttribute","dashRatio","dashes","pointX","pointY","orientation","up","multiply","createMesh","getOrientation","applyMatrix","setColorAttribute","setDashed","setPulse","getInverse","updateMesh","loadObject3d","Object3d","actions","animationMixer","loopAnimation","callBack","child","clip","findByName","clipAction","reset","weight","paused","clampWhenFinished","loop","play","setId","ShipMapIcon","normalSprite","movementTargetSprite","sprite","hide","replaceColor","revertColor","setFacing","setOverlayColor","setOverlayColorAlpha","show","ShipObject","shipId","systemLocations","bumpMap","shipObject","systemObjects","resolveShipObjectLoaded","isShipObjectLoaded","mapIcon","hexSprites","hexSpriteContainer","ghostShipObject","shipSideSprite","shipSelectedSprite","line","defaultHeight","sideSpriteSize","shipZ","hidden","emissiveReplaced","ghost","forcedEmissiveColor","consumeShipdata","bumpScale","flipY","addTo","shipObjects","overlaySpriteSize","setFromAxisAngle","tmpQuaternion","setRotation","replaceOpacity","names","slot","newEntity","replaceEmissive","replacement","emissive","emissiveMap","forceEmissive","hexSprite","hideShip","showShip","renderPayload","playAnimation","setAnimation","disableAnimation","iconPosition","iconFacing","getIconHexas","hexas","getShipHexas","lowest","highest","Gunship","Loader","loadTexturesAndAssign","startRotation","Rhino","autoCannon","shipMaterial","Capital","normalScale","shininess","Haka","setShipObject","Caliope","Fulcrum","Mouros","Impetous","ShipIconContainer","iconsAsObject","iconsAsArray","ghostShipIcons","setGhostShip","is","createGhostShipIcon","hasIcon","createIcon","call","icons","getHexHeightViewport","getIconsInSameHex","closestDistance","shipIcon","currentDistance","getLastMovement","OEWIndicator","targetIcon","targetGhost","targetPosition","createLine","setZ","getZ","destroy","newTargetPosition","newShipPosition","updateTextureSize","ShipEWIndicators","shipIconContainer","getByShip","oew","useGhost","createOEW","newOew","getAllOew","ewEntry","getById","getGhostShipIconByShip","indicator","indicatorNew","CurrentOEWIndicator","ShipCurrentEWIndicators","ElectronicWarfareIndicatorService","iconContainer","indicators","currentIndicators","isShip","getCurrentIndicators","getIndicators","TerrainRenderer","terrainObjects","diameter","ShipWindowManager","uiState","setShipWindows","openShip","MovementPath","objects","getNewEndMove","createMovementLine","createMovementFacing","setGhostShipEmissive","setMovementTarget","MovementPathService","paths","path","movementPath","getPath","PhaseStrategy","services","inactive","animationPaused","animationReversed","currentDeltaTime","animationStartTime","animationEndtime","animationTurnLength","callStrategies","activate","functionName","stopped","updateDeltaTime","updateTotalAnimationTime","torpedoIconContainer","setGameData","updateStrategies","activateStrategies","gameConnector","LobbyPhaseStrategy","setLobby","takeSlot","leaveSlot","buyShips","UiStrategy","MouseOverShowsMovementPath","movementPathService","hideAllMovementPaths","showMovementPath","HighlightSelectedShip","activeTime","revertEmissive","revertOpacity","SelectedShipMovementUi","hideShipMovement","getSelectedShip","showShipMovement","ShowDeploymentAreas","areas","area","sprites","slots","getSlots","deploymentLocation","deploymentRadius","isUsers","isUsersTeamSlot","shouldEaseIn","startsAndEnds","startEndIndex","between","betweenIndex","lastBetween","shouldEaseOut","nextMove","startsAndEndsToSteps","startFacing","endFacing","easeIn","easeOut","betweenMap","movesToSteps","newStep","PivotPath","percentDone","stepIndex","stepDone","ShipMovementAnimation","positionCurves","movesToCurves","pivotSteps","PivotSteps","startRoll","endRoll","easeInOut","getPoint","getPositionAndFacing","turnDone","getMovementTurnDone","angle1","angle2","getCurrentRoll","setRoll","buildPositionCurve","startPosition","point1","control1","control2","point2","ShipIdleMovementAnimation","gameTerrain","getRoll","back","isRolling","ShipSystemAnimation","updateAll","updateSystem","disableSystemAnimation","playSystemAnimation","setSystemAnimation","isOnline","BoltEffect","startTime","endPosition","particleEmitterContainer","createBolt","directionNormal","tailLength","getBoltParticle","setBoltTexture","coreLength","coreTime","coreOpacity","boltEffect","ExplosionEffect","getRandomColor","setRGB","getSmokeColor","createGlow","createEMP","createPillar","createMainGlow","createCore","createWhiteCenter","shootoffs","createShootOffs","createMain","createPillars","createEmpGlow","createEmpCore","activation","fadeOutAt","createShootOff","fadeOutSpeed","activationTime","getYellowColor","getCoreColor","ShipWeaponAnimation","applyQuaternion","ShipWeaponBoltAnimation","shooterIcon","weaponAnimationService","shotsHit","extraWait","getLocationForSystem","getRandomPosition","getBoltEffect","explosion","causedDamage","getDamageExplosion","ShipWeaponBoltBurstAnimation","missesFirst","offsetVector","missExtra","missFade","totalShots","startExtra","shotNumber","ShipWeaponUniversalBoltAnimation","omitHitExplosion","setStartPosition","setEndPosition","setStartTime","shot","hitsStart","currentShot","impactPosition","impactTime","startWait","firstHit","getFirstHit","AnimationUiStrategy","removeAllAnimations","animation","deactivate","toRemove","ShowShipObjects","getArray","RightClickShowsShipWindow","MouseOverShowsShipTooltip","clickedShip","mouseOveredShip","showShipTooltip","hideShipTooltip","systemMenu","activeSystem","MouseOverHighlightsShip","SelectUndeployedShip","getShipsForUser","selectShip","DeployShipOnHexClick","getSlotByShip","isValidShipDeployment","AllowSubmittingWhenDeploymentDone","setTurnReady","checkDeployment","SelectedShipDeploymentMovementUi","showShipDeploymentMovement","ShowWaitingStatus","setWaiting","SelectFirstActiveShip","activeShips","isActive","oldShip","newShip","getShipById","getActiveShipsForUser","AllShipsMovementPaths","hasGameUiMode","getAliveShips","AllowSubmittingOnValidGameState","AutomaticReplay","phaseStrategy","replayContext","gameDatas","shipsLoaded","setTimeout","animateFromTo","getTurnLength","closeReplay","ShowReplayUi","showReplayUi","Text","ShipName","Amount","OEWButtons","canAssignOffensiveEw","assignOffensiveEw","GamePositionComponent","containerRef","renderCallback","onGameRender","marginTop","marginLeft","newPosition","subscribeToRender","unsubscribeFromRender","InfoHeader","Entry","Header","InfoValue","SystemInfoWeaponTargeting","hitChange","baseToHit","fireControl","outOfRange","rangeModifier","CargoTooltipContainer","CargoTooltip","additionalContent","getDisplayName","getCargoInfo","getEntry","CargoItem","createRef","mouseOveredCargo","setState","handleOnClick","tooltipAdditionalContent","onMouseOver","onCargoMouseOver","onCargoMouseOut","getBackgroundImage","CargoListContainer","CargoList","customEvent","mouseOveredSystem","TorpedoList","TorpedoLauncher","launcher","forceUpdate","systemChangedCallbackInstance","systemChangedCallback","subscribeToSystemChange","unsubscribeFromSystemChange","launcherIndex","unloadAmmo","shipSystemStateChanged","torpedo","loadAmmo","loadedTorpedo","loadingTime","turnsLoaded","torpedoClass","getPossibleTorpedosToLoad","loadTorpedo","LoadingList","NewTargetContainer","MagazineTooltipEntry","LoadingButton","loadingOpen","ammoStrategy","loadingTarget","getLoadingTarget","ammunitionClasses","notFound","addToLoading","ammoPerFireOrder","getSelectedAmmo","getShortDisplayName","getAmmoInMagazine","startLoadingAfter","turnsOffline","intakeInTurn","getLoadingTargetAmount","getNewLoadOutButtons","RangeContainer","RangeNumbersContainer","RangeStep","RangePenalty","rangeStrategy","getMaxRange","getRangeModifier","range","ranges","rangesAndPenalties","SystemStrategyUi","myShip","SystemTooltip","tab","Warning","HeaderMenu","HeaderMenuItem","SystemInfo","scs","warnings","getCriticals","getSystemDescription","getWithTurns","messageIndex","systemInfoMenuProvider","weaponTargeting","Menu","getWarnings","getSystemInfo","getContainer","getDefaultTab","getLogTab","getInfoTab","HealthBar","destroyed","health","SystemText","System","targeting","reserved","firing","offline","loading","SystemIcon","clickedSystem","activeSystemElement","onSystemClicked","clickSystem","weaponFireService","getIconText","menu","displayMenu","systemHasFireOrder","systemHasFireOrderAgainstShip","onSystemMouseOver","onSystemMouseOut","isLoading","getStructureLeft","StructureText","StructureContainer","StructureIcon","ShipSectionContainer","ShipSection","getNonStructureSystems","isSelectedSystem","ShipWindowContainer","Column","ColumnMiddle","ShipWindow","closeShipWindow","shipWindowClicked","team","WeaponTargeting","prediction","WeaponTargetingList","selectedShip","unTargetShip","targetShip","removeFireOrders","addFireOrder","isSameTeam","getSystemIcons","TorpedoAttackService","torpedoAttackShips","launchers","attack","deltaDistance","getDeltaVelocty","aLastMove","bLastMove","aPosition","bPosition","TorpedoAttackTooltip","strikePrediction","impactTurn","impactVelocity","getTorpedoTooltip","TorpedoMovementService","torpedoMath","getTorpedoGameDeltaVelocity","accelerationVector","turnsActive","buildPredictions","shooterVelocity","targetVelocity","Δpos","φ","rotationMatrix","Matrix4","makeRotationZ","newShooterVelocity","torpedoAcceleration","standardize","accelerationAngle","θ","findRoot","isNaN","toString","vx","vy","findRoot2","findUpperLimit","findLowerLimit","θ1","θ2","θlow","θhigh","θmid","f","argument","TorpedoFlight","reachedTarget","intercepted","getInterceptTries","impactAngle","Cell","TorpedoCargoItem","launchTarget","TorpedoAttack","setLaunchTarget","getPossibleTorpedos","torpedoMovementService","torpedoShipEntry","predictTorpedoHitPositionAndTurn","launcherClick","Row","ShipDetailsTooltipEntry","ShipTooltipDetails","getTotalHeatStored","getTotalHeatStorage","getPassiveHeatChange","ShipTooltipContainer","interactable","ShipTooltip","tooltipTab","ui","shipTooltipMenuProvider","getTooltipTab","getMenu","getTabHeader","selectTooltipTab","CCEWButtons","canAssignCcEw","assignCcEw","hasOnlineradiators","GameShipTooltipMenu","isSelected","getOffensiveEw","hasRadiators","on","toggleRadiators","hasInterceptors","toggleInterceptors","hasOnlineInterceptors","GameShipTooltipMenuStrategy","setTooltipMenuProvider","getTooltipComponent","ShowUiModeButtons","showUiModeButtons","OwnedShipEw","electronicWarfareIndicatorService","hideAll","showForShip","getUsersShips","ShipClickSelectsShip","CurrentEW","hideAllCurrent","getShipsEnemyTeams","showCurrentForShip","getShipsInSameTeam","WeaponArcsOnSystemMouseOver","weaponArcs","circle","maxRange","getHexDistance","arcsList","fillRect","arcs","arcLenght","faceVertexUvs","intial","uvsNeedUpdate","SelectWeaponOnSystemClick","deselectAllSystems","isWeapon","deselectSystem","selectSystem","updateState","SelectedShipSystemList","setSystemList","showOnSystemList","GameSystemTooltipMenu","disabledHandler","onClickHandler","GameSystemInfoMenuStrategy","setSystemInfoMenuProvider","SystemClickShowsSystemMenu","setSystemMenuActiveSystem","SelectedShipEwList","setEwList","UnderHexForShips","showing","ShowMapIcons","showingIcons","showHighligh","shouldShow","hideHighligh","changeScale","gameCamera","showMapIcon","changeToMapView","hideMapIcon","changeToCloseView","showIcons","hideIcons","extraScale","ShowShipBadges","showingName","showShipBadge","showName","hideShipBadge","ShowTorpedoObjects","lines","torpedos","getTorpedoFlights","reachesTargetThisTurn","handleImpactingTorpedo","handleTorpedo","getIconByTorpedoFlight","variance","torpedoPosition","flightId","DeploymentPhaseStrategy","commitDeployment","ReplayPhaseStrategy","WaitingPhaseStrategy","GamePhaseStrategy","commitTurn","ShipVelocityAnimation","positionCurve","ReplayContext","firingDuration","movementDuration","torpedoMovementDuration","velocityDuration","torpedoAttackDuration","unpauseAndRewindAnimation","pauseAnimation","unpauseAnimation","setAnimationTime","getShootingPosition","getEndPosition","ShipWeaponAnimationService","CombatLogShipMovement","replayOrder","CombatLogShipVelocity","CameraPositionAnimation","endTime","lastTime","curve","smoothMove","getLookAtPosition","getPointBetween","doMove","setByLookAtPosition","WeaponHitChange","absoluteResult","rollingPenalty","CombatLogWeaponFireHitResult","hitRoll","CombatLogWeaponFire","fireOrderId","damages","hitResult","ammoName","getDamages","CombatLogGroupedWeaponFire","fire","getSprite","toUpperCase","changeTimeIfNeccessary","texts","inSameHex","getInSameHex","isTooClose","gamePosition","SystemDestroyedTextAnimation","destroyedTexts","destroyedText","ellapsedTime","newPos","fadeTime","TorpedoMovementAnimation","launch","interceptTime","impact","CombatLogTorpedoMove","torpedoFlightId","CombatLogTorpedoAttack","CombatLogGroupedTorpedoAttack","TorpedoExplosionHE","TorpedoExplosionMSV","explosionPosition","setFromAngle","getMovesForShip","ReplayTurnActions","systemDestroyedTextAnimation","startCombatLog","combatLog","getForReplay","buildMovementAnimation","buildVelocityAnimation","buildWeaponFireAnimation","buildTorpedoMoveAnimation","buildTorpedoAttackAnimation","intercepts","interceptPosition","intercept","isSucessfull","animationName","ShipWeaponAnimations","charAt","wrapGetShootingPosition","getVelocityStart","getNextTorpedoAttackStart","fireStart","torpedoEntry","getTorpedoFlightById","addToCombatLog","getInterceptsFor","systemsDestroyed","getDestroyedSystems","getInterceptPosition","buildInterceptAnimation","addTorpedoAttackAnimationDuration","cameraDuration","getTorpedoMovementStart","setTorpedoMovementDuration","getNextFireStart","longestDuration","fireEntry","getFireOrderById","addFireAnimationDuration","setVelocityDuration","getEndMoveForShip","doesMove","setMovementDuration","hideCombatLog","AutomaticReplayPhaseStrategy","replayTurnActions","GameDataCache","replays","currentGameData","lastGameData","replay","newReplay","GameSlot","shipIds","userId","bought","deploymentVector","points","includesShip","GameSlots","teams","userSlot","addSlot","slotData","BoostableSystemStrategy","maxLevel","boostLevel","remainginPower","getPowerRequiredForBoost","canBoost","targetBoostlevel","getStrategiesByInstance","canDeBoost","deBoost","boost","boostableSystemStrategy","ThrustOutputSystemStrategy","output","getOutputReduction","severity","onSystemPowerLevelDecrease","revertMovementsUntilValidMovement","RequiresPowerSystemStrategy","getsCriticals","PowerOutputSystemStrategy","directionsToString","ThrustChannelSystemStrategy","heatPerThrustChanneled","thrustChannelSystemStrategy","thisData","getDirectionString","getChannelOutput","getHeatIncrease","getHeatPerThrustChanneled","getMaxChannelAmount","AllowsEvasionSystemStrategy","typeAsString","ElectronicWarfareProvider","allowedEwTypes","electronicWarfareProvider","getUsageVsOutputText","getTotalEwUsed","getEwOutput","getValidEwTypes","canUseEw","getEwEntry","addAmount","canUseEwType","canUseEwAmount","getUnusedCapacity","repeatElectonicWarfare","LargerHitProfileOnlineSystemStrategy","hitSizeMultiplier","largerHitProfileOnlineSystemStrategy","BoostablePlusOneOutputSystemStrategy","ArmorBoostOfflineSystemStrategy","armorBoost","OutputHeatOnlineStrategy","heatOutput","heatOutputPerBoostLevel","FireOrderHeatStrategy","heatPerFireOrder","AlwaysTargetableSystemStrategy","turnsOfflineToCancel","alwaysTargetableSystemStrategy","StandardHitStrategy","weaponSettings","toHit","addHitResult","finalHexDistanceTo","rangeDistance","getFireControl","onRange","StandardRangeStrategy","currentRange","exactModifier","modifier","difference","CombatLogWeaponOutOfArc","FireOrderStrategy","resolutionPriority","addEntry","setResolved","fireOrderStrategy","StandardLoadingStrategy","firedThisTurn","boostLoading","_getBoostLoading","getLoadingTime","boostPower","loadingPerTurn","_getTurnsUntilLoaded","isLoaded","getLoadingTimeIncrease","standardLoadingStrategy","loadingStep","targetLoading","WeaponArcStrategy","targetHeading","shooterFacing","getArcs","isPositionOnArc","Reactor","TestDamageStrategy","BurstDamageStrategy","shotsFormula","maxShots","grouping","_getNumberOfShots","from","PiercingDamageStrategy","maxDamages","systemsHit","shotsResolved","InterceptorStrategy","numberOfIntercepts","heatPerIntercept","timesIntercepted","interceptTry","torpedoDistanceToTarget","interceptorDistanceToTorpedo","interceptorDistanceToTarget","torpedoHitSize","getHitSize","ManeuveringThruster","Thruster","ManeuveringThrusterLeft","ManeuveringThrusterRight","Engine","EwArray","boostHeat","boostable","CQEWArray","ElintArray","OEWArray","Weapon","alwaysTargetable","TestWeapon","WeaponAnimationStrategy","animationArguments","CoilgunLightFixed","MediumCoilcunTurretedUC","RailgunTurreted64gw","RailgunTurreted32gw","CargoService","cargoBays","getBaysWithSpace","getShipWideCargoSpaceAvailable","AmmunitionStrategy","selectedAmmo","targetLoad","_buildInitialTargetLoad","changeTargetLoad","changeSelectedAmmo","loaded","amountUsed","over","under","toggleSelectedAmmo","onDisabledHandler","ammunitionStrategy","ammoData","clientStrategy","ammoClass","onWeaponFired","getGenericLogEntry","addMessage","_changeSelectedAmmoIfOutOfAmmo","_load","newAmmo","ammoTransferredIn","ammoTransferredOut","cargoService","spaceAvailable","hasSpaceForHowMany","divideCargo","cargoSystem","missing","PDC30mm","RailgunFixed120mm","RailgunTurreted2x140mm","RailgunTurreted140mmUC","TorpedoLauncherStrategy","nextTorpedoClass","changeAmmo","previousTorpedo","launcherData","previousTurnsLoaded","cargoBay","getThisStrategy","receiveAmmoChange","ammoEntry","TorpedoLauncher158","TorpedoLauncherDual72","TorpedoLauncherDual158","TorpedoLauncherQuadruple158","AutoCannon85mm","merged","coilguns","railguns","Radiator","extraProfile","HeatSink","Radiator5x40","Radiator10x40","Radiator10x50","CargoBay","engines","reactors","ewArrays","weapons","UcRhino","addFrontSystem","addPrimarySystem","addAftSystem","description","addStarboardFrontSystem","addPortFrontSystem","addPortAftSystem","addStarboardAftSystem","TestShip","X2PDC30mm","Uc","Protectorate","Test","Federation","createShipObject","GameShips","shipA","shipB","getTeamForShip","getUsersSlots","teamShips","setShipLoadout","GameActiveShips","GameTerrainEntity","actualGravity","gravity","mass","affectedByGravity","bs","bsx","getCacheKey","stage","arkFunction","arkStep","parentPosition","parentMass","dt","setValues","sum","derivativeVelocityX","derivativeVelocityY","findCached","cacheHit","cacheMiss","kx","ky","kvx","kvy","setCache","cache","valueA","ks","getAllKs","dPosition","weightedSum","dVelocity","Vector4","ARK","currentTime","positions","getParentEntity","collision","calculate","MAX_ERROR","fDPosition","fDVelocity","GameTerrain","ark","calculateNewPositionVelocity","GameTorpedos","flights","noLongerActive","CombatLogTorpedoLaunch","CombatLogTorpedoIntercept","interceptChange","CombatLogTorpedoOutOfTime","CombatLogTorpedoNotArmed","combatLogClasses","CombatLogData","torpedoAttack","groupedFires","grouped","groupedTorpedos","GameData","status","phase","players","activePlayerIds","isPlayerActive","slotError","validate","setActive","setInactive","creatorId","setPlayerActive","setActiveShip","torpedoMesh","TorpedoObject","particleEmitter","enginePosition","getEnginePosition","setSine","TorpedoIconContainer","getIconById","PhaseDirector","timeline","shipWindowManager","terrainRenderer","phaseState","gameDataCache","setPhaseDirector","resolvePhaseStrategy","getGameDatasForAutomaticReplay","activatePhaseStrategy","setCurrent","receiveTurnChange","splice","setReplays","canDisturb","onEvent","getCurrent","isPlayerInGame","isReplay","getServices","PositionObject","view","GameSettings","settings","matchEvent","def","keyCode","shiftKey","altKey","ctrlKey","metaKey","populate","ShowAllEW","ShowFriendlyEW","ShowEnemyEW","ZoomLevelToStrategic","localStorage","setItem","JSON","stringify","getItem","parse","GameConnector","webSocket","open","connection","connectionResolve","close","timeout","WebSocket","onerror","onError","onmessage","onMessage","onclose","onClose","onopen","onOpen","send","arguments","connect","receiveGameData","receiveReplay","HexGridRenderer","onZoom","minZoom","maxZoom","GameCamera","ortho","orthoCameraAngle","perspectiveRatio","perspectiveFieldOfView","perspective","perspectiveCameraDistance","closeAngle","setCameraAngle","hypotenuse","opposite","aspect","perspectiveZoom","solvePerspectiveSize","setPerspectiveCameraPositionByLookat","zoomPerspective","updateProjectionMatrix","updateMatrixWorld","perspectivePositionVector","perspectivePosition","toThree","newAngle","currentLookat","GameScene","hexGridRenderer","zoomTarget","cameraAngle","deactivated","light","directionalLight","shadowMap","enabled","moveCamera","addPosition","animationReady","zoomCamera","clearDepth","animateZoom","zoominprogress","newzoom","removeChild","forceContextLoss","Game","gameScene","gameSettings","mouseOvered","mouseOveredHex","changeZoom","gamePos","fromViewPortToGame","getEntitiesIntersected","hexPos","scroll","UIState","renderListeners","systemChangeListeners","lobby","selectedSystems","systemInfo","systemInfoMenu","shipMovement","shipTooltip","turnReady","shipBadges","gameUiMode","gameUiModeButtons","replayUi","systemList","ewList","stateVersion","badge","HEX_SIZE","lowestY","lowestHexas","version","startReplay","waiting","deselectShip","tooltip","listener","FleetList","openShipWindow","onReady","SlotContainer","Slot","edit","take","selectedSlot","isTaken","getPlayerName","isOccupiedBy","LobbySlots","getSlotsByTeams","isBought","mapTeamsToComponents","Faction","buyShip","faction","FleetContainer","FleetStore","factions","LobbyContainer","Lobby","shipClasses","getPointCost","select","prevState","TurnHeaderContainer","ReadySection","TurnHeader","Power","TextRow","Movement","getRemainingThrustOutput","overChannel","ThrustButton","can","RevertButton","CancelButton","PivotButton","RollContainer","RollButton","EvadeContainer","RotatedContainer","Evasion","EvadeButton","canMore","canLess","GameMovement","DeploymentPivotButton","doDeploymentTurn","DeploymentMovementButtons","ReplayButton","GameUiModeButtons","ew","enemy_weapons","toggleGameUiMode","EwList","highlight","LeftPanel","RotatedButton","ReplayUi","rewindToFiring","resumeReplayRewind","pauseReplay","resumeReplay","Highlight","DangerHighlight","HitChangeContainer","HitChange","resolution","DamageContainer","DamageLine","totalDamage","totalArmor","LineContainer","SubLine","IndentedSubline","CombatLogLine","targetName","trim","shooterName","weaponName","getWeaponFireLine","getTorpedoAttackLine","LogContainer","CombatLog","logEntry","ShipBadgeContainer","BackgroundContainer","Icon","BadgeIconAndLabel","BadgeIcon","Badges","WarningBadge","ShipBadge","isMine","missiles","getNumberOfMissilesImpacting","GameStateStore","GameDispatchStore","GameStoreProvider","getReducer","getInitialState","setDispatch","GameUiComponent","getUiState","DeploymentMovement","ReplayUI","GameComponent","match","useState","setUiState","setGame","newUiState","newGame","params","gameid","Logout","logoutUser","pathname","Slots","CreateGame","addPlayer","changeGameName","useCallback","createGameCallBack","PrivateRoute","component","authed","Routes","exact","contextType","App","Router","hostname","ReactDOM","getElementById","navigator","serviceWorker","then","registration","unregister"],"mappings":"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","file":"static/js/main.2fd2f83c.chunk.js","sourcesContent":["const blue = \"#deebff\";\r\nconst darkBlue = \"#04161C\";\r\nconst border = \"#496791\";\r\nconst borderDark = \"#37465a\";\r\nconst text = \"#DEEBFF\";\r\nconst textDanger = \"#da5656\";\r\nconst lightBlue = \"#6daaff\";\r\nconst systemWindowBorder = \"#6e6c6c\";\r\nconst systemWindowPrimaryBorder = \"#aaaaaa\";\r\nconst systemBorder = \"#bebebe\";\r\nconst tooltipButtonColor = \"#3b3b60\";\r\n\r\nexport {\r\n  blue,\r\n  darkBlue,\r\n  border,\r\n  borderDark,\r\n  text,\r\n  textDanger,\r\n  lightBlue,\r\n  systemWindowBorder,\r\n  systemBorder,\r\n  systemWindowPrimaryBorder,\r\n  tooltipButtonColor\r\n};\r\n","import * as React from \"react\";\r\n\r\nclass Arrow extends React.Component {\r\n  render() {\r\n    const { size = \"90%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        id=\"arrow\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 32.75 32.75\"\r\n      >\r\n        <path\r\n          id=\"svg-path\"\r\n          d=\"M30.434,15.938c-0.791,0.933-1.917,1.411-3.052,1.411c-0.913,0-1.834-0.312-2.587-0.951l-4.421-3.753V28.75 c0,2.209-1.791,4-4,4c-2.209,0-4-1.791-4-4V12.646l-4.42,3.754c-1.683,1.431-4.208,1.226-5.639-0.459 c-1.43-1.684-1.224-4.208,0.46-5.638l11.01-9.351c1.493-1.27,3.686-1.27,5.178,0l11.011,9.351 C31.658,11.73,31.863,14.255,30.434,15.938z\"\r\n        />\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Arrow;\r\n","import * as React from \"react\";\r\n\r\nclass ArrowSmall extends React.Component {\r\n  render() {\r\n    const { color = \"#fff\", size = \"100%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        id=\"Capa_1\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 438.533 438.533\"\r\n      >\r\n        <path\r\n          id=\"svg-path\"\r\n          d=\"M409.133,109.203c-19.608-33.592-46.205-60.189-79.798-79.796C295.736,9.801,259.058,0,219.273,0 c-39.781,0-76.47,9.801-110.063,29.407c-33.595,19.604-60.192,46.201-79.8,79.796C9.801,142.8,0,179.489,0,219.267 c0,39.78,9.804,76.463,29.407,110.062c19.607,33.592,46.204,60.189,79.799,79.798c33.597,19.605,70.283,29.407,110.063,29.407 s76.47-9.802,110.065-29.407c33.593-19.602,60.189-46.206,79.795-79.798c19.603-33.596,29.403-70.284,29.403-110.062 C438.533,179.485,428.732,142.795,409.133,109.203z M334.332,232.111L204.71,361.736c-3.617,3.613-7.896,5.428-12.847,5.428 c-4.952,0-9.235-1.814-12.85-5.428l-29.121-29.13c-3.617-3.613-5.426-7.898-5.426-12.847c0-4.941,1.809-9.232,5.426-12.847 l87.653-87.646l-87.657-87.65c-3.617-3.612-5.426-7.898-5.426-12.845c0-4.949,1.809-9.231,5.426-12.847l29.121-29.13 c3.619-3.615,7.898-5.424,12.85-5.424c4.95,0,9.233,1.809,12.85,5.424l129.622,129.621c3.613,3.614,5.42,7.898,5.42,12.847 C339.752,224.213,337.945,228.498,334.332,232.111z\"\r\n          fill={color}\r\n        />\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ArrowSmall;\r\n","import * as React from \"react\";\r\n\r\nclass Roll extends React.Component {\r\n  render() {\r\n    const { color = \"#fff\", size = \"100%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        id=\"roll\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        viewBox=\"0 0 420.995 420.995\"\r\n        width={size}\r\n        height={size}\r\n      >\r\n        <g fill=\"#010002\">\r\n          <path\r\n            id=\"svg-path\"\r\n            d=\"M127.505,196.313c22.15,0,27.45-12.827,11.77-28.458l-31.165-31.197 c4.406-6.194,9.234-12.006,14.599-17.257c1.878-1.788,3.796-3.512,5.763-5.17c2.3-2.008,4.715-3.861,7.145-5.698 c2.146-1.561,4.292-3.146,6.487-4.593c3.65-2.341,7.364-4.511,11.226-6.454c1.723-0.87,3.438-1.626,5.194-2.439 c4.04-1.837,8.202-3.471,12.494-4.926c0.845-0.236,1.626-0.602,2.463-0.845c5.194-1.561,10.478-2.707,15.875-3.617 c1.39-0.244,2.78-0.455,4.17-0.634c5.601-0.764,11.25-1.301,17.013-1.301c0.179,0,0.358,0.065,0.536,0.065 c4.113,0,8.096,0.171,12.103,0.593c1.967,0.187,3.861,0.585,5.763,0.862c2.292,0.358,4.552,0.593,6.755,1.024 c1.626,0.366,3.195,0.813,4.771,1.203c2.552,0.602,5.154,1.211,7.657,2.016c1.138,0.333,2.235,0.813,3.349,1.179 c2.991,1.032,5.918,2.057,8.787,3.325c14.534,6.218,27.946,15.2,39.464,26.735c12.372,12.315,21.85,26.784,28.182,42.927 c6.942,17.607,26.776,26.223,44.358,19.313c17.623-6.901,26.255-26.751,19.305-44.317c-9.779-24.987-24.435-47.325-43.447-66.329 c-17.322-17.289-37.416-30.775-59.143-40.399c-0.301-0.154-0.536-0.333-0.845-0.455c-0.252-0.122-0.488-0.187-0.732-0.301 c-4.885-2.089-9.868-3.894-14.932-5.584c-1.211-0.423-2.382-0.935-3.617-1.292c-4.804-1.52-9.665-2.731-14.55-3.812 c-1.544-0.366-3.073-0.87-4.617-1.171c-4.885-0.992-9.836-1.65-14.81-2.252c-1.544-0.187-3.048-0.553-4.625-0.732 c-6.519-0.634-13.152-0.975-19.785-0.975c-0.358,0-0.788,0.065-1.179,0.065c-5.462,0-10.835,0.309-16.151,0.788 c-1.861,0.13-3.739,0.366-5.601,0.602c-4.081,0.488-8.12,1.097-12.128,1.821c-1.813,0.301-3.585,0.626-5.373,0.992 c-5.064,1.057-10.136,2.325-15.054,3.78c-0.463,0.146-0.943,0.236-1.423,0.382c-5.796,1.756-11.469,3.837-17.013,6.096 c-0.585,0.219-1.089,0.488-1.634,0.699c-5.259,2.227-10.437,4.674-15.452,7.332c-0.333,0.154-0.658,0.325-1.016,0.504 C95.69,50.6,75.409,67.191,58.997,87.602l-30.539-30.58C12.803,41.391,0,46.674,0,68.825v87.211 c0,22.183,18.102,40.277,40.228,40.277C40.228,196.313,127.505,196.313,127.505,196.313z\"\r\n            fill={color}\r\n          />\r\n          <path\r\n            id=\"svg-path\"\r\n            d=\"M380.783,224.706h-87.268c-22.118,0-27.393,12.786-11.77,28.45l31.197,31.206 c-4.406,6.121-9.161,11.86-14.542,17.111c-1.902,1.861-3.894,3.642-5.918,5.357c-2.235,1.935-4.536,3.715-6.844,5.43 c-2.3,1.691-4.593,3.406-6.999,4.926c-3.536,2.252-7.153,4.373-10.9,6.235c-1.74,0.894-3.495,1.723-5.267,2.536 c-4.024,1.821-8.12,3.438-12.282,4.828c-0.91,0.301-1.756,0.658-2.658,0.91c-5.162,1.593-10.445,2.715-15.843,3.617 c-1.39,0.236-2.812,0.423-4.202,0.658c-5.568,0.699-11.217,1.203-16.948,1.203c-4.284,0-8.511-0.179-12.729-0.602 c-1.788-0.179-3.56-0.536-5.316-0.788c-2.406-0.301-4.82-0.658-7.243-1.122c-1.504-0.26-3.016-0.788-4.519-1.105 c-2.626-0.675-5.251-1.276-7.852-2.065c-1.146-0.366-2.268-0.845-3.438-1.203c-2.894-1.024-5.763-2.048-8.633-3.284 c-14.534-6.243-27.97-15.2-39.489-26.702c-12.404-12.429-21.874-26.881-28.214-42.96c-6.877-17.623-26.767-26.255-44.358-19.346 c-17.566,6.917-26.263,26.767-19.313,44.39c9.803,24.857,24.435,47.186,43.504,66.248c17.322,17.33,37.391,30.848,59.144,40.383 c0.301,0.171,0.545,0.358,0.813,0.455c0.236,0.146,0.496,0.203,0.707,0.293c4.999,2.187,10.136,4.056,15.314,5.771 c1.097,0.358,2.113,0.813,3.211,1.154c4.975,1.561,10.047,2.772,15.135,3.95c1.333,0.317,2.658,0.723,4.048,0.992 c5.121,1.089,10.405,1.813,15.688,2.414c1.26,0.179,2.463,0.455,3.707,0.569c6.544,0.634,13.12,1.032,19.793,1.032 c0.358,0,0.691-0.073,1.049-0.073c5.527-0.033,10.99-0.325,16.387-0.813c1.788-0.154,3.601-0.366,5.406-0.577 c4.17-0.504,8.299-1.105,12.396-1.845c1.723-0.293,3.406-0.626,5.105-0.984c5.243-1.065,10.437-2.357,15.509-3.894 c0.358-0.057,0.658-0.163,1.024-0.236c5.82-1.756,11.591-3.869,17.2-6.153l1.325-0.585c5.373-2.219,10.616-4.731,15.753-7.446 c0.268-0.154,0.545-0.301,0.845-0.455c22.809-12.193,43.09-28.783,59.509-49.21l30.539,30.531 c15.664,15.696,28.45,10.372,28.45-11.762v-87.187C421.011,242.801,402.901,224.706,380.783,224.706z\"\r\n            fill={color}\r\n          />\r\n        </g>\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Roll;\r\n","import * as React from \"react\";\r\n\r\nclass X extends React.Component {\r\n  render() {\r\n    const { color = \"#fff\", size = \"80%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        id=\"Capa_1\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 348.333 348.334\"\r\n      >\r\n        <path\r\n          id=\"svg-path\"\r\n          d=\"M336.559,68.611L231.016,174.165l105.543,105.549c15.699,15.705,15.699,41.145,0,56.85 c-7.844,7.844-18.128,11.769-28.407,11.769c-10.296,0-20.581-3.919-28.419-11.769L174.167,231.003L68.609,336.563 c-7.843,7.844-18.128,11.769-28.416,11.769c-10.285,0-20.563-3.919-28.413-11.769c-15.699-15.698-15.699-41.139,0-56.85 l105.54-105.549L11.774,68.611c-15.699-15.699-15.699-41.145,0-56.844c15.696-15.687,41.127-15.687,56.829,0l105.563,105.554 L279.721,11.767c15.705-15.687,41.139-15.687,56.832,0C352.258,27.466,352.258,52.912,336.559,68.611z\"\r\n          fill={color}\r\n        />\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default X;\r\n","import * as React from \"react\";\r\n\r\nclass Evade extends React.Component {\r\n  render() {\r\n    const { color = \"#fff\", size = \"100%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        viewBox=\"0 0 512 512\"\r\n        width={size}\r\n        height={size}\r\n      >\r\n        <path\r\n          id=\"svg-path\"\r\n          d=\"M501.608,384.478L320.497,51.476C291.376,2.451,220.139,2.41,191.21,52.003L10.647,383.951 c-29.706,49.989,6.259,113.291,64.482,113.291h361.689C495.436,497.242,530.688,433.393,501.608,384.478z M331,332.242 c0,22.516-23.688,36.693-43.403,26.836L211,320.787v101.455c0,8.284-6.716,15-15,15h-30c-8.284,0-15-6.716-15-15v-150 c0-22.516,23.69-36.667,43.418-26.836L271,283.698V182.242c0-8.286,6.716-15,15-15h30c8.284,0,15,6.714,15,15V332.242z\"\r\n          fill={color}\r\n        />\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Evade;\r\n\r\n/*\r\n<svg xmlns='http://www.w3.org/2000/svg' id='Capa_1' viewBox='0 0 214.32 214.32'\r\nwidth='512' height='512'>\r\n    <path d='M183.673,128.681c-8.297,9.305-19.722,14.821-32.169,15.534c-12.432,0.712-24.425-3.466-33.73-11.764L81.312,99.937 c-8.919-7.954-22.649-7.17-30.603,1.751l-1.404,1.574c-7.953,8.919-7.167,22.647,1.752,30.602l35.191,31.382l5.02-5.532 c2.399-2.645,6.031-3.81,9.521-3.054c3.492,0.756,6.315,3.317,7.406,6.72l11.951,37.267c0.449,1.137,0.696,2.377,0.696,3.675 c0,5.488-4.421,9.943-9.896,9.999c-0.041,0.001-0.082,0.001-0.124,0.001c-0.704,0-1.413-0.074-2.116-0.227l-38.887-8.422 c-3.492-0.756-6.315-3.317-7.406-6.72s-0.284-7.128,2.117-9.773l4.917-5.419l-35.031-31.238 c-19.208-17.129-20.899-46.691-3.771-65.899l1.404-1.574c17.127-19.207,46.688-20.899,65.898-3.77l36.462,32.515 c8.92,7.954,22.648,7.17,30.603-1.751c7.954-8.92,7.168-22.647-1.751-30.602L126.96,49.067l-5.027,5.54 c-1.916,2.112-4.617,3.28-7.405,3.28c-0.704,0-1.413-0.074-2.117-0.227c-3.491-0.756-6.314-3.317-7.405-6.72L92.856,13.054 c-1.091-3.402-0.284-7.128,2.117-9.773c2.399-2.645,6.032-3.81,9.521-3.054l38.887,8.421c3.492,0.756,6.315,3.317,7.406,6.72 s0.284,7.128-2.117,9.773l-4.911,5.412l36.142,32.23C199.11,79.911,200.802,109.474,183.673,128.681z'\r\n    fill='#D80027' />\r\n</svg>\r\n*/\r\n","import * as React from \"react\";\r\n\r\nclass Pivot extends React.Component {\r\n  render() {\r\n    const { color = \"#fff\", size = \"100%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        id=\"pivot\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 511.612 511.612\"\r\n      >\r\n        <path\r\n          id=\"svg-path\"\r\n          d=\"M433.822,126.876l-113.28-113.28c-18.048-18.112-49.632-18.144-67.744,0c-18.752,18.752-18.752,49.312,0,68.064 l29.984,29.952h-18.976c-110.272,0-200,89.728-200,200s89.728,200,200,200h8c8.832,0,16-7.168,16-16v-64c0-8.832-7.168-16-16-16 h-8c-57.344,0-104-46.656-104-104s46.656-104,104-104h21.216l-32.224,32.192c-18.752,18.784-18.752,49.312,0,68.064 c17.984,17.952,50.304,17.536,67.744,0l113.312-113.28c8.864-8.896,13.952-21.152,13.952-33.696 C447.806,148.444,442.974,136.476,433.822,126.876z\"\r\n          fill={color}\r\n        />\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Pivot;\r\n","import * as React from \"react\";\r\n\r\nclass Cancel extends React.Component {\r\n  render() {\r\n    const { color = \"#fff\", size = \"90%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        id=\"cancel\"\r\n        viewBox=\"0 0 512 512\"\r\n        width={size}\r\n        height={size}\r\n      >\r\n        <path\r\n          id=\"svg-path\"\r\n          d=\"M256,0C114.833,0,0,114.844,0,256s114.833,256,256,256s256-114.844,256-256S397.167,0,256,0z M256,426.667 c-94.104,0-170.667-76.563-170.667-170.667c0-31.596,8.785-61.112,23.814-86.52L342.52,402.853 C317.112,417.882,287.596,426.667,256,426.667z M402.853,342.52L169.48,109.147c25.408-15.029,54.923-23.814,86.52-23.814 c94.104,0,170.667,76.563,170.667,170.667C426.667,287.596,417.882,317.112,402.853,342.52z\"\r\n          fill={color}\r\n        />\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Cancel;\r\n","import * as React from \"react\";\r\n\r\nclass CheckMark extends React.Component {\r\n  render() {\r\n    const { color = \"#fff\", size = \"90%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        id=\"CheckMark\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 442.533 442.533\"\r\n      >\r\n        <path\r\n          d=\"M434.539,98.499l-38.828-38.828c-5.324-5.328-11.799-7.993-19.41-7.993c-7.618,0-14.093,2.665-19.417,7.993L169.59,247.248 l-83.939-84.225c-5.33-5.33-11.801-7.992-19.412-7.992c-7.616,0-14.087,2.662-19.417,7.992L7.994,201.852 C2.664,207.181,0,213.654,0,221.269c0,7.609,2.664,14.088,7.994,19.416l103.351,103.349l38.831,38.828 c5.327,5.332,11.8,7.994,19.414,7.994c7.611,0,14.084-2.669,19.414-7.994l38.83-38.828L434.539,137.33 c5.325-5.33,7.994-11.802,7.994-19.417C442.537,110.302,439.864,103.829,434.539,98.499z\"\r\n          fill={color}\r\n        />\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CheckMark;\r\n","import React from \"react\";\r\n\r\nclass Play extends React.PureComponent {\r\n  render() {\r\n    const { color = \"#fff\", size = \"100%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 373.008 373.008\"\r\n      >\r\n        <path\r\n          d=\"M61.792 2.588A19.258 19.258 0 0171.444 0c3.33 0 6.663.864 9.655 2.588l230.116 167.2a19.327 19.327 0 019.656 16.719 19.293 19.293 0 01-9.656 16.713L81.099 370.427a19.336 19.336 0 01-19.302 0 19.333 19.333 0 01-9.66-16.724V19.305a19.308 19.308 0 019.655-16.717z\"\r\n          fill={color}\r\n        ></path>\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Play;\r\n","import React from \"react\";\r\n\r\nclass Pause extends React.PureComponent {\r\n  render() {\r\n    const { color = \"#fff\", size = \"100%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 792 792\"\r\n      >\r\n        <path\r\n          d=\"M282.856 0H169.714c-31.228 0-56.571 25.344-56.571 56.571v678.857c0 31.228 25.344 56.571 56.571 56.571h113.143c31.256 0 56.572-25.315 56.572-56.571V56.571C339.428 25.344 314.112 0 282.856 0zm339.429 0H509.143c-31.256 0-56.572 25.344-56.572 56.571v678.857c0 31.228 25.316 56.571 56.572 56.571h113.143c31.256 0 56.572-25.315 56.572-56.571V56.571C678.857 25.344 653.541 0 622.285 0z\"\r\n          fill={color}\r\n        ></path>\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Pause;\r\n","import React from \"react\";\r\n\r\nclass Replay extends React.PureComponent {\r\n  render() {\r\n    const { color = \"#fff\", size = \"100%\" } = this.props;\r\n\r\n    return (\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width={size}\r\n        height={size}\r\n        viewBox=\"0 0 400.548 400.548\"\r\n      >\r\n        <path\r\n          d=\"M383.86 99.79a27.04 27.04 0 00-29.466 5.86l-51.507 51.512v-31.397c0-22.359-18.13-40.491-40.493-40.491H40.493C18.131 85.274 0 103.406 0 125.765v149.018c0 22.359 18.131 40.491 40.493 40.491h221.901c22.363 0 40.493-18.132 40.493-40.491v-31.398l51.507 51.512a27.04 27.04 0 0019.126 7.924c3.481 0 6.995-.678 10.34-2.063a27.04 27.04 0 0016.688-24.978V124.767A27.037 27.037 0 00383.86 99.79zM190.309 210.764l-55.191 42.403a13.21 13.21 0 01-8.06 2.738 13.223 13.223 0 01-13.226-13.228V157.87a13.22 13.22 0 017.38-11.864 13.22 13.22 0 0113.905 1.375l55.191 42.402a13.228 13.228 0 01.001 20.981z\"\r\n          fill={color}\r\n        ></path>\r\n      </svg>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Replay;\r\n","import styled from \"styled-components\";\r\n\r\nconst IconAndLabel = styled.div`\r\n  position: relative;\r\n  box-sizing: border-box;\r\n  width: 30px;\r\n  height: 30px;\r\n\r\n  background-color: \"transparent\";\r\n  background-image: ${props => `url(${props.background})`};\r\n  background-size: cover;\r\n  display: flex;\r\n  align-items: flex-end;\r\n  justify-content: center;\r\n  font-family: arial;\r\n  font-size: 10px;\r\n`;\r\n\r\nexport default IconAndLabel;\r\n","import styled, { css } from \"styled-components\";\nimport { darkBlue } from \"./Colors\";\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  border: 1px solid #496791;\n  color: #deebff;\n  background-color: #0a3340;\n  font-family: arial;\n  margin-bottom: 10px;\n\n  :last-child {\n    margin-bottom: 0;\n  }\n`;\n\nconst Backdrop = styled.div`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: 99999;\n  background-color: rgba(0, 0, 0, 0.5);\n`;\n\nconst ContainerRoundedRightBottom = styled(Container)`\n  border-radius: 0px 0px 30px 0px;\n  box-shadow: 5px 5px 10px black;\n`;\n\nconst ContainerRounded = styled(Container)`\n  border-radius: 0px 0px 30px 30px;\n  box-shadow: 5px 5px 10px black;\n`;\n\nconst ContainerRoundedRightSide = styled(Container)`\n  border-radius: 30px 0px 0px 30px;\n  box-shadow: 5px 5px 10px black;\n`;\n\nconst defaultPadding = css`\n  padding: 10px;\n`;\n\nconst defaultWidth = css`\n  width: 500px;\n`;\n\nconst DarkContainer = styled(Container)`\n  ${defaultPadding}\n  background-color: ${darkBlue}\n`;\n\nconst PanelContainer = styled(Container)`\n  ${defaultPadding}\n  ${defaultWidth}\n  border-radius: 5px;\n  margin: 30px auto;\n`;\n\nconst Section = styled.div`\n  display: flex;\n  margin: 0;\n  padding: 0;\n  flex-wrap: wrap;\n`;\n\nconst SectionRight = styled(Section)`\n  flex-grow: 1;\n  justify-content: flex-end;\n`;\n\nconst Cell50 = styled.div`\n  display: flex;\n  margin: 0 8px;\n  flex-grow: 1;\n  flex-basis: calc(50% - 16px);\n`;\n\nexport {\n  Cell50,\n  Container,\n  ContainerRoundedRightBottom,\n  Backdrop,\n  ContainerRounded,\n  ContainerRoundedRightSide,\n  defaultPadding,\n  PanelContainer,\n  DarkContainer,\n  Section,\n  SectionRight\n};\n","import styled from \"styled-components\";\r\nimport { lightBlue } from \"./Colors\";\r\n\r\nconst Paragraph = styled.p`\r\n  font-family: arial;\r\n  font-size: 12px;\r\n  color: #deebff;\r\n  padding: 10px;\r\n`;\r\n\r\nconst Label = styled.span`\r\n  display: flex;\r\n  font-family: arial;\r\n  font-size: 12px;\r\n  color: #deebff;\r\n  padding: 10px;\r\n`;\r\n\r\nconst Value = styled.span`\r\n  color: ${lightBlue};\r\n  padding: 0;\r\n  margin: 0;\r\n  padding-left: 5px;\r\n`;\r\n\r\nexport { Paragraph, Label, Value };\r\n","import styled from \"styled-components\";\n\nconst Title = styled.span`\n  font-family: arial;\n  font-size: 16px;\n  text-transform: uppercase;\n  color: #deebff;\n  padding: 10px;\n  font-weight: bold;\n`;\n\nconst SubTitle = styled(Title)`\n  font-weight: normal;\n`;\n\nexport { Title, SubTitle };\n","import { css } from \"styled-components\";\n\nconst Clickable = css`\n  ${props => !props.disabled && \"cursor: pointer;\"}\n\n  &:hover {\n    text-shadow: white 0 0 10px, white 0 0 3px;\n    opacity: 2;\n    ${props => props.disabled && \"opacity: 0.5;\"}\n    color: #deebff;\n  }\n`;\n\nexport { Clickable };\n","import styled from \"styled-components\";\r\nimport { Section, colors } from \".\";\r\n\r\nconst Error = styled(Section)`\r\n  color: ${colors.textDanger};\r\n  font-size: 12px;\r\n  height: 18px;\r\n  overflow: hidden;\r\n  font-weight: bolder;\r\n`;\r\n\r\nexport { Error };\r\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport { Section } from \".\";\nimport { Error } from \"./Error\";\n\nclass InputAndLabel extends React.Component {\n  render() {\n    const {\n      id,\n      label,\n      type,\n      value,\n      placeholder,\n      onKeyDown,\n      onChange,\n      error,\n      ...rest\n    } = this.props;\n\n    return (\n      <Container>\n        <SubContainer>\n          {label && <Label htmlFor={id}>{label}</Label>}\n          <Input\n            id={id}\n            type={type || \"text\"}\n            value={value}\n            placeholder={placeholder}\n            onKeyDown={onKeyDown}\n            onChange={onChange}\n            tabIndex=\"0\"\n            {...rest}\n          />\n        </SubContainer>\n        <Error>{error}</Error>\n      </Container>\n    );\n  }\n}\n\nconst Container = styled.div`\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column;\n  flex-grow: 1;\n  margin: 5px 0px;\n`;\n\nconst SubContainer = styled.div`\n  position: relative;\n  display: flex;\n  flex: 1 1 100%;\n  margin: 0;\n  padding: 0;\n  flex-wrap: wrap;\n  align-items: center;\n`;\n\nconst Label = styled.div`\n  display: flex;\n  max-width: 300px;\n  color: #deebff;\n  align-items: center;\n  padding: 4px 10px 4px 0;\n`;\n\nconst Input = styled.input`\n  display: flex;\n  color: #0a3340;\n  background-color: white;\n  padding: 3px 6px;\n  border: 1px solid #04161c;\n  border-radius: 3px;\n  width: calc(70% - 12px);\n  height: 16px;\n\n  min-width: 150px;\n  max-width: 100%;\n  flex-grow: 1;\n`;\n\nexport { InputAndLabel };\n","import * as React from \"react\";\nimport styled, { css } from \"styled-components\";\nimport { colors } from \"./index\";\nimport { tooltipButtonColor } from \"./Colors\";\n\nclass Component extends React.Component {\n  render() {\n    const { children, className } = this.props;\n    return <div className={className}>{children}</div>;\n  }\n}\n\nconst TooltipContainer = styled(Component)`\n  opacity: 0.95;\n  text-align: center;\n  font-family: arial;\n  font-size: 12px;\n  color: white;\n  background-color: black;\n  border-radius: 7px;\n  -moz-border-radius: 7px;\n  -webkit-border-radius: 7px;\n  padding: 3px 8px 8px 8px;\n  border: 1px solid #121212;\n  filter: brightness(1);\n  cursor: initial;\n`;\n\nconst Tooltip = styled(TooltipContainer)`\n  z-index: 7001;\n  position: absolute;\n`;\n\nconst RelativeTooltipContainer = styled(Tooltip)`\n  position: absolute;\n  z-index: 20000;\n  ${props =>\n    Object.keys(props.position).reduce((style, key) => {\n      return style + \"\\n\" + key + \":\" + props.position[key] + \"px;\";\n    }, \"\")}\n  text-align: left;\n  filter: brightness(1);\n`;\n\nconst TooltipValue = styled.div`\n  color: ${colors.lightBlue};\n`;\n\nexport class RelativeTooltip extends React.Component {\n  render() {\n    const { element, children, ...rest } = this.props;\n\n    const getPosition = element => {\n      const boundingBox = element.getBoundingClientRect\n        ? element.getBoundingClientRect()\n        : element.get(0).getBoundingClientRect();\n\n      const position = {};\n\n      if (boundingBox.top > window.innerHeight / 2) {\n        position.bottom = 32;\n      } else {\n        position.top = 32;\n      }\n\n      if (boundingBox.left > window.innerWidth / 2) {\n        position.right = 0;\n      } else {\n        position.left = 0;\n      }\n\n      return position;\n    };\n\n    return (\n      <RelativeTooltipContainer position={getPosition(element)} {...rest}>\n        {children}\n      </RelativeTooltipContainer>\n    );\n  }\n}\n\nconst TooltipHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  text-transform: uppercase;\n  border-bottom: 1px solid #aaaaaa;\n  width: calc(100% - 16px);\n  margin: 5px 8px;\n  font-weight: bold;\n  font-size: 12px;\n`;\n\nconst TooltipSubHeader = styled.div`\n  display: flex;\n  border-bottom: 1px solid #aaaaaa;\n  width: calc(100% - 16px);\n  margin: 5px 8px;\n  font-weight: bold;\n  font-size: 12px;\n  color: white;\n`;\n\nconst TooltipValueHeader = styled.div`\n  padding-right: 5px;\n  color: white;\n`;\n\nconst TooltipEntry = styled.div`\n  display: flex;\n  box-sizing: border-box;\n  margin: 2px 8px;\n\n  ${props => props.noMargin && \"margin: 0;\"}\n  font-weight: ${props => (props.important ? \"bold\" : \"inherit\")};\n  font-size: ${props => (props.important ? \"14px\" : \"11px\")};\n  ${props => props.space && \"margin-top: 14px\"};\n  text-align: left;\n  color: #5e85bc;\n  font-family: arial;\n  \n  ${props =>\n    props.clickable &&\n    css`\n      cursor: pointer;\n      color: white;\n      background-color: ${tooltipButtonColor};\n      border: 1px solid black;\n    `}\n\n  &:hover {\n    ${props =>\n      props.clickable &&\n      css`\n        border: 1px solid white;\n      `}\n  }\n`;\n\nconst CenteredTooltipEntry = styled(TooltipEntry)`\n  justify-content: center;\n  ${TooltipValueHeader} {\n    padding-right: 0;\n  }\n`;\n\nconst InlineTooltipEntry = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n`;\n\nconst TooltipMenu = styled.div`\n  margin: 0 8px;\n  display: flex;\n`;\n\nconst selectedTooltipButton = css`\n  filter: brightness(5) grayscale(100%);\n  opacity: 1;\n`;\n\nconst disabledTooltipButton = css`\n  filter: brightness(0.25) grayscale(100%);\n`;\n\nconst hoverTooltipButton = css`\n  opacity: 1;\n  filter: brightness(5) grayscale(100%);\n`;\n\nconst TooltipButton = styled.button`\n  border: none;\n  width: 40px;\n  height: 40px;\n  background-color: transparent;\n  margin: 0;\n  cursor: pointer;\n  background-image: ${props => props.img && `url(${props.img})`};\n  background-size: cover;\n  opacity: 0.5;\n  filter: brightness(3) grayscale(100%);\n\n  ${props => props.selected && !props.disabled && selectedTooltipButton}\n\n  ${props => props.disabled && disabledTooltipButton}\n\n  &:hover {\n    ${props => !props.disabled && hoverTooltipButton}\n  }\n\n  &:focus {\n    outline: 0;\n  }\n\n  svg #svg-path {\n    fill: white;\n    ${props => props.disabled && \"fill:#ff0000;\"}\n  }\n`;\n\nconst buildTooltipEntries = (entries, subKey = \"\") => {\n  return entries\n    .sort((a, b) => {\n      if (!a.sort && b.sort) {\n        return 1;\n      }\n\n      if (a.sort && !b.sort) {\n        return -1;\n      }\n\n      if (a.sort > b.sort) {\n        return 1;\n      }\n\n      if (a.sort < b.sort) {\n        return -1;\n      }\n\n      return 0;\n    })\n    .map(({ value, header }, index) => {\n      if (value && value.replace) {\n        value = value.replace(/<br>/gm, \"\\n\");\n      }\n\n      return (\n        <TooltipEntry\n          noMargin={subKey !== \"\"}\n          key={`shiptoolitip-${index}-${subKey}`}\n        >\n          {header && <TooltipValueHeader>{header}: </TooltipValueHeader>}\n          {value && Array.isArray(value) && (\n            <InlineTooltipEntry>\n              {buildTooltipEntries(value, subKey + \"-\" + index)}\n            </InlineTooltipEntry>\n          )}\n          {value && !Array.isArray(value) && (\n            <TooltipValue>{value}</TooltipValue>\n          )}\n        </TooltipEntry>\n      );\n    });\n};\n\nexport {\n  TooltipContainer,\n  buildTooltipEntries,\n  Tooltip,\n  TooltipHeader,\n  TooltipEntry,\n  TooltipMenu,\n  TooltipButton,\n  TooltipSubHeader,\n  TooltipValue,\n  TooltipValueHeader,\n  InlineTooltipEntry,\n  CenteredTooltipEntry\n};\n","import styled, { css } from \"styled-components\";\r\nimport React from \"react\";\r\n\r\nconst text = css`\r\n  display: inline;\r\n  border: none;\r\n  background-color: transparent;\r\n  color: #deebff;\r\n\r\n  &:hover,\r\n  &:active {\r\n    text-shadow: white 0 0 10px, white 0 0 3px;\r\n    opacity: 2;\r\n    color: #deebff;\r\n  }\r\n`;\r\n\r\nconst greyButton = css`\r\n  background-color: #222;\r\n  padding: 5px 0px;\r\n  color: white;\r\n  text-decoration: none;\r\n  font-family: arial;\r\n  font-size: 12px;\r\n  text-transform: uppercase;\r\n  display: flex;\r\n  flex-grow: 1;\r\n  flex-basis: 100%;\r\n  border: none;\r\n  margin: 0;\r\n\r\n  justify-content: center;\r\n\r\n  &:hover,\r\n  &:active {\r\n    background-color: #deebff;\r\n    color: black;\r\n    text-decoration: none;\r\n  }\r\n`;\r\n\r\nconst iconStyle = css`\r\n  display: flex;\r\n  border: 0;\r\n  padding: 3px;\r\n  font-weight: bold;\r\n  font-size: 16px;\r\n  background-color: transparent;\r\n\r\n  &:hover,\r\n  &:active {\r\n    color: #0a3340;\r\n  }\r\n`;\r\n\r\nconst button = css`\r\n  display: flex;\r\n  text-transform: uppercase;\r\n  color: #0a3340;\r\n  border: 1px solid black;\r\n  background-color: #6792ce;\r\n  max-width: 240px;\r\n  justify-content: center;\r\n  box-shadow: 2px 3px 5px 2px rgba(0, 0, 0, 0.5);\r\n  border-radius: 1px;\r\n  padding: 3px;\r\n  font-weight: bold;\r\n  font-size: 16px;\r\n\r\n  &:hover,\r\n  &:active {\r\n    box-shadow: 0px 0px 3px 3px rgba(222, 235, 255, 0.5);\r\n    color: #0a3340;\r\n    background-color: #deebff;\r\n  }\r\n`;\r\n\r\nconst IconContainer = styled.div`\r\n  width: 25px;\r\n  height: 25px;\r\n`;\r\n\r\nconst ButtonContainer = styled.button`\r\n  display: flex;\r\n  cursor: pointer;\r\n  position: relative;\r\n  margin: 3px 5px;\r\n\r\n  ${props => {\r\n    if (props.icon) {\r\n      return iconStyle;\r\n    }\r\n    switch (props.buttonStyle) {\r\n      case \"text\":\r\n        return text;\r\n      case \"button-grey\":\r\n        return greyButton;\r\n      default:\r\n        return button;\r\n    }\r\n  }}\r\n`;\r\n\r\nconst Button = props => (\r\n  <ButtonContainer {...props}>\r\n    {props.icon && (\r\n      <IconContainer>\r\n        <props.icon color=\"#deebff\" />\r\n      </IconContainer>\r\n    )}\r\n    {props.children}\r\n  </ButtonContainer>\r\n);\r\n\r\nexport { Button };\r\n","import styled from \"styled-components\";\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\n\r\nconst Link = styled(RouterLink)`\r\n  text-decoration: none;\r\n`;\r\n\r\nexport { Link };\r\n","import THREE from \"three\";\r\n\r\nconst HEX_SIZE = 12.5;\r\nconst ZOOM_MAX = 40;\r\nconst ZOOM_MIN = 0.05;\r\nconst ZOOM_PERSPECTIVE_MIN = 100;\r\nconst ZOOM_FOR_MAPICONS = 4;\r\nconst ZOOM_FOR_SHIPBADGE = 2;\r\nconst ZOOM_FOR_SHIPBADGE_NAME = 0.5;\r\n\r\nconst TORPEDO_Z = 30;\r\n\r\nconst COLOR_FRIENDLY = new THREE.Color(0 / 255, 138 / 255, 255 / 255); //new THREE.Color(39 / 255, 196 / 255, 39 / 255);\r\nconst COLOR_ENEMY = new THREE.Color(196 / 255, 39 / 255, 39 / 255);\r\nconst COLOR_FRIENDLY_HIGHLIGHT = COLOR_FRIENDLY.clone().multiplyScalar(1.5);\r\nconst COLOR_ENEMY_HIGHLIGHT = COLOR_ENEMY.clone().multiplyScalar(1.5);\r\n\r\nconst COLOR_OEW_FRIENDLY = new THREE.Color(160 / 255, 150 / 255, 250 / 255);\r\nconst COLOR_OEW_ENEMY = new THREE.Color(255 / 255, 40 / 255, 40 / 255);\r\n\r\nexport {\r\n  HEX_SIZE,\r\n  ZOOM_MAX,\r\n  ZOOM_MIN,\r\n  COLOR_FRIENDLY,\r\n  COLOR_ENEMY,\r\n  ZOOM_FOR_MAPICONS,\r\n  COLOR_FRIENDLY_HIGHLIGHT,\r\n  COLOR_ENEMY_HIGHLIGHT,\r\n  COLOR_OEW_FRIENDLY,\r\n  COLOR_OEW_ENEMY,\r\n  ZOOM_FOR_SHIPBADGE,\r\n  ZOOM_FOR_SHIPBADGE_NAME,\r\n  ZOOM_PERSPECTIVE_MIN,\r\n  TORPEDO_Z\r\n};\r\n","import Cube from \"./Cube.mjs\";\n\nconst NEIGHBOURS = [\n  [\n    { q: 1, r: 0 },\n    { q: 1, r: -1 },\n    { q: 0, r: -1 },\n    { q: -1, r: 0 },\n    { q: 0, r: 1 },\n    { q: 1, r: 1 }\n  ],\n  [\n    { q: 1, r: 0 },\n    { q: 0, r: -1 },\n    { q: -1, r: -1 },\n    { q: -1, r: 0 },\n    { q: -1, r: 1 },\n    { q: 0, r: 1 }\n  ]\n];\n\nclass Offset {\n  constructor(q, r) {\n    if (q === undefined) {\n      console.trace();\n    }\n    if (q instanceof Offset || (q.q !== undefined && q.r !== undefined)) {\n      const offset = q;\n      this.q = offset.q;\n      this.r = offset.r;\n    } else {\n      this.q = q;\n      this.r = r;\n    }\n  }\n\n  getNeighbours() {\n    var neighbours = [];\n\n    NEIGHBOURS[this.r & 1].forEach(function(neighbour) {\n      neighbours.push(this.add(new Offset(neighbour)));\n    }, this);\n\n    return neighbours;\n  }\n\n  getNeighbourAtHeading(heading) {\n    if (heading >= 330 || heading <= 30) {\n      return this.add(new Offset(1, 0));\n    } else if (heading >= 150 && heading <= 210) {\n      return this.add(new Offset(-1, 0));\n    } else if (heading > 30 && heading < 90) {\n      return this.add(new Offset(1, -1));\n    } else if (heading >= 90 && heading < 150) {\n      return this.add(new Offset(0, -1));\n    } else if (heading > 210 && heading <= 270) {\n      return this.add(new Offset(0, 1));\n    } else if (heading > 270 && heading < 330) {\n      return this.add(new Offset(1, 1));\n    }\n  }\n\n  add(offset) {\n    return this.toCube()\n      .add(offset.toCube())\n      .toOffset();\n  }\n\n  subtract(offset) {\n    return this.toCube()\n      .subtract(offset.toCube())\n      .toOffset();\n  }\n\n  scale(scale) {\n    return this.toCube()\n      .scale(scale)\n      .toOffset();\n  }\n\n  moveToDirection(direction, steps) {\n    return this.toCube()\n      .moveToDirection(direction, steps)\n      .toOffset();\n  }\n\n  equals(offset) {\n    return this.q === offset.q && this.r === offset.r;\n  }\n\n  getNeighbourAtDirection(direction) {\n    var neighbours = this.getNeighbours();\n\n    return neighbours[direction];\n  }\n\n  distanceTo(target) {\n    return this.toCube().distanceTo(target.toCube());\n  }\n\n  ring(radius) {\n    return this.toCube()\n      .ring(radius)\n      .map(cube => cube.toOffset());\n  }\n\n  spiral(radius) {\n    return this.toCube()\n      .spiral(radius)\n      .map(cube => cube.toOffset());\n  }\n\n  clone() {\n    return new Offset(this);\n  }\n\n  toCube() {\n    const x = this.q - (this.r + (this.r & 1)) / 2;\n    const z = this.r;\n    const y = -x - z;\n\n    /*\n        var x, y, z;\n        switch (this.layout) {\n            case Offset.ODD_R:\n                x = this.q - (this.r - (this.r & 1)) / 2;\n                z = this.r;\n                y = -x - z;\n                break;\n            case Offset.EVEN_R:\n                x = this.q - (this.r + (this.r&1)) / 2;\n                z = this.r;\n                y = -x - z;\n                break;\n        }\n        */\n\n    return new Cube(x, y, z).round();\n  }\n\n  drawLine(target, distance) {\n    return this.toCube()\n      .drawLine(target.toCube(), distance)\n      .map(cube => cube.toOffset());\n  }\n\n  toString() {\n    return `(${this.q}, ${this.r})`;\n  }\n\n  rotate(facing) {\n    return this.toCube()\n      .rotate(facing)\n      .toOffset();\n  }\n\n  normalize() {\n    return this.toCube()\n      .normalize()\n      .toOffset();\n  }\n}\n\nexport default Offset;\n","import Offset from \"./Offset.mjs\";\n\nconst PRECISION = 4;\n\nconst lerp = (a, b, t) => {\n  return a + (b - a) * t;\n};\n\nconst cubeLerp = (a, b, t) => {\n  return new Cube(lerp(a.x, b.x, t), lerp(a.y, b.y, t), lerp(a.z, b.z, t));\n};\n\nclass Cube {\n  constructor(x, y, z) {\n    if (\n      x instanceof Cube ||\n      (x.x !== undefined && x.y !== undefined && x.z !== undefined)\n    ) {\n      const cube = x;\n      this.x = this._formatNumber(cube.x);\n      this.y = this._formatNumber(cube.y);\n      this.z = this._formatNumber(cube.z);\n    } else {\n      this.x = this._formatNumber(x);\n      this.y = this._formatNumber(y);\n      this.z = this._formatNumber(z);\n    }\n\n    this.neighbours = [\n      { x: 1, y: -1, z: 0 },\n      { x: 1, y: 0, z: -1 },\n      { x: 0, y: 1, z: -1 },\n      { x: -1, y: 1, z: 0 },\n      { x: -1, y: 0, z: 1 },\n      { x: 0, y: -1, z: 1 }\n    ];\n\n    this._validate();\n  }\n\n  round() {\n    if (this.x % 1 === 0 && this.y % 1 === 0 && this.z % 1 === 0) {\n      return this;\n    }\n\n    var rx = Math.round(this.x);\n    var ry = Math.round(this.y);\n    var rz = Math.round(this.z);\n\n    var x_diff = Math.abs(rx - this.x);\n    var y_diff = Math.abs(ry - this.y);\n    var z_diff = Math.abs(rz - this.z);\n\n    if (x_diff > y_diff && x_diff > z_diff) {\n      rx = -ry - rz;\n    } else if (y_diff > z_diff) {\n      ry = -rx - rz;\n    } else {\n      rz = -rx - ry;\n    }\n\n    return new Cube(rx, ry, rz);\n  }\n\n  _validate() {\n    if (Math.abs(this.x + this.y + this.z) > 0.001) {\n      throw new Error(\n        \"Invalid Cube coordinates: (\" +\n          this.x +\n          \", \" +\n          this.y +\n          \", \" +\n          this.z +\n          \")\"\n      );\n    }\n  }\n\n  getNeighbours() {\n    var neighbours = [];\n\n    this.neighbours.forEach(function(neighbour) {\n      neighbours.push(this.add(new Cube(neighbour)));\n    }, this);\n\n    return neighbours;\n  }\n\n  moveToDirection(direction, steps = 1) {\n    return this.add(new Cube(this.neighbours[direction]).scale(steps));\n  }\n\n  add(cube) {\n    return new Cube(this.x + cube.x, this.y + cube.y, this.z + cube.z);\n  }\n\n  subtract(cube) {\n    return new Cube(this.x - cube.x, this.y - cube.y, this.z - cube.z);\n  }\n\n  scale(scale) {\n    return new Cube(this.x * scale, this.y * scale, this.z * scale);\n  }\n\n  distanceTo(cube) {\n    return Math.max(\n      Math.abs(this.x - cube.x),\n      Math.abs(this.y - cube.y),\n      Math.abs(this.z - cube.z)\n    );\n  }\n\n  equals(cube) {\n    return this.x === cube.x && this.y === cube.y && this.z === cube.z;\n  }\n\n  clone() {\n    return new Cube(this);\n  }\n\n  getFacing(neighbour) {\n    var index = -1;\n\n    var delta = neighbour.subtract(this);\n\n    this.neighbours.some(function(hex, i) {\n      if (delta.equals(hex)) {\n        index = i;\n        return true;\n      }\n\n      return false;\n    });\n\n    return index;\n  }\n\n  ring(radius) {\n    const results = [];\n\n    if (radius === 0) {\n      return results;\n    }\n\n    let cube = this.moveToDirection(4, radius);\n    for (let i = 0; i < 6; i++) {\n      for (let j = 0; j < radius; j++) {\n        results.push(cube);\n        cube = cube.moveToDirection(i);\n      }\n    }\n\n    return results;\n  }\n\n  spiral(radius) {\n    let results = [this.clone()];\n    for (let k = 1; k <= radius; k++) {\n      results = results.concat(this.ring(k));\n    }\n    return results;\n  }\n\n  toOffset() {\n    var q = this.x + (this.z + (this.z & 1)) / 2;\n    var r = this.z;\n\n    return new Offset(q, r); //EVEN_R\n  }\n\n  /*\n        Cube.prototype.toOffset = function()\n        {\n            var q = this.x + (this.z - (this.z & 1)) / 2;\n            var r = this.z;\n    \n            return new hexagon.Offset(q, r); //ODD_R\n        };\n    */\n  toString() {\n    return \"(\" + this.x + \",\" + this.y + \",\" + this.z + \")\";\n  }\n\n  _formatNumber(number) {\n    return parseFloat(number.toFixed(PRECISION));\n  }\n\n  normalize() {\n    return this.drawLine(new Cube(0, 0, 0), 1)[0];\n  }\n\n  drawLine(target, distance = null) {\n    const n = this.distanceTo(target);\n\n    if (distance === null) {\n      distance = n;\n    }\n\n    const results = [];\n    for (let i = distance; i >= 0; i--) {\n      results.push(cubeLerp(target, this, (1.0 / n) * i).round());\n    }\n\n    return results;\n  }\n\n  rotate(facing) {\n    let result = this;\n\n    const takeStep = cube => {\n      return new Cube(-cube.y, -cube.z, -cube.x);\n    };\n\n    while (facing--) {\n      result = takeStep(result);\n    }\n\n    return result;\n  }\n}\n\nexport default Cube;\n","import Cube from \"./Cube.mjs\";\r\nimport Offset from \"./Offset.mjs\";\r\n\r\nexport default { Cube, Offset };\r\n","import * as gameConfig from \"../gameConfig.mjs\";\r\n\r\nconst getHexA = hexSize => {\r\n  if (!hexSize) {\r\n    hexSize = gameConfig.HEX_SIZE;\r\n  }\r\n\r\n  return hexSize * Math.sin((30 / 180) * Math.PI);\r\n};\r\n\r\nconst getHexB = hexSize => {\r\n  if (!hexSize) {\r\n    hexSize = gameConfig.HEX_SIZE;\r\n  }\r\n\r\n  return hexSize * Math.cos((30 / 180) * Math.PI);\r\n};\r\n\r\nconst getHexHeight = hexSize => {\r\n  if (!hexSize) {\r\n    hexSize = gameConfig.HEX_SIZE;\r\n  }\r\n\r\n  return hexSize + 2 * getHexA(hexSize);\r\n};\r\n\r\nconst getHexWidth = hexSize => {\r\n  if (!hexSize) {\r\n    hexSize = gameConfig.HEX_SIZE;\r\n  }\r\n\r\n  return getHexB(hexSize) * 2;\r\n};\r\n\r\nconst getHexRowHeight = hexSize => {\r\n  if (!hexSize) {\r\n    hexSize = gameConfig.HEX_SIZE;\r\n  }\r\n\r\n  return hexSize + getHexA(hexSize);\r\n};\r\n\r\nconst getTextureHeight = hexSize => {\r\n  if (!hexSize) {\r\n    hexSize = gameConfig.HEX_SIZE;\r\n  }\r\n\r\n  return Math.floor(hexSize + getHexHeight(hexSize));\r\n};\r\n\r\nconst getTextureWidth = hexSize => {\r\n  if (!hexSize) {\r\n    hexSize = gameConfig.HEX_SIZE;\r\n  }\r\n\r\n  return getHexWidth(hexSize) * 2;\r\n};\r\n\r\nconst getGridWidth = hexCountWidth => {\r\n  return getHexWidth() * (hexCountWidth + 0.5);\r\n};\r\n\r\nconst getGridHeight = hexCountHeight => {\r\n  var amount = Math.floor(hexCountHeight / 2);\r\n  var height = amount * (getHexHeight() + gameConfig.HEX_SIZE);\r\n\r\n  if (hexCountHeight % 2 !== 0) {\r\n    height += getHexHeight();\r\n  }\r\n\r\n  return height;\r\n};\r\n\r\nexport default {\r\n  getHexA,\r\n  getHexB,\r\n  getHexHeight,\r\n  getHexWidth,\r\n  getHexRowHeight,\r\n  getTextureHeight,\r\n  getTextureWidth,\r\n  getGridWidth,\r\n  getGridHeight\r\n};\r\n","const distance = (x1, y1, x2, y2) => {\r\n  if (y1.x !== undefined && x1.x !== undefined) {\r\n    x2 = y1.x;\r\n    y2 = y1.y;\r\n    y1 = x1.y;\r\n    x1 = x1.x;\r\n  }\r\n\r\n  return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\r\n};\r\n\r\nconst distance3d = (pointA, pointB) => {\r\n  const dx = pointB.x - pointA.x;\r\n  const dy = pointB.y - pointA.y;\r\n  const dz = pointB.z - pointA.z;\r\n\r\n  const dist = Math.sqrt(Math.pow(dx, 2) + Math.pow(dy, 2) + Math.pow(dz, 2));\r\n\r\n  return dist;\r\n};\r\n\r\nconst getSeededRandomGenerator = seed => {\r\n  function xmur3(str) {\r\n    for (var i = 0, h = 1779033703 ^ str.length; i < str.length; i++) {\r\n      h = Math.imul(h ^ str.charCodeAt(i), 3432918353);\r\n      h = (h << 13) | (h >>> 19);\r\n    }\r\n\r\n    return function() {\r\n      h = Math.imul(h ^ (h >>> 16), 2246822507);\r\n      h = Math.imul(h ^ (h >>> 13), 3266489909);\r\n      return (h ^= h >>> 16) >>> 0;\r\n    };\r\n  }\r\n\r\n  const seedGenerator = xmur3(seed);\r\n\r\n  const xoshiro128ss = (a, b, c, d) => {\r\n    return function() {\r\n      var t = b << 9,\r\n        r = a * 5;\r\n      r = ((r << 7) | (r >>> 25)) * 9;\r\n      c ^= a;\r\n      d ^= b;\r\n      b ^= c;\r\n      a ^= d;\r\n      c ^= t;\r\n      d = (d << 11) | (d >>> 21);\r\n      return (r >>> 0) / 4294967296;\r\n    };\r\n  };\r\n\r\n  return xoshiro128ss(\r\n    seedGenerator(),\r\n    seedGenerator(),\r\n    seedGenerator(),\r\n    seedGenerator()\r\n  );\r\n};\r\n\r\nconst addToDirection = (current, add) => {\r\n  add = add % 360;\r\n\r\n  let ret = 0;\r\n  if (current + add > 360) {\r\n    ret = add - (360 - current);\r\n  } else if (current + add < 0) {\r\n    ret = 360 + (current + add);\r\n  } else {\r\n    ret = current + add;\r\n  }\r\n\r\n  return ret;\r\n};\r\n\r\nconst getDistanceBetweenDirections = (start, end, direction = 1) => {\r\n  if (end === start) {\r\n    return 0;\r\n  }\r\n\r\n  if (direction > 0) {\r\n    if (end < start) {\r\n      return 360 - start + end;\r\n    } else {\r\n      return end - start;\r\n    }\r\n  } else {\r\n    if (end > start) {\r\n      return 360 - end + start;\r\n    } else {\r\n      return start - end;\r\n    }\r\n  }\r\n};\r\n\r\nconst getPointBetween = (start, end, percentage, noRound) => {\r\n  var x = start.x + percentage * (end.x - start.x);\r\n  var y = start.y + percentage * (end.y - start.y);\r\n\r\n  if (noRound) {\r\n    return { x: x, y: y };\r\n  }\r\n\r\n  return { x: Math.floor(x), y: Math.floor(y) };\r\n};\r\n\r\nconst getPointBetween3d = (start, end, percentage, noRound) => {\r\n  var x = start.x + percentage * (end.x - start.x);\r\n  var y = start.y + percentage * (end.y - start.y);\r\n  var z = start.z + percentage * (end.z - start.z);\r\n\r\n  if (noRound) {\r\n    return { x: x, y: y, z: z };\r\n  }\r\n\r\n  return { x: Math.floor(x), y: Math.floor(y), z: Math.floor(z) };\r\n};\r\n\r\nconst getPointBetweenInDistance = (start, end, distance, noRound) => {\r\n  const totalDistance = distance3d(start, end);\r\n  const percentage = distance / totalDistance;\r\n  return getPointBetween3d(start, end, percentage, noRound);\r\n};\r\n\r\nconst getDistanceBetweenShipsInHex = (s1, s2) => {\r\n  var start = s1.getHexPosition();\r\n  var end = s2.getHexPosition();\r\n  return start.distanceTo(end);\r\n};\r\n\r\nconst getAngleBetween = (angle1, angle2, right) => {\r\n  let difference;\r\n  if (right) {\r\n    if (angle1 > angle2) {\r\n      difference = 360 - angle1 + angle2;\r\n    } else {\r\n      difference = angle2 - angle1;\r\n    }\r\n  } else {\r\n    if (angle1 < angle2) {\r\n      difference = (angle1 + (360 - angle2)) * -1;\r\n    } else {\r\n      difference = angle2 - angle1;\r\n    }\r\n  }\r\n\r\n  return difference;\r\n};\r\n\r\nconst addToHexFacing = (facing, add) => {\r\n  if (facing + add > 5) {\r\n    return addToHexFacing(0, facing + add - 6);\r\n  }\r\n\r\n  if (facing + add < 0) {\r\n    return addToHexFacing(6, facing + add);\r\n  }\r\n\r\n  return facing + add;\r\n};\r\n\r\nconst getPointInDirection = (r, a, cx, cy, noRound) => {\r\n  a = -a;\r\n\r\n  var x = cx + r * Math.cos((a * Math.PI) / 180);\r\n  var y = cy + r * Math.sin((a * Math.PI) / 180);\r\n\r\n  if (noRound) {\r\n    return { x: x, y: y };\r\n  }\r\n  return { x: Math.round(x), y: Math.round(y) };\r\n};\r\n\r\nconst getArcLength = (start, end) => {\r\n  var a = 0;\r\n  if (start > end) {\r\n    a = 360 - start + end;\r\n  } else {\r\n    a = end - start;\r\n  }\r\n\r\n  return a;\r\n};\r\n\r\nconst isInArc = (direction, start, end) => {\r\n  //direction: 300 start: 360 end: 240\r\n  direction = Math.round(direction);\r\n\r\n  if (start === end) return true;\r\n\r\n  if ((direction === 0 && start === 360) || (direction === 0 && end === 360))\r\n    return true;\r\n\r\n  if (start > end) {\r\n    return direction >= start || direction <= end;\r\n  } else if (direction >= start && direction <= end) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nconst radianToDegree = angle => {\r\n  return angle * (180.0 / Math.PI);\r\n};\r\n\r\nconst degreeToRadian = angle => angle / (180.0 / Math.PI);\r\n\r\nconst getCompassHeadingOfPoint = (observer, target) => {\r\n  let heading = radianToDegree(\r\n    Math.atan2(target.y - observer.y, target.x - observer.x)\r\n  );\r\n\r\n  if (heading > 0) {\r\n    heading = 360 - heading;\r\n  } else {\r\n    heading = Math.abs(heading);\r\n  }\r\n\r\n  return heading;\r\n};\r\n\r\nconst hexFacingToAngle = d => {\r\n  switch (d) {\r\n    case 0:\r\n      return 0;\r\n    case 1:\r\n      return 60;\r\n    case 2:\r\n      return 120;\r\n    case 3:\r\n      return 180;\r\n    case 4:\r\n      return 240;\r\n    default:\r\n      return 300;\r\n  }\r\n};\r\n\r\nconst angleToHexFacing = d => {\r\n  switch (d) {\r\n    case 0:\r\n      return 0;\r\n    case 60:\r\n      return 1;\r\n    case 120:\r\n      return 2;\r\n    case 180:\r\n      return 3;\r\n    case 240:\r\n      return 4;\r\n    default:\r\n      return 5;\r\n  }\r\n};\r\n\r\nconst shuffleArray = a => {\r\n  for (let i = a.length - 1; i > 0; i--) {\r\n    const j = Math.floor(Math.random() * (i + 1));\r\n    [a[i], a[j]] = [a[j], a[i]];\r\n  }\r\n  return a;\r\n};\r\n\r\nexport {\r\n  distance,\r\n  distance3d,\r\n  getSeededRandomGenerator,\r\n  addToDirection,\r\n  getDistanceBetweenDirections,\r\n  getPointBetween,\r\n  getPointBetween3d,\r\n  getPointBetweenInDistance,\r\n  getDistanceBetweenShipsInHex,\r\n  getAngleBetween,\r\n  addToHexFacing,\r\n  getPointInDirection,\r\n  getArcLength,\r\n  isInArc,\r\n  radianToDegree,\r\n  degreeToRadian,\r\n  getCompassHeadingOfPoint,\r\n  hexFacingToAngle,\r\n  angleToHexFacing,\r\n  shuffleArray\r\n};\r\n","import THREE from \"three\";\r\nimport Vector from \"./Vector.mjs\";\r\nimport * as gameConfig from \"../gameConfig.mjs\";\r\nimport hexagon from \"../hexagon/index.mjs\";\r\nimport HexagonMath from \"./HexagonMath.mjs\";\r\nimport { distance } from \"./math.mjs\";\r\n\r\nconst getShipIcon = object3d => {\r\n  do {\r\n    if (object3d.userData.icon) {\r\n      return object3d.userData.icon;\r\n    }\r\n    object3d = object3d.parent;\r\n  } while (object3d.parent);\r\n\r\n  return null;\r\n};\r\n\r\nclass CoordinateConverter {\r\n  constructor() {\r\n    this.hexlenght = gameConfig.HEX_SIZE;\r\n    this.width = 0;\r\n    this.height = 0;\r\n    this.zoom = 1;\r\n    this.camera = null;\r\n    this.scene = null;\r\n    this.raycaster = new THREE.Raycaster();\r\n  }\r\n\r\n  init(camera, scene) {\r\n    this.camera = camera;\r\n    this.scene = scene;\r\n  }\r\n\r\n  onResize({ width, height }) {\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n\r\n  onZoom(zoom) {\r\n    this.zoom = zoom;\r\n  }\r\n\r\n  fromHexToViewport(hex) {\r\n    return this.fromGameToViewPort(this.fromHexToGame(hex));\r\n  }\r\n\r\n  getHexHeightViewport() {\r\n    return HexagonMath.getHexHeight() / this.zoom;\r\n  }\r\n\r\n  getHexDistance() {\r\n    var hex1 = new hexagon.Offset(0, 0);\r\n    var hex2 = hex1.getNeighbourAtDirection(0);\r\n\r\n    return distance(this.fromHexToGame(hex1), this.fromHexToGame(hex2));\r\n  }\r\n\r\n  fromGameToHex(gameCoordinates) {\r\n    if (!gameCoordinates) {\r\n      console.trace();\r\n    }\r\n    var q =\r\n      ((1 / 3) * Math.sqrt(3) * gameCoordinates.x -\r\n        (1 / 3) * gameCoordinates.y) /\r\n      this.hexlenght;\r\n    var r = ((2 / 3) * gameCoordinates.y) / this.hexlenght;\r\n\r\n    var x = q;\r\n    var z = r;\r\n    var y = -x - z;\r\n\r\n    return new hexagon.Cube(x, y, z).round().toOffset();\r\n  }\r\n\r\n  fromHexToGame(offsetHex) {\r\n    if (offsetHex instanceof hexagon.Cube) {\r\n      offsetHex = offsetHex.toOffset();\r\n    }\r\n\r\n    if (!(offsetHex instanceof hexagon.Offset)) {\r\n      offsetHex = new hexagon.Offset(offsetHex.q, offsetHex.r);\r\n    }\r\n\r\n    var x =\r\n      this.hexlenght * Math.sqrt(3) * (offsetHex.q - 0.5 * (offsetHex.r & 1));\r\n    var y = ((this.hexlenght * 3) / 2) * offsetHex.r;\r\n\r\n    return new Vector(x, y, 0);\r\n  }\r\n\r\n  fromViewPortToGame(pos) {\r\n    var result = {\r\n      x: 0,\r\n      y: 0,\r\n      z: 0\r\n    };\r\n\r\n    this.raycaster.setFromCamera(\r\n      { x: pos.xR, y: pos.yR },\r\n      this.camera.getCamera()\r\n    );\r\n    var intersects = this.raycaster.intersectObjects(this.scene.children, true);\r\n\r\n    intersects.forEach(function(intersected) {\r\n      if (intersected.object.name === \"hexgrid\") {\r\n        result.x = intersected.point.x;\r\n        result.y = intersected.point.y;\r\n        result.z = intersected.point.z;\r\n      }\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  getEntitiesIntersected(pos, debug = false) {\r\n    var result = [];\r\n\r\n    this.raycaster.setFromCamera(\r\n      { x: pos.xR, y: pos.yR },\r\n      this.camera.getCamera()\r\n    );\r\n    var intersects = this.raycaster.intersectObjects(this.scene.children, true);\r\n\r\n    intersects.forEach(function(intersected) {\r\n      if (intersected.object.name !== \"hexgrid\") {\r\n        var icon = getShipIcon(intersected.object);\r\n\r\n        icon && !result.includes(icon) && result.push(icon);\r\n      }\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  fromGameToViewPort(pos) {\r\n    var vector = new THREE.Vector3();\r\n    vector.set(pos.x, pos.y, pos.z || 0);\r\n\r\n    // map to normalized device coordinate (NDC) space\r\n    vector.project(this.camera.getCamera());\r\n\r\n    // map to 2D screen space\r\n    vector.x = Math.round(((vector.x + 1) * this.width) / 2);\r\n    vector.y = Math.round(((-vector.y + 1) * this.height) / 2);\r\n    vector.z = 0;\r\n\r\n    return {\r\n      x: vector.x,\r\n      y: vector.y\r\n    };\r\n\r\n    /*\r\n        var cameraPos = this.camera.position;\r\n        var zoom = this.zoom;\r\n        var windowDimensions = { width: this.width, height: this.height };\r\n\r\n        var positionFromCamera = { x: pos.x - cameraPos.x, y: pos.y - cameraPos.y };\r\n        var withZoom = { x: positionFromCamera.x / zoom, y: positionFromCamera.y / zoom };\r\n        var positionFromCenterOfScreen = { x: withZoom.x + windowDimensions.width / 2, y: windowDimensions.height / 2 - withZoom.y };\r\n\r\n        return positionFromCenterOfScreen;\r\n        */\r\n  }\r\n}\r\n\r\nconst coordinateConverter = new CoordinateConverter();\r\nexport default coordinateConverter;\r\n","import THREE from \"three\";\r\nimport coordinateConverter from \"./CoordinateConverter.mjs\";\r\nimport { degreeToRadian } from \"./math.mjs\";\r\n\r\nconst helperA = new THREE.Vector3();\r\nconst helperB = new THREE.Vector3();\r\n\r\nclass Vector {\r\n  constructor(x = 0, y = 0, z = 0) {\r\n    if (x instanceof THREE.Vector3 || x instanceof Vector) {\r\n      this.x = x.x;\r\n      this.y = x.y;\r\n      this.z = x.z;\r\n    } else if (x instanceof THREE.Vector2) {\r\n      this.x = x.x;\r\n      this.y = x.y;\r\n      this.z = 0;\r\n    } else if (typeof x === \"object\") {\r\n      this.x = x.x || 0;\r\n      this.y = x.y || 0;\r\n      this.z = x.z || 0;\r\n    } else {\r\n      this.x = x;\r\n      this.y = y;\r\n      this.z = z;\r\n    }\r\n  }\r\n\r\n  clone() {\r\n    return new Vector(this.x, this.y, this.z);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      x: this.x,\r\n      y: this.y,\r\n      z: this.z\r\n    };\r\n  }\r\n\r\n  setX(x) {\r\n    return new Vector(x, this.y, this.z);\r\n  }\r\n\r\n  setY(y) {\r\n    return new Vector(this.x, y, this.z);\r\n  }\r\n\r\n  setZ(z) {\r\n    return new Vector(this.x, this.y, z);\r\n  }\r\n\r\n  setFromAngle(a) {\r\n    return new Vector(\r\n      Math.cos(degreeToRadian(a)),\r\n      Math.sin(degreeToRadian(a))\r\n    ).normalize();\r\n  }\r\n\r\n  distanceTo(vector) {\r\n    vector = new Vector(vector);\r\n    helperA.set(this.x, this.y, this.z);\r\n    helperB.set(vector.x, vector.y, vector.z);\r\n    return helperA.distanceTo(helperB);\r\n  }\r\n\r\n  add(vector) {\r\n    vector = new Vector(vector);\r\n    helperA.set(this.x, this.y, this.z);\r\n    helperB.set(vector.x, vector.y, vector.z);\r\n    helperA.add(helperB);\r\n    return new Vector(helperA.x, helperA.y, helperA.z);\r\n  }\r\n\r\n  dot(vector) {\r\n    helperA.set(this.x, this.y, this.z);\r\n    helperB.set(vector.x, vector.y, vector.z);\r\n    return helperA.dot(helperB);\r\n  }\r\n\r\n  subtract(vector) {\r\n    return this.sub(vector);\r\n  }\r\n\r\n  sub(vector) {\r\n    vector = new Vector(vector);\r\n    helperA.set(this.x, this.y, this.z);\r\n    helperB.set(vector.x, vector.y, vector.z);\r\n    helperA.sub(helperB);\r\n    return new Vector(helperA.x, helperA.y, helperA.z);\r\n  }\r\n\r\n  normalize() {\r\n    helperA.set(this.x, this.y, this.z);\r\n    helperA.normalize();\r\n    return new Vector(helperA.x, helperA.y, helperA.z);\r\n  }\r\n\r\n  multiplyScalar(scalar) {\r\n    helperA.set(this.x, this.y, this.z);\r\n    helperA.multiplyScalar(scalar);\r\n    return new Vector(helperA.x, helperA.y, helperA.z);\r\n  }\r\n\r\n  length() {\r\n    helperA.set(this.x, this.y, this.z);\r\n    return helperA.length();\r\n  }\r\n\r\n  applyMatrix4(matrix) {\r\n    helperA.set(this.x, this.y, this.z);\r\n\r\n    return new Vector(helperA.applyMatrix4(matrix));\r\n  }\r\n\r\n  equals(vector) {\r\n    if (!vector) {\r\n      return false;\r\n    }\r\n\r\n    return this.x === vector.x && this.y === vector.y && this.z === vector.z;\r\n  }\r\n\r\n  round() {\r\n    return new Vector(\r\n      Math.floor(this.x),\r\n      Math.floor(this.y),\r\n      Math.floor(this.z)\r\n    );\r\n  }\r\n\r\n  roundToHexCenter() {\r\n    return coordinateConverter.fromHexToGame(\r\n      coordinateConverter.fromGameToHex(this)\r\n    );\r\n  }\r\n\r\n  toString() {\r\n    return `(x:${this.x}, y:${this.y}, z:${this.z})`;\r\n  }\r\n\r\n  toThree() {\r\n    return new THREE.Vector3(this.x, this.y, this.z);\r\n  }\r\n}\r\n\r\nexport default Vector;\r\n","import Vector from \"../../../../model/utils/Vector\";\n\nclass Animation {\n  constructor(getRandom) {\n    this.getRandom = getRandom || Math.random;\n    this.active = false;\n    this.started = false;\n    this.done = false;\n  }\n\n  start() {\n    this.active = true;\n  }\n\n  stop() {\n    this.active = false;\n  }\n\n  setIsDone(done) {\n    this.done = done;\n    return this;\n  }\n\n  setStartCallback(callback) {\n    this.startCallback = callback;\n    return this;\n  }\n\n  setDoneCallback(callback) {\n    this.doneCallback = callback;\n    return this;\n  }\n\n  callStartCallback(total) {\n    if (!this.started && total > this.time) {\n      this.startCallback && this.startCallback();\n      this.started = true;\n    }\n  }\n\n  callDoneCallback(total) {\n    if (total > this.time + this.duration && !this.done) {\n      this.doneCallback && this.doneCallback();\n      this.done = true;\n    }\n  }\n\n  getDuration() {\n    return 0;\n  }\n\n  deactivate() {}\n\n  reset() {}\n\n  cleanUp() {}\n\n  update(gameData) {}\n\n  render(now, total, last, delta, goingBack) {}\n\n  getRandomPosition(distance) {\n    return new Vector(\n      this.getRandom() * distance - distance * 0.5,\n      this.getRandom() * distance - distance * 0.5,\n      this.getRandom() * distance - distance * 0.5\n    );\n  }\n}\n\nexport default Animation;\n","import * as THREE from \"three\";\r\nimport { degreeToRadian } from \"../../../../../model/utils/math\";\r\n\r\nconst changeAttribute = (geometry, index, key, values) => {\r\n  values = [].concat(values);\r\n\r\n  var target = geometry.attributes[key].array;\r\n\r\n  values.forEach(function(value, i) {\r\n    target[index * values.length + i] = value;\r\n  });\r\n\r\n  geometry.attributes[key].needsUpdate = true;\r\n};\r\n\r\nexport const TEXTURE_GAS = 0;\r\nexport const TEXTURE_BOLT = 1;\r\nexport const TEXTURE_GLOW = 2;\r\nexport const TEXTURE_RING = 3;\r\nexport const TEXTURE_STARLINE = 4;\r\n\r\nclass BaseParticle {\r\n  constructor(material, geometry) {\r\n    this.material = material;\r\n    this.geometry = geometry;\r\n    this.index = 0;\r\n\r\n    this.texture = {\r\n      gas: TEXTURE_GAS,\r\n      bolt: TEXTURE_BOLT,\r\n      glow: TEXTURE_GLOW,\r\n      ring: TEXTURE_RING,\r\n      starLine: TEXTURE_STARLINE\r\n    };\r\n  }\r\n\r\n  create(index) {\r\n    this.index = index;\r\n    return this;\r\n  }\r\n\r\n  setInitialValues() {\r\n    this.setPosition({ x: 0, y: 0, z: 0 });\r\n    this.setColor(new THREE.Color(0, 0, 0));\r\n    this.setOpacity(0.0);\r\n    this.setFadeIn(0.0, 0.0);\r\n    this.setFadeOut(0.0, 0.0);\r\n    this.setSize(0.0);\r\n    this.setSizeChange(0.0);\r\n    this.setAngle(0.0);\r\n    this.setAngleChange(0.0);\r\n    this.setActivationTime(0.0);\r\n    this.setVelocity(new THREE.Vector3(0, 0, 0));\r\n    this.setAcceleration(new THREE.Vector3(0, 0, 0));\r\n    this.setTexture(this.texture.glow);\r\n\r\n    return this;\r\n  }\r\n\r\n  setSine(frequency, amplitude) {\r\n    const value = Math.floor(frequency) + amplitude;\r\n    changeAttribute(this.geometry, this.index, \"sine\", value);\r\n    return this;\r\n  }\r\n\r\n  setTexture(tex) {\r\n    changeAttribute(this.geometry, this.index, \"textureNumber\", tex);\r\n\r\n    return this;\r\n  }\r\n\r\n  setSize(size) {\r\n    changeAttribute(this.geometry, this.index, \"size\", size);\r\n    return this;\r\n  }\r\n\r\n  setSizeChange(size) {\r\n    changeAttribute(this.geometry, this.index, \"sizeChange\", size);\r\n    return this;\r\n  }\r\n\r\n  setColor(color) {\r\n    changeAttribute(this.geometry, this.index, \"color\", [\r\n      color.r,\r\n      color.g,\r\n      color.b\r\n    ]);\r\n    return this;\r\n  }\r\n\r\n  setOpacity(opacity) {\r\n    changeAttribute(this.geometry, this.index, \"opacity\", opacity);\r\n    return this;\r\n  }\r\n\r\n  setFadeIn(time, speed = 1000) {\r\n    changeAttribute(this.geometry, this.index, \"fadeInTime\", time);\r\n    changeAttribute(this.geometry, this.index, \"fadeInSpeed\", speed);\r\n    return this;\r\n  }\r\n\r\n  setFadeOut(time, speed = 1000) {\r\n    changeAttribute(this.geometry, this.index, \"fadeOutTime\", time);\r\n    changeAttribute(this.geometry, this.index, \"fadeOutSpeed\", speed);\r\n    return this;\r\n  }\r\n\r\n  setPosition(pos) {\r\n    changeAttribute(\r\n      this.geometry,\r\n      this.index,\r\n      \"position\",\r\n      [pos.x, pos.y, pos.z],\r\n      true\r\n    );\r\n    return this;\r\n  }\r\n\r\n  setAngle(angle) {\r\n    changeAttribute(this.geometry, this.index, \"angle\", degreeToRadian(angle));\r\n    return this;\r\n  }\r\n\r\n  setAngleChange(angle) {\r\n    changeAttribute(\r\n      this.geometry,\r\n      this.index,\r\n      \"angleChange\",\r\n      degreeToRadian(angle)\r\n    );\r\n    return this;\r\n  }\r\n\r\n  setVelocity(velocity) {\r\n    changeAttribute(this.geometry, this.index, \"velocity\", [\r\n      velocity.x,\r\n      velocity.y,\r\n      velocity.z\r\n    ]);\r\n    return this;\r\n  }\r\n\r\n  setAcceleration(acceleration) {\r\n    changeAttribute(this.geometry, this.index, \"acceleration\", [\r\n      acceleration.x,\r\n      acceleration.y,\r\n      acceleration.z\r\n    ]);\r\n    return this;\r\n  }\r\n\r\n  deactivate() {\r\n    this.setInitialValues();\r\n    return this;\r\n  }\r\n\r\n  setActivationTime(gameTime) {\r\n    changeAttribute(this.geometry, this.index, \"activationGameTime\", gameTime);\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default BaseParticle;\r\n","const effectVertexShader = `\r\n    attribute vec3 color;\r\n    attribute float opacity;\r\n    attribute float fadeInTime;\r\n    attribute float fadeInSpeed;\r\n    attribute float fadeOutTime;\r\n    attribute float fadeOutSpeed;\r\n    attribute float size;\r\n    attribute float sizeChange;\r\n    attribute float angle;\r\n    attribute float angleChange;\r\n    attribute vec3 velocity;\r\n    attribute vec3 acceleration;\r\n    attribute float activationGameTime;\r\n    attribute float textureNumber;\r\n    attribute float sine;\r\n    uniform float zoomLevel;\r\n    uniform float gameTime;\r\n    varying vec4  vColor;\r\n    varying float vAngle;\r\n    varying float textureN;\r\n    void main()\r\n    {\r\n        float elapsedTime = gameTime - activationGameTime;\r\n\r\n        if (elapsedTime < 0.0 || (fadeOutTime > 0.0 && gameTime - (fadeOutTime + fadeOutSpeed) > 0.0)) {\r\n            gl_PointSize = 0.0;\r\n            gl_Position = vec4( 0.0, 0.0, 0.0, 1.0 );\r\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\r\n            textureN = textureNumber;\r\n            return;\r\n        }\r\n\r\n        float currentOpacity = 0.0;\r\n        if (fadeInSpeed == 0.0) {\r\n            currentOpacity = opacity;\r\n        }\r\n\r\n\r\n        if (fadeInSpeed > 0.0 && gameTime > fadeInTime)\r\n        {\r\n            float fadeIn = (gameTime - fadeInTime) / fadeInSpeed;\r\n        if (fadeIn > 1.0) fadeIn = 1.0;\r\n            currentOpacity =  opacity * fadeIn;\r\n        }\r\n\r\n        if (fadeOutSpeed > 0.0 && gameTime > fadeOutTime)\r\n        {\r\n            float fadeOut = (gameTime - fadeOutTime) / fadeOutSpeed;\r\n        if (fadeOut > 1.0) fadeOut = 1.0;\r\n            currentOpacity =  currentOpacity * (1.0 - fadeOut);\r\n        }\r\n\r\n        if ( currentOpacity > 0.0 && elapsedTime >= 0.0)\r\n        {\r\n            float sineAmplitude = sine - floor(sine);\r\n            float sineFrequency = floor(sine);\r\n\r\n            if (sineFrequency > 0.0) {\r\n                currentOpacity *= (sineAmplitude * 0.5 * sin(elapsedTime/sineFrequency) + sineAmplitude);\r\n            }\r\n\r\n            \r\n            if (zoomLevel < 1.0) {\r\n                currentOpacity += (1.0 - zoomLevel) * 0.5;\r\n            }\r\n            \r\n            vColor = vec4( color, currentOpacity );\r\n        } else {\r\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\r\n        }\r\n\r\n        \r\n        vAngle = angle + angleChange * elapsedTime;\r\n        textureN = textureNumber;\r\n\r\n        vec3 displacement = velocity * elapsedTime;\r\n        vec3 accelerationDisplacement  = elapsedTime * elapsedTime * 0.5 * acceleration;\r\n\r\n        vec3 modPos = position + displacement + accelerationDisplacement;\r\n\r\n\r\n        gl_PointSize = clamp(size + (sizeChange * elapsedTime), 0.0, 1024.0) * zoomLevel;\r\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( modPos, 1.0 );\r\n    }\r\n`;\r\n\r\nexport default effectVertexShader;\r\n","const effectFragmentShader = `\r\n    uniform sampler2D texture;\r\n    varying vec4 vColor;\r\n    varying float vAngle;\r\n    varying float textureN;\r\n    void main()\r\n    {\r\n        gl_FragColor = vColor;\r\n        if (gl_FragColor.a == 0.0) {\r\n            return;\r\n        }\r\n\r\n        float c = cos(vAngle);\r\n        float s = sin(vAngle);\r\n        float textureAmount = 8.0;\r\n        vec2 tPos = vec2((mod(textureN, textureAmount) * (1.0 / textureAmount)), (floor(textureN / textureAmount) * (1.0 / textureAmount)));\r\n\r\n        vec2 pos = vec2(gl_PointCoord.x, gl_PointCoord.y);\r\n        vec2 tCen = vec2(0.5, 0.5);\r\n\r\n        vec2 rPos = vec2(\r\n            tCen.x + c * (pos.x - tCen.x) - s * (pos.y - tCen.y),\r\n            tCen.y + s * (pos.x - tCen.x) + c * (pos.y - tCen.y)\r\n        );\r\n\r\n        rPos = clamp(rPos, 0.0, 1.0);\r\n\r\n        vec2 finalPos = vec2(\r\n            (rPos.x / textureAmount + tPos.x),\r\n            1.0 - (rPos.y / textureAmount + tPos.y)\r\n        );\r\n\r\n        vec4 rotatedTexture = texture2D(texture, finalPos);\r\n        gl_FragColor = gl_FragColor * rotatedTexture;\r\n    }\r\n`;\r\n\r\nexport default effectFragmentShader;\r\n","const spriteFragmentShader = `\r\n    uniform sampler2D texture;\r\n    uniform float overlayAlpha;\r\n    uniform vec3 overlayColor;\r\n    uniform float opacity;\r\n\r\n    varying vec2 vUv;\r\n\r\n    void main() {\r\n        vec4 textureColor = texture2D(texture, vUv);\r\n        vec4 finalColor = textureColor;\r\n\r\n        if (overlayAlpha > 0.0 && textureColor.a > 0.0){\r\n            //finalColor = vec4(overlayColor, textureColor.a);\r\n            //finalColor = mix(textureColor, overlayColor, overlayAlpha);\r\n            //finalColor = (1.0 - t1.a) * t0 + t1.a * t1;\r\n            finalColor = (1.0 - overlayAlpha) * textureColor + overlayAlpha * vec4(overlayColor, 1.0);\r\n            finalColor.a = textureColor.a;\r\n        }\r\n\r\n        if (finalColor.a > 0.0) {\r\n            finalColor.a *= opacity;\r\n        }\r\n\r\n        gl_FragColor = finalColor;\r\n    }\r\n`;\r\n\r\nexport default spriteFragmentShader;\r\n","const spriteVertexShader = `\r\n    varying vec2 vUv;\r\n\r\n    void main() {\r\n        vUv = uv;\r\n\r\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\r\n    }\r\n`;\r\n\r\nexport default spriteVertexShader;\r\n","const line2dVertexShader = `\r\n    precision highp float;\r\n    uniform mat4 modelMatrix;\r\n    uniform mat4 viewMatrix;\r\n    uniform mat4 modelViewMatrix;\r\n    uniform mat4 projectionMatrix;\r\n    uniform vec3 color;\r\n    uniform float opacity;\r\n    attribute vec3 position;\r\n    attribute vec2 uv;\r\n    varying vec2 vUv;\r\n    varying float vOpacity;\r\n    varying vec3 vColor;\r\n\r\n    void main() {\r\n       \r\n        vUv = uv;\r\n        vOpacity = opacity;\r\n        vColor = color;\r\n        /*\r\n        vPulse = pulse;\r\n        vDashRatio = dashRatio;\r\n        */\r\n       \r\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);    \r\n    }\r\n`;\r\n\r\nexport default line2dVertexShader;\r\n","const line2dFragmentShader = `\r\n    precision highp float;\r\n    uniform sampler2D map;\r\n    uniform float textureRepeat;\r\n    uniform vec2 pulse;\r\n    uniform float time;\r\n    varying vec2 vUv;\r\n    varying float vOpacity;\r\n    varying vec3 vColor;\r\n\r\n    vec4 getPulse(vec4 color) {\r\n        float pulseAmount = pulse.x;\r\n        float pulseSpeed = pulse.y;\r\n\r\n        if (pulseAmount == 0.0 || pulseSpeed == 0.0) {\r\n            return color;\r\n        }\r\n\r\n        float pulseTime = mod(time * pulseSpeed, 1.0);\r\n        float y = mod(vUv.y * pulseAmount, 1.0);\r\n   \r\n        float diff = y - pulseTime;\r\n        if (diff < 0.0) {\r\n            diff = 1.0 + diff;\r\n        }\r\n\r\n        if (diff > 0.9) {\r\n            diff = 1.0 - ((diff - 0.9) * 10.0);\r\n        }\r\n    \r\n        color.a *= 1.0 + (diff);\r\n\r\n        return color;\r\n    }\r\n\r\n    vec4 repeatTexture() {\r\n        vec2 textureUv = vec2(\r\n            vUv.x,\r\n            vUv.y * textureRepeat\r\n        );\r\n\r\n        return texture2D(map, textureUv);\r\n    }\r\n\r\n    void main() {\r\n       \r\n      \r\n        float finalOpacity = repeatTexture().a * vOpacity;\r\n        vec4 finalColor = vec4(vColor, finalOpacity);\r\n        gl_FragColor = getPulse(finalColor);\r\n        \r\n    }\r\n`;\r\n\r\nexport default line2dFragmentShader;\r\n","import * as THREE from \"three\";\nimport Animation from \"../Animation\";\nimport BaseParticle from \"./BaseParticle\";\nimport {\n  effectVertexShader,\n  effectFragmentShader\n} from \"../../renderer/shader\";\n\nconst texture = new THREE.TextureLoader().load(\n  \"/img/effect/effectTextures1024.png\"\n);\n\nclass ParticleEmitter extends Animation {\n  constructor(scene, particleCount, args = {}) {\n    super();\n\n    var blending = args.blending || THREE.AdditiveBlending;\n\n    if (!particleCount) {\n      particleCount = 1000;\n    }\n\n    this.scene = scene;\n\n    this.free = [];\n    for (var i = 0; i < particleCount; i++) {\n      this.free.push(i);\n    }\n\n    this.effects = 0;\n\n    var uniforms = {\n      gameTime: { type: \"f\", value: 0.0 },\n      zoomLevel: { type: \"f\", value: 1.0 },\n      texture: { type: \"t\", value: texture }\n    };\n\n    this.particleGeometry = new THREE.BufferGeometry();\n\n    this.particleGeometry.addAttribute(\n      \"position\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount * 3),\n        3\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"size\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"sizeChange\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"color\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount * 3),\n        3\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"opacity\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"fadeInTime\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"fadeInSpeed\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"fadeOutTime\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"fadeOutSpeed\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"activationGameTime\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"velocity\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount * 3),\n        3\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"acceleration\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount * 3),\n        3\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"textureNumber\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"angle\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"angleChange\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"sine\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n\n    this.particleGeometry.dynamic = true;\n\n    this.particleGeometry.setDrawRange(0, particleCount);\n\n    this.particleMaterial = new THREE.ShaderMaterial({\n      uniforms: uniforms,\n      vertexShader: effectVertexShader,\n      fragmentShader: effectFragmentShader,\n      transparent: true,\n      blending: blending,\n      depthWrite: false,\n      depthTest: false\n    });\n\n    /*\n        THREE.NormalBlending = 0;\n        THREE.AdditiveBlending = 1;\n        THREE.SubtractiveBlending = 2;\n        THREE.MultiplyBlending = 3;\n        THREE.AdditiveAlphaBlending = 4;\n        */\n\n    this.flyParticle = new BaseParticle(\n      this.particleMaterial,\n      this.particleGeometry\n    );\n\n    while (particleCount--) {\n      this.flyParticle.create(particleCount).setInitialValues();\n    }\n\n    this.mesh = new THREE.Points(this.particleGeometry, this.particleMaterial);\n    this.mesh.position.set(0, 0, 0);\n    this.mesh.frustumCulled = false;\n    this.needsUpdate = false;\n\n    this.scene.add(this.mesh);\n  }\n\n  cleanUp() {\n    this.mesh.material.dispose();\n    this.scene.remove(this.mesh);\n  }\n\n  render({ total, zoom }) {\n    this.particleMaterial.uniforms.gameTime.value = total;\n    this.particleMaterial.uniforms.zoomLevel.value = 1 / zoom;\n    this.mesh.material.needsUpdate = true;\n  }\n\n  hasFree() {\n    return this.free.length > 0;\n  }\n\n  getParticle() {\n    if (this.free.length === 0) {\n      return false;\n    }\n\n    var i = this.free.pop();\n\n    return this.flyParticle.create(i);\n  }\n\n  freeParticles(particleIndices) {\n    particleIndices = [].concat(particleIndices);\n\n    particleIndices.forEach(function(i) {\n      this.flyParticle.create(i).setInitialValues();\n    }, this);\n    this.free = this.free.concat(particleIndices);\n  }\n}\n\nexport default ParticleEmitter;\n","import * as THREE from \"three\";\r\nimport { degreeToRadian } from \"../../../../../../model/utils/math.mjs\";\r\nimport Vector from \"../../../../../../model/utils/Vector.mjs\";\r\n\r\nclass BoltInstance {\r\n  constructor(boltContainer) {\r\n    this.boltContainer = boltContainer;\r\n    this.index = null;\r\n  }\r\n\r\n  setIndex(index) {\r\n    this.index = index;\r\n    return this;\r\n  }\r\n\r\n  setOpacity(opacity) {\r\n    this.boltContainer.setOpacity(this.index, opacity);\r\n    return this;\r\n  }\r\n\r\n  setPosition(position) {\r\n    this.boltContainer.setPosition(this.index, position);\r\n    return this;\r\n  }\r\n\r\n  setScale(length = 1, width = 1) {\r\n    this.boltContainer.setScale(this.index, { x: length, y: width, z: width });\r\n    return this;\r\n  }\r\n\r\n  setRotation(rotation) {\r\n    const quaternion = new THREE.Quaternion();\r\n    quaternion.setFromUnitVectors(\r\n      new THREE.Vector3(1, 0, 0).normalize(),\r\n      new Vector(rotation).normalize()\r\n    );\r\n\r\n    this.boltContainer.setQuaternion(this.index, quaternion);\r\n    return this;\r\n  }\r\n\r\n  unsetTexture() {\r\n    this.boltContainer.setTexture(this.index, -1);\r\n    return this;\r\n  }\r\n\r\n  setGasTexture() {\r\n    this.boltContainer.setTexture(this.index, 0);\r\n    return this;\r\n  }\r\n\r\n  setBoltTexture() {\r\n    this.boltContainer.setTexture(this.index, 1);\r\n    return this;\r\n  }\r\n\r\n  setHaloTexture() {\r\n    this.boltContainer.setTexture(this.index, 2);\r\n    return this;\r\n  }\r\n\r\n  setRayTexture() {\r\n    this.boltContainer.setTexture(this.index, 3);\r\n    return this;\r\n  }\r\n\r\n  setColor(color) {\r\n    this.boltContainer.setColor(this.index, color);\r\n    return this;\r\n  }\r\n\r\n  setVelocity(velocity) {\r\n    this.boltContainer.setVelocity(this.index, velocity);\r\n    return this;\r\n  }\r\n\r\n  setActivationTime(time) {\r\n    this.boltContainer.setActivationTime(this.index, time);\r\n    return this;\r\n  }\r\n\r\n  setDeactivationTime(time, fade) {\r\n    this.boltContainer.setDeactivationTime(this.index, time, fade);\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default BoltInstance;\r\n","import BoltInstance from \"./BoltInstance\";\n\nclass BoltContainer {\n  constructor(\n    offsetAttribute,\n    opacityAttribute,\n    textureNumberAttribute,\n    scaleAttribute,\n    quaternionAttribute,\n    colorAttribute,\n    velocityAttribute,\n    activationGameTimeAttribute,\n    deactivationGameTimeAttribute,\n    deactivationFadeAttribute,\n    amount,\n    mesh,\n    scene,\n    numberCreated\n  ) {\n    this.amount = amount;\n    this.offsetAttribute = offsetAttribute;\n    this.opacityAttribute = opacityAttribute;\n    this.textureNumberAttribute = textureNumberAttribute;\n    this.scaleAttribute = scaleAttribute;\n    this.quaternionAttribute = quaternionAttribute;\n    this.colorAttribute = colorAttribute;\n    this.velocityAttribute = velocityAttribute;\n    this.activationGameTimeAttribute = activationGameTimeAttribute;\n    this.deactivationGameTimeAttribute = deactivationGameTimeAttribute;\n    this.deactivationFadeAttribute = deactivationFadeAttribute;\n    this.mesh = mesh;\n    this.scene = scene;\n    this.numberCreated = numberCreated;\n\n    this.free = [];\n    for (let i = 0; i < this.amount; i++) {\n      this.free.push(i);\n    }\n\n    this.flyBolt = new BoltInstance(this);\n  }\n\n  setPosition(position) {\n    this.mesh.position.set(position.x, position.y, 0);\n  }\n\n  setRenderOrder(order) {\n    //console.log(this.mesh.renderOrder);\n    //console.log(\"setting renderOrder \", order);\n    //this.mesh.renderOrder = order;\n  }\n\n  hasFree() {\n    return this.free.length > 0;\n  }\n\n  discard() {\n    this.scene.remove(this.mesh);\n  }\n\n  resetIndex() {\n    this.used = 0;\n  }\n\n  unassignEverything() {\n    const opacitys = [];\n\n    for (let i = 0; i < this.amount; i++) {\n      opacitys.push(0);\n    }\n\n    this.opacityAttribute.setArray(opacitys);\n    this.opacityAttribute.needsUpdate = true;\n\n    this.used = 0;\n  }\n\n  freeParticles(particleIndices) {\n    particleIndices = [].concat(particleIndices);\n\n    particleIndices = particleIndices.filter(\n      index => !this.free.includes(index)\n    );\n\n    particleIndices.forEach(function(i) {\n      this.opacityAttribute.setX(i, 0);\n    }, this);\n\n    this.opacityAttribute.needsUpdate = true;\n\n    this.free = this.free.concat(particleIndices);\n  }\n\n  getParticle() {\n    if (this.free.length === 0) {\n      throw new Error(\"Container is full\");\n    }\n\n    return this.flyBolt.setIndex(this.free.pop());\n  }\n\n  setOpacity(index, opacity) {\n    this.opacityAttribute.setX(index, opacity);\n    this.opacityAttribute.needsUpdate = true;\n  }\n\n  setPosition(index, position) {\n    this.offsetAttribute.setXYZ(index, position.x, position.y, position.z);\n    this.offsetAttribute.needsUpdate = true;\n  }\n\n  setScale(index, scale) {\n    this.scaleAttribute.setXYZ(index, scale.x, scale.y, scale.z);\n    this.scaleAttribute.needsUpdate = true;\n  }\n\n  setQuaternion(index, quaternion) {\n    this.quaternionAttribute.setXYZW(\n      index,\n      quaternion.x,\n      quaternion.y,\n      quaternion.z,\n      quaternion.w\n    );\n\n    this.quaternionAttribute.needsUpdate = true;\n  }\n\n  setTexture(index, texture) {\n    this.textureNumberAttribute.setX(index, texture);\n    this.textureNumberAttribute.needsUpdate = true;\n  }\n\n  setColor(index, color) {\n    this.colorAttribute.setXYZ(index, color.r, color.g, color.b);\n    this.colorAttribute.needsUpdate = true;\n  }\n\n  setVelocity(index, velocity) {\n    this.velocityAttribute.setXYZ(index, velocity.x, velocity.y, velocity.z);\n    this.velocityAttribute.needsUpdate = true;\n  }\n\n  setActivationTime(index, time) {\n    this.activationGameTimeAttribute.setX(index, time);\n    this.activationGameTimeAttribute.needsUpdate = true;\n  }\n\n  setDeactivationTime(index, time, fade = 0) {\n    this.deactivationGameTimeAttribute.setX(index, time);\n    this.deactivationFadeAttribute.setX(index, fade);\n    this.deactivationGameTimeAttribute.needsUpdate = true;\n    this.deactivationFadeAttribute.needsUpdate = true;\n  }\n}\n\nexport default BoltContainer;\n","import { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\r\n\r\nconst loader = new GLTFLoader();\r\n\r\nconst entities = [];\r\n\r\nexport const cloneObject = (source, cloneMaterial = true) => {\r\n  const sourceLookup = new Map();\r\n  const cloneLookup = new Map();\r\n\r\n  const clone = source.scene.clone();\r\n  const animations = source.animations;\r\n\r\n  parallelTraverse(source.scene, clone, function(sourceNode, clonedNode) {\r\n    sourceLookup.set(clonedNode, sourceNode);\r\n    cloneLookup.set(sourceNode, clonedNode);\r\n  });\r\n\r\n  clone.traverse(function(node) {\r\n    if (!node.isSkinnedMesh) return;\r\n\r\n    const clonedMesh = node;\r\n    const sourceMesh = sourceLookup.get(node);\r\n    const sourceBones = sourceMesh.skeleton.bones;\r\n\r\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\r\n    clonedMesh.bindMatrix.copy(sourceMesh.bindMatrix);\r\n\r\n    clonedMesh.skeleton.bones = sourceBones.map(function(bone) {\r\n      return cloneLookup.get(bone);\r\n    });\r\n\r\n    clonedMesh.bind(clonedMesh.skeleton, clonedMesh.bindMatrix);\r\n  });\r\n\r\n  if (cloneMaterial) {\r\n    clone.traverse(node => {\r\n      if (node.isMesh) {\r\n        node.material = node.material.clone();\r\n      }\r\n    });\r\n  }\r\n\r\n  return { scene: clone, animations };\r\n};\r\n\r\nconst parallelTraverse = (a, b, callback) => {\r\n  callback(a, b);\r\n\r\n  for (var i = 0; i < a.children.length; i++) {\r\n    parallelTraverse(a.children[i], b.children[i], callback);\r\n  }\r\n};\r\n\r\nexport const loadObject = async url => {\r\n  const cached = entities.find(entity => entity.url === url);\r\n\r\n  if (cached) {\r\n    const object = await cached.value;\r\n    return cloneObject(object);\r\n  }\r\n\r\n  const entity = {\r\n    url: url,\r\n    value: new Promise((resolve, reject) => {\r\n      loader.load(url, object => {\r\n        resolve(object);\r\n      });\r\n    })\r\n  };\r\n\r\n  entities.push(entity);\r\n\r\n  const object = await entity.value;\r\n  return cloneObject(object);\r\n};\r\n","import * as THREE from \"three\";\r\n\r\nimport { boltVertexShader, boltFragmentShader } from \"../../../renderer/shader\";\r\nimport BoltContainer from \"./BoltContainer\";\r\nimport { loadObject } from \"../../../utils/objectLoader\";\r\n\r\nlet loadedCube = null;\r\nlet numberCreated = 0;\r\n\r\nclass BoltInstanceFactory {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n    this.ready = new Promise(async resolve => {\r\n      if (!loadedCube) {\r\n        loadedCube = await this.loadCube();\r\n      }\r\n\r\n      resolve(true);\r\n    });\r\n\r\n    const texture = new THREE.TextureLoader().load(\r\n      //\"/img/offline.png\"\r\n      \"/img/effect/effectTextures1024.png\"\r\n    );\r\n\r\n    //texture.minFilter = THREE.LinearMipMapNearestFilter;\r\n\r\n    /*\r\n    THREE.NearestFilter\r\nTHREE.NearestMipMapNearestFilter\r\nTHREE.NearestMipMapLinearFilter\r\nTHREE.LinearFilter\r\nTHREE.LinearMipMapNearestFilter\r\nTHREE.LinearMipMapLinearFilter\r\n*/\r\n\r\n    this.material = new THREE.RawShaderMaterial({\r\n      uniforms: {\r\n        map: { value: texture },\r\n        gameTime: { type: \"f\", value: 0.0 },\r\n        zoomLevel: { type: \"f\", value: 0.0 }\r\n      },\r\n      transparent: true,\r\n      depthWrite: false,\r\n      depthTest: false,\r\n      side: THREE.DoubleSide,\r\n      blending: THREE.AdditiveBlending,\r\n      vertexShader: boltVertexShader,\r\n      fragmentShader: boltFragmentShader\r\n      //wireframe: true\r\n    });\r\n\r\n    this.start = Date.now() / 3000;\r\n  }\r\n\r\n  render({ total, zoom }) {\r\n    this.material.uniforms.gameTime.value = total;\r\n    this.material.uniforms.zoomLevel.value = 1 / zoom;\r\n    this.material.needsUpdate = true;\r\n  }\r\n\r\n  create(size = 2000) {\r\n    return this.makeInstanced(loadedCube, size);\r\n  }\r\n\r\n  async loadCube() {\r\n    if (loadedCube) {\r\n      return loadedCube;\r\n    }\r\n\r\n    const cube = await loadObject(\"/img/3d/effect/bolt/scene.gltf\");\r\n    const cubeGeometry = cube.scene.children[0].geometry;\r\n    //cubeGeometry.rotateY((90 * Math.PI) / 180);\r\n    //cubeGeometry.scale(0.5, 0.5, 0.5);\r\n\r\n    loadedCube = cubeGeometry;\r\n    return loadedCube;\r\n  }\r\n\r\n  makeInstanced(original, amount) {\r\n    original = original.clone();\r\n\r\n    let offsetAttribute,\r\n      opacityAttribute,\r\n      textureNumberAttribute,\r\n      scaleAttribute,\r\n      quaternionAttribute,\r\n      colorAttribute,\r\n      velocityAttribute,\r\n      activationGameTimeAttribute,\r\n      deactivationGameTimeAttribute,\r\n      deactivationFadeAttribute;\r\n\r\n    const geometry = new THREE.InstancedBufferGeometry();\r\n    geometry.index = original.index;\r\n    geometry.attributes.position = original.attributes.position;\r\n    geometry.attributes.uv = original.attributes.uv;\r\n\r\n    const offsets = [];\r\n    const opacitys = [];\r\n    const textureNumbers = [];\r\n    const scales = [];\r\n    const quaternions = [];\r\n    const colors = [];\r\n    const velocitys = [];\r\n    const activations = [];\r\n    const deactivations = [];\r\n    const fades = [];\r\n\r\n    for (let i = 0; i < amount; i++) {\r\n      offsets.push(0, 0, 0.5);\r\n      opacitys.push(0);\r\n      textureNumbers.push(-1);\r\n      scales.push(1, 1, 1);\r\n      quaternions.push(0, 1, 0, 0);\r\n      colors.push(0, 0, 0);\r\n      velocitys.push(0, 0, 0);\r\n      activations.push(0);\r\n      deactivations.push(0);\r\n      fades.push(0);\r\n    }\r\n\r\n    offsetAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(offsets),\r\n      3\r\n    ).setDynamic(true);\r\n\r\n    opacityAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(opacitys),\r\n      1\r\n    ).setDynamic(true);\r\n\r\n    textureNumberAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(textureNumbers),\r\n      1\r\n    ).setDynamic(true);\r\n\r\n    scaleAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(scales),\r\n      3\r\n    ).setDynamic(true);\r\n\r\n    quaternionAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(quaternions),\r\n      4\r\n    ).setDynamic(true);\r\n\r\n    colorAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(colors),\r\n      3\r\n    ).setDynamic(true);\r\n\r\n    velocityAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(velocitys),\r\n      3\r\n    ).setDynamic(true);\r\n\r\n    activationGameTimeAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(activations),\r\n      1\r\n    ).setDynamic(true);\r\n\r\n    deactivationGameTimeAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(deactivations),\r\n      1\r\n    ).setDynamic(true);\r\n\r\n    deactivationFadeAttribute = new THREE.InstancedBufferAttribute(\r\n      new Float32Array(fades),\r\n      1\r\n    ).setDynamic(true);\r\n\r\n    geometry.addAttribute(\"offset\", offsetAttribute);\r\n    geometry.addAttribute(\"opacity\", opacityAttribute);\r\n    geometry.addAttribute(\"textureNumber\", textureNumberAttribute);\r\n    geometry.addAttribute(\"scale\", scaleAttribute);\r\n    geometry.addAttribute(\"quaternion\", quaternionAttribute);\r\n    geometry.addAttribute(\"color\", colorAttribute);\r\n    geometry.addAttribute(\"velocity\", velocityAttribute);\r\n    geometry.addAttribute(\"activationGameTime\", activationGameTimeAttribute);\r\n    geometry.addAttribute(\r\n      \"deactivationGameTime\",\r\n      deactivationGameTimeAttribute\r\n    );\r\n    geometry.addAttribute(\"deactivationFade\", deactivationFadeAttribute);\r\n\r\n    const mesh = new THREE.Mesh(geometry, this.material);\r\n    mesh.frustumCulled = false;\r\n\r\n    this.scene.add(mesh);\r\n\r\n    numberCreated++;\r\n\r\n    return new BoltContainer(\r\n      offsetAttribute,\r\n      opacityAttribute,\r\n      textureNumberAttribute,\r\n      scaleAttribute,\r\n      quaternionAttribute,\r\n      colorAttribute,\r\n      velocityAttribute,\r\n      activationGameTimeAttribute,\r\n      deactivationGameTimeAttribute,\r\n      deactivationFadeAttribute,\r\n      amount,\r\n      mesh,\r\n      this.scene,\r\n      numberCreated\r\n    );\r\n  }\r\n}\r\n\r\nexport default BoltInstanceFactory;\r\n","const boltVertexShader = `\n    precision highp float;\n    uniform mat4 modelMatrix;\n    uniform mat4 viewMatrix;\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n    uniform float gameTime;\n    uniform float zoomLevel;\n    attribute vec3 position;\n    attribute vec3 offset;\n    attribute float opacity;\n    attribute vec2 uv;\n    attribute float textureNumber;\n    attribute vec3 scale;\n    attribute vec4 quaternion;\n    attribute vec3 color;\n    attribute vec3 velocity;\n    attribute float activationGameTime;\n    attribute float deactivationGameTime;\n    attribute float deactivationFade;\n    varying float vActivationGameTime;\n    varying float vDeactivationGameTime;\n    varying vec3 vColor;\n    varying vec2 vUv;\n    varying float vOpacity;\n\n    float getScale() {\n        return 1.0;\n    }\n\n    vec2 resolveUv() {\n        float textureAmount = 8.0;\n        vec2 tPos = vec2(\n            (mod(textureNumber, textureAmount) * (1.0 / textureAmount)),\n            (floor(textureNumber / textureAmount) * (1.0 / textureAmount))\n        );\n        \n        vec2 finalPos = vec2((uv.x / textureAmount + tPos.x), 1.0 - (uv.y / textureAmount + tPos.y));\n\n        return finalPos;\n    }\n\n    // http://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/\n    vec3 applyQuaternionToVector(vec3 v ){\n        return v + 2.0 * cross( quaternion.xyz, cross( quaternion.xyz, v ) + quaternion.w * v );\n    }\n\n    float getTimeToEnd() {\n        float speed = length(velocity);\n\n        if (speed > 0.0) {  \n            float length = scale.x;\n            float timeToEnd = length / speed;\n            return timeToEnd ;\n        } else {  \n            return 0.0;\n        }\n    }\n\n    float getFadeOpacity() {\n\n        if (deactivationFade == 0.0) {\n            return 1.0;\n        }\n\n        if (gameTime < (deactivationGameTime - deactivationFade)) {\n            return 1.0;\n        }\n\n        float fade = gameTime - (deactivationGameTime - deactivationFade);\n\n        if (fade > deactivationFade) {\n            fade = deactivationFade;\n        }\n\n        float ratio = fade / deactivationFade;\n\n        return 1.0 - ratio;\n        \n    }\n\n    int active(float vertexDeltaTime) {\n        if (opacity == 0.0) {\n            return 0;\n        }\n\n        if (activationGameTime > gameTime) {\n            return 0;\n        }\n\n        if (deactivationGameTime + vertexDeltaTime < gameTime) {\n            return 0;\n        }\n        \n        return 1;\n    }\n\n    void main() {\n\n        float timeToEnd = getTimeToEnd();\n\n        if (active(timeToEnd) == 0) {\n            gl_Position = vec4(0.0);\n            vOpacity = 0.0;\n            return;\n        }\n\n        float currentOpacity = opacity;\n\n        if (zoomLevel < 1.0) {\n            currentOpacity += (1.0 - zoomLevel) * 0.5;\n        }\n\n        float elapsedTime = gameTime - activationGameTime;\n\n        vOpacity = currentOpacity * getFadeOpacity();\n        vUv = resolveUv();\n        vColor = color;\n        vActivationGameTime = activationGameTime + timeToEnd * uv.y;\n        vDeactivationGameTime = deactivationGameTime + timeToEnd * uv.y;\n        \n\n        \n        gl_Position = projectionMatrix * modelViewMatrix * vec4((offset + velocity * elapsedTime) + applyQuaternionToVector(position * scale), 1.0 );      \n     \n        //gl_Position = projectionMatrix * modelViewMatrix * vec4( offset + applyQuaternionToVector(position) * scale, 1.0 );      \n      }\n\n`;\n\nexport default boltVertexShader;\n","const boltFragmentShader = `\r\n    precision highp float;\r\n    uniform sampler2D map;\r\n    uniform float gameTime;\r\n    varying vec2 vUv;\r\n    varying float vOpacity;\r\n    varying vec3 vColor;\r\n    varying float vActivationGameTime;\r\n    varying float vDeactivationGameTime;\r\n\r\n    void main() {\r\n        if (vOpacity == 0.0) {\r\n            discard;\r\n        }\r\n\r\n        if (vActivationGameTime > gameTime) {\r\n            discard;\r\n        }\r\n\r\n        if (vDeactivationGameTime < gameTime) {\r\n            discard;\r\n        }\r\n\r\n        vec4 finalColor = vec4(vColor.rgb, texture2D(map, vUv).a * vOpacity);\r\n        gl_FragColor = finalColor;\r\n    }\r\n`;\r\n\r\nexport default boltFragmentShader;\r\n","import Animation from \"../Animation\";\nimport ParticleEmitter from \"./ParticleEmitter\";\nimport { StarParticleEmitter } from \".\";\nimport BoltInstanceFactory from \"./BoltParticleEmitter/BoltInstanceFactory\";\n\nclass ParticleEmitterContainer {\n  constructor(scene, defaultParticleAmount) {\n    this.scene = scene;\n    this.defaultParticleAmount = defaultParticleAmount;\n\n    this.boltInstanceFactory = new BoltInstanceFactory(this.scene);\n\n    this.reservations = [];\n\n    this.emitters = {\n      star: [],\n      bolt: [],\n      effect: []\n    };\n\n    this._isReady = false;\n    this.readyPromise = new Promise(async resolve => {\n      await this.boltInstanceFactory.ready;\n      this._isReady = true;\n      resolve(true);\n    });\n  }\n\n  ready() {\n    return this.readyPromise;\n  }\n\n  isReady() {\n    return this._isReady;\n  }\n\n  createParticleEmitter(type) {\n    switch (type) {\n      case \"star\":\n        return this.createStarParticleEmitter();\n      case \"bolt\":\n        return this.createBoltParticleEmitter();\n      case \"effect\":\n      default:\n        return this.createEffectParticleEmitter();\n    }\n  }\n\n  createStarParticleEmitter() {\n    return new StarParticleEmitter(this.scene, this.defaultParticleAmount);\n  }\n\n  createEffectParticleEmitter() {\n    return new ParticleEmitter(this.scene, this.defaultParticleAmount);\n  }\n\n  createBoltParticleEmitter() {\n    return this.boltInstanceFactory.create(this.defaultParticleAmount);\n  }\n\n  getParticle(reserver, type = \"effect\") {\n    let emitter = this.emitters[type].find(emitter => emitter.hasFree());\n\n    if (!emitter) {\n      emitter = this.createParticleEmitter(type);\n      this.emitters[type].push(emitter);\n    }\n\n    const particle = emitter.getParticle();\n\n    this.reservations.push({ reserver, emitter, index: particle.index });\n\n    return particle;\n  }\n\n  getStarParticle(reserver) {\n    return this.getParticle(reserver, \"star\");\n  }\n\n  getBoltParticle(reserver) {\n    return this.getParticle(reserver, \"bolt\");\n  }\n\n  getEffectParticle(reserver) {\n    return this.getParticle(reserver, \"effect\");\n  }\n\n  cleanUp() {\n    this.emitters.star.forEach(emitter => {\n      emitter.cleanUp();\n    });\n\n    this.emitters.bolt.forEach(emitter => {\n      emitter.cleanUp();\n    });\n\n    this.emitters.effect.forEach(emitter => {\n      emitter.cleanUp();\n    });\n\n    this.emitters = {\n      star: [],\n      bolt: [],\n      effect: []\n    };\n  }\n\n  release(reserver) {\n    this.reservations.forEach(reservation => {\n      if (reservation.reserver === reserver) {\n        reservation.emitter.freeParticles(reservation.index);\n      }\n    });\n  }\n\n  render(payload) {\n    this.emitters.star.forEach(emitter => {\n      emitter.render(payload);\n    });\n\n    this.emitters.effect.forEach(emitter => {\n      emitter.render(payload);\n    });\n\n    this.boltInstanceFactory.render(payload);\n  }\n}\n\nexport default ParticleEmitterContainer;\n","import * as THREE from \"three\";\nimport { degreeToRadian } from \"../../../../../model/utils/math\";\n\nconst changeAttribute = (geometry, index, key, values) => {\n  values = [].concat(values);\n\n  var target = geometry.attributes[key].array;\n\n  values.forEach(function(value, i) {\n    target[index * values.length + i] = value;\n  });\n\n  geometry.attributes[key].needsUpdate = true;\n};\n\nclass StarParticle {\n  constructor(material, geometry) {\n    this.material = material;\n    this.geometry = geometry;\n    this.index = 0;\n\n    this.texture = {\n      gas: 0,\n      bolt: 1,\n      glow: 2,\n      ring: 3,\n      starLine: 4\n    };\n  }\n\n  create(index) {\n    this.index = index;\n    return this;\n  }\n\n  setInitialValues() {\n    this.setPosition({ x: 0, y: 0 });\n    this.setColor(new THREE.Color(0, 0, 0));\n    this.setOpacity(0.0);\n    this.setSize(0.0);\n    this.setSizeChange(0.0);\n    this.setAngle(0.0);\n    this.setAngleChange(0.0);\n    this.setActivationTime(0.0);\n    this.setTexture(this.texture.glow);\n    this.setParallaxFactor(0.0);\n    this.setSineFrequency(0.0);\n    this.setSineAmplitude(1);\n\n    return this;\n  }\n\n  setTexture(tex) {\n    changeAttribute(this.geometry, this.index, \"textureNumber\", tex);\n\n    return this;\n  }\n\n  setParallaxFactor(parallaxFactor) {\n    changeAttribute(\n      this.geometry,\n      this.index,\n      \"parallaxFactor\",\n      -1.0 + parallaxFactor\n    );\n    return this;\n  }\n\n  setSineFrequency(sineFrequency) {\n    changeAttribute(this.geometry, this.index, \"sineFrequency\", sineFrequency);\n    return this;\n  }\n\n  setSineAmplitude(sineAmplitude) {\n    changeAttribute(this.geometry, this.index, \"sineAmplitude\", sineAmplitude);\n    return this;\n  }\n\n  setSize(size) {\n    changeAttribute(this.geometry, this.index, \"size\", size);\n    return this;\n  }\n\n  setSizeChange(size) {\n    changeAttribute(this.geometry, this.index, \"sizeChange\", size);\n    return this;\n  }\n\n  setColor(color) {\n    changeAttribute(this.geometry, this.index, \"color\", [\n      color.r,\n      color.g,\n      color.b\n    ]);\n    return this;\n  }\n\n  setOpacity(opacity) {\n    changeAttribute(this.geometry, this.index, \"opacity\", opacity);\n    return this;\n  }\n\n  setPosition(pos) {\n    changeAttribute(\n      this.geometry,\n      this.index,\n      \"position\",\n      [pos.x, pos.y, pos.z || 0],\n      true\n    );\n    return this;\n  }\n\n  setAngle(angle) {\n    changeAttribute(this.geometry, this.index, \"angle\", degreeToRadian(angle));\n    return this;\n  }\n\n  setAngleChange(angle) {\n    changeAttribute(\n      this.geometry,\n      this.index,\n      \"angleChange\",\n      degreeToRadian(angle)\n    );\n    return this;\n  }\n\n  deactivate() {\n    this.setInitialValues();\n    return this;\n  }\n\n  setActivationTime(gameTime) {\n    changeAttribute(this.geometry, this.index, \"activationGameTime\", gameTime);\n    return this;\n  }\n}\n\nexport default StarParticle;\n","import * as THREE from \"three\";\nimport Animation from \"../Animation\";\nimport StarParticle from \"./StarParticle\";\nimport { starVertexShader, starFragmentShader } from \"../../renderer/shader\";\n\nconst texture = new THREE.TextureLoader().load(\n  \"/img/effect/effectTextures1024.png\"\n);\n\nclass StarParticleEmitter extends Animation {\n  constructor(scene, particleCount, args) {\n    super();\n\n    if (!args) {\n      args = {};\n    }\n\n    var blending = args.blending || THREE.AdditiveBlending;\n\n    if (!particleCount) {\n      particleCount = 1000;\n    }\n\n    this.scene = scene;\n\n    this.free = [];\n    for (var i = 0; i < particleCount; i++) {\n      this.free.push(i);\n    }\n\n    this.effects = 0;\n\n    var uniforms = {\n      gameTime: { type: \"f\", value: 0.0 },\n      texture: { type: \"t\", value: texture }\n    };\n\n    this.particleGeometry = new THREE.BufferGeometry();\n\n    this.particleGeometry.addAttribute(\n      \"position\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount * 3),\n        3\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"size\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"sizeChange\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"color\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount * 3),\n        3\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"opacity\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"activationGameTime\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"textureNumber\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"angle\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"angleChange\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"parallaxFactor\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"sineFrequency\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n    this.particleGeometry.addAttribute(\n      \"sineAmplitude\",\n      new THREE.Float32BufferAttribute(\n        new Float32Array(particleCount),\n        1\n      ).setDynamic(true)\n    );\n\n    this.particleGeometry.dynamic = true;\n\n    this.particleGeometry.setDrawRange(0, particleCount);\n\n    this.particleMaterial = new THREE.ShaderMaterial({\n      uniforms: uniforms,\n      vertexShader: starVertexShader,\n      fragmentShader: starFragmentShader,\n      transparent: true,\n      blending: blending,\n      depthWrite: false //Try removing this if problems with transparency\n    });\n\n    /*\n        THREE.NormalBlending = 0;\n        THREE.AdditiveBlending = 1;\n        THREE.SubtractiveBlending = 2;\n        THREE.MultiplyBlending = 3;\n        THREE.AdditiveAlphaBlending = 4;\n        */\n\n    this.flyParticle = new StarParticle(\n      this.particleMaterial,\n      this.particleGeometry\n    );\n\n    while (particleCount--) {\n      this.flyParticle.create(particleCount).setInitialValues();\n    }\n\n    this.mesh = new THREE.Points(this.particleGeometry, this.particleMaterial);\n    this.mesh.frustumCulled = false;\n    //this.mesh.matrixAutoUpdate = false;\n    this.mesh.position.set(0, 0, args.z || -10);\n\n    this.needsUpdate = false;\n\n    this.scene.add(this.mesh);\n  }\n\n  cleanUp() {\n    this.mesh.material.dispose();\n    this.scene.remove(this.mesh);\n  }\n\n  render({ total }) {\n    this.particleMaterial.uniforms.gameTime.value = total;\n    this.mesh.material.needsUpdate = true;\n  }\n\n  hasFree() {\n    return this.free.length > 0;\n  }\n\n  getParticle() {\n    if (this.free.length === 0) {\n      return false;\n    }\n\n    var i = this.free.pop();\n\n    return this.flyParticle.create(i);\n  }\n\n  freeParticles(particleIndices) {\n    particleIndices = [].concat(particleIndices);\n\n    particleIndices.forEach(function(i) {\n      this.flyParticle.create(i).setInitialValues();\n    }, this);\n    this.free = this.free.concat(particleIndices);\n  }\n}\n\nexport default StarParticleEmitter;\n","const starVertexShader = `\r\n    attribute vec3 color;\r\n    attribute float opacity;\r\n    attribute float size;\r\n    attribute float sizeChange;\r\n    attribute float angle;\r\n    attribute float angleChange;\r\n    attribute float activationGameTime;\r\n    attribute float textureNumber;\r\n    attribute float parallaxFactor;\r\n    attribute float sineFrequency;\r\n    attribute float sineAmplitude;\r\n    uniform float gameTime;\r\n    varying vec4  vColor;\r\n    varying float vAngle;\r\n    varying float textureN;\r\n    void main()\r\n    {\r\n    \r\n        float elapsedTime = gameTime - activationGameTime;\r\n\r\n        if (elapsedTime < 0.0) {\r\n            gl_PointSize = 0.0;\r\n            gl_Position = vec4( 0.0, 0.0, 0.0, 1.0 );\r\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\r\n            textureN = textureNumber;\r\n            return;\r\n        }\r\n        \r\n\r\n        float currentOpacity = opacity;\r\n        if (sineFrequency > 0.0) {\r\n            currentOpacity = opacity + (sineAmplitude * 0.5 * sin(gameTime/sineFrequency) + sineAmplitude);\r\n        }\r\n\r\n        if ( currentOpacity > 0.0 && elapsedTime >= 0.0)\r\n        {\r\n            vColor = vec4( color, currentOpacity );\r\n        } else {\r\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\r\n        }\r\n\r\n        vAngle = angle + angleChange * elapsedTime;\r\n        textureN = textureNumber;\r\n\r\n        vec3 modPos = vec3( position.x - (cameraPosition.x * parallaxFactor), position.y - (cameraPosition.y * parallaxFactor), position.z );\r\n\r\n\r\n        gl_PointSize = clamp(size + (sizeChange * elapsedTime), 0.0, 1024.0);\r\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( modPos, 1.0 );\r\n        \r\n    }\r\n`;\r\n\r\nexport default starVertexShader;\r\n","const starFragmentShader = `\r\n    uniform sampler2D texture;\r\n    varying vec4 vColor;\r\n    varying float vAngle;\r\n    varying float textureN;\r\n    void main()\r\n    {\r\n        gl_FragColor = vColor;\r\n        if (gl_FragColor.a == 0.0) {\r\n            return;\r\n        }\r\n\r\n        float c = cos(vAngle);\r\n        float s = sin(vAngle);\r\n        float textureAmount = 8.0;\r\n        vec2 tPos = vec2((mod(textureN, textureAmount) * (1.0 / textureAmount)), (floor(textureN / textureAmount) * (1.0 / textureAmount)));\r\n\r\n        vec2 pos = vec2(gl_PointCoord.x, gl_PointCoord.y);\r\n        vec2 tCen = vec2(0.5, 0.5);\r\n\r\n        vec2 rPos = vec2(\r\n            tCen.x + c * (pos.x - tCen.x) - s * (pos.y - tCen.y),\r\n            tCen.y + s * (pos.x - tCen.x) + c * (pos.y - tCen.y)\r\n        );\r\n\r\n        rPos = clamp(rPos, 0.0, 1.0);\r\n\r\n        vec2 finalPos = vec2(\r\n            (rPos.x / textureAmount + tPos.x),\r\n            1.0 - (rPos.y / textureAmount + tPos.y)\r\n        );\r\n\r\n        vec4 rotatedTexture = texture2D(texture, finalPos);\r\n        gl_FragColor = gl_FragColor * rotatedTexture;\r\n    }\r\n`;\r\n\r\nexport default starFragmentShader;\r\n","import * as THREE from \"three\";\nimport {\n  ParticleEmitterContainer,\n  StarParticleEmitter\n} from \"../animation/particle\";\n\nimport { getSeededRandomGenerator } from \"../../../../model/utils/math\";\n\nclass StarField {\n  constructor(scene, gameId) {\n    this.starCount = 5000;\n    this.emitterContainer = new ParticleEmitterContainer(scene, this.starCount);\n    this.scene = scene;\n    this.lastAnimationTime = null;\n    this.totalAnimationTime = 0;\n    this.zoomChanged = 0;\n    this.gameId = gameId;\n\n    this.getRandom = null;\n\n    this.create();\n  }\n\n  async create() {\n    await this.emitterContainer.ready();\n    //this.scene.background = new THREE.Color(10 / 255, 10 / 255, 30 / 255);\n\n    //this.webglScene.scene.background = new THREE.Color(10/255, 10/255, 30/255);\n    var width = 3000; //this.webglScene.width * 1.5;\n    var height = 2000; // this.webglScene.height * 1.5;\n\n    this.getRandom = getSeededRandomGenerator(this.gameId);\n\n    //var stars = Math.floor(this.starCount * (width / 4000));\n    var stars = this.starCount;\n    while (stars--) {\n      this.createStar(width, height);\n\n      if (this.getRandom() > 0.98) {\n        this.createShiningStar(width, height);\n      }\n    }\n\n    //var gas = Math.floor(this.getRandom() * 5) + 8;\n\n    /*\n        while(gas--){\n            this.createGasCloud(width, height)\n        }\n        */\n\n    this.lastAnimationTime = new Date().getTime();\n    this.totalAnimationTime = 0;\n    this.zoomChanged = 1;\n    return this;\n  }\n\n  resize() {}\n\n  cleanUp() {\n    this.emitterContainer.release(this);\n  }\n\n  render() {\n    if (!this.emitterContainer.isReady()) {\n      return;\n    }\n\n    var deltaTime = new Date().getTime() - this.lastAnimationTime;\n    this.totalAnimationTime += deltaTime;\n    this.emitterContainer.render({\n      delta: 0,\n      total: this.totalAnimationTime,\n      last: 0,\n      zoom: this.zoomChanged\n    });\n\n    if (this.zoomChanged === 1) {\n      this.zoomChanged = 0;\n    }\n\n    this.lastAnimationTime = new Date().getTime();\n  }\n\n  createStar(width, height) {\n    var particle = this.emitterContainer.getStarParticle(this);\n\n    var x = (this.getRandom() - 0.5) * width * 1.5;\n    var y = (this.getRandom() - 0.5) * height * 1.5;\n\n    particle\n      .setActivationTime(0)\n      .setSize(2 + this.getRandom() * 2)\n      .setOpacity(this.getRandom() * 0.2 + 0.9)\n      .setPosition({ x: x, y: y })\n      .setColor(new THREE.Color(1, 1, 1))\n      .setParallaxFactor(0.1 + this.getRandom() * 0.1);\n\n    if (this.getRandom() > 0.9) {\n      particle\n        .setSineFrequency(this.getRandom() * 200 + 50)\n        .setSineAmplitude(this.getRandom());\n    }\n  }\n\n  createShiningStar(width, height) {\n    var particle = this.emitterContainer.getStarParticle(this);\n\n    var x = (this.getRandom() - 0.5) * width * 1.5;\n    var y = (this.getRandom() - 0.5) * height * 1.5;\n\n    var size = 6 + this.getRandom() * 6;\n    var parallaxFactor = 0.1 + this.getRandom() * 0.1;\n    var color = new THREE.Color(\n      this.getRandom() * 0.4 + 0.6,\n      this.getRandom() * 0.2 + 0.8,\n      this.getRandom() * 0.4 + 0.6\n    );\n\n    particle\n      .setActivationTime(0)\n      .setSize(size * 0.5)\n      .setOpacity(this.getRandom() * 0.2 + 0.9)\n      .setPosition({ x: x, y: y })\n      .setColor(new THREE.Color(1, 1, 1))\n      .setParallaxFactor(parallaxFactor);\n\n    particle = this.emitterContainer.getStarParticle(this);\n    particle\n      .setActivationTime(0)\n      .setSize(size)\n      .setOpacity(this.getRandom() * 0.1 + 0.1)\n      .setPosition({ x: x, y: y })\n      .setColor(color)\n      .setParallaxFactor(parallaxFactor)\n      .setSineFrequency(this.getRandom() * 200 + 100)\n      .setSineAmplitude(this.getRandom() * 0.4);\n\n    var shines = Math.round(this.getRandom() * 8) - 3;\n\n    if (shines <= 2) {\n      return;\n    }\n\n    var angle = this.getRandom() * 360;\n    var angleChange = (this.getRandom() - 0.5) * 0.01;\n\n    while (shines--) {\n      angle += this.getRandom() * 60 + 40;\n      particle = this.emitterContainer.getStarParticle(this);\n      particle\n        .setActivationTime(0)\n        .setSize(size * this.getRandom() * 10 + 10)\n        .setOpacity(this.getRandom() * 0.1 + 0.1)\n        .setPosition({ x: x, y: y })\n        .setColor(color)\n        .setParallaxFactor(parallaxFactor)\n        .setSineFrequency(this.getRandom() * 200 + 100)\n        .setSineAmplitude(0.1)\n        .setAngle(angle)\n        .setAngleChange(angleChange)\n        .setTexture(particle.texture.starLine);\n    }\n  }\n\n  createGasCloud(width, height) {\n    var position = {\n      x: (this.getRandom() - 0.5) * width,\n      y: (this.getRandom() - 0.5) * height\n    };\n\n    var vector = {\n      x: (this.getRandomBand(0.5, 1) * width) / 100,\n      y: (this.getRandomBand(0.5, 1) * width) / 100\n    };\n\n    var iterations = Math.floor(this.getRandom() * 3) + 5;\n\n    while (iterations--) {\n      this.createGasCloudPart({ x: position.x, y: position.y }, width);\n      position.x += this.getRandomBand(0, 1) * 50 + vector.x;\n      position.y += this.getRandomBand(0, 1) * 50 + vector.y;\n    }\n  }\n\n  getRandomBand(min, max) {\n    var random = this.getRandom() * (max - min) + min;\n    return this.getRandom() > 0.5 ? random * -1 : random;\n  }\n\n  createGasCloudPart(position, width) {\n    var gas = Math.floor(this.getRandom() * 5 + 5);\n    var baseRotation = (this.getRandom() - 0.5) * 0.002;\n\n    while (gas--) {\n      this.createGas(\n        position,\n        baseRotation,\n        this.getRandom() * width * 0.4 + width * 0.4\n      );\n    }\n  }\n\n  createGas(position, baseRotation, size) {\n    var particle = this.emitterContainer.getStarParticle(this);\n\n    position.x += (this.getRandom() - 0.5) * 100;\n    position.y += (this.getRandom() - 0.5) * 100;\n\n    particle\n      .setActivationTime(0)\n      .setSize(this.getRandom() * size * 0.5 + size * 0.5)\n      .setOpacity(this.getRandom() * 0.005 + 0.005)\n      .setPosition({ x: position.x, y: position.y })\n      .setColor(new THREE.Color(104 / 255, 204 / 255, 249 / 255))\n      .setTexture(particle.texture.gas)\n      .setAngle(this.getRandom() * 360)\n      .setAngleChange(baseRotation + (this.getRandom() - 0.5) * 0.001)\n      .setParallaxFactor(0.1 + this.getRandom() * 0.1);\n\n    if (this.getRandom() > 0.9) {\n      particle\n        .setActivationTime(0)\n        .setSize(this.getRandom() * size * 0.25 + size * 0.25)\n        .setOpacity(0)\n        .setPosition({ x: position.x, y: position.y })\n        .setColor(new THREE.Color(1, 1, 1))\n        .setTexture(particle.texture.gas)\n        .setAngle(this.getRandom() * 360)\n        .setAngleChange(baseRotation + (this.getRandom() - 0.5) * 0.01)\n        .setParallaxFactor(0.1 + this.getRandom() * 0.1)\n        .setSineFrequency(this.getRandom() * 200 + 200)\n        .setSineAmplitude(this.getRandom() * 0.02);\n    }\n  }\n}\n\nexport default StarField;\n","import * as THREE from \"three\";\r\nimport StarField from \"../game/terrain/StarField\";\r\n\r\nwindow.THREE = THREE;\r\n\r\nclass HomeScene {\r\n  constructor() {\r\n    this.starFieldScene = null;\r\n    this.starFieldCamera = null;\r\n    this.starField = null;\r\n    this.width = null;\r\n    this.height = null;\r\n    this.element = null;\r\n    this.initialized = false;\r\n\r\n    this.zoom = 1;\r\n  }\r\n\r\n  init(element, { width, height }) {\r\n    this.element = element;\r\n    this.scene = new THREE.Scene();\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n    this.starFieldScene = new THREE.Scene();\r\n    this.starFieldCamera = new THREE.OrthographicCamera(\r\n      (this.zoom * this.width) / -2,\r\n      (this.zoom * this.width) / 2,\r\n      (this.zoom * this.height) / 2,\r\n      (this.zoom * this.height) / -2,\r\n      -4000,\r\n      30000\r\n    );\r\n\r\n    this.starFieldCamera.position.set(0, 0, 500);\r\n    this.starFieldCamera.lookAt(0, 0, 100);\r\n\r\n    this.renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });\r\n    this.renderer.setPixelRatio(window.devicePixelRatio);\r\n    this.renderer.setSize(this.width, this.height);\r\n    this.renderer.autoClear = false;\r\n    this.renderer.context.getExtension(\"OES_standard_derivatives\");\r\n    this.renderer.gammaOutput = true;\r\n    this.renderer.gammaFactor = 2.2;\r\n    element.appendChild(this.renderer.domElement);\r\n\r\n    this.initialized = true;\r\n    this.starField = new StarField(this.starFieldScene, \"home\");\r\n\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    this.renderer.clear();\r\n    this.renderer.render(this.starFieldScene, this.starFieldCamera);\r\n    this.starField.render();\r\n\r\n    requestAnimationFrame(this.render.bind(this));\r\n  }\r\n\r\n  onResize({ width, height }) {\r\n    this.width = width;\r\n    this.height = height;\r\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    this.starField.resize();\r\n  }\r\n}\r\n\r\nexport default HomeScene;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport HomeScene from \"./HomeScene\";\r\n\r\nconst WebglCanvas = styled.div`\r\n  position: fixed;\r\n  top: 0px;\r\n  bottom: 0px;\r\n  left: 0px;\r\n  right: 0px;\r\n  display: flex;\r\n  background-size: cover;\r\n  background-color: #0b121a;\r\n  box-shadow: inset 0px 0px 200px rgba(0, 0, 0, 1);\r\n  z-index: -2;\r\n`;\r\n\r\nclass HomeSceneComponent extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.canvasRef = React.createRef();\r\n    this.scene = new HomeScene();\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.addEventListener(\"resize\", this.onResize.bind(this));\r\n\r\n    const sceneElement = this.canvasRef.current;\r\n\r\n    this.scene.init(sceneElement, this.getDimensions());\r\n  }\r\n\r\n  getDimensions() {\r\n    return {\r\n      width: this.canvasRef.current.offsetWidth,\r\n      height: this.canvasRef.current.offsetHeight\r\n    };\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener(\"resize\", this.onResize.bind(this));\r\n  }\r\n\r\n  onResize() {\r\n    if (!this.canvasRef.current) {\r\n      return;\r\n    }\r\n\r\n    const dimensions = this.getDimensions();\r\n    this.scene.onResize(dimensions);\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    return false;\r\n  }\r\n\r\n  render() {\r\n    return <WebglCanvas ref={this.canvasRef} />;\r\n  }\r\n}\r\n\r\nexport default HomeSceneComponent;\r\n","const SERVER_URL = \"http://localhost:4000\";\r\nconst SERVER_WEBSOCKET_URL = \"ws://localhost:4000/game/\";\r\n\r\nexport { SERVER_URL, SERVER_WEBSOCKET_URL };\r\n","import axios from \"axios\";\r\nimport { SERVER_URL } from \"../config\";\r\n\r\nconst axiosConfig = {\r\n  withCredentials: true,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\"\r\n  }\r\n};\r\n\r\nexport const login = async (username, password) => {\r\n  try {\r\n    return await axios.post(\r\n      `${SERVER_URL}/login`,\r\n      {\r\n        username,\r\n        password\r\n      },\r\n      axiosConfig\r\n    );\r\n  } catch (error) {\r\n    throw error.response;\r\n  }\r\n};\r\n\r\nexport const register = async (username, password) => {\r\n  try {\r\n    return await axios.post(\r\n      `${SERVER_URL}/register`,\r\n      {\r\n        username,\r\n        password\r\n      },\r\n      axiosConfig\r\n    );\r\n  } catch (error) {\r\n    throw error.response;\r\n  }\r\n};\r\n\r\nexport const getCurrentUser = async () => {\r\n  try {\r\n    return await axios.get(`${SERVER_URL}/user`, axiosConfig);\r\n  } catch (error) {\r\n    throw error.response;\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    return await axios.get(`${SERVER_URL}/logout`, axiosConfig);\r\n  } catch (error) {\r\n    throw error.response;\r\n  }\r\n};\r\n","import axios from \"axios\";\r\nimport { SERVER_URL } from \"../config\";\r\n\r\nconst axiosConfig = {\r\n  withCredentials: true,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\"\r\n  }\r\n};\r\n\r\nexport const createGame = async gameData => {\r\n  try {\r\n    return axios.post(`${SERVER_URL}/game`, gameData.serialize(), axiosConfig);\r\n  } catch (error) {\r\n    throw error.response;\r\n  }\r\n};\r\n","class User {\r\n  constructor(id, username, accessLevel = 1) {\r\n    this.id = id;\r\n    this.username = username;\r\n    this.accessLevel = accessLevel;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      id: this.id,\r\n      username: this.username,\r\n      accessLevel: this.accessLevel\r\n    };\r\n  }\r\n\r\n  deserialize(data) {\r\n    this.id = data.id;\r\n    this.username = data.username;\r\n    this.accessLevel = data.accessLevel;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default User;\r\n","import { user } from \"../api\";\r\nimport User from \"../../model/User.mjs\";\r\n\r\nconst actionTypes = {\r\n  GET_CURRENT_USER: \"GET_CURRENT_USER\"\r\n};\r\n\r\nexport const getCurrentUser = async dispatch => {\r\n  const payload = await user.getCurrentUser();\r\n  dispatch({\r\n    type: actionTypes.GET_CURRENT_USER,\r\n    payload: payload\r\n  });\r\n};\r\n\r\nexport const reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"GET_CURRENT_USER\":\r\n      const user = action.payload.data\r\n        ? new User().deserialize(action.payload.data)\r\n        : null;\r\n      return {\r\n        ...state,\r\n        currentUser: user\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import React, { useReducer, useEffect } from \"react\";\r\nimport { reducer, getCurrentUser } from \"./actions\";\r\n\r\nexport const StateStore = React.createContext({});\r\nexport const DispatchStore = React.createContext({});\r\n\r\nconst initialState = {\r\n  currentUser: undefined\r\n};\r\n\r\nconst StoreProvider = ({ children }) => {\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n\r\n  useEffect(() => {\r\n    getCurrentUser(dispatch);\r\n  }, []);\r\n\r\n  return (\r\n    <DispatchStore.Provider value={dispatch}>\r\n      <StateStore.Provider value={state}>{children}</StateStore.Provider>\r\n    </DispatchStore.Provider>\r\n  );\r\n};\r\n\r\nexport default StoreProvider;\r\n","import React, { useContext } from \"react\";\r\nimport { Formik } from \"formik\";\r\nimport * as Yup from \"yup\";\r\nimport { getCurrentUser } from \"../../state/actions\";\r\nimport { login as loginUser } from \"../../api/user\";\r\n\r\nimport {\r\n  Title,\r\n  InputAndLabel,\r\n  PanelContainer,\r\n  Button,\r\n  Section,\r\n  Link,\r\n  TooltipContainer,\r\n  TooltipHeader,\r\n  Cell50\r\n} from \"../../styled\";\r\nimport { StateStore, DispatchStore } from \"../../state/StoreProvider\";\r\n\r\nconst Login = ({ className }) => {\r\n  const dispatch = useContext(DispatchStore);\r\n  const { currentUser } = useContext(StateStore);\r\n\r\n  const onSubmit = async (values, { setSubmitting }) => {\r\n    await loginUser(values.username, values.password);\r\n    console.log(\"user logged in!\");\r\n    await getCurrentUser(dispatch);\r\n    setSubmitting(false);\r\n  };\r\n\r\n  if (currentUser) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Formik\r\n      initialValues={{ username: \"\", password: \"\" }}\r\n      onSubmit={onSubmit}\r\n      validationSchema={Yup.object().shape({\r\n        username: Yup.string().required(\"Required\"),\r\n        password: Yup.string().required(\"Required\")\r\n      })}\r\n    >\r\n      {props => {\r\n        const {\r\n          values,\r\n          touched,\r\n          errors,\r\n          isSubmitting,\r\n          handleChange,\r\n          handleBlur,\r\n          handleSubmit\r\n        } = props;\r\n\r\n        return (\r\n          <TooltipContainer\r\n            className={className}\r\n            as=\"form\"\r\n            onSubmit={handleSubmit}\r\n          >\r\n            <TooltipHeader>Login</TooltipHeader>\r\n            <Section>\r\n              <Cell50>\r\n                <InputAndLabel\r\n                  label=\"Username\"\r\n                  id=\"username\"\r\n                  placeholder=\"Username\"\r\n                  value={values.username}\r\n                  onChange={handleChange}\r\n                  onBlur={handleBlur}\r\n                  error={touched.username && errors.username}\r\n                />\r\n              </Cell50>\r\n              <Cell50>\r\n                <InputAndLabel\r\n                  label=\"Password\"\r\n                  id=\"password\"\r\n                  placeholder=\"Password\"\r\n                  value={values.password}\r\n                  onChange={handleChange}\r\n                  onBlur={handleBlur}\r\n                  error={touched.password && errors.password}\r\n                  type=\"password\"\r\n                />\r\n              </Cell50>\r\n            </Section>\r\n\r\n            <Section>\r\n              <Cell50>\r\n                <Button\r\n                  buttonStyle=\"button-grey\"\r\n                  type=\"submit\"\r\n                  disabled={isSubmitting || Object.entries(errors).length !== 0}\r\n                >\r\n                  Login\r\n                </Button>\r\n              </Cell50>\r\n              <Cell50>\r\n                <Button\r\n                  buttonStyle=\"button-grey\"\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n\r\n                    alert(\"not implemented\");\r\n                  }}\r\n                >\r\n                  Register\r\n                </Button>\r\n              </Cell50>\r\n            </Section>\r\n          </TooltipContainer>\r\n        );\r\n      }}\r\n    </Formik>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import React, { useContext } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { StateStore } from \"../../state/StoreProvider\";\r\nimport Login from \"./Login\";\r\n\r\nconst LoginFloaterContainer = styled(Login)`\r\n  position: absolute;\r\n  width: 20%;\r\n  min-width: 200px;\r\n  right: 10px;\r\n  top: 10px;\r\n  z-index: 3;\r\n`;\r\n\r\nconst LoginFloater = () => {\r\n  const { currentUser } = useContext(StateStore);\r\n\r\n  if (currentUser) {\r\n    return null;\r\n  }\r\n\r\n  return <LoginFloaterContainer />;\r\n};\r\n\r\nexport default LoginFloater;\r\n","import React, { Component } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  Title,\r\n  PanelContainer,\r\n  Button,\r\n  Link,\r\n  TooltipContainer,\r\n  TooltipHeader\r\n} from \"../../styled\";\r\nimport HomeSceneComponent from \"./HomeSceneComponent\";\r\nimport Login from \"../login/Login\";\r\nimport LoginFloater from \"../login/LoginFloater\";\r\n\r\nconst Logo = styled.div`\r\n  height: 58px;\r\n  width: 412px;\r\n  background-image: url(img/coldvoid.png);\r\n  position: absolute;\r\n  top: 45px;\r\n  left: 30px;\r\n  opacity: 0.8;\r\n  z-index: -1;\r\n`;\r\n\r\nconst SuperContainer = styled.div`\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  flex-wrap: wrap-reverse;\r\n  margin: 5px;\r\n`;\r\nconst ContainerLeft = styled.div`\r\n  width: 40%;\r\n  min-width: 800px;\r\n  margin: 5px;\r\n`;\r\n\r\nconst ContainerRight = styled.div`\r\n  width: 21%;\r\n  min-width: 200px;\r\n  margin: 5px;\r\n`;\r\n\r\nclass Home extends Component {\r\n  render() {\r\n    return (\r\n      <>\r\n        <Logo />\r\n        <HomeSceneComponent />\r\n        <SuperContainer>\r\n          <ContainerLeft>\r\n            <TooltipContainer>\r\n              <TooltipHeader>Home</TooltipHeader>\r\n\r\n              <Link to=\"/createGame\">\r\n                <Button type=\"button\" buttonStyle=\"button-grey\">\r\n                  Create game\r\n                </Button>\r\n              </Link>\r\n              <Link to=\"/logout\">\r\n                <Button type=\"button\" buttonStyle=\"button-grey\">\r\n                  Log out\r\n                </Button>\r\n              </Link>\r\n            </TooltipContainer>\r\n          </ContainerLeft>\r\n          <ContainerRight>\r\n            <Login />\r\n          </ContainerRight>\r\n        </SuperContainer>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Home;\r\n","import Home from \"./Home\";\r\n\r\nexport default Home;\r\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport { distance } from \"../../../../model/utils/math\";\n\nconst WebglCanvas = styled.div`\n  display: flex;\n  width: 100%;\n  height: 100%;\n  background-size: cover;\n  background-color: #0b121a;\n  box-shadow: inset 0px 0px 200px rgba(0, 0, 0, 1);\n`;\n\nconst ClickCatcher = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  z-index: 2;\n  width: 100%;\n  height: 100%;\n  background-color: transparent;\n`;\n\nconst getMousePositionInObservedElement = (event, element) => {\n  if (event.touches) {\n    return {\n      x: event.originalEvent.touches[0].pageX - element.offset().left,\n      y: event.originalEvent.touches[0].pageY - element.offset().top,\n      xR:\n        ((event.originalEvent.touches[0].pageX - element.offset().left) /\n          window.innerWidth) *\n          2 -\n        1,\n      yR:\n        -(\n          (event.originalEvent.touches[0].pageY - element.offset().top) /\n          window.innerHeight\n        ) *\n          2 +\n        1\n    };\n  }\n\n  return {\n    x: event.clientX,\n    y: event.clientY,\n    xR: (event.clientX / element.offsetWidth) * 2 - 1,\n    yR: -(event.clientY / element.offsetHeight) * 2 + 1\n  };\n};\n\nclass GameSceneComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    // create a ref to store the textInput DOM element\n    this.canvasRef = React.createRef();\n    this.clickCatcherRef = React.createRef();\n    this.mouseDownPosition = null;\n    this.lastDraggingPosition = null;\n    this.draggingThreshold = 5;\n  }\n\n  componentDidMount() {\n    console.log(\"Game scene component mounted\");\n    const { game } = this.props;\n\n    window.addEventListener(\"resize\", this.onResize);\n    this.clickCatcherRef.current.addEventListener(\"wheel\", this.onWheel);\n    window.addEventListener(\"touchstart\", this.onTouchStart);\n    document.addEventListener(\"keydown\", this.onKeyDown.bind(this), false);\n    document.addEventListener(\"keyup\", this.onKeyUp.bind(this), false);\n\n    game.initRender(this.canvasRef.current);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.onKeyDown.bind(this), false);\n    document.removeEventListener(\"keyup\", this.onKeyUp.bind(this), false);\n    window.removeEventListener(\"resize\", this.onResize);\n    this.clickCatcherRef.current.removeEventListener(\"wheel\", this.onWheel);\n    window.removeEventListener(\"touchstart\", this.onTouchStart);\n  }\n\n  onTouchStart = event => {\n    event.stopPropagation();\n    event.preventDefault();\n  };\n\n  onWheel = event => {\n    event.stopImmediatePropagation();\n    event.preventDefault();\n    const { game } = this.props;\n    const delta = Math.sign(event.deltaY);\n    game.onMouseWheel(delta);\n  };\n\n  onResize = () => {\n    const { game } = this.props;\n    game.onResize();\n  };\n\n  onMouseDown(event) {\n    event.stopPropagation();\n    event.preventDefault();\n    this.mouseDownPosition = getMousePositionInObservedElement(\n      event,\n      this.clickCatcherRef.current\n    );\n  }\n\n  onMouseUp(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    const { game } = this.props;\n    if (!this.lastDraggingPosition) {\n      game.onMouseUp(\n        getMousePositionInObservedElement(event, this.clickCatcherRef.current),\n        event.button\n      );\n    }\n\n    this.mouseDownPosition = null;\n    this.lastDraggingPosition = null;\n  }\n\n  onMouseMove(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    const { game } = this.props;\n\n    if (this.mouseDownPosition === null) {\n      game.onMouseMove(\n        getMousePositionInObservedElement(event, this.canvasRef.current)\n      );\n      return;\n    }\n\n    const position = getMousePositionInObservedElement(\n      event,\n      this.clickCatcherRef.current\n    );\n\n    if (\n      !this.lastDraggingPosition &&\n      distance(this.mouseDownPosition, position) > this.draggingThreshold\n    ) {\n      this.lastDraggingPosition = this.mouseDownPosition;\n    }\n\n    if (this.lastDraggingPosition) {\n      const delta = {\n        x: position.x - this.lastDraggingPosition.x,\n        y: position.y - this.lastDraggingPosition.y\n      };\n\n      this.lastDraggingPosition = position;\n      game.onDrag(position, delta);\n    }\n  }\n\n  onMouseOut(event) {\n    const { game } = this.props;\n    this.mouseDownPosition = null;\n    this.lastDraggingPosition = null;\n    game.onMouseOut(event);\n  }\n\n  onKeyDown(event) {\n    const { game } = this.props;\n    game.onKeyDown(event);\n  }\n\n  onKeyUp(event) {\n    const { game } = this.props;\n    game.onKeyUp(event);\n  }\n\n  componentDidUpdate() {\n    console.log(\"updated init\");\n    this.props.game.initRender(this.canvasRef.current);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    /*\n    if (this.props.game != nextProps.game) {\n      this.props.game.deactivate();\n      return true;\n    }\n  */\n\n    return false;\n  }\n\n  render() {\n    console.log(\"rerender game scene component\");\n    return (\n      <>\n        <ClickCatcher\n          ref={this.clickCatcherRef}\n          onMouseOut={this.onMouseOut.bind(this)}\n          onMouseDown={this.onMouseDown.bind(this)}\n          onMouseUp={this.onMouseUp.bind(this)}\n          onMouseMove={this.onMouseMove.bind(this)}\n          onKeyUp={this.onKeyUp.bind(this)}\n          onContextMenu={e => {\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n        />\n        <WebglCanvas ref={this.canvasRef} />\n      </>\n    );\n  }\n}\n\nexport default GameSceneComponent;\n","import { movementTypes } from \"./index.mjs\";\nimport { addToHexFacing } from \"../utils/math.mjs\";\n\nclass RequiredThrust {\n  constructor(ship, move) {\n    this.requirements = {};\n    this.fullfilments = {\n      0: [],\n      1: [],\n      2: [],\n      3: [],\n      4: [],\n      5: [],\n      6: [],\n      7: [],\n      8: []\n    };\n\n    if (move) {\n      switch (move.type) {\n        case movementTypes.SPEED:\n          this.requireSpeed(ship, move);\n          break;\n        case movementTypes.PIVOT:\n          this.requirePivot(ship, move);\n          break;\n        case movementTypes.ROLL:\n          this.requireRoll(ship);\n          break;\n        case movementTypes.EVADE:\n          this.requireEvade(ship, move);\n          break;\n        default:\n      }\n    }\n  }\n\n  serialize() {\n    return {\n      requirements: this.requirements,\n      fullfilments: this.fullfilments\n    };\n  }\n\n  deserialize(data = {}) {\n    this.requirements = data.requirements || {};\n    this.fullfilments = data.fullfilments || {\n      0: [],\n      1: [],\n      2: [],\n      3: [],\n      4: [],\n      5: [],\n      6: [],\n      7: [],\n      8: []\n    };\n    return this;\n  }\n\n  getTotalAmountRequired() {\n    return Object.keys(this.requirements).reduce((total, direction) => {\n      const required = this.requirements[direction] || 0;\n      return total + required;\n    }, 0);\n  }\n\n  getRequirement(direction) {\n    if (!this.requirements[direction]) {\n      return 0;\n    }\n\n    return this.requirements[direction] - this.getFulfilledAmount(direction);\n  }\n\n  isFulfilled() {\n    return Object.keys(this.requirements).every(\n      direction => this.getRequirement(direction) === 0\n    );\n  }\n\n  fulfill(direction, amount, thruster) {\n    this.fullfilments[direction].push({ amount, thrusterId: thruster.id });\n    if (this.requirements[direction] < this.getFulfilledAmount(direction)) {\n      throw new Error(\"Fulfilled too much!\");\n    }\n  }\n\n  getFulfilledAmount(direction) {\n    return this.fullfilments[direction].reduce(\n      (total, entry) => total + entry.amount,\n      0\n    );\n  }\n\n  getFulfilments() {\n    return Object.keys(this.fullfilments)\n      .map(key => this.fullfilments[key])\n      .filter(fulfillment => fulfillment.length > 0);\n  }\n\n  requireRoll(ship) {\n    this.requirements[8] = ship.rollcost;\n  }\n\n  requireEvade(ship, move) {\n    this.requirements[8] = ship.evasioncost * move.value;\n  }\n\n  requirePivot(ship, move) {\n    if (ship.movement.isRolled()) {\n      if (move.value === 1) {\n        this.requirements[7] = ship.pivotcost;\n      } else {\n        this.requirements[6] = ship.pivotcost;\n      }\n    } else {\n      if (move.value === 1) {\n        this.requirements[6] = ship.pivotcost;\n      } else {\n        this.requirements[7] = ship.pivotcost;\n      }\n    }\n  }\n\n  requireSpeed(ship, move) {\n    const facing = move.facing;\n    const direction = move.value;\n    const actualDirection = addToHexFacing(\n      addToHexFacing(direction, -facing),\n      3\n    );\n\n    if (ship.movement.isRolled() && [1, 2, 4, 5].includes(actualDirection)) {\n      this.requirements[addToHexFacing(actualDirection, 3)] = ship.accelcost;\n    } else {\n      this.requirements[actualDirection] = ship.accelcost;\n    }\n  }\n\n  accumulate(total) {\n    Object.keys(this.requirements).forEach(direction => {\n      total[direction] = total[direction]\n        ? total[direction] + this.requirements[direction]\n        : this.requirements[direction];\n    });\n\n    return total;\n  }\n}\n\nexport default RequiredThrust;\n","import Vector from \"../../model/utils/Vector.mjs\";\nimport coordinateConverter from \"../../model/utils/CoordinateConverter.mjs\";\nimport { movementTypes } from \"./index.mjs\";\nimport hexagon from \"../hexagon/index.mjs\";\nimport { addToHexFacing } from \"../utils/math.mjs\";\nimport RequiredThrust from \"./RequiredThrust.mjs\";\n\nclass MovementOrder {\n  constructor(\n    id,\n    type,\n    position,\n    velocity,\n    facing,\n    rolled,\n    turn,\n    value = 0,\n    requiredThrust = undefined,\n    index = 0\n  ) {\n    this.id = id;\n    this.type = type;\n    this.facing = facing;\n    this.rolled = rolled;\n    this.turn = turn;\n    this.value = value;\n    this.requiredThrust = requiredThrust || new RequiredThrust();\n    this.index = index;\n    this.setPosition(position);\n    this.setVelocity(velocity);\n  }\n\n  round() {\n    const position = this.position.round();\n    const velocity = this.velocity.round();\n\n    const clone = this.clone();\n    clone.setPosition(position);\n    clone.setVelocity(velocity);\n    return clone;\n  }\n\n  setPosition(position) {\n    if (position instanceof hexagon.Offset) {\n      position = coordinateConverter.fromHexToGame(position);\n    }\n\n    this.position = position;\n  }\n\n  setVelocity(velocity) {\n    if (velocity instanceof hexagon.Offset) {\n      velocity = coordinateConverter.fromHexToGame(velocity);\n    }\n\n    this.velocity = velocity;\n  }\n\n  getFacing() {\n    return this.facing;\n  }\n\n  getPosition() {\n    return this.position;\n  }\n\n  getVelocity() {\n    return this.velocity;\n  }\n\n  getHexPosition() {\n    return coordinateConverter.fromGameToHex(this.position);\n  }\n\n  getHexVelocity() {\n    return coordinateConverter.fromGameToHex(this.velocity);\n  }\n\n  setRequiredThrust(req) {\n    this.requiredThrust = req;\n    return this;\n  }\n\n  setId(id) {\n    this.id = id;\n    return this;\n  }\n\n  setIndex(index) {\n    this.index = index;\n    return this;\n  }\n\n  serialize() {\n    return {\n      id: this.id,\n      type: this.type,\n      position: this.position.serialize(),\n      velocity: this.velocity.serialize(),\n      facing: this.facing,\n      rolled: this.rolled,\n      turn: this.turn,\n      value: this.value,\n      requiredThrust: this.requiredThrust.serialize(),\n      index: this.index\n    };\n  }\n\n  deserialize(data) {\n    this.id = data.id;\n    this.type = data.type;\n    this.position = new Vector(data.position);\n    this.velocity = new Vector(data.velocity);\n    this.facing = data.facing;\n    this.rolled = data.rolled;\n    this.turn = data.turn;\n    this.value = data.value;\n    this.index = data.index;\n    this.requiredThrust = new RequiredThrust().deserialize(data.requiredThrust);\n\n    return this;\n  }\n\n  equals(move) {\n    return (\n      this.type === move.type &&\n      this.position\n        .roundToHexCenter()\n        .equals(move.position.roundToHexCenter()) &&\n      this.velocity\n        .roundToHexCenter()\n        .equals(move.velocity.roundToHexCenter()) &&\n      this.facing === move.facing &&\n      this.rolled === move.rolled &&\n      this.turn === move.turn &&\n      this.value === move.value\n    );\n  }\n\n  isSpeed() {\n    return this.type === movementTypes.SPEED;\n  }\n\n  isDeploy() {\n    return this.type === movementTypes.DEPLOY;\n  }\n\n  isStart() {\n    return this.type === movementTypes.START;\n  }\n\n  isEvade() {\n    return this.type === movementTypes.EVADE;\n  }\n\n  isRoll() {\n    return this.type === movementTypes.ROLL;\n  }\n\n  isEnd() {\n    return this.type === movementTypes.END;\n  }\n\n  isPivot() {\n    return this.type === movementTypes.PIVOT;\n  }\n\n  isCancellable() {\n    return this.isSpeed() || this.isPivot() || this.isEvade() || this.isRoll();\n  }\n\n  isPlayerAdded() {\n    return this.isSpeed() || this.isPivot() || this.isEvade() || this.isRoll();\n  }\n\n  clone() {\n    return new MovementOrder(\n      this.id,\n      this.type,\n      this.position,\n      this.velocity,\n      this.facing,\n      this.rolled,\n      this.turn,\n      this.value,\n      this.requiredThrust,\n      this.index\n    );\n  }\n\n  isOpposite(move) {\n    switch (move.type) {\n      case movementTypes.SPEED:\n        return this.isSpeed() && this.value === addToHexFacing(move.value, 3);\n      default:\n        return false;\n    }\n  }\n}\n\nexport default MovementOrder;\n","const movementTypes = {\r\n  START: \"start\",\r\n  END: \"end\",\r\n  DEPLOY: \"deploy\",\r\n  SPEED: \"speed\",\r\n  PIVOT: \"pivot\",\r\n  EVADE: \"evade\",\r\n  ROLL: \"roll\"\r\n};\r\n\r\nexport default movementTypes;\r\n","import hexagon from \"../hexagon/index.mjs\";\nimport { addToHexFacing } from \"../utils/math.mjs\";\n\nimport { MovementOrder, movementTypes, ThrustBill } from \"./index.mjs\";\n\nclass MovementResolver {\n  constructor(ship, movementService, turn) {\n    this.ship = ship;\n    this.movementService = movementService;\n    this.turn = turn;\n  }\n\n  billAndPay(bill, commit = true) {\n    if (bill.pay()) {\n      const newMovement = bill.getMoves();\n\n      if (commit) {\n        this.ship.movement.replaceMovement(newMovement);\n        this.movementService.shipStateChanged(this.ship);\n      }\n\n      return true;\n    } else if (commit) {\n      throw new Error(\n        \"Tried to commit move that was not legal. Check legality first!\"\n      );\n    } else {\n      return false;\n    }\n  }\n\n  canRoll() {\n    return this.roll(false);\n  }\n\n  roll(commit = true) {\n    let rollMove = this.ship.movement.getRollMove();\n\n    const endMove = this.ship.movement.getLastEndMoveOrSurrogate();\n\n    let movements = this.ship.movement.getMovement();\n\n    if (rollMove) {\n      movements = movements.filter(move => !move.isRoll());\n    } else {\n      rollMove = new MovementOrder(\n        null,\n        movementTypes.ROLL,\n        endMove.position,\n        endMove.velocity,\n        endMove.facing,\n        endMove.rolled,\n        this.turn,\n        endMove.rolled ? false : true\n      );\n\n      const playerAdded = movements.filter(move => move.isPlayerAdded());\n      const nonPlayerAdded = movements.filter(move => !move.isPlayerAdded());\n\n      movements = [...nonPlayerAdded, rollMove, ...playerAdded];\n    }\n\n    const bill = new ThrustBill(\n      this.ship,\n      this.ship.movement.getThrustOutput(),\n      movements\n    );\n\n    return this.billAndPay(bill, commit);\n  }\n\n  canEvade(step) {\n    return this.evade(step, false);\n  }\n\n  evade(step, commit = true) {\n    let evadeMove = this.ship.movement.getEvadeMove();\n\n    const endMove = this.ship.movement.getLastEndMoveOrSurrogate();\n\n    if (evadeMove) {\n      if (evadeMove.value + step > this.ship.movement.getMaxEvasion()) {\n        return false;\n      }\n\n      if (evadeMove.value + step < 0) {\n        return false;\n      }\n      evadeMove.value += step;\n    } else {\n      if (step < 0) {\n        return false;\n      }\n\n      evadeMove = new MovementOrder(\n        null,\n        movementTypes.EVADE,\n        endMove.position,\n        endMove.velocity,\n        endMove.facing,\n        endMove.rolled,\n        this.turn,\n        1\n      );\n    }\n\n    const playerAdded = this.ship.movement\n      .getMovement()\n      .filter(\n        move => move.isPlayerAdded() && !move.isRoll() && !move.isEvade()\n      );\n    const nonPlayerAdded = this.ship.movement\n      .getMovement()\n      .filter(move => !move.isPlayerAdded() || move.isRoll());\n\n    const movements =\n      evadeMove.value === 0\n        ? [...nonPlayerAdded, ...playerAdded]\n        : [...nonPlayerAdded, evadeMove, ...playerAdded];\n\n    const bill = new ThrustBill(\n      this.ship,\n      this.ship.movement.getThrustOutput(),\n      movements\n    );\n\n    return this.billAndPay(bill, commit);\n  }\n\n  canPivot(pivotDirection) {\n    return this.pivot(pivotDirection, false);\n  }\n\n  pivot(pivotDirection, commit = true) {\n    const lastMove = this.ship.movement.getLastMove();\n\n    const pivotMove = new MovementOrder(\n      null,\n      movementTypes.PIVOT,\n      lastMove.position,\n      lastMove.velocity,\n      addToHexFacing(lastMove.facing, pivotDirection),\n      lastMove.rolled,\n      this.turn,\n      pivotDirection\n    );\n\n    const movements = this.ship.movement.getMovement();\n\n    if (lastMove.isPivot() && lastMove.value !== pivotDirection) {\n      movements.pop();\n    } else {\n      if (\n        this.ship.maxPivots !== null &&\n        this.ship.movement.getMovement().filter(move => move.isPivot())\n          .length >= this.ship.maxPivots\n      ) {\n        return false;\n      }\n\n      movements.push(pivotMove);\n    }\n\n    const bill = new ThrustBill(\n      this.ship,\n      this.ship.movement.getThrustOutput(),\n      movements\n    );\n\n    return this.billAndPay(bill, commit);\n  }\n\n  canThrust(direction) {\n    return this.thrust(direction, false);\n  }\n\n  thrust(direction, commit = true) {\n    const lastMove = this.ship.movement.getLastMove();\n\n    const thrustMove = new MovementOrder(\n      null,\n      movementTypes.SPEED,\n      lastMove.position,\n      lastMove.getHexVelocity().moveToDirection(direction),\n      lastMove.facing,\n      lastMove.rolled,\n      this.turn,\n      direction\n    );\n\n    let movements = this.ship.movement.getMovement();\n    if (lastMove.isSpeed() && lastMove.value === addToHexFacing(direction, 3)) {\n      movements.pop();\n    } else {\n      movements.push(thrustMove);\n    }\n\n    const bill = new ThrustBill(\n      this.ship,\n      this.ship.movement.getThrustOutput(),\n      movements\n    );\n\n    return this.billAndPay(bill, commit);\n  }\n\n  canCancel() {\n    return this.ship.movement.getMovement().some(move => move.isCancellable());\n  }\n\n  cancel() {\n    const toCancel = this.ship.movement.getLastMove();\n\n    if (!toCancel || !toCancel.isCancellable()) {\n      return;\n    }\n\n    this.ship.movement.removeMovement(toCancel);\n\n    const bill = new ThrustBill(\n      this.ship,\n      this.ship.movement.getThrustOutput(),\n      this.ship.movement.getMovement()\n    );\n\n    return this.billAndPay(bill, true);\n  }\n\n  canRevert() {\n    return this.ship.movement.getMovement().some(move => move.isPlayerAdded());\n  }\n\n  revert() {\n    this.ship.movement\n      .getMovement()\n      .filter(move => move.isCancellable())\n      .forEach(move => this.ship.movement.removeMovement(move));\n\n    this.movementService.shipStateChanged(this.ship);\n  }\n}\n\nexport default MovementResolver;\n","import { RequiredThrust, ThrustAssignment } from \"./index.mjs\";\n\nclass ThrustBill {\n  constructor(ship, thrustAvailable, movement) {\n    this.ship = ship;\n    this.movement = movement.map(move => move.clone());\n    this.thrusters = ship.systems\n      .getSystems()\n      .filter(system => system.callHandler(\"isThruster\", null, false))\n      .filter(system => !system.isDisabled())\n      .map(thruster => new ThrustAssignment(thruster));\n\n    this.buildRequiredThrust(this.movement);\n\n    this.paid = null;\n\n    this.cost = 0;\n    this.thrustAvailable = thrustAvailable;\n    this.directionsRequired = this.getRequiredThrustDirections();\n  }\n\n  getRequiredThrustDirections() {\n    const result = this.movement.reduce(\n      (accumulator, move) => move.requiredThrust.accumulate(accumulator),\n      {}\n    );\n\n    result[0] = result[0] || 0;\n    result[1] = result[1] || 0;\n    result[2] = result[2] || 0;\n    result[3] = result[3] || 0;\n    result[4] = result[4] || 0;\n    result[5] = result[5] || 0;\n    result[6] = result[6] || 0;\n    result[7] = result[7] || 0;\n    result[8] = result[8] || 0;\n\n    return result;\n  }\n\n  getTotalThrustRequired() {\n    const totalRequired = this.getRequiredThrustDirections();\n    return (\n      totalRequired[0] +\n      totalRequired[1] +\n      totalRequired[2] +\n      totalRequired[3] +\n      totalRequired[4] +\n      totalRequired[5] +\n      totalRequired[6] +\n      totalRequired[7] +\n      totalRequired[8]\n    );\n  }\n\n  getCurrentThrustRequired() {\n    return (\n      this.directionsRequired[0] +\n      this.directionsRequired[1] +\n      this.directionsRequired[2] +\n      this.directionsRequired[3] +\n      this.directionsRequired[4] +\n      this.directionsRequired[5] +\n      this.directionsRequired[6] +\n      this.directionsRequired[7] +\n      this.directionsRequired[8]\n    );\n  }\n\n  isPaid() {\n    return this.getCurrentThrustRequired() === 0;\n  }\n\n  getAllUsableThrusters(direction) {\n    return this.thrusters\n      .filter(thruster => {\n        const capacity = thruster.getThrustCapacity();\n\n        return thruster.isDirection(direction) && capacity > 0;\n      })\n      .sort(this.sortThrusters);\n  }\n\n  sortThrusters(a, b) {\n    const aHeat = a.getOverheat();\n    const bHeat = b.getOverheat();\n\n    if (aHeat > bHeat) {\n      return -1;\n    }\n\n    if (aHeat > bHeat) {\n      return 1;\n    }\n\n    if (a.channeled > b.channeled) {\n      return -1;\n    }\n\n    if (a.channeled < b.channeled) {\n      return 1;\n    }\n\n    return 0;\n  }\n\n  errorIfOverBudget() {\n    if (this.isOverBudget()) {\n      throw new Error(\"over budget\");\n    }\n  }\n\n  isOverBudget() {\n    return this.cost > this.thrustAvailable;\n  }\n\n  pay() {\n    if (this.paid !== null) {\n      throw new Error(\"Thrust bill is already paid!\");\n    }\n\n    try {\n      if (this.getTotalThrustRequired() > this.thrustAvailable) {\n        throw new Error(\"over budget\");\n      }\n\n      this.process();\n\n      this.paid = this.isPaid();\n      return this.paid;\n    } catch (e) {\n      if (e.message === \"over budget\") {\n        this.paid = false;\n        return this.paid;\n      }\n\n      throw e;\n    }\n  }\n\n  process() {\n    Object.keys(this.directionsRequired).forEach(direction => {\n      const required = this.directionsRequired[direction];\n      direction = parseInt(direction, 10);\n\n      if (required === 0) {\n        return;\n      }\n\n      this.useThrusters(direction, required);\n    });\n\n    return this.isPaid();\n  }\n\n  useThrusters(direction, required) {\n    let assigned = 0;\n\n    while (true) {\n      const thrusters = this.getAllUsableThrusters(direction);\n\n      if (thrusters.length === 0) {\n        return;\n      }\n\n      if (assigned === required) {\n        return;\n      }\n\n      const thruster = thrusters.pop();\n      thruster.channel(1);\n      this.directionsRequired[direction] -= 1;\n      this.cost += 1;\n      assigned += 1;\n\n      this.errorIfOverBudget();\n    }\n  }\n\n  buildRequiredThrust(movement) {\n    movement.forEach(move =>\n      move.setRequiredThrust(new RequiredThrust(this.ship, move))\n    );\n  }\n\n  getMoves() {\n    [0, 1, 2, 3, 4, 5, 6, 7, 8].forEach(direction => {\n      this.thrusters.forEach(thruster => {\n        if (!thruster.isDirection(direction)) {\n          return;\n        }\n\n        let free = thruster.channeled - thruster.assigned;\n\n        if (free === 0) {\n          return;\n        }\n\n        this.movement.forEach(move => {\n          const required = move.requiredThrust.getRequirement(direction);\n\n          if (required === 0) {\n            return;\n          }\n\n          if (required > free) {\n            move.requiredThrust.fulfill(direction, free, thruster.thruster);\n            thruster.addAssigned(free);\n            free = 0;\n          } else {\n            move.requiredThrust.fulfill(direction, required, thruster.thruster);\n            thruster.addAssigned(required);\n            free -= required;\n          }\n        });\n      });\n    });\n\n    if (!this.movement.every(move => move.requiredThrust.isFulfilled())) {\n      throw new Error(\"Not all moves are fulfilled\");\n    }\n\n    return this.movement;\n  }\n}\n\nexport default ThrustBill;\n","class ThrustAssignment {\r\n  constructor(thruster) {\r\n    this.thruster = thruster;\r\n\r\n    this.directions = [].concat(thruster.callHandler(\"getThrustDirection\"));\r\n    this.paid = 0;\r\n    this.channeled = 0;\r\n    this.capacity = thruster.callHandler(\"getThrustChannel\");\r\n    this.assigned = 0;\r\n  }\r\n\r\n  addAssigned(amount) {\r\n    this.assigned += amount;\r\n  }\r\n\r\n  getOverheat() {\r\n    return (\r\n      this.thruster.heat.getOverheat() +\r\n      this.thruster.callHandler(\r\n        \"getHeatForThrust\",\r\n        { amount: this.channeled },\r\n        0\r\n      )\r\n    );\r\n  }\r\n\r\n  isDirection(direction) {\r\n    return this.directions.includes(direction);\r\n  }\r\n\r\n  canChannel() {\r\n    return this.channeled < this.capacity;\r\n  }\r\n\r\n  getThrustCapacity() {\r\n    const capacity = this.capacity - this.channeled;\r\n\r\n    if (capacity < 0) {\r\n      return 0;\r\n    }\r\n\r\n    return capacity;\r\n  }\r\n\r\n  channel(amount) {\r\n    this.channeled += amount;\r\n  }\r\n\r\n  undoChannel(amount) {\r\n    if (this.channeled - amount < 0) {\r\n      throw new Error(\"Can not undo channel more than channeled\");\r\n    }\r\n\r\n    this.channeled = this.channeled - amount;\r\n  }\r\n}\r\n\r\nexport default ThrustAssignment;\r\n","import { MovementOrder, movementTypes, MovementResolver } from \"./index.mjs\";\nimport hexagon from \"../hexagon/index.mjs\";\nimport { addToHexFacing } from \"../utils/math.mjs\";\n\nclass MovementService {\n  constructor() {\n    this.gamedata = null;\n  }\n\n  update(gamedata, phaseDirector) {\n    this.gamedata = gamedata;\n    this.phaseDirector = phaseDirector;\n\n    return this;\n  }\n\n  isMoved(ship, turn) {\n    const end = this.getLastEndMove(ship);\n\n    if (!end) {\n      return false;\n    }\n\n    return end.turn === turn;\n  }\n\n  getShipsInSameHex(ship, hex) {\n    hex = hex && this.getMostRecentMove(ship).position;\n    return this.gamedata.ships.filter(\n      ship2 =>\n        ship2.isDestroyed() &&\n        ship !== ship2 &&\n        this.getMostRecentMove(ship2).position.equals(hex)\n    );\n  }\n\n  getNewEndMove(ship, terrain) {\n    const startMove = ship.movement.getLastEndMoveOrSurrogate();\n    const lastMove = ship.movement.getLastMove();\n    const vector = lastMove.getVelocity();\n\n    const { position, velocity } = terrain.getGravityVectorForTurn(\n      startMove.position,\n      vector\n    );\n\n    return new MovementOrder(\n      null,\n      movementTypes.END,\n      position,\n      velocity,\n      lastMove.facing,\n      lastMove.rolled,\n      startMove.turn + 1,\n      0\n    );\n  }\n\n  deploy(ship, pos) {\n    let deployMove = ship.movement.getDeployMove();\n\n    if (!deployMove) {\n      const lastMove = ship.movement.getLastMove();\n      deployMove = new MovementOrder(\n        -1,\n        movementTypes.DEPLOY,\n        pos,\n        lastMove.velocity,\n        lastMove.facing,\n        lastMove.rolled,\n        this.gamedata.turn,\n        0,\n        null,\n        1\n      );\n      ship.movement.addMovement(deployMove);\n    } else {\n      deployMove.setPosition(pos);\n      ship.movement.replaceDeployMove(deployMove);\n    }\n  }\n\n  doDeploymentTurn(ship, step) {\n    const deployMove = ship.movement.getDeployMove();\n    const newfacing = addToHexFacing(deployMove.facing, step);\n    deployMove.facing = newfacing;\n    ship.movement.replaceDeployMove(deployMove);\n    this.shipStateChanged(ship);\n  }\n\n  getPositionAtStartOfTurn(ship, currentTurn) {\n    if (currentTurn === undefined) {\n      currentTurn = this.gamedata.turn;\n    }\n\n    let move = null;\n\n    for (var i = ship.movement.length - 1; i >= 0; i--) {\n      move = ship.movement[i];\n      if (move.turn < currentTurn) {\n        break;\n      }\n    }\n\n    return new hexagon.Offset(move.position);\n  }\n\n  shipStateChanged(ship) {\n    this.phaseDirector.relayEvent(\"shipStateChanged\", ship);\n  }\n\n  canThrust(ship, direction) {\n    return new MovementResolver(ship, this, this.gamedata.turn).canThrust(\n      direction\n    );\n  }\n\n  thrust(ship, direction) {\n    new MovementResolver(ship, this, this.gamedata.turn).thrust(direction);\n  }\n\n  canCancel(ship) {\n    return new MovementResolver(ship, this, this.gamedata.turn).canCancel();\n  }\n\n  canRevert(ship) {\n    return new MovementResolver(ship, this, this.gamedata.turn).canRevert();\n  }\n\n  cancel(ship) {\n    new MovementResolver(ship, this, this.gamedata.turn).cancel();\n  }\n\n  revert(ship) {\n    new MovementResolver(ship, this, this.gamedata.turn).revert();\n  }\n\n  canPivot(ship, turnDirection) {\n    if (turnDirection !== 1 && turnDirection !== -1) {\n      throw new Error(\"While pivoting direction must be 1 or -1\");\n    }\n\n    return new MovementResolver(ship, this, this.gamedata.turn).canPivot(\n      turnDirection\n    );\n  }\n\n  pivot(ship, turnDirection) {\n    if (turnDirection !== 1 && turnDirection !== -1) {\n      throw new Error(\"While pivoting direction must be 1 or -1\");\n    }\n\n    return new MovementResolver(ship, this, this.gamedata.turn).pivot(\n      turnDirection\n    );\n  }\n\n  canRoll(ship) {\n    return new MovementResolver(ship, this, this.gamedata.turn).canRoll();\n  }\n\n  roll(ship) {\n    return new MovementResolver(ship, this, this.gamedata.turn).roll();\n  }\n\n  canEvade(ship, step) {\n    if (step !== 1 && step !== -1) {\n      throw new Error(\"While evading step must be 1 or -1\");\n    }\n\n    if (ship.movement.getEvasion() + step > ship.movement.getMaxEvasion()) {\n      return false;\n    }\n\n    return new MovementResolver(ship, this, this.gamedata.turn).canEvade(step);\n  }\n\n  evade(ship, step) {\n    if (step !== 1 && step !== -1) {\n      throw new Error(\"While evading step must be 1 or -1\");\n    }\n\n    return new MovementResolver(ship, this, this.gamedata.turn).evade(step);\n  }\n}\n\nexport default MovementService;\n","import { shuffleArray } from \"../utils/math.mjs\";\r\n\r\nclass ShipPower {\r\n  constructor(shipSystems) {\r\n    this.shipSystems = shipSystems;\r\n  }\r\n\r\n  getPowerOutput() {\r\n    return this.shipSystems\r\n      .getSystems()\r\n      .reduce((acc, system) => acc + system.power.getPowerOutput(), 0);\r\n  }\r\n\r\n  getPowerRequired() {\r\n    return this.shipSystems\r\n      .getSystems()\r\n      .filter(system => !system.power.isOffline())\r\n      .reduce((acc, system) => acc + system.power.getPowerRequirement(), 0);\r\n  }\r\n\r\n  getRemainingPowerOutput() {\r\n    return this.getPowerOutput() - this.getPowerRequired();\r\n  }\r\n\r\n  isValidPower() {\r\n    return this.getRemainingPowerOutput() >= 0 || this.getPowerRequired() === 0;\r\n  }\r\n\r\n  canSetOffline(system) {\r\n    return system.power.canSetOffline();\r\n  }\r\n\r\n  canSetOnline(system) {\r\n    if (!system.power.canSetOnline()) {\r\n      return false;\r\n    }\r\n\r\n    return this.getRemainingPowerOutput() >= system.power.getPowerRequirement();\r\n  }\r\n\r\n  copyPower(ship) {\r\n    this.shipSystems.getSystems().forEach(system => {\r\n      const otherSystem = ship.systems.getSystemById(system.id);\r\n\r\n      if (otherSystem.power.isGoingOffline()) {\r\n        if (this.canSetOffline(system)) {\r\n          system.power.setOffline();\r\n        }\r\n      }\r\n\r\n      if (otherSystem.power.isGoingOnline()) {\r\n        if (this.canSetOnline(system)) {\r\n          system.power.setOnline();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  forceValidPower() {\r\n    const systems = shuffleArray(this.shipSystems.getSystems());\r\n\r\n    systems.forEach(system => {\r\n      if (this.canSetOffline(system) && !this.isValidPower()) {\r\n        system.power.setOffline();\r\n      }\r\n    });\r\n  }\r\n\r\n  advanceTurn(turn) {}\r\n}\r\n\r\nexport default ShipPower;\r\n","import uuidv4 from \"uuid/v4.js\";\r\n\r\nclass DamageEntry {\r\n  constructor(amount, armor = 0) {\r\n    this.amount = amount;\r\n    if (this.amount < 0) {\r\n      this.amount = 0;\r\n    }\r\n    this.armor = armor;\r\n    this.id = uuidv4();\r\n    this.destroyedSystem = false;\r\n\r\n    this.system = null;\r\n    this.new = true;\r\n  }\r\n\r\n  isNew() {\r\n    return this.new;\r\n  }\r\n\r\n  setSystem(system) {\r\n    this.system = system;\r\n  }\r\n\r\n  setDestroyedSystem() {\r\n    this.destroyedSystem = true;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      amount: this.amount,\r\n      armor: this.armor,\r\n      id: this.id,\r\n      destroyedSystem: this.destroyedSystem\r\n    };\r\n  }\r\n\r\n  deserialize(data) {\r\n    this.id = data.id || uuidv4();\r\n    this.amount = data.amount || 0;\r\n    this.armor = data.armor || 0;\r\n    this.destroyedSystem = data.destroyedSystem || false;\r\n    this.new = false;\r\n\r\n    return this;\r\n  }\r\n\r\n  getDamage() {\r\n    return this.amount;\r\n  }\r\n\r\n  advanceTurn() {\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default DamageEntry;\r\n","import uuidv4 from \"uuid/v4.js\";\r\n\r\nclass Critical {\r\n  constructor(duration = null) {\r\n    this.id = uuidv4();\r\n    this.duration = Number.isInteger(duration) ? duration + 1 : null;\r\n    this.turnsRemaining = this.duration;\r\n  }\r\n\r\n  getMessage() {\r\n    return \"\";\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      className: this.getClassName(),\r\n      id: this.id,\r\n      duration: this.duration,\r\n      turnsRemaining: this.turnsRemaining\r\n    };\r\n  }\r\n\r\n  deserialize(data) {\r\n    this.id = data.id || null;\r\n    this.turnsRemaining = data.turnsRemaining || null;\r\n    this.duration = data.duration || null;\r\n    return this;\r\n  }\r\n\r\n  advanceTurn() {\r\n    if (this.turnsRemaining !== null && this.turnsRemaining > 0) {\r\n      this.turnsRemaining--;\r\n    }\r\n  }\r\n\r\n  excludes(critical) {\r\n    return false;\r\n  }\r\n\r\n  isReplacedBy(critical) {\r\n    return false;\r\n  }\r\n\r\n  isFixed() {\r\n    return this.turnsRemaining === 0;\r\n  }\r\n\r\n  getDuration() {\r\n    return this.duration;\r\n  }\r\n\r\n  getClassName() {\r\n    return this.constructor.name;\r\n  }\r\n}\r\n\r\nexport default Critical;\r\n","import Critical from \"./Critical.mjs\";\r\n\r\nclass OutputReduced extends Critical {\r\n  constructor(outputReduction, duration) {\r\n    super(duration);\r\n\r\n    this.outputReduction = outputReduction;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      ...super.serialize(),\r\n      outputReduction: this.outputReduction\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    super.deserialize(data);\r\n    this.outputReduction = data.outputReduction || 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessage() {\r\n    if (this.duration) {\r\n      return `Output decreased by ${this.outputReduction} for ${this.turnsRemaining} turns`;\r\n    }\r\n    return `Output decreased by ${this.outputReduction}`;\r\n  }\r\n\r\n  getOutputReduction() {\r\n    return this.outputReduction;\r\n  }\r\n\r\n  excludes(critical) {\r\n    if (!(critical instanceof OutputReduced)) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.outputReduction !== this.outputReduction) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.getDuration() !== null && this.getDuration() !== null) {\r\n      return critical.getDuration() <= this.turnsRemaining;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  isReplacedBy(critical) {\r\n    if (!(critical instanceof OutputReduced)) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.getDuration() !== null && this.getDuration() !== null) {\r\n      if (critical.outputReduction !== this.outputReduction) {\r\n        return false;\r\n      }\r\n\r\n      return critical.getDuration() > this.turnsRemaining;\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default OutputReduced;\r\n","import OutputReduced from \"./OutputReduced.mjs\";\r\n\r\nclass OutputReduced2 extends OutputReduced {\r\n  constructor(duration) {\r\n    super(2, duration);\r\n  }\r\n}\r\n\r\nexport default OutputReduced2;\r\n","import OutputReduced from \"./OutputReduced.mjs\";\r\n\r\nclass OutputReduced4 extends OutputReduced {\r\n  constructor(duration) {\r\n    super(4, duration);\r\n  }\r\n}\r\n\r\nexport default OutputReduced4;\r\n","import OutputReduced from \"./OutputReduced.mjs\";\r\n\r\nclass OutputReduced6 extends OutputReduced {\r\n  constructor(duration) {\r\n    super(6, duration);\r\n  }\r\n}\r\n\r\nexport default OutputReduced6;\r\n","import OutputReduced from \"./OutputReduced.mjs\";\r\n\r\nclass OutputReduced8 extends OutputReduced {\r\n  constructor(duration) {\r\n    super(8, duration);\r\n  }\r\n}\r\n\r\nexport default OutputReduced8;\r\n","import Critical from \"./Critical.mjs\";\r\n\r\nclass LoadingTimeIncreased extends Critical {\r\n  constructor(duration, loadingTimeIncrease) {\r\n    super(duration);\r\n\r\n    this.loadingTimeIncrease = loadingTimeIncrease;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      ...super.serialize(),\r\n      loadingTimeIncrease: this.loadingTimeIncrease\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    super.deserialize(data);\r\n    this.loadingTimeIncrease = data.loadingTimeIncrease || 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessage() {\r\n    if (this.duration) {\r\n      return `Charging time increased by ${this.loadingTimeIncrease} for ${this.turnsRemaining} turns`;\r\n    }\r\n    return `Charging time increased by ${this.loadingTimeIncrease}`;\r\n  }\r\n\r\n  getLoadingTimeIncrease() {\r\n    return this.loadingTimeIncrease;\r\n  }\r\n\r\n  excludes(critical) {\r\n    if (!(critical instanceof LoadingTimeIncreased)) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.loadingTimeIncrease < this.loadingTimeIncrease) {\r\n      return true;\r\n    }\r\n\r\n    if (critical.loadingTimeIncrease > this.loadingTimeIncrease) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.getDuration() !== null && this.getDuration() === null) {\r\n      return true;\r\n    }\r\n\r\n    return critical.getDuration() <= this.turnsRemaining;\r\n  }\r\n\r\n  isReplacedBy(critical) {\r\n    if (!(critical instanceof LoadingTimeIncreased)) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.loadingTimeIncrease > this.loadingTimeIncrease) {\r\n      return true;\r\n    }\r\n\r\n    if (critical.getDuration() === null && this.getDuration() !== null) {\r\n      return true;\r\n    }\r\n\r\n    return critical.getDuration() > this.turnsRemaining;\r\n  }\r\n}\r\n\r\nexport default LoadingTimeIncreased;\r\n","import Critical from \"./Critical.mjs\";\r\n\r\nclass ForcedOffline extends Critical {\r\n  getMessage() {\r\n    return `Forced offline for ${this.turnsRemaining} turns`;\r\n  }\r\n\r\n  excludes(critical) {\r\n    return (\r\n      critical instanceof ForcedOffline &&\r\n      critical.getDuration() <= this.turnsRemaining\r\n    );\r\n  }\r\n\r\n  isReplacedBy(critical) {\r\n    return (\r\n      critical instanceof ForcedOffline &&\r\n      critical.getDuration() > this.turnsRemaining\r\n    );\r\n  }\r\n}\r\n\r\nexport default ForcedOffline;\r\n","import Critical from \"./Critical.mjs\";\n\nclass ForcedOfflineOverheat extends Critical {\n  getMessage() {\n    return `Forced offline until system heat lowers to 0.5 or below`;\n  }\n\n  excludes(critical) {\n    return critical instanceof ForcedOfflineOverheat;\n  }\n\n  isFixed(system) {\n    return system.heat.getOverheatPercentage() < 0.5;\n  }\n}\n\nexport default ForcedOfflineOverheat;\n","import Critical from \"./Critical.mjs\";\r\n\r\nclass ThrustChannelHeatIncreased extends Critical {\r\n  constructor(heatMultiplier = 0.5, duration) {\r\n    super(duration);\r\n\r\n    this.heatMultiplier = heatMultiplier;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      ...super.serialize(),\r\n      heatMultiplier: this.heatMultiplier\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    super.deserialize(data);\r\n    this.heatMultiplier = data.heatMultiplier || 0.5;\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessage() {\r\n    if (this.duration) {\r\n      return `Heat per thrust increased by ${this.heatMultiplier} for ${this.turnsRemaining} turns`;\r\n    }\r\n    return `Heat per thrust increased by ${this.heatMultiplier}`;\r\n  }\r\n\r\n  getHeatIncrease() {\r\n    return this.heatMultiplier;\r\n  }\r\n\r\n  excludes(critical) {\r\n    if (!(critical instanceof ThrustChannelHeatIncreased)) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.heatMultiplier !== this.heatMultiplier) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.getDuration() !== null && this.getDuration() !== null) {\r\n      return critical.getDuration() <= this.turnsRemaining;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  isReplacedBy(critical) {\r\n    if (!(critical instanceof ThrustChannelHeatIncreased)) {\r\n      return false;\r\n    }\r\n\r\n    if (critical.getDuration() !== null && this.getDuration() !== null) {\r\n      if (critical.heatMultiplier !== this.heatMultiplier) {\r\n        return false;\r\n      }\r\n\r\n      return critical.getDuration() > this.turnsRemaining;\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default ThrustChannelHeatIncreased;\r\n","import DamageEntry from \"./DamageEntry.mjs\";\r\nimport * as criticals from \"./criticals/index.mjs\";\r\nimport Critical from \"./criticals/Critical.mjs\";\r\n\r\nclass SystemDamage {\r\n  constructor(system) {\r\n    this.system = system;\r\n    this.entries = [];\r\n    this.criticals = [];\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      entries: this.entries.map(entry => entry.serialize()),\r\n      criticals: this.criticals.map(entry => entry.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.entries = data.entries\r\n      ? data.entries.map(entry => new DamageEntry().deserialize(entry))\r\n      : [];\r\n\r\n    this.criticals = data.criticals\r\n      ? data.criticals.map(entry =>\r\n          new criticals[entry.className]().deserialize(entry)\r\n        )\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n\r\n  addDamage(damage) {\r\n    this.entries.push(damage);\r\n  }\r\n\r\n  getDamageById(id) {\r\n    const entry = this.entries.find(damage => damage.id === id);\r\n\r\n    if (entry) {\r\n      entry.setSystem(this.system);\r\n    }\r\n\r\n    return entry;\r\n  }\r\n\r\n  addCritical(critical) {\r\n    this.criticals.push(critical);\r\n  }\r\n\r\n  filterReplaced(critical) {\r\n    this.criticals = this.criticals.filter(old => !old.isReplacedBy(critical));\r\n  }\r\n\r\n  hasCritical(object) {\r\n    switch (typeof object) {\r\n      case \"object\":\r\n        return this.criticals.some(\r\n          crit => crit.constructor === object.constructor\r\n        );\r\n      case \"function\":\r\n        return this.criticals.some(crit => crit instanceof object);\r\n\r\n      case \"string\":\r\n        return this.criticals.some(crit => crit.constructor.name === object);\r\n    }\r\n  }\r\n\r\n  getCriticals() {\r\n    return this.criticals;\r\n  }\r\n\r\n  hasAnyCritical() {\r\n    return this.criticals.length > 0;\r\n  }\r\n\r\n  getTotalDamage() {\r\n    const damage = this.entries.reduce(\r\n      (acc, entry) => acc + entry.getDamage(),\r\n      0\r\n    );\r\n\r\n    if (damage > this.system.hitpoints) {\r\n      return this.system.hitpoints;\r\n    }\r\n\r\n    return damage;\r\n  }\r\n\r\n  getPercentUnDamaged() {\r\n    return 1 - this.getTotalDamage() / this.system.hitpoints;\r\n  }\r\n\r\n  getNewDamage() {\r\n    return this.entries\r\n      .filter(entry => entry.new)\r\n      .reduce((acc, entry) => acc + entry.getDamage(), 0);\r\n  }\r\n\r\n  isDestroyed() {\r\n    return this.getTotalDamage() >= this.system.hitpoints;\r\n  }\r\n\r\n  advanceTurn() {\r\n    this.entries = this.entries\r\n      .map(entry => entry.advanceTurn())\r\n      .filter(Boolean);\r\n    this.criticals.forEach(critical => critical.advanceTurn());\r\n    this.criticals = this.criticals.filter(\r\n      critical => !critical.isFixed(this.system)\r\n    );\r\n  }\r\n}\r\n\r\nexport default SystemDamage;\r\n","const POWER_TYPE_OFFLINE = \"offline\";\nconst POWER_TYPE_BOOST = \"boost\";\nconst POWER_TYPE_GO_OFFLINE = \"go-offline\";\nconst POWER_TYPE_GO_ONLINE = \"go-online\";\n\nclass PowerEntry {\n  constructor(powerType, amount = 0) {\n    this.type = powerType;\n    this.amount = amount;\n  }\n\n  isOffline() {\n    return this.type === POWER_TYPE_OFFLINE;\n  }\n\n  isGoingOffline() {\n    return this.type === POWER_TYPE_GO_OFFLINE;\n  }\n\n  isGoingOnline() {\n    return this.type === POWER_TYPE_GO_ONLINE;\n  }\n\n  isBoost() {\n    return this.type === POWER_TYPE_BOOST;\n  }\n\n  getAmount() {\n    return this.amount;\n  }\n\n  setAmount(amount) {\n    this.amount = amount;\n  }\n\n  serialize() {\n    return {\n      type: this.type,\n      amount: this.amount\n    };\n  }\n\n  deserialize(data) {\n    this.type = data.type;\n    this.amount = data.amount || 0;\n\n    return this;\n  }\n}\n\nexport {\n  POWER_TYPE_OFFLINE,\n  POWER_TYPE_BOOST,\n  POWER_TYPE_GO_OFFLINE,\n  POWER_TYPE_GO_ONLINE\n};\n\nexport default PowerEntry;\n","import PowerEntry, {\r\n  POWER_TYPE_OFFLINE,\r\n  POWER_TYPE_GO_OFFLINE,\r\n  POWER_TYPE_GO_ONLINE\r\n  //POWER_TYPE_BOOST\r\n} from \"./PowerEntry.mjs\";\r\n\r\nclass SystemPower {\r\n  constructor(system) {\r\n    this.system = system;\r\n    this.entries = [];\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      entries: this.entries.map(entry => entry.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.entries = data.entries\r\n      ? data.entries.map(entry => new PowerEntry().deserialize(entry))\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n\r\n  isOffline() {\r\n    if (this.system.isDestroyed()) {\r\n      return false;\r\n    }\r\n\r\n    return (\r\n      (this.entries.some(entry => entry.isOffline()) ||\r\n        this.isGoingOffline()) &&\r\n      !this.isGoingOnline()\r\n    );\r\n  }\r\n\r\n  isOnline() {\r\n    return !this.isOffline();\r\n  }\r\n\r\n  isGoingOnline() {\r\n    return this.entries.some(entry => entry.isGoingOnline());\r\n  }\r\n\r\n  isGoingOffline() {\r\n    return this.entries.some(entry => entry.isGoingOffline());\r\n  }\r\n\r\n  forceOffline() {\r\n    if (this.isOffline() || !this.canSetOffline()) {\r\n      return;\r\n    }\r\n\r\n    this.entries = this.entries.filter(\r\n      entry => entry.type !== POWER_TYPE_GO_ONLINE\r\n    );\r\n\r\n    this.entries.push(new PowerEntry(POWER_TYPE_GO_OFFLINE));\r\n  }\r\n\r\n  setOffline() {\r\n    this.forceOffline();\r\n    this.system.callHandler(\"onSystemOffline\");\r\n  }\r\n\r\n  canSetOffline() {\r\n    return (\r\n      !this.isOffline() && this.system.callHandler(\"canSetOffline\", null, false)\r\n    );\r\n  }\r\n\r\n  canSetOnline() {\r\n    if (this.system.callHandler(\"shouldBeOffline\", null, false)) {\r\n      return false;\r\n    }\r\n\r\n    return (\r\n      this.isOffline() && this.system.callHandler(\"canSetOnline\", null, false)\r\n    );\r\n  }\r\n\r\n  setOnline() {\r\n    if (!this.isOffline()) {\r\n      return;\r\n    }\r\n\r\n    this.entries = this.entries.filter(\r\n      entry => entry.type !== POWER_TYPE_GO_OFFLINE\r\n    );\r\n\r\n    this.entries.push(new PowerEntry(POWER_TYPE_GO_ONLINE));\r\n  }\r\n\r\n  getPowerOutput() {\r\n    return this.system.callHandler(\"getPowerOutput\", null, 0);\r\n  }\r\n\r\n  getPowerRequirement() {\r\n    return this.system.callHandler(\"getPowerRequirement\", null, 0);\r\n  }\r\n\r\n  advanceTurn() {\r\n    if (this.isOffline()) {\r\n      this.entries = [new PowerEntry(POWER_TYPE_OFFLINE)];\r\n    } else {\r\n      this.entries = [];\r\n    }\r\n  }\r\n}\r\n\r\nexport default SystemPower;\r\n","class SystemHeat {\n  constructor(system) {\n    this.system = system;\n    this.heat = 0;\n    this.overheat = 0;\n\n    this.heatTransferPerStructure = 0.5;\n    this.overheatLimitPerStructure = 1;\n\n    this.overheatTransferRatio = 0.5;\n\n    this.heatTransferred = 0;\n  }\n\n  serialize() {\n    return {\n      heat: this.heat,\n      overheat: this.overheat\n    };\n  }\n\n  deserialize(data = {}) {\n    this.heat = data.heat || 0;\n    this.overheat = data.overheat || 0;\n\n    return this;\n  }\n\n  getHeat() {\n    return this.heat;\n  }\n\n  getMaxTransferHeat() {\n    if (this.isHeatStorage()) {\n      return 0;\n    }\n\n    return this.system.hitpoints * this.heatTransferPerStructure;\n  }\n\n  getTransferOverHeat() {\n    return this.overheat * this.overheatTransferRatio;\n  }\n\n  getTransferHeat() {\n    const max = this.getMaxTransferHeat() - this.heatTransferred;\n\n    if (max <= 0) {\n      return 0;\n    }\n\n    if (max > this.heat) {\n      let overheatTransfer = max - this.heat;\n\n      if (overheatTransfer > this.getTransferOverHeat()) {\n        overheatTransfer = this.getTransferOverHeat();\n      }\n\n      return this.heat + overheatTransfer;\n    }\n\n    return max;\n  }\n\n  getHeatGenerated() {\n    return this.system.callHandler(\"getHeatGenerated\", null, 0);\n  }\n\n  getHeatPerStructure() {\n    return this.getHeat() / this.system.hitpoints;\n  }\n\n  shouldDisplayHeat() {\n    return (\n      this.system.callHandler(\"generatesHeat\", null, false) ||\n      this.isHeatStorage()\n    );\n  }\n\n  generateHeat() {\n    const newHeat = this.getHeatGenerated();\n    this.heat += newHeat;\n    return newHeat;\n  }\n\n  isHeatStorage() {\n    return this.system.callHandler(\"canStoreHeat\", null, false);\n  }\n\n  getMaxHeatStoreCapacity() {\n    return this.system.callHandler(\"getHeatStoreAmount\", null, 0);\n  }\n\n  getHeatStoreCapacity() {\n    const capacity = this.getMaxHeatStoreCapacity() - this.heat;\n\n    if (capacity <= 0) {\n      return 0;\n    }\n\n    return capacity;\n  }\n\n  changeHeat(change) {\n    if (change < 0) {\n      if (change > this.heat) {\n        this.overheat += change + this.heat;\n        this.heat = 0;\n      } else {\n        this.heat += change;\n      }\n\n      this.heatTransferred += Math.abs(change);\n    } else {\n      this.heat += change;\n    }\n    return this;\n  }\n\n  markNewOverheat() {\n    if (this.isHeatStorage()) {\n      return;\n    }\n\n    this.overheat += this.heat;\n    this.heat = 0;\n  }\n\n  getOverheat() {\n    if (this.isHeatStorage()) {\n      return 0;\n    }\n\n    return this.overheat;\n  }\n\n  getOverheatTreshold() {\n    return this.system.hitpoints * this.overheatLimitPerStructure;\n  }\n\n  getOverheatPercentage(extra = 0) {\n    if (this.isHeatStorage()) {\n      return 0;\n    }\n\n    return (this.overheat + extra) / this.getOverheatTreshold();\n  }\n\n  getRadiateHeatCapacity() {\n    return this.system.callHandler(\"getHeatRadiationCapacity\", null, 0);\n  }\n\n  radiateHeat(heat) {\n    return this.system.callHandler(\"radiateHeat\", heat);\n  }\n\n  advanceTurn() {\n    this.heatTransferred = 0;\n  }\n}\n\nexport default SystemHeat;\n","class ShipSystemLogEntry {\r\n  constructor(system) {\r\n    this.system = system;\r\n    this.turn = null;\r\n\r\n    this.messages = [];\r\n  }\r\n\r\n  setTurn(turn) {\r\n    this.turn = turn;\r\n  }\r\n\r\n  addMessage(message) {\r\n    this.messages.push(message);\r\n  }\r\n\r\n  getMessage() {\r\n    return this.messages;\r\n  }\r\n\r\n  isOpen() {\r\n    return this.turn === null;\r\n  }\r\n\r\n  isTurn(turn) {\r\n    return this.turn === turn;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      className: this.constructor.name,\r\n      messages: this.messages,\r\n      turn: this.turn\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.turn = data.turn || null;\r\n    this.messages = data.messages || [];\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default ShipSystemLogEntry;\r\n","export const formatNumber = number => {\r\n  if ((number * 10) % 1 > 0) {\r\n    return number.toFixed(2);\r\n  }\r\n\r\n  if (number % 1 > 0) {\r\n    return number.toFixed(1);\r\n  }\r\n\r\n  return number;\r\n};\r\n","import ShipSystemLogEntry from \"./ShipSystemLogEntry.mjs\";\r\nimport { formatNumber } from \"../../../utils/format.mjs\";\r\n\r\nclass ShipSystemLogEntryHeat extends ShipSystemLogEntry {\r\n  constructor(system) {\r\n    super(system);\r\n\r\n    this.initialOverheat = 0;\r\n    this.initialOverheatPercentage = 0;\r\n    this.heatGenerated = 0;\r\n    this.heatCooled = 0;\r\n    this.heatRadiated = 0;\r\n    this.overheat = 0;\r\n    this.overheatPercentage = 0;\r\n    this.isForcedOffline = 0;\r\n    this.intialHeatStored = 0;\r\n    this.newHeatStored = 0;\r\n    this.heatGivenToRadiators = 0;\r\n  }\r\n\r\n  setIntialHeatStored(heat) {\r\n    this.intialHeatStored = heat;\r\n  }\r\n\r\n  addNewHeatStored(amount) {\r\n    this.newHeatStored += amount;\r\n  }\r\n\r\n  addHeatGivenToRadiators(amount) {\r\n    this.heatGivenToRadiators += amount;\r\n  }\r\n\r\n  setInitialOverheat(heat, percentage) {\r\n    this.initialOverheat = heat;\r\n    this.initialOverheatPercentage = percentage;\r\n  }\r\n\r\n  setHeatGenerated(heat) {\r\n    this.heatGenerated = heat;\r\n  }\r\n\r\n  setNewOverheat(heat, percentage) {\r\n    this.overheat = heat;\r\n    this.overheatPercentage = percentage;\r\n\r\n    this.heatCooled = this.heatGenerated + this.initialOverheat - this.overheat;\r\n  }\r\n\r\n  setHeatRadiated(heat) {\r\n    this.heatRadiated = heat;\r\n  }\r\n\r\n  setForcedOffline() {\r\n    this.isForcedOffline = true;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      ...super.serialize(),\r\n      initialOverheat: this.initialOverheat,\r\n      initialOverheatPercentage: this.initialOverheatPercentage,\r\n      heatGenerated: this.heatGenerated,\r\n      heatCooled: this.heatCooled,\r\n      heatRadiated: this.heatRadiated,\r\n      overheat: this.overheat,\r\n      overheatPercentage: this.overheatPercentage,\r\n      isForcedOffline: this.isForcedOffline,\r\n      intialHeatStored: this.intialHeatStored,\r\n      newHeatStored: this.newHeatStored,\r\n      heatGivenToRadiators: this.heatGivenToRadiators\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    super.deserialize(data);\r\n    this.initialOverheat = data.initialOverheat || 0;\r\n    this.initialOverheatPercentage = data.initialOverheatPercentage || 0;\r\n    this.heatGenerated = data.heatGenerated || 0;\r\n    this.heatCooled = data.heatCooled || 0;\r\n    this.heatRadiated = data.heatRadiated || 0;\r\n    this.overheat = data.overheat || 0;\r\n    this.overheatPercentage = data.overheatPercentage || 0;\r\n    this.isForcedOffline = data.isForcedOffline || 0;\r\n    this.intialHeatStored = data.intialHeatStored || 0;\r\n    this.newHeatStored = data.newHeatStored || 0;\r\n    this.heatGivenToRadiators = data.heatGivenToRadiators || 0;\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessage() {\r\n    let messages = [];\r\n\r\n    const isRadiator = this.system.callHandler(\"isRadiator\", null, false);\r\n    const isStorage = this.system.heat.isHeatStorage();\r\n\r\n    if (isStorage) {\r\n      messages = [...messages, ...this.getHeatStorageMessage()];\r\n    }\r\n\r\n    if (isRadiator) {\r\n      messages = [...messages, ...this.getRadiatorMessage()];\r\n    }\r\n\r\n    if (!isRadiator && !isStorage) {\r\n      messages = [...messages, ...this.getRegularMessage()];\r\n    }\r\n\r\n    return messages;\r\n  }\r\n\r\n  getRadiatorMessage() {\r\n    if (this.heatRadiated) {\r\n      return [`Radiated ${formatNumber(this.heatRadiated)} units of heat.`];\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  getHeatStorageMessage() {\r\n    const messages = [];\r\n\r\n    if (this.heatGivenToRadiators || this.newHeatStored) {\r\n      messages.push(\r\n        `Added ${formatNumber(\r\n          this.newHeatStored\r\n        )} units of heat. Transfered ${formatNumber(\r\n          this.heatGivenToRadiators\r\n        )} units of heat to radiators.`\r\n      );\r\n    }\r\n\r\n    messages.push(\r\n      `Stored ${formatNumber(\r\n        this.intialHeatStored + this.newHeatStored - this.heatGivenToRadiators\r\n      )} units of heat.`\r\n    );\r\n\r\n    return messages;\r\n  }\r\n\r\n  getRegularMessage() {\r\n    const messages = [];\r\n\r\n    if (this.heatGenerated || this.heatCooled) {\r\n      messages.push(\r\n        `Added ${formatNumber(this.heatGenerated)} and cooled ${formatNumber(\r\n          this.heatCooled\r\n        )} units of heat.`\r\n      );\r\n    }\r\n\r\n    let heatMessage = `Current system heat was ${formatNumber(this.overheat)}.`;\r\n\r\n    messages.push();\r\n\r\n    if (this.overheat) {\r\n      heatMessage += ` Overheating ${Math.round(\r\n        this.overheatPercentage * 100\r\n      )}%.`;\r\n    }\r\n\r\n    messages.push(heatMessage);\r\n    if (this.isForcedOffline) {\r\n      messages.push(`System forced offline until overheat is less than 50%.`);\r\n    }\r\n\r\n    return messages;\r\n  }\r\n}\r\n\r\nexport default ShipSystemLogEntryHeat;\r\n","import ShipSystemLogEntry from \"./ShipSystemLogEntry.mjs\";\r\n\r\nclass ShipSystemLogEntryCriticalHit extends ShipSystemLogEntry {\r\n  constructor(system) {\r\n    super(system);\r\n\r\n    this.newDamagePoints = 0;\r\n    this.overHeatPoints = 0;\r\n    this.oldDamagePoints = 0;\r\n    this.criticalMessage = \"\";\r\n    this.extraPoints = 0;\r\n  }\r\n\r\n  setExtraPoints(amount) {\r\n    this.extraPoints = amount;\r\n  }\r\n\r\n  setNewDamagePoints(damage) {\r\n    this.newDamagePoints = damage;\r\n  }\r\n\r\n  setOldDamagePoints(damage) {\r\n    this.oldDamagePoints = damage;\r\n  }\r\n\r\n  setOverHeatPoints(amount) {\r\n    this.overHeatPoints += amount;\r\n  }\r\n\r\n  setCriticalMessage(message) {\r\n    this.criticalMessage = message;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      ...super.serialize(),\r\n      newDamagePoints: this.newDamagePoints,\r\n      overHeatPoints: this.overHeatPoints,\r\n      oldDamagePoints: this.oldDamagePoints,\r\n      criticalMessage: this.criticalMessage,\r\n      extraPoints: this.extraPoints\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    super.deserialize(data);\r\n    this.newDamagePoints = data.newDamagePoints || 0;\r\n    this.overHeatPoints = data.overHeatPoints || 0;\r\n    this.oldDamagePoints = data.oldDamagePoints || 0;\r\n    this.criticalMessage = data.criticalMessage || \"\";\r\n    this.extraPoints = data.extraPoints || 0;\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessage() {\r\n    const messages = [\r\n      `Tested for critical damage:`,\r\n      `Existing damage: ${this.oldDamagePoints}, new: ${\r\n        this.newDamagePoints\r\n      }, overheat: ${this.overHeatPoints}, random: ${\r\n        this.extraPoints\r\n      }, total: ${this.oldDamagePoints +\r\n        this.newDamagePoints +\r\n        this.overHeatPoints +\r\n        this.extraPoints}`\r\n    ];\r\n\r\n    if (this.criticalMessage) {\r\n      messages.push(`Resulted in critical:`);\r\n      messages.push(`\"${this.criticalMessage}\"`);\r\n    }\r\n\r\n    return messages;\r\n  }\r\n}\r\n\r\nexport default ShipSystemLogEntryCriticalHit;\r\n","import ShipSystemLogEntry from \"./ShipSystemLogEntry.mjs\";\r\n\r\nclass ShipSystemLogEntryDamage extends ShipSystemLogEntry {\r\n  constructor(system) {\r\n    super(system);\r\n\r\n    this.damage = 0;\r\n    this.blockedByArmor = 0;\r\n    this.wasDestroyed = false;\r\n  }\r\n\r\n  addDamage(damageEntry) {\r\n    this.damage += damageEntry.amount;\r\n    this.blockedByArmor += damageEntry.armor;\r\n    if (damageEntry.destroyedSystem) {\r\n      this.wasDestroyed = true;\r\n    }\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      ...super.serialize(),\r\n      blockedByArmor: this.blockedByArmor,\r\n      damage: this.damage,\r\n      wasDestroyed: this.wasDestroyed\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    super.deserialize(data);\r\n    this.blockedByArmor = data.blockedByArmor || 0;\r\n    this.damage = data.damage || 0;\r\n    this.wasDestroyed = data.wasDestroyed || false;\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessage() {\r\n    const messages = [\r\n      `Suffered ${this.damage} points of damge. Armor blocked ${this.addBlockedByArmor} points.`\r\n    ];\r\n\r\n    if (this.wasDestroyed) {\r\n      messages.push(`System was destroyed`);\r\n    }\r\n\r\n    return messages;\r\n  }\r\n}\r\n\r\nexport default ShipSystemLogEntryDamage;\r\n","import ShipSystemLogEntry from \"./ShipSystemLogEntry.mjs\";\r\nimport ShipSystemLogEntryHeat from \"./ShipSystemLogEntryHeat.mjs\";\r\nimport ShipSystemLogEntryCriticalHit from \"./ShipSystemLogEntryCriticalHit.mjs\";\r\nimport ShipSystemLogEntryDamage from \"./ShipSystemLogEntryDamage.mjs\";\r\n\r\nexport const systemLogEntryClasses = {\r\n  ShipSystemLogEntry,\r\n  ShipSystemLogEntryHeat,\r\n  ShipSystemLogEntryCriticalHit,\r\n  ShipSystemLogEntryDamage\r\n};\r\n","import { systemLogEntryClasses } from \"./systemLogEntryClasses.mjs\";\r\nimport ShipSystemLogEntry from \"./ShipSystemLogEntry.mjs\";\r\n\r\nclass ShipSystemLog {\r\n  constructor(system) {\r\n    this.system = system;\r\n\r\n    this.log = [];\r\n  }\r\n\r\n  getGenericLogEntry() {\r\n    const entry = new ShipSystemLogEntry();\r\n    this.log.push(entry);\r\n    return entry;\r\n  }\r\n\r\n  getOpenLogEntryByClass(className) {\r\n    let entry = this.log\r\n      .filter(entry => entry.isOpen())\r\n      .find(entry => entry instanceof className);\r\n\r\n    if (!entry) {\r\n      entry = new className(this.system);\r\n      this.log.push(entry);\r\n    }\r\n\r\n    return entry;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      log: this.log.map(entry => entry.serialize())\r\n    };\r\n  }\r\n\r\n  getMessagesForTurn(turn) {\r\n    return this.log\r\n      .filter(entry => entry.isTurn(turn))\r\n      .reduce((all, entry) => [...all, ...entry.getMessage()], []);\r\n  }\r\n\r\n  getWithTurns() {\r\n    const turns = [];\r\n\r\n    this.log.forEach(entry => {\r\n      let turnEntry = turns.find(turnEntry => turnEntry.turn === entry.turn);\r\n\r\n      if (!turnEntry) {\r\n        turnEntry = {\r\n          turn: entry.turn,\r\n          messages: []\r\n        };\r\n\r\n        turns.push(turnEntry);\r\n      }\r\n\r\n      turnEntry.messages = [...turnEntry.messages, ...entry.getMessage()];\r\n    });\r\n\r\n    return turns;\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.log = data.log || [];\r\n    this.log = this.log.map(entry =>\r\n      new systemLogEntryClasses[entry.className](this.system).deserialize(entry)\r\n    );\r\n\r\n    return this;\r\n  }\r\n\r\n  endTurn(turn) {\r\n    this.log\r\n      .filter(entry => entry.isOpen())\r\n      .forEach(entry => entry.setTurn(turn));\r\n  }\r\n\r\n  advanceTurn(turn) {}\r\n}\r\n\r\nexport default ShipSystemLog;\r\n","import SystemDamage from \"./SystemDamage.mjs\";\nimport SystemPower from \"./SystemPower.mjs\";\nimport SystemHeat from \"./SystemHeat.mjs\";\nimport ShipSystemLog from \"./ShipSystemLog/ShipSystemLog.mjs\";\nimport ShipSystemLogEntryDamage from \"./ShipSystemLog/ShipSystemLogEntryDamage.mjs\";\nimport { formatNumber } from \"../../utils/format.mjs\";\n\nclass ShipSystem {\n  constructor(args = {}, strategies = []) {\n    this.id = args.id;\n    this.hitpoints = args.hitpoints;\n    this.armor = args.armor || 0;\n    this.strategies = strategies;\n\n    if (!this.hitpoints) {\n      throw new Error(\"System must have hitpoints\");\n    }\n\n    this.strategies.forEach(strategy => strategy.init(this));\n\n    this.damage = new SystemDamage(this);\n    this.power = new SystemPower(this);\n\n    this.shipSystems = null;\n\n    this.heat = new SystemHeat(this);\n    this.log = new ShipSystemLog(this);\n  }\n\n  getSystemDescription() {\n    return \"\";\n  }\n\n  addStrategy(strategy) {\n    this.strategies.push(strategy);\n    strategy.init(this);\n  }\n\n  addShipSystemsReference(shipSystems) {\n    this.shipSystems = shipSystems;\n  }\n\n  getSystemInfo(ship) {\n    const heatMessages = [];\n\n    if (this.heat.shouldDisplayHeat()) {\n      if (!this.heat.isHeatStorage()) {\n        heatMessages.push({\n          sort: \"heat\",\n          value: [\n            {\n              header: \"Overheat\",\n              value: `${formatNumber(this.heat.getOverheat())}/${formatNumber(\n                this.heat.getOverheatTreshold()\n              )} (${Math.round(this.heat.getOverheatPercentage() * 100)}%)`\n            },\n            {\n              header: \"Cooling\",\n              value: this.heat.getMaxTransferHeat()\n            }\n          ]\n        });\n      }\n    }\n\n    return [\n      {\n        sort: \"AAA\",\n        value: [\n          {\n            header: \"Hitpoints\",\n            value: `${this.getRemainingHitpoints()}/${this.hitpoints}`\n          },\n          { header: \"Armor\", value: `${this.getArmor()}` }\n        ]\n      },\n      ...heatMessages,\n      ...this.callHandler(\"getMessages\", null, [])\n    ];\n  }\n\n  getDisplayName() {\n    return null;\n  }\n\n  getBackgroundImage() {\n    return null;\n  }\n\n  getIconText() {\n    return this.callHandler(\"getIconText\", null, \"\");\n  }\n\n  isDestroyed() {\n    return this.damage.isDestroyed();\n  }\n\n  isDisabled() {\n    return this.power.isOffline() || this.isDestroyed();\n  }\n\n  getArmor() {\n    const armorMod = this.callHandler(\"getArmorModifier\", null, 0);\n\n    return this.armor + armorMod;\n  }\n\n  getRemainingHitpoints() {\n    return this.hitpoints - this.getTotalDamage();\n  }\n\n  getTotalDamage() {\n    return this.damage.getTotalDamage();\n  }\n\n  addDamage(damage) {\n    const shipWasDestroyed = this.shipSystems\n      ? this.shipSystems.isDestroyed()\n      : undefined;\n\n    const systemWasDestroyed = this.isDestroyed();\n    this.damage.addDamage(damage);\n\n    if (!systemWasDestroyed && this.isDestroyed()) {\n      damage.setDestroyedSystem();\n    }\n\n    const logEntry = this.log.getOpenLogEntryByClass(ShipSystemLogEntryDamage);\n    logEntry.addDamage(damage);\n\n    if (\n      this.shipSystems &&\n      shipWasDestroyed === false &&\n      this.shipSystems.isDestroyed()\n    ) {\n      this.shipSystems.markDestroyedThisTurn();\n    }\n  }\n\n  addCritical(critical) {\n    this.damage.addCritical(critical);\n  }\n\n  hasAnyCritical() {\n    return this.damage.hasAnyCritical();\n  }\n\n  hasCritical(name) {\n    return this.damage.hasCritical(name);\n  }\n\n  callHandler(name, payload = {}, response = undefined) {\n    this.strategies.forEach(strategy => {\n      response = strategy.callHandler(name, payload, response);\n    });\n\n    return response;\n  }\n\n  getStrategiesByInstance(instance) {\n    return this.strategies.filter(strategy => strategy instanceof instance);\n  }\n\n  deserialize(data = {}) {\n    this.damage.deserialize(data.damage);\n    this.power.deserialize(data.power);\n    this.heat.deserialize(data.heat);\n    this.log.deserialize(data.log);\n    this.callHandler(\"deserialize\", data);\n\n    return this;\n  }\n\n  serialize() {\n    return {\n      damage: this.damage.serialize(),\n      power: this.power.serialize(),\n      heat: this.heat.serialize(),\n      log: this.log.serialize(),\n      ...this.callHandler(\"serialize\")\n    };\n  }\n\n  endTurn(turn) {\n    this.log.endTurn(turn);\n  }\n\n  advanceTurn(turn) {\n    this.damage.advanceTurn(turn);\n    this.power.advanceTurn(turn);\n    this.heat.advanceTurn(turn);\n    this.log.advanceTurn(turn);\n    this.callHandler(\"advanceTurn\", turn);\n  }\n\n  isWeapon() {\n    return false;\n  }\n\n  showOnSystemList() {\n    return false;\n  }\n}\n\nexport default ShipSystem;\n","import dice from \"rpg-dice-roller\";\n\nclass ShipSystemStrategy {\n  constructor() {\n    this.system = null;\n    this.diceRoller = new dice.DiceRoller();\n  }\n\n  init(system) {\n    this.system = system;\n  }\n\n  hasHandler(name) {\n    return Boolean(this[name]);\n  }\n\n  callHandler(name, payload = {}, previousResponse) {\n    if (!this.hasHandler(name)) {\n      return previousResponse;\n    }\n    return this[name](payload, previousResponse);\n  }\n}\n\nexport default ShipSystemStrategy;\n","class CargoEntity {\r\n  getSpaceRequired() {\r\n    return 0.1;\r\n  }\r\n\r\n  getCargoInfo() {\r\n    return [];\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport default CargoEntity;\r\n","import CargoEntity from \"../../../cargo/CargoEntity.mjs\";\n\nclass Torpedo extends CargoEntity {\n  constructor({\n    deltaVelocityPerTurn,\n    turnsToLive,\n    maxInterceptVelocity = 140,\n    hitSize = 0,\n    evasion = 30,\n    armingTime = 1\n  }) {\n    super();\n    this.deltaVelocityPerTurn = deltaVelocityPerTurn;\n    this.turnsToLive = turnsToLive;\n    this.maxInterceptVelocity = maxInterceptVelocity;\n    this.hitSize = hitSize;\n    this.evasion = evasion;\n    this.armingTime = armingTime;\n\n    this.damageStrategy = null;\n\n    this.visuals = {\n      engineColor: [51 / 255, 163 / 255, 255 / 255],\n      explosionType: \"HE\",\n      explosionSize: 15\n    };\n  }\n\n  getStrikeDistance(flight, target) {\n    return 1;\n  }\n\n  getHitSize() {\n    return this.hitSize;\n  }\n\n  getEvasion() {\n    return this.evasion;\n  }\n\n  getInterceptTries(effectiveness, flight, target) {\n    let tries = Math.round(5 * (1 - effectiveness));\n    if (tries < 1) {\n      tries = 1;\n    }\n\n    switch (tries) {\n      case 1:\n        return [1, 2, 3];\n      case 2:\n        return [1, 2, 3, 4];\n      default:\n        return [1, 2, 3, 4, 5];\n    }\n  }\n\n  getCargoInfo() {\n    const previousResponse = super.getCargoInfo();\n\n    return [\n      ...previousResponse,\n      { header: \"Velocity per turn\", value: this.deltaVelocityPerTurn },\n      { header: \"Turns active\", value: this.turnsToLive },\n      { header: \"Arming time\", value: this.armingTime },\n      { header: \"Evasion\", value: this.evasion },\n      ...this.damageStrategy.getMessages()\n    ];\n  }\n}\n\nexport default Torpedo;\n","import Torpedo from \"./Torpedo.mjs\";\r\n\r\nclass Torpedo158 extends Torpedo {\r\n  constructor({\r\n    deltaVelocityPerTurn,\r\n    turnsToLive,\r\n    maxInterceptVelocity = 140,\r\n    hitSize = 0,\r\n    evasion = 30\r\n  }) {\r\n    super({\r\n      deltaVelocityPerTurn,\r\n      turnsToLive,\r\n      maxInterceptVelocity,\r\n      hitSize,\r\n      evasion,\r\n      armingTime: 2\r\n    });\r\n  }\r\n}\r\n\r\nexport default Torpedo158;\r\n","class HitSystemRandomizer {\r\n  rollForSystem(totalStructure) {\r\n    return Math.ceil(Math.random() * totalStructure);\r\n  }\r\n\r\n  randomizeHitSystem(systems) {\r\n    if (systems.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    const totalStructure = systems.reduce(\r\n      (total, system) => total + this.getSystemHitSize(system),\r\n      0\r\n    );\r\n\r\n    const roll = this.rollForSystem(totalStructure);\r\n\r\n    let tested = 0;\r\n\r\n    return systems.find(system => {\r\n      if (roll > tested && roll <= this.getSystemHitSize(system) + tested) {\r\n        return true;\r\n      }\r\n\r\n      tested += this.getSystemHitSize(system);\r\n      return false;\r\n    });\r\n  }\r\n\r\n  getSystemHitSize(system) {\r\n    return (\r\n      system.hitpoints *\r\n      system.callHandler(\"getHitSystemSizeMultiplier\", null, 1)\r\n    );\r\n  }\r\n}\r\n\r\nexport default HitSystemRandomizer;\r\n","class CombatLogDamageEntry {\r\n  constructor() {\r\n    this.entries = [];\r\n    this.notes = [];\r\n  }\r\n\r\n  addNote(note) {\r\n    this.notes.push(note);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      entries: this.entries,\r\n      notes: this.notes\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.entries = data.entries || [];\r\n    this.notes = data.notes || [];\r\n    return this;\r\n  }\r\n\r\n  add(system, damage) {\r\n    this.entries.push({\r\n      systemId: system.id,\r\n      damageIds: [].concat(damage).map(d => d.id)\r\n    });\r\n  }\r\n\r\n  getDamages(target) {\r\n    return this.entries.reduce((total, { systemId, damageIds }) => {\r\n      const system = target.systems.getSystemById(systemId);\r\n\r\n      return total.concat(\r\n        damageIds.map(damageId => system.damage.getDamageById(damageId))\r\n      );\r\n    }, []);\r\n  }\r\n}\r\n\r\nexport default CombatLogDamageEntry;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\r\nimport HitSystemRandomizer from \"./utils/HitSystemRandomizer.mjs\";\r\nimport DamageEntry from \"../../DamageEntry.mjs\";\r\nimport CombatLogDamageEntry from \"../../../../combatLog/CombatLogDamageEntry.mjs\";\r\n\r\nclass StandardDamageStrategy extends ShipSystemStrategy {\r\n  constructor(damageFormula = 0, armorPiercingFormula = 0) {\r\n    super();\r\n\r\n    this.damageFormula = damageFormula;\r\n    this.armorPiercingFormula = armorPiercingFormula;\r\n    this.hitSystemRandomizer = new HitSystemRandomizer();\r\n  }\r\n\r\n  getTotalBurstSize() {\r\n    return 1;\r\n  }\r\n\r\n  _getDamageMessage() {\r\n    let messages = [];\r\n\r\n    if (this.damageFormula) {\r\n      messages.push(this.damageFormula);\r\n    }\r\n\r\n    const ammo = this.system.callHandler(\"getSelectedAmmo\", null, null);\r\n\r\n    if (ammo) {\r\n      messages.push(ammo.damageFormula);\r\n    }\r\n\r\n    return messages.join(\" + ammo: \");\r\n  }\r\n\r\n  _getArmorPiercingMessage() {\r\n    let messages = [];\r\n\r\n    if (this.armorPiercingFormula) {\r\n      messages.push(this.armorPiercingFormula);\r\n    }\r\n\r\n    const ammo = this.system.callHandler(\"getSelectedAmmo\", null, null);\r\n\r\n    if (ammo) {\r\n      messages.push(ammo.armorPiercingFormula);\r\n    }\r\n\r\n    return messages.join(\" + ammo: \");\r\n  }\r\n\r\n  _getDamageTypeMessage() {\r\n    return \"Standard\";\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Damage type\",\r\n      value: this._getDamageTypeMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Damage\",\r\n      value: this._getDamageMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Armor piercing\",\r\n      value: this._getArmorPiercingMessage()\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  applyDamageFromWeaponFire(payload) {\r\n    const { fireOrder, combatLogEntry, hitResolution } = payload;\r\n\r\n    const hit = hitResolution.result;\r\n\r\n    const result = new CombatLogDamageEntry();\r\n    combatLogEntry.addDamage(result);\r\n\r\n    if (hit) {\r\n      combatLogEntry.setShots(1, 1);\r\n      this._doDamage(\r\n        { shooterPosition: payload.shooter.getPosition(), ...payload },\r\n        result\r\n      );\r\n    } else {\r\n      combatLogEntry.setShots(0, 1);\r\n    }\r\n  }\r\n\r\n  _doDamage(\r\n    payload,\r\n    damageResult,\r\n    lastSection,\r\n    armorPiercing = undefined,\r\n    damage = undefined\r\n  ) {\r\n    const { target, shooterPosition } = payload;\r\n\r\n    if (armorPiercing === undefined) {\r\n      armorPiercing = this._getArmorPiercing(payload);\r\n    }\r\n\r\n    if (damage === undefined) {\r\n      damage = this._getDamageForWeaponHit(payload);\r\n    }\r\n\r\n    const hitSystem = this._chooseHitSystem({\r\n      target,\r\n      shooterPosition,\r\n      lastSection\r\n    });\r\n\r\n    if (!hitSystem) {\r\n      damageResult.addNote(\"Unable to find system to hit\");\r\n      return;\r\n    }\r\n\r\n    let result = this._doDamageToSystem(\r\n      payload,\r\n      damageResult,\r\n      hitSystem,\r\n      armorPiercing,\r\n      damage\r\n    );\r\n\r\n    armorPiercing = result.armorPiercing;\r\n    damage = result.damage;\r\n\r\n    if (damage === 0) {\r\n      return damageResult;\r\n    }\r\n\r\n    let overkillSystem = this._findOverkillStructure(hitSystem, target);\r\n\r\n    if (!overkillSystem) {\r\n      return this._doDamage(\r\n        payload,\r\n        damageResult,\r\n        target.systems.sections.getSectionBySystem(hitSystem),\r\n        armorPiercing,\r\n        damage\r\n      );\r\n    }\r\n\r\n    result = this._doDamageToSystem(\r\n      payload,\r\n      damageResult,\r\n      overkillSystem,\r\n      armorPiercing,\r\n      damage\r\n    );\r\n\r\n    armorPiercing = result.armorPiercing;\r\n    damage = result.damage;\r\n\r\n    if (damage === 0) {\r\n      return;\r\n    }\r\n\r\n    return this._doDamage(\r\n      payload,\r\n      damageResult,\r\n      target.systems.sections.getSectionBySystem(overkillSystem),\r\n      armorPiercing,\r\n      damage\r\n    );\r\n  }\r\n\r\n  _findOverkillStructure(system, ship) {\r\n    const section = ship.systems.sections.getSectionBySystem(system);\r\n    const structure = section.getStructure();\r\n\r\n    if (!structure || structure.id === system.id) {\r\n      return null;\r\n    }\r\n\r\n    return structure;\r\n  }\r\n\r\n  _doDamageToSystem(\r\n    { fireOrder },\r\n    damageResult,\r\n    hitSystem,\r\n    armorPiercing,\r\n    damage\r\n  ) {\r\n    let armor = hitSystem.getArmor();\r\n    let finalArmor = armor - armorPiercing;\r\n    if (finalArmor < 0) {\r\n      finalArmor = 0;\r\n    }\r\n\r\n    damage -= finalArmor;\r\n\r\n    let armorPiercingLeft = armorPiercing - armor;\r\n    if (armorPiercingLeft < 0) {\r\n      armorPiercingLeft = 0;\r\n    }\r\n\r\n    if (damage < 0) {\r\n      damage = 0;\r\n    }\r\n\r\n    let entry = null;\r\n\r\n    if (damage > hitSystem.getRemainingHitpoints()) {\r\n      if (hitSystem.getRemainingHitpoints() <= 0) {\r\n        throw new Error(\"Trying to damage destroyed system\");\r\n      }\r\n\r\n      entry = new DamageEntry(hitSystem.getRemainingHitpoints(), finalArmor);\r\n      damage -= hitSystem.getRemainingHitpoints();\r\n    } else {\r\n      entry = new DamageEntry(damage, finalArmor);\r\n\r\n      damage = 0;\r\n    }\r\n\r\n    hitSystem.addDamage(entry);\r\n    damageResult.add(hitSystem, entry);\r\n\r\n    return {\r\n      armorPiercing: armorPiercingLeft,\r\n      damage\r\n    };\r\n  }\r\n\r\n  _chooseHitSystem({ target, shooterPosition, lastSection }) {\r\n    return this.hitSystemRandomizer.randomizeHitSystem(\r\n      target.systems.getSystemsForHit(shooterPosition, lastSection)\r\n    );\r\n  }\r\n\r\n  _getDamageForWeaponHit({ requiredToHit, rolledToHit }) {\r\n    let damage = 0;\r\n    if (Number.isInteger(this.damageFormula)) {\r\n      damage = this.damageFormula;\r\n    } else if (this.damageFormula !== null) {\r\n      damage = this.diceRoller.roll(this.damageFormula).total;\r\n    }\r\n\r\n    if (!this.system) {\r\n      return damage;\r\n    }\r\n\r\n    const ammo = this.system.callHandler(\"getSelectedAmmo\", null, null);\r\n\r\n    if (!ammo) {\r\n      return damage;\r\n    }\r\n\r\n    return damage + ammo.getDamage(this.diceRoller);\r\n  }\r\n\r\n  _getArmorPiercing() {\r\n    let armorPiercing = 0;\r\n    if (Number.isInteger(this.armorPiercingFormula)) {\r\n      armorPiercing = this.armorPiercingFormula;\r\n    } else if (this.armorPiercingFormula !== null) {\r\n      armorPiercing = this.diceRoller.roll(this.armorPiercingFormula).total;\r\n    }\r\n\r\n    if (!this.system) {\r\n      return armorPiercing;\r\n    }\r\n\r\n    const ammo = this.system.callHandler(\"getSelectedAmmo\", null, null);\r\n\r\n    if (!ammo) {\r\n      return armorPiercing;\r\n    }\r\n\r\n    return armorPiercing + ammo.getArmorPiercing(this.diceRoller);\r\n  }\r\n}\r\n\r\nexport default StandardDamageStrategy;\r\n","import StandardDamageStrategy from \"../../../../strategy/weapon/StandardDamageStrategy.mjs\";\nimport CombatLogDamageEntry from \"../../../../../../combatLog/CombatLogDamageEntry.mjs\";\n\nclass MSVTorpedoDamageStrategy extends StandardDamageStrategy {\n  constructor(\n    damageFormula,\n    armorPiercingFormula,\n    rangePenalty,\n    numberOfShots,\n    strikeHitChange = 20,\n    minStrikeDistance = 1\n  ) {\n    super(damageFormula, armorPiercingFormula);\n    this.rangePenalty = rangePenalty;\n    this.numberOfShots = numberOfShots;\n    this.strikeHitChange = strikeHitChange;\n    this.minStrikeDistance = minStrikeDistance;\n  }\n\n  getMessages(payload, previousResponse = []) {\n    previousResponse.push({\n      header: \"Number of SVs\",\n      value: this.numberOfShots\n    });\n\n    previousResponse.push({\n      header: \"Damage per SV\",\n      value: this.damageFormula\n    });\n\n    previousResponse.push({\n      header: \"Armor piercing per SV\",\n      value: this.armorPiercingFormula\n    });\n\n    previousResponse.push({\n      header: \"SV range penalty\",\n      value: this.rangePenalty\n    });\n\n    return previousResponse;\n  }\n\n  _getDamageForWeaponHit({ torpedoFlight }) {\n    if (Number.isInteger(this.damageFormula)) {\n      return Math.ceil(this.damageFormula * torpedoFlight.strikeEffectiveness);\n    }\n    return Math.ceil(\n      this.diceRoller.roll(this.damageFormula).total *\n        torpedoFlight.strikeEffectiveness\n    );\n  }\n\n  _getArmorPiercing({ torpedoFlight }) {\n    if (Number.isInteger(this.armorPiercingFormula)) {\n      return Math.round(\n        this.armorPiercingFormula * torpedoFlight.strikeEffectiveness\n      );\n    }\n\n    return Math.round(\n      this.diceRoller.roll(this.armorPiercingFormula).total *\n        torpedoFlight.strikeEffectiveness\n    );\n  }\n\n  getHitChange({ target, torpedoFlight, distance }) {\n    const hitProfile = target.getHitProfile(torpedoFlight.launchPosition);\n    const rangeModifier =\n      this.rangePenalty * (1 + target.movement.getEvasion() / 10) * distance;\n\n    return hitProfile - rangeModifier;\n  }\n\n  getStrikeDistance(payload) {\n    let distance = 11;\n\n    while (distance--) {\n      if (distance === this.minStrikeDistance) {\n        return distance;\n      }\n\n      if (this.getHitChange({ ...payload, distance }) >= this.strikeHitChange) {\n        return distance;\n      }\n    }\n\n    return 1;\n  }\n\n  applyDamageFromWeaponFire(payload) {\n    const { torpedoFlight, combatLogEvent } = payload;\n    const attackPosition = torpedoFlight.launchPosition;\n\n    let shots = this.numberOfShots;\n\n    const distance = this.getStrikeDistance(payload);\n    const hitChance = this.getHitChange({ ...payload, distance });\n\n    combatLogEvent.addNote(\n      `MSV with ${this.numberOfShots} projectiles at distance ${distance} with hit chance of ${hitChance}% each.`\n    );\n\n    let hits = 0;\n\n    while (shots--) {\n      const roll = Math.ceil(Math.random() * 100);\n      const hit = roll <= hitChance;\n\n      if (hit) {\n        hits++;\n        const result = new CombatLogDamageEntry();\n        combatLogEvent.addDamage(result);\n        this._doDamage({ shooterPosition: attackPosition, ...payload }, result);\n      }\n    }\n\n    combatLogEvent.addNote(`${hits} MSVs hit target.`);\n  }\n}\n\nexport default MSVTorpedoDamageStrategy;\n","import Torpedo158 from \"./Torpedo158.mjs\";\nimport MSVTorpedoDamageStrategy from \"./torpedoDamageStrategy/MSVTorpedoDamageStrategy.mjs\";\n\nclass Torpedo158MSV extends Torpedo158 {\n  constructor() {\n    super({ deltaVelocityPerTurn: 48, turnsToLive: 6 });\n\n    this.damageStrategy = new MSVTorpedoDamageStrategy(\"d3+3\", 0, 15, 32);\n\n    this.visuals = {\n      engineColor: [255 / 255, 222 / 255, 120 / 255],\n      explosionType: \"MSV\"\n    };\n  }\n\n  getInterceptTries(effectiveness, flight, target) {\n    const distance = this.getStrikeDistance(flight, target);\n    if (distance > 5) {\n      return [5];\n    }\n\n    return [distance];\n  }\n\n  getStrikeDistance(flight, target) {\n    return this.damageStrategy.getStrikeDistance({\n      target,\n      torpedoFlight: flight\n    });\n  }\n\n  getCargoInfo() {\n    const previousResponse = super.getCargoInfo();\n\n    return [\n      {\n        value: \"A long range torpedo with Multiple Strike Vehicles.\"\n      },\n      ...previousResponse\n    ];\n  }\n\n  getDisplayName() {\n    return \"Shrike 1.53m MSV torpedo\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/torpedoMSV.png\";\n  }\n}\n\nexport default Torpedo158MSV;\n","import Torpedo158 from \"./Torpedo158.mjs\";\r\nimport MSVTorpedoDamageStrategy from \"./torpedoDamageStrategy/MSVTorpedoDamageStrategy.mjs\";\r\n\r\nclass Torpedo158MSV2 extends Torpedo158 {\r\n  constructor() {\r\n    super({ deltaVelocityPerTurn: 48, turnsToLive: 6, evasion: 35 });\r\n\r\n    this.damageStrategy = new MSVTorpedoDamageStrategy(\"d3\", 0, 5, 84, 10);\r\n\r\n    this.visuals = {\r\n      engineColor: [255 / 255, 222 / 255, 120 / 255],\r\n      explosionType: \"MSV\"\r\n    };\r\n  }\r\n\r\n  getInterceptTries(effectiveness, flight, target) {\r\n    const distance = this.getStrikeDistance(flight, target);\r\n    if (distance > 5) {\r\n      return [5];\r\n    }\r\n\r\n    return [distance];\r\n  }\r\n\r\n  getStrikeDistance(flight, target) {\r\n    return this.damageStrategy.getStrikeDistance({\r\n      target,\r\n      torpedoFlight: flight\r\n    });\r\n  }\r\n\r\n  getCargoInfo() {\r\n    const previousResponse = super.getCargoInfo();\r\n\r\n    return [\r\n      {\r\n        value:\r\n          \"A long range torpedo with Multiple Strike Vehicles. Designed to supress smaller targets.\"\r\n      },\r\n      ...previousResponse\r\n    ];\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Shrike B 1.53m saturation MSV torpedo\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/torpedoMSV2.png\";\r\n  }\r\n}\r\n\r\nexport default Torpedo158MSV2;\r\n","import CombatLogDamageEntry from \"../../../../../../combatLog/CombatLogDamageEntry.mjs\";\nimport ExplosiveDamageStrategy from \"../../../../strategy/weapon/ExplosiveDamageStrategy.mjs\";\n\nclass HETorpedoDamageStrategy extends ExplosiveDamageStrategy {\n  constructor(damageFormula, armorPiercingFormula, numberOfHitsFormula) {\n    super(damageFormula, armorPiercingFormula, numberOfHitsFormula);\n  }\n\n  _getDamageMessage() {\n    return this.damageFormula;\n  }\n\n  _getArmorPiercingMessage() {\n    return this.armorPiercingFormula;\n  }\n\n  getStrikeDistance() {\n    return 1;\n  }\n\n  applyDamageFromWeaponFire(payload) {\n    const { torpedoFlight, combatLogEvent } = payload;\n    const attackPosition = torpedoFlight.launchPosition;\n\n    const result = new CombatLogDamageEntry();\n    combatLogEvent.addDamage(result);\n    this._doDamage({ shooterPosition: attackPosition, ...payload }, result);\n  }\n}\n\nexport default HETorpedoDamageStrategy;\n","import StandardDamageStrategy from \"./StandardDamageStrategy.mjs\";\r\n\r\nclass ExplosiveDamageStrategy extends StandardDamageStrategy {\r\n  constructor(damageFormula, armorPiercingFormula, numberOfDamagesFormula = 1) {\r\n    super(damageFormula, armorPiercingFormula);\r\n\r\n    this.numberOfDamagesFormula = numberOfDamagesFormula;\r\n  }\r\n\r\n  _getDamageTypeMessage() {\r\n    return \"Explosive\";\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Damage type\",\r\n      value: this._getDamageTypeMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Number of hits\",\r\n      value: this.numberOfDamagesFormula\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Damage per hit\",\r\n      value: this._getDamageMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Armor piercing per hit\",\r\n      value: this._getArmorPiercingMessage()\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  _getNumberOfDamagesForWeaponHit() {\r\n    if (Number.isInteger(this.numberOfDamagesFormula)) {\r\n      return this.numberOfDamagesFormula;\r\n    }\r\n    return this.diceRoller.roll(this.numberOfDamagesFormula).total;\r\n  }\r\n\r\n  _doDamage(payload, damageResult) {\r\n    const { target, shooterPosition } = payload;\r\n\r\n    let numberOfDamages = this._getNumberOfDamagesForWeaponHit();\r\n\r\n    while (numberOfDamages--) {\r\n      const hitSystem = this._chooseHitSystem({\r\n        target,\r\n        shooterPosition\r\n      });\r\n\r\n      if (!hitSystem) {\r\n        return;\r\n      }\r\n\r\n      this._doDamageToSystem(\r\n        payload,\r\n        damageResult,\r\n        hitSystem,\r\n        this._getArmorPiercing(),\r\n        this._getDamageForWeaponHit(payload)\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default ExplosiveDamageStrategy;\r\n","import Torpedo158 from \"./Torpedo158.mjs\";\r\nimport HETorpedoDamageStrategy from \"./torpedoDamageStrategy/HETorpedoDamageStrategy.mjs\";\r\n\r\nclass Torpedo158Nuclear extends Torpedo158 {\r\n  constructor(args) {\r\n    super({\r\n      deltaVelocityPerTurn: 40,\r\n      turnsToLive: 6,\r\n      maxInterceptVelocity: 200,\r\n      evasion: 25\r\n    });\r\n\r\n    this.damageStrategy = new HETorpedoDamageStrategy(\"d10+4\", 0, \"d20+60\");\r\n  }\r\n\r\n  getCargoInfo() {\r\n    const previousResponse = super.getCargoInfo();\r\n\r\n    return [\r\n      {\r\n        value: \"A long range torpedo with 8 megaton nuclear payload.\"\r\n      },\r\n      ...previousResponse\r\n    ];\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Bodkin 1.53m nuclear torpedo\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/torpedoNuclear.png\";\r\n  }\r\n}\r\n\r\nexport default Torpedo158Nuclear;\r\n","import Torpedo from \"./Torpedo.mjs\";\r\n\r\nclass Torpedo72 extends Torpedo {\r\n  constructor({\r\n    deltaVelocityPerTurn,\r\n    turnsToLive = 4,\r\n    maxInterceptVelocity = 110,\r\n    hitSize = 0,\r\n    evasion = 50\r\n  }) {\r\n    super({\r\n      deltaVelocityPerTurn,\r\n      turnsToLive,\r\n      maxInterceptVelocity,\r\n      hitSize,\r\n      evasion\r\n    });\r\n  }\r\n}\r\n\r\nexport default Torpedo72;\r\n","import MSVTorpedoDamageStrategy from \"./torpedoDamageStrategy/MSVTorpedoDamageStrategy.mjs\";\nimport Torpedo72 from \"./Torpedo72.mjs\";\n\nclass Torpedo72MSV extends Torpedo72 {\n  constructor() {\n    super({ deltaVelocityPerTurn: 42, turnsToLive: 4 });\n\n    this.damageStrategy = new MSVTorpedoDamageStrategy(\"d3+3\", 0, 15, 25);\n    this.visuals = {\n      engineColor: [255 / 255, 222 / 255, 120 / 255],\n      explosionType: \"MSV\"\n    };\n  }\n\n  getInterceptTries(effectiveness, flight, target) {\n    const distance = this.getStrikeDistance(flight, target);\n    if (distance > 5) {\n      return [5];\n    }\n\n    return [distance];\n  }\n\n  getStrikeDistance(flight, target) {\n    return this.damageStrategy.getStrikeDistance({\n      target,\n      torpedoFlight: flight\n    });\n  }\n\n  getCargoInfo() {\n    const previousResponse = super.getCargoInfo();\n\n    return [\n      {\n        value: \"A medium range torpedo with Multiple Strike Vehicles.\"\n      },\n      ...previousResponse\n    ];\n  }\n\n  getDisplayName() {\n    return \"Avalanche 0.72m MSV torpedo\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/torpedoMSVsmall.png\";\n  }\n}\n\nexport default Torpedo72MSV;\n","import Torpedo72 from \"./Torpedo72.mjs\";\nimport HETorpedoDamageStrategy from \"./torpedoDamageStrategy/HETorpedoDamageStrategy.mjs\";\n\nclass Torpedo72HE extends Torpedo72 {\n  constructor() {\n    super({ deltaVelocityPerTurn: 42, turnsToLive: 4 });\n\n    this.damageStrategy = new HETorpedoDamageStrategy(\"d8+4\", 0, \"d3+3\");\n  }\n\n  getStrikeDistance(flight, target) {\n    return this.damageStrategy.getStrikeDistance({\n      target,\n      torpedoFlight: flight\n    });\n  }\n\n  getCargoInfo() {\n    const previousResponse = super.getCargoInfo();\n\n    return [\n      {\n        value: \"A medium range torpedo with high explosive warhead.\"\n      },\n      ...previousResponse\n    ];\n  }\n\n  getDisplayName() {\n    return \"Pike 0.72m HE torpedo\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/torpedoHEsmall.png\";\n  }\n}\n\nexport default Torpedo72HE;\n","import HETorpedoDamageStrategy from \"./torpedoDamageStrategy/HETorpedoDamageStrategy.mjs\";\r\nimport Torpedo158 from \"./Torpedo158.mjs\";\r\n\r\nclass Torpedo158HE extends Torpedo158 {\r\n  constructor() {\r\n    super({ deltaVelocityPerTurn: 52, turnsToLive: 6 });\r\n\r\n    this.damageStrategy = new HETorpedoDamageStrategy(\"d10+4\", 0, \"d8+6\");\r\n  }\r\n\r\n  getStrikeDistance(flight, target) {\r\n    return this.damageStrategy.getStrikeDistance({\r\n      target,\r\n      torpedoFlight: flight\r\n    });\r\n  }\r\n\r\n  getCargoInfo() {\r\n    const previousResponse = super.getCargoInfo();\r\n\r\n    return [\r\n      {\r\n        value: \"A long range torpedo with high explosive warhead.\"\r\n      },\r\n      ...previousResponse\r\n    ];\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Meteor 1.53m HE torpedo\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/torpedoHE.png\";\r\n  }\r\n}\r\n\r\nexport default Torpedo158HE;\r\n","import CargoEntity from \"../../cargo/CargoEntity.mjs\";\r\n\r\nclass Ammo extends CargoEntity {\r\n  constructor(damageFormula, armorPiercingFormula) {\r\n    super();\r\n    this.damageFormula = damageFormula;\r\n    this.armorPiercingFormula = armorPiercingFormula;\r\n  }\r\n\r\n  getDamage(diceRoller) {\r\n    if (Number.isInteger(this.damageFormula)) {\r\n      return this.armorPiercingFormula;\r\n    }\r\n\r\n    return diceRoller.roll(this.damageFormula).total;\r\n  }\r\n\r\n  getArmorPiercing(diceRoller) {\r\n    if (Number.isInteger(this.armorPiercingFormula)) {\r\n      return this.armorPiercingFormula;\r\n    }\r\n\r\n    return diceRoller.roll(this.armorPiercingFormula).total;\r\n  }\r\n\r\n  getCargoInfo() {\r\n    const previousResponse = super.getCargoInfo();\r\n\r\n    return [\r\n      {\r\n        header: \"Damage\",\r\n        value: this.damageFormula\r\n      },\r\n      {\r\n        header: \"Armor piercing\",\r\n        value: this.armorPiercingFormula\r\n      },\r\n      ...previousResponse\r\n    ];\r\n  }\r\n\r\n  getIconText() {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport default Ammo;\r\n","import Ammo from \"../Ammo.mjs\";\r\n\r\nclass Ammo30mm extends Ammo {\r\n  constructor() {\r\n    super(\"d2\", \"d3+2\");\r\n  }\r\n\r\n  getSpaceRequired() {\r\n    return 0.01;\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"30mm PDC shell\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"30mm\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/ammo/30mm.png\";\r\n  }\r\n}\r\n\r\nexport default Ammo30mm;\r\n","import Ammo from \"../Ammo.mjs\";\r\n\r\nclass Ammo85mmHE extends Ammo {\r\n  constructor() {\r\n    super(\"2d4+2\", 0);\r\n  }\r\n\r\n  getSpaceRequired() {\r\n    return 0.02;\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"85mm high explosive shell\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"85mm HE\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/ammo/85mmHE.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"HE\";\r\n  }\r\n}\r\n\r\nexport default Ammo85mmHE;\r\n","import Ammo from \"../Ammo.mjs\";\r\n\r\nclass Ammo85mmAP extends Ammo {\r\n  constructor() {\r\n    super(\"d3\", \"2d3+2\");\r\n  }\r\n\r\n  getSpaceRequired() {\r\n    return 0.02;\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"85mm armor piercing shell\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"85mm AP\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/ammo/85mmAP.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"AP\";\r\n  }\r\n}\r\n\r\nexport default Ammo85mmAP;\r\n","import Ammo from \"../Ammo.mjs\";\r\n\r\nclass Ammo140mmAP extends Ammo {\r\n  constructor() {\r\n    super(\"2d3+6\", 12);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"140mm armor piercing railgun projectile\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"140mm AP\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/ammo/140mmAP.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"AP\";\r\n  }\r\n}\r\n\r\nexport default Ammo140mmAP;\r\n","import Ammo from \"../Ammo.mjs\";\r\n\r\nclass Ammo140mmHE extends Ammo {\r\n  constructor() {\r\n    super(\"2d5 + 10\", 0);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"140mm high explosive railgun projectile\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"140mm HE\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/ammo/140mmHE.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"HE\";\r\n  }\r\n}\r\n\r\nexport default Ammo140mmHE;\r\n","import Ammo from \"../Ammo.mjs\";\r\n\r\nclass Ammo120mmAP extends Ammo {\r\n  constructor() {\r\n    super(\"2d3+5\", 10);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"120mm armor piercing railgun projectile\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"120mm AP\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/ammo/120mmAP.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"AP\";\r\n  }\r\n}\r\n\r\nexport default Ammo120mmAP;\r\n","import Ammo from \"../Ammo.mjs\";\r\n\r\nclass Ammo120mmHE extends Ammo {\r\n  constructor() {\r\n    super(\"2d4 + 10\", 0);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"120mm high explosive railgun projectile\";\r\n  }\r\n\r\n  getShortDisplayName() {\r\n    return \"120mm HE\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/ammo/120mmHE.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"HE\";\r\n  }\r\n}\r\n\r\nexport default Ammo120mmHE;\r\n","import CargoEntity from \"../../cargo/CargoEntity.mjs\";\r\n\r\nclass NoAmmunitionLoaded extends CargoEntity {\r\n  getDisplayName() {\r\n    return \"NO AMMUNITION LOADED\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/noAmmo.png\";\r\n  }\r\n}\r\n\r\nexport default NoAmmunitionLoaded;\r\n","import * as torpedoes from \"./torpedo/index.mjs\";\r\nimport * as conventional from \"./conventional/index.mjs\";\r\nimport NoAmmunitionLoaded from \"./NoAmmunitionLoaded.mjs\";\r\n\r\nexport const ammunition = {\r\n  ...torpedoes,\r\n  ...conventional,\r\n  NoAmmunitionLoaded\r\n};\r\n","import { ammunition } from \"../weapon/ammunition/index.mjs\";\r\n\r\nexport const cargoClasses = { ...ammunition };\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\nimport { cargoClasses } from \"../cargo/cargo.mjs\";\r\n\r\nclass CargoBaySystemStrategy extends ShipSystemStrategy {\r\n  constructor(space) {\r\n    super();\r\n    this.space = space;\r\n    this.cargo = [];\r\n  }\r\n\r\n  getUiComponents(payload, previousResponse = []) {\r\n    return [\r\n      ...previousResponse,\r\n      {\r\n        name: \"CargoList\",\r\n        props: {\r\n          list: this.cargo.map(cargo => ({\r\n            object: cargo.object,\r\n            amount: cargo.amount\r\n          }))\r\n        }\r\n      }\r\n    ];\r\n  }\r\n\r\n  serialize(payload, previousResponse = []) {\r\n    return {\r\n      ...previousResponse,\r\n      cargoBaySystemStrategy: this.cargo.map(cargo => ({\r\n        className: cargo.object.constructor.name,\r\n        amount: cargo.amount\r\n      }))\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.cargo = data.cargoBaySystemStrategy\r\n      ? data.cargoBaySystemStrategy.map(data => ({\r\n          object: new cargoClasses[data.className](),\r\n          amount: data.amount\r\n        }))\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n\r\n  getTotalCargoSpace() {\r\n    return this.space;\r\n  }\r\n\r\n  getAvailableCargoSpace() {\r\n    return this.space - this.getCargoSpaceUsed();\r\n  }\r\n\r\n  getCargoSpaceUsed() {\r\n    return this.cargo.reduce(\r\n      (total, { object, amount }) => total + object.getSpaceRequired() * amount,\r\n      0\r\n    );\r\n  }\r\n\r\n  hasSpaceFor({ object, amount }) {\r\n    return this.getAvailableCargoSpace() >= object.getSpaceRequired() * amount;\r\n  }\r\n\r\n  getCargoEntry(object) {\r\n    return this.cargo.find(\r\n      stored => stored.object.constructor === object.constructor\r\n    );\r\n  }\r\n\r\n  getCargoByParentClass(parentClass) {\r\n    return this.cargo.filter(cargo => cargo.object instanceof parentClass);\r\n  }\r\n\r\n  hasCargo({ object, amount = 1 }) {\r\n    const entry = this.getCargoEntry(object);\r\n\r\n    if (!entry) {\r\n      return false;\r\n    }\r\n\r\n    return entry.amount >= amount;\r\n  }\r\n\r\n  removeCargo({ object, amount = 1 }) {\r\n    const entry = this.getCargoEntry(object);\r\n\r\n    if (!entry || entry.amount < amount) {\r\n      throw new Error(\"Check hasCargo first!\");\r\n    }\r\n\r\n    entry.amount -= amount;\r\n\r\n    this.cargo = this.cargo.filter(entry => entry.amount > 0);\r\n  }\r\n\r\n  addCargo({ object, amount = 1 }) {\r\n    if (!this.hasSpaceFor({ object, amount })) {\r\n      throw new Error(\"No space in cargo bay\");\r\n    }\r\n\r\n    let entry = this.getCargoEntry(object);\r\n\r\n    if (entry) {\r\n      entry.amount += amount;\r\n    } else {\r\n      entry = {\r\n        object: new cargoClasses[object.constructor.name](),\r\n        amount\r\n      };\r\n\r\n      this.cargo.push(entry);\r\n    }\r\n  }\r\n}\r\n\r\nexport default CargoBaySystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass StoreHeatStrategy extends ShipSystemStrategy {\r\n  constructor(heatCapacity) {\r\n    super();\r\n    this.heatCapacity = heatCapacity;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Stores heat without overheating\",\r\n      value: `${this.heatCapacity}`\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  canStoreHeat() {\r\n    if (this.system.isDisabled()) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  getHeatStoreAmount(payload, previousResponse) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return previousResponse + this.heatCapacity;\r\n  }\r\n}\r\n\r\nexport default StoreHeatStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass RadiateHeatStrategy extends ShipSystemStrategy {\r\n  constructor(radiationCapacity) {\r\n    super();\r\n    this.radiationCapacity = radiationCapacity;\r\n\r\n    this.heatRadiated = 0;\r\n  }\r\n\r\n  isRadiator() {\r\n    return true;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Radiates heat\",\r\n      value: `${this.radiationCapacity}`\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  getRadiatedHeat(payload, previousResponse = 0) {\r\n    return this.heatRadiated + previousResponse;\r\n  }\r\n\r\n  getHeatRadiationCapacity(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    const undamaged = this.system.damage.getPercentUnDamaged();\r\n    let capacity =\r\n      Math.floor(this.radiationCapacity * undamaged) - this.heatRadiated;\r\n\r\n    if (capacity < 0) {\r\n      capacity = 0;\r\n    }\r\n\r\n    return previousResponse + capacity;\r\n  }\r\n\r\n  radiateHeat(heat, previousResponse = 0) {\r\n    let heatLeft = heat - previousResponse;\r\n    if (heatLeft <= 0) {\r\n      return previousResponse;\r\n    }\r\n\r\n    const capacity = this.getHeatRadiationCapacity();\r\n    if (capacity < heatLeft) {\r\n      heatLeft = capacity;\r\n    }\r\n\r\n    this.heatRadiated += heatLeft;\r\n\r\n    return previousResponse + heatLeft;\r\n  }\r\n}\r\n\r\nexport default RadiateHeatStrategy;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport CargoBaySystemStrategy from \"../strategy/CargoBaySystemStrategy.mjs\";\r\nimport StoreHeatStrategy from \"../strategy/StoreHeatStrategy.mjs\";\r\nimport RadiateHeatStrategy from \"../strategy/RadiateHeatStrategy.mjs\";\r\n\r\nclass Structure extends ShipSystem {\r\n  constructor({ cargoSpace = 0, heatStorage = 0, radiator = 0, ...args }) {\r\n    super(args);\r\n\r\n    if (cargoSpace) {\r\n      this.addStrategy(new CargoBaySystemStrategy(cargoSpace));\r\n    }\r\n\r\n    if (heatStorage) {\r\n      this.addStrategy(new StoreHeatStrategy(heatStorage));\r\n    }\r\n\r\n    if (radiator) {\r\n      this.addStrategy(new RadiateHeatStrategy(radiator));\r\n    }\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Structure\";\r\n  }\r\n}\r\n\r\nexport default Structure;\r\n","import Structure from \"../structure/Structure.mjs\";\r\nimport hexagon from \"../../../hexagon/index.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass SystemSection {\r\n  constructor(location) {\r\n    this.location = location;\r\n    this.systems = [];\r\n  }\r\n\r\n  getOffsetHex() {\r\n    switch (this.location) {\r\n      case systemLocation.SYSTEM_LOCATION_PRIMARY:\r\n        return new hexagon.Offset(0, 0);\r\n      case systemLocation.SYSTEM_LOCATION_FRONT:\r\n        return new hexagon.Offset(1, 0);\r\n      case systemLocation.SYSTEM_LOCATION_AFT:\r\n        return new hexagon.Offset(-1, 0);\r\n      case systemLocation.SYSTEM_LOCATION_PORT_FRONT:\r\n        return new hexagon.Offset(1, 1);\r\n      case systemLocation.SYSTEM_LOCATION_PORT_AFT:\r\n        return new hexagon.Offset(0, 1);\r\n      case systemLocation.SYSTEM_LOCATION_STARBOARD_FRONT:\r\n        return new hexagon.Offset(1, -1);\r\n      case systemLocation.SYSTEM_LOCATION_STARBOARD_AFT:\r\n        return new hexagon.Offset(0, -1);\r\n    }\r\n  }\r\n\r\n  hasUndestroyedStructure() {\r\n    return this.systems.some(\r\n      system => system instanceof Structure && !system.isDisabled()\r\n    );\r\n  }\r\n\r\n  addSystem(system) {\r\n    this.systems.push(system);\r\n    return this;\r\n  }\r\n\r\n  getSystems() {\r\n    return this.systems;\r\n  }\r\n\r\n  isLocation(location) {\r\n    return this.location === location;\r\n  }\r\n\r\n  hasSystems() {\r\n    return this.systems.length > 0;\r\n  }\r\n\r\n  getStructure() {\r\n    return this.systems.find(system => system instanceof Structure);\r\n  }\r\n\r\n  getNonStructureSystems() {\r\n    return this.systems.filter(system => !(system instanceof Structure));\r\n  }\r\n}\r\n\r\nexport default SystemSection;\r\n","export const SYSTEM_LOCATION_PRIMARY = 0;\r\nexport const SYSTEM_LOCATION_FRONT = 1;\r\nexport const SYSTEM_LOCATION_AFT = 2;\r\nexport const SYSTEM_LOCATION_PORT_FRONT = 31;\r\nexport const SYSTEM_LOCATION_PORT_AFT = 32;\r\nexport const SYSTEM_LOCATION_STARBOARD_FRONT = 41;\r\nexport const SYSTEM_LOCATION_STARBOARD_AFT = 42;\r\n","import SystemSection from \"./SystemSection.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass PrimarySection extends SystemSection {\r\n  constructor() {\r\n    super(systemLocation.SYSTEM_LOCATION_PRIMARY);\r\n  }\r\n}\r\n\r\nexport default PrimarySection;\r\n","import SystemSection from \"./SystemSection.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass AftSection extends SystemSection {\r\n  constructor() {\r\n    super(systemLocation.SYSTEM_LOCATION_AFT);\r\n  }\r\n}\r\n\r\nexport default AftSection;\r\n","import SystemSection from \"./SystemSection.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass FrontSection extends SystemSection {\r\n  constructor() {\r\n    super(systemLocation.SYSTEM_LOCATION_FRONT);\r\n  }\r\n}\r\n\r\nexport default FrontSection;\r\n","import SystemSection from \"./SystemSection.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass PortAftSection extends SystemSection {\r\n  constructor() {\r\n    super(systemLocation.SYSTEM_LOCATION_PORT_AFT);\r\n  }\r\n}\r\n\r\nexport default PortAftSection;\r\n","import SystemSection from \"./SystemSection.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass PortFrontSection extends SystemSection {\r\n  constructor() {\r\n    super(systemLocation.SYSTEM_LOCATION_PORT_FRONT);\r\n  }\r\n}\r\n\r\nexport default PortFrontSection;\r\n","import SystemSection from \"./SystemSection.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass StarboardFrontSection extends SystemSection {\r\n  constructor() {\r\n    super(systemLocation.SYSTEM_LOCATION_STARBOARD_FRONT);\r\n  }\r\n}\r\n\r\nexport default StarboardFrontSection;\r\n","import SystemSection from \"./SystemSection.mjs\";\r\nimport * as systemLocation from \"./systemLocation.mjs\";\r\n\r\nclass StarboardAftSection extends SystemSection {\r\n  constructor() {\r\n    super(systemLocation.SYSTEM_LOCATION_STARBOARD_AFT);\r\n  }\r\n}\r\n\r\nexport default StarboardAftSection;\r\n","import {\r\n  PrimarySection,\r\n  FrontSection,\r\n  AftSection,\r\n  PortFrontSection,\r\n  PortAftSection,\r\n  StarboardFrontSection,\r\n  StarboardAftSection\r\n} from \"./systemSection/index.mjs\";\r\nimport { getCompassHeadingOfPoint, addToDirection } from \"../../utils/math.mjs\";\r\n\r\nclass ShipSystemSections {\r\n  constructor(ship) {\r\n    this.ship = ship;\r\n\r\n    this.sections = [\r\n      new PrimarySection(),\r\n      new FrontSection(),\r\n      new AftSection(),\r\n      new PortFrontSection(),\r\n      new PortAftSection(),\r\n      new StarboardFrontSection(),\r\n      new StarboardAftSection()\r\n    ];\r\n  }\r\n\r\n  getHitSectionHeading(shooterPosition, shipPosition, shipFacing) {\r\n    const heading = addToDirection(\r\n      getCompassHeadingOfPoint(shipPosition, shooterPosition),\r\n      -shipFacing\r\n    );\r\n\r\n    if (this.ship.movement.isRolled()) {\r\n      return addToDirection(0, -heading);\r\n    }\r\n\r\n    return heading;\r\n  }\r\n\r\n  getNextSectionForHit(heading, lastSection) {\r\n    return this.sections.find(section => {\r\n      const location = section.getOffsetHex();\r\n      const intervening = location.getNeighbourAtHeading(heading);\r\n\r\n      return lastSection.getOffsetHex().equals(intervening);\r\n    });\r\n  }\r\n\r\n  getSectionsThatCanBeHit(heading) {\r\n    return this.sections.filter(section => {\r\n      const location = section.getOffsetHex();\r\n      const intervening = location.getNeighbourAtHeading(heading);\r\n\r\n      return this.sections.every(blockingSection => {\r\n        if (!blockingSection.getOffsetHex().equals(intervening)) {\r\n          return true;\r\n        } else if (!blockingSection.hasUndestroyedStructure()) {\r\n          return true;\r\n        } else if (blockingSection === section) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  getHitSections(shooterPosition, shipPosition, shipFacing, lastSection) {\r\n    const heading = this.getHitSectionHeading(\r\n      shooterPosition,\r\n      shipPosition,\r\n      shipFacing\r\n    );\r\n\r\n    if (!lastSection) {\r\n      return this.getSectionsThatCanBeHit(heading);\r\n    }\r\n\r\n    let result = [];\r\n\r\n    while (true) {\r\n      const newSection = this.getNextSectionForHit(heading, lastSection);\r\n\r\n      if (!newSection) {\r\n        return result;\r\n      }\r\n\r\n      result = result.concat(newSection);\r\n\r\n      if (newSection.hasUndestroyedStructure()) {\r\n        return result;\r\n      }\r\n\r\n      lastSection = newSection;\r\n    }\r\n  }\r\n\r\n  getPrimarySection() {\r\n    return this.getSection(PrimarySection);\r\n  }\r\n\r\n  getFrontSection() {\r\n    return this.getSection(FrontSection);\r\n  }\r\n\r\n  getAftSection() {\r\n    return this.getSection(AftSection);\r\n  }\r\n\r\n  getStarboardFrontSection() {\r\n    return this.getSection(StarboardFrontSection);\r\n  }\r\n\r\n  getStarboardAftSection() {\r\n    return this.getSection(StarboardAftSection);\r\n  }\r\n\r\n  getPortFrontSection() {\r\n    return this.getSection(PortFrontSection);\r\n  }\r\n\r\n  getPortAftSection() {\r\n    return this.getSection(PortAftSection);\r\n  }\r\n\r\n  getSection(location) {\r\n    return this.sections.find(section => section instanceof location);\r\n  }\r\n\r\n  getSectionBySystem(system) {\r\n    return this.sections.find(section =>\r\n      section.systems.find(otherSystem => system.id === otherSystem.id)\r\n    );\r\n  }\r\n}\r\n\r\nexport default ShipSystemSections;\r\n","import ShipPower from \"./ShipPower.mjs\";\nimport ShipSystemSections from \"./system/ShipSystemSections.mjs\";\nimport { hexFacingToAngle } from \"../utils/math.mjs\";\n\nclass ShipSystems {\n  constructor(ship) {\n    this.ship = ship;\n    this.systems = {};\n    this.systemsAsArray = [];\n\n    this.sections = new ShipSystemSections(ship);\n    this.power = new ShipPower(this);\n  }\n\n  markDestroyedThisTurn() {\n    this.ship.markDestroyedThisTurn();\n  }\n\n  isDestroyed() {\n    const structuresDestroyed = this.sections.sections.reduce(\n      (total, section) => {\n        const structure = section.getStructure();\n\n        if (structure && structure.isDestroyed()) {\n          return total + 1;\n        }\n\n        return total;\n      },\n      0\n    );\n\n    const structures = this.sections.sections.reduce((total, section) => {\n      if (section.getStructure()) {\n        return total + 1;\n      }\n\n      return total;\n    }, 0);\n\n    const primaryStructure = this.sections.getPrimarySection().getStructure();\n\n    return (\n      (!primaryStructure || primaryStructure.isDestroyed()) &&\n      structuresDestroyed > structures / 2\n    );\n  }\n\n  getSectionsForHit(attackPosition, lastSection) {\n    return this.sections.getHitSections(\n      attackPosition,\n      this.ship.getPosition(),\n      hexFacingToAngle(this.ship.getFacing()),\n      lastSection\n    );\n  }\n\n  getSystemsForHit(attackPosition, lastSection) {\n    const systems = this.getSectionsForHit(attackPosition, lastSection).reduce(\n      (all, section) => {\n        return [\n          ...all,\n          ...section.getSystems().filter(system => !system.isDestroyed())\n        ];\n      },\n      []\n    );\n\n    return [\n      ...systems,\n      ...this.getSystems().filter(system =>\n        system.callHandler(\"canBeTargeted\", null, false)\n      )\n    ];\n  }\n\n  addSystem(system, section) {\n    if (this.getSystemById(system.id)) {\n      throw new Error(\"System with duplicate id! \" + system.id);\n    }\n\n    if (!system.id) {\n      throw new Error(\"System with falsy id!\");\n    }\n\n    this.systems[system.id] = system;\n    this.systemsAsArray.push(system);\n    section.addSystem(system);\n    system.addShipSystemsReference(this);\n\n    return this;\n  }\n\n  addPrimarySystem(systems) {\n    systems = [].concat(systems);\n    systems.forEach(system =>\n      this.addSystem(system, this.sections.getPrimarySection())\n    );\n\n    return this;\n  }\n\n  addFrontSystem(systems) {\n    systems = [].concat(systems);\n    systems.forEach(system =>\n      this.addSystem(system, this.sections.getFrontSection())\n    );\n\n    return this;\n  }\n\n  addAftSystem(systems) {\n    systems = [].concat(systems);\n    systems.forEach(system =>\n      this.addSystem(system, this.sections.getAftSection())\n    );\n\n    return this;\n  }\n\n  addStarboardFrontSystem(systems) {\n    systems = [].concat(systems);\n    systems.forEach(system =>\n      this.addSystem(system, this.sections.getStarboardFrontSection())\n    );\n\n    return this;\n  }\n\n  addStarboardAftSystem(systems) {\n    systems = [].concat(systems);\n    systems.forEach(system =>\n      this.addSystem(system, this.sections.getStarboardAftSection())\n    );\n\n    return this;\n  }\n\n  addPortFrontSystem(systems) {\n    systems = [].concat(systems);\n    systems.forEach(system =>\n      this.addSystem(system, this.sections.getPortFrontSection())\n    );\n\n    return this;\n  }\n\n  addPortAftSystem(systems) {\n    systems = [].concat(systems);\n    systems.forEach(system =>\n      this.addSystem(system, this.sections.getPortAftSection())\n    );\n\n    return this;\n  }\n\n  getSystemById(id) {\n    return this.systems[id];\n  }\n\n  getSystems() {\n    return this.systemsAsArray;\n  }\n\n  deserialize(data = []) {\n    data.forEach(systemData => {\n      const system = this.getSystemById(systemData.systemId);\n      if (system) {\n        system.deserialize(systemData.data);\n      }\n    });\n\n    return this;\n  }\n\n  serialize() {\n    return this.systemsAsArray.map(system => ({\n      systemId: system.id,\n      data: system.serialize()\n    }));\n  }\n\n  endTurn(turn) {\n    this.getSystems().forEach(system => {\n      system.endTurn(turn);\n    });\n  }\n\n  advanceTurn(turn) {\n    this.getSystems().forEach(system => {\n      system.advanceTurn(turn);\n    });\n\n    this.power.advanceTurn(turn);\n    return this;\n  }\n\n  receivePlayerData(clientShip) {\n    this.getSystems().forEach(system =>\n      system.callHandler(\"receivePlayerData\", {\n        clientShip,\n        clientSystem: clientShip.systems.getSystemById(system.id)\n      })\n    );\n  }\n\n  censorForUser(user, mine) {\n    this.getSystems().forEach(system => {\n      system.callHandler(\"censorForUser\", { user, mine });\n    });\n  }\n\n  callAllSystemHandlers(name, payload) {\n    return this.getSystems()\n      .reduce(\n        (total, system) => [\n          ...total,\n          ...[].concat(system.callHandler(name, payload))\n        ],\n        []\n      )\n      .filter(Boolean);\n  }\n\n  getTotalHeat() {\n    return this.getSystems().reduce(\n      (total, system) => total + system.heat.getHeat(),\n      0\n    );\n  }\n\n  getTotalHeatStorage() {\n    return this.getSystems().reduce(\n      (total, system) => total + system.heat.getMaxHeatStoreCapacity(),\n      0\n    );\n  }\n\n  getTotalHeatStored() {\n    return this.getSystems()\n      .filter(system => system.heat.isHeatStorage())\n      .reduce((total, system) => total + system.heat.getHeat(), 0);\n  }\n\n  getPassiveHeatChange() {\n    const producedAndTransferred = this.getSystems().reduce((total, system) => {\n      const heatGenerated = system.heat.getHeatGenerated();\n      const heatTransfer = system.heat.getMaxTransferHeat();\n\n      if (heatGenerated > heatTransfer) {\n        return total + heatTransfer;\n      }\n\n      return total + heatGenerated;\n    }, 0);\n\n    const heatRadiated = this.getSystems().reduce(\n      (total, system) => total + system.heat.getRadiateHeatCapacity(),\n      0\n    );\n\n    return producedAndTransferred - heatRadiated;\n  }\n}\n\nexport default ShipSystems;\n","import * as ewTypes from \"./electronicWarfareTypes.mjs\";\r\n\r\nclass ElectronicWarfareEntry {\r\n  constructor(type, targetShipId, amount) {\r\n    this.deserialize({\r\n      type,\r\n      targetShipId,\r\n      amount\r\n    });\r\n  }\r\n\r\n  clone() {\r\n    return new ElectronicWarfareEntry(\r\n      this.type,\r\n      this.targetShipId,\r\n      this.amount\r\n    );\r\n  }\r\n\r\n  addAmount(amount) {\r\n    this.amount += amount;\r\n  }\r\n\r\n  getAmount() {\r\n    return this.amount;\r\n  }\r\n\r\n  getType() {\r\n    return this.type;\r\n  }\r\n\r\n  getActualPower() {\r\n    switch (this.type) {\r\n      case ewTypes.EW_OFFENSIVE:\r\n      case ewTypes.EW_DEFENSIVE:\r\n      case ewTypes.EW_CC:\r\n      case ewTypes.EW_OFFENSIVE_SUPPORT:\r\n      case ewTypes.EW_DEFENSIVE_SUPPORT:\r\n        return this.amount;\r\n      case ewTypes.EW_DISRUPTION:\r\n        return this.amount / 3;\r\n      case ewTypes.EW_AREA_DEFENSIVE_SUPPORT:\r\n        return this.amount / 2.5;\r\n    }\r\n  }\r\n\r\n  getEfficiency() {\r\n    switch (this.type) {\r\n      case ewTypes.EW_OFFENSIVE:\r\n      case ewTypes.EW_DEFENSIVE:\r\n      case ewTypes.EW_CC:\r\n      case ewTypes.EW_OFFENSIVE_SUPPORT:\r\n      case ewTypes.EW_DEFENSIVE_SUPPORT:\r\n        return 1;\r\n      case ewTypes.EW_DISRUPTION:\r\n        return 3;\r\n      case ewTypes.EW_AREA_DEFENSIVE_SUPPORT:\r\n        return 2.5;\r\n    }\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      type: this.type,\r\n      targetShipId: this.targetShipId,\r\n      amount: this.amount\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.type = data.type;\r\n    this.targetShipId = data.targetShipId;\r\n    this.amount = data.amount;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default ElectronicWarfareEntry;\r\n","export const EW_OFFENSIVE = \"oew\";\r\nexport const EW_DEFENSIVE = \"dew\";\r\nexport const EW_CC = \"ccew\";\r\nexport const EW_OFFENSIVE_SUPPORT = \"soew\";\r\nexport const EW_DEFENSIVE_SUPPORT = \"sdew\";\r\nexport const EW_DISRUPTION = \"disew\";\r\nexport const EW_AREA_DEFENSIVE_SUPPORT = \"adew\";\r\n","import * as ewTypes from \"../electronicWarfare/electronicWarfareTypes.mjs\";\r\nimport ElectornicWarfareEntry from \"../electronicWarfare/ElectronicWarfareEntry.mjs\";\r\nimport Ship from \"./Ship.mjs\";\r\n\r\nclass ShipCurrentElectronicWarfare {\r\n  constructor(dew, ccew, entries) {\r\n    this.dew = dew;\r\n    this.ccew = ccew;\r\n    this.entries = entries ? entries.map(entry => entry.clone()) : [];\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      dew: this.dew,\r\n      ccew: this.ccew,\r\n      entries: this.entries.map(entry => entry.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.dew = data.dew || 0;\r\n    this.ccew = data.ccew || 0;\r\n    this.entries = data.entries\r\n      ? data.entries.map(entry =>\r\n          new ElectornicWarfareEntry().deserialize(entry)\r\n        )\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n\r\n  getDefensiveEw() {\r\n    return this.dew;\r\n  }\r\n\r\n  getCcEw() {\r\n    return this.ccew;\r\n  }\r\n\r\n  getOffensiveEw(target) {\r\n    return this.getFromEntries(ewTypes.EW_OFFENSIVE, target);\r\n  }\r\n\r\n  getAllOew() {\r\n    const combined = [];\r\n\r\n    this.entries\r\n      .filter(entry => entry.getType() === ewTypes.EW_OFFENSIVE)\r\n      .forEach(entry => {\r\n        const existing = combined.find(\r\n          combinedEntry => combinedEntry.targetShipId === entry.targetShipId\r\n        );\r\n\r\n        if (existing) {\r\n          existing.amount += entry.amount;\r\n        } else {\r\n          combined.push(entry.clone());\r\n        }\r\n      });\r\n\r\n    return combined;\r\n  }\r\n\r\n  getFromEntries(type, target) {\r\n    if (target instanceof Ship) {\r\n      target = target.id;\r\n    }\r\n\r\n    return this.entries\r\n      .filter(entry => entry.type === type && entry.targetShipId === target)\r\n      .reduce((total, entry) => total + entry.getAmount(), 0);\r\n  }\r\n}\r\n\r\nexport default ShipCurrentElectronicWarfare;\r\n","import * as ewTypes from \"../electronicWarfare/electronicWarfareTypes.mjs\";\r\nimport ElectronicWarfareEntry from \"../electronicWarfare/ElectronicWarfareEntry.mjs\";\r\nimport Ship from \"../unit/Ship.mjs\";\r\nimport ShipCurrentElectronicWarfare from \"./ShipCurrentElectronicWarfare.mjs\";\r\n\r\nexport class UnableToAssignEw extends Error {}\r\n\r\nclass ShipElectronicWarfare {\r\n  constructor(ship) {\r\n    this.ship = ship;\r\n    this.inEffect = new ShipCurrentElectronicWarfare();\r\n  }\r\n\r\n  serialize() {\r\n    return this.inEffect.serialize();\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.inEffect.deserialize(data);\r\n\r\n    return this;\r\n  }\r\n\r\n  activatePlannedElectronicWarfare() {\r\n    this.inEffect = new ShipCurrentElectronicWarfare(\r\n      this.getDefensiveEw(),\r\n      this.getCcEw(),\r\n      this.getAllEntries()\r\n    );\r\n  }\r\n\r\n  canAssignCcEw(amount) {\r\n    return this.canAssignEw(ewTypes.EW_CC, this.ship.id, amount);\r\n  }\r\n\r\n  assignCcEw(amount) {\r\n    this.assingEw(ewTypes.EW_CC, this.ship.id, amount);\r\n  }\r\n\r\n  assignOffensiveEw(target, amount) {\r\n    this.assingEw(ewTypes.EW_OFFENSIVE, target, amount);\r\n  }\r\n\r\n  canAssignOffensiveEw(target, amount) {\r\n    return this.canAssignEw(ewTypes.EW_OFFENSIVE, target, amount);\r\n  }\r\n\r\n  getCcEw() {\r\n    return this.getEw(ewTypes.EW_CC, this.ship.id);\r\n  }\r\n\r\n  getDefensiveEw() {\r\n    return this.getEw(ewTypes.EW_DEFENSIVE);\r\n  }\r\n\r\n  getOffensiveEw(target) {\r\n    return this.getEw(ewTypes.EW_OFFENSIVE, target);\r\n  }\r\n\r\n  getEw(type, target) {\r\n    if (target && target instanceof Ship) {\r\n      target = target.id;\r\n    }\r\n\r\n    if (type === ewTypes.EW_DEFENSIVE) {\r\n      return this.getEwArrays().reduce(\r\n        (total, system) =>\r\n          total + system.callHandler(\"getTotalEwUsedByType\", type),\r\n        0\r\n      );\r\n    }\r\n\r\n    const result = this.getAllEntries()\r\n      .filter(entry => entry.type === type && entry.targetShipId === target)\r\n      .reduce((total, entry) => total + entry.getAmount(), 0);\r\n\r\n    return result;\r\n  }\r\n\r\n  assingEw(type, target, amount) {\r\n    if (target && target instanceof Ship) {\r\n      target = target.id;\r\n    }\r\n\r\n    const entries = this.getAllEntries();\r\n    entries.push(new ElectronicWarfareEntry(type, target, amount));\r\n\r\n    this.assignEntries(entries);\r\n  }\r\n\r\n  canAssignEw(type, target, amount) {\r\n    const entries = this.getAllEntries();\r\n    try {\r\n      this.assingEw(type, target, amount);\r\n      this.assignEntries(entries);\r\n      return true;\r\n    } catch (e) {\r\n      if (e instanceof UnableToAssignEw) {\r\n        this.assignEntries(entries);\r\n        return false;\r\n      }\r\n\r\n      throw e;\r\n    }\r\n  }\r\n\r\n  getAllOew() {\r\n    const combined = [];\r\n\r\n    this.getEwArrays()\r\n      .reduce(\r\n        (all, system) => [...all, ...system.callHandler(\"getEwEntries\")],\r\n        []\r\n      )\r\n      .filter(entry => entry.getType() === ewTypes.EW_OFFENSIVE)\r\n      .forEach(entry => {\r\n        const existing = combined.find(\r\n          combinedEntry => combinedEntry.targetShipId === entry.targetShipId\r\n        );\r\n\r\n        if (existing) {\r\n          existing.amount += entry.amount;\r\n        } else {\r\n          combined.push(entry.clone());\r\n        }\r\n      });\r\n\r\n    return combined;\r\n  }\r\n\r\n  getAllEntries() {\r\n    return this.getEwArrays().reduce(\r\n      (all, system) => [...all, ...system.callHandler(\"getEwEntries\")],\r\n      []\r\n    );\r\n  }\r\n\r\n  getEwArrays() {\r\n    return this.ship.systems\r\n      .getSystems()\r\n      .filter(system => system.callHandler(\"isEwArray\"));\r\n  }\r\n\r\n  repeatElectonicWarfare() {\r\n    this.assignEntries(this.getAllEntries(), true);\r\n  }\r\n\r\n  removeAll() {\r\n    this.getEwArrays().forEach(system => system.callHandler(\"resetEw\"));\r\n  }\r\n\r\n  assignEntries(entries, allowIncomplete = false) {\r\n    this.removeAll();\r\n    const negativeEntries = entries.filter(entry => entry.getAmount() < 0);\r\n\r\n    entries\r\n      .filter(entry => entry.getAmount() > 0)\r\n      .sort((a, b) => {\r\n        if (\r\n          a.type === ewTypes.EW_OFFENSIVE &&\r\n          b.type !== ewTypes.EW_OFFENSIVE\r\n        ) {\r\n          return 1;\r\n        }\r\n\r\n        if (\r\n          a.type !== ewTypes.EW_OFFENSIVE &&\r\n          b.type === ewTypes.EW_OFFENSIVE\r\n        ) {\r\n          return -1;\r\n        }\r\n\r\n        return 0;\r\n      })\r\n      .map(entry => {\r\n        negativeEntries\r\n          .filter(\r\n            negativeEntry =>\r\n              negativeEntry.type === entry.type &&\r\n              negativeEntry.targetShipId === entry.targetShipId\r\n          )\r\n          .forEach(negativeEntry => {\r\n            if (entry.getAmount() >= Math.abs(negativeEntry.getAmount())) {\r\n              entry.amount += negativeEntry.getAmount();\r\n              negativeEntry.amount = 0;\r\n            } else if (\r\n              Math.abs(negativeEntry.getAmount()) > entry.getAmount()\r\n            ) {\r\n              negativeEntry.amount += entry.getAmount();\r\n              entry.amount = 0;\r\n            }\r\n          });\r\n\r\n        return entry;\r\n      })\r\n      .filter(entry => entry.getAmount() !== 0)\r\n      .forEach(entry => this.assignPositiveEW(entry, allowIncomplete));\r\n\r\n    if (negativeEntries.some(entry => entry.getAmount() !== 0)) {\r\n      throw new UnableToAssignEw(\"Invalid EW, negative entries left\");\r\n    }\r\n  }\r\n\r\n  assignPositiveEW(entry, allowIncomplete) {\r\n    let amount = entry.getAmount();\r\n    while (amount > 0) {\r\n      const availableSystems = this.getAvailableSystemsForEntry(entry);\r\n      if (availableSystems.length === 0) {\r\n        if (allowIncomplete) {\r\n          return;\r\n        } else {\r\n          throw new UnableToAssignEw(\"Invalid EW\");\r\n        }\r\n      }\r\n\r\n      availableSystems.shift().callHandler(\"assignEw\", {\r\n        type: entry.type,\r\n        target: entry.targetShipId,\r\n        amount: 1\r\n      });\r\n      amount--;\r\n    }\r\n  }\r\n\r\n  getAvailableSystemsForEntry(entry) {\r\n    return this.getEwArrays()\r\n      .filter(system =>\r\n        system.callHandler(\"canUseEw\", {\r\n          type: entry.type,\r\n          amount: 1\r\n        })\r\n      )\r\n      .sort((a, b) => {\r\n        const aValidTypes = a.callHandler(\"getValidEwTypes\");\r\n        const bValidTypes = b.callHandler(\"getValidEwTypes\");\r\n\r\n        if (aValidTypes.length > bValidTypes.length) {\r\n          return -1;\r\n        } else if (aValidTypes.length < bValidTypes.length) {\r\n          return 1;\r\n        }\r\n\r\n        return 0;\r\n      });\r\n  }\r\n}\r\n\r\nexport default ShipElectronicWarfare;\r\n","import User from \"../User.mjs\";\r\n\r\nclass ShipPlayer {\r\n  constructor() {\r\n    this.user = null;\r\n  }\r\n\r\n  is(user) {\r\n    return user && this.user.id === user.id;\r\n  }\r\n\r\n  setUser(user) {\r\n    this.user = user;\r\n  }\r\n\r\n  isUsers(user) {\r\n    return user && this.user && this.user.id === user.id;\r\n  }\r\n\r\n  deserialize(user) {\r\n    this.user = user ? new User().deserialize(user) : undefined;\r\n\r\n    return this;\r\n  }\r\n\r\n  serialize() {\r\n    return this.user ? this.user.serialize() : undefined;\r\n  }\r\n}\r\n\r\nexport default ShipPlayer;\r\n","import MovementOrder from \"../movement/MovementOrder.mjs\";\nimport Vector from \"../utils/Vector.mjs\";\nimport ThrustBill from \"../movement/ThrustBill.mjs\";\n\nclass ShipMovement {\n  constructor(ship) {\n    this.ship = ship;\n    this.moves = [];\n  }\n\n  addMovement(move) {\n    this.moves.push(move.clone());\n    this.buildIndex();\n  }\n\n  removeMovement(move) {\n    const toDelete = this.moves.find(other => other.equals(move));\n    this.moves = this.moves.filter(other => other !== toDelete);\n    this.buildIndex();\n  }\n\n  replaceLastMove(move) {\n    this.moves[this.moves.length - 1] = move;\n    this.buildIndex();\n  }\n\n  removeMovementExceptEnd(turn) {\n    this.moves = this.moves.filter(\n      move =>\n        move.turn < turn || move.isEnd() || move.isDeploy() || move.isStart()\n    );\n    this.buildIndex();\n  }\n\n  removeMovementForTurn(turn) {\n    this.moves = this.moves.filter(move => move.turn < turn || move.isStart());\n    this.buildIndex();\n  }\n\n  removeMovementForOtherTurns(turn) {\n    this.moves = this.moves.filter(move => move.turn === turn);\n    this.buildIndex();\n  }\n\n  getMovement() {\n    return this.moves.map(move => move.clone());\n  }\n\n  getPlayerAddedMovement() {\n    return this.moves\n      .filter(move => move.isPlayerAdded())\n      .map(move => move.clone());\n  }\n\n  getLastMove() {\n    if (this.moves.length === 0) {\n      return null;\n    }\n\n    return this.moves[this.moves.length - 1].clone();\n  }\n\n  getStartMove() {\n    const start = this.moves.find(move => move.isStart());\n    if (!start) {\n      return null;\n    }\n\n    return start.clone();\n  }\n\n  getDeployMove() {\n    const deploy = this.moves.find(move => move.isDeploy());\n    if (!deploy) {\n      return null;\n    }\n\n    return deploy.clone();\n  }\n\n  replaceDeployMove(newMove) {\n    this.moves = this.moves.map(move => {\n      if (move.isDeploy()) {\n        return newMove;\n      } else {\n        return move.clone();\n      }\n    });\n  }\n\n  replaceMovement(newMovement) {\n    this.moves = [\n      ...this.moves.filter(move => !move.isPlayerAdded()),\n      ...newMovement.filter(move => move.isPlayerAdded())\n    ];\n\n    this.moves = this.moves.map(move => move.clone());\n    this.buildIndex();\n  }\n\n  buildIndex() {\n    let lastIndex = null;\n\n    this.moves.forEach(move => {\n      if (\n        lastIndex === null &&\n        (move.isEnd() || move.isStart() || move.isDeploy()) &&\n        move.index !== 0\n      ) {\n        lastIndex = move.index;\n      } else if (lastIndex !== null) {\n        lastIndex++;\n        move.index = lastIndex;\n      }\n    });\n\n    this.ship.systems.callAllSystemHandlers(\"resetChanneledThrust\");\n\n    this.moves.forEach(move => {\n      const fulfilments = move.requiredThrust.getFulfilments();\n      fulfilments.forEach(fulfilment => {\n        fulfilment.forEach(({ amount, thrusterId }) => {\n          this.ship.systems\n            .getSystemById(thrusterId)\n            .callHandler(\"addChanneledThrust\", amount);\n        });\n      });\n    });\n  }\n\n  getLastEndMove() {\n    const end = this.moves\n      .slice()\n      .reverse()\n      .find(move => move.isEnd());\n\n    if (!end) {\n      return null;\n    }\n\n    return end.clone();\n  }\n\n  getLastEndMoveOrSurrogate() {\n    const end = this.getLastEndMove();\n    if (!end) {\n      const deploy = this.getDeployMove();\n\n      if (!deploy) {\n        const start = this.getStartMove();\n        return start;\n      }\n\n      return deploy;\n    }\n\n    return end;\n  }\n\n  getEvadeMove() {\n    const move = this.moves.find(move => move.isEvade());\n\n    if (!move) {\n      return null;\n    }\n\n    return move.clone();\n  }\n\n  isRolled() {\n    const end = this.getLastEndMoveOrSurrogate();\n    return end.rolled;\n  }\n\n  isRolling() {\n    return this.getRollMove();\n  }\n\n  getRollMove() {\n    const move = this.moves.find(move => move.isRoll());\n\n    if (!move) {\n      return null;\n    }\n\n    return move.clone();\n  }\n\n  getEvasion() {\n    const move = this.getEvadeMove();\n\n    if (!move) {\n      return 0;\n    }\n\n    return move.value;\n  }\n\n  getThrustOutput() {\n    return this.ship.systems\n      .getSystems()\n      .reduce(\n        (acc, system) => system.callHandler(\"getThrustOutput\", null, acc),\n        0\n      );\n  }\n\n  getThrustRequired() {\n    return this.moves\n      .filter(move => move.requiredThrust)\n      .reduce(\n        (total, move) => total + move.requiredThrust.getTotalAmountRequired(),\n        0\n      );\n  }\n\n  getRemainingThrustOutput() {\n    return this.getThrustOutput() - this.getThrustRequired();\n  }\n\n  getThrusters() {\n    return this.ship.systems\n      .getSystems()\n      .filter(system => system.callHandler(\"isThruster\"))\n      .filter(system => !system.isDisabled());\n  }\n\n  getMaxEvasion() {\n    return this.ship.systems\n      .getSystems()\n      .reduce(\n        (acc, system) => system.callHandler(\"getMaxEvasion\", null, acc),\n        0\n      );\n  }\n\n  isOverlapping(otherShip) {\n    const shipPosition = this.ship.getHexPosition();\n    const shipFacing = this.ship.getFacing();\n    const otherShipPosition = otherShip.getHexPosition();\n    const otherShipFacing = otherShip.getFacing();\n\n    return this.ship.hexSizes.some(hex => {\n      return otherShip.hexSizes.some(otherHex =>\n        shipPosition\n          .add(hex.rotate(shipFacing))\n          .equals(otherShipPosition.add(otherHex.rotate(otherShipFacing)))\n      );\n    });\n  }\n\n  hasValidMovement() {\n    const bill = new ThrustBill(\n      this.ship,\n      this.getThrustOutput(),\n      this.getMovement()\n    );\n\n    const result = bill.pay();\n    return result;\n  }\n\n  revertMovementsUntilValidMovement() {\n    const canRevert = () =>\n      this.getMovement().some(move => move.isPlayerAdded());\n\n    while (true) {\n      if (this.hasValidMovement()) {\n        return;\n      }\n\n      if (!canRevert()) {\n        throw new Error(\n          \"Ship does not have valid movement, but can not revert either\"\n        );\n      }\n\n      this.removeMovement(\n        this.getMovement()\n          .filter(move => move.isCancellable())\n          .pop()\n      );\n    }\n  }\n\n  applyRoll() {\n    const endMove = this.getLastEndMove();\n    const rollMove = this.getRollMove();\n    if (rollMove) {\n      endMove.rolled = !endMove.rolled;\n    }\n\n    this.replaceLastMove(endMove);\n  }\n\n  deserialize(data = []) {\n    this.moves = data.map(moveData =>\n      new MovementOrder().deserialize(moveData)\n    );\n\n    return this;\n  }\n\n  serialize() {\n    return this.moves.map(move => move.serialize());\n  }\n}\n\nexport default ShipMovement;\n","import ShipSystems from \"./ShipSystems.mjs\";\nimport ShipElectronicWarfare from \"./ShipElectronicWarfare.mjs\";\nimport ShipPlayer from \"./ShipPlayer.mjs\";\nimport ShipMovement from \"./ShipMovement.mjs\";\nimport {\n  getCompassHeadingOfPoint,\n  addToDirection,\n  hexFacingToAngle\n} from \"../utils/math.mjs\";\nimport HexagonMath from \"../utils/HexagonMath.mjs\";\nimport Offset from \"../hexagon/Offset.mjs\";\nimport coordinateConverter from \"../utils/CoordinateConverter.mjs\";\n\nclass Ship {\n  constructor(data = {}) {\n    this.systems = new ShipSystems(this);\n    this.pointCost = 0;\n    this.accelcost = 1;\n    this.rollcost = 1;\n    this.pivotcost = 1;\n    this.maxPivots = null;\n    this.evasioncost = 1;\n    this.frontHitProfile = 30;\n    this.sideHitProfile = 50;\n    this.hexSizes = [];\n\n    this.shipModel = null;\n    this.shipTypeName = \"\";\n    this.setShipProperties();\n    this.deserialize(data);\n  }\n\n  setShipProperties() {}\n\n  getFrontHitProfile() {\n    return (\n      this.frontHitProfile +\n      this.systems\n        .callAllSystemHandlers(\"getHitProfile\", { front: true })\n        .reduce((total, entry) => total + entry, 0)\n    );\n  }\n\n  getSideHitProfile() {\n    return (\n      this.sideHitProfile +\n      this.systems\n        .callAllSystemHandlers(\"getHitProfile\", { front: false })\n        .reduce((total, entry) => total + entry, 0)\n    );\n  }\n\n  getHitProfile(position) {\n    const heading = addToDirection(\n      getCompassHeadingOfPoint(this.getPosition(), position),\n      -hexFacingToAngle(this.getFacing())\n    );\n\n    if (heading >= 330 || heading <= 30 || (heading >= 150 && heading <= 210)) {\n      return this.getFrontHitProfile();\n    } else {\n      return this.getSideHitProfile();\n    }\n  }\n\n  getPointCost() {\n    return this.pointCost;\n  }\n\n  getFacing() {\n    const lastMove = this.movement.getLastMove();\n    if (!lastMove) {\n      return null;\n    }\n\n    return lastMove.getFacing();\n  }\n\n  getFinalPosition() {\n    const lastMove = this.movement.getLastMove();\n    if (!lastMove) {\n      return null;\n    }\n\n    return lastMove.getPosition().add(lastMove.velocity);\n  }\n\n  getFinalHexPosition() {\n    return coordinateConverter.fromGameToHex(this.getFinalPosition());\n  }\n\n  getPosition() {\n    const lastMove = this.movement.getLastMove();\n    if (!lastMove) {\n      return null;\n    }\n\n    return lastMove.getPosition();\n  }\n\n  getHexPosition() {\n    return coordinateConverter.fromGameToHex(this.getPosition());\n  }\n\n  distanceTo(target) {\n    return HexagonMath.getHexWidth() * this.hexDistanceTo(target);\n  }\n\n  _calculateHexDistanceTo(\n    shipPosition,\n    shipFacing,\n    otherShipPosition,\n    otherShipFacing,\n    target\n  ) {\n    let closest = null;\n\n    const hexSizes =\n      this.hexSizes.length > 0 ? this.hexSizes : [new Offset(0, 0)];\n\n    hexSizes.forEach(hex => {\n      const otherHexSizes =\n        target.hexSizes.length > 0 ? target.hexSizes : [new Offset(0, 0)];\n\n      otherHexSizes.forEach(otherHex => {\n        const distance = shipPosition\n          .add(hex.rotate(shipFacing))\n          .distanceTo(otherShipPosition.add(otherHex.rotate(otherShipFacing)));\n\n        if (closest === null || distance < closest) {\n          closest = distance;\n        }\n      });\n    });\n\n    return closest;\n  }\n\n  finalHexDistanceTo(target) {\n    const shipPosition = this.getFinalHexPosition();\n    const shipFacing = this.getFacing();\n    const otherShipPosition = target.getFinalHexPosition();\n    const otherShipFacing = target.getFacing();\n\n    return this._calculateHexDistanceTo(\n      shipPosition,\n      shipFacing,\n      otherShipPosition,\n      otherShipFacing,\n      target\n    );\n  }\n\n  hexDistanceTo(target) {\n    const shipPosition = this.getHexPosition();\n    const shipFacing = this.getFacing();\n    const otherShipPosition = target.getHexPosition();\n    const otherShipFacing = target.getFacing();\n\n    return this._calculateHexDistanceTo(\n      shipPosition,\n      shipFacing,\n      otherShipPosition,\n      otherShipFacing,\n      target\n    );\n  }\n\n  getVelocity() {\n    const lastMove = this.movement.getLastMove();\n    if (!lastMove) {\n      return null;\n    }\n\n    return lastMove.getVelocity();\n  }\n\n  getIconHexas(hexFacing = 0) {\n    return this.hexSizes.map(hex => hex.rotate(hexFacing));\n  }\n\n  deserialize(data = {}) {\n    const shipData = data.shipData || {};\n    this.id = data.id || null;\n    this.name = data.name || \"Unnamed ship \";\n    this.shipClass = this.constructor.name;\n    this.slotId = data.slotId || null;\n\n    this.systems.deserialize(shipData.systems);\n    this.player = new ShipPlayer(this).deserialize(shipData.player);\n    this.movement = new ShipMovement(this).deserialize(data.movement);\n    this.electronicWarfare = new ShipElectronicWarfare(this).deserialize(\n      shipData.electronicWarfare\n    );\n    this.destroyedThisTurn = data.destroyedThisTurn || false;\n\n    return this;\n  }\n\n  serialize() {\n    return {\n      id: this.id,\n      gameId: this.gameId,\n      name: this.name,\n      shipClass: this.shipClass,\n      slotId: this.slotId,\n      movement: this.movement.serialize(),\n      shipData: {\n        systems: this.systems.serialize(),\n        player: this.player.serialize(),\n        electronicWarfare: this.electronicWarfare.serialize()\n      },\n      destroyedThisTurn: this.destroyedThisTurn\n    };\n  }\n\n  isDestroyed() {\n    return this.systems.isDestroyed();\n  }\n\n  isDestroyedThisTurn() {\n    return this.destroyedThisTurn;\n  }\n\n  markDestroyedThisTurn() {\n    this.destroyedThisTurn = true;\n  }\n\n  censorForUser(user, mine) {\n    if (!mine) {\n      this.movement.removeMovementExceptEnd(this.turn);\n    }\n    this.systems.censorForUser(user, mine);\n  }\n\n  endTurn(turn) {\n    this.systems.endTurn(turn);\n  }\n\n  advanceTurn(turn) {\n    this.movement.removeMovementForOtherTurns(turn);\n    this.systems.advanceTurn(turn);\n    this.electronicWarfare.activatePlannedElectronicWarfare();\n    this.electronicWarfare.removeAll();\n    //this.electronicWarfare.repeatElectonicWarfare();\n\n    this.destroyedThisTurn = false;\n    return this;\n  }\n\n  receivePlayerData(clientShip) {\n    this.systems.receivePlayerData(clientShip);\n  }\n\n  setShipLoadout() {\n    this.systems.callAllSystemHandlers(\"loadTargetInstant\");\n  }\n}\n\nexport default Ship;\n","import Ship from \"../unit/Ship.mjs\";\r\nimport ShipSystem from \"../unit/system/ShipSystem.mjs\";\r\n\r\nclass FireOrder {\r\n  constructor(shooterId, targetId, weaponId, weaponSettigs = {}) {\r\n    this.id = null;\r\n    this.shooterId = shooterId instanceof Ship ? shooterId.id : shooterId;\r\n    this.targetId = shooterId instanceof Ship ? targetId.id : targetId;\r\n    this.weaponId = weaponId instanceof ShipSystem ? weaponId.id : weaponId;\r\n    this.weaponSettigs = weaponSettigs;\r\n    this.resolved = false;\r\n  }\r\n\r\n  setId(id) {\r\n    this.id = id;\r\n    return this;\r\n  }\r\n\r\n  setResolved() {\r\n    this.resolved = true;\r\n    return this;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      id: this.id,\r\n      shooterId: this.shooterId,\r\n      targetId: this.targetId,\r\n      weaponId: this.weaponId,\r\n      weaponSettigs: this.weaponSettigs,\r\n      resolved: this.resolved\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.id = data.id || null;\r\n    this.shooterId = data.shooterId;\r\n    this.targetId = data.targetId;\r\n    this.weaponId = data.weaponId;\r\n    this.weaponSettigs = data.weaponSettigs || {};\r\n    this.resolved = data.resolved;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default FireOrder;\r\n","import FireOrder from \"./FireOrder.mjs\";\r\n\r\nclass WeaponFireService {\r\n  constructor() {\r\n    this.gamedata = null;\r\n  }\r\n\r\n  update(gamedata) {\r\n    this.gamedata = gamedata;\r\n\r\n    return this;\r\n  }\r\n\r\n  getAllFireOrders() {\r\n    return this.gamedata.ships\r\n      .getShips()\r\n      .reduce(\r\n        (all, ship) => [...all, ...this.getAllFireOrdersForShip(ship)],\r\n        []\r\n      );\r\n  }\r\n\r\n  getFireOrderById(id) {\r\n    return this.getAllFireOrders().find(order => order.id === id);\r\n  }\r\n\r\n  getAllFireOrdersForShip(shooter) {\r\n    return shooter.systems\r\n      .getSystems()\r\n      .reduce(\r\n        (all, system) => [\r\n          ...all,\r\n          ...system.callHandler(\"getFireOrders\", {}, [])\r\n        ],\r\n        []\r\n      );\r\n  }\r\n\r\n  systemHasFireOrder(system) {\r\n    const fireOrders = system.callHandler(\"getFireOrders\");\r\n    return fireOrders && fireOrders.length > 0;\r\n  }\r\n\r\n  systemHasFireOrderAgainstShip(system, target) {\r\n    const fireOrders = system.callHandler(\"getFireOrders\", null, []);\r\n\r\n    return fireOrders.some(order => order.targetId === target.id);\r\n  }\r\n\r\n  addFireOrder(shooter, target, weapon) {\r\n    if (!this.canFire(shooter, target, weapon)) {\r\n      throw new Error(\"Check validity first\");\r\n    }\r\n\r\n    return weapon.callHandler(\"addFireOrder\", {\r\n      shooter,\r\n      target\r\n    });\r\n  }\r\n\r\n  removeFireOrders(shooter, weapon) {\r\n    weapon.callHandler(\"removeFireOrders\");\r\n  }\r\n\r\n  canFire(shooter, target, weapon) {\r\n    if (\r\n      shooter.isDestroyed() ||\r\n      target.isDestroyed() ||\r\n      weapon.isDisabled() ||\r\n      !weapon.callHandler(\"usesFireOrders\", null, false)\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    if (!weapon.callHandler(\"canFire\", null, true)) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n\r\nexport default WeaponFireService;\r\n","class PhaseState {\r\n  constructor() {\r\n    this.state = {};\r\n  }\r\n\r\n  set(key, payload) {\r\n    this.state[key] = payload;\r\n  }\r\n\r\n  get(key) {\r\n    return this.state[key];\r\n  }\r\n}\r\n\r\nexport default PhaseState;\r\n","import * as THREE from \"three\";\n\nimport { line2dVertexShader, line2dFragmentShader } from \"../shader\";\nimport { loadObject } from \"../../utils/objectLoader\";\nimport Vector from \"../../../../../model/utils/Vector.mjs\";\n\nconst GEOMETRY = loadObject(\"/img/3d/line3/scene.gltf\");\n\nconst getTexture = (type = \"\") => {\n  switch (type) {\n    case \"dashed\":\n      return new THREE.TextureLoader().load(\"/img/line/dash.png\");\n    case \"dashed-arrow\":\n      return new THREE.TextureLoader().load(\"/img/line/dashArrow.png\");\n    case \"dashed-circle\":\n      return new THREE.TextureLoader().load(\"/img/line/dashCircle.png\");\n    default:\n      return new THREE.TextureLoader().load(\"/img/line/full.png\");\n  }\n};\n\nclass LineSprite {\n  constructor(start, end, lineWidth, args = {}) {\n    this.args = args;\n    this.mesh = null;\n\n    this.color = args.color || new THREE.Color(1, 1, 1);\n    this.opacity = args.opacity || 1;\n\n    this.material = new THREE.RawShaderMaterial({\n      uniforms: {\n        map: {\n          value: getTexture(args.type)\n        },\n        time: { type: \"f\", value: 0.0 },\n        zoom: { type: \"f\", value: 0.0 },\n        color: { type: \"v3\", value: this.color },\n        opacity: { type: \"f\", value: this.opacity },\n        textureRepeat: { type: \"f\", value: 1.0 },\n        pulse: {\n          type: \"v2\",\n          value: [args.pulseAmount || 0, args.pulseSpeed || 1]\n        }\n      },\n      transparent: true,\n      depthWrite: false,\n      depthTest: true,\n      side: THREE.DoubleSide,\n      blending: args.blending || THREE.NormalBlending,\n      vertexShader: line2dVertexShader,\n      fragmentShader: line2dFragmentShader\n      //wireframe: true\n    });\n\n    this.start = start;\n    this.end = end;\n    this.lineWidth = lineWidth;\n\n    this.create();\n    this.update(start, end, lineWidth, true);\n    this.animate();\n  }\n\n  animate() {\n    const now = Date.now();\n    this.material.uniforms.time.value = (now % 1000) * 0.001;\n    this.material.needsUpdate = true;\n    requestAnimationFrame(this.animate.bind(this));\n  }\n\n  async addTo(scene) {\n    this.scene = scene;\n    await GEOMETRY;\n    scene.add(this.mesh);\n  }\n\n  async create() {\n    this.material.uniforms.map.value.wrapT = THREE.RepeatWrapping;\n    this.material.uniforms.map.value.minFilter =\n      this.args.minFilter || THREE.LinearMipmapNearestFilter;\n\n    this.material.needsUpdate = true;\n\n    const geometry = await GEOMETRY;\n    this.mesh = new THREE.Mesh(\n      geometry.scene.children[0].geometry.clone(),\n      this.material\n    );\n  }\n\n  async updateTextureSize(size) {\n    this.args.textureSize = size;\n    const distance = this.start.distanceTo(this.end);\n    let textureRepeat = this.args.textureSize\n      ? distance / this.args.textureSize\n      : 1;\n\n    if (this.args.roundTestureRepeate) {\n      textureRepeat = Math.round(textureRepeat);\n    }\n\n    this.material.uniforms.textureRepeat.value = textureRepeat;\n  }\n\n  async update(start, end, lineWidth = 1, force) {\n    await GEOMETRY;\n\n    if (lineWidth !== this.lineWidth || force) {\n      this.mesh.scale.setY(this.lineWidth);\n    }\n\n    if (!start.equals(this.start) || !end.equals(this.end) || force) {\n      const direction = end.sub(start);\n\n      this.mesh.quaternion.setFromUnitVectors(\n        new THREE.Vector3(1, 0, 0).normalize(),\n        direction.normalize()\n      );\n\n      const distance = start.distanceTo(end);\n      this.mesh.scale.setX(distance);\n      const position = start.add(direction.multiplyScalar(0.5));\n      this.mesh.position.set(position.x, position.y, position.z);\n      let testureRepeat = this.args.textureSize\n        ? distance / this.args.textureSize\n        : 1;\n\n      if (this.args.roundTestureRepeate) {\n        testureRepeat = Math.round(testureRepeat);\n      }\n      this.material.uniforms.textureRepeat.value = testureRepeat;\n      this.material.needsUpdate = true;\n    }\n\n    this.start = start;\n    this.end = end;\n    this.lineWidth = lineWidth;\n\n    return this;\n  }\n\n  render(zoom) {\n    /*\n    if (zoom > 1) {\n      this.material.uniforms.opacity.value =\n        this.opacity * (1 + (zoom - 1) * 0.5);\n    }\n    */\n    //this.mesh.scale.setY(this.lineWidth * (zoom * 0.5));\n    /*\n    const distance = this.start.distanceTo(this.end) / zoom;\n\n    this.material.uniforms.textureRepeat.value = this.args.textureSize\n      ? distance / this.args.textureSize\n      : 1;\n      */\n  }\n\n  async hide() {\n    await GEOMETRY;\n    this.mesh.visible = false;\n    return this;\n  }\n\n  async show() {\n    await GEOMETRY;\n    this.mesh.visible = true;\n    return this;\n  }\n\n  async destroy() {\n    await GEOMETRY;\n    this.scene.remove(this.mesh);\n    this.mesh.material.dispose();\n  }\n}\n\nexport default LineSprite;\n","import * as THREE from \"three\";\nimport { spriteFragmentShader, spriteVertexShader } from \"../shader\";\nimport {\n  degreeToRadian,\n  radianToDegree\n} from \"../../../../../model/utils/math\";\n\nconst textureLoader = new THREE.TextureLoader();\nconst geometries = {};\n\nconst baseMaterial = new THREE.ShaderMaterial({\n  vertexShader: spriteVertexShader,\n  fragmentShader: spriteFragmentShader,\n  transparent: true,\n  depthWrite: false\n});\n\nclass Sprite {\n  constructor(image, size, z) {\n    this.z = z || 0;\n    this.mesh = null;\n    this.size = size;\n    this.opacity = 1;\n    this.uniforms = {\n      texture: { type: \"t\", value: new THREE.DataTexture(null, 0, 0) },\n      overlayAlpha: { type: \"f\", value: 0.0 },\n      overlayColor: { type: \"v3\", value: new THREE.Color(0, 0, 0) },\n      opacity: { type: \"f\", value: 1.0 }\n    };\n\n    this.color = null;\n\n    this.mesh = this.create(size, image);\n  }\n\n  getMaterial() {\n    return baseMaterial;\n  }\n\n  hide() {\n    this.mesh.visible = false;\n    return this;\n  }\n\n  show() {\n    this.mesh.visible = true;\n    return this;\n  }\n\n  replaceColor(color) {\n    this.uniforms.overlayColor.value = color;\n    return this;\n  }\n\n  revertColor() {\n    if (!this.color) {\n      return;\n    }\n\n    this.uniforms.overlayColor.value = this.color;\n  }\n\n  setPosition(pos) {\n    this.mesh.position.x = pos.x;\n    this.mesh.position.y = pos.y;\n    return this;\n  }\n\n  setOpacity(opacity) {\n    this.opacity = opacity;\n    this.uniforms.opacity.value = opacity;\n    return this;\n  }\n\n  multiplyOpacity(m) {\n    this.uniforms.opacity.value = this.opacity * m;\n    return this;\n  }\n\n  setOverlayColorAlpha(alpha) {\n    this.uniforms.overlayAlpha.value = alpha;\n    return this;\n  }\n\n  setOverlayColor(color) {\n    this.color = color;\n    this.uniforms.overlayColor.value = color;\n    return this;\n  }\n\n  setScale(width, height) {\n    this.mesh.scale.set(width, height, 1);\n    return this;\n  }\n\n  destroy() {\n    this.mesh.material.dispose();\n  }\n\n  setFacing(facing) {\n    this.mesh.rotation.z = degreeToRadian(facing);\n    return this;\n  }\n\n  getFacing() {\n    return radianToDegree(this.mesh.rotation.z);\n  }\n\n  create(size, image) {\n    const material = this.getMaterial();\n    const geometry =\n      geometries[\"\" + size.width + \"-\" + size.height] ||\n      (() => {\n        const geometry = new THREE.PlaneGeometry(size.width, size.height, 1, 1);\n        geometries[\"\" + size.width + \"-\" + size.height] = geometry;\n        return geometry;\n      })();\n\n    if (typeof image == \"string\") {\n      image = textureLoader.load(\"img/spritesheet.png\");\n    }\n\n    this.uniforms.texture.value = image;\n\n    this.material = material.clone();\n    this.material.uniforms = this.uniforms;\n\n    this.material.depthTest = true;\n\n    const mesh = new THREE.Mesh(geometry, this.material);\n\n    mesh.position.z = this.z;\n    return mesh;\n  }\n}\n\nexport default Sprite;\n","import * as mathlib from \"../../../../model/utils/math\";\r\n\r\nconst clearCanvas = canvasid => {\r\n  const canvas = document.getElementById(canvasid);\r\n  canvas.getContext(\"2d\").clearRect(0, 0, canvas.width, canvas.height);\r\n};\r\n\r\nconst clearContext = (context, canvas) => {\r\n  context.clearRect(0, 0, canvas.width, canvas.height);\r\n};\r\n\r\nconst clearSmallCanvas = context => {\r\n  context.clearRect(0, 0, 100, 100);\r\n};\r\n\r\nconst getCanvas = canvasid => {\r\n  //console.log(canvasid);\r\n  var canvas = document.getElementById(canvasid);\r\n  if (!canvas) {\r\n    console.log(\"Canvas is null\");\r\n    console.trace();\r\n    return null;\r\n  }\r\n\r\n  var context = canvas.getContext(\"2d\");\r\n  return context;\r\n};\r\n\r\nconst drawCone = (canvas, start, p1, p2, arcs, w) => {\r\n  canvas.lineWidth = w;\r\n  canvas.beginPath();\r\n  canvas.moveTo(start.x, start.y);\r\n  canvas.lineTo(p1.x, p1.y);\r\n  canvas.arc(\r\n    start.x,\r\n    start.y,\r\n    mathlib.distance(start, p1),\r\n    mathlib.degreeToRadian(arcs.start),\r\n    mathlib.degreeToRadian(arcs.end),\r\n    false\r\n  );\r\n  //canvas.lineTo(start.x,start.y);\r\n  canvas.closePath();\r\n  canvas.stroke();\r\n  canvas.fill();\r\n};\r\n\r\nconst drawBox = (canvas, p, w, h, lw) => {\r\n  canvas.lineWidth = lw;\r\n  canvas.beginPath();\r\n  canvas.moveTo(p.x - w / 2, p.y + h / 2);\r\n  canvas.lineTo(p.x + w / 2, p.y + h / 2);\r\n  canvas.lineTo(p.x + w / 2, p.y - h / 2);\r\n  canvas.lineTo(p.x - w / 2, p.y - h / 2);\r\n  canvas.closePath();\r\n  canvas.stroke();\r\n  canvas.fill();\r\n};\r\n\r\nconst drawCircle = (canvas, x, y, r, w) => {\r\n  if (r < 1) r = 1;\r\n  canvas.lineWidth = w;\r\n  canvas.beginPath();\r\n  canvas.arc(x, y, r, 0, Math.PI * 2, true);\r\n  canvas.closePath();\r\n  canvas.stroke();\r\n};\r\n\r\nconst drawHollowCircleAndFill = (canvas, x, y, r, r2, w) => {\r\n  canvas.beginPath();\r\n  canvas.arc(x, y, r2, 0, Math.PI * 2, false); // outer (filled)\r\n  canvas.moveTo(x + r, y);\r\n  canvas.arc(x, y, r, 0, Math.PI * 2, true); // inner (unfills it)\r\n  canvas.stroke();\r\n  canvas.fill();\r\n};\r\n\r\nconst drawCircleSegment = (canvas, x, y, r, r2, s, e) => {\r\n  canvas.beginPath();\r\n  canvas.arc(x, y, r2, s, e, false); // outer (filled)\r\n\r\n  const p1 = mathlib.getPointInDirection(r, -mathlib.radianToDegree(e), x, y);\r\n  canvas.lineTo(p1.x, p1.y);\r\n  canvas.arc(x, y, r, e, s, true); // inner (unfills it)\r\n  const p2 = mathlib.getPointInDirection(r2, -mathlib.radianToDegree(s), x, y);\r\n  canvas.lineTo(p2.x, p2.y);\r\n\r\n  canvas.closePath();\r\n  canvas.stroke();\r\n  canvas.fill();\r\n};\r\n\r\nconst drawDottedCircle = (canvas, x, y, r, r2, segments, gapratio) => {\r\n  const deg = 360 / segments;\r\n  const gap = deg * gapratio;\r\n\r\n  for (let d = 0; d < 360; d += deg) {\r\n    drawCircleSegment(\r\n      canvas,\r\n      x,\r\n      y,\r\n      r,\r\n      r2,\r\n      mathlib.degreeToRadian(d),\r\n      mathlib.degreeToRadian(d + deg - gap)\r\n    );\r\n  }\r\n};\r\n\r\nconst drawFilledCircle = (canvas, x, y, r1, r2) => {\r\n  drawCircleSegment(\r\n    canvas,\r\n    x,\r\n    y,\r\n    r1,\r\n    r2,\r\n    mathlib.degreeToRadian(0),\r\n    mathlib.degreeToRadian(360)\r\n  );\r\n};\r\n\r\nconst drawCircleAndFill = (canvas, x, y, r, w) => {\r\n  canvas.lineWidth = w;\r\n  canvas.beginPath();\r\n  canvas.arc(x, y, r, 0, Math.PI * 2, true);\r\n  canvas.closePath();\r\n  canvas.stroke();\r\n  canvas.fill();\r\n};\r\n\r\nconst drawCircleNoStroke = (canvas, x, y, r, w) => {\r\n  canvas.lineWidth = w;\r\n  canvas.beginPath();\r\n  canvas.arc(x, y, r, 0, Math.PI * 2, true);\r\n  canvas.closePath();\r\n  canvas.fill();\r\n};\r\n\r\nconst drawLine = (canvas, x1, y1, x2, y2, w) => {\r\n  canvas.lineWidth = w;\r\n  canvas.beginPath();\r\n  canvas.moveTo(x1, y1);\r\n  canvas.lineTo(x2, y2);\r\n  canvas.stroke();\r\n};\r\n\r\nconst drawArrow = (canvas, x, y, a, s, w) => {\r\n  var p1, p2, p3, p4, p5, p6, p7;\r\n\r\n  p1 = mathlib.getPointInDirection(s * 0.5, -a, x, y);\r\n  p2 = mathlib.getPointInDirection(\r\n    s * 0.5,\r\n    -mathlib.addToDirection(a, -140),\r\n    p1.x,\r\n    p1.y\r\n  );\r\n  p3 = mathlib.getPointInDirection(\r\n    s * 0.15,\r\n    -mathlib.addToDirection(a, 90),\r\n    p2.x,\r\n    p2.y\r\n  );\r\n  p4 = mathlib.getPointInDirection(\r\n    s * 0.5,\r\n    -mathlib.addToDirection(a, 180),\r\n    p3.x,\r\n    p3.y\r\n  );\r\n\r\n  p7 = mathlib.getPointInDirection(\r\n    s * 0.5,\r\n    -mathlib.addToDirection(a, 140),\r\n    p1.x,\r\n    p1.y\r\n  );\r\n  p6 = mathlib.getPointInDirection(\r\n    s * 0.15,\r\n    -mathlib.addToDirection(a, -90),\r\n    p7.x,\r\n    p7.y\r\n  );\r\n  p5 = mathlib.getPointInDirection(\r\n    s * 0.5,\r\n    -mathlib.addToDirection(a, 180),\r\n    p6.x,\r\n    p6.y\r\n  );\r\n\r\n  canvas.lineWidth = w;\r\n  canvas.beginPath();\r\n  canvas.moveTo(p1.x, p1.y);\r\n  canvas.lineTo(p2.x, p2.y);\r\n  canvas.lineTo(p3.x, p3.y);\r\n  canvas.lineTo(p4.x, p4.y);\r\n  canvas.lineTo(p5.x, p5.y);\r\n  canvas.lineTo(p6.x, p6.y);\r\n  canvas.lineTo(p7.x, p7.y);\r\n  canvas.closePath();\r\n  canvas.fill();\r\n  canvas.stroke();\r\n};\r\n\r\nconst drawX = (canvas, x, y, l, w) => {\r\n  x = parseInt(x);\r\n  y = parseInt(y);\r\n  l = parseInt(l);\r\n\r\n  canvas.lineWidth = w;\r\n  canvas.beginPath();\r\n  canvas.moveTo(x - l, y - l);\r\n  canvas.lineTo(x + l, y + l);\r\n  canvas.stroke();\r\n\r\n  canvas.beginPath();\r\n  canvas.moveTo(x - l, y + l);\r\n  canvas.lineTo(x + l, y - l);\r\n  canvas.stroke();\r\n};\r\n\r\nconst drawCenteredHexagon = (canvas, x, y, l, leftside, topleft, topright) => {\r\n  const a = l * Math.sin((30 / 180) * Math.PI);\r\n  const b = l * Math.cos((30 / 180) * Math.PI);\r\n\r\n  x = x - b;\r\n  y = y - a * 2;\r\n  drawHexagon(canvas, x, y, l, leftside, topleft, topright);\r\n};\r\n\r\nconst drawHexagon = (canvas, x, y, l, leftside, topleft, topright) => {\r\n  const a = l * Math.sin((30 / 180) * Math.PI);\r\n  const b = l * Math.cos((30 / 180) * Math.PI);\r\n\r\n  let p1, p2, p3, p4, p5, p6;\r\n\r\n  p1 = { x: x, y: y + a + l };\r\n  p2 = { x: x, y: y + a };\r\n  p3 = { x: x + b, y: y };\r\n  p4 = { x: x + 2 * b, y: y + a };\r\n  p5 = { x: x + 2 * b, y: y + a + l };\r\n  p6 = { x: x + b, y: y + 2 * l };\r\n\r\n  canvas.beginPath();\r\n\r\n  if (leftside) {\r\n    canvas.moveTo(p1.x, p1.y);\r\n    canvas.lineTo(p2.x, p2.y);\r\n  } else {\r\n    canvas.moveTo(p2.x, p2.y);\r\n  }\r\n\r\n  if (topleft) {\r\n    canvas.lineTo(p3.x, p3.y);\r\n  } else {\r\n    canvas.moveTo(p3.x, p3.y);\r\n  }\r\n\r\n  if (topright) {\r\n    canvas.lineTo(p4.x, p4.y);\r\n  } else {\r\n    canvas.moveTo(p4.x, p4.y);\r\n  }\r\n\r\n  canvas.lineTo(p5.x, p5.y);\r\n  canvas.lineTo(p6.x, p6.y);\r\n  canvas.lineTo(p1.x, p1.y);\r\n  canvas.closePath();\r\n\r\n  canvas.stroke();\r\n  canvas.fill();\r\n};\r\n\r\nconst drawAndRotate = (canvas, w, h, iw, ih, angle, img, rolled) => {\r\n  const x = Math.round(w / 2);\r\n  const y = Math.round(h / 2);\r\n  const width = iw / 2;\r\n  const height = ih / 2;\r\n\r\n  if (rolled) angle = 360 - angle;\r\n\r\n  angle = (angle * Math.PI) / 180;\r\n  canvas.save();\r\n  canvas.translate(x, y);\r\n  if (rolled) canvas.scale(1, -1);\r\n  canvas.rotate(angle);\r\n  canvas.drawImage(img, -width / 2, -height / 2, width, height);\r\n  canvas.rotate(-angle);\r\n  canvas.translate(-x, -y);\r\n  canvas.restore();\r\n};\r\n\r\nexport {\r\n  clearCanvas,\r\n  clearContext,\r\n  clearSmallCanvas,\r\n  getCanvas,\r\n  drawCone,\r\n  drawBox,\r\n  drawCircle,\r\n  drawHollowCircleAndFill,\r\n  drawDottedCircle,\r\n  drawCircleSegment,\r\n  drawCircleAndFill,\r\n  drawFilledCircle,\r\n  drawCircleNoStroke,\r\n  drawLine,\r\n  drawArrow,\r\n  drawX,\r\n  drawCenteredHexagon,\r\n  drawHexagon,\r\n  drawAndRotate\r\n};\r\n","const create = (width, height, debug) => {\r\n  const canvas = document.createElement(\"canvas\");\r\n  canvas.width = width;\r\n  canvas.height = height;\r\n  canvas.style.zIndex = 1000;\r\n  canvas.style.position = \"absolute\";\r\n  canvas.style.top = \"3px\";\r\n  canvas.style.left = \"3px\";\r\n  canvas.style.border = \"1px solid red\";\r\n\r\n  if (debug) {\r\n    document.body.appendChild(canvas);\r\n  }\r\n\r\n  return canvas;\r\n};\r\n\r\nexport default {\r\n  create\r\n};\r\n","import * as THREE from \"three\";\r\nimport { drawCenteredHexagon } from \"../../utils/graphics\";\r\nimport abstractCanvas from \"../../utils/abstractCanvas\";\r\nimport HexagonMath from \"../../../../../model/utils/HexagonMath\";\r\n\r\nconst createCanvas = (width, height, debug) => {\r\n  return abstractCanvas.create(width, height, debug);\r\n};\r\n\r\nconst getTexture = function(canvas, gridWidth, gridHeight) {\r\n  if (gridWidth === undefined) {\r\n    gridWidth = 1;\r\n  }\r\n\r\n  if (gridHeight === undefined) {\r\n    gridHeight = 1;\r\n  }\r\n\r\n  var texture = new THREE.Texture(canvas);\r\n  texture.needsUpdate = true;\r\n  texture.wrapS = THREE.RepeatWrapping;\r\n  texture.wrapT = THREE.RepeatWrapping;\r\n  texture.repeat.set(\r\n    getHorizontalRepeat(gridWidth),\r\n    getVerticalRepeat(gridHeight)\r\n  );\r\n\r\n  texture.offset.set(0, 0.16666);\r\n\r\n  return texture;\r\n};\r\n\r\nconst getHorizontalRepeat = hexagons => 3 / 4 + ((hexagons - 1) * 2) / 4;\r\n\r\nconst getVerticalRepeat = hexagons => 4 / 6 + ((hexagons - 1) * 3) / 6;\r\n\r\nconst renderHexGrid = (canvasSize, lineColor, fillColor, lineWidth, repeat) => {\r\n  var scale = { x: 1, y: 1 };\r\n  var width = canvasSize;\r\n  var hl = width / 4 / Math.cos((30 / 180) * Math.PI);\r\n  var a = HexagonMath.getHexA(hl);\r\n  var b = HexagonMath.getHexB(hl);\r\n  var x = b;\r\n\r\n  var height = HexagonMath.getTextureHeight(hl);\r\n\r\n  var canvas = createCanvas(width, height, false);\r\n  var context = canvas.getContext(\"2d\", { antialias: true });\r\n  context.fillStyle = lineColor;\r\n  context.strokeStyle = lineColor;\r\n  context.fillStyle = fillColor;\r\n  context.lineWidth = lineWidth;\r\n\r\n  context.scale(scale.x, scale.y);\r\n\r\n  if (repeat) {\r\n    drawCenteredHexagon(context, x, 0, hl, true, true, true);\r\n    drawCenteredHexagon(context, x * 3, 0, hl, true, true, true);\r\n  }\r\n\r\n  drawCenteredHexagon(context, x * 2, hl + a, hl, true, true, true);\r\n\r\n  if (repeat) {\r\n    drawCenteredHexagon(context, x, hl * 3, hl, true, true, true);\r\n    drawCenteredHexagon(context, x * 3, hl * 3, hl, true, true, true);\r\n  }\r\n\r\n  var canvas2 = createCanvas(width, width, false);\r\n\r\n  canvas2\r\n    .getContext(\"2d\", { antialias: true })\r\n    .drawImage(canvas, 0, 0, width, height, 0, 0, width, width);\r\n\r\n  return canvas2;\r\n};\r\n\r\nconst getHexGridTexture = (\r\n  canvasSize,\r\n  gridWidth,\r\n  gridHeight,\r\n  lineColor,\r\n  fillColor,\r\n  lineWidth\r\n) => {\r\n  return getTexture(\r\n    renderHexGrid(canvasSize, lineColor, fillColor, lineWidth, true),\r\n    gridWidth,\r\n    gridHeight\r\n  );\r\n};\r\n\r\nconst getHexTexture = (canvasSize, lineColor, fillColor, lineWidth) => {\r\n  return getTexture(\r\n    renderHexGrid(canvasSize, lineColor, fillColor, lineWidth),\r\n    1,\r\n    1\r\n  );\r\n};\r\n\r\nexport default {\r\n  renderHexGrid,\r\n  getHexGridTexture,\r\n  getHexTexture\r\n};\r\n","import Sprite from \"./Sprite\";\nimport * as THREE from \"three\";\nimport HexagonTexture from \"../hexgrid/HexagonTexture\";\nimport HexagonMath from \"../../../../../model/utils/HexagonMath\";\n\nconst TEXTURE_SIZE = 512;\nlet TEXTURE = null;\n\nconst createTexture = () => {\n  const canvas = HexagonTexture.renderHexGrid(\n    TEXTURE_SIZE,\n    getStrokeColor(),\n    getFillColor(),\n    10\n  );\n\n  const tex = new THREE.Texture(canvas);\n  tex.needsUpdate = true;\n  TEXTURE = tex;\n};\n\nconst getStrokeColor = () => {\n  return \"rgba(255,255,255,0.50)\";\n};\n\nconst getFillColor = () => {\n  return \"rgba(255,255,255,0.15)\";\n};\n\nclass HexagonSprite extends Sprite {\n  constructor(position, z = 0, scale = 1) {\n    super(\n      null,\n      {\n        width: HexagonMath.getTextureWidth() * scale,\n        height: HexagonMath.getTextureHeight() * scale\n      },\n      z\n    );\n\n    if (!TEXTURE) {\n      createTexture();\n    }\n\n    this.uniforms.texture.value = TEXTURE;\n\n    this.setPosition(position);\n  }\n}\n\nexport default HexagonSprite;\n","import * as THREE from \"three\";\r\nimport Sprite from \"./Sprite\";\r\nimport abstractCanvas from \"../../utils/abstractCanvas\";\r\nimport { drawDottedCircle } from \"../../utils/graphics\";\r\n\r\nlet texture = null;\r\nconst TEXTURE_SIZE = 512;\r\n\r\nconst createTexture = () => {\r\n  if (texture) {\r\n    return;\r\n  }\r\n\r\n  const canvas = abstractCanvas.create(TEXTURE_SIZE, TEXTURE_SIZE);\r\n  const context = canvas.getContext(\"2d\");\r\n  context.strokeStyle = \"rgba(78,220,25,1.0)\";\r\n  context.fillStyle = \"rgba(78,220,25,0.5)\";\r\n\r\n  drawDottedCircle(\r\n    context,\r\n    TEXTURE_SIZE / 2,\r\n    TEXTURE_SIZE / 2,\r\n    TEXTURE_SIZE * 0.4,\r\n    TEXTURE_SIZE * 0.5,\r\n    12,\r\n    0.3\r\n  );\r\n\r\n  texture = new THREE.Texture(canvas);\r\n  texture.needsUpdate = true;\r\n};\r\n\r\nclass DottedCircleSprite extends Sprite {\r\n  constructor(size, z, opacity) {\r\n    super(null, size, z);\r\n\r\n    this.setOpacity(opacity);\r\n\r\n    createTexture();\r\n    this.uniforms.texture.value = texture;\r\n  }\r\n}\r\n\r\nexport default DottedCircleSprite;\r\n","import * as THREE from \"three\";\nimport abstractCanvas from \"../../utils/abstractCanvas\";\n\nconst TEXTURE_SIZE = 256;\n\nclass TextSprite {\n  constructor(text, color, z, args) {\n    if (!args) {\n      args = {};\n    }\n\n    this.z = z || 0;\n\n    const size = args.size || TEXTURE_SIZE;\n\n    this.color = color || \"rgba(255,255,255,1)\";\n\n    this.fontSize = args.fontSize || \"32px\";\n    this.font = args.font || \"Arial Black\";\n\n    var canvas = abstractCanvas.create(size, size);\n    var context = canvas.getContext(\"2d\");\n    context.save();\n    context.fillStyle = this.color;\n    context.font = this.fontSize + \" \" + this.font;\n    context.textAlign = \"center\";\n    context.textBaseline = \"middle\";\n    context.shadowOffsetX = 0;\n    context.shadowOffsetY = 0;\n\n    context.shadowColor = \"rgba(0,0,0,1)\";\n\n    context.shadowBlur = 8;\n    context.fillText(text, Math.round(size / 2), Math.round(size / 2));\n    context.restore();\n\n    var geometry = new THREE.PlaneGeometry(size, size, 1, 1);\n\n    var texture = new THREE.Texture(canvas);\n    texture.needsUpdate = true;\n\n    this.material = new THREE.MeshBasicMaterial({\n      map: texture,\n      transparent: true,\n      depthTest: false,\n      depthWrite: false\n    });\n\n    this.mesh = new THREE.Mesh(geometry, this.material);\n  }\n\n  setScale(width, height) {\n    this.mesh.scale.set(width, height, 1);\n  }\n\n  hide() {\n    this.mesh.visible = false;\n    return this;\n  }\n\n  show() {\n    this.mesh.visible = true;\n    return this;\n  }\n\n  setOpacity(opacity) {\n    this.material.opacity = opacity;\n  }\n\n  setPosition(pos) {\n    this.mesh.position.x = pos.x;\n    this.mesh.position.y = pos.y;\n    this.mesh.position.z = this.z;\n    return this;\n  }\n\n  destroy() {\n    this.mesh.material.dispose();\n  }\n}\n\nexport default TextSprite;\n","import * as THREE from \"three\";\r\nimport Sprite from \"./Sprite\";\r\nimport abstractCanvas from \"../../utils/abstractCanvas\";\r\nimport { drawCircleAndFill } from \"../../utils/graphics\";\r\nimport { spriteFragmentShader, spriteVertexShader } from \"../shader\";\r\n\r\nconst baseMaterial = new THREE.ShaderMaterial({\r\n  vertexShader: spriteVertexShader,\r\n  fragmentShader: spriteFragmentShader,\r\n  transparent: true,\r\n  depthWrite: false\r\n  //blending: THREE.AdditiveBlending\r\n});\r\n\r\nlet texture = new THREE.TextureLoader().load(\"/img/shipMapIcon.png\");\r\nlet textureMovementTarget = new THREE.TextureLoader().load(\r\n  \"/img/shipMapIconMovementTarget.png\"\r\n);\r\n\r\nclass ShipMapSprite extends Sprite {\r\n  constructor(position, size, z, opacity, movementTarget = false) {\r\n    super(null, size, z);\r\n\r\n    this.setOpacity(opacity);\r\n\r\n    if (movementTarget) {\r\n      this.uniforms.texture.value = textureMovementTarget;\r\n    } else {\r\n      this.uniforms.texture.value = texture;\r\n    }\r\n    this.setPosition(position);\r\n  }\r\n\r\n  getMaterial() {\r\n    return baseMaterial;\r\n  }\r\n}\r\n\r\nexport default ShipMapSprite;\r\n","import * as THREE from \"three\";\r\n\r\nimport { loadObject, cloneObject } from \"../utils/objectLoader\";\r\nimport { lineFragmentShader, lineVertexShader } from \"./shader\";\r\nimport { degreeToRadian } from \"../../../../model/utils/math.mjs\";\r\n\r\nlet hexagonMesh = null;\r\n\r\nconst baseMaterial = new THREE.ShaderMaterial({\r\n  vertexShader: lineVertexShader,\r\n  fragmentShader: lineFragmentShader,\r\n  transparent: true,\r\n  depthWrite: false,\r\n  //depthTest: false,\r\n  side: THREE.DoubleSide,\r\n  blending: THREE.AdditiveBlending\r\n});\r\n\r\nconst uniforms = {\r\n  time: { type: \"f\", value: 0.0 }\r\n};\r\n\r\nbaseMaterial.uniforms = uniforms;\r\n/*\r\nconst baseMaterial = new THREE.MeshBasicMaterial({\r\n  color: new THREE.Color(0, 1, 0)\r\n});\r\n*/\r\n\r\nconst animate = () => {\r\n  const now = Date.now();\r\n  baseMaterial.uniforms.time.value = (now % 1000) * 0.001;\r\n  baseMaterial.needsUpdate = true;\r\n  requestAnimationFrame(animate);\r\n};\r\n\r\nconst verticeAmount = 16;\r\n\r\nanimate();\r\n\r\nclass Line {\r\n  constructor(scene, args = {}) {\r\n    if (!args) {\r\n      args = {};\r\n    }\r\n\r\n    this.scene = scene;\r\n    this.mesh = null;\r\n    this.start = args.start;\r\n    this.end = args.end;\r\n    this.width = args.width || 10;\r\n    this.pulseAmount = args.pulseAmount || 0;\r\n    this.pulseSpeed = args.pulseSpeed || 1;\r\n    this.dashSize = args.dashSize || 0;\r\n    this.length = new THREE.Vector3().subVectors(this.start, this.end).length();\r\n    this.type = args.type || \"laser\";\r\n\r\n    this.ready = new Promise(resolve => {\r\n      this.resolveReady = resolve;\r\n    });\r\n\r\n    this.color = args.color;\r\n    this.opacity = args.opacity;\r\n\r\n    this.currentRotationMatrix = null;\r\n\r\n    this.create(this.start, this.end, this.width);\r\n  }\r\n\r\n  async getGeometry() {\r\n    if (!hexagonMesh) {\r\n      const object = await loadObject(\"/img/3d/line2/scene.gltf\");\r\n      hexagonMesh = object.scene.children[0];\r\n      hexagonMesh.rotation.set(\r\n        hexagonMesh.rotation.x + degreeToRadian(90),\r\n        hexagonMesh.rotation.y,\r\n        hexagonMesh.rotation.z\r\n      );\r\n      hexagonMesh.material = baseMaterial;\r\n    }\r\n\r\n    return hexagonMesh;\r\n  }\r\n\r\n  async createMesh(width, height) {\r\n    let mesh = await this.getGeometry();\r\n    mesh = mesh.clone();\r\n    mesh.geometry = mesh.geometry.clone();\r\n    //mesh.material = baseMaterial.clone();\r\n    mesh.scale.set(width, width, height);\r\n\r\n    return mesh;\r\n  }\r\n\r\n  getVertexAmount() {\r\n    switch (this.type) {\r\n      case \"cylinder\":\r\n        return 14;\r\n      case \"laser\":\r\n        return 16;\r\n    }\r\n  }\r\n\r\n  setPulse(amount, speed = 1) {\r\n    this.pulseAmount = amount;\r\n    this.pulseSpeed = speed;\r\n\r\n    if (!this.pulseAttribute) {\r\n      const pulses = [];\r\n      for (let i = 0; i < this.getVertexAmount(); i++) {\r\n        pulses.push(this.pulseAmount, this.pulseSpeed);\r\n      }\r\n      this.pulseAttribute = new THREE.BufferAttribute(\r\n        new Float32Array(pulses),\r\n        2\r\n      ).setDynamic(true);\r\n      this.mesh.geometry.addAttribute(\"pulse\", this.pulseAttribute);\r\n    } else {\r\n      for (let i = 0; i < this.getVertexAmount(); i++) {\r\n        this.pulseAttribute.setXY(i, this.pulseAmount, this.pulseSpeed);\r\n      }\r\n    }\r\n\r\n    this.dashAttribute.needsUpdate = true;\r\n  }\r\n\r\n  setDashed(dashSize) {\r\n    this.dashRatio = dashSize / this.length;\r\n\r\n    if (!this.dashAttribute) {\r\n      const dashes = [];\r\n      for (let i = 0; i < this.getVertexAmount(); i++) {\r\n        dashes.push(this.dashRatio);\r\n      }\r\n      this.dashAttribute = new THREE.BufferAttribute(\r\n        new Float32Array(dashes),\r\n        1\r\n      ).setDynamic(true);\r\n      this.mesh.geometry.addAttribute(\"dashRatio\", this.dashAttribute);\r\n    } else {\r\n      for (let i = 0; i < this.getVertexAmount(); i++) {\r\n        this.dashAttribute.setX(i, this.dashAttribute);\r\n      }\r\n    }\r\n\r\n    this.dashAttribute.needsUpdate = true;\r\n  }\r\n\r\n  setColorAttribute(color) {\r\n    const colors = [];\r\n    for (let i = 0; i < this.getVertexAmount(); i++) {\r\n      colors.push(color.r, color.g, color.b);\r\n    }\r\n    this.colorAttribute = new THREE.BufferAttribute(\r\n      new Float32Array(colors),\r\n      3\r\n    ).setDynamic(true);\r\n    this.mesh.geometry.addAttribute(\"color\", this.colorAttribute);\r\n\r\n    this.colorAttribute.needsUpdate = true;\r\n  }\r\n\r\n  async setColor(color) {\r\n    await this.ready;\r\n    this.color = color;\r\n    for (let i = 0; i < this.getVertexAmount(); i++) {\r\n      this.colorAttribute.setXYZ(i, this.color.r, this.color.g, this.color.b);\r\n    }\r\n\r\n    this.colorAttribute.needsUpdate = true;\r\n  }\r\n\r\n  setOpacity(opacity) {\r\n    this.opacity = opacity;\r\n    if (!this.opacityAttribute) {\r\n      const opacitys = [];\r\n      for (let i = 0; i < this.getVertexAmount(); i++) {\r\n        opacitys.push(opacity);\r\n      }\r\n      this.opacityAttribute = new THREE.BufferAttribute(\r\n        new Float32Array(opacitys),\r\n        1\r\n      ).setDynamic(true);\r\n      this.mesh.geometry.addAttribute(\"opacity\", this.opacityAttribute);\r\n    } else {\r\n      for (let i = 0; i < this.getVertexAmount(); i++) {\r\n        this.opacityAttribute.setX(i, this.opacity);\r\n      }\r\n    }\r\n\r\n    this.opacityAttribute.needsUpdate = true;\r\n  }\r\n\r\n  getOrientation(pointX, pointY) {\r\n    const orientation = new THREE.Matrix4();\r\n    orientation.lookAt(pointX, pointY, new THREE.Object3D().up);\r\n    orientation.multiply(\r\n      new THREE.Matrix4().set(1, 0, 0, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 0, 0, 1)\r\n    );\r\n\r\n    return orientation;\r\n  }\r\n\r\n  async create(pointX, pointY, lineWidth) {\r\n    const mesh = await this.createMesh(lineWidth, this.length);\r\n    const orientation = this.getOrientation(pointX, pointY);\r\n\r\n    mesh.applyMatrix(orientation);\r\n    this.currentRotationMatrix = orientation;\r\n\r\n    mesh.position.x = (pointY.x + pointX.x) / 2;\r\n    mesh.position.y = (pointY.y + pointX.y) / 2;\r\n    mesh.position.z = (pointY.z + pointX.z) / 2;\r\n\r\n    this.scene.add(mesh);\r\n    this.mesh = mesh;\r\n    this.resolveReady(true);\r\n    this.setColorAttribute(this.color);\r\n    this.setOpacity(this.opacity);\r\n    this.setDashed(this.dashSize);\r\n    this.setPulse(this.pulseAmount, this.pulseSpeed);\r\n  }\r\n\r\n  updateMesh() {\r\n    const orientation = this.getOrientation(this.start, this.end);\r\n\r\n    this.mesh.applyMatrix(\r\n      new THREE.Matrix4().getInverse(this.currentRotationMatrix)\r\n    );\r\n\r\n    this.mesh.scale.set(this.width, this.width, this.length);\r\n\r\n    this.mesh.applyMatrix(orientation);\r\n    this.currentRotationMatrix = orientation;\r\n    this.mesh.position.x = (this.end.x + this.start.x) / 2;\r\n    this.mesh.position.y = (this.end.y + this.start.y) / 2;\r\n    this.mesh.position.z = (this.end.z + this.start.z) / 2;\r\n  }\r\n\r\n  async update(start, end, lineWidth) {\r\n    await this.ready;\r\n    this.width = lineWidth;\r\n    this.start = start;\r\n    this.end = end;\r\n    this.length = new THREE.Vector3().subVectors(this.start, this.end).length();\r\n    this.updateMesh();\r\n  }\r\n\r\n  setEnd(end) {\r\n    this.update(this.start, end, this.width);\r\n  }\r\n\r\n  setLineWidth(lineWidth) {\r\n    this.width = lineWidth;\r\n\r\n    this.mesh.scale.set(this.width, this.width, this.length);\r\n  }\r\n\r\n  multiplyOpacity(m) {\r\n    this.setOpacity(this.opacity * m);\r\n  }\r\n\r\n  async hide() {\r\n    await this.ready;\r\n    this.mesh.visible = false;\r\n    return this;\r\n  }\r\n\r\n  async show() {\r\n    await this.ready;\r\n    this.mesh.visible = true;\r\n    return this;\r\n  }\r\n\r\n  async destroy() {\r\n    await this.ready;\r\n    this.scene.remove(this.mesh);\r\n  }\r\n}\r\n\r\nexport default Line;\r\n","const lineVertexShader = `\r\n\r\n    attribute vec3 color;\r\n    attribute float opacity;\r\n    attribute float dashRatio;\r\n    attribute vec2 pulse;\r\n    varying float vOpacity;\r\n    varying vec3 vColor;\r\n    varying vec2 vUv;\r\n    varying float vDashRatio;\r\n    varying vec2 vPulse;\r\n\r\n    void main() {\r\n        vUv = uv;\r\n        vColor = color;\r\n        vPulse = pulse;\r\n        vOpacity = opacity;\r\n        vDashRatio = dashRatio;\r\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\r\n    }\r\n`;\r\n\r\nexport default lineVertexShader;\r\n","const lineFragmentShader = `\r\n\r\n    uniform float time;\r\n    varying vec3 vColor;\r\n    varying vec2 vUv;\r\n    varying float vOpacity;\r\n    varying float vDashRatio;\r\n    varying vec2 vPulse;\r\n\r\n    vec4 getPulse(vec4 color) {\r\n        float pulseAmount = vPulse.x;\r\n        float pulseSpeed = vPulse.y;\r\n\r\n        if (pulseAmount == 0.0 || pulseSpeed == 0.0) {\r\n            return color;\r\n        }\r\n\r\n        float pulseTime = mod(time * pulseSpeed, 1.0);\r\n        float y = mod(vUv.y * pulseAmount, 1.0);\r\n   \r\n        float diff = y - pulseTime;\r\n        if (diff < 0.0) {\r\n            diff = 1.0 + diff;\r\n        }\r\n\r\n        if (diff > 0.9) {\r\n            diff = 1.0 - ((diff - 0.9) * 10.0);\r\n        }\r\n    \r\n        color += diff * 0.1;\r\n\r\n        return color;\r\n    }\r\n\r\n    vec4 blendSides(vec4 color) {\r\n        float treshold = 0.4;\r\n        if (vUv.x < treshold) {\r\n            color.a *= vUv.x * 1.0 / treshold;\r\n        } else if (vUv.x > 1.0 - treshold) {\r\n            color.a *= (1.0 - vUv.x) * 1.0 / treshold;;\r\n        }\r\n\r\n        return color;\r\n    }\r\n\r\n    vec4 getDashedColor(vec4 color) {\r\n\r\n        if (vDashRatio == 0.0) {\r\n            return color;\r\n        }\r\n\r\n        float y = vUv.y;\r\n\r\n        if ( mod(floor(y * 10.0 / (vDashRatio * 10.0)), 2.0) == 0.0 ) {\r\n            discard;\r\n        }\r\n\r\n        float modulus = mod(y, vDashRatio) / vDashRatio;\r\n        if (modulus < 0.2) {\r\n            color.a *= modulus * 5.0;\r\n        } else if (modulus > 0.8) {\r\n            color.a *= (1.0 - modulus) * 5.0;\r\n        }\r\n\r\n        return color;\r\n    }\r\n\r\n    void main() {\r\n        vec4 finalColor = vec4(vColor, 1.0);\r\n\r\n        if (finalColor.a > 0.0) {\r\n            finalColor.a *= vOpacity;\r\n        }\r\n\r\n        finalColor = getDashedColor(finalColor);\r\n        finalColor = blendSides(finalColor);\r\n        finalColor = getPulse(finalColor);\r\n       \r\n        gl_FragColor = finalColor; \r\n    }\r\n`;\r\n\r\nexport default lineFragmentShader;\r\n","import { loadObject, cloneObject } from \"../../utils/objectLoader\";\r\nimport * as THREE from \"three\";\r\n\r\nexport const loadObject3d = async url => {\r\n  const object = await loadObject(url);\r\n  return new Object3d(object.scene, object.animations);\r\n};\r\n\r\nclass Object3d {\r\n  constructor(scene, animations) {\r\n    this.id = null;\r\n\r\n    this.object = new THREE.Object3D();\r\n    this.scene = scene;\r\n    this.animations = animations;\r\n    this.actions = [];\r\n\r\n    this.object.add(this.scene);\r\n\r\n    this.animationMixer = new THREE.AnimationMixer(this.scene);\r\n    this.loopAnimation(\"ambient\");\r\n  }\r\n\r\n  traverse(callBack) {\r\n    this.object.traverse(child => {\r\n      if (child.isMesh) {\r\n        callBack(child);\r\n      }\r\n\r\n      if (child instanceof Object3d) {\r\n        child.traverse(callBack);\r\n      }\r\n    });\r\n  }\r\n\r\n  disableAnimation(name) {\r\n    const clip = THREE.AnimationClip.findByName(this.animations, name);\r\n\r\n    if (!clip) {\r\n      return;\r\n    }\r\n\r\n    const action = this.animationMixer.clipAction(clip);\r\n    action.reset();\r\n    action.weight = 0;\r\n    action.paused = true;\r\n  }\r\n\r\n  playAnimation(name) {\r\n    const clip = THREE.AnimationClip.findByName(this.animations, name);\r\n\r\n    if (!clip) {\r\n      return;\r\n    }\r\n    const action = this.animationMixer.clipAction(clip);\r\n    action.reset();\r\n    action.weight = 1;\r\n    action.clampWhenFinished = true;\r\n    action.loop = THREE.LoopOnce;\r\n    action.time = 0;\r\n    action.paused = false;\r\n    action.play();\r\n  }\r\n\r\n  loopAnimation(name) {\r\n    const clip = THREE.AnimationClip.findByName(this.animations, name);\r\n\r\n    if (!clip) {\r\n      return;\r\n    }\r\n    const action = this.animationMixer.clipAction(clip);\r\n    action.reset();\r\n    action.weight = 1;\r\n    action.clampWhenFinished = true;\r\n    action.loop = THREE.LoopRepeat;\r\n    action.time = 0;\r\n    action.paused = false;\r\n    action.play();\r\n  }\r\n\r\n  setAnimation(name, time) {\r\n    const clip = THREE.AnimationClip.findByName(this.animations, name);\r\n\r\n    if (!clip) {\r\n      return;\r\n    }\r\n    const action = this.animationMixer.clipAction(clip);\r\n    action.reset();\r\n    action.weight = 1;\r\n    action.clampWhenFinished = true;\r\n    action.loop = THREE.LoopOnce;\r\n    action.time = time;\r\n    action.paused = true;\r\n    action.play();\r\n  }\r\n\r\n  addTo(scene) {\r\n    scene.add(this.object);\r\n  }\r\n\r\n  removeFrom(scene) {\r\n    scene.remove(this.object);\r\n  }\r\n\r\n  clone() {\r\n    const clone = cloneObject(this);\r\n    const object = new Object3d(clone.scene, clone.animations);\r\n    object.setId(this.id);\r\n    return object;\r\n  }\r\n\r\n  setId(id) {\r\n    this.id = id;\r\n    return this;\r\n  }\r\n\r\n  render({ delta }) {\r\n    this.animationMixer.update(delta * 0.001);\r\n  }\r\n}\r\n\r\nexport default Object3d;\r\n","import { ShipMapSprite } from \"../sprite\";\r\n\r\nclass ShipMapIcon {\r\n  constructor(icon) {\r\n    this.icon = icon;\r\n\r\n    this.size = { width: 25, height: 25 };\r\n\r\n    this.normalSprite = new ShipMapSprite(\r\n      { x: 0, y: 0, z: 0 },\r\n      this.size,\r\n      0,\r\n      1\r\n    );\r\n    this.movementTargetSprite = new ShipMapSprite(\r\n      { x: 0, y: 0, z: 0 },\r\n      { width: 30, height: 30 },\r\n      0,\r\n      1,\r\n      true\r\n    );\r\n\r\n    this.sprite = this.normalSprite;\r\n    this.sprite.mesh.userData = { icon };\r\n    this.sprite.hide();\r\n    this.normalSprite.hide();\r\n    this.movementTargetSprite.hide();\r\n\r\n    this.scene = null;\r\n  }\r\n\r\n  setMovementTarget() {\r\n    this.scene.remove(this.sprite.mesh);\r\n    this.sprite = this.movementTargetSprite;\r\n    this.scene.add(this.sprite.mesh);\r\n    return this;\r\n  }\r\n\r\n  replaceColor(color) {\r\n    this.sprite.replaceColor(color);\r\n    return this;\r\n  }\r\n\r\n  revertColor() {\r\n    this.sprite.revertColor(this.color);\r\n    return this;\r\n  }\r\n\r\n  addTo(scene) {\r\n    this.scene = scene;\r\n    scene.add(this.sprite.mesh);\r\n  }\r\n\r\n  setScale(scale) {\r\n    this.sprite.setScale(scale, scale);\r\n    return this;\r\n  }\r\n\r\n  setRotation(rotation) {\r\n    this.normalSprite.setFacing(rotation);\r\n    this.movementTargetSprite.setFacing(rotation);\r\n    return this;\r\n  }\r\n\r\n  setOverlayColor(color) {\r\n    this.sprite.setOverlayColor(color);\r\n    return this;\r\n  }\r\n\r\n  setOverlayColorAlpha(alpha) {\r\n    this.sprite.setOverlayColorAlpha(alpha);\r\n    return this;\r\n  }\r\n\r\n  show() {\r\n    this.sprite.show();\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.sprite.hide();\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default ShipMapIcon;\r\n","import * as THREE from \"three\";\nimport * as shipObjects from \".\";\nimport Vector from \"../../../../../model/utils/Vector.mjs\";\n\nimport { degreeToRadian } from \"../../../../../model/utils/math\";\n\nimport {\n  LineSprite,\n  CircleSprite,\n  ShipEWSprite,\n  DottedCircleSprite,\n  HexagonSprite\n} from \"../sprite\";\n\nimport Line from \"../Line\";\nimport Object3d from \"../object3d/Object3d\";\nimport coordinateConverter from \"../../../../../model/utils/CoordinateConverter.mjs\";\nimport ShipMapIcon from \"./ShipMapIcon\";\nimport { angleToHexFacing } from \"../../../../../model/utils/math.mjs\";\nimport { radianToDegree } from \"../../../../../model/utils/math.mjs\";\n\nconst COLOR_MINE = new THREE.Color(39 / 255, 196 / 255, 39 / 255);\nconst COLOR_ENEMY = new THREE.Color(255 / 255, 40 / 255, 40 / 255);\n\nclass ShipObject {\n  constructor(ship, scene) {\n    this.shipId = ship.id;\n    this.ship = ship;\n    this.systemLocations = {};\n\n    this.bumpMap = null;\n\n    this.scene = scene;\n    this.mesh = new THREE.Object3D();\n    //this.mesh.castShadow = true;\n    //this.mesh.receiveShadow = true;\n    this.shipObject = null;\n    this.systemObjects = [];\n\n    this.resolveShipObjectLoaded = null;\n    this.isShipObjectLoaded = new Promise((resolve, reject) => {\n      this.resolveShipObjectLoaded = resolve;\n    });\n\n    this.mapIcon = null;\n    this.hexSprites = [];\n    this.hexSpriteContainer = new THREE.Object3D();\n    this.ghostShipObject = null;\n    this.shipSideSprite = null;\n    //this.shipEWSprite = null;\n    this.shipSelectedSprite = null;\n    this.line = null;\n\n    this.defaultHeight = 50;\n    this.sideSpriteSize = 100;\n    this.position = { x: 0, y: 0, z: 0 };\n    this.shipZ = null;\n\n    this.hidden = false;\n\n    this.emissiveReplaced = [];\n\n    this.ghost = false;\n    this.forcedEmissiveColor = null;\n    this.opacity = 1;\n\n    this.rotation = 0;\n    this.roll = 0;\n\n    this.consumeShipdata(this.ship);\n  }\n\n  setShipObject(object) {\n    this.shipObject = object;\n\n    if (this.bumpMap) {\n      object.scene.children.forEach(mesh => {\n        mesh.material.bumpMap = this.bumpMap;\n        mesh.material.bumpScale = 0.5;\n        mesh.material.bumpMap.flipY = false;\n        mesh.material.needsUpdate = true;\n      });\n    }\n\n    this.shipObject.traverse(child => {\n      child.userData = { icon: this };\n    });\n\n    object.addTo(this.mesh);\n    this.resolveShipObjectLoaded(true);\n  }\n\n  clone() {\n    return new shipObjects[this.ship.shipModel](this.ship, this.scene);\n  }\n\n  consumeShipdata(ship) {\n    this.ship = ship;\n  }\n\n  createMesh() {\n    if (this.shipZ === null) {\n      this.shipZ = this.defaultHeight;\n    }\n\n    const opacity = 0.5;\n\n    this.line = new Line(this.mesh, {\n      start: { x: 0, y: 0, z: 0 },\n      end: { x: 0, y: 0, z: this.defaultHeight },\n      width: 5,\n      color: new THREE.Color(1, 1, 1),\n      opacity: 0.1\n    });\n    this.line.hide();\n\n    this.shipSelectedSprite = new DottedCircleSprite(\n      { width: this.overlaySpriteSize, height: this.overlaySpriteSize },\n      this.defaultHeight,\n      opacity\n    );\n\n    this.ship.hexSizes.forEach(position => {\n      const sprite = new HexagonSprite(\n        coordinateConverter.fromHexToGame(position)\n      )\n        .setOpacity(0.5)\n        .setOverlayColorAlpha(1);\n      this.hexSprites.push(sprite);\n      this.hexSpriteContainer.add(sprite.mesh);\n    });\n\n    this.hexSpriteContainer.visible = false;\n\n    this.mapIcon = new ShipMapIcon(this);\n    this.mapIcon.addTo(this.mesh);\n\n    this.mesh.add(this.hexSpriteContainer);\n    /*\n    this.shipSelectedSprite.setOverlayColor(COLOR_MINE);\n    this.shipSelectedSprite.setOverlayColorAlpha(1);\n    this.mesh.add(this.shipSelectedSprite.mesh);\n    //shipSelectedSprite.hide();\n    */\n\n    /*\n    this.shipSideSprite = new CircleSprite(\n      { width: this.sideSpriteSize, height: this.sideSpriteSize },\n      0.01,\n      opacity\n    );\n    this.mesh.add(this.shipSideSprite.mesh);\n    */\n\n    /*\n    this.shipEWSprite = new ShipEWSprite(\n      { width: this.sideSpriteSize * 1.5, height: this.sideSpriteSize },\n      this.defaultHeight\n    );\n    this.mesh.add(this.shipEWSprite.mesh);\n    this.shipEWSprite.hide();\n    */\n\n    //this.mesh.name = \"ship\";\n    //this.mesh.userData = { icon: this };\n    this.scene.add(this.mesh);\n    this.hide();\n  }\n\n  create() {\n    this.createMesh();\n  }\n\n  async setPosition(x, y) {\n    if (typeof x === \"object\") {\n      y = x.y;\n      x = x.x;\n    }\n\n    this.position = { x, y, z: 0 };\n\n    if (this.mesh) {\n      this.mesh.position.set(x, y, 0);\n    }\n\n    await this.isShipObjectLoaded;\n    this.shipObject.object.position.set(0, 0, this.shipZ);\n  }\n\n  setShipZ(z) {\n    this.shipZ = z;\n    this.setPosition(this.position);\n  }\n\n  getPosition() {\n    return new Vector(this.position);\n  }\n\n  async setRotation() {\n    await this.isShipObjectLoaded;\n\n    this.shipObject.object.quaternion.setFromAxisAngle(\n      new THREE.Vector3(0, 0, 1),\n      degreeToRadian(this.rotation)\n    );\n\n    const tmpQuaternion = new THREE.Quaternion();\n    tmpQuaternion\n      .setFromAxisAngle(\n        new THREE.Vector3(1, 0, 0).normalize(),\n        degreeToRadian(this.roll)\n      )\n      .normalize();\n\n    this.shipObject.object.quaternion.multiply(tmpQuaternion);\n    this.hexSpriteContainer.rotation.z = degreeToRadian(this.rotation);\n    this.mapIcon.setRotation(this.rotation);\n  }\n\n  async setFacing(rotation) {\n    if (this.rotation === rotation) {\n      return;\n    }\n\n    this.rotation = rotation;\n    this.setRotation();\n  }\n\n  getFacing() {\n    return -this.rotation;\n  }\n\n  async setRoll(roll) {\n    if (this.roll === roll) {\n      return;\n    }\n\n    this.roll = roll;\n    this.setRotation();\n  }\n\n  getRoll() {\n    return this.roll;\n  }\n\n  async setOpacity(opacity) {\n    await this.isShipObjectLoaded;\n    this.opacity = opacity;\n    this.replaceOpacity(opacity);\n  }\n\n  hideShip() {\n    if (!this.shipObject) {\n      return;\n    }\n\n    this.shipObject.object.visible = false;\n  }\n\n  showShip() {\n    if (!this.shipObject) {\n      return;\n    }\n\n    this.shipObject.object.visible = true;\n  }\n\n  hide() {\n    if (this.hidden) {\n      return;\n    }\n\n    this.scene.remove(this.mesh);\n    this.hidden = true;\n  }\n\n  show() {\n    if (!this.hidden) {\n      return;\n    }\n\n    this.scene.add(this.mesh);\n    this.hidden = false;\n  }\n\n  setOverlayColorAlpha(alpha) {}\n\n  /*\n  getMovements(turn) {\n    return this.movements.filter(function(movement) {\n      return turn === undefined || movement.turn === turn;\n    }, this);\n  }\n*/\n\n  setScale(width, height) {}\n\n  showSideSprite(value) {}\n\n  setHighlighted(value) {}\n\n  setSideSpriteOpacity(opacity) {}\n\n  /*\n  showBDEW() {\n    var BDEW = this.ship.ew.getBDEW();\n    if (!BDEW || this.BDEWSprite) {\n      return;\n    }\n\n    var hexDistance = window.coordinateConverter.getHexDistance();\n    var dis = 20 * hexDistance;\n\n    var color = this.ship.player.isMine()\n      ? new THREE.Color(160 / 255, 250 / 255, 100 / 255)\n      : new THREE.Color(255 / 255, 157 / 255, 0 / 255);\n\n    var geometry = new THREE.CircleGeometry(dis, 64, 0);\n    var material = new THREE.MeshBasicMaterial({\n      color: color,\n      opacity: 0.2,\n      transparent: true\n    });\n    var circle = new THREE.Mesh(geometry, material);\n    circle.position.z = -1;\n    this.mesh.add(circle);\n    this.BDEWSprite = circle;\n\n    return null;\n  }\n\n  hideBDEW() {\n    this.mesh.remove(this.BDEWSprite);\n    this.BDEWSprite = null;\n  }\n\n*/\n  async replaceSocketByName(names, entity) {\n    names = [].concat(names);\n\n    await this.isShipObjectLoaded;\n\n    names.forEach(({ name, id }) => {\n      const slot = this.shipObject.scene.children.find(child => {\n        if (!child.name) {\n          return false;\n        }\n\n        if (child.name === name) {\n          return true;\n        }\n      });\n\n      if (!slot) {\n        return;\n      }\n\n      if (!entity) {\n        this.shipObject.scene.remove(slot);\n        return;\n      }\n\n      const newEntity = entity.clone().setId(id);\n      newEntity.object.position.copy(slot.position);\n      newEntity.object.rotation.copy(slot.rotation);\n      newEntity.object.quaternion.copy(slot.quaternion);\n      this.shipObject.scene.remove(slot);\n      newEntity.addTo(this.shipObject.object);\n\n      this.systemObjects.push(newEntity);\n      this.systemLocations[id] = slot.position;\n    });\n  }\n\n  async replaceOpacity(opacity) {\n    await this.isShipObjectLoaded;\n\n    this.shipObject.traverse(child => {\n      child.material.transparent = true;\n      child.material.opacity = opacity;\n      child.material.needsUpdate = true;\n    });\n  }\n\n  async revertOpacity() {\n    await this.isShipObjectLoaded;\n\n    this.shipObject.traverse(child => {\n      child.material.opacity = this.opacity;\n      child.material.needsUpdate = true;\n    });\n  }\n\n  forceEmissive(color) {\n    this.forcedEmissiveColor = color;\n    this.replaceEmissive(color);\n    this.emissiveReplaced = [];\n  }\n\n  async replaceEmissive(color) {\n    await this.isShipObjectLoaded;\n\n    this.shipObject.traverse(child => {\n      const replacement = this.emissiveReplaced.find(\n        replacement => replacement.object === child\n      );\n\n      if (!replacement) {\n        this.emissiveReplaced.push({\n          object: child,\n          color: child.material.emissive,\n          map: child.material.emissiveMap\n        });\n      }\n\n      child.material.emissiveMap = null;\n      child.material.emissive = color;\n      child.material.needsUpdate = true;\n    });\n  }\n\n  async revertEmissive() {\n    await this.isShipObjectLoaded;\n    this.shipObject.traverse(child => {\n      const replacement = this.emissiveReplaced.find(\n        replacement => replacement.object === child\n      );\n\n      if (this.forcedEmissiveColor) {\n        child.material.emissiveMap = null;\n        child.material.emissive = this.forcedEmissiveColor;\n        child.material.needsUpdate = true;\n      } else if (replacement) {\n        child.material.emissiveMap = replacement.map;\n        child.material.emissive = replacement.color;\n        child.material.needsUpdate = true;\n      }\n    });\n  }\n\n  setGhostShip(mine) {\n    this.ghost = true;\n    //this.setGhostShipEmissive(mine);\n    //this.setOpacity(0.2);\n  }\n\n  async setGhostShipEmissive(color) {\n    await this.isShipObjectLoaded;\n\n    this.forceEmissive(color);\n    this.hexSprites.forEach(hexSprite =>\n      hexSprite.setOverlayColor(new THREE.Color(color))\n    );\n  }\n\n  showMapIcon(color) {\n    this.mapIcon\n      .setOverlayColor(color)\n      .setOverlayColorAlpha(1)\n      .show();\n    this.hideShip();\n  }\n\n  hideMapIcon() {\n    this.mapIcon.hide();\n    this.showShip();\n  }\n\n  isGhostShip() {\n    return this.ghost;\n  }\n\n  render(renderPayload) {\n    this.systemObjects.forEach(object => object.render(renderPayload));\n  }\n\n  playSystemAnimation(system, name) {\n    const object = this.systemObjects.find(object => object.id === system.id);\n\n    if (!object) {\n      return;\n    }\n\n    //console.log(\"animate\", name, system);\n    object.playAnimation(name);\n  }\n\n  setSystemAnimation(system, name, time) {\n    const object = this.systemObjects.find(object => object.id === system.id);\n\n    if (!object) {\n      return;\n    }\n\n    //console.log(\"set animation\", name, system);\n    object.setAnimation(name, time);\n  }\n\n  disableSystemAnimation(system, name) {\n    const object = this.systemObjects.find(object => object.id === system.id);\n\n    if (!object) {\n      return;\n    }\n\n    //console.log(\"disable\", name, system);\n    object.disableAnimation(name);\n  }\n\n  getShipHexas() {\n    const iconPosition = this.getPosition();\n    const iconFacing = this.getFacing();\n    const hexFacing = angleToHexFacing(iconFacing);\n\n    return this.ship\n      .getIconHexas(hexFacing)\n      .map(hex => coordinateConverter.fromHexToGame(hex).add(iconPosition));\n  }\n\n  getCenter() {\n    const hexas = this.getShipHexas();\n\n    const lowest = new Vector();\n    const highest = new Vector();\n\n    hexas.forEach(position => {\n      if (position.x < lowest.x) {\n        lowest.x = position.x;\n      }\n\n      if (position.y < lowest.y) {\n        lowest.y = position.y;\n      }\n\n      if (position.x > highest.x) {\n        highest.x = position.x;\n      }\n\n      if (position.y < highest.y) {\n        highest.y = position.y;\n      }\n    });\n\n    return lowest.add(highest).multiplyScalar(0.5);\n  }\n}\n\nexport default ShipObject;\n","import ShipObject from \"../ShipObject\";\n//import * as THREE from \"three\";\n\nclass Gunship extends ShipObject {\n  constructor(ship, scene) {\n    super(ship, scene);\n    this.defaultHeight = 30;\n    this.sideSpriteSize = 50;\n    this.create();\n  }\n\n  create() {\n    super.create();\n\n    window.Loader.loadObject(\"img/3d/gunship/gunship.obj\", object => {\n      window.Loader.loadTexturesAndAssign(\n        object.children[0],\n        {},\n        null,\n        \"img/3d/gunship/normal.png\"\n      );\n\n      window.Loader.loadTexturesAndAssign(\n        object.children[1],\n        {},\n        null,\n        \"img/3d/turretNormal.png\"\n      );\n      window.Loader.loadTexturesAndAssign(\n        object.children[2],\n        {},\n        null,\n        \"img/3d/turretNormal.png\"\n      );\n      window.Loader.loadTexturesAndAssign(\n        object.children[3],\n        {},\n        null,\n        \"img/3d/turretNormal.png\"\n      );\n      window.Loader.loadTexturesAndAssign(\n        object.children[6],\n        {},\n        null,\n        \"img/3d/turretNormal.png\"\n      );\n      window.Loader.loadTexturesAndAssign(\n        object.children[7],\n        {},\n        null,\n        \"img/3d/turretNormal.png\"\n      );\n      window.Loader.loadTexturesAndAssign(\n        object.children[4],\n        {},\n        \"img/3d/diffuseThruster.png\",\n        \"img/3d/normalThruster.png\"\n      );\n      window.Loader.loadTexturesAndAssign(\n        object.children[5],\n        {},\n        \"img/3d/diffuseThruster.png\",\n        \"img/3d/normalThruster.png\"\n      );\n\n      object.scale.set(5, 5, 5);\n      this.startRotation = { x: 90, y: 90, z: 0 };\n      this.shipObject = object;\n      this.setRotation(this.rotation.x, this.rotation.y, this.rotation.z);\n      this.mesh.add(this.shipObject);\n      object.position.set(0, 0, this.shipZ);\n    });\n  }\n}\n\nexport default Gunship;\n","import ShipObject from \"../ShipObject\";\nimport { loadObject, cloneObject } from \"../../../utils/objectLoader\";\nimport * as THREE from \"three\";\n\nclass Rhino extends ShipObject {\n  constructor(ship, scene) {\n    super(ship, scene);\n    this.defaultHeight = 50;\n    this.sideSpriteSize = 30;\n    this.overlaySpriteSize = 80;\n    this.create();\n  }\n\n  async create() {\n    super.create();\n\n    const object = await loadObject(\"/img/3d/caliope/scene.gltf\");\n    //object.scale.set(2, 2, 2);\n    this.startRotation = { x: 90, y: 90, z: 0 };\n\n    this.shipObject = object;\n    this.setRotation(this.rotation.x, this.rotation.y, this.rotation.z);\n    this.mesh.add(this.shipObject);\n    object.position.set(0, 0, this.shipZ);\n\n    const radiator = await loadObject(\"/img/3d/radiator/scene.gltf\");\n    const autoCannon = await loadObject(\n      \"/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf\"\n    );\n\n    super.replaceSocketByName(\n      [\n        \"engine_pylon_top_front\",\n        \"engine_pylon_left_front\",\n        \"engine_pylon_right_front\"\n      ],\n      radiator\n    );\n\n    super.replaceSocketByName(\n      [\n        \"engine_pylon_top\",\n        \"engine_pylon_left\",\n        \"engine_pylon_right\",\n        \"main_hull_front_left_bottom\",\n        \"main_hull_front_left_top\",\n        \"main_hull_front_right_bottom\",\n        \"main_hull_front_right_top\"\n      ],\n      autoCannon\n    );\n\n    super.replaceSocketByName(\n      [\n        \"font_hull_bottom\",\n        \"font_hull_top\",\n        \"main_hull_front_left_side\",\n        \"main_hull_front_right_side\"\n      ],\n      await loadObject(\n        \"/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf\"\n      )\n    );\n\n    super.replaceSocketByName(\n      [\"thruster_top\", \"thruster_right\", \"thruster_left\"],\n      await loadObject(\"/img/3d/systems/thrusters/5mThruster/scene.gltf\")\n    );\n\n    const shipMaterial = this.shipObject.children[0].material;\n\n    shipMaterial.emissive = new THREE.Color(1, 1, 1);\n    shipMaterial.emissiveMap = new THREE.TextureLoader().load(\n      \"/img/3d/caliope/emissiveMap.png\"\n    );\n    shipMaterial.emissiveMap.flipY = false;\n\n    /*\n    this.shipObject.traverse(o => {\n      if (o.isMesh) {\n        o.material.emissive = new THREE.Color(1, 1, 1);\n        o.material.emissiveMap = new THREE.TextureLoader().load(\n          \"/img/3d/caliope/baseColor.png\"\n        );\n        o.material.emissiveMap.flipY = false;\n\n\n      }\n    });\n\n    */\n    console.log(object);\n  }\n\n  render() {\n    super.render();\n\n    if (this.shipObject) {\n      this.shipObject.rotation.y += 0.006;\n    }\n  }\n}\n\nexport default Rhino;\n","import ShipObject from \"../ShipObject\";\nimport * as THREE from \"three\";\n\nclass Capital extends ShipObject {\n  constructor(ship, scene) {\n    super(ship, scene);\n    this.defaultHeight = 50;\n    this.sideSpriteSize = 50;\n    this.create();\n  }\n\n  create() {\n    super.create();\n\n    window.Loader.loadObject(\"img/3d/capital/capital.obj\", object => {\n      window.Loader.loadTexturesAndAssign(\n        object.children[0],\n        {\n          normalScale: new THREE.Vector2(0.5, 0.5),\n          shininess: 10,\n          color: new THREE.Color(1, 1, 1)\n        },\n        \"img/3d/capital/diffuse.png\",\n        \"img/3d/capital/normalEdit.png\"\n      );\n\n      object.scale.set(3, 3, 3);\n      this.startRotation = { x: 90, y: 90, z: 0 };\n      this.shipObject = object;\n      this.setRotation(this.rotation.x, this.rotation.y, this.rotation.z);\n      this.mesh.add(this.shipObject);\n      object.position.set(0, 0, this.shipZ);\n    });\n  }\n}\n\nexport default Capital;\n","import ShipObject from \"../ShipObject\";\r\nimport { loadObject3d } from \"../../object3d/Object3d\";\r\nimport * as THREE from \"three\";\r\n\r\nconst textureLoader = new THREE.TextureLoader();\r\n\r\nclass Haka extends ShipObject {\r\n  constructor(ship, scene) {\r\n    super(ship, scene);\r\n    this.defaultHeight = 80;\r\n    this.sideSpriteSize = 30;\r\n    this.overlaySpriteSize = 80;\r\n    this.create();\r\n  }\r\n\r\n  async create() {\r\n    super.create();\r\n    const object = await loadObject3d(\"/img/3d/ships/uc/haka/scene.gltf\");\r\n    this.bumpMap = await textureLoader.load(\r\n      \"/img/3d/ships/uc/haka/heightMap.png\"\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"socket_middle_pylon_top\", id: 602 },\r\n        { name: \"socket_front_top_1\", id: 606 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/coilgun/turreted32GwRailgun/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [{ name: \"socket_middle_pylon_bottom\", id: 202 }],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/railgun/2x140mmRailgunTurret/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"socket_main_pylon_left\", id: 118 },\r\n        { name: \"socket_main_pylon_right\", id: 119 },\r\n        { name: \"socket_front_top_2\", id: 603 },\r\n        { name: \"socket_front_top_3\", id: 604 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/railgun/140mmRailgunTurret/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"socket_engine_1\", id: 123 },\r\n        { name: \"socket_engine_2\", id: 123 },\r\n        { name: \"socket_engine_3\", id: 123 },\r\n        { name: \"socket_engine_4\", id: 123 }\r\n      ],\r\n      await loadObject3d(\"/img/3d/systems/thrusters/10mThruster/scene.gltf\")\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"socket_engine_pylon_1\", id: 550 },\r\n        { name: \"socket_engine_pylon_2\", id: 551 },\r\n        { name: \"socket_engine_pylon_3\", id: 554 },\r\n        { name: \"socket_engine_pylon_4\", id: 555 },\r\n        { name: \"socket_engine_pylon_5\", id: 352 },\r\n        { name: \"socket_engine_pylon_6\", id: 353 },\r\n        { name: \"socket_engine_pylon_7\", id: 356 },\r\n        { name: \"socket_engine_pylon_8\", id: 357 },\r\n        { name: \"socket_engine_pylon_9\", id: 451 },\r\n        { name: \"socket_engine_pylon_10\", id: 456 },\r\n        { name: \"socket_engine_pylon_11\", id: 450 },\r\n        { name: \"socket_engine_pylon_12\", id: 452 },\r\n        { name: \"socket_engine_pylon_13\", id: 457 },\r\n        { name: \"socket_engine_pylon_14\", id: 455 },\r\n        { name: \"socket_engine_pylon_15\", id: 453 },\r\n        { name: \"socket_engine_pylon_16\", id: 454 },\r\n        { name: \"socket_main_right_1\", id: 114 },\r\n        { name: \"socket_main_right_2\", id: 115 },\r\n        { name: \"socket_main_left_1\", id: 116 },\r\n        { name: \"socket_main_left_2\", id: 117 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"socket_radiator_5\", id: 301 },\r\n        { name: \"socket_radiator_6\", id: 302 },\r\n        { name: \"socket_radiator_7\", id: 502 },\r\n        { name: \"socket_radiator_8\", id: 503 }\r\n      ],\r\n      await loadObject3d(\"/img/3d/systems/radiators/10x40/scene.gltf\")\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"socket_radiator_1\", id: 416 },\r\n        { name: \"socket_radiator_2\", id: 216 },\r\n        { name: \"socket_radiator_3\", id: 416 },\r\n        { name: \"socket_radiator_4\", id: 216 }\r\n      ],\r\n      null\r\n    );\r\n\r\n    /*\r\n     new systems.PDC30mm({ id: 450 }, { start: 160, end: 340 }),\r\n      new systems.PDC30mm({ id: 451 }, { start: 160, end: 340 }),\r\n\r\n      new systems.PDC30mm({ id: 452 }, { start: 40, end: 200 }),\r\n      new systems.PDC30mm({ id: 453 }, { start: 40, end: 200 }),\r\n\r\n      new systems.PDC30mm({ id: 454 }, { start: 160, end: 340 }),\r\n      new systems.PDC30mm({ id: 455 }, { start: 160, end: 340 }),\r\n\r\n      new systems.PDC30mm({ id: 456 }, { start: 40, end: 200 }),\r\n      new systems.PDC30mm({ id: 457 }, { start: 40, end: 200 })\r\n      */\r\n\r\n    this.setShipObject(object);\r\n  }\r\n}\r\n\r\nexport default Haka;\r\n","import ShipObject from \"../ShipObject\";\r\nimport { loadObject3d } from \"../../object3d/Object3d\";\r\nimport * as THREE from \"three\";\r\n\r\nconst textureLoader = new THREE.TextureLoader();\r\n\r\nclass Caliope extends ShipObject {\r\n  constructor(ship, scene) {\r\n    super(ship, scene);\r\n    this.defaultHeight = 80;\r\n    this.sideSpriteSize = 30;\r\n    this.overlaySpriteSize = 80;\r\n    this.create();\r\n  }\r\n\r\n  async create() {\r\n    super.create();\r\n    const object = await loadObject3d(\"/img/3d/caliope/scene.gltf\");\r\n    this.bumpMap = await textureLoader.load(\"/img/3d/caliope/heightMap.png\");\r\n\r\n    object.object.position.set(0, 0, this.defaultHeight);\r\n\r\n    const radiator = await loadObject3d(\"/img/3d/radiator/scene.gltf\");\r\n    const autoCannon = await loadObject3d(\r\n      \"/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf\"\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"engine_pylon_top_front\", id: 412 },\r\n        { name: \"engine_pylon_left_front\", id: 501 },\r\n        { name: \"engine_pylon_right_front\", id: 301 }\r\n      ],\r\n      radiator\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"engine_pylon_top\", id: 421 },\r\n        { name: \"engine_pylon_left\", id: 521 },\r\n        { name: \"engine_pylon_right\", id: 321 }\r\n      ],\r\n      autoCannon\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"main_hull_front_left_bottom\", id: 603 },\r\n        { name: \"main_hull_front_left_top\", id: 604 },\r\n        { name: \"main_hull_front_right_bottom\", id: 203 },\r\n        { name: \"main_hull_front_right_top\", id: 204 }\r\n      ],\r\n      autoCannon\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"front_hull_right_side\", id: 213 },\r\n        { name: \"front_hull_left_side\", id: 612 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/railgun/2x140mmRailgunTurret/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"font_hull_bottom\", id: 115 },\r\n        { name: \"font_hull_top\", id: 114 },\r\n        { name: \"main_hull_front_left_side\", id: 602 },\r\n        { name: \"main_hull_front_right_side\", id: 202 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"thruster_top\", id: 123 },\r\n        { name: \"thruster_right\", id: 123 },\r\n        { name: \"thruster_left\", id: 123 }\r\n      ],\r\n      await loadObject3d(\"/img/3d/systems/thrusters/5mThruster/scene.gltf\")\r\n    );\r\n\r\n    this.setShipObject(object);\r\n\r\n    /*\r\n    const shipMaterial = this.shipObject.children[0].material;\r\n\r\n    shipMaterial.emissive = new THREE.Color(1, 1, 1);\r\n    shipMaterial.emissiveMap = new THREE.TextureLoader().load(\r\n      \"/img/3d/caliope/emissiveMap.png\"\r\n    );\r\n    shipMaterial.emissiveMap.flipY = false;\r\n*/\r\n    /*\r\n    this.shipObject.traverse(o => {\r\n      if (o.isMesh) {\r\n        o.material.emissive = new THREE.Color(1, 1, 1);\r\n        o.material.emissiveMap = new THREE.TextureLoader().load(\r\n          \"/img/3d/caliope/baseColor.png\"\r\n        );\r\n        o.material.emissiveMap.flipY = false;\r\n\r\n\r\n      }\r\n    });\r\n\r\n    */\r\n  }\r\n}\r\n\r\nexport default Caliope;\r\n","import ShipObject from \"../ShipObject\";\r\nimport { loadObject3d } from \"../../object3d/Object3d\";\r\nimport * as THREE from \"three\";\r\n\r\nconst textureLoader = new THREE.TextureLoader();\r\n\r\nclass Fulcrum extends ShipObject {\r\n  constructor(ship, scene) {\r\n    super(ship, scene);\r\n    this.defaultHeight = 100;\r\n    this.sideSpriteSize = 30;\r\n    this.overlaySpriteSize = 80;\r\n    this.create();\r\n  }\r\n\r\n  async create() {\r\n    super.create();\r\n    const object = await loadObject3d(\r\n      \"/img/3d/ships/protectorate/Fulcrum/scene.gltf\"\r\n    );\r\n    this.bumpMap = await textureLoader.load(\r\n      \"/img/3d/ships/protectorate/Fulcrum/heightMap.png\"\r\n    );\r\n\r\n    object.object.position.set(0, 0, this.defaultHeight);\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"rear_hull_radiator_left\", id: 416 },\r\n        { name: \"rear_hull_radiator_right\", id: 216 },\r\n        { name: \"rear_hull_radiator_bottom\", id: 316 }\r\n      ],\r\n      await loadObject3d(\"/img/3d/systems/radiators/5x40mSail/scene.gltf\")\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [{ name: \"front_plate_center\", id: 102 }],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/coilgun/fixed22GwCoilgun/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"front_hull_pdc_bottom\", id: 14 },\r\n        { name: \"front_hull_pdc_left\", id: 13 },\r\n        { name: \"front_hull_pdc_right\", id: 15 },\r\n        { name: \"rear_hull_pdc_top\", id: 214 },\r\n        { name: \"rear_hull_pdc_right\", id: 215 },\r\n        { name: \"rear_hull_pdc_left\", id: 213 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [{ name: \"thruster\", id: 123 }],\r\n      await loadObject3d(\"/img/3d/systems/thrusters/5mThruster/scene.gltf\")\r\n    );\r\n\r\n    this.setShipObject(object);\r\n  }\r\n}\r\n\r\nexport default Fulcrum;\r\n","import ShipObject from \"../ShipObject\";\r\nimport { loadObject3d } from \"../../object3d/Object3d\";\r\nimport * as THREE from \"three\";\r\n\r\nclass Mouros extends ShipObject {\r\n  constructor(ship, scene) {\r\n    super(ship, scene);\r\n    this.defaultHeight = 10;\r\n    this.sideSpriteSize = 30;\r\n    this.overlaySpriteSize = 80;\r\n    this.create();\r\n  }\r\n\r\n  async create() {\r\n    super.create();\r\n    const object = await loadObject3d(\r\n      \"/img/3d/ships/protectorate/Mouros/scene.gltf\"\r\n    );\r\n\r\n    //this.startRotation = { x: 90, y: 90, z: 0 };\r\n\r\n    this.setRotation(this.rotation.x, this.rotation.y, this.rotation.z);\r\n\r\n    object.object.position.set(0, 0, this.defaultHeight);\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"Middle_hull_depress_top\", id: 123 },\r\n        { name: \"Middle_hull_depress_left\", id: 123 },\r\n        { name: \"Middle_hull_depress_right\", id: 123 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf\"\r\n        //\"/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"Middle_hull_frame_top\", id: 123 },\r\n        { name: \"Middle_hull_frame_left\", id: 123 },\r\n        { name: \"Middle_hull_frame_right\", id: 123 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/140mmCannonTurret/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"railgun_turret_mount_right\", id: 123 },\r\n        ,\r\n        { name: \"railgun_turret_mount_left\", id: 123 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/coilgun/turreted32GwRailgun/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"thruster_1\", id: 123 },\r\n        { name: \"thruster_6\", id: 123 },\r\n        { name: \"thruster_2\", id: 123 },\r\n        { name: \"thruster_4\", id: 123 },\r\n        { name: \"thruster_3\", id: 123 },\r\n        { name: \"thruster_5\", id: 123 }\r\n      ],\r\n      await loadObject3d(\"/img/3d/systems/thrusters/8mThruster/scene.gltf\")\r\n    );\r\n\r\n    this.setShipObject(object);\r\n  }\r\n}\r\n\r\nexport default Mouros;\r\n","import ShipObject from \"../ShipObject\";\r\nimport { loadObject3d } from \"../../object3d/Object3d\";\r\nimport * as THREE from \"three\";\r\n\r\nclass Impetous extends ShipObject {\r\n  constructor(ship, scene) {\r\n    super(ship, scene);\r\n    this.defaultHeight = 15;\r\n    this.sideSpriteSize = 30;\r\n    this.overlaySpriteSize = 80;\r\n    this.create();\r\n  }\r\n\r\n  async create() {\r\n    super.create();\r\n    const object = await loadObject3d(\r\n      \"/img/3d/ships/federation/Impetous/scene.gltf\"\r\n    );\r\n\r\n    //object.scale.set(2, 2, 2);\r\n    this.startRotation = { x: 90, y: 90, z: 0 };\r\n\r\n    this.setRotation(this.rotation.x, this.rotation.y, this.rotation.z);\r\n\r\n    object.object.position.set(0, 0, this.defaultHeight);\r\n    /*\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"Middle_hull_depress_top\", id: 123 },\r\n        { name: \"Middle_hull_frame_top\", id: 123 },\r\n        { name: \"Middle_hull_depress_left\", id: 123 },\r\n        { name: \"Middle_hull_depress_right\", id: 123 },\r\n        { name: \"Middle_hull_frame_left\", id: 123 },\r\n        { name: \"Middle_hull_frame_right\", id: 123 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"railgun_turret_mount_right\", id: 123 },\r\n        ,\r\n        { name: \"railgun_turret_mount_left\", id: 123 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/coilgun/turreted64GwRailgun/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    */\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"engine_mount_2\", id: 123 },\r\n        { name: \"engine_mount_3\", id: 123 },\r\n        { name: \"engine_mount_4\", id: 123 },\r\n        { name: \"engine_mount_5\", id: 123 }\r\n      ],\r\n      await loadObject3d(\"/img/3d/systems/thrusters/10mThruster/scene.gltf\")\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"front-wing-left-mount1\", id: 501 },\r\n        { name: \"front-wing-left-mount2\", id: 502 },\r\n        { name: \"front-wing-left-mount3\", id: 503 },\r\n        { name: \"front-wing-right-mount1\", id: 101 },\r\n        { name: \"front-wing-right-mount2\", id: 102 },\r\n        { name: \"front-wing-right-mount3\", id: 103 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/2x30mmPDC/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [{ name: \"middle-top-mount1\", id: 623 }],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/coilgun/turreted64GwRailgun/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"front-wing-left-top-mount1\", id: 623 },\r\n        { name: \"front-wing-left-bottom-mount1\", id: 623 },\r\n        { name: \"aft-wing-left-top-mount1\", id: 623 },\r\n        { name: \"aft-wing-left-bottom-mount1\", id: 623 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/2x140mmCannonTurret/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    super.replaceSocketByName(\r\n      [\r\n        { name: \"front-wing-left-top-mount2\", id: 623 },\r\n        { name: \"front-wing-left-bottom-mount2\", id: 623 }\r\n      ],\r\n      await loadObject3d(\r\n        \"/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf\"\r\n      )\r\n    );\r\n\r\n    this.setShipObject(object);\r\n  }\r\n}\r\n\r\nexport default Impetous;\r\n","import * as shipObjects from \"../ships\";\r\nimport { distance } from \"../../../../../model/utils/math\";\r\n\r\nconst buildShipArray = iconsAsObject => {\r\n  return Object.keys(iconsAsObject).map(key => iconsAsObject[key]);\r\n};\r\n\r\nconst createIcon = (ship, scene) => {\r\n  return new shipObjects[ship.shipModel](ship, scene);\r\n};\r\n\r\nconst createGhostShipIcon = (ship, scene, currentUser) => {\r\n  const icon = new shipObjects[ship.shipModel](ship, scene);\r\n  icon.setGhostShip(ship.player.is(currentUser));\r\n  icon.hide();\r\n\r\n  return icon;\r\n};\r\n\r\nclass ShipIconContainer {\r\n  constructor(scene, currentUser) {\r\n    this.iconsAsObject = {};\r\n    this.iconsAsArray = [];\r\n    this.scene = scene;\r\n    this.currentUser = currentUser;\r\n\r\n    this.ghostShipIcons = [];\r\n  }\r\n\r\n  shipsLoaded() {\r\n    return Promise.all(this.iconsAsArray.map(icon => icon.isShipObjectLoaded));\r\n  }\r\n\r\n  getGhostShipIconByShip(ship) {\r\n    let icon = this.ghostShipIcons.find(icon => icon.ship === ship);\r\n\r\n    if (!icon) {\r\n      icon = createGhostShipIcon(ship, this.scene, this.currentUser);\r\n      this.ghostShipIcons.push(icon);\r\n    }\r\n\r\n    return icon;\r\n  }\r\n\r\n  update(gamedata) {\r\n    gamedata.ships.getShips().forEach(ship => {\r\n      if (!this.hasIcon(ship.id)) {\r\n        this.iconsAsObject[ship.id] = createIcon(ship, this.scene);\r\n      } else {\r\n        this.iconsAsObject[ship.id].consumeShipdata(ship);\r\n      }\r\n\r\n      const ghost = this.ghostShipIcons.find(icon => icon.ship.id === ship.id);\r\n      if (ghost) {\r\n        ghost.consumeShipdata(ship);\r\n      }\r\n    });\r\n\r\n    this.iconsAsArray = buildShipArray(this.iconsAsObject);\r\n  }\r\n\r\n  getByShip(ship) {\r\n    return this.iconsAsObject[ship.id];\r\n  }\r\n\r\n  getById(id) {\r\n    return this.iconsAsObject[id];\r\n  }\r\n\r\n  onEvent(name, payload) {\r\n    var target = this[\"on\" + name];\r\n    if (target && typeof target === \"function\") {\r\n      target.call(this, payload);\r\n    }\r\n  }\r\n\r\n  onZoomEvent(payload) {\r\n    var zoom = payload.zoom;\r\n\r\n    var alpha = zoom > 2 ? zoom - 2 : 0;\r\n    if (alpha > 1) {\r\n      alpha = 1;\r\n    }\r\n    this.iconsAsArray.forEach(function(icon) {\r\n      icon.setOverlayColorAlpha(alpha);\r\n    });\r\n  }\r\n\r\n  getArray() {\r\n    return this.iconsAsArray;\r\n  }\r\n\r\n  hasIcon(shipId) {\r\n    return Boolean(this.iconsAsObject[shipId]);\r\n  }\r\n\r\n  getIconById(shipId) {\r\n    return this.iconsAsObject[shipId];\r\n  }\r\n\r\n  getIconsInProximity(payload) {\r\n    var hexHeight = this.coordinateConverter.getHexHeightViewport();\r\n    var currentDistance = hexHeight / 10;\r\n\r\n    var icons = [];\r\n\r\n    if (currentDistance < 30) {\r\n      icons = this.getIconsInSameHex(payload.hex);\r\n    } else {\r\n      var closest = null;\r\n      var closestDistance = null;\r\n\r\n      this.iconsAsArray.forEach(function(shipIcon) {\r\n        var currentDistance = distance(shipIcon.getPosition(), payload.game);\r\n\r\n        if (\r\n          currentDistance < 10 &&\r\n          (!closest || currentDistance < closestDistance)\r\n        ) {\r\n          closest = shipIcon;\r\n          closestDistance = currentDistance;\r\n        }\r\n      }, this);\r\n\r\n      if (closest) icons.push(closest);\r\n    }\r\n\r\n    return icons;\r\n  }\r\n\r\n  getIconsInSameHex(hex) {\r\n    return this.iconsAsArray.filter(function(shipIcon) {\r\n      return this.coordinateConverter\r\n        .fromGameToHex(shipIcon.getPosition())\r\n        .equals(hex);\r\n    }, this);\r\n  }\r\n\r\n  getFinalMovementInSameHex(hex) {\r\n    return this.iconsAsArray.filter(function(shipIcon) {\r\n      return (\r\n        !shipIcon.ship.isDestroyed() &&\r\n        shipIcon.getLastMovement().position.equals(hex)\r\n      );\r\n    }, this);\r\n  }\r\n\r\n  render(renderPayload) {\r\n    this.iconsAsArray.forEach(icon => icon.render(renderPayload));\r\n  }\r\n}\r\n\r\nexport default ShipIconContainer;\r\n","import * as THREE from \"three\";\r\nimport Line from \"../Line\";\r\nimport LineSprite from \"../sprite/LineSprite\";\r\nimport {\r\n  COLOR_OEW_FRIENDLY,\r\n  COLOR_OEW_ENEMY,\r\n  COLOR_FRIENDLY_HIGHLIGHT\r\n} from \"../../../../../model/gameConfig.mjs\";\r\n\r\nclass OEWIndicator {\r\n  constructor(shipIcon, targetIcon, targetGhost, amount, mine, scene) {\r\n    this.scene = scene;\r\n    this.shipIcon = shipIcon;\r\n    this.targetIcon = targetIcon;\r\n    this.targetGhost = targetGhost;\r\n    this.amount = amount;\r\n    this.mine = mine;\r\n\r\n    this.visible = false;\r\n\r\n    this.targetPosition = this.targetGhost.hidden\r\n      ? targetIcon.getPosition()\r\n      : targetGhost.getPosition();\r\n\r\n    this.shipPosition = this.shipIcon.getPosition();\r\n\r\n    this.line = this.createLine();\r\n  }\r\n\r\n  createLine() {\r\n    const line = new LineSprite(\r\n      this.shipIcon.getPosition().setZ(this.getZ()),\r\n      this.targetPosition.setZ(this.getZ()),\r\n      this.amount * 1 + 5,\r\n      {\r\n        color: this.mine ? COLOR_OEW_FRIENDLY : COLOR_OEW_ENEMY,\r\n        opacity: 0.5,\r\n        type: \"dashed-circle\",\r\n        textureSize: this.amount * 1 + 5,\r\n        //minFilter: THREE.NearestFilter,\r\n        pulseAmount: 1\r\n      }\r\n    );\r\n\r\n    line.addTo(this.scene);\r\n\r\n    return line;\r\n  }\r\n\r\n  getZ() {\r\n    return 0;\r\n  }\r\n\r\n  remove() {\r\n    this.line.destroy();\r\n  }\r\n\r\n  render(zoom) {\r\n    if (!this.visible) {\r\n      return;\r\n    }\r\n\r\n    //this.line.render(zoom);\r\n\r\n    const newTargetPosition = this.targetGhost.hidden\r\n      ? this.targetIcon.getPosition()\r\n      : this.targetGhost.getPosition();\r\n    const newShipPosition = this.shipIcon.getPosition();\r\n    if (\r\n      !this.shipPosition.equals(newShipPosition) ||\r\n      !this.targetPosition.equals(newTargetPosition)\r\n    ) {\r\n      this.shipPosition = newShipPosition;\r\n      this.targetPosition = newTargetPosition;\r\n      this.line.update(\r\n        this.shipPosition.setZ(this.getZ()),\r\n        this.targetPosition.setZ(this.getZ()),\r\n        this.amount * 1 + 5\r\n      );\r\n\r\n      if (this.line && this.line.updateTextureSize) {\r\n        this.line.updateTextureSize(this.amount * 1 + 5);\r\n      }\r\n    }\r\n  }\r\n\r\n  update(ship, amount) {\r\n    this.ship = ship;\r\n\r\n    if (this.amount !== amount) {\r\n      this.amount = amount;\r\n      this.line.update(\r\n        this.shipPosition.setZ(this.getZ()),\r\n        this.targetPosition.setZ(this.getZ()),\r\n        this.amount * 1 + 5\r\n      );\r\n\r\n      if (this.line && this.line.updateTextureSize) {\r\n        this.line.updateTextureSize(this.amount * 1 + 5);\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  show() {\r\n    this.visible = true;\r\n    this.line.show();\r\n  }\r\n\r\n  hide() {\r\n    this.visible = false;\r\n    this.line.hide();\r\n  }\r\n}\r\n\r\nexport default OEWIndicator;\r\n","import OEWIndicator from \"./OEWIndicator\";\r\n\r\nclass ShipEWIndicators {\r\n  constructor(ship, shipIconContainer, currentUser, scene) {\r\n    this.ship = ship;\r\n    this.icon = shipIconContainer.getByShip(ship);\r\n    this.shipIconContainer = shipIconContainer;\r\n    this.currentUser = currentUser;\r\n    this.scene = scene;\r\n    this.oew = [];\r\n\r\n    this.update(this.ship);\r\n  }\r\n\r\n  update(ship, useGhost) {\r\n    this.ship = ship;\r\n    this.oew = this.createOEW(useGhost);\r\n\r\n    return this;\r\n  }\r\n\r\n  show() {\r\n    this.oew.forEach(oew => oew.show());\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.oew.forEach(oew => oew.hide());\r\n    return this;\r\n  }\r\n\r\n  isShip(ship) {\r\n    return this.ship.id === ship.id;\r\n  }\r\n\r\n  render(zoom) {\r\n    this.oew.forEach(oew => oew.render(zoom));\r\n  }\r\n\r\n  createOEW() {\r\n    const old = this.oew;\r\n    const newOew = this.ship.electronicWarfare.getAllOew().map(ewEntry => {\r\n      const targetIcon = this.shipIconContainer.getById(ewEntry.targetShipId);\r\n      const targetGhost = this.shipIconContainer.getGhostShipIconByShip(\r\n        targetIcon.ship\r\n      );\r\n      let indicator = this.oew.find(oew => oew.targetIcon === targetIcon);\r\n\r\n      if (!indicator) {\r\n        indicator = new OEWIndicator(\r\n          this.icon,\r\n          targetIcon,\r\n          targetGhost,\r\n          ewEntry.amount,\r\n          this.ship.player.is(this.currentUser),\r\n          this.scene\r\n        );\r\n      }\r\n\r\n      return indicator.update(this.ship, ewEntry.amount);\r\n    });\r\n\r\n    old\r\n      .filter(indicator =>\r\n        newOew.every(indicatorNew => indicatorNew !== indicator)\r\n      )\r\n      .forEach(indicator => indicator.remove());\r\n\r\n    return newOew;\r\n  }\r\n}\r\n\r\nexport default ShipEWIndicators;\r\n","import * as THREE from \"three\";\r\nimport Line from \"../Line\";\r\nimport OEWIndicator from \"./OEWIndicator\";\r\n\r\nconst COLOR_OEW_FRIENDLY = new THREE.Color(100 / 255, 90 / 255, 250 / 255);\r\nconst COLOR_OEW_ENEMY = new THREE.Color(255 / 255, 40 / 255, 40 / 255);\r\n\r\nclass CurrentOEWIndicator extends OEWIndicator {\r\n  createLine() {\r\n    return new Line(this.scene, {\r\n      start: { ...this.shipIcon.getPosition(), z: this.getZ() },\r\n      end: { ...this.targetPosition, z: this.getZ() },\r\n      width: this.amount * 1 + 5,\r\n      color: this.mine ? COLOR_OEW_FRIENDLY : COLOR_OEW_ENEMY,\r\n      opacity: 0.1,\r\n      pulseAmount: 1,\r\n      dashSize: 0\r\n    });\r\n  }\r\n\r\n  getZ() {\r\n    return 0;\r\n    return this.mine ? 15 : 30;\r\n  }\r\n}\r\n\r\nexport default CurrentOEWIndicator;\r\n","import CurrentOEWIndicator from \"./CurrentOEWIndicator\";\r\n\r\nclass ShipCurrentEWIndicators {\r\n  constructor(ship, shipIconContainer, currentUser, scene) {\r\n    this.ship = ship;\r\n    this.icon = shipIconContainer.getByShip(ship);\r\n    this.shipIconContainer = shipIconContainer;\r\n    this.currentUser = currentUser;\r\n    this.scene = scene;\r\n    this.oew = [];\r\n\r\n    this.update(this.ship);\r\n  }\r\n\r\n  update(ship, useGhost) {\r\n    this.ship = ship;\r\n    this.oew = this.createOEW(useGhost);\r\n\r\n    return this;\r\n  }\r\n\r\n  show() {\r\n    this.oew.forEach(oew => oew.show());\r\n    return this;\r\n  }\r\n\r\n  hide() {\r\n    this.oew.forEach(oew => oew.hide());\r\n    return this;\r\n  }\r\n\r\n  isShip(ship) {\r\n    return this.ship.id === ship.id;\r\n  }\r\n\r\n  render(zoom) {\r\n    this.oew.forEach(oew => oew.render(zoom));\r\n  }\r\n\r\n  createOEW() {\r\n    const old = this.oew;\r\n    const newOew = this.ship.electronicWarfare.inEffect\r\n      .getAllOew()\r\n      .map(ewEntry => {\r\n        const targetIcon = this.shipIconContainer.getById(ewEntry.targetShipId);\r\n        const targetGhost = this.shipIconContainer.getGhostShipIconByShip(\r\n          targetIcon.ship\r\n        );\r\n        let indicator = this.oew.find(oew => oew.targetIcon === targetIcon);\r\n\r\n        if (!indicator) {\r\n          indicator = new CurrentOEWIndicator(\r\n            this.icon,\r\n            targetIcon,\r\n            targetGhost,\r\n            ewEntry.amount,\r\n            this.ship.player.is(this.currentUser),\r\n            this.scene\r\n          );\r\n        }\r\n\r\n        return indicator.update(this.ship, ewEntry.amount);\r\n      });\r\n\r\n    old\r\n      .filter(indicator =>\r\n        newOew.every(indicatorNew => indicatorNew !== indicator)\r\n      )\r\n      .forEach(indicator => indicator.remove());\r\n\r\n    return newOew;\r\n  }\r\n}\r\n\r\nexport default ShipCurrentEWIndicators;\r\n","import * as THREE from \"three\";\r\nimport ShipEWIndicators from \"./ShipEWIndicators\";\r\nimport ShipCurrentEWIndicators from \"./ShipCurrentEWIndicators\";\r\n\r\nconst COLOR_OEW_DIST = new THREE.Color(255 / 255, 157 / 255, 0 / 255);\r\nconst COLOR_SDEW = new THREE.Color(109 / 255, 189 / 255, 255 / 255);\r\nconst COLOR_OEW_SOEW = new THREE.Color(1, 1, 1);\r\n\r\nclass ElectronicWarfareIndicatorService {\r\n  constructor(scene, iconContainer, currentUser) {\r\n    this.scene = scene;\r\n    this.shipIconContainer = iconContainer;\r\n    this.currentUser = currentUser;\r\n\r\n    this.indicators = [];\r\n    this.currentIndicators = [];\r\n  }\r\n\r\n  getCurrentIndicators(ship) {\r\n    let indicator = this.currentIndicators.find(indicator =>\r\n      indicator.isShip(ship)\r\n    );\r\n\r\n    if (!indicator) {\r\n      indicator = new ShipCurrentEWIndicators(\r\n        ship,\r\n        this.shipIconContainer,\r\n        this.currentUser,\r\n        this.scene\r\n      );\r\n\r\n      this.currentIndicators.push(indicator);\r\n    }\r\n\r\n    return indicator;\r\n  }\r\n\r\n  getIndicators(ship) {\r\n    let indicator = this.indicators.find(indicator => indicator.isShip(ship));\r\n\r\n    if (!indicator) {\r\n      indicator = new ShipEWIndicators(\r\n        ship,\r\n        this.shipIconContainer,\r\n        this.currentUser,\r\n        this.scene\r\n      );\r\n\r\n      this.indicators.push(indicator);\r\n    }\r\n\r\n    return indicator;\r\n  }\r\n\r\n  render(zoom) {\r\n    this.indicators.forEach(indicator => indicator.render(zoom));\r\n    this.currentIndicators.forEach(indicator => indicator.render(zoom));\r\n  }\r\n\r\n  showCurrentForShip(ship) {\r\n    this.getCurrentIndicators(ship)\r\n      .update(ship)\r\n      .show();\r\n  }\r\n\r\n  hideCurrentForShip(ship) {\r\n    this.getCurrentIndicators(ship)\r\n      .update(ship)\r\n      .hide();\r\n  }\r\n\r\n  showForShip(ship) {\r\n    this.getIndicators(ship)\r\n      .update(ship)\r\n      .show();\r\n  }\r\n\r\n  hideForShip(ship) {\r\n    this.getIndicators(ship)\r\n      .update(ship)\r\n      .hide();\r\n  }\r\n\r\n  hideAll() {\r\n    this.indicators.forEach(indicators => indicators.hide());\r\n  }\r\n\r\n  hideAllCurrent() {\r\n    this.currentIndicators.forEach(indicators => indicators.hide());\r\n  }\r\n}\r\n\r\nexport default ElectronicWarfareIndicatorService;\r\n","import { loadObject } from \"../utils/objectLoader\";\r\nimport * as THREE from \"three\";\r\n\r\nimport HexagonMath from \"../../../../model/utils/HexagonMath\";\r\n\r\nclass TerrainRenderer {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n    this.terrain = null;\r\n    this.terrainObjects = [];\r\n  }\r\n\r\n  init() {}\r\n\r\n  update(terrain) {\r\n    //TODO: This creates new objects every time gamedata updates.\r\n    return;\r\n\r\n    this.terrain = terrain;\r\n\r\n    this.terrainObjects = this.terrain.getEntities().forEach(entity => ({\r\n      entity,\r\n      object: this.createObject(entity)\r\n    }));\r\n  }\r\n\r\n  async createObject(entity) {\r\n    const object = await loadObject(\"/img/3d/sphere/scene.gltf\");\r\n\r\n    const material = object.children[0].material;\r\n\r\n    material.emissive = new THREE.Color(1, 1, 1);\r\n\r\n    object.position.set(0, 0, 0);\r\n    const scale = HexagonMath.getHexWidth() * entity.diameter;\r\n    object.scale.set(scale, scale, scale);\r\n    this.scene.add(object);\r\n  }\r\n\r\n  render() {}\r\n}\r\n\r\nexport default TerrainRenderer;\r\n","class ShipWindowManager {\r\n  constructor(uiState, movementService) {\r\n    this.uiState = uiState;\r\n    this.movementService = movementService;\r\n    this.ships = [];\r\n  }\r\n\r\n  open(ship) {\r\n    this.ships = this.ships.filter(function(otherShip) {\r\n      return otherShip.player.user !== ship.player.user;\r\n    });\r\n\r\n    if (!this.ships.includes(ship)) {\r\n      this.ships.push(ship);\r\n    }\r\n\r\n    this.uiState.setShipWindows({\r\n      ships: this.ships,\r\n      movementService: this.movementService\r\n    });\r\n  }\r\n\r\n  close(ship) {\r\n    this.ships = this.ships.filter(function(openShip) {\r\n      return openShip !== ship;\r\n    });\r\n\r\n    this.uiState.setShipWindows({\r\n      ships: this.ships,\r\n      movementService: this.movementService\r\n    });\r\n  }\r\n\r\n  closeAll() {\r\n    this.ships = [];\r\n\r\n    this.uiState.setShipWindows({\r\n      ships: this.ships,\r\n      movementService: this.movementService\r\n    });\r\n  }\r\n\r\n  update() {\r\n    this.uiState.setShipWindows({\r\n      ships: this.ships,\r\n      movementService: this.movementService\r\n    });\r\n  }\r\n}\r\n\r\nexport default ShipWindowManager;\r\n","import * as THREE from \"three\";\nimport {\n  getPointBetweenInDistance,\n  hexFacingToAngle\n} from \"../../../../model/utils/math\";\nimport coordinateConverter from \"../../../../model/utils/CoordinateConverter\";\n\nimport { CircleSprite, LineSprite } from \"../renderer/sprite\";\n\nimport Line from \"../renderer/Line\";\nimport { COLOR_FRIENDLY, COLOR_ENEMY } from \"../../../../model/gameConfig.mjs\";\nimport Vector from \"../../../../model/utils/Vector.mjs\";\nimport MovementService from \"../../../../model/movement/MovementService.mjs\";\n\nclass MovementPath {\n  constructor(ship, scene, terrain, ghost, mine) {\n    this.ship = ship;\n    this.scene = scene;\n    this.terrain = terrain;\n    this.ghost = ghost;\n\n    this.color = mine ? COLOR_FRIENDLY : COLOR_ENEMY;\n\n    //this.color = new THREE.Color(19 / 255, 96 / 255, 19 / 255);\n\n    this.objects = [];\n\n    this.movementService = new MovementService();\n\n    this.create();\n  }\n\n  remove() {\n    this.objects.forEach(object3d => {\n      this.scene.remove(object3d.mesh);\n      object3d.destroy();\n    });\n    this.ghost.hide();\n  }\n\n  create() {\n    const startMove = this.movementService.getNewEndMove(\n      this.ship,\n      this.terrain\n    );\n    const start = startMove.position;\n    const end = startMove.position.add(startMove.velocity);\n\n    const line = createMovementLine(\n      this.scene,\n      start,\n      end,\n      this.color,\n      0.5,\n      this.ghost.shipZ\n    );\n\n    this.objects.push(line);\n\n    createMovementFacing(this.ghost, startMove.facing, end, this.color);\n  }\n}\n\nconst createMovementMiddleStep = (position, color) => {\n  const size = coordinateConverter.getHexDistance() * 0.5;\n  const circle = new CircleSprite({ width: size, height: size }, 0.01, 1.6);\n  circle.setPosition(position);\n  circle.setOverlayColor(color);\n  circle.setOverlayColorAlpha(1);\n  return circle;\n};\n\nconst createMovementLine = (\n  scene,\n  position,\n  target,\n  color,\n  opacity = 0.8,\n  z\n) => {\n  const line = new LineSprite(\n    new Vector({ x: position.x, y: position.y, z }),\n    new Vector({ x: target.x, y: target.y, z }),\n    30,\n    {\n      color,\n      opacity,\n      type: \"dashed-arrow\",\n      textureSize: 30,\n      pulseAmount: 1,\n      roundTestureRepeate: true\n    }\n  );\n\n  line.addTo(scene);\n\n  return line;\n};\n\nconst createMovementFacing = (ghost, facing, target, color) => {\n  ghost.show();\n  ghost.setPosition(target);\n  ghost.setFacing(-hexFacingToAngle(facing));\n  ghost.setGhostShipEmissive(color);\n  ghost.setOpacity(0.2);\n\n  ghost.mapIcon\n    .setMovementTarget()\n    .replaceColor(color)\n    .setOverlayColorAlpha(1)\n    .show();\n  /*\n  const size = coordinateConverter.getHexDistance() * 1.5;\n  const facingSprite = new ShipFacingSprite(\n    { width: size, height: size },\n    0.01,\n    1.6,\n    facing\n  );\n  facingSprite.setPosition(target);\n  facingSprite.setOverlayColor(color);\n  facingSprite.setOverlayColorAlpha(1);\n  facingSprite.setFacing(hexFacingToAngle(facing));\n\n  return facingSprite;\n  */\n};\n\nexport { createMovementLine };\n\nexport default MovementPath;\n","import MovementPath from \"./MovementPath\";\r\n\r\nclass MovementPathService {\r\n  constructor(scene, shipIconContainer, currentUser) {\r\n    this.scene = scene;\r\n    this.shipIconContainer = shipIconContainer;\r\n    this.terrain = null;\r\n    this.currentUser = currentUser;\r\n\r\n    this.paths = [];\r\n  }\r\n\r\n  getPath(ship) {\r\n    return this.paths.find(path => path.ship.id === ship.id);\r\n  }\r\n\r\n  update(gameData) {\r\n    this.terrain = gameData.terrain;\r\n  }\r\n\r\n  hideAllMovementPaths() {\r\n    this.paths.forEach(path => path.movementPath.remove(this.scene));\r\n    this.paths = [];\r\n  }\r\n\r\n  hideMovementPath(ship) {\r\n    const path = this.getPath(ship);\r\n    if (!path) {\r\n      return;\r\n    }\r\n\r\n    path.movementPath.remove(this.scene);\r\n    this.paths = this.paths.filter(path => path.ship !== ship);\r\n  }\r\n\r\n  showMovementPath(ship) {\r\n    let path = this.getPath(ship);\r\n\r\n    if (!path) {\r\n      path = {\r\n        ship,\r\n        ghost: this.shipIconContainer.getGhostShipIconByShip(ship),\r\n        movementPath: null\r\n      };\r\n      this.paths.push(path);\r\n    }\r\n\r\n    if (path.movementPath) {\r\n      //TODO: this is inefficient and causes flickering\r\n      path.movementPath.remove(this.scene);\r\n    }\r\n\r\n    path.ship = ship;\r\n\r\n    path.movementPath = new MovementPath(\r\n      ship,\r\n      this.scene,\r\n      this.terrain,\r\n      path.ghost,\r\n      ship.player.is(this.currentUser)\r\n    );\r\n  }\r\n}\r\n\r\nexport default MovementPathService;\r\n","const getInterestingStuffInPosition = (payload, shipIconContainer) => {\n  const mouseovered = payload.entities.filter(\n    entity => entity instanceof window.ShipObject && !entity.ship.isDestroyed()\n  );\n\n  if (mouseovered.length > 0) {\n    return mouseovered;\n  }\n\n  return shipIconContainer\n    .getIconsInProximity(payload)\n    .filter(icon => !icon.ship.isDestroyed());\n};\n\nclass PhaseStrategy {\n  constructor(services) {\n    this.services = services;\n    this.strategies = [];\n    this.inactive = true;\n\n    this.gameData = null;\n\n    this.animationPaused = true;\n    this.animationReversed = false;\n    this.currentDeltaTime = 0;\n    this.animationStartTime = 0;\n    this.totalAnimationTime = 0;\n    this.lastAnimationTime = 0;\n    this.animationEndtime = 0;\n    this.animationTurnLength = null;\n  }\n\n  onEvent(name, payload) {\n    this.callStrategies(name, payload);\n  }\n\n  updateStrategies(gamedata) {\n    this.strategies.forEach(strategy => strategy.update(gamedata));\n  }\n\n  activateStrategies() {\n    this.strategies.forEach(strategy => strategy.activate(this.services));\n  }\n\n  callStrategies(functionName, payload) {\n    this.strategies.forEach(strategy => {\n      if (strategy[functionName] && (!payload || !payload.stopped)) {\n        strategy[functionName](payload);\n      }\n    });\n  }\n\n  render(coordinateConverter, scene, zoom) {\n    this.updateDeltaTime(this.animationPaused);\n    this.updateTotalAnimationTime(this.animationPaused);\n\n    const { shipIconContainer, torpedoIconContainer } = this.services;\n\n    const renderPayload = {\n      delta: this.currentDeltaTime,\n      total: this.totalAnimationTime,\n      last: this.lastAnimationTime,\n      zoom\n    };\n    this.callStrategies(\"render\", renderPayload);\n    shipIconContainer && shipIconContainer.render(renderPayload);\n    torpedoIconContainer && torpedoIconContainer.render(renderPayload);\n    return renderPayload;\n  }\n\n  animateFromTo(start, end) {\n    this.animationStartTime = start;\n    this.totalAnimationTime = start;\n    this.animationReversed = false;\n    this.lastAnimationTime = null;\n    this.currentDeltaTime = 0;\n    this.animationEndtime = end;\n    this.animationPaused = false;\n  }\n\n  pauseAnimation() {\n    this.animationPaused = true;\n  }\n\n  unpauseAnimation() {\n    this.animationReversed = false;\n    this.animationPaused = false;\n  }\n\n  unpauseAndRewindAnimation() {\n    this.animationReversed = true;\n    this.animationPaused = false;\n  }\n\n  setAnimationTime(time) {\n    this.totalAnimationTime = time;\n    this.lastAnimationTime = null;\n    this.currentDeltaTime = 0;\n  }\n\n  updateTotalAnimationTime() {\n    if (this.animationPaused) {\n      return;\n    }\n\n    if (this.animationReversed) {\n      this.totalAnimationTime -= this.currentDeltaTime;\n      if (this.totalAnimationTime < this.animationStartTime) {\n        this.totalAnimationTime = this.animationStartTime;\n        this.animationPaused = true;\n      }\n    } else {\n      this.totalAnimationTime += this.currentDeltaTime;\n      if (\n        this.animationEndtime &&\n        this.totalAnimationTime >= this.animationEndtime\n      ) {\n        this.totalAnimationTime = this.animationEndtime;\n        this.animationPaused = true;\n      }\n    }\n  }\n\n  updateDeltaTime() {\n    const now = Date.now();\n\n    if (!this.lastAnimationTime) {\n      this.lastAnimationTime = now;\n      this.currentDeltaTime = 0;\n    }\n\n    this.currentDeltaTime = now - this.lastAnimationTime;\n\n    this.lastAnimationTime = now;\n  }\n\n  update(gamedata) {\n    const { uiState } = this.services;\n\n    this.gameData = gamedata;\n    uiState.setGameData(gamedata);\n    this.updateStrategies(gamedata);\n\n    return this;\n  }\n\n  activate() {\n    this.inactive = false;\n    this.activateStrategies();\n    return this;\n  }\n\n  deactivate() {\n    this.inactive = true;\n    this.callStrategies(\"deactivate\");\n\n    return this;\n  }\n\n  triggerEvent(name, payload) {\n    this.callStrategies(name, payload);\n  }\n\n  onScrollEvent(payload) {\n    this.callStrategies(\"onScroll\", payload);\n  }\n\n  onZoomEvent(payload) {\n    this.callStrategies(\"onZoom\", payload);\n  }\n\n  canDisturb() {\n    return true;\n  }\n\n  commitTurn(gameConnector) {}\n}\n\nexport default PhaseStrategy;\n","import PhaseStrategy from \"./PhaseStrategy\";\r\n\r\nclass LobbyPhaseStrategy extends PhaseStrategy {\r\n  update(gamedata) {\r\n    super.update(gamedata);\r\n    const { uiState } = this.services;\r\n    uiState.setLobby(true);\r\n\r\n    return this;\r\n  }\r\n\r\n  onEvent(name, payload) {\r\n    switch (name) {\r\n      case \"takeSlot\":\r\n        return this.services.gameConnector.takeSlot(payload.id);\r\n      case \"leaveSlot\":\r\n        return this.services.gameConnector.leaveSlot(payload.id);\r\n      case \"buyShips\":\r\n        return this.services.gameConnector.buyShips(\r\n          payload.slot.id,\r\n          payload.ships\r\n        );\r\n      default:\r\n        return super.onEvent(name, payload);\r\n    }\r\n  }\r\n\r\n  deactivate() {\r\n    super.deactivate();\r\n    const { uiState } = this.services;\r\n    uiState.setLobby(false);\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default LobbyPhaseStrategy;\r\n","class UiStrategy {\r\n  constructor() {\r\n    this.services = null;\r\n    this.gameData = null;\r\n  }\r\n\r\n  deactivate() {}\r\n\r\n  activate(services) {\r\n    this.services = services;\r\n  }\r\n\r\n  update(gameData) {\r\n    this.gameData = gameData;\r\n  }\r\n\r\n  stopEvent(payload) {\r\n    payload.stopped = true;\r\n  }\r\n}\r\n\r\nexport default UiStrategy;\r\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass MouseOverShowsMovementPath extends UiStrategy {\r\n  deactivate() {\r\n    const { movementPathService } = this.services;\r\n    movementPathService.hideAllMovementPaths();\r\n  }\r\n\r\n  mouseOverShip(payload) {\r\n    const { movementPathService } = this.services;\r\n    movementPathService.hideAllMovementPaths();\r\n    movementPathService.showMovementPath(payload.entity.ship);\r\n  }\r\n\r\n  mouseOutShip() {\r\n    const { movementPathService } = this.services;\r\n    movementPathService.hideAllMovementPaths();\r\n  }\r\n}\r\n\r\nexport default MouseOverShowsMovementPath;\r\n","import UiStrategy from \"./UiStrategy\";\r\nimport * as THREE from \"three\";\r\nimport {\r\n  COLOR_FRIENDLY,\r\n  COLOR_ENEMY,\r\n  COLOR_FRIENDLY_HIGHLIGHT,\r\n  COLOR_ENEMY_HIGHLIGHT\r\n} from \"../../../../../model/gameConfig.mjs\";\r\n\r\nclass HighlightSelectedShip extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n\r\n    this.active = false;\r\n    this.activeTime = 0;\r\n    this.icon = null;\r\n    //currentOpacity = opacity + (sineAmplitude * 0.5 * sin(gameTime/sineFrequency) + sineAmplitude)\r\n  }\r\n\r\n  hide() {\r\n    const { shipIconContainer } = this.services;\r\n    if (this.icon) {\r\n      this.icon.revertEmissive();\r\n      this.icon.mapIcon.revertColor();\r\n      this.icon.hexSprites.forEach(sprite => sprite.revertColor());\r\n      const ghost = shipIconContainer.getGhostShipIconByShip(this.icon.ship);\r\n      ghost.revertOpacity();\r\n      ghost.mapIcon.setMovementTarget();\r\n      ghost.mapIcon.revertColor();\r\n    }\r\n\r\n    this.icon = null;\r\n  }\r\n\r\n  deactivate() {\r\n    this.hide();\r\n  }\r\n\r\n  shipSelected(ship) {\r\n    const { shipIconContainer } = this.services;\r\n    this.active = true;\r\n    this.activeTime = 0;\r\n    this.icon = shipIconContainer.getByShip(ship);\r\n  }\r\n\r\n  shipDeselected(ship) {\r\n    const { shipIconContainer } = this.services;\r\n    this.active = true;\r\n    this.activeTime = 0;\r\n\r\n    this.hide();\r\n  }\r\n\r\n  render({ delta }) {\r\n    const { shipIconContainer } = this.services;\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    const sineAmplitude = 1;\r\n    const sineFrequency = 200;\r\n\r\n    let opacity =\r\n      0.5 * Math.sin(this.activeTime / sineFrequency) + sineAmplitude * 0.5;\r\n    opacity = 0.2 + 0.6 * opacity;\r\n\r\n    const ghost = shipIconContainer.getGhostShipIconByShip(this.icon.ship);\r\n\r\n    //if (ghost.hidden) {\r\n\r\n    const color = COLOR_FRIENDLY_HIGHLIGHT.clone().multiplyScalar(opacity);\r\n    /*\r\n    const color = new THREE.Color(\r\n      (39 * opacity) / 255,\r\n      (196 * opacity) / 255,\r\n      (39 * opacity) / 255\r\n    );\r\n    */\r\n\r\n    //this.icon.replaceEmissive(color);\r\n    //}\r\n\r\n    ghost.setGhostShipEmissive(color);\r\n    ghost.replaceOpacity(opacity);\r\n    ghost.mapIcon\r\n      .setMovementTarget()\r\n      .replaceColor(color)\r\n      .setOverlayColorAlpha(1);\r\n    this.icon.hexSprites.forEach(sprite => sprite.replaceColor(color.clone()));\r\n    this.icon.mapIcon.replaceColor(color);\r\n    this.activeTime += delta;\r\n  }\r\n}\r\n\r\nexport default HighlightSelectedShip;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass SelectedShipMovementUi extends UiStrategy {\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.hideShipMovement();\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n    this.shipStateChanged();\r\n  }\r\n\r\n  shipStateChanged() {\r\n    const { uiState } = this.services;\r\n    const ship = uiState.getSelectedShip();\r\n\r\n    if (ship) {\r\n      uiState.showShipMovement(ship, true);\r\n    }\r\n  }\r\n\r\n  shipSelected(ship) {\r\n    const { uiState } = this.services;\r\n    uiState.showShipMovement(ship, true);\r\n  }\r\n\r\n  shipDeselected() {\r\n    const { uiState } = this.services;\r\n    uiState.hideShipMovement();\r\n  }\r\n}\r\n\r\nexport default SelectedShipMovementUi;\r\n","import UiStrategy from \"./UiStrategy\";\r\nimport * as THREE from \"three\";\r\nimport { HexagonSprite } from \"../../renderer/sprite\";\r\n\r\nclass ShowDeploymentAreas extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n\r\n    this.areas = [];\r\n  }\r\n\r\n  deactivate() {\r\n    const { scene } = this.services;\r\n    this.areas.forEach(area => {\r\n      area.sprites.forEach(sprite => {\r\n        scene.remove(sprite.mesh);\r\n        sprite.destroy();\r\n      });\r\n    });\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n    const { scene, coordinateConverter, currentUser } = this.services;\r\n\r\n    this.areas = gameData.slots.getSlots().map(slot => {\r\n      const hexagons = slot.deploymentLocation.spiral(slot.deploymentRadius);\r\n\r\n      let color = new THREE.Color(1, 1, 1);\r\n      if (slot.isUsers(currentUser)) {\r\n        color = new THREE.Color(39 / 255, 196 / 255, 39 / 255);\r\n      } else if (!gameData.slots.isUsersTeamSlot(slot, currentUser)) {\r\n        color = new THREE.Color(196 / 255, 39 / 255, 39 / 255);\r\n      }\r\n\r\n      return {\r\n        slot,\r\n        sprites: hexagons.map(hex => {\r\n          const sprite = new HexagonSprite(\r\n            coordinateConverter.fromHexToGame(hex)\r\n          );\r\n\r\n          sprite.setOpacity(0.5);\r\n          sprite.setOverlayColor(color);\r\n          sprite.setOverlayColorAlpha(0.5);\r\n\r\n          scene.add(sprite.mesh);\r\n\r\n          return sprite;\r\n        })\r\n      };\r\n    });\r\n  }\r\n\r\n  selectShip(ship) {}\r\n}\r\n\r\nexport default ShowDeploymentAreas;\r\n","import {\r\n  addToDirection,\r\n  hexFacingToAngle\r\n} from \"../../../../../model/utils/math.mjs\";\r\n\r\nconst shouldEaseIn = (\r\n  startsAndEnds,\r\n  startEndIndex,\r\n  between,\r\n  betweenIndex,\r\n  move\r\n) => {\r\n  if (!between[betweenIndex - 1]) {\r\n    if (!startsAndEnds[startEndIndex - 1]) {\r\n      return true;\r\n    } else {\r\n      const lastBetween = startsAndEnds[startEndIndex - 1].between;\r\n      const lastMove = lastBetween[lastBetween.length - 1];\r\n      if (!lastMove.isPivot() || lastMove.value !== move.value) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  } else {\r\n    const lastMove = between[betweenIndex - 1];\r\n    if (!lastMove.isPivot() || lastMove.value !== move.value) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n};\r\n\r\nconst shouldEaseOut = (\r\n  startsAndEnds,\r\n  startEndIndex,\r\n  between,\r\n  betweenIndex,\r\n  move\r\n) => {\r\n  if (!between[betweenIndex + 1]) {\r\n    if (!startsAndEnds[startEndIndex + 1]) {\r\n      return true;\r\n    } else {\r\n      const nextBetween = startsAndEnds[startEndIndex + 1].between;\r\n      const nextMove = nextBetween[0];\r\n      if (!nextMove.isPivot() || nextMove.value !== move.value) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  } else {\r\n    const nextMove = between[betweenIndex + 1];\r\n    if (!nextMove.isPivot() || nextMove.value !== move.value) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n};\r\n\r\nconst betweenMap = (\r\n  startsAndEnds,\r\n  startEndIndex,\r\n  between,\r\n  betweenIndex,\r\n  move\r\n) => {\r\n  if (!move.isPivot()) {\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    pivot: move.value === 1 ? 60 : -60,\r\n    easeIn: shouldEaseIn(\r\n      startsAndEnds,\r\n      startEndIndex,\r\n      between,\r\n      betweenIndex,\r\n      move\r\n    ),\r\n    easeOut: shouldEaseOut(\r\n      startsAndEnds,\r\n      startEndIndex,\r\n      between,\r\n      betweenIndex,\r\n      move\r\n    )\r\n  };\r\n};\r\n\r\nconst startsAndEndsToSteps = startsAndEnds => {\r\n  return startsAndEnds.map(({ start, end, between }, startEndIndex) => {\r\n    return {\r\n      startFacing: hexFacingToAngle(start.facing),\r\n      endFacing: hexFacingToAngle(end.facing),\r\n      steps: between.map((move, i) => {\r\n        return betweenMap(startsAndEnds, startEndIndex, between, i, move);\r\n      })\r\n    };\r\n  });\r\n};\r\n\r\nconst setStartFacings = path => {\r\n  return path.map(({ startFacing, endFacing, steps }) => {\r\n    return {\r\n      startFacing,\r\n      endFacing,\r\n      steps: steps.map(step => {\r\n        if (step === null) {\r\n          return { facing: startFacing };\r\n        }\r\n\r\n        const newStep = {\r\n          ...step,\r\n          startFacing\r\n        };\r\n\r\n        startFacing = addToDirection(startFacing, step.pivot);\r\n        return newStep;\r\n      })\r\n    };\r\n  });\r\n};\r\n\r\nconst movesToSteps = moves => {\r\n  const startsAndEnds = [];\r\n  let between = [];\r\n  let start = null;\r\n\r\n  moves.forEach(move => {\r\n    if (move.isDeploy()) {\r\n      start = move;\r\n    } else if (move.isEnd() && !start) {\r\n      start = move;\r\n    } else if (move.isEnd()) {\r\n      startsAndEnds.push({\r\n        start: start,\r\n        between: [...between],\r\n        end: move\r\n      });\r\n\r\n      start = move;\r\n      between = [];\r\n    } else if (start && move.isPivot()) {\r\n      between.push(move);\r\n    } else if (start && move.isSpeed()) {\r\n      between.push(move);\r\n    }\r\n  });\r\n\r\n  return setStartFacings(startsAndEndsToSteps(startsAndEnds));\r\n};\r\n\r\nclass PivotPath {\r\n  constructor(moves) {\r\n    this.moves = moves;\r\n    this.path = movesToSteps(moves);\r\n  }\r\n\r\n  getFacing(turn, percentDone) {\r\n    const steps = this.path[turn] || this.path[this.path.length - 1];\r\n    const length = steps.steps.length;\r\n\r\n    if (length === 0) {\r\n      return steps.endFacing;\r\n    } else {\r\n      const stepIndex = this.path[turn]\r\n        ? Math.floor(length * percentDone)\r\n        : length - 1;\r\n      const stepDone = this.path[turn] ? (length * percentDone) % 1 : 1;\r\n\r\n      const step = steps.steps[stepIndex];\r\n      if (step.facing !== undefined) {\r\n        return step.facing;\r\n      }\r\n      return addToDirection(step.startFacing, step.pivot * stepDone);\r\n    }\r\n  }\r\n}\r\n\r\nexport default PivotPath;\r\n","import ShipMovementAnimation from \"./ShipMovementAnimation\";\r\n\r\nexport default ShipMovementAnimation;\r\n","import * as THREE from \"three\";\nimport Animation from \"../Animation\";\nimport ShipEvasionMovementPath from \"./ShipEvasionMovementPath\";\nimport PivotSteps from \"./PivotSteps\";\nimport Vector from \"../../../../../model/utils/Vector.mjs\";\nimport { getAngleBetween } from \"../../../../../model/utils/math.mjs\";\nimport { addToDirection } from \"../../../../../model/utils/math.mjs\";\n\nclass ShipMovementAnimation extends Animation {\n  constructor(shipIcon, moves, start, end) {\n    super();\n\n    this.shipIcon = shipIcon;\n    this.moves = moves;\n\n    this.doneCallback = null;\n\n    this.start = start;\n    this.end = end;\n\n    this.duration = end - start;\n\n    this.positionCurves = this.movesToCurves(moves);\n    this.pivotSteps = new PivotSteps(moves);\n\n    this.startRoll = moves[0].rolled ? 180 : 0;\n    this.endRoll =\n      moves[0].rolled === moves[moves.length - 1].rolled\n        ? this.startRoll\n        : this.startRoll + 180;\n\n    this.easeInOut = new THREE.CubicBezierCurve(\n      new THREE.Vector2(0, 0),\n      new THREE.Vector2(0.75, 0),\n      new THREE.Vector2(0.25, 1),\n      new THREE.Vector2(1, 1)\n    );\n\n    /*\n\n    this.positionCurve = this.buildPositionCurve();\n    this.rotations = this.buildRotations();\n    this.evasionOffset = new ShipEvasionMovementPath(\n      this.turn * this.ship.id,\n      this.movementService.getEvasion(this.ship)\n    );\n\n    /*\n    this.turnCurve = new THREE.CubicBezierCurve(\n      new THREE.Vector2(0, 0),\n      new THREE.Vector2(0.25, 0.25),\n      new THREE.Vector2(0.75, 0.75),\n      new THREE.Vector2(1, 1)\n    );\n\n    */\n\n    Animation.call(this);\n  }\n\n  doesMove() {\n    return !new Vector(this.positionCurves[0].getPoint(0)).equals(\n      new Vector(this.positionCurves[0].getPoint(1))\n    );\n  }\n\n  deactivate() {}\n\n  update(gameData) {}\n\n  cleanUp() {}\n\n  getEndPosition() {\n    return this.getPositionAndFacing(1, 1);\n  }\n\n  getPositionAt(time) {\n    const turnDone = this.getMovementTurnDone({ total: time });\n\n    const turn = Math.floor(turnDone);\n    const percentDone = turnDone < 1 ? turnDone % 1 : 1;\n\n    return this.getPositionAndFacing(turn, percentDone);\n  }\n\n  getMovementTurnDone({ total }) {\n    if (total < this.start) {\n      return 0;\n    }\n\n    if (total > this.end) {\n      return 1;\n    }\n\n    const time = total - this.start;\n    return time / this.duration;\n  }\n\n  getCurrentRoll(turnDone) {\n    const between = -getAngleBetween(this.startRoll, this.endRoll);\n    if (between === 0) {\n      return this.endRoll;\n    }\n\n    return addToDirection(\n      this.startRoll,\n      between * this.easeInOut.getPoint(turnDone).y\n    );\n  }\n\n  render(payload) {\n    const turnDone = this.getMovementTurnDone(payload);\n\n    if (turnDone === 1) {\n      return;\n    }\n\n    const turn = Math.floor(turnDone);\n    const percentDone = turnDone < 1 ? turnDone % 1 : 1;\n\n    const { position, facing } = this.getPositionAndFacing(turn, percentDone);\n\n    const roll = this.getCurrentRoll(turnDone);\n    this.shipIcon.setPosition(position);\n    this.shipIcon.setFacing(-facing);\n    this.shipIcon.setRoll(roll);\n  }\n\n  getPositionAndFacing(turn, percentDone) {\n    const position = this.positionCurves[turn]\n      ? this.positionCurves[turn].getPoint(percentDone)\n      : this.positionCurves[this.positionCurves.length - 1].getPoint(1);\n\n    const facing = this.pivotSteps.getFacing(turn, percentDone);\n\n    return { position, facing };\n  }\n\n  movesToCurves(moves) {\n    const startsAndEnds = [];\n    let start = null;\n\n    moves.forEach(move => {\n      if (move.isDeploy()) {\n        start = move;\n      } else if (move.isEnd() && !start) {\n        start = move;\n      } else if (move.isEnd()) {\n        startsAndEnds.push({\n          start: start,\n          end: move\n        });\n\n        start = move;\n      }\n    });\n\n    const curves = startsAndEnds.map(({ start, end }) =>\n      this.buildPositionCurve(start, end)\n    );\n\n    return curves;\n  }\n\n  buildPositionCurve(start, end) {\n    const startPosition = start.position.add(start.velocity);\n\n    const point1 = startPosition.roundToHexCenter();\n    const control1 = startPosition.roundToHexCenter();\n    const control2 = end.position.roundToHexCenter();\n    const point2 = end.position.roundToHexCenter();\n\n    /*\n    const point1 = start.position.roundToHexCenter();\n    const control1 = start.position.add(start.velocity.multiplyScalar(0.5));\n    const control2 = end.position.sub(end.velocity.multiplyScalar(0.5));\n    const point2 = end.position.roundToHexCenter();\n    */\n\n    /*\n    return new THREE.QuadraticBezierCurve3(\n      new THREE.Vector3(point1.x, point1.y, point1.z),\n      new THREE.Vector3(control1.x, control1.y, control1.z),\n      new THREE.Vector3(point2.x, point2.y, point2.z)\n    );\n    */\n\n    return new THREE.CubicBezierCurve3(\n      new THREE.Vector3(point1.x, point1.y, point1.z),\n      new THREE.Vector3(control1.x, control1.y, control1.z),\n      new THREE.Vector3(control2.x, control2.y, control2.z),\n      new THREE.Vector3(point2.x, point2.y, point2.z)\n    );\n  }\n}\n\nexport default ShipMovementAnimation;\n","import { hexFacingToAngle } from \"../../../../model/utils/math.mjs\";\r\n\r\nimport Animation from \"./Animation\";\r\nimport MovementService from \"../../../../model/movement/MovementService.mjs\";\r\n\r\nclass ShipIdleMovementAnimation extends Animation {\r\n  constructor(shipIcon, gameTerrain) {\r\n    super();\r\n\r\n    this.gameTerrain = gameTerrain;\r\n\r\n    this.shipIcon = shipIcon;\r\n    this.ship = shipIcon.ship;\r\n\r\n    this.duration = 0;\r\n    this.movementService = new MovementService();\r\n\r\n    this.position = this.getPosition();\r\n    this.facing = this.getFacing();\r\n    this.roll = this.getRoll();\r\n  }\r\n\r\n  update() {\r\n    this.position = this.getPosition();\r\n    this.facing = this.getFacing();\r\n    this.roll = this.getRoll();\r\n  }\r\n\r\n  deactivate() {}\r\n\r\n  render(now, total, last, delta, zoom, back, paused) {\r\n    this.shipIcon.setPosition(this.position);\r\n    this.shipIcon.setFacing(-this.facing);\r\n    this.shipIcon.setRoll(this.roll);\r\n  }\r\n\r\n  getRoll() {\r\n    const roll = this.shipIcon.ship.movement.isRolled() ? 180 : 0;\r\n\r\n    if (this.shipIcon.ship.movement.isRolling()) {\r\n      return roll + 90;\r\n    }\r\n\r\n    return roll;\r\n  }\r\n\r\n  getPosition() {\r\n    const end = this.movementService.getNewEndMove(this.ship, this.gameTerrain);\r\n    return end.position;\r\n  }\r\n\r\n  getFacing() {\r\n    return hexFacingToAngle(this.ship.movement.getLastMove().facing);\r\n  }\r\n}\r\n\r\nexport default ShipIdleMovementAnimation;\r\n","import Animation from \"./Animation\";\r\n\r\nclass ShipSystemAnimation extends Animation {\r\n  constructor(icon, ship) {\r\n    super();\r\n    this.icon = icon;\r\n    this.ship = ship || icon.ship;\r\n\r\n    this.updateAll();\r\n  }\r\n\r\n  updateAll() {\r\n    this.ship.systems.getSystems().forEach(system => this.updateSystem(system));\r\n  }\r\n\r\n  updateSystem(system) {\r\n    if (system.power.isGoingOffline()) {\r\n      this.icon.disableSystemAnimation(system, \"online\");\r\n      this.icon.playSystemAnimation(system, \"offline\");\r\n    } else if (system.power.isGoingOnline()) {\r\n      this.icon.disableSystemAnimation(system, \"offline\");\r\n      this.icon.playSystemAnimation(system, \"online\");\r\n    } else if (system.isDisabled()) {\r\n      this.icon.disableSystemAnimation(system, \"online\");\r\n      this.icon.setSystemAnimation(system, \"offline\", 100);\r\n    } else if (system.power.isOffline()) {\r\n      this.icon.disableSystemAnimation(system, \"online\");\r\n      this.icon.setSystemAnimation(system, \"offline\", 100);\r\n    } else if (system.power.isOnline()) {\r\n      this.icon.disableSystemAnimation(system, \"offline\");\r\n      this.icon.setSystemAnimation(system, \"online\", 100);\r\n    }\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default ShipSystemAnimation;\r\n","import * as THREE from \"three\";\nimport Vector from \"../../../../../model/utils/Vector\";\n\nclass BoltEffect {\n  create(\n    startTime,\n    startPosition,\n    endPosition,\n    speed,\n    fade,\n    duration,\n    args,\n    getRandom,\n    particleEmitterContainer,\n    context\n  ) {\n    this.particleEmitterContainer = particleEmitterContainer;\n\n    const velocity = new Vector(endPosition)\n      .sub(startPosition)\n      .normalize()\n      .multiplyScalar(speed);\n\n    this.duration = this.createBolt(\n      startTime,\n      startPosition,\n      endPosition,\n      duration,\n      velocity,\n      speed,\n      fade,\n      args,\n      particleEmitterContainer,\n      getRandom,\n      context\n    );\n  }\n\n  createBolt(\n    startTime,\n    startPosition,\n    endPosition,\n    duration,\n    velocity,\n    speed,\n    fade,\n    args,\n    particleEmitterContainer,\n    getRandom,\n    context\n  ) {\n    const directionNormal = endPosition.sub(startPosition).normalize();\n    const color = args.color\n      ? new THREE.Color(args.color[0], args.color[1], args.color[2])\n      : new THREE.Color(1, 0, 0);\n\n    const tailLength = args.length ? args.length : args.size * 2;\n\n    particleEmitterContainer\n      .getBoltParticle(context)\n      .setScale(tailLength, args.size)\n      .setOpacity(0.5)\n      .setPosition(startPosition)\n      .setBoltTexture()\n      .setRotation(directionNormal)\n      .setColor(color)\n      .setVelocity(velocity)\n      .setActivationTime(startTime)\n      .setDeactivationTime(startTime + duration, fade);\n\n    const coreLength = (args.length ? args.length : args.size * 2) * 0.5;\n\n    const corePosition = coreLength * 0.2;\n    const coreTime = corePosition / speed;\n\n    const coreOpacity = args.coreOpacity || 0.5;\n\n    particleEmitterContainer\n      .getBoltParticle(context)\n      //.setActivationTime(0)\n      .setScale(coreLength, args.size * 0.5)\n      .setOpacity(coreOpacity)\n      .setPosition(startPosition)\n      .setBoltTexture()\n      .setRotation(directionNormal)\n      //.setVelocity(velocity)\n      .setColor(new THREE.Color(1, 1, 1))\n      .setVelocity(velocity)\n      .setActivationTime(startTime + coreTime)\n      .setDeactivationTime(startTime + duration + coreTime, fade);\n\n    return duration + coreTime;\n  }\n}\n\nexport default BoltEffect;\n","import BaseParticle, {\n  TEXTURE_GAS,\n  TEXTURE_BOLT,\n  TEXTURE_GLOW,\n  TEXTURE_RING,\n  TEXTURE_STARLINE\n} from \"../particle/BaseParticle\";\nimport Animation from \"../Animation\";\nimport { getPointInDirection } from \"../../../../../model/utils/math.mjs\";\nimport * as THREE from \"three\";\nimport BoltEffect from \"./BoltEffect\";\nimport Vector from \"../../../../../model/utils/Vector.mjs\";\n\nconst boltEffect = new BoltEffect();\n\nclass ExplosionEffect extends Animation {\n  constructor(emitterContainer, getRandom, args = {}, context) {\n    super(getRandom);\n\n    this.emitterContainer = emitterContainer;\n    this.position = args.position || { x: 0, y: 0 };\n    this.time = args.time || 0;\n    this.type = args.type || \"gas\";\n    this.size = args.size || 16;\n    this.speed = args.speed || 1;\n    this.ring = args.ring || false;\n    this.duration = args.duration;\n    this.color = args.color;\n    this.opacity = args.opacity || 1;\n\n    this.movement = args.velocity || { x: 0, y: 0, z: 0 };\n\n    this.context = context;\n    this.create();\n  }\n\n  create() {\n    switch (this.type) {\n      case \"gas\":\n        this.createGas();\n        break;\n\n      case \"glow\":\n        this.createGlow();\n        break;\n\n      case \"emp\":\n        this.createEMP();\n        break;\n\n      case \"pillar\":\n        this.createPillar();\n        break;\n      default:\n        this.createGas();\n        break;\n    }\n  }\n\n  createGlow() {\n    var amount = 3;\n\n    this.createMainGlow(amount, this.size);\n    this.createCore(this.size, TEXTURE_GLOW);\n    this.createWhiteCenter(this.size * 2, 0.8);\n  }\n\n  createGas() {\n    var amount = Math.ceil(this.size / 4);\n    if (amount > 6) {\n      amount = 6;\n    }\n\n    var shootoffs = Math.ceil(Math.random() * 20 + 10);\n\n    this.createShootOffs(shootoffs, this.size);\n    this.createMainGlow(1, this.size);\n    this.createCore(this.size, TEXTURE_GLOW);\n    this.createMain(amount, this.size);\n    this.createWhiteCenter(this.size * 2, 0.5);\n  }\n\n  createPillar() {\n    //if ( this.ring)\n    //\tthis.createRing(this.size, emitter);\n\n    var amount = Math.ceil(this.size / 4);\n    if (amount > 6) {\n      amount = 6;\n    }\n\n    var shootoffs = Math.ceil(Math.random() * 20 + 10);\n\n    this.createPillars(shootoffs, this.size);\n    this.createMainGlow(Math.ceil(amount / 2), this.size);\n  }\n\n  createEMP() {\n    //if ( this.ring)\n    //\tthis.createRing(this.size, emitter);\n\n    var amount = Math.ceil(this.size / 4);\n    if (amount > 6) {\n      amount = 6;\n    }\n\n    this.createEmpGlow(Math.ceil(amount / 2), this.size);\n    this.createWhiteCenter(this.size * 4, 0.5);\n    this.createEmpCore(this.size, TEXTURE_GAS);\n  }\n\n  createWhiteCenter(size, opacity) {\n    if (!opacity) {\n      opacity = 1.0;\n    }\n\n    var activation = this.time;\n    var fadeInSpeed = 100;\n    var fadeOutAt = activation + fadeInSpeed;\n    //amount = 1;\n\n    this.emitterContainer\n      .getParticle(this.context)\n      .setSize(size / 4)\n      //.setSizeChange(128)\n      .setOpacity(opacity * this.opacity)\n      .setFadeIn(activation, fadeInSpeed)\n      .setFadeOut(fadeOutAt, 500)\n      .setColor({ r: 1, g: 1, b: 1 })\n      .setPosition({\n        x: this.position.x,\n        y: this.position.y,\n        z: this.position.z\n      })\n      .setTexture(TEXTURE_GLOW)\n      .setActivationTime(activation);\n  }\n\n  createShootOffs(amount, radius, args) {\n    while (amount--) {\n      this.createShootOff(radius, args);\n    }\n  }\n\n  createShootOff(radius, args) {\n    if (!args) {\n      args = {};\n    }\n\n    console.log(\"hi\", this.size);\n    const speed = (Math.random() * 0.2 + 0.1) * this.speed * this.size * 0.01;\n\n    const startPosition = args.position || this.position;\n    const endPosition =\n      args.target ||\n      new Vector(Math.random() - 0.5, Math.random() - 0.5, Math.random() - 0.5)\n        .normalize()\n        .multiplyScalar((Math.random() * 10 + 3) * this.size)\n        .add(startPosition);\n\n    const color = this.getRandomColor();\n    boltEffect.create(\n      this.time + Math.floor((Math.random() * 30) / this.speed),\n      new Vector(startPosition),\n      new Vector(endPosition),\n      speed * 1.5,\n      args.fadeOutSpeed || Math.random() * 500 + 250,\n      Math.floor(Math.random() * 500 + 250) / this.speed,\n      {\n        size: radius / 3,\n        color: [color.r, color.g, color.b],\n        coreOpacity: 0.1\n      },\n      this.getRandom,\n      this.emitterContainer,\n      this.context\n    );\n  }\n\n  createPillars(amount, radius) {\n    var size = radius;\n    //amount = 1;\n    while (amount--) {\n      var particle = this.emitterContainer.getParticle(this.context);\n      var activationTime =\n        this.time + Math.floor((Math.random() * 30) / this.speed);\n      var fadeOutAt =\n        activationTime + Math.floor((Math.random() * 50) / this.speed);\n\n      var angle = Math.floor(Math.random() * 360);\n      var target = getPointInDirection(0.1, -angle, 0, 0);\n\n      particle\n        .setSize(Math.floor(Math.random() * size) + size / 2)\n        .setOpacity(Math.random() * 0.1 + 0.9)\n        .setFadeIn(activationTime, Math.random() * 50 + 25)\n        .setFadeOut(\n          fadeOutAt,\n          (Math.random() * 500) / this.speed + 250 / this.speed\n        )\n        .setColor(getYellowColor())\n        .setPosition({\n          x: this.position.x,\n          y: this.position.y,\n          z: this.position.z\n        })\n        .setVelocity(target)\n        .setAngle(angle)\n        .setTexture(TEXTURE_BOLT)\n        .setActivationTime(activationTime);\n\n      this.createShootOff(radius, {\n        angle: angle,\n        activationTime: activationTime\n      });\n    }\n  }\n\n  createCore(radius, texture) {\n    var size = radius;\n\n    var particle = this.emitterContainer.getParticle(this.context);\n    var activationTime = this.time + (Math.random() * 0.005) / this.speed;\n    var fadeOutAt =\n      activationTime + (Math.random() * 0.02) / this.speed + 0.03 / this.speed;\n\n    particle\n      .setSize(Math.floor((Math.random() * size) / 2) + size)\n      .setOpacity(Math.random() * 0.2 + 0.6)\n      .setFadeIn(activationTime, Math.random() * 0.005 + 0.0025)\n      .setFadeOut(\n        fadeOutAt,\n        (Math.random() * 0.05) / this.speed + 0.025 / this.speed\n      )\n      .setOpacity(this.opacity * 0.5)\n      .setColor(getCoreColor())\n      .setPosition({\n        x: this.position.x, // + Math.floor(Math.random()*radius/10)-radius/5,\n        y: this.position.y, // + Math.floor(Math.random()*radius/10)-radius/5,\n        z: this.position.z\n      })\n      .setAngle(45)\n      .setTexture(texture)\n      .setVelocity(this.movement)\n      .setAngle(Math.floor(Math.random() * 360))\n      .setAngleChange(\n        Math.floor(Math.random() * 20 * this.speed) - 10 * this.speed\n      )\n      .setActivationTime(activationTime);\n  }\n\n  createEmpGlow(amount, radius) {\n    var size = radius * 2;\n    while (amount--) {\n      var particle = this.emitterContainer.getParticle(this.context);\n      var activationTime = this.time;\n      var fadeOutAt = activationTime;\n\n      particle\n        .setSize(size)\n        .setSizeChange(0.004 * this.size)\n        .setOpacity(Math.random() * 0.1 + 0.2)\n        .setFadeIn(activationTime, Math.random() * 0.005 + 0.0025)\n        .setFadeOut(fadeOutAt, (Math.random() * 200 + 800) / this.speed)\n        .setColor({ r: 122 / 255, g: 221 / 255, b: 255 / 255 })\n        .setVelocity(this.movement)\n        .setPosition({\n          x: this.position.x,\n          y: this.position.y,\n          z: this.position.z\n        })\n        .setTexture(TEXTURE_GLOW)\n        .setActivationTime(activationTime);\n    }\n  }\n\n  createEmpCore(radius, texture) {\n    var size = radius;\n\n    var particle = this.emitterContainer.getParticle(this.context);\n    var activationTime = this.time;\n    var fadeOutAt = activationTime;\n\n    particle\n      .setSize(size * 0.9)\n      .setSizeChange(0.0039 * this.size)\n      .setOpacity(Math.random() * 0.2 + 0.6)\n      .setFadeIn(activationTime, 0.1)\n      .setFadeOut(fadeOutAt, (Math.random() * 200 + 800) / this.speed)\n      .setColor(getCoreColor())\n      .setPosition({\n        x: this.position.x, // + Math.floor(Math.random()*radius/10)-radius/5,\n        y: this.position.y, // + Math.floor(Math.random()*radius/10)-radius/5,\n        z: this.position.z\n      })\n      .setAngle(45)\n      .setTexture(texture)\n      .setVelocity(this.movement)\n      .setAngle(Math.floor(Math.random() * 360))\n      .setAngleChange(5 * this.speed)\n      .setActivationTime(activationTime);\n  }\n\n  createMain(amount, radius) {\n    var size = radius;\n    while (amount--) {\n      var particle = this.emitterContainer.getParticle(this.context);\n      var activationTime =\n        this.time + Math.floor((Math.random() * 300) / this.speed);\n      var fadeOutAt =\n        activationTime + Math.floor((Math.random() * 500) / this.speed);\n\n      particle\n        .setSize(Math.floor(Math.random() * size) + size / 2)\n        .setSizeChange(this.size * 0.003)\n        .setOpacity(Math.random() * 0.1 + 0.05)\n        .setFadeIn(activationTime, Math.random() * 50 + 25)\n        .setFadeOut(\n          fadeOutAt,\n          (Math.random() * 500) / this.speed + 500 / this.speed\n        )\n        .setColor(this.getRandomColor())\n        .setPosition({\n          x:\n            this.position.x + (Math.floor(Math.random() * radius) - radius) / 8,\n          y:\n            this.position.y + (Math.floor(Math.random() * radius) - radius) / 8,\n          z: this.position.z + (Math.floor(Math.random() * radius) - radius) / 8\n        })\n        .setVelocity(this.movement)\n        .setAngle(Math.floor(Math.random() * 360))\n        //.setAngleChange(Math.floor(Math.random()*2*this.speed)-1*this.speed)\n        .setActivationTime(activationTime)\n        .setTexture(TEXTURE_GAS);\n    }\n  }\n\n  createMainGlow(amount, radius) {\n    var size = radius * 2;\n    while (amount--) {\n      var particle = this.emitterContainer.getParticle(this.context);\n      var activationTime =\n        this.time + Math.floor((Math.random() * 0.03) / this.speed);\n      var fadeOutAt = this.duration\n        ? activationTime + this.duration\n        : activationTime + Math.floor((Math.random() * 0.05) / this.speed);\n\n      particle\n        .setSize(Math.floor((Math.random() * size) / 2) + size)\n        .setOpacity(Math.random() * 0.1 + 0.4)\n        .setFadeIn(activationTime, Math.random() * 0.005 + 0.0025)\n        .setFadeOut(fadeOutAt, (Math.random() * 200 + 800) / this.speed)\n        .setColor(this.getRandomColor())\n        .setVelocity(this.movement)\n        .setOpacity(this.opacity)\n        .setPosition({\n          x: this.position.x,\n          y: this.position.y,\n          z: this.position.z\n        })\n        .setTexture(TEXTURE_GLOW)\n        .setActivationTime(activationTime);\n    }\n  }\n\n  getRandomColor = function() {\n    if (this.color) {\n      return this.color;\n    }\n\n    return new THREE.Color().setRGB(\n      1,\n      (155 - Math.floor(Math.random() * 75)) / 255,\n      Math.floor(Math.random() * 155) / 255\n    );\n  };\n\n  getSmokeColor = function() {\n    var c = (Math.random() * 50 + 20) / 255;\n    return new THREE.Color().setRGB(c, c, c + 0.05);\n  };\n\n  deactivate() {\n    this.emitterContainer.release(this);\n  }\n}\n\nconst getCoreColor = () => {\n  return new THREE.Color().setRGB(255, 255, 255);\n};\n\nconst getYellowColor = () => {\n  return new THREE.Color().setRGB(\n    1,\n    (Math.floor(Math.random() * 20) + 235) / 255,\n    (Math.floor(Math.random() * 10) + 130) / 255\n  );\n};\n\nexport default ExplosionEffect;\n","import * as THREE from \"three\";\r\nimport Animation from \"../Animation\";\r\nimport Vector from \"../../../../../model/utils/Vector\";\r\nimport ExplosionEffect from \"../effect/ExplosionEffect\";\r\nimport { degreeToRadian } from \"../../../../../model/utils/math.mjs\";\r\n\r\nclass ShipWeaponAnimation extends Animation {\r\n  constructor(props) {\r\n    super(props.getRandom);\r\n    this.particleEmitterContainer = props.particleEmitterContainer;\r\n    this.props = props;\r\n  }\r\n\r\n  getLocationForSystem(system, icon, facing) {\r\n    const location = icon.systemLocations[system.id];\r\n\r\n    if (!location) {\r\n      return new Vector();\r\n    }\r\n\r\n    const object = new THREE.Object3D();\r\n    object.rotation.z = degreeToRadian(-facing);\r\n    const result = location.clone();\r\n    result.applyQuaternion(object.quaternion);\r\n    result.z += icon.shipZ;\r\n    return result;\r\n  }\r\n}\r\n\r\nexport default ShipWeaponAnimation;\r\n","import ShipWeaponBoltAnimation from \"./ShipWeaponBoltAnimation\";\r\nimport ShipWeaponBoltBurstAnimation from \"./ShipWeaponBoltBurstAnimation\";\r\nimport ShipWeaponUniversalBoltAnimation from \"./ShipWeaponUniversalBoltAnimation\";\r\n\r\nexport default {\r\n  ShipWeaponBoltAnimation,\r\n  ShipWeaponBoltBurstAnimation,\r\n  ShipWeaponUniversalBoltAnimation\r\n};\r\n","import * as THREE from \"three\";\r\nimport Vector from \"../../../../../model/utils/Vector\";\r\nimport ShipWeaponAnimation from \"./ShipWeaponAnimation\";\r\nimport BoltEffect from \"../effect/BoltEffect\";\r\nimport ExplosionEffect from \"../effect/ExplosionEffect\";\r\n\r\nclass ShipWeaponBoltAnimation extends ShipWeaponAnimation {\r\n  constructor(\r\n    time,\r\n    combatLogEntry,\r\n    fireOrder,\r\n    weapon,\r\n    shooterIcon,\r\n    targetIcon,\r\n    getPosition,\r\n    getRandom,\r\n    particleEmitterContainer,\r\n    args,\r\n    weaponAnimationService\r\n  ) {\r\n    super(getRandom);\r\n\r\n    const hit = Boolean(combatLogEntry.shotsHit);\r\n\r\n    this.particleEmitterContainer = particleEmitterContainer;\r\n\r\n    this.extraWait = getRandom() * 2000;\r\n    let startTime = time + this.extraWait;\r\n    const speed = args.speed || 1;\r\n\r\n    const startPosition = getPosition(shooterIcon, startTime).position.add(\r\n      this.getLocationForSystem(\r\n        weapon,\r\n        shooterIcon,\r\n        getPosition(shooterIcon, startTime).facing\r\n      )\r\n    );\r\n    startPosition.z += shooterIcon.shipZ;\r\n\r\n    const endPosition = getPosition(targetIcon, startTime).position.add(\r\n      this.getRandomPosition(20)\r\n    );\r\n    endPosition.z += targetIcon.shipZ;\r\n\r\n    const distance = startPosition.distanceTo(endPosition);\r\n    this.duration = distance / speed;\r\n\r\n    let fade = 0;\r\n\r\n    if (!hit) {\r\n      const extra = getRandom() * 300 + 300;\r\n      this.duration += extra;\r\n      fade = extra * 0.8;\r\n    }\r\n\r\n    this.animations = [];\r\n\r\n    this.animations.push(\r\n      weaponAnimationService.getBoltEffect(\r\n        startTime,\r\n        startPosition,\r\n        endPosition.clone(),\r\n        speed,\r\n        fade,\r\n        this.duration,\r\n        args,\r\n        this\r\n      )\r\n    );\r\n\r\n    this.explosion = null;\r\n\r\n    if (!combatLogEntry.causedDamage()) {\r\n      return;\r\n    }\r\n\r\n    if (hit) {\r\n      weaponAnimationService.getDamageExplosion(\r\n        args.explosionSize,\r\n        endPosition,\r\n        startTime + this.duration,\r\n        this\r\n      );\r\n\r\n      this.duration += 1000;\r\n    }\r\n  }\r\n\r\n  getDuration() {\r\n    return this.duration + this.extraWait;\r\n  }\r\n\r\n  deactivate() {\r\n    this.particleEmitterContainer.release(this);\r\n  }\r\n}\r\n\r\nexport default ShipWeaponBoltAnimation;\r\n","import * as THREE from \"three\";\r\nimport Vector from \"../../../../../model/utils/Vector\";\r\nimport ShipWeaponAnimation from \"./ShipWeaponAnimation\";\r\nimport BoltEffect from \"../effect/BoltEffect\";\r\nimport ExplosionEffect from \"../effect/ExplosionEffect\";\r\n\r\nclass ShipWeaponBoltBurstAnimation extends ShipWeaponAnimation {\r\n  constructor(\r\n    time,\r\n    combatLogEntry,\r\n    fireOrder,\r\n    weapon,\r\n    shooterIcon,\r\n    targetIcon,\r\n    getPosition,\r\n    getRandom,\r\n    particleEmitterContainer,\r\n    args,\r\n    weaponAnimationService\r\n  ) {\r\n    super(getRandom);\r\n    this.animations = [];\r\n    this.particleEmitterContainer = particleEmitterContainer;\r\n\r\n    const missesFirst = this.getRandom() > 0.5;\r\n    const speed = args.speed || 1;\r\n\r\n    this.extraWait = getRandom() * 2000;\r\n    let startTime = time + this.extraWait;\r\n\r\n    const startPosition = getPosition(shooterIcon, startTime).position.add(\r\n      this.getLocationForSystem(\r\n        weapon,\r\n        shooterIcon,\r\n        getPosition(shooterIcon, startTime).facing\r\n      )\r\n    );\r\n    startPosition.z += shooterIcon.shipZ;\r\n\r\n    let endPosition = getPosition(targetIcon, startTime).position.add(\r\n      this.getRandomPosition(20)\r\n    );\r\n    endPosition.z += targetIcon.shipZ;\r\n\r\n    const distance = startPosition.distanceTo(endPosition);\r\n    this.duration = distance / speed;\r\n\r\n    let offsetVector = this.getRandomPosition(5);\r\n\r\n    const missExtra = getRandom() * 300 + 300;\r\n    const missFade = missExtra * 0.8;\r\n\r\n    const totalShots = combatLogEntry.totalShots;\r\n    const shotsHit = combatLogEntry.shotsHit;\r\n\r\n    this.startExtra = 0;\r\n    for (let shotNumber = 1; shotNumber <= totalShots; shotNumber++) {\r\n      this.startExtra = (30 / speed) * shotNumber;\r\n\r\n      if (\r\n        (missesFirst && shotNumber <= totalShots - shotsHit) ||\r\n        (!missesFirst && shotNumber > shotsHit)\r\n      ) {\r\n        this.animations.push(\r\n          weaponAnimationService.getBoltEffect(\r\n            this.startExtra + startTime,\r\n            startPosition,\r\n            endPosition.clone(),\r\n            speed,\r\n            missFade,\r\n            this.duration + missExtra,\r\n            args,\r\n            this\r\n          )\r\n        );\r\n      } else {\r\n        this.animations.push(\r\n          weaponAnimationService.getBoltEffect(\r\n            this.startExtra + startTime,\r\n            startPosition,\r\n            endPosition.clone(),\r\n            speed,\r\n            0,\r\n            this.duration,\r\n            args,\r\n            this\r\n          )\r\n        );\r\n\r\n        weaponAnimationService.getDamageExplosion(\r\n          args.explosionSize,\r\n          endPosition,\r\n          this.startExtra + startTime + this.duration,\r\n          this\r\n        );\r\n      }\r\n\r\n      endPosition = endPosition.add(offsetVector);\r\n    }\r\n  }\r\n\r\n  getDuration() {\r\n    return this.duration + this.extraWait + this.startExtra + 1000;\r\n  }\r\n\r\n  deactivate() {\r\n    this.particleEmitterContainer.release(this);\r\n  }\r\n}\r\n\r\nexport default ShipWeaponBoltBurstAnimation;\r\n","import * as THREE from \"three\";\nimport Vector from \"../../../../../model/utils/Vector\";\nimport ShipWeaponAnimation from \"./ShipWeaponAnimation\";\nimport BoltEffect from \"../effect/BoltEffect\";\nimport ExplosionEffect from \"../effect/ExplosionEffect\";\n\nclass ShipWeaponUniversalBoltAnimation extends ShipWeaponAnimation {\n  constructor(props) {\n    super(props);\n    const { args, weaponAnimationService, omitHitExplosion } = props;\n\n    this.animations = [];\n    this.speed = args.speed || 1;\n    this.duration = 0;\n    this.setShots();\n    this.setStartPosition();\n    this.setEndPosition();\n    this.setStartTime();\n\n    const missExtra = this.getRandom() * 300 + 300;\n    const missFade = missExtra * 0.8;\n\n    this.shots.forEach(shot => {\n      const duration =\n        this.startPosition.distanceTo(this.endPosition.add(shot.offset)) /\n        this.speed;\n\n      this.animations.push(\n        weaponAnimationService.getBoltEffect(\n          this.startTime + shot.startExtra,\n          this.startPosition.clone(),\n          this.endPosition.clone(),\n          this.speed,\n          shot.hit ? 0 : missFade,\n          shot.hit ? duration : duration + missExtra,\n          props.args,\n          this\n        )\n      );\n\n      if (shot.hit && !omitHitExplosion) {\n        this.animations.push(\n          weaponAnimationService.getDamageExplosion(\n            props.args.explosionSize,\n            props.args.explosionType,\n            this.endPosition.add(shot.offset),\n            this.startTime + shot.startExtra + duration,\n            this\n          )\n        );\n      }\n    });\n  }\n\n  setShots() {\n    const { totalShots, shotsHit } = this.props;\n\n    let startExtra = 0;\n    this.shots = [];\n    const hitsStart = Math.floor(this.getRandom() * (totalShots - shotsHit));\n\n    const offsetVector = this.getRandomPosition(5);\n\n    for (let currentShot = 0; currentShot < totalShots; currentShot++) {\n      const hit =\n        currentShot >= hitsStart && currentShot < hitsStart + shotsHit;\n\n      startExtra = (30 / this.speed) * currentShot;\n\n      const n = currentShot - hitsStart;\n\n      let offset = new Vector();\n      if (n < 0) {\n        offset = offset.sub(offsetVector.multiplyScalar(Math.abs(n)));\n      } else if (n > 0) {\n        offset = offset.add(offsetVector.multiplyScalar(Math.abs(n)));\n      }\n\n      this.shots.push({\n        startExtra: startExtra,\n        hit,\n        offset\n      });\n    }\n  }\n\n  getFirstHit() {\n    return this.shots.find(shot => shot.hit);\n  }\n\n  setEndPosition() {\n    const {\n      targetIcon,\n      animationStartTime,\n      impactPosition,\n      getPosition,\n      shotsHit\n    } = this.props;\n\n    if (impactPosition) {\n      if (shotsHit === 0) {\n        this.endPosition = impactPosition.add(this.getRandomPosition(20));\n      } else {\n        this.endPosition = impactPosition;\n      }\n    } else {\n      this.endPosition = getPosition(\n        targetIcon,\n        animationStartTime\n      ).position.add(this.getRandomPosition(20));\n      this.endPosition.z += targetIcon.shipZ;\n    }\n  }\n\n  setStartTime() {\n    const { animationStartTime, impactTime } = this.props;\n\n    if (impactTime) {\n      this.startWait = 0;\n      const firstHit = this.getFirstHit();\n      const startExtra = firstHit ? firstHit.startExtra : 0;\n\n      const distance = this.startPosition.distanceTo(this.endPosition);\n      this.duration = distance / this.speed;\n      this.startTime = impactTime - (startExtra + this.duration);\n    } else {\n      this.startWait = this.getRandom() * 2000;\n      this.startTime = animationStartTime + this.startWait;\n      const distance = this.startPosition.distanceTo(this.endPosition);\n      this.duration = distance / this.speed;\n    }\n  }\n\n  setStartPosition() {\n    const { shooterIcon, weapon, animationStartTime, getPosition } = this.props;\n    this.startPosition = getPosition(\n      shooterIcon,\n      animationStartTime\n    ).position.add(\n      this.getLocationForSystem(\n        weapon,\n        shooterIcon,\n        getPosition(shooterIcon, animationStartTime).facing\n      )\n    );\n  }\n\n  getDuration() {\n    return this.duration + this.startWait + 1000;\n  }\n\n  deactivate() {\n    this.particleEmitterContainer.release(this);\n  }\n}\n\nexport default ShipWeaponUniversalBoltAnimation;\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass AnimationUiStrategy extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n    this.animations = [];\r\n  }\r\n\r\n  deactivate() {\r\n    this.removeAllAnimations();\r\n    super.deactivate();\r\n  }\r\n\r\n  render(payload) {\r\n    this.animations.forEach(animation => animation.render(payload));\r\n  }\r\n\r\n  removeAllAnimations() {\r\n    this.animations.forEach(animation => animation.deactivate());\r\n    this.animations = [];\r\n  }\r\n\r\n  removeAnimation(toRemove) {\r\n    this.animations = this.animations.filter(function(animation) {\r\n      return animation !== animation;\r\n    });\r\n\r\n    toRemove.deactivate();\r\n  }\r\n}\r\n\r\nexport default AnimationUiStrategy;\r\n","import {\r\n  ShipIdleMovementAnimation,\r\n  ShipSystemAnimation\r\n} from \"../../animation\";\r\n\r\nimport AnimationUiStrategy from \"./AnimationUiStrategy\";\r\n\r\nclass ShowShipObjects extends AnimationUiStrategy {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  update(gamedata) {\r\n    super.update(gamedata);\r\n    const { shipIconContainer } = this.services;\r\n\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      const ship = icon.ship;\r\n\r\n      if (ship.isDestroyed()) {\r\n        icon.hide();\r\n      } else {\r\n        icon.show();\r\n        this.animations.push(\r\n          new ShipIdleMovementAnimation(icon, gamedata.terrain)\r\n        );\r\n        this.animations.push(new ShipSystemAnimation(icon));\r\n      }\r\n      return this;\r\n    });\r\n  }\r\n\r\n  shipStateChanged(ship) {\r\n    this.animations\r\n      .filter(animation => animation.ship === ship)\r\n      .forEach(animation => {\r\n        animation.update();\r\n      });\r\n  }\r\n\r\n  shipSystemStateChanged({ ship, system }) {\r\n    this.animations\r\n      .filter(animation => animation.ship === ship)\r\n      .forEach(animation => {\r\n        if (animation.updateSystem) {\r\n          animation.updateSystem(system);\r\n        }\r\n      });\r\n  }\r\n\r\n  deactivate() {\r\n    const { shipIconContainer } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      icon.hide();\r\n    }, this);\r\n\r\n    return super.deactivate();\r\n  }\r\n}\r\n\r\nexport default ShowShipObjects;\r\n","import UiStrategy from \"./UiStrategy\";\n\nclass RightClickShowsShipWindow extends UiStrategy {\n  shipRightClicked(payload) {\n    const { uiState } = this.services;\n    //TODO: open tooltip in ship window mode?\n  }\n}\n\nexport default RightClickShowsShipWindow;\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass MouseOverShowsShipTooltip extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n\r\n    this.clickedShip = null;\r\n    this.mouseOveredShip = null;\r\n  }\r\n\r\n  shipStateChanged(ship) {\r\n    const { uiState, shipIconContainer } = this.services;\r\n    if (this.clickedShip === ship) {\r\n      uiState.showShipTooltip(shipIconContainer.getByShip(ship), true);\r\n    }\r\n  }\r\n\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    if (this.clickedShip) {\r\n      uiState.hideShipTooltip(this.clickedShip);\r\n    }\r\n  }\r\n\r\n  shipClicked(payload) {\r\n    const { uiState } = this.services;\r\n\r\n    if (this.clickedShip) {\r\n      uiState.hideShipTooltip(this.clickedShip);\r\n    }\r\n\r\n    uiState.showShipTooltip(payload.entity, true);\r\n    this.clickedShip = payload.entity.ship;\r\n  }\r\n\r\n  hexClicked() {\r\n    if (!this.clickedShip) {\r\n      return;\r\n    }\r\n\r\n    const { uiState } = this.services;\r\n\r\n    if (uiState.state.systemMenu.activeSystem) {\r\n      return;\r\n    }\r\n\r\n    uiState.hideShipTooltip(this.clickedShip);\r\n    this.clickedShip = null;\r\n  }\r\n\r\n  mouseOverShip(payload) {\r\n    if (this.clickedShip === payload.entity.ship) {\r\n      return;\r\n    }\r\n\r\n    const { uiState } = this.services;\r\n\r\n    if (this.mouseOveredShip) {\r\n      uiState.hideShipTooltip(this.mouseOveredShip);\r\n    }\r\n\r\n    if (this.clickedShip) {\r\n      uiState.hideShipTooltip(this.clickedShip);\r\n    }\r\n\r\n    uiState.showShipTooltip(payload.entity);\r\n    this.mouseOveredShip = payload.entity.ship;\r\n  }\r\n\r\n  mouseOutShip(payload) {\r\n    const { shipIconContainer } = this.services;\r\n\r\n    if (this.clickedShip === payload.entity.ship) {\r\n      return;\r\n    }\r\n\r\n    const { uiState } = this.services;\r\n    uiState.hideShipTooltip(payload.entity.ship);\r\n    this.mouseOveredShip = null;\r\n\r\n    if (this.clickedShip) {\r\n      uiState.showShipTooltip(\r\n        shipIconContainer.getByShip(this.clickedShip),\r\n        true\r\n      );\r\n    }\r\n  }\r\n\r\n  /*\r\n  mouseOut() {\r\n    const { uiState } = this.services;\r\n    if (this.mouseOveredShip && this.mouseOveredShip !== this.clickedShip) {\r\n      uiState.hideShipTooltip(this.mouseOveredShip.ship);\r\n    }\r\n\r\n    this.mouseOveredShip = null;\r\n  }\r\n  */\r\n}\r\n\r\nexport default MouseOverShowsShipTooltip;\r\n","import UiStrategy from \"./UiStrategy\";\r\nimport {\r\n  COLOR_FRIENDLY,\r\n  COLOR_ENEMY,\r\n  COLOR_FRIENDLY_HIGHLIGHT,\r\n  COLOR_ENEMY_HIGHLIGHT\r\n} from \"../../../../../model/gameConfig.mjs\";\r\n\r\nclass MouseOverHighlightsShip extends UiStrategy {\r\n  deactivate(payload) {\r\n    this.hide();\r\n  }\r\n\r\n  show(payload) {\r\n    const { currentUser } = this.services;\r\n    if (payload.entity.ship.player.isUsers(currentUser)) {\r\n      payload.entity.replaceEmissive(COLOR_FRIENDLY);\r\n    } else {\r\n      payload.entity.replaceEmissive(COLOR_ENEMY);\r\n    }\r\n  }\r\n\r\n  hide() {\r\n    const { shipIconContainer } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      icon.revertEmissive();\r\n    });\r\n  }\r\n\r\n  mouseOverShip(payload) {\r\n    this.show(payload);\r\n  }\r\n\r\n  mouseOutShip(payload) {\r\n    this.hide();\r\n  }\r\n\r\n  mouseOut() {\r\n    this.hide();\r\n  }\r\n}\r\n\r\nexport default MouseOverHighlightsShip;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass SelectUndeployedShip extends UiStrategy {\r\n  update(gameData) {\r\n    const { uiState, currentUser } = this.services;\r\n\r\n    if (uiState.getSelectedShip()) {\r\n      return;\r\n    }\r\n\r\n    const ships = gameData.getShipsForUser(currentUser);\r\n    let ship = ships.find(s => s.movement.getDeployMove());\r\n\r\n    if (!ship) {\r\n      ship = ships[0];\r\n    }\r\n\r\n    if (!ship) {\r\n      return;\r\n    }\r\n\r\n    uiState.selectShip(ship);\r\n  }\r\n}\r\n\r\nexport default SelectUndeployedShip;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass DeployShipOnHexClick extends UiStrategy {\r\n  hexClicked({ hex }) {\r\n    const { uiState, movementService } = this.services;\r\n    const ship = uiState.getSelectedShip();\r\n\r\n    if (!ship || !this.gameData) {\r\n      return;\r\n    }\r\n\r\n    const slot = this.gameData.slots.getSlotByShip(ship);\r\n\r\n    if (!slot.isValidShipDeployment(ship, hex)) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.gameData.ships\r\n        .getShips()\r\n        .find(\r\n          otherShip =>\r\n            otherShip !== ship && otherShip.getHexPosition().equals(hex)\r\n        )\r\n    ) {\r\n      return;\r\n    }\r\n    movementService.deploy(ship, hex);\r\n    uiState.shipStateChanged(ship);\r\n  }\r\n}\r\n\r\nexport default DeployShipOnHexClick;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass AllowSubmittingWhenDeploymentDone extends UiStrategy {\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.setTurnReady(false);\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n    this.checkDeployment();\r\n  }\r\n\r\n  shipStateChanged() {\r\n    this.checkDeployment();\r\n  }\r\n\r\n  checkDeployment() {\r\n    const { currentUser, uiState } = this.services;\r\n    const result = this.gameData.ships.getShips().every(ship => {\r\n      if (!ship.player.isUsers(currentUser)) {\r\n        return true;\r\n      }\r\n\r\n      const slot = this.gameData.slots.getSlotByShip(ship);\r\n\r\n      if (slot.isValidShipDeployment(ship, ship.getHexPosition())) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    });\r\n\r\n    uiState.setTurnReady(result);\r\n  }\r\n}\r\n\r\nexport default AllowSubmittingWhenDeploymentDone;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass SelectedShipDeploymentMovementUi extends UiStrategy {\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.hideShipMovement();\r\n  }\r\n\r\n  shipStateChanged() {\r\n    const { uiState } = this.services;\r\n    const ship = uiState.getSelectedShip();\r\n\r\n    if (ship) {\r\n      uiState.showShipDeploymentMovement(ship, true);\r\n    }\r\n  }\r\n\r\n  shipSelected(ship) {\r\n    const { uiState } = this.services;\r\n    uiState.showShipDeploymentMovement(ship, true);\r\n  }\r\n\r\n  shipDeselected() {\r\n    const { uiState } = this.services;\r\n    uiState.hideShipMovement();\r\n  }\r\n}\r\n\r\nexport default SelectedShipDeploymentMovementUi;\r\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass ShowWaitingStatus extends UiStrategy {\r\n  activate(services) {\r\n    super.activate(services);\r\n    const { uiState } = this.services;\r\n    uiState.setWaiting(true);\r\n  }\r\n\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.setWaiting(false);\r\n  }\r\n}\r\n\r\nexport default ShowWaitingStatus;\r\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass SelectFirstActiveShip extends UiStrategy {\r\n  update(gameData) {\r\n    const { uiState, currentUser } = this.services;\r\n\r\n    if (\r\n      uiState.getSelectedShip() &&\r\n      gameData.activeShips.isActive(uiState.getSelectedShip())\r\n    ) {\r\n      const oldShip = uiState.getSelectedShip();\r\n      const newShip = gameData.ships.getShipById(oldShip.id);\r\n      if (oldShip !== newShip) {\r\n        uiState.selectShip(newShip);\r\n      }\r\n      return;\r\n    }\r\n\r\n    const ship = gameData.getActiveShipsForUser(currentUser).pop();\r\n\r\n    if (ship) {\r\n      uiState.selectShip(ship);\r\n    }\r\n  }\r\n}\r\n\r\nexport default SelectFirstActiveShip;\r\n","import UiStrategy from \"./UiStrategy\";\r\nimport * as gameUiModes from \"../gameUiModes\";\r\n\r\nclass AllShipsMovementPaths extends UiStrategy {\r\n  deactivate() {\r\n    const { movementPathService } = this.services;\r\n    movementPathService.hideAllMovementPaths();\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n    this.show();\r\n  }\r\n\r\n  uiStateChanged() {\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    this.show();\r\n  }\r\n\r\n  shipStateChanged(ship) {\r\n    const { movementPathService, uiState } = this.services;\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !uiState.hasGameUiMode(gameUiModes.MOVEMENT) ||\r\n      uiState.getSelectedShip() !== ship\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    movementPathService.showMovementPath(ship);\r\n  }\r\n\r\n  mouseOutShip() {\r\n    this.show();\r\n  }\r\n\r\n  show() {\r\n    const { movementPathService, uiState } = this.services;\r\n\r\n    if (uiState.hasGameUiMode(gameUiModes.MOVEMENT)) {\r\n      const ships = this.gameData.ships.getAliveShips();\r\n      ships.forEach(ship => movementPathService.showMovementPath(ship));\r\n    } else {\r\n      movementPathService.hideAllMovementPaths();\r\n\r\n      /*\r\n      const ship = uiState.getSelectedShip();\r\n      if (ship) {\r\n        movementPathService.showMovementPath(ship);\r\n      }\r\n      */\r\n    }\r\n  }\r\n}\r\n\r\nexport default AllShipsMovementPaths;\r\n","export const WEAPONS = \"weapons\";\r\nexport const ENEMY_WEAPONS = \"enemy_weapons\";\r\nexport const MOVEMENT = \"movement\";\r\nexport const EW = \"ew\";\r\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass AllowSubmittingOnValidGameState extends UiStrategy {\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.setTurnReady(false);\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n\r\n    const { uiState } = this.services;\r\n    uiState.setTurnReady(true);\r\n  }\r\n}\r\n\r\nexport default AllowSubmittingOnValidGameState;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass AutomaticReplay extends UiStrategy {\r\n  constructor(phaseStrategy, replayContext) {\r\n    super();\r\n    this.phaseStrategy = phaseStrategy;\r\n    this.replayContext = replayContext;\r\n  }\r\n\r\n  async newTurn(gameDatas) {\r\n    const { shipIconContainer } = this.services;\r\n\r\n    await shipIconContainer.shipsLoaded();\r\n\r\n    setTimeout(() => {\r\n      this.phaseStrategy.animateFromTo(0);\r\n    }, 500);\r\n  }\r\n\r\n  render({ delta, total }) {\r\n    if (total >= this.replayContext.getTurnLength() + 2000) {\r\n      const { uiState } = this.services;\r\n      uiState.closeReplay();\r\n    }\r\n  }\r\n}\r\n\r\nexport default AutomaticReplay;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass ShowReplayUi extends UiStrategy {\r\n  constructor(replayContext) {\r\n    super();\r\n    this.replayContext = replayContext;\r\n  }\r\n\r\n  activate(services) {\r\n    super.activate(services);\r\n    const { uiState } = this.services;\r\n    uiState.showReplayUi(this.replayContext);\r\n  }\r\n\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.showReplayUi(false);\r\n  }\r\n}\r\n\r\nexport default ShowReplayUi;\r\n","import * as React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { TooltipMenu, TooltipButton } from \"../../../../styled\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst Text = css`\r\n  color: white;\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n  font-family: arial;\r\n  font-size: 16px;\r\n  text-transform: uppercase;\r\n`;\r\n\r\nconst ShipName = styled.div`\r\n  ${Text}\r\n  padding: 0 5px 0 30px;\r\n  width: 200px;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst Amount = styled.div`\r\n  ${Text}\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 25px;\r\n  height: 25px;\r\n`;\r\n\r\nclass OEWButtons extends React.PureComponent {\r\n  render() {\r\n    const { name, ship, target, uiState, oew } = this.props;\r\n\r\n    return (\r\n      <Container>\r\n        {name && <ShipName>{name}</ShipName>}\r\n        <TooltipButton\r\n          img=\"/img/removeOEW.png\"\r\n          onClick={() => {\r\n            if (ship.electronicWarfare.canAssignOffensiveEw(target, -1)) {\r\n              ship.electronicWarfare.assignOffensiveEw(target, -1);\r\n              uiState.shipStateChanged(ship);\r\n            }\r\n          }}\r\n        />\r\n        <Amount>{oew}</Amount>\r\n        <TooltipButton\r\n          img=\"/img/addOEW.png\"\r\n          onClick={() => {\r\n            if (ship.electronicWarfare.canAssignOffensiveEw(target, 1)) {\r\n              ship.electronicWarfare.assignOffensiveEw(target, 1);\r\n              uiState.shipStateChanged(ship);\r\n            }\r\n          }}\r\n        />\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default OEWButtons;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  top: 0px;\r\n  left: 0px;\r\n`;\r\n\r\nclass GamePositionComponent extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.containerRef = React.createRef();\r\n    this.renderCallback = this.onGameRender.bind(this);\r\n    this.position = null;\r\n    this.state = {\r\n      position: null\r\n    };\r\n  }\r\n\r\n  onGameRender() {\r\n    const { getPosition, marginTop = 0, marginLeft = 0 } = this.props;\r\n\r\n    if (!this.containerRef.current) {\r\n      return;\r\n    }\r\n\r\n    const newPosition = getPosition();\r\n\r\n    if (\r\n      !this.position ||\r\n      this.position.x !== newPosition.x ||\r\n      this.position.y !== newPosition.y\r\n    ) {\r\n      this.position = newPosition;\r\n\r\n      this.containerRef.current.style.left = `${newPosition.x + marginLeft}px`;\r\n      this.containerRef.current.style.top = `${newPosition.y + marginTop}px`;\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { uiState } = this.props;\r\n\r\n    uiState.subscribeToRender(this.renderCallback);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    const { uiState } = this.props;\r\n\r\n    uiState.unsubscribeFromRender(this.renderCallback);\r\n  }\r\n\r\n  render() {\r\n    const { children } = this.props;\r\n\r\n    /*\r\n    style={{\r\n          top: position.y + marginTop + \"px\",\r\n          left: position.x + marginLeft + \"px\"\r\n        }}\r\n        */\r\n\r\n    return <Container ref={this.containerRef}>{children}</Container>;\r\n  }\r\n}\r\n\r\nexport default GamePositionComponent;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  Tooltip,\r\n  TooltipHeader,\r\n  TooltipEntry,\r\n  colors\r\n} from \"../../../../styled\";\r\n\r\nconst InfoHeader = styled(TooltipHeader)`\r\n  font-size: 12px;\r\n`;\r\n\r\nconst SystemInfoTooltip = styled(Tooltip)`\r\n  position: absolute;\r\n  z-index: 20000;\r\n  ${props =>\r\n    Object.keys(props.position).reduce((style, key) => {\r\n      return style + \"\\n\" + key + \":\" + props.position[key] + \"px;\";\r\n    }, \"\")}\r\n  width: ${props => (props.ship ? \"300px\" : \"200px\")};\r\n  text-align: left;\r\n  filter: brightness(1);\r\n`;\r\n\r\nexport const Entry = styled(TooltipEntry)`\r\n  text-align: left;\r\n  color: #5e85bc;\r\n  font-family: arial;\r\n  font-size: 11px;\r\n`;\r\n\r\nexport const Header = styled.span`\r\n  color: white;\r\n`;\r\n\r\nconst InfoValue = styled.span`\r\n  color: ${colors.lightBlue};\r\n`;\r\n\r\nclass SystemInfoWeaponTargeting extends React.Component {\r\n  render() {\r\n    const { ship, system, uiState, target, hitChange } = this.props;\r\n\r\n    return (\r\n      <>\r\n        <InfoHeader>TARGET: {target.name}</InfoHeader>\r\n        <Entry>\r\n          <Header>Base hit change: </Header>\r\n          <InfoValue>{hitChange.baseToHit}%</InfoValue>\r\n        </Entry>\r\n        <Entry>\r\n          <Header>Fire control: </Header>\r\n          <InfoValue>+{hitChange.fireControl} to hit</InfoValue>\r\n        </Entry>\r\n        <Entry>\r\n          <Header>Distance: </Header>\r\n          <InfoValue>\r\n            {hitChange.distance} hexas,{\" \"}\r\n            {hitChange.outOfRange\r\n              ? `out of range`\r\n              : `${hitChange.rangeModifier} to hit`}\r\n          </InfoValue>\r\n        </Entry>\r\n        <Entry>\r\n          <Header>OEW: </Header>\r\n          <InfoValue>+{hitChange.oew * 5} to hit</InfoValue>\r\n        </Entry>\r\n        <Entry>\r\n          <Header>DEW: </Header>\r\n          <InfoValue>-{hitChange.dew * 5} to hit</InfoValue>\r\n        </Entry>\r\n        <Entry>\r\n          <Header>FINAL HIT CHANGE: </Header>\r\n          <InfoValue>{hitChange.result}%</InfoValue>\r\n        </Entry>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SystemInfoWeaponTargeting;\r\n","import React from \"react\";\r\nimport {\r\n  RelativeTooltip,\r\n  TooltipHeader,\r\n  TooltipEntry,\r\n  TooltipValueHeader,\r\n  TooltipValue\r\n} from \"../../../../../../styled\";\r\nimport styled from \"styled-components\";\r\n\r\nconst CargoTooltipContainer = styled(RelativeTooltip)`\r\n  width: 200px;\r\n`;\r\n\r\nclass CargoTooltip extends React.Component {\r\n  render() {\r\n    const { element, cargo, additionalContent } = this.props;\r\n\r\n    return (\r\n      <CargoTooltipContainer element={element}>\r\n        <TooltipHeader>{cargo.getDisplayName()}</TooltipHeader>\r\n        {cargo.getCargoInfo().map(getEntry)}\r\n        {additionalContent}\r\n      </CargoTooltipContainer>\r\n    );\r\n  }\r\n}\r\n\r\nconst getEntry = ({ header, value }, i) => {\r\n  if (value.replace) {\r\n    value = value.replace(/<br>/gm, \"\\n\");\r\n  }\r\n\r\n  return (\r\n    <TooltipEntry key={`cargoTooltipEntry-${header}-${i}`}>\r\n      {header && <TooltipValueHeader>{header}: </TooltipValueHeader>}\r\n      {value && <TooltipValue>{value}</TooltipValue>}\r\n    </TooltipEntry>\r\n  );\r\n};\r\n\r\nexport default CargoTooltip;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { IconAndLabel } from \"../../../../../../styled\";\r\nimport CargoTooltip from \"./CargoTooltip\";\r\n\r\nconst Container = styled.div`\r\n  position: relative;\r\n  margin: 0;\r\n  padding: 0;\r\n  ${props => props.onClick && \"cursor: pointer;\"}\r\n`;\r\n\r\nclass CargoItem extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.element = React.createRef();\r\n    this.state = {\r\n      mouseOveredCargo: null\r\n    };\r\n  }\r\n\r\n  onCargoMouseOver(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n    this.setState({ mouseOveredCargo: this.element });\r\n  }\r\n\r\n  onCargoMouseOut(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n    this.setState({ mouseOveredCargo: null });\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      cargo,\r\n      amount,\r\n      handleOnClick = () => {},\r\n      tooltipAdditionalContent,\r\n      text,\r\n      ...rest\r\n    } = this.props;\r\n    const { mouseOveredCargo } = this.state;\r\n\r\n    return (\r\n      <Container\r\n        onClick={handleOnClick}\r\n        onMouseOver={this.onCargoMouseOver.bind(this)}\r\n        onMouseOut={this.onCargoMouseOut.bind(this)}\r\n        {...rest}\r\n      >\r\n        {mouseOveredCargo && (\r\n          <CargoTooltip\r\n            element={mouseOveredCargo}\r\n            cargo={cargo}\r\n            additionalContent={tooltipAdditionalContent}\r\n          />\r\n        )}\r\n        <IconAndLabel\r\n          ref={c => (this.element = c)}\r\n          background={cargo.getBackgroundImage()}\r\n        >\r\n          {text ? text : amount}\r\n        </IconAndLabel>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CargoItem;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { IconAndLabel, TooltipSubHeader } from \"../../../../../../styled\";\r\nimport CargoItem from \"./CargoItem\";\r\n\r\nconst CargoListContainer = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n`;\r\n\r\nclass CargoList extends React.Component {\r\n  onSystemMouseOver(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n\r\n    let { uiState, system, ship } = this.props;\r\n\r\n    uiState.customEvent(\"systemMouseOver\", {\r\n      ship,\r\n      system,\r\n      element: this.element\r\n    });\r\n\r\n    this.setState({ mouseOveredSystem: this.element });\r\n  }\r\n\r\n  onSystemMouseOut(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n\r\n    let { uiState } = this.props;\r\n\r\n    uiState.customEvent(\"systemMouseOut\");\r\n\r\n    this.setState({ mouseOveredSystem: null });\r\n  }\r\n\r\n  render() {\r\n    const { list } = this.props;\r\n\r\n    return (\r\n      <>\r\n        <TooltipSubHeader>Current cargo</TooltipSubHeader>\r\n        <CargoListContainer>\r\n          {list.map(({ object, amount }, i) => (\r\n            <CargoItem key={`cargo-item-${i}`} cargo={object} amount={amount} />\r\n          ))}\r\n        </CargoListContainer>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CargoList;\r\n","import React from \"react\";\n\nimport {\n  IconAndLabel,\n  TooltipHeader,\n  TooltipSubHeader,\n  TooltipEntry,\n  TooltipValueHeader,\n  TooltipValue,\n  InlineTooltipEntry\n} from \"../../../../../../styled\";\nimport styled from \"styled-components\";\nimport CargoItem from \"../cargo/CargoItem\";\nimport NoAmmunitionLoaded from \"../../../../../../../model/unit/system/weapon/ammunition/NoAmmunitionLoaded.mjs\";\n\nconst TorpedoList = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\nclass TorpedoLauncher extends React.PureComponent {\n  systemChangedCallback(ship, system) {\n    if (\n      ship.id === this.props.ship.id &&\n      system.id === this.props.launcher.system.id\n    ) {\n      this.forceUpdate();\n    }\n  }\n\n  componentDidMount() {\n    const { uiState } = this.props;\n    this.systemChangedCallbackInstance = this.systemChangedCallback.bind(this);\n    uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);\n  }\n\n  componentWillUnmount() {\n    const { uiState } = this.props;\n    uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);\n  }\n\n  unloadAmmo() {\n    return e => {\n      e.preventDefault();\n      e.stopPropagation();\n      const { ship, launcher, uiState, launcherIndex } = this.props;\n\n      launcher.unloadAmmo({ launcherIndex });\n      uiState.shipSystemStateChanged(ship, launcher.system);\n    };\n  }\n\n  loadTorpedo(torpedo) {\n    return e => {\n      e.preventDefault();\n      e.stopPropagation();\n      const { ship, launcher, uiState, launcherIndex } = this.props;\n\n      launcher.loadAmmo({ ammo: torpedo, launcherIndex });\n      uiState.shipSystemStateChanged(ship, launcher.system);\n    };\n  }\n\n  render() {\n    const {\n      launcherIndex,\n      loadedTorpedo,\n      loadingTime,\n      turnsLoaded,\n      torpedoClass,\n      launcher\n    } = this.props;\n\n    return (\n      <>\n        <TooltipHeader>Torpedo tube {launcherIndex}</TooltipHeader>\n        <InlineTooltipEntry>\n          <TooltipEntry>\n            <TooltipValueHeader>Loading: </TooltipValueHeader>\n            <TooltipValue>{`${turnsLoaded}/${loadingTime}`}</TooltipValue>\n          </TooltipEntry>\n\n          <InlineTooltipEntry>\n            <TooltipValueHeader>Loaded torpedo:</TooltipValueHeader>\n            <CargoItem\n              cargo={loadedTorpedo ? loadedTorpedo : new NoAmmunitionLoaded()}\n              amount={null}\n            />\n          </InlineTooltipEntry>\n        </InlineTooltipEntry>\n\n        <TooltipEntry>\n          <TooltipValueHeader>Select torpedo to load: </TooltipValueHeader>\n        </TooltipEntry>\n\n        <TorpedoList>\n          {launcher.getPossibleTorpedosToLoad().map(({ object, amount }, i) => (\n            <CargoItem\n              handleOnClick={this.loadTorpedo(object).bind(this)}\n              key={`torpedo-launcer-${i}-possible-torpedo-${object.constructor.name}`}\n              cargo={object}\n              amount={amount}\n            />\n          ))}\n          {loadedTorpedo && (\n            <CargoItem\n              handleOnClick={this.unloadAmmo().bind(this)}\n              key={`torpedo-launcer-unload`}\n              cargo={new NoAmmunitionLoaded()}\n              amount={null}\n            />\n          )}\n        </TorpedoList>\n      </>\n    );\n  }\n}\n\nexport default TorpedoLauncher;\n","import React from \"react\";\r\n\r\nimport {\r\n  IconAndLabel,\r\n  TooltipHeader,\r\n  TooltipSubHeader,\r\n  TooltipEntry,\r\n  TooltipValueHeader,\r\n  TooltipValue,\r\n  InlineTooltipEntry,\r\n  CenteredTooltipEntry,\r\n  TooltipButton\r\n} from \"../../../../../../styled\";\r\nimport styled from \"styled-components\";\r\nimport CargoItem from \"../cargo/CargoItem\";\r\nimport NoAmmunitionLoaded from \"../../../../../../../model/unit/system/weapon/ammunition/NoAmmunitionLoaded.mjs\";\r\n\r\nconst LoadingList = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-around;\r\n`;\r\n\r\nconst NewTargetContainer = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst MagazineTooltipEntry = styled(InlineTooltipEntry)`\r\n  justify-content: flex-start;\r\n`;\r\n\r\nconst LoadingButton = styled(TooltipButton)`\r\n  width: 20px;\r\n  height: 20px;\r\n`;\r\n\r\nclass Ammo extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = { loadingOpen: false };\r\n  }\r\n\r\n  systemChangedCallback(ship, system) {\r\n    if (\r\n      ship.id === this.props.ship.id &&\r\n      system.id === this.props.ammoStrategy.system.id\r\n    ) {\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { uiState } = this.props;\r\n    this.systemChangedCallbackInstance = this.systemChangedCallback.bind(this);\r\n    uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    const { uiState } = this.props;\r\n    uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);\r\n  }\r\n\r\n  getNewLoadOutButtons() {\r\n    const { ammoStrategy, uiState, ship } = this.props;\r\n\r\n    const loadingTarget = ammoStrategy.getLoadingTarget();\r\n    ammoStrategy.ammunitionClasses\r\n      .filter(\r\n        className =>\r\n          !loadingTarget.find(entry => entry.object instanceof className)\r\n      )\r\n      .forEach(notFound => {\r\n        loadingTarget.push({\r\n          object: new notFound(),\r\n          amount: 0\r\n        });\r\n      });\r\n\r\n    loadingTarget.sort((a, b) => {\r\n      if (a.object.constructor.name > b.object.constructor.name) {\r\n        return 1;\r\n      }\r\n\r\n      if (a.object.constructor.name < b.object.constructor.name) {\r\n        return -1;\r\n      }\r\n\r\n      return 0;\r\n    });\r\n\r\n    return (\r\n      <LoadingList>\r\n        {loadingTarget.map(({ object, amount }, i) => (\r\n          <NewTargetContainer key={`new-loading-${i}`}>\r\n            <LoadingButton\r\n              img=\"/img/minus.png\"\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n\r\n                ammoStrategy.addToLoading({ object, amount: -1 });\r\n                this.forceUpdate();\r\n              }}\r\n            />\r\n            <CargoItem\r\n              key={`torpedo-launcer-${i}-possible-torpedo-${object.constructor.name}`}\r\n              cargo={object}\r\n              amount={amount}\r\n            />\r\n            <LoadingButton\r\n              img=\"/img/plus.png\"\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n\r\n                ammoStrategy.addToLoading({ object, amount: 1 });\r\n                this.forceUpdate();\r\n              }}\r\n            />\r\n          </NewTargetContainer>\r\n        ))}\r\n      </LoadingList>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { ammoStrategy, uiState, ship } = this.props;\r\n    const { loadingOpen } = this.state;\r\n\r\n    if (!ship.player.isUsers(uiState.services.currentUser)) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <>\r\n        {!loadingOpen && (\r\n          <>\r\n            <TooltipHeader>AMMO MAGAZINE</TooltipHeader>\r\n            <TooltipEntry>\r\n              <TooltipValueHeader>Ammo needed to fire</TooltipValueHeader>\r\n              <TooltipValue>{ammoStrategy.ammoPerFireOrder}</TooltipValue>\r\n            </TooltipEntry>\r\n            <MagazineTooltipEntry>\r\n              <TooltipEntry>\r\n                <TooltipValueHeader>Current ammo: </TooltipValueHeader>\r\n                <TooltipValue>\r\n                  {ammoStrategy.getSelectedAmmo().getShortDisplayName()}\r\n                </TooltipValue>\r\n              </TooltipEntry>\r\n            </MagazineTooltipEntry>\r\n            <MagazineTooltipEntry>\r\n              <TooltipEntry>\r\n                <TooltipValueHeader>Ammo in magazine: </TooltipValueHeader>\r\n              </TooltipEntry>\r\n\r\n              {ammoStrategy.getAmmoInMagazine().map(({ object, amount }, i) => (\r\n                <CargoItem\r\n                  key={`torpedo-launcer-${i}-possible-torpedo-${object.constructor.name}`}\r\n                  cargo={object}\r\n                  amount={amount}\r\n                />\r\n              ))}\r\n            </MagazineTooltipEntry>\r\n\r\n            <TooltipEntry>\r\n              <TooltipValue>NOTE: Magazine reloaded only offline</TooltipValue>\r\n            </TooltipEntry>\r\n\r\n            <CenteredTooltipEntry\r\n              clickable\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this.setState({ loadingOpen: true });\r\n              }}\r\n            >\r\n              <TooltipValueHeader>CLICK TO LOAD NEW AMMO</TooltipValueHeader>\r\n            </CenteredTooltipEntry>\r\n          </>\r\n        )}\r\n\r\n        {loadingOpen && (\r\n          <>\r\n            <TooltipHeader>New loadout</TooltipHeader>\r\n            <TooltipEntry>\r\n              <TooltipValue>NOTE: Magazine reloaded only offline</TooltipValue>\r\n            </TooltipEntry>\r\n            <TooltipEntry>\r\n              <TooltipValueHeader>Cooldown before loading:</TooltipValueHeader>\r\n              <TooltipValue>\r\n                {ammoStrategy.startLoadingAfter} turn(s)\r\n              </TooltipValue>\r\n            </TooltipEntry>\r\n            <TooltipEntry>\r\n              <TooltipValueHeader>Turns offline:</TooltipValueHeader>\r\n              <TooltipValue>{ammoStrategy.turnsOffline} turn(s)</TooltipValue>\r\n            </TooltipEntry>\r\n            <TooltipEntry>\r\n              <TooltipValueHeader>Ammo transfer per turn:</TooltipValueHeader>\r\n              <TooltipValue>{ammoStrategy.intakeInTurn}</TooltipValue>\r\n            </TooltipEntry>\r\n            <TooltipEntry>\r\n              <TooltipValueHeader>Magazine capacity:</TooltipValueHeader>\r\n              <TooltipValue>\r\n                {`${ammoStrategy.getLoadingTargetAmount()}/${\r\n                  ammoStrategy.capacity\r\n                }`}\r\n              </TooltipValue>\r\n            </TooltipEntry>\r\n\r\n            {this.getNewLoadOutButtons()}\r\n            <CenteredTooltipEntry\r\n              clickable\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this.setState({ loadingOpen: false });\r\n              }}\r\n            >\r\n              <TooltipValueHeader>CLOSE</TooltipValueHeader>\r\n            </CenteredTooltipEntry>\r\n            <CenteredTooltipEntry\r\n              clickable\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n\r\n                ship.systems\r\n                  .getSystems()\r\n                  .filter(\r\n                    system =>\r\n                      system.constructor === ammoStrategy.system.constructor\r\n                  )\r\n                  .forEach(system =>\r\n                    system.callHandler(\r\n                      \"setNewLoadingTarget\",\r\n                      ammoStrategy.getLoadingTarget()\r\n                    )\r\n                  );\r\n                this.setState({ loadingOpen: false });\r\n              }}\r\n            >\r\n              <TooltipValueHeader>COPY FOR ALL WEAPONS</TooltipValueHeader>\r\n            </CenteredTooltipEntry>\r\n          </>\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Ammo;\r\n","import React from \"react\";\r\n\r\nimport {\r\n  IconAndLabel,\r\n  TooltipHeader,\r\n  TooltipSubHeader,\r\n  TooltipEntry,\r\n  TooltipValueHeader,\r\n  TooltipValue,\r\n  InlineTooltipEntry,\r\n  CenteredTooltipEntry,\r\n  TooltipButton,\r\n  colors\r\n} from \"../../../../../../styled\";\r\nimport styled from \"styled-components\";\r\nimport CargoItem from \"../cargo/CargoItem\";\r\nimport NoAmmunitionLoaded from \"../../../../../../../model/unit/system/weapon/ammunition/NoAmmunitionLoaded.mjs\";\r\n\r\nconst RangeContainer = styled.div`\r\n  display: flex;\r\n  width: calc(100% - 16px);\r\n  height: 32px;\r\n  align-items: flex-end;\r\n  margin: 0 8px;\r\n`;\r\n\r\nconst RangeNumbersContainer = styled.div`\r\n  width: calc(100% - 16px);\r\n  margin: 0 8px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n`;\r\n\r\nconst RangeStep = styled.div`\r\n  width: 1%;\r\n  height: 100%;\r\n  background-image: url(\"/img/lightBluePixel.png\");\r\n  background-size: 100% ${props => `${props.height}%`};\r\n  background-repeat: no-repeat;\r\n  background-position: bottom 0 left 0;\r\n  opacity: 0.25;\r\n  filter: blur(1px);\r\n\r\n  &:hover {\r\n    opacity: 0.5;\r\n  }\r\n`;\r\n\r\nclass RangePenalty extends React.Component {\r\n  /*\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = { mouseOveredStep: null };\r\n  }\r\n  systemChangedCallback(ship, system) {\r\n    if (\r\n      ship.id === this.props.ship.id &&\r\n      system.id === this.props.rangeStrategy.system.id\r\n    ) {\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { uiState } = this.props;\r\n    this.systemChangedCallbackInstance = this.systemChangedCallback.bind(this);\r\n    uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    const { uiState } = this.props;\r\n    uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);\r\n  }\r\n*/\r\n  render() {\r\n    const { rangeStrategy } = this.props;\r\n\r\n    const step = getMaxRange(rangeStrategy) / 100;\r\n    const steps = [];\r\n    for (let i = 0; i < 100; i++) {\r\n      const rangePenalty = rangeStrategy.getRangeModifier({\r\n        distance: i * step\r\n      });\r\n\r\n      steps.push({\r\n        range: i,\r\n        rangePenalty,\r\n        height: Math.abs(rangePenalty / 200) * 100\r\n      });\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <TooltipEntry>\r\n          <TooltipValueHeader>Range penalty:</TooltipValueHeader>\r\n        </TooltipEntry>\r\n        <RangeContainer>\r\n          {steps.map((entry, i) => (\r\n            <RangeStep key={`rangestep-${i}`} height={entry.height} />\r\n          ))}\r\n        </RangeContainer>\r\n        <RangeNumbersContainer>\r\n          <TooltipValue>0</TooltipValue>\r\n          <TooltipValue>distance</TooltipValue>\r\n          <TooltipValue>{getMaxRange(rangeStrategy)}</TooltipValue>\r\n        </RangeNumbersContainer>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst getMaxRange = rangeStrategy => {\r\n  const ranges = rangeStrategy.rangesAndPenalties;\r\n  return ranges[ranges.length - 1].range;\r\n};\r\n\r\nexport default RangePenalty;\r\n","import React from \"react\";\r\nimport CargoList from \"./cargo/CargoList\";\r\nimport TorpedoLauncher from \"./torpedo/TorpedoLauncher\";\r\nimport Ammo from \"./ammo/Ammo\";\r\nimport RangePenalty from \"./range/RangePenalty\";\r\n\r\nclass SystemStrategyUi extends React.Component {\r\n  render() {\r\n    const { ship, uiState, system } = this.props;\r\n    const { currentUser } = uiState.services;\r\n\r\n    const myShip = ship.player.is(currentUser);\r\n\r\n    return (\r\n      <>\r\n        {system\r\n          .callHandler(\"getUiComponents\", { myShip }, [])\r\n          .map(({ name, props }, i) => {\r\n            switch (name) {\r\n              case \"RangePenalty\":\r\n                return (\r\n                  <RangePenalty\r\n                    key={`rangePenalty-${name}-index-${i}`}\r\n                    uiState={uiState}\r\n                    ship={ship}\r\n                    {...props}\r\n                  />\r\n                );\r\n              case \"Ammo\":\r\n                return (\r\n                  <Ammo\r\n                    key={`ammo-${name}-index-${i}`}\r\n                    uiState={uiState}\r\n                    ship={ship}\r\n                    {...props}\r\n                  />\r\n                );\r\n              case \"CargoList\":\r\n                return (\r\n                  <CargoList\r\n                    key={`cargo-item-${name}-index-${i}`}\r\n                    uiState={uiState}\r\n                    ship={ship}\r\n                    {...props}\r\n                  />\r\n                );\r\n              case \"TorpedoLauncher\":\r\n                return (\r\n                  <TorpedoLauncher\r\n                    key={`torpedo-launcher-${name}-index-${i}`}\r\n                    uiState={uiState}\r\n                    ship={ship}\r\n                    {...props}\r\n                  />\r\n                );\r\n            }\r\n          })}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SystemStrategyUi;\r\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport SystemInfoWeaponTargeting from \"./SystemInfoWeaponTargeting\";\nimport {\n  Tooltip,\n  TooltipHeader,\n  TooltipEntry,\n  colors,\n  TooltipValue,\n  RelativeTooltip,\n  TooltipValueHeader,\n  InlineTooltipEntry,\n  buildTooltipEntries,\n  TooltipSubHeader\n} from \"../../../../styled\";\nimport SystemStrategyUi from \"./SystemStrategyUi\";\n\nconst SystemTooltip = styled(Tooltip)`\n  top: 0px;\n  right: 340px;\n  width: 202px;\n\n  ${props => props.tab && \"width: 302px;\"}\n  transition: width 0.25s;\n  transition-timing-function: ease-in-out;\n`;\n\nconst Warning = styled.div`\n  color: ${colors.textDanger};\n  font-weight: bold;\n\n  animation: blinker 2s linear infinite;\n\n  @keyframes blinker {\n    50% {\n      opacity: 0.5;\n    }\n  }\n`;\n\nconst HeaderMenu = styled.div`\n  line-height: 14px;\n  display: flex;\n  flex-direction: row;\n  color: #5e85bc;\n`;\n\nconst HeaderMenuItem = styled.div`\n  cursor: pointer;\n  font-weight: bolder;\n  margin-right: 4px;\n\n  ${props => props.active && `color: white;`}\n  &:last-child {\n    margin: 0;\n  }\n  :hover {\n    color: white;\n  }\n`;\n\nclass SystemInfo extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tab: null\n    };\n  }\n\n  systemChangedCallback(ship, system) {\n    if (ship.id === this.props.ship.id && system.id === this.props.system.id) {\n      this.forceUpdate();\n    }\n  }\n\n  componentDidMount() {\n    const { uiState } = this.props;\n    this.systemChangedCallbackInstance = this.systemChangedCallback.bind(this);\n    uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);\n  }\n\n  componentWillUnmount() {\n    const { uiState } = this.props;\n    uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);\n  }\n\n  getContainer(children) {\n    const { element, scs } = this.props;\n    const { tab } = this.state;\n\n    if (scs) {\n      return <SystemTooltip tab={tab}>{children}</SystemTooltip>;\n    }\n    return (\n      <RelativeTooltip tab={tab} element={element}>\n        {children}\n      </RelativeTooltip>\n    );\n  }\n\n  getWarnings() {\n    const { system } = this.props;\n    const warnings = [];\n    if (system.isDestroyed()) {\n      warnings.push(\"DESTROYED\");\n    }\n    if (system.power.isOffline()) {\n      warnings.push(\"OFFLINE\");\n    }\n\n    const criticals = system.damage\n      .getCriticals()\n      .map(critical => critical.getMessage());\n\n    return [...warnings, ...criticals].join(\", \");\n  }\n\n  getInfoTab() {\n    const { system } = this.props;\n    return buildTooltipEntries([\n      {\n        value: system.getSystemDescription()\n      }\n    ]);\n  }\n\n  getLogTab() {\n    const { system } = this.props;\n\n    const messages = system.log.getWithTurns();\n\n    return messages.map(({ turn, messages }, index) => (\n      <div key={`systemlog-turn-${turn}-${index}`}>\n        <TooltipSubHeader>{`Log, turn ${turn}`}</TooltipSubHeader>\n        {messages.map((message, messageIndex) => (\n          <TooltipEntry key={`logmessage-${turn}-${index}-${messageIndex}`}>\n            <TooltipValue>{message}</TooltipValue>\n          </TooltipEntry>\n        ))}\n      </div>\n    ));\n  }\n\n  getDefaultTab() {\n    const {\n      ship,\n      system,\n      systemInfoMenuProvider,\n      uiState,\n      weaponTargeting\n    } = this.props;\n\n    const Menu = systemInfoMenuProvider ? systemInfoMenuProvider() : null;\n\n    const warnings = this.getWarnings();\n\n    return (\n      <>\n        {Menu && <Menu uiState={uiState} ship={ship} system={system} />}\n\n        {warnings && (\n          <TooltipEntry>\n            <Warning>{warnings}</Warning>\n          </TooltipEntry>\n        )}\n\n        {buildTooltipEntries(system.getSystemInfo(ship))}\n        <SystemStrategyUi ship={ship} system={system} uiState={uiState} />\n        {weaponTargeting && (\n          <SystemInfoWeaponTargeting\n            uiState={uiState}\n            ship={ship}\n            system={system}\n            target={weaponTargeting.target}\n            hitChange={weaponTargeting.hitChange}\n          />\n        )}\n      </>\n    );\n  }\n  render() {\n    const { system } = this.props;\n\n    const { tab } = this.state;\n\n    return this.getContainer(\n      <>\n        <TooltipHeader>\n          {system.getDisplayName()}\n          <HeaderMenu>\n            <HeaderMenuItem\n              active={tab === \"log\"}\n              onClick={e => {\n                e.preventDefault();\n                e.stopPropagation();\n                this.setState({ tab: \"log\" });\n              }}\n            >\n              L\n            </HeaderMenuItem>\n            <HeaderMenuItem\n              active={tab === \"info\"}\n              onClick={e => {\n                e.preventDefault();\n                e.stopPropagation();\n                this.setState({ tab: \"info\" });\n              }}\n            >\n              ?\n            </HeaderMenuItem>\n\n            <HeaderMenuItem\n              active={!tab}\n              onClick={e => {\n                e.preventDefault();\n                e.stopPropagation();\n                this.setState({ tab: null });\n              }}\n            >\n              D\n            </HeaderMenuItem>\n          </HeaderMenu>\n        </TooltipHeader>\n\n        {!tab && this.getDefaultTab()}\n        {tab === \"log\" && this.getLogTab()}\n        {tab === \"info\" && this.getInfoTab()}\n      </>\n    );\n  }\n}\n\nexport default SystemInfo;\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport SystemInfo from \"./SystemInfo\";\n\nimport { colors } from \"../../../../styled\";\n\nconst HealthBar = styled.div`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 7px;\n  border: 2px solid black;\n  box-sizing: border-box;\n\n  ${props => props.destroyed && \"display: none;\"}\n  background-color: #7a2020;\n\n  :before {\n    content: \"\";\n    position: absolute;\n    width: ${props => `${props.health}%`};\n    height: 100%;\n    left: 0;\n    bottom: 0;\n    background-color: ${props => (props.criticals ? \"#ed6738\" : \"#427231\")};\n  }\n`;\n\nconst SystemText = styled.div`\n  position: absolute;\n  top: 0px;\n  width: 100%;\n  height: calc(100% - 5px);\n  font-family: arial;\n  font-size: 10px;\n  color: white;\n  display: flex;\n  ${props => props.destroyed && \"display: none;\"}\n  align-items: flex-end;\n  justify-content: center;\n  text-shadow: black 0 0 6px, black 0 0 6px, black 0 0 6px, black 0 0 6px;\n`;\n\nconst System = styled.div`\n  position: relative;\n  box-sizing: border-box;\n  width: 30px;\n  height: 30px;\n\n  background-color: \"transparent\";\n  background-image: ${props => `url(${props.background})`};\n  background-size: cover;\n  filter: ${props => {\n    if (props.targeting) {\n      return \"hue-rotate(0deg) brightness(4) grayscale(0)\";\n    } else if (props.reserved) {\n      return \"hue-rotate(0deg) brightness(1) grayscale(0.7)\";\n    } else if (props.firing) {\n      return \"hue-rotate(0deg) brightness(4) grayscale(0)\"; //\"grayscale(100%) brightness(6) drop-shadow(0px 0px 5px white)\";\n    } else if (props.destroyed) {\n      return \"blur(1px) brightness(0.5)\";\n    } else {\n      return \"none\";\n    }\n  }};\n  cursor: pointer;\n\n  ${SystemText} {\n    display: ${props => (props.offline ? \"none\" : \"flex\")};\n  }\n\n  :before {\n    content: \"\";\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    opacity: ${props => {\n      if (props.destroyed || props.offline || props.loading) {\n        return \"0.8\";\n      }\n\n      return \"0\";\n    }};\n\n    background-color: transparent;\n\n    background-image: ${props => {\n      if (props.offline) {\n        return \"url(/img/offline.png)\";\n      }\n\n      return \"none\";\n    }};\n  }\n`;\n\nconst Container = styled.div`\n  cursor: pointer;\n  position: relative;\n  margin: 3px 1px;\n`;\n\nclass SystemIcon extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.element = React.createRef();\n    this.state = {\n      mouseOveredSystem: null,\n      clickedSystem: null\n    };\n  }\n\n  clickSystem(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    const { uiState, system, ship, scs } = this.props;\n\n    uiState.customEvent(\"systemClicked\", {\n      ship,\n      system,\n      element: this.element,\n      scs\n    });\n  }\n\n  onSystemMouseOver(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    let { uiState, system, ship } = this.props;\n\n    uiState.customEvent(\"systemMouseOver\", {\n      ship,\n      system,\n      element: this.element\n    });\n\n    this.setState({ mouseOveredSystem: this.element });\n  }\n\n  onSystemMouseOut(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    let { uiState } = this.props;\n\n    uiState.customEvent(\"systemMouseOut\");\n\n    this.setState({ mouseOveredSystem: null });\n  }\n\n  onContextMenu(e) {\n    e.stopPropagation();\n    e.preventDefault();\n\n    let { uiState, system, ship } = this.props;\n\n    uiState.customEvent(\"systemRightClicked\", { system, ship });\n  }\n\n  render() {\n    let {\n      uiState,\n      system,\n      ship,\n      scs,\n      destroyed,\n      systemMenu: {\n        systemInfoMenuProvider,\n        activeSystem,\n        activeSystemElement\n      } = {\n        systemInfoMenuProvider: null,\n        activeSystem: null,\n        activeSystemElement: null\n      },\n      onSystemClicked = this.clickSystem,\n      selected = false,\n      text = null,\n      target = null,\n      ...rest\n    } = this.props;\n    const { mouseOveredSystem } = this.state;\n    const { weaponFireService } = uiState.services;\n\n    if (!text) {\n      text = system.getIconText();\n    }\n\n    const menu = activeSystem ? systemInfoMenuProvider : null;\n\n    const displayMenu = Boolean(\n      (!activeSystem && mouseOveredSystem) ||\n        (activeSystem &&\n          activeSystem === system &&\n          activeSystemElement === this.element)\n    );\n\n    const firing = weaponFireService.systemHasFireOrder(system);\n    const reserved =\n      target &&\n      weaponFireService.systemHasFireOrder(system) &&\n      !weaponFireService.systemHasFireOrderAgainstShip(system, target);\n    const targeting =\n      target && weaponFireService.systemHasFireOrderAgainstShip(system, target);\n\n    return (\n      <>\n        {displayMenu && scs && (\n          <SystemInfo\n            scs\n            uiState={uiState}\n            ship={ship}\n            system={system}\n            systemInfoMenuProvider={menu}\n            element={mouseOveredSystem || activeSystemElement}\n            target={target}\n            {...rest}\n          />\n        )}\n        <Container\n          onClick={onSystemClicked.bind(this)}\n          onMouseOver={this.onSystemMouseOver.bind(this)}\n          onMouseOut={this.onSystemMouseOut.bind(this)}\n          onContextMenu={this.onContextMenu.bind(this)}\n          scs\n        >\n          {displayMenu && !scs && (\n            <SystemInfo\n              scs\n              uiState={uiState}\n              ship={ship}\n              system={system}\n              systemInfoMenuProvider={menu}\n              element={mouseOveredSystem || activeSystemElement}\n              target={target}\n              {...rest}\n            />\n          )}\n          <System\n            ref={c => (this.element = c)}\n            scs={scs}\n            background={system.getBackgroundImage()}\n            offline={isOffline(ship, system)}\n            loading={isLoading(system)}\n            selected={selected}\n            firing={firing}\n            targeting={targeting}\n            reserved={reserved}\n            destroyed={system.isDestroyed()}\n          />\n\n          <SystemText destroyed={system.isDestroyed()} selected={selected}>\n            {text}\n          </SystemText>\n          <HealthBar\n            destroyed={system.isDestroyed()}\n            criticals={system.hasAnyCritical()}\n            health={getStructureLeft(system)}\n          />\n        </Container>\n      </>\n    );\n  }\n}\n\nconst isLoading = system => undefined; //ASK FROM SYSTEM system.weapon && !weaponManager.isLoaded(system);\n\nconst isOffline = (ship, system) => system.power.isOffline();\n\nconst getStructureLeft = system =>\n  ((system.hitpoints - system.getTotalDamage()) / system.hitpoints) * 100;\n\nexport default SystemIcon;\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport SystemInfo from \"./SystemInfo\";\r\n\r\nimport { colors } from \"../../../../styled\";\r\n\r\nconst HealthBar = styled.div`\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 7px;\r\n  border: 2px solid black;\r\n  box-sizing: border-box;\r\n\r\n  background-color: #7a2020;\r\n\r\n  :before {\r\n    content: \"\";\r\n    position: absolute;\r\n    width: ${props => `${props.health}%`};\r\n    height: 100%;\r\n    left: 0;\r\n    bottom: 0;\r\n    background-color: ${props => (props.criticals ? \"#ed6738\" : \"#427231\")};\r\n  }\r\n`;\r\n\r\nconst SystemText = styled.div`\r\n  position: absolute;\r\n  top: 0px;\r\n  width: 100%;\r\n  height: calc(100% - 5px);\r\n  font-family: arial;\r\n  font-size: 10px;\r\n  color: white;\r\n  display: flex;\r\n  align-items: flex-end;\r\n  justify-content: center;\r\n  text-shadow: black 0 0 6px, black 0 0 6px, black 0 0 6px, black 0 0 6px;\r\n`;\r\n\r\nconst System = styled.div`\r\n  position: relative;\r\n  box-sizing: border-box;\r\n  width: 30px;\r\n  height: 30px;\r\n\r\n  background-color: \"transparent\";\r\n  background-image: ${props => `url(${props.background})`};\r\n  background-size: cover;\r\n  filter: ${props => {\r\n    if (props.targeting) {\r\n      return \"hue-rotate(0deg) brightness(4) grayscale(0)\";\r\n    } else if (props.reserved) {\r\n      return \"hue-rotate(0deg) brightness(1) grayscale(0.7)\";\r\n    } else if (props.firing) {\r\n      return \"hue-rotate(0deg) brightness(4) grayscale(0)\"; //\"grayscale(100%) brightness(6) drop-shadow(0px 0px 5px white)\";\r\n    } else if (props.destroyed) {\r\n      return \"blur(1px)\";\r\n    } else {\r\n      return \"none\";\r\n    }\r\n  }};\r\n  cursor: pointer;\r\n\r\n  ${SystemText} {\r\n    display: ${props => (props.offline ? \"none\" : \"flex\")};\r\n  }\r\n\r\n  :before {\r\n    content: \"\";\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    opacity: ${props => {\r\n      if (props.destroyed || props.offline || props.loading) {\r\n        return \"0.5\";\r\n      }\r\n\r\n      return \"0\";\r\n    }};\r\n\r\n    background-color: ${props => {\r\n      if (props.destroyed || props.offline) {\r\n        return \"black\";\r\n      } else if (props.loading) {\r\n        return \"orange\";\r\n      }\r\n\r\n      return \"transparent\";\r\n    }};\r\n\r\n    background-image: ${props => {\r\n      if (props.offline) {\r\n        return \"url(/img/offline.png)\";\r\n      }\r\n\r\n      return \"none\";\r\n    }};\r\n  }\r\n`;\r\n\r\nconst Container = styled.div`\r\n  cursor: pointer;\r\n  position: relative;\r\n  margin: 3px 1px;\r\n`;\r\n\r\nconst StructureText = styled.div`\r\n  z-index: 1;\r\n`;\r\n\r\nconst StructureContainer = styled.div`\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  box-sizing: border-box;\r\n  width: calc(100% - 4px);\r\n  height: 16px;\r\n  background-color: #081313;\r\n  color: ${props => (props.health === 0 ? \"transparent\" : \"white\")};\r\n  font-family: arial;\r\n  font-size: 11px;\r\n  text-shadow: black 0 0 6px, black 0 0 6px;\r\n  margin: 1px;\r\n  filter: ${props => (props.health === 0 ? \"blur(1px)\" : \"none\")};\r\n  border: 1px solid black;\r\n\r\n  :before {\r\n    box-sizing: border-box;\r\n    content: \"\";\r\n    position: absolute;\r\n    width: ${props => `${props.health}%`};\r\n    height: 100%;\r\n    left: 0;\r\n    bottom: 0;\r\n    z-index: 0;\r\n    background-color: ${props => (props.criticals ? \"#ed6738\" : \"#427231\")};\r\n  }\r\n`;\r\n\r\nclass StructureIcon extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.element = React.createRef();\r\n    this.state = {\r\n      mouseOveredSystem: null,\r\n      clickedSystem: null\r\n    };\r\n  }\r\n\r\n  clickSystem(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n\r\n    const { uiState, system, ship } = this.props;\r\n\r\n    uiState.customEvent(\"systemClicked\", {\r\n      ship,\r\n      system,\r\n      element: this.element,\r\n      scs: true\r\n    });\r\n  }\r\n\r\n  onSystemMouseOver(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n\r\n    let { uiState, system, ship } = this.props;\r\n\r\n    uiState.customEvent(\"systemMouseOver\", {\r\n      ship,\r\n      system,\r\n      element: this.element\r\n    });\r\n\r\n    this.setState({ mouseOveredSystem: this.element });\r\n  }\r\n\r\n  onSystemMouseOut(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n\r\n    let { uiState } = this.props;\r\n\r\n    uiState.customEvent(\"systemMouseOut\");\r\n\r\n    this.setState({ mouseOveredSystem: null });\r\n  }\r\n\r\n  onContextMenu(e) {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n\r\n    let { uiState, system, ship } = this.props;\r\n\r\n    uiState.customEvent(\"systemRightClicked\", { system, ship });\r\n  }\r\n\r\n  render() {\r\n    let {\r\n      uiState,\r\n      system,\r\n      ship,\r\n      scs,\r\n      destroyed,\r\n      systemMenu: {\r\n        systemInfoMenuProvider,\r\n        activeSystem,\r\n        activeSystemElement\r\n      } = {\r\n        systemInfoMenuProvider: null,\r\n        activeSystem: null,\r\n        activeSystemElement: null\r\n      },\r\n      onSystemClicked = this.clickSystem,\r\n      selected = false,\r\n      text = null,\r\n      target = null,\r\n      ...rest\r\n    } = this.props;\r\n    const { mouseOveredSystem } = this.state;\r\n\r\n    const menu = activeSystem ? systemInfoMenuProvider : null;\r\n\r\n    const displayMenu = Boolean(\r\n      (!activeSystem && mouseOveredSystem) ||\r\n        (activeSystem &&\r\n          activeSystem === system &&\r\n          activeSystemElement === this.element)\r\n    );\r\n\r\n    return (\r\n      <>\r\n        {displayMenu && (\r\n          <SystemInfo\r\n            scs\r\n            uiState={uiState}\r\n            ship={ship}\r\n            system={system}\r\n            systemInfoMenuProvider={menu}\r\n            element={mouseOveredSystem || activeSystemElement}\r\n            target={target}\r\n            {...rest}\r\n          />\r\n        )}\r\n        <StructureContainer\r\n          ref={c => (this.element = c)}\r\n          onClick={onSystemClicked.bind(this)}\r\n          onMouseOver={this.onSystemMouseOver.bind(this)}\r\n          onMouseOut={this.onSystemMouseOut.bind(this)}\r\n          onContextMenu={this.onContextMenu.bind(this)}\r\n          health={getStructureLeft(system)}\r\n          criticals={system.hasAnyCritical()}\r\n        >\r\n          <StructureText>\r\n            {system.getRemainingHitpoints()} / {system.hitpoints} A{\" \"}\r\n            {system.getArmor()}\r\n          </StructureText>\r\n        </StructureContainer>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst getStructureLeft = system =>\r\n  ((system.hitpoints - system.getTotalDamage()) / system.hitpoints) * 100;\r\n\r\nexport default StructureIcon;\r\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport SystemIcon from \"../system/SystemIcon\";\nimport { colors } from \"../../../../styled\";\nimport * as systemLocation from \"../../../../../model/unit/system/systemSection/systemLocation\";\nimport StructureIcon from \"../system/StructureIcon\";\n\nconst ShipSectionContainer = styled.div`\n  display: flex;\n  flex-wrap: wrap-reverse;\n  width: calc(100% - 2px);\n  align-items: end;\n  justify-content: space-around;\n  align-content: center;\n  box-sizing: border-box;\n  margin: 1px;\n  flex-grow: 1;\n\n  border: ${props => {\n    switch (props.location) {\n      case 0:\n        return `1px solid ${colors.systemWindowPrimaryBorder}`;\n      default:\n        return `1px dashed ${colors.systemWindowBorder}`;\n    }\n  }};\n`;\n\nconst StructureText = styled.div`\n  z-index: 1;\n`;\n\nconst StructureContainer = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n  width: calc(100% - 4px);\n  height: 16px;\n  background-color: #081313;\n  color: ${props => (props.health === 0 ? \"transparent\" : \"white\")};\n  font-family: arial;\n  font-size: 11px;\n  text-shadow: black 0 0 6px, black 0 0 6px;\n  margin: 1px;\n  filter: ${props => (props.health === 0 ? \"blur(1px)\" : \"none\")};\n  border: 1px solid black;\n\n  :before {\n    box-sizing: border-box;\n    content: \"\";\n    position: absolute;\n    width: ${props => `${props.health}%`};\n    height: 100%;\n    left: 0;\n    bottom: 0;\n    z-index: 0;\n    background-color: ${props => (props.criticals ? \"#ed6738\" : \"#427231\")};\n  }\n`;\n\nclass ShipSection extends React.Component {\n  render() {\n    const { ship, section, uiState, ...rest } = this.props;\n    const location = section.location;\n    const structure = section.getStructure();\n\n    return (\n      <ShipSectionContainer location={location}>\n        {section.getNonStructureSystems().map(system => (\n          <SystemIcon\n            scs\n            uiState={uiState}\n            key={`system-scs-${location}-${ship.id}-${system.id}`}\n            system={system}\n            ship={ship}\n            selected={uiState.isSelectedSystem(system)}\n            {...rest}\n          />\n        ))}\n\n        {structure && (\n          <StructureIcon\n            uiState={uiState}\n            system={structure}\n            ship={ship}\n            selected={uiState.isSelectedSystem(structure)}\n            {...rest}\n          />\n        )}\n      </ShipSectionContainer>\n    );\n  }\n}\n\nexport default ShipSection;\n","import * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport ShipSection from \"./ShipSection\";\n\nconst ShipWindowContainer = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  max-width: 400px;\n  height: auto;\n  opacity: 0.95;\n  z-index: 10001;\n  font-size: 10px;\n  color: white;\n  font-family: arial;\n  max-height: 100vh;\n  overflow-y: scroll;\n  margin: 0 8px;\n  scrollbar-width: 0;\n\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n`;\n\nconst Column = styled.div`\n  width: 25%;\n  max-height: calc(33.3333333% - 11px);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n\nconst ColumnMiddle = styled(Column)`\n  width: 50%;\n`;\n\nclass ShipWindow extends React.Component {\n  close() {\n    let { uiState } = this.props;\n    uiState.closeShipWindow(this.props.ship);\n  }\n\n  render() {\n    const { ship, uiState, ...rest } = this.props;\n\n    return (\n      <ShipWindowContainer\n        onClick={shipWindowClicked.bind(this, uiState)}\n        onContextMenu={e => {\n          e.preventDefault();\n          e.stopPropagation();\n        }}\n        team={ship.team}\n      >\n        <Column>\n          <ShipSection\n            uiState={uiState}\n            ship={ship}\n            section={ship.systems.sections.getPortFrontSection()}\n            {...rest}\n          />\n          <ShipSection\n            uiState={uiState}\n            ship={ship}\n            section={ship.systems.sections.getPortAftSection()}\n            {...rest}\n          />\n        </Column>\n\n        <ColumnMiddle>\n          <ShipSection\n            uiState={uiState}\n            section={ship.systems.sections.getFrontSection()}\n            ship={ship}\n            {...rest}\n          />\n          <ShipSection\n            uiState={uiState}\n            ship={ship}\n            section={ship.systems.sections.getPrimarySection()}\n            {...rest}\n          />\n          <ShipSection\n            uiState={uiState}\n            ship={ship}\n            section={ship.systems.sections.getAftSection()}\n            {...rest}\n          />\n        </ColumnMiddle>\n\n        <Column>\n          <ShipSection\n            uiState={uiState}\n            ship={ship}\n            section={ship.systems.sections.getStarboardFrontSection()}\n            {...rest}\n          />\n          <ShipSection\n            uiState={uiState}\n            ship={ship}\n            section={ship.systems.sections.getStarboardAftSection()}\n            {...rest}\n          />\n        </Column>\n      </ShipWindowContainer>\n    );\n  }\n}\n\nconst shipWindowClicked = uiState => uiState.customEvent(\"closeSystemInfo\");\n\nexport default ShipWindow;\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport SystemIcon from \"../system/SystemIcon\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n`;\r\n\r\nclass WeaponTargeting extends React.Component {\r\n  render() {\r\n    const { uiState, ship, target, system, ...rest } = this.props;\r\n    const { weaponFireService } = uiState.services;\r\n\r\n    if (!weaponFireService.canFire(ship, target, system)) {\r\n      return null;\r\n    }\r\n\r\n    const hitChange = system.callHandler(\"getHitChange\", {\r\n      shooter: ship,\r\n      target,\r\n      prediction: true\r\n    });\r\n\r\n    return (\r\n      <Container>\r\n        <SystemIcon\r\n          scs\r\n          targeting\r\n          uiState={uiState}\r\n          key={`system-weaponTargeting-${ship.id}-${system.id}`}\r\n          system={system}\r\n          ship={ship}\r\n          selected={false}\r\n          target={target}\r\n          weaponTargeting={{\r\n            target: target,\r\n            hitChange: hitChange\r\n          }}\r\n          text={hitChange.result + \"%\"}\r\n          {...rest}\r\n        />\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default WeaponTargeting;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport WeaponTargeting from \"./WeaponTargeting\";\r\nimport {\r\n  Tooltip,\r\n  TooltipHeader,\r\n  TooltipEntry,\r\n  colors\r\n} from \"../../../../styled\";\r\n\r\nconst InfoHeader = styled(TooltipHeader)`\r\n  border: none;\r\n  margin-bottom: 0;\r\n  font-size: 12px;\r\n`;\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin: 0 8px;\r\n`;\r\n\r\nclass WeaponTargetingList extends React.Component {\r\n  getSystemIcons(\r\n    systems,\r\n    weaponFireService,\r\n    uiState,\r\n    selectedShip,\r\n    ship,\r\n    rest\r\n  ) {\r\n    return systems.map(system => (\r\n      <WeaponTargeting\r\n        key={`weaponTargeting-${system.id}`}\r\n        uiState={uiState}\r\n        system={system}\r\n        target={ship}\r\n        ship={selectedShip}\r\n        onSystemClicked={\r\n          !weaponFireService.systemHasFireOrderAgainstShip(system, ship)\r\n            ? this.targetShip(system, selectedShip, ship, uiState)\r\n            : this.unTargetShip(system, selectedShip, ship, uiState)\r\n        }\r\n        {...rest}\r\n      />\r\n    ));\r\n  }\r\n\r\n  targetShip(system, ship, target, uiState) {\r\n    const { weaponFireService } = uiState.services;\r\n\r\n    return () => {\r\n      weaponFireService.removeFireOrders(ship, system);\r\n      weaponFireService.addFireOrder(ship, target, system);\r\n\r\n      uiState.shipSystemStateChanged(ship, system);\r\n      uiState.shipStateChanged(ship);\r\n    };\r\n  }\r\n\r\n  unTargetShip(system, ship, target, uiState) {\r\n    const { weaponFireService } = uiState.services;\r\n\r\n    return () => {\r\n      weaponFireService.removeFireOrders(ship, system);\r\n      uiState.shipSystemStateChanged(ship, system);\r\n      uiState.shipStateChanged(ship);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { ship, uiState, ...rest } = this.props;\r\n    const { weaponFireService } = uiState.services;\r\n\r\n    const selectedShip = uiState.getSelectedShip();\r\n\r\n    if (\r\n      !selectedShip ||\r\n      uiState.gameData.ships.isSameTeam(ship, selectedShip)\r\n    ) {\r\n      return null;\r\n    }\r\n\r\n    const systems = selectedShip.systems\r\n      .getSystems()\r\n      .filter(system => weaponFireService.canFire(selectedShip, ship, system));\r\n\r\n    const icons = this.getSystemIcons(\r\n      systems,\r\n      weaponFireService,\r\n      uiState,\r\n      selectedShip,\r\n      ship,\r\n      rest\r\n    );\r\n\r\n    return (\r\n      <>\r\n        <Container>{icons}</Container>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default WeaponTargetingList;\r\n","class TorpedoAttackService {\r\n  constructor(services, gameData, target) {\r\n    this.services = services;\r\n    this.target = target;\r\n    this.gameData = gameData;\r\n  }\r\n\r\n  getPossibleTorpedos(currentUser, target) {\r\n    const torpedoAttackShips = [];\r\n\r\n    if (target.player.isUsers(currentUser)) {\r\n      return [];\r\n    }\r\n\r\n    this.gameData.ships\r\n      .getShips()\r\n      .filter(ship => ship.player.isUsers(currentUser))\r\n      .forEach(ship => {\r\n        ship.systems.getSystems().forEach(system => {\r\n          const launchers = system.callHandler(\"getLoadedLaunchers\", null, []);\r\n\r\n          if (launchers.length === 0) {\r\n            return;\r\n          }\r\n\r\n          let entry = torpedoAttackShips.find(attack => attack.ship === ship);\r\n\r\n          if (entry) {\r\n            entry.launchers = [...entry.launchers, ...launchers];\r\n          } else {\r\n            torpedoAttackShips.push({\r\n              ship,\r\n              launchers: launchers,\r\n              distance: this.target\r\n                .getHexPosition()\r\n                .distanceTo(ship.getHexPosition()),\r\n              deltaDistance: getDeltaVelocty(this.target, ship)\r\n            });\r\n          }\r\n        });\r\n      });\r\n\r\n    torpedoAttackShips.sort((a, b) => {\r\n      if (a.distance > b.distance) {\r\n        return 1;\r\n      }\r\n\r\n      if (a.distance < b.distance) {\r\n        return -1;\r\n      }\r\n\r\n      return 0;\r\n    });\r\n\r\n    return torpedoAttackShips;\r\n  }\r\n}\r\n\r\nconst getDeltaVelocty = (a, b) => {\r\n  const distance = a.getHexPosition().distanceTo(b.getHexPosition());\r\n  const aLastMove = a.movement.getLastMove();\r\n  const bLastMove = b.movement.getLastMove();\r\n\r\n  if (!aLastMove || !bLastMove) {\r\n    return 0;\r\n  }\r\n\r\n  const aPosition = a.getHexPosition().add(aLastMove.getHexVelocity());\r\n  const bPosition = b.getHexPosition().add(bLastMove.getHexVelocity());\r\n\r\n  const newDistance = aPosition.distanceTo(bPosition);\r\n\r\n  return newDistance - distance;\r\n};\r\n\r\nexport default TorpedoAttackService;\r\n","import React from \"react\";\r\nimport {\r\n  TooltipHeader,\r\n  TooltipEntry,\r\n  TooltipValueHeader,\r\n  TooltipValue\r\n} from \"../../../../styled\";\r\nimport coordinateConverter from \"../../../../../model/utils/CoordinateConverter.mjs\";\r\nimport HexagonMath from \"../../../../../model/utils/HexagonMath.mjs\";\r\n\r\nconst getTorpedoTooltip = (shooter, target, torpedo, strikePrediction) => {\r\n  if (strikePrediction) {\r\n    const entries = [\r\n      {\r\n        value:\r\n          \"Following prediction depends on relative velocity, position of target, launched torpedo and is subject to change\"\r\n      },\r\n      {\r\n        header: `Impact in`,\r\n        value: `+${Math.floor(strikePrediction.impactTurn)} turns`\r\n      },\r\n      {\r\n        header: \"Relative velocity\",\r\n        value: `${strikePrediction.impactVelocity} h/t`\r\n      }\r\n      /*\r\n      {\r\n        header: \"Strike position\",\r\n        value: coordinateConverter\r\n          .fromGameToHex(strikePrediction.impactPosition)\r\n          .toString()\r\n      },\r\n      {\r\n        header: \"Strike effectiveness\",\r\n        value: `${Math.round(strikePrediction.effectiveness * 100)}%`\r\n      }\r\n      */\r\n    ];\r\n\r\n    if (strikePrediction.note) {\r\n      entries.push({\r\n        value: strikePrediction.note\r\n      });\r\n    }\r\n\r\n    return entries;\r\n  }\r\n\r\n  return [];\r\n};\r\n\r\nclass TorpedoAttackTooltip extends React.Component {\r\n  render() {\r\n    const { shooter, target, torpedo, strikePrediction } = this.props;\r\n\r\n    return (\r\n      <>\r\n        <TooltipHeader>Torpedo attack</TooltipHeader>\r\n        {getTorpedoTooltip(shooter, target, torpedo, strikePrediction).map(\r\n          getEntry\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst getEntry = ({ header, value }, i) => {\r\n  if (value.replace) {\r\n    value = value.replace(/<br>/gm, \"\\n\");\r\n  }\r\n\r\n  return (\r\n    <TooltipEntry key={`cargoTooltipEntry-${header}-${i}`}>\r\n      {header && <TooltipValueHeader>{header}: </TooltipValueHeader>}\r\n      {value && <TooltipValue>{value}</TooltipValue>}\r\n    </TooltipEntry>\r\n  );\r\n};\r\n\r\nexport default TorpedoAttackTooltip;\r\n","import coordinateConverter from \"../utils/CoordinateConverter.mjs\";\nimport HexagonMath from \"../utils/HexagonMath.mjs\";\nimport Vector from \"../utils/Vector.mjs\";\nimport THREE from \"three\";\nimport { radianToDegree } from \"../utils/math.mjs\";\n\nclass TorpedoMovementService {\n  reachesTargetThisTurn(flight, target) {\n    const { impactTurn } = this.torpedoMath(\n      flight.position,\n      flight.velocity,\n      target.getPosition(),\n      target.getVelocity(),\n      flight.getTorpedoGameDeltaVelocity()\n    );\n\n    return impactTurn < 1;\n  }\n\n  moveTorpedo(flight, target) {\n    const { accelerationVector, ...rest } = this.torpedoMath(\n      flight.position,\n      flight.velocity,\n      target.getPosition().sub(target.getVelocity()),\n      target.getVelocity(),\n      flight.getTorpedoGameDeltaVelocity()\n    );\n\n    flight.position = flight.position\n      .add(flight.velocity)\n      .add(\n        accelerationVector.multiplyScalar(\n          0.5 * flight.getTorpedoGameDeltaVelocity()\n        )\n      );\n\n    flight.velocity = flight.velocity.add(\n      accelerationVector.multiplyScalar(flight.getTorpedoGameDeltaVelocity())\n    );\n  }\n\n  buildPredictions(flight, result) {\n    const maxInterceptVelocity = flight.torpedo.maxInterceptVelocity;\n\n    let velocity = result.impactVelocity / HexagonMath.getHexWidth();\n\n    if (velocity > maxInterceptVelocity) {\n      velocity = maxInterceptVelocity;\n    }\n\n    let effectiveness = velocity / maxInterceptVelocity;\n    let notes = \"\";\n\n    if (\n      Math.floor(result.impactTurn) + flight.turnsActive <\n      flight.torpedo.armingTime\n    ) {\n      effectiveness = 0;\n      notes = \"Insufficient time to arm torpedo\";\n    }\n\n    if (\n      Math.floor(result.impactTurn) + flight.turnsActive >\n      flight.torpedo.turnsToLive\n    ) {\n      effectiveness = 0;\n      notes = \"Out of range\";\n    }\n\n    return {\n      ...result,\n      notes,\n      impactVelocity: Math.round(\n        result.impactVelocity / HexagonMath.getHexWidth()\n      ),\n      effectiveness\n    };\n  }\n\n  predictTorpedoHitPositionAndTurnAfterMovement(flight, target) {\n    const result = this.torpedoMath(\n      flight.position,\n      flight.velocity,\n      target.getPosition().sub(target.getVelocity()),\n      target.getVelocity(),\n      flight.getTorpedoGameDeltaVelocity()\n    );\n\n    return this.buildPredictions(flight, result);\n  }\n\n  predictTorpedoHitPositionAndTurn(flight, target) {\n    const result = this.torpedoMath(\n      flight.position,\n      flight.velocity,\n      target.getPosition(),\n      target.getVelocity(),\n      flight.getTorpedoGameDeltaVelocity()\n    );\n\n    return this.buildPredictions(flight, result);\n  }\n\n  standardize(\n    shooterPosition,\n    shooterVelocity,\n    targetPosition,\n    targetVelocity\n  ) {\n    const Δpos = targetPosition.sub(shooterPosition);\n    const φ = Math.atan2(Δpos.y, Δpos.x);\n    const rotationMatrix = new THREE.Matrix4().makeRotationZ(-φ);\n    const newTargetPosition = Δpos.applyMatrix4(rotationMatrix);\n    const newShooterVelocity = shooterVelocity\n      .sub(targetVelocity)\n      .applyMatrix4(rotationMatrix);\n\n    return {\n      newTargetPosition,\n      newShooterVelocity,\n      φ\n    };\n  }\n\n  torpedoMath(\n    shooterPosition,\n    shooterVelocity,\n    targetPosition,\n    targetVelocity,\n    torpedoAcceleration\n  ) {\n    if (torpedoAcceleration <= 0) {\n      throw new Error(\"Torpedoacceleration is <= 0\");\n    }\n\n    if (shooterPosition.equals(targetPosition)) {\n      throw new Error(\"Shooter and target positions can not be same\");\n    }\n\n    const { newTargetPosition, newShooterVelocity, φ } = this.standardize(\n      shooterPosition,\n      shooterVelocity,\n      targetPosition,\n      targetVelocity\n    );\n\n    const x = newTargetPosition.x;\n\n    let result = null;\n\n    if (\n      Math.pow(newShooterVelocity.y, 2) / (torpedoAcceleration * x) <\n      Math.pow(10, -7)\n    ) {\n      const impactTurn =\n        (-newShooterVelocity.x +\n          Math.sqrt(\n            Math.pow(newShooterVelocity.x, 2) + 2 * torpedoAcceleration * x\n          )) /\n        torpedoAcceleration;\n\n      result = {\n        accelerationAngle: φ,\n        impactTurn\n      };\n    } else if (newShooterVelocity.y > 0) {\n      const θ = this.findRoot(\n        newTargetPosition.x,\n        newShooterVelocity.x,\n        newShooterVelocity.y,\n        torpedoAcceleration\n      );\n\n      const impactTurn =\n        -(2 * newShooterVelocity.y) / (torpedoAcceleration * Math.sin(θ));\n\n      result = {\n        accelerationAngle: θ + φ,\n        impactTurn\n      };\n    } else {\n      const θ = this.findRoot(\n        newTargetPosition.x,\n        newShooterVelocity.x,\n        -newShooterVelocity.y,\n        torpedoAcceleration\n      );\n\n      const impactTurn =\n        (2 * newShooterVelocity.y) / (torpedoAcceleration * Math.sin(θ));\n\n      result = {\n        accelerationAngle: 2 * Math.PI - θ + φ,\n        impactTurn\n      };\n    }\n\n    const impactVelocity = Math.sqrt(\n      Math.pow(\n        -newShooterVelocity.x +\n          targetVelocity.x -\n          torpedoAcceleration *\n            result.impactTurn *\n            Math.cos(result.accelerationAngle),\n        2\n      ) +\n        Math.pow(\n          -newShooterVelocity.y +\n            targetVelocity.y -\n            torpedoAcceleration *\n              result.impactTurn *\n              Math.sin(result.accelerationAngle),\n          2\n        )\n    );\n\n    const accelerationVector = new Vector(\n      Math.cos(result.accelerationAngle),\n      Math.sin(result.accelerationAngle)\n    ).normalize();\n\n    if (\n      Number.isNaN(result.accelerationAngle) ||\n      Number.isNaN(result.impactTurn) ||\n      Number.isNaN(accelerationVector) ||\n      Number.isNaN(impactVelocity)\n    ) {\n      throw new Error(\n        `Torpedo math encountered NaN with values '${shooterPosition.toString()}, '${shooterVelocity.toString()}, '${targetPosition.toString()}, '${targetVelocity.toString()},'${torpedoAcceleration}'`\n      );\n    }\n\n    const impactPosition = shooterPosition\n      .add(shooterVelocity.multiplyScalar(result.impactTurn))\n      .add(\n        accelerationVector.multiplyScalar(\n          0.5 * torpedoAcceleration * Math.pow(result.impactTurn, 2)\n        )\n      );\n\n    return { ...result, accelerationVector, impactVelocity, impactPosition };\n  }\n\n  findRoot(x, vx, vy, a) {\n    if (vx / vy - (a * x) / (2 * Math.pow(vy, 2) < 0)) {\n      return this.findRoot2(\n        x,\n        vx,\n        vy,\n        a,\n        (3 * Math.PI) / 2,\n        this.findUpperLimit(x, vx, vy, a)\n      );\n    }\n\n    return this.findRoot2(\n      x,\n      vx,\n      vy,\n      a,\n      this.findLowerLimit(x, vx, vy, a),\n      (3 * Math.PI) / 2\n    );\n  }\n\n  f(x, vx, vy, a, θ) {\n    return (\n      Math.cos(θ) / Math.pow(Math.sin(θ), 2) -\n      vx / (vy * Math.sin(θ)) -\n      (a * x) / (2 * Math.pow(vy, 2))\n    );\n  }\n\n  findRoot2(x, vx, vy, a, θ1, θ2) {\n    let θlow = θ1;\n    let θhigh = θ2;\n    let θmid = 0;\n\n    while (θhigh - θlow > Math.pow(10, -8)) {\n      θmid = (θlow + θhigh) / 2;\n      if (this.f(x, vx, vy, a, θmid) > 0) {\n        θhigh = θmid;\n      } else {\n        θlow = θmid;\n      }\n    }\n\n    return (θlow + θhigh) / 2;\n  }\n\n  findUpperLimit(x, vx, vy, a) {\n    let i = 1;\n\n    while (true) {\n      const argument = 2 * Math.PI - Math.PI / Math.pow(2, i);\n      const result = this.f(x, vx, vy, a, argument);\n\n      if (result > 0) {\n        return argument;\n      }\n      i++;\n    }\n  }\n\n  findLowerLimit(x, vx, vy, a) {\n    let i = 1;\n\n    while (true) {\n      const argument = Math.PI + Math.PI / Math.pow(2, i);\n      const result = this.f(x, vx, vy, a, argument);\n\n      if (result < 0) {\n        return argument;\n      }\n      i++;\n    }\n  }\n}\n\nexport default TorpedoMovementService;\n","import Vector from \"../utils/Vector.mjs\";\nimport { cargoClasses } from \"./system/cargo/cargo.mjs\";\nimport uuidv4 from \"uuid/v4.js\";\nimport HexagonMath from \"../utils/HexagonMath.mjs\";\n\nclass TorpedoFlight {\n  constructor(torpedo, targetId, shooterId, weaponId, launcherIndex) {\n    this.id = uuidv4();\n    this.torpedo = torpedo;\n    this.targetId = targetId;\n    this.shooterId = shooterId;\n    this.weaponId = weaponId;\n    this.launcherIndex = launcherIndex;\n    this.position = new Vector();\n    this.launchPosition = new Vector();\n    this.velocity = new Vector();\n\n    this.reachedTarget = false;\n    this.strikeEffectiveness = 0;\n    this.intercepted = false;\n    this.turnsActive = 0;\n  }\n\n  hasArmed() {\n    return this.turnsActive > this.torpedo.armingTime;\n  }\n\n  noLongerActive() {\n    return this.torpedo.turnsToLive < this.turnsActive;\n  }\n\n  getTorpedoGameDeltaVelocity() {\n    return this.torpedo.deltaVelocityPerTurn * HexagonMath.getHexWidth();\n  }\n\n  getRelativeVelocityRatio(velocity) {\n    if (velocity > this.torpedo.maxInterceptVelocity) {\n      velocity = this.torpedo.maxInterceptVelocity;\n    }\n\n    return velocity / this.torpedo.maxInterceptVelocity;\n  }\n\n  setIntercepted() {\n    this.intercepted = true;\n  }\n\n  setReachedTarget(strikeEffectiveness) {\n    this.reachedTarget = true;\n    this.strikeEffectiveness = strikeEffectiveness;\n  }\n\n  getInterceptTries(target) {\n    return this.torpedo.getInterceptTries(\n      this.strikeEffectiveness,\n      this,\n      target\n    );\n  }\n\n  getStrikeDistance(target) {\n    return this.torpedo.getStrikeDistance(this, target);\n  }\n\n  setImpactAngle(angle) {\n    this.impactAngle = angle;\n  }\n\n  setPosition(position) {\n    this.position = position;\n    return this;\n  }\n\n  setLaunchPosition(position) {\n    this.launchPosition = position;\n    return this;\n  }\n\n  setVelocity(velocity) {\n    this.velocity = velocity;\n    return this;\n  }\n\n  serialize() {\n    return {\n      id: this.id,\n      torpedo: this.torpedo.constructor.name,\n      targetId: this.targetId,\n      position: this.position,\n      velocity: this.velocity,\n      shooterId: this.shooterId,\n      weaponId: this.weaponId,\n      launcherIndex: this.launcherIndex,\n      intercepted: this.intercepted,\n      launchPosition: this.launchPosition,\n      turnsActive: this.turnsActive\n    };\n  }\n\n  deserialize(data) {\n    this.id = data.id;\n    this.torpedo = new cargoClasses[data.torpedo]();\n    this.targetId = data.targetId;\n    this.position = new Vector(data.position);\n    this.launchPosition = new Vector(data.launchPosition);\n    this.velocity = new Vector(data.velocity);\n    this.shooterId = data.shooterId;\n    this.weaponId = data.weaponId;\n    this.launcherIndex = data.launcherIndex;\n    this.intercepted = data.intercepted || false;\n    this.turnsActive = data.turnsActive || 0;\n\n    return this;\n  }\n\n  clone() {\n    return new TorpedoFlight().deserialize(this.serialize());\n  }\n}\n\nexport default TorpedoFlight;\n","import React from \"react\";\r\nimport TorpedoAttackService from \"../../../../../model/weapon/TorpedoAttackService.mjs\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  Tooltip,\r\n  TooltipHeader,\r\n  TooltipSubHeader,\r\n  TooltipEntry,\r\n  colors,\r\n  IconAndLabel\r\n} from \"../../../../styled\";\r\nimport CargoItem from \"../system/SystemStrategyUi/cargo/CargoItem\";\r\nimport TorpedoAttackTooltip from \"./TorpedoAttackTooltip\";\r\nimport TorpedoMovementService from \"../../../../../model/movement/TorpedoMovementService.mjs\";\r\nimport TorpedoFlight from \"../../../../../model/unit/TorpedoFlight.mjs\";\r\n\r\nconst Container = styled.div`\r\n  z-index: 3;\r\n`;\r\n\r\nconst Cell = styled.div`\r\n  width: 25%;\r\n  display: flex;\r\n\r\n  justify-content: center;\r\n\r\n  :first-child {\r\n    width: 50%;\r\n    justify-content: flex-start;\r\n  }\r\n\r\n  :last-child {\r\n    justify-content: flex-end;\r\n  }\r\n`;\r\n\r\nconst TorpedoList = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n`;\r\n\r\nconst TorpedoCargoItem = styled(CargoItem)`\r\n  ${IconAndLabel} {\r\n    ${props => {\r\n      const { launcher, ship } = props;\r\n\r\n      if (launcher.launchTarget === ship.id) {\r\n        return \"filter: hue-rotate(0deg) brightness(4) grayscale(0);\";\r\n      } else if (\r\n        launcher.launchTarget !== null &&\r\n        launcher.launchTarget !== ship.id\r\n      ) {\r\n        return \"filter: hue-rotate(0deg) brightness(1) grayscale(0.7);\";\r\n      }\r\n    }}\r\n  }\r\n`;\r\n\r\nclass TorpedoAttack extends React.Component {\r\n  launcherClick(launcher) {\r\n    return () => {\r\n      const { ship } = this.props;\r\n      if (launcher.launchTarget === null || launcher.launchTarget !== ship.id) {\r\n        launcher.setLaunchTarget(ship.id);\r\n      } else if (launcher.launchTarget && launcher.launchTarget === ship.id) {\r\n        launcher.setLaunchTarget(null);\r\n      }\r\n\r\n      this.forceUpdate();\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { uiState, ship: target } = this.props;\r\n\r\n    const torpedoAttackService = new TorpedoAttackService(\r\n      uiState.services,\r\n      uiState.gameData,\r\n      target\r\n    );\r\n\r\n    const launchers = torpedoAttackService.getPossibleTorpedos(\r\n      uiState.services.currentUser,\r\n      target\r\n    );\r\n\r\n    const torpedoMovementService = new TorpedoMovementService();\r\n\r\n    return (\r\n      <>\r\n        <TooltipSubHeader>\r\n          <Cell>Name</Cell>\r\n          <Cell>Distance</Cell>\r\n          <Cell>Δ Distance</Cell>\r\n        </TooltipSubHeader>\r\n        {launchers.map((torpedoShipEntry, i) => {\r\n          return (\r\n            <Container key={`torpedo-launching-ship-${i}`}>\r\n              <TooltipHeader>\r\n                <Cell>{torpedoShipEntry.ship.name}</Cell>\r\n                <Cell>{torpedoShipEntry.distance}</Cell>\r\n                <Cell>{torpedoShipEntry.deltaDistance}</Cell>\r\n              </TooltipHeader>\r\n              <TorpedoList>\r\n                {torpedoShipEntry.launchers.map((launcher, i) => {\r\n                  const strikePrediction = torpedoMovementService.predictTorpedoHitPositionAndTurn(\r\n                    new TorpedoFlight(launcher.loadedTorpedo)\r\n                      .setPosition(torpedoShipEntry.ship.getPosition())\r\n                      .setVelocity(torpedoShipEntry.ship.getVelocity()),\r\n                    target\r\n                  );\r\n\r\n                  if (!strikePrediction) {\r\n                    return null;\r\n                  }\r\n\r\n                  return (\r\n                    <TorpedoCargoItem\r\n                      launcher={launcher}\r\n                      ship={torpedoShipEntry.ship}\r\n                      handleOnClick={this.launcherClick(launcher).bind(this)}\r\n                      key={`torpedo-attack--torpedo-${torpedoShipEntry.ship.id}-${i}`}\r\n                      cargo={launcher.loadedTorpedo}\r\n                      amount={null}\r\n                      text={`${Math.round(\r\n                        strikePrediction.effectiveness * 100\r\n                      )}%`}\r\n                      tooltipAdditionalContent={\r\n                        <TorpedoAttackTooltip\r\n                          shooter={torpedoShipEntry.ship}\r\n                          target={target}\r\n                          torpedo={launcher.loadedTorpedo}\r\n                          strikePrediction={strikePrediction}\r\n                        />\r\n                      }\r\n                    />\r\n                  );\r\n                })}\r\n              </TorpedoList>\r\n            </Container>\r\n          );\r\n        })}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TorpedoAttack;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  Tooltip,\r\n  TooltipHeader,\r\n  TooltipEntry,\r\n  TooltipValue,\r\n  TooltipValueHeader\r\n} from \"../../../../styled\";\r\n\r\nconst Row = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n`;\r\n\r\nconst Container = styled.div`\r\n  margin: 0 8px 5px 8px;\r\n`;\r\n\r\nconst ShipDetailsTooltipEntry = styled(TooltipEntry)`\r\n  margin: 2px 0;\r\n`;\r\n\r\nclass ShipTooltipDetails extends React.Component {\r\n  getEntry(header, value) {\r\n    return (\r\n      <ShipDetailsTooltipEntry>\r\n        {header && <TooltipValueHeader>{header}: </TooltipValueHeader>}\r\n        {value && <TooltipValue>{value}</TooltipValue>}\r\n      </ShipDetailsTooltipEntry>\r\n    );\r\n  }\r\n  render() {\r\n    const { ship, uiState } = this.props;\r\n\r\n    const { currentUser } = uiState.services;\r\n\r\n    return (\r\n      <Container>\r\n        <Row>\r\n          {this.getEntry(\r\n            \"Hit profile\",\r\n            `Front: ${ship.getFrontHitProfile()}, Side: ${ship.getSideHitProfile()}`\r\n          )}\r\n          {this.getEntry(\r\n            \"DEW\",\r\n            ship.electronicWarfare.inEffect.getDefensiveEw()\r\n          )}\r\n          {this.getEntry(\"CCEW\", ship.electronicWarfare.inEffect.getCcEw())}\r\n        </Row>\r\n        <Row>\r\n          {this.getEntry(\r\n            \"Movement costs\",\r\n            `Acc: ${ship.accelcost}, Pivot: ${ship.pivotcost}, Evasion: ${ship.evasioncost}, Roll: ${ship.rollcost}`\r\n          )}\r\n        </Row>\r\n        <Row>\r\n          {ship.player.isUsers(currentUser) &&\r\n            this.getEntry(\r\n              \"Power available\",\r\n              ship.systems.power.getRemainingPowerOutput()\r\n            )}\r\n\r\n          {ship.player.isUsers(currentUser) &&\r\n            this.getEntry(\r\n              \"Planned DEW\",\r\n              ship.electronicWarfare.getDefensiveEw()\r\n            )}\r\n\r\n          {ship.player.isUsers(currentUser) &&\r\n            this.getEntry(\"Planned CCEW\", ship.electronicWarfare.getCcEw())}\r\n        </Row>\r\n\r\n        <Row>\r\n          {this.getEntry(\r\n            \"Heat stored\",\r\n            `${Math.round(\r\n              ship.systems.getTotalHeatStored()\r\n            )}/${ship.systems.getTotalHeatStorage()}`\r\n          )}\r\n\r\n          {this.getEntry(\r\n            \"Passive heat change\",\r\n            ship.systems.getPassiveHeatChange()\r\n          )}\r\n        </Row>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ShipTooltipDetails;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport GamePositionComponent from \"../GamePositionComponent\";\r\nimport ShipWindow from \"../shipWindow/ShipWindow\";\r\nimport WeaponTargetingList from \"./WeaponTargetingList\";\r\nimport {\r\n  Tooltip,\r\n  TooltipHeader,\r\n  TooltipEntry,\r\n  TooltipValue,\r\n  TooltipValueHeader\r\n} from \"../../../../styled\";\r\nimport TorpedoAttack from \"./TorpedoAttack\";\r\nimport ShipTooltipDetails from \"./ShipTooltipDetails\";\r\n\r\nconst InfoHeader = styled(TooltipHeader)`\r\n  display: flex;\r\n  justify-content: space-between;\r\n`;\r\n\r\nconst ShipTooltipContainer = styled(Tooltip)`\r\n  width: 315px;\r\n  text-align: left;\r\n  opacity: 0.95;\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  ${props => (props.interactable ? \"z-index: 4;\" : \"z-index: 1;\")}\r\n`;\r\n\r\nexport const Entry = styled(TooltipEntry)`\r\n  text-align: left;\r\n  color: #5e85bc;\r\n  font-family: arial;\r\n  font-size: 11px;\r\n`;\r\n\r\nexport const Header = styled.span`\r\n  color: white;\r\n`;\r\n\r\nexport const TOOLTIP_TAB_TORPEDO_ATTACK = \"toolti_tab_torpedo_attack\";\r\n\r\nclass ShipTooltip extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { tooltipTab: null };\r\n  }\r\n\r\n  selectTooltipTab(name) {\r\n    this.setState({ tooltipTab: name });\r\n  }\r\n\r\n  getMenu() {\r\n    const { ui, shipTooltipMenuProvider } = this.props;\r\n\r\n    const tooltipTab = this.getTooltipTab();\r\n\r\n    if (!tooltipTab) {\r\n      const Menu =\r\n        ui && shipTooltipMenuProvider ? shipTooltipMenuProvider() : null;\r\n      return Menu;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  getTabHeader() {\r\n    const { tooltipTab } = this.state;\r\n\r\n    switch (tooltipTab) {\r\n      case TOOLTIP_TAB_TORPEDO_ATTACK:\r\n        return \"Torpedo attack\";\r\n      default:\r\n        return \"Ship details\";\r\n    }\r\n  }\r\n\r\n  getTooltipTab() {\r\n    const { ship, uiState } = this.props;\r\n    const { tooltipTab } = this.state;\r\n    const { currentUser } = uiState.services;\r\n\r\n    const myShip = ship.player.isUsers(currentUser);\r\n\r\n    if (tooltipTab === TOOLTIP_TAB_TORPEDO_ATTACK && myShip) {\r\n      return null;\r\n    }\r\n\r\n    return tooltipTab;\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      ship,\r\n      getPosition,\r\n      uiState,\r\n      ui,\r\n      shipTooltipMenuProvider,\r\n      className,\r\n      ...rest\r\n    } = this.props;\r\n\r\n    const tooltipTab = this.getTooltipTab();\r\n\r\n    const Menu = this.getMenu();\r\n    const interactable = Boolean(Menu) || tooltipTab;\r\n\r\n    /*\r\n    <GamePositionComponent\r\n        getPosition={getPosition}\r\n        uiState={uiState}\r\n        marginTop={20}\r\n        marginLeft={-150}\r\n      >\r\n      */\r\n\r\n    return (\r\n      <ShipTooltipContainer className={className} interactable={interactable}>\r\n        <InfoHeader>\r\n          <div>{ship.name}</div> <div>{this.getTabHeader()}</div>\r\n        </InfoHeader>\r\n        {Menu && (\r\n          <Menu\r\n            uiState={uiState}\r\n            ship={ship}\r\n            selectTooltipTab={this.selectTooltipTab.bind(this)}\r\n            {...rest}\r\n          />\r\n        )}\r\n        {!tooltipTab && (\r\n          <>\r\n            {Menu && (\r\n              <WeaponTargetingList uiState={uiState} ship={ship} {...rest} />\r\n            )}\r\n            <ShipTooltipDetails ship={ship} uiState={uiState} />\r\n            <ShipWindow ship={ship} uiState={uiState} {...rest} />\r\n          </>\r\n        )}\r\n\r\n        {tooltipTab === TOOLTIP_TAB_TORPEDO_ATTACK && (\r\n          <TorpedoAttack ship={ship} uiState={uiState} {...rest} />\r\n        )}\r\n      </ShipTooltipContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ShipTooltip;\r\n","import * as React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport { TooltipMenu, TooltipButton } from \"../../../../styled\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`;\r\n\r\nconst Text = css`\r\n  color: white;\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n  font-family: arial;\r\n  font-size: 16px;\r\n  text-transform: uppercase;\r\n`;\r\n\r\nconst ShipName = styled.div`\r\n  ${Text}\r\n  padding: 0 5px 0 30px;\r\n  width: 200px;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst Amount = styled.div`\r\n  ${Text}\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 25px;\r\n  height: 25px;\r\n`;\r\n\r\nclass CCEWButtons extends React.PureComponent {\r\n  render() {\r\n    const { name, ship, uiState, ccew } = this.props;\r\n\r\n    return (\r\n      <Container>\r\n        {name && <ShipName>{name}</ShipName>}\r\n        <TooltipButton\r\n          img=\"/img/removeCCEW.png\"\r\n          onClick={() => {\r\n            if (ship.electronicWarfare.canAssignCcEw(-1)) {\r\n              ship.electronicWarfare.assignCcEw(-1);\r\n              uiState.shipStateChanged(ship);\r\n            }\r\n          }}\r\n        />\r\n        <Amount>{ccew}</Amount>\r\n        <TooltipButton\r\n          img=\"/img/addCCEW.png\"\r\n          onClick={() => {\r\n            if (ship.electronicWarfare.canAssignCcEw(1)) {\r\n              ship.electronicWarfare.assignCcEw(1);\r\n              uiState.shipStateChanged(ship);\r\n            }\r\n          }}\r\n        />\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CCEWButtons;\r\n","import * as React from \"react\";\r\nimport { TooltipMenu, TooltipButton } from \"../../../../styled\";\r\nimport OEWButtons from \"../electronicWarfare/OEWButtons\";\r\nimport { TOOLTIP_TAB_TORPEDO_ATTACK } from \"./ShipTooltip\";\r\nimport CCEWButtons from \"../electronicWarfare/CCEWButtons\";\r\n\r\nconst toggleRadiators = (ship, uiState, on = false) => {\r\n  ship.systems\r\n    .getSystems()\r\n    .filter(system => !system.isDestroyed())\r\n    .filter(system => system.callHandler(\"isRadiator\", null, false))\r\n    .filter(system => {\r\n      if (on) {\r\n        return system.power.canSetOnline();\r\n      } else {\r\n        return system.power.canSetOffline();\r\n      }\r\n    })\r\n    .forEach(system => {\r\n      if (on) {\r\n        system.power.setOnline();\r\n      } else {\r\n        system.power.setOffline();\r\n      }\r\n\r\n      uiState.shipSystemStateChanged(ship, system);\r\n    });\r\n};\r\n\r\nconst hasRadiators = ship =>\r\n  ship.systems\r\n    .getSystems()\r\n    .filter(system => !system.isDestroyed())\r\n    .filter(system => system.callHandler(\"isRadiator\", null, false)).length > 0;\r\n\r\nconst hasOnlineradiators = ship =>\r\n  ship.systems\r\n    .getSystems()\r\n    .filter(system => !system.isDestroyed())\r\n    .filter(system => system.callHandler(\"isRadiator\", null, false))\r\n    .filter(system => system.power.canSetOffline())\r\n    .filter(system => system.power.isOnline()).length > 0;\r\n\r\nconst toggleInterceptors = (ship, uiState, on = false) => {\r\n  ship.systems\r\n    .getSystems()\r\n    .filter(system => !system.isDestroyed())\r\n    .filter(system => system.callHandler(\"canIntercept\", null, false))\r\n    .filter(system => {\r\n      if (on) {\r\n        return system.power.canSetOnline();\r\n      } else {\r\n        return system.power.canSetOffline();\r\n      }\r\n    })\r\n    .forEach(system => {\r\n      if (on) {\r\n        system.power.setOnline();\r\n      } else {\r\n        system.power.setOffline();\r\n      }\r\n\r\n      uiState.shipSystemStateChanged(ship, system);\r\n    });\r\n};\r\n\r\nconst hasInterceptors = ship =>\r\n  ship.systems\r\n    .getSystems()\r\n    .filter(system => !system.isDestroyed())\r\n    .filter(system => system.callHandler(\"canIntercept\", null, false)).length >\r\n  0;\r\n\r\nconst hasOnlineInterceptors = ship =>\r\n  ship.systems\r\n    .getSystems()\r\n    .filter(system => !system.isDestroyed())\r\n    .filter(system => system.callHandler(\"canIntercept\", null, false))\r\n    .filter(system => system.power.canSetOffline())\r\n    .filter(system => system.power.isOnline()).length > 0;\r\n\r\nclass GameShipTooltipMenu extends React.PureComponent {\r\n  render() {\r\n    const { ship, uiState, selectTooltipTab } = this.props;\r\n    const { currentUser } = uiState.services;\r\n\r\n    const selectedShip = uiState.getSelectedShip();\r\n\r\n    return (\r\n      <TooltipMenu>\r\n        {ship.player.isUsers(currentUser) && !uiState.isSelected(ship) && (\r\n          <TooltipButton\r\n            img=\"/img/selectShip.png\"\r\n            onClick={() => uiState.selectShip(ship)}\r\n          />\r\n        )}\r\n\r\n        {ship.player.isUsers(currentUser) && (\r\n          <CCEWButtons\r\n            ship={ship}\r\n            uiState={uiState}\r\n            ccew={selectedShip.electronicWarfare.getCcEw()}\r\n          />\r\n        )}\r\n\r\n        {!ship.player.isUsers(currentUser) && selectedShip && (\r\n          <OEWButtons\r\n            ship={selectedShip}\r\n            target={ship}\r\n            uiState={uiState}\r\n            oew={selectedShip.electronicWarfare.getOffensiveEw(ship)}\r\n          />\r\n        )}\r\n\r\n        {ship.player.isUsers(currentUser) && hasRadiators(ship) && (\r\n          <TooltipButton\r\n            img=\"/img/system/radiator.png\"\r\n            onClick={e => {\r\n              e.preventDefault();\r\n              e.stopPropagation();\r\n\r\n              console.log(\"hasOnlineradiators\", hasOnlineradiators(ship));\r\n              toggleRadiators(\r\n                ship,\r\n                uiState,\r\n                hasOnlineradiators(ship) ? false : true\r\n              );\r\n              uiState.shipStateChanged(ship);\r\n              this.forceUpdate();\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {ship.player.isUsers(currentUser) && hasInterceptors(ship) && (\r\n          <TooltipButton\r\n            img=\"/img/system/gatlingPulseCannon.png\"\r\n            onClick={e => {\r\n              e.preventDefault();\r\n              e.stopPropagation();\r\n\r\n              toggleInterceptors(\r\n                ship,\r\n                uiState,\r\n                hasOnlineInterceptors(ship) ? false : true\r\n              );\r\n              uiState.shipStateChanged(ship);\r\n              this.forceUpdate();\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {!ship.player.isUsers(currentUser) && (\r\n          <TooltipButton\r\n            img=\"/img/system/missile1.png\"\r\n            onClick={() => selectTooltipTab(TOOLTIP_TAB_TORPEDO_ATTACK)}\r\n          />\r\n        )}\r\n      </TooltipMenu>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GameShipTooltipMenu;\r\n","import UiStrategy from \"./UiStrategy\";\r\nimport GameShipTooltipMenu from \"../shipTooltip/GameShipTooltipMenu\";\r\n\r\nclass GameShipTooltipMenuStrategy extends UiStrategy {\r\n  activate(services) {\r\n    super.activate(services);\r\n    const { uiState } = this.services;\r\n\r\n    uiState.setTooltipMenuProvider(this.getTooltipComponent);\r\n  }\r\n\r\n  deactivate() {\r\n    super.deactivate();\r\n    const { uiState } = this.services;\r\n\r\n    uiState.setTooltipMenuProvider(null);\r\n  }\r\n\r\n  getTooltipComponent() {\r\n    return GameShipTooltipMenu;\r\n  }\r\n}\r\n\r\nexport default GameShipTooltipMenuStrategy;\r\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass ShowUiModeButtons extends UiStrategy {\r\n  activate(services) {\r\n    super.activate(services);\r\n    const { uiState } = this.services;\r\n    uiState.showUiModeButtons(true);\r\n  }\r\n\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.showUiModeButtons(false);\r\n  }\r\n}\r\n\r\nexport default ShowUiModeButtons;\r\n","import UiStrategy from \"../UiStrategy\";\r\nimport * as gameUiModes from \"../../gameUiModes\";\r\n\r\nclass OwnedShipEw extends UiStrategy {\r\n  deactivate() {\r\n    const { electronicWarfareIndicatorService } = this.services;\r\n    electronicWarfareIndicatorService.hideAll();\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n    this.show();\r\n  }\r\n\r\n  uiStateChanged() {\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    this.show();\r\n  }\r\n\r\n  shipStateChanged(ship) {\r\n    const { electronicWarfareIndicatorService, uiState } = this.services;\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !uiState.hasGameUiMode(gameUiModes.EW) &&\r\n      uiState.getSelectedShip() !== ship\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    electronicWarfareIndicatorService.showForShip(ship);\r\n  }\r\n\r\n  mouseOutShip() {\r\n    this.show();\r\n  }\r\n\r\n  show() {\r\n    const {\r\n      electronicWarfareIndicatorService,\r\n      uiState,\r\n      currentUser\r\n    } = this.services;\r\n\r\n    electronicWarfareIndicatorService.hideAll();\r\n\r\n    if (uiState.hasGameUiMode(gameUiModes.EW)) {\r\n      this.gameData.ships\r\n        .getUsersShips(currentUser)\r\n        .forEach(ship => electronicWarfareIndicatorService.showForShip(ship));\r\n    }\r\n\r\n    if (\r\n      !uiState.hasGameUiMode([gameUiModes.ENEMY_WEAPONS, gameUiModes.WEAPONS])\r\n    ) {\r\n      const ship = uiState.getSelectedShip();\r\n      if (ship) {\r\n        electronicWarfareIndicatorService.showForShip(ship);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default OwnedShipEw;\r\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass ShipClickSelectsShip extends UiStrategy {\r\n  shipClicked(payload) {\r\n    const { uiState, currentUser } = this.services;\r\n    const ship = payload.entity.ship;\r\n\r\n    if (ship.player.isUsers(currentUser) && !uiState.isSelected(ship)) {\r\n      uiState.selectShip(ship);\r\n    }\r\n  }\r\n}\r\n\r\nexport default ShipClickSelectsShip;\r\n","import UiStrategy from \"../UiStrategy\";\r\nimport * as gameUiModes from \"../../gameUiModes\";\r\n\r\nclass CurrentEW extends UiStrategy {\r\n  deactivate() {\r\n    const { electronicWarfareIndicatorService } = this.services;\r\n    electronicWarfareIndicatorService.hideAllCurrent();\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n    this.show();\r\n  }\r\n\r\n  uiStateChanged() {\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    this.show();\r\n  }\r\n\r\n  mouseOutShip() {\r\n    this.show();\r\n  }\r\n\r\n  show() {\r\n    const {\r\n      electronicWarfareIndicatorService,\r\n      uiState,\r\n      currentUser\r\n    } = this.services;\r\n\r\n    electronicWarfareIndicatorService.hideAllCurrent();\r\n\r\n    if (uiState.hasGameUiMode(gameUiModes.ENEMY_WEAPONS)) {\r\n      this.gameData.ships\r\n        .getShipsEnemyTeams(currentUser)\r\n        .forEach(ship =>\r\n          electronicWarfareIndicatorService.showCurrentForShip(ship)\r\n        );\r\n    }\r\n\r\n    if (uiState.hasGameUiMode(gameUiModes.WEAPONS)) {\r\n      this.gameData.ships\r\n        .getShipsInSameTeam(currentUser)\r\n        .forEach(ship =>\r\n          electronicWarfareIndicatorService.showCurrentForShip(ship)\r\n        );\r\n    }\r\n  }\r\n}\r\n\r\nexport default CurrentEW;\r\n","import * as THREE from \"three\";\r\nimport UiStrategy from \"../UiStrategy\";\r\nimport {\r\n  degreeToRadian,\r\n  addToDirection,\r\n  getArcLength\r\n} from \"../../../../../../model/utils/math\";\r\nimport abstractCanvas from \"../../../utils/abstractCanvas\";\r\n\r\nclass WeaponArcsOnSystemMouseOver extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n    this.weaponArcs = [];\r\n  }\r\n\r\n  deactivate() {\r\n    this.hide();\r\n  }\r\n\r\n  systemMouseOver({ ship, system }) {\r\n    if (!system.callHandler(\"hasArcs\")) {\r\n      return;\r\n    }\r\n\r\n    this.show(ship, system);\r\n  }\r\n\r\n  systemMouseOut() {\r\n    this.hide();\r\n  }\r\n\r\n  hide() {\r\n    const { scene } = this.services;\r\n    this.weaponArcs = this.weaponArcs.filter(({ mesh, circle }) => {\r\n      mesh.remove(circle);\r\n    });\r\n  }\r\n\r\n  show(ship, system) {\r\n    const { coordinateConverter, shipIconContainer } = this.services;\r\n    const icon = shipIconContainer.getByShip(ship);\r\n\r\n    const maxRange = system.callHandler(\"getMaxRange\");\r\n    const distance = maxRange * coordinateConverter.getHexDistance();\r\n\r\n    const arcsList = system.callHandler(\"getArcs\", {\r\n      facing: icon.getFacing()\r\n    });\r\n\r\n    const canvas = abstractCanvas.create(maxRange + 1, 1);\r\n    const context = canvas.getContext(\"2d\");\r\n\r\n    for (let range = 0; range <= maxRange; range++) {\r\n      const rangePenalty = system.callHandler(\"getRangeModifier\", {\r\n        distance: range\r\n      });\r\n\r\n      const opacity = (100 + rangePenalty) / 100;\r\n\r\n      if (opacity < 0) {\r\n        opacity = 0;\r\n      }\r\n\r\n      context.fillStyle =\r\n        \"rgba(\" + 2 + \",\" + 80 + \",\" + 128 + \",\" + opacity + \")\";\r\n      context.fillRect(range, 0, 1, 1);\r\n    }\r\n\r\n    const texture = new THREE.CanvasTexture(canvas);\r\n\r\n    const material = new THREE.MeshBasicMaterial({\r\n      color: new THREE.Color(\"rgb(20,80,128)\"),\r\n      opacity: 1,\r\n      transparent: true,\r\n      map: texture\r\n    });\r\n\r\n    arcsList.forEach(arcs => {\r\n      const arcLenght =\r\n        arcs.start === arcs.end ? 360 : getArcLength(arcs.start, arcs.end);\r\n\r\n      const geometry = new THREE.CircleGeometry(\r\n        distance,\r\n        32,\r\n        degreeToRadian(addToDirection(360, -arcs.end)),\r\n        degreeToRadian(arcLenght)\r\n      );\r\n\r\n      geometry.faceVertexUvs = [\r\n        geometry.faceVertexUvs[0].map(intial => [\r\n          new THREE.Vector2(1, 0),\r\n          new THREE.Vector2(1, 0),\r\n          new THREE.Vector2(0, 0)\r\n        ])\r\n      ];\r\n\r\n      geometry.uvsNeedUpdate = true;\r\n      const circle = new THREE.Mesh(geometry, material);\r\n      circle.position.z = -1;\r\n      icon.mesh.add(circle);\r\n      this.weaponArcs.push({ mesh: icon.mesh, circle });\r\n    });\r\n  }\r\n}\r\n\r\nexport default WeaponArcsOnSystemMouseOver;\r\n","import * as THREE from \"three\";\r\nimport UiStrategy from \"../UiStrategy\";\r\nimport {\r\n  degreeToRadian,\r\n  addToDirection,\r\n  getArcLength\r\n} from \"../../../../../../model/utils/math\";\r\n\r\nconst material = new THREE.MeshBasicMaterial({\r\n  color: new THREE.Color(\"rgb(20,80,128)\"),\r\n  opacity: 0.5,\r\n  transparent: true\r\n});\r\n\r\nclass SelectWeaponOnSystemClick extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n    this.weaponArcs = [];\r\n  }\r\n\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n\r\n    uiState.deselectAllSystems();\r\n  }\r\n\r\n  systemClicked({ ship, system, scs }) {\r\n    const { uiState, currentUser } = this.services;\r\n\r\n    if (scs || !system.isWeapon() || !ship.player.is(currentUser)) {\r\n      return;\r\n    }\r\n\r\n    if (uiState.isSelectedSystem(system)) {\r\n      uiState.deselectSystem(system);\r\n    } else {\r\n      uiState.selectSystem(ship, system);\r\n    }\r\n\r\n    uiState.updateState();\r\n  }\r\n}\r\n\r\nexport default SelectWeaponOnSystemClick;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass SelectedShipSystemList extends UiStrategy {\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.setSystemList([]);\r\n  }\r\n\r\n  update(gameData) {\r\n    const { uiState } = this.services;\r\n    super.update(gameData);\r\n\r\n    const ship = uiState.getSelectedShip();\r\n    if (ship) {\r\n      uiState.setSystemList(\r\n        ship.systems.getSystems().filter(system => system.showOnSystemList())\r\n      );\r\n    }\r\n  }\r\n\r\n  shipSelected(ship) {\r\n    const { uiState } = this.services;\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    uiState.setSystemList(\r\n      ship.systems.getSystems().filter(system => system.showOnSystemList())\r\n    );\r\n  }\r\n}\r\n\r\nexport default SelectedShipSystemList;\r\n","import * as React from \"react\";\r\nimport { TooltipMenu, TooltipButton, TooltipValue } from \"../../../../styled\";\r\nimport OEWButtons from \"../electronicWarfare/OEWButtons\";\r\n\r\nclass GameSystemTooltipMenu extends React.PureComponent {\r\n  render() {\r\n    const { ship, system, uiState } = this.props;\r\n    const { currentUser } = uiState.services;\r\n\r\n    const myShip = ship.player.is(currentUser);\r\n    const selectedShip = uiState.getSelectedShip();\r\n\r\n    if (system.isDestroyed()) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <TooltipMenu>\r\n        {myShip && ship.systems.power.canSetOnline(system) && (\r\n          <TooltipButton\r\n            img=\"/img/goOnline.png\"\r\n            onClick={e => {\r\n              e.preventDefault();\r\n              e.stopPropagation();\r\n              system.power.setOnline();\r\n              uiState.shipSystemStateChanged(ship, system);\r\n              uiState.shipStateChanged(ship);\r\n              this.forceUpdate();\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {myShip && ship.systems.power.canSetOffline(system) && (\r\n          <TooltipButton\r\n            img=\"/img/goOffline.png\"\r\n            onClick={e => {\r\n              e.preventDefault();\r\n              e.stopPropagation();\r\n              system.power.setOffline();\r\n              uiState.shipSystemStateChanged(ship, system);\r\n              uiState.shipStateChanged(ship);\r\n              this.forceUpdate();\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {myShip &&\r\n          !system.isDisabled() &&\r\n          system.callHandler(\"isBoostable\", null, false) && (\r\n            <TooltipButton\r\n              img=\"/img/plus.png\"\r\n              disabled={!system.callHandler(\"canBoost\", null, false)}\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if ((!system.callHandler(\"canBoost\"), null, false)) {\r\n                  return;\r\n                }\r\n\r\n                system.callHandler(\"boost\");\r\n                uiState.shipSystemStateChanged(ship, system);\r\n                uiState.shipStateChanged(ship);\r\n                this.forceUpdate();\r\n              }}\r\n            />\r\n          )}\r\n\r\n        {myShip &&\r\n          !system.isDisabled() &&\r\n          system.callHandler(\"isBoostable\", null, false) && (\r\n            <TooltipButton\r\n              img=\"/img/minus.png\"\r\n              disabled={!system.callHandler(\"canDeBoost\", null, false)}\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (!system.callHandler(\"canDeBoost\", null, false)) {\r\n                  return;\r\n                }\r\n                system.callHandler(\"deBoost\");\r\n                uiState.shipSystemStateChanged(ship, system);\r\n                uiState.shipStateChanged(ship);\r\n                this.forceUpdate();\r\n              }}\r\n            />\r\n          )}\r\n\r\n        {system\r\n          .callHandler(\"getTooltipMenuButton\", { uiState, myShip }, [])\r\n          .map(({ img, disabledHandler, onClickHandler }, i) => (\r\n            <TooltipButton\r\n              key={`custom-system-tooltip-button-${i}`}\r\n              img={img}\r\n              disabled={disabledHandler}\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                onClickHandler();\r\n                uiState.shipSystemStateChanged(ship, system);\r\n                uiState.shipStateChanged(ship);\r\n                this.forceUpdate();\r\n              }}\r\n            />\r\n          ))}\r\n      </TooltipMenu>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GameSystemTooltipMenu;\r\n","import UiStrategy from \"./UiStrategy\";\r\nimport GameSystemTooltipMenu from \"../system/GameSystemTooltipMenu\";\r\n\r\nclass GameSystemInfoMenuStrategy extends UiStrategy {\r\n  activate(services) {\r\n    super.activate(services);\r\n    const { uiState } = this.services;\r\n\r\n    uiState.setSystemInfoMenuProvider(this.getTooltipComponent);\r\n  }\r\n\r\n  deactivate() {\r\n    super.deactivate();\r\n    const { uiState } = this.services;\r\n\r\n    uiState.setSystemInfoMenuProvider(null);\r\n  }\r\n\r\n  getTooltipComponent() {\r\n    return GameSystemTooltipMenu;\r\n  }\r\n}\r\n\r\nexport default GameSystemInfoMenuStrategy;\r\n","import UiStrategy from \"./UiStrategy\";\r\n\r\nclass SystemClickShowsSystemMenu extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n\r\n    this.clickedSystem = null;\r\n  }\r\n\r\n  shipStateChanged() {\r\n    const { uiState } = this.services;\r\n    if (this.clickedSystem) {\r\n      uiState.setSystemMenuActiveSystem(this.clickedSystem, this.element);\r\n    }\r\n  }\r\n\r\n  closeSystemInfo() {\r\n    this.hide();\r\n  }\r\n\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    if (this.clickedShip) {\r\n      uiState.setSystemMenuActiveSystem(null, null);\r\n    }\r\n  }\r\n\r\n  systemClicked({ system, element, scs }) {\r\n    const { uiState } = this.services;\r\n\r\n    if (!scs) {\r\n      return;\r\n    }\r\n\r\n    this.clickedSystem = system;\r\n    this.element = element;\r\n    uiState.setSystemMenuActiveSystem(this.clickedSystem, this.element);\r\n  }\r\n\r\n  hexClicked() {\r\n    this.hide();\r\n  }\r\n\r\n  mouseOverShip(payload) {\r\n    this.hide();\r\n  }\r\n\r\n  mouseOutShip() {\r\n    this.hide();\r\n  }\r\n\r\n  hide() {\r\n    if (!this.clickedSystem) {\r\n      return;\r\n    }\r\n\r\n    const { uiState } = this.services;\r\n    uiState.setSystemMenuActiveSystem(null, null);\r\n    this.clickedSystem = null;\r\n    this.element = null;\r\n  }\r\n}\r\n\r\nexport default SystemClickShowsSystemMenu;\r\n","import UiStrategy from \"../UiStrategy\";\r\n\r\nclass SelectedShipEwList extends UiStrategy {\r\n  deactivate() {\r\n    const { uiState } = this.services;\r\n    uiState.setEwList([]);\r\n  }\r\n\r\n  shipStateChanged() {\r\n    const { uiState } = this.services;\r\n    const ship = uiState.getSelectedShip();\r\n\r\n    uiState.setEwList(ship.electronicWarfare.getAllOew());\r\n  }\r\n\r\n  shipSelected(ship) {\r\n    const { uiState } = this.services;\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    uiState.setEwList(ship.electronicWarfare.getAllOew());\r\n  }\r\n}\r\n\r\nexport default SelectedShipEwList;\r\n","import UiStrategy from \"./UiStrategy\";\r\nimport {\r\n  COLOR_FRIENDLY,\r\n  COLOR_ENEMY,\r\n  ZOOM_FOR_MAPICONS\r\n} from \"../../../../../model/gameConfig.mjs\";\r\n\r\nclass UnderHexForShips extends UiStrategy {\r\n  constructor() {\r\n    super();\r\n\r\n    this.showing = false;\r\n  }\r\n\r\n  show() {\r\n    const { shipIconContainer, currentUser } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      icon.hexSpriteContainer.visible = true;\r\n      const color = icon.ship.player.isUsers(currentUser)\r\n        ? COLOR_FRIENDLY\r\n        : COLOR_ENEMY;\r\n\r\n      icon.hexSprites.forEach(sprite => sprite.setOverlayColor(color));\r\n      icon.line.setColor(color);\r\n      icon.line.show();\r\n    });\r\n\r\n    this.showing = true;\r\n  }\r\n\r\n  hide() {\r\n    const { shipIconContainer } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      icon.hexSpriteContainer.visible = false;\r\n\r\n      icon.line.hide();\r\n    });\r\n\r\n    this.showing = false;\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n    this.show();\r\n  }\r\n\r\n  render({ zoom }) {\r\n    if (zoom > ZOOM_FOR_MAPICONS && this.showing) {\r\n      this.hide();\r\n    }\r\n\r\n    if (zoom <= ZOOM_FOR_MAPICONS && !this.showing) {\r\n      this.show();\r\n    }\r\n  }\r\n\r\n  deactivate() {\r\n    this.hide();\r\n  }\r\n}\r\n\r\nexport default UnderHexForShips;\r\n","import AnimationUiStrategy from \"./AnimationUiStrategy\";\r\nimport {\r\n  COLOR_FRIENDLY,\r\n  COLOR_ENEMY,\r\n  ZOOM_FOR_MAPICONS,\r\n  COLOR_FRIENDLY_HIGHLIGHT,\r\n  COLOR_ENEMY_HIGHLIGHT,\r\n  ZOOM_MAX\r\n} from \"../../../../../model/gameConfig.mjs\";\r\n\r\nclass ShowMapIcons extends AnimationUiStrategy {\r\n  constructor() {\r\n    super();\r\n\r\n    this.zoom = 1;\r\n    this.showingIcons = false;\r\n  }\r\n\r\n  showHighligh(icon) {\r\n    const { currentUser } = this.services;\r\n    const color = icon.ship.player.isUsers(currentUser)\r\n      ? COLOR_FRIENDLY_HIGHLIGHT\r\n      : COLOR_ENEMY_HIGHLIGHT;\r\n\r\n    icon.mapIcon.replaceColor(color);\r\n  }\r\n\r\n  hideHighligh() {\r\n    const { shipIconContainer, currentUser } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      const ghost = shipIconContainer.getGhostShipIconByShip(icon.ship);\r\n      ghost.mapIcon.revertColor();\r\n      icon.mapIcon.revertColor();\r\n    });\r\n  }\r\n\r\n  mouseOverShip(payload) {\r\n    const icon = payload.entity;\r\n    this.showHighligh(icon);\r\n  }\r\n\r\n  uiStateChanged() {\r\n    this.shouldShow(this.zoom, true);\r\n  }\r\n\r\n  shipStateChanged() {\r\n    this.shouldShow(this.zoom, true);\r\n  }\r\n\r\n  mouseOutShip() {\r\n    this.hideHighligh();\r\n    this.shouldShow(this.zoom, true);\r\n  }\r\n\r\n  mouseOut() {\r\n    this.hideHighligh();\r\n  }\r\n\r\n  showIcons() {\r\n    this.changeScale(1);\r\n    const { shipIconContainer, currentUser, gameCamera } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      const color = icon.ship.player.isUsers(currentUser)\r\n        ? COLOR_FRIENDLY\r\n        : COLOR_ENEMY;\r\n\r\n      const ghost = shipIconContainer.getGhostShipIconByShip(icon.ship);\r\n      ghost.showMapIcon(color);\r\n      icon.showMapIcon(color);\r\n    });\r\n    this.showingIcons = true;\r\n    gameCamera.changeToMapView();\r\n  }\r\n\r\n  hideIcons() {\r\n    this.changeScale(1);\r\n    const { shipIconContainer, gameCamera } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      icon.hideMapIcon();\r\n      const ghost = shipIconContainer.getGhostShipIconByShip(icon.ship);\r\n      ghost.hideMapIcon();\r\n    });\r\n\r\n    this.showingIcons = false;\r\n    gameCamera.changeToCloseView();\r\n  }\r\n\r\n  changeScale(scale) {\r\n    const { shipIconContainer } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      icon.mapIcon.setScale(scale);\r\n      const ghost = shipIconContainer.getGhostShipIconByShip(icon.ship);\r\n      ghost.mapIcon.setScale(scale);\r\n    });\r\n  }\r\n\r\n  shouldShow(zoom, force = false) {\r\n    if (!this.services) {\r\n      return;\r\n    }\r\n\r\n    if (zoom > ZOOM_FOR_MAPICONS && (force || !this.showingIcons)) {\r\n      this.showIcons();\r\n    }\r\n\r\n    if (zoom <= ZOOM_FOR_MAPICONS && (force || this.showingIcons)) {\r\n      this.hideIcons();\r\n    }\r\n\r\n    if (zoom > ZOOM_FOR_MAPICONS) {\r\n      /*\r\n      const extraScale =\r\n        ((zoom - ZOOM_FOR_MAPICONS) / (ZOOM_MAX - ZOOM_FOR_MAPICONS)) * 5 + 1;\r\n        */\r\n\r\n      const extraScale = zoom;\r\n\r\n      this.changeScale(extraScale);\r\n    }\r\n  }\r\n\r\n  render({ zoom }) {\r\n    if (zoom === this.zoom) {\r\n      return;\r\n    }\r\n\r\n    this.zoom = zoom;\r\n\r\n    this.shouldShow(zoom);\r\n  }\r\n\r\n  deactivate() {\r\n    super.deactivate();\r\n    this.hideIcons();\r\n  }\r\n}\r\n\r\nexport default ShowMapIcons;\r\n","import AnimationUiStrategy from \"./AnimationUiStrategy\";\r\nimport {\r\n  COLOR_FRIENDLY,\r\n  COLOR_ENEMY,\r\n  ZOOM_FOR_MAPICONS,\r\n  ZOOM_FOR_SHIPBADGE,\r\n  ZOOM_FOR_SHIPBADGE_NAME,\r\n  ZOOM_MAX\r\n} from \"../../../../../model/gameConfig.mjs\";\r\n\r\nclass ShowShipBadges extends AnimationUiStrategy {\r\n  constructor() {\r\n    super();\r\n\r\n    this.zoom = 1;\r\n    this.showing = false;\r\n    this.showingName = false;\r\n  }\r\n\r\n  /*\r\n  uiStateChanged() {\r\n    this.shouldShow(this.zoom, true);\r\n  }*/\r\n\r\n  shipStateChanged(ship) {\r\n    this.show(ship);\r\n  }\r\n\r\n  updateShip(ship) {\r\n    const { shipIconContainer, uiState } = this.services;\r\n    const icon = shipIconContainer.getByShip(ship);\r\n    uiState.showShipBadge(icon);\r\n  }\r\n\r\n  /*\r\n\r\n  mouseOutShip() {\r\n    this.shouldShow(this.zoom, true);\r\n  }\r\n  */\r\n\r\n  show(showName) {\r\n    const { shipIconContainer, uiState } = this.services;\r\n\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      uiState.showShipBadge(icon, showName);\r\n    });\r\n    this.showing = true;\r\n    this.showingName = showName;\r\n  }\r\n\r\n  hide() {\r\n    const { shipIconContainer, uiState } = this.services;\r\n    shipIconContainer.getArray().forEach(icon => {\r\n      uiState.hideShipBadge(icon);\r\n    });\r\n    this.showing = false;\r\n  }\r\n\r\n  shouldShow(zoom, force = false) {\r\n    if (!this.services) {\r\n      return;\r\n    }\r\n\r\n    if (zoom > ZOOM_FOR_SHIPBADGE && (force || this.showing)) {\r\n      this.hide();\r\n    }\r\n\r\n    if (zoom <= ZOOM_FOR_SHIPBADGE) {\r\n      //const showName = zoom <= ZOOM_FOR_SHIPBADGE_NAME;\r\n\r\n      if (/* this.showingName !== showName || */ force || !this.showing) {\r\n        this.show(/* showName */);\r\n      }\r\n    }\r\n  }\r\n\r\n  render({ zoom }) {\r\n    this.zoom = zoom;\r\n\r\n    this.shouldShow(zoom);\r\n  }\r\n\r\n  deactivate() {\r\n    this.hide();\r\n  }\r\n}\r\n\r\nexport default ShowShipBadges;\r\n","import * as THREE from \"three\";\r\nimport AnimationUiStrategy from \"./AnimationUiStrategy\";\r\nimport { getCompassHeadingOfPoint } from \"../../../../../model/utils/math.mjs\";\r\nimport { getSeededRandomGenerator } from \"../../../../../model/utils/math.mjs\";\r\nimport Vector from \"../../../../../model/utils/Vector.mjs\";\r\nimport { TORPEDO_Z } from \"../../../../../model/gameConfig.mjs\";\r\nimport TorpedoMovementService from \"../../../../../model/movement/TorpedoMovementService.mjs\";\r\nimport MovementService from \"../../../../../model/movement/MovementService.mjs\";\r\nimport Line from \"../../renderer/Line\";\r\n\r\nclass ShowTorpedoObjects extends AnimationUiStrategy {\r\n  constructor() {\r\n    super();\r\n    this.torpedoMovementService = new TorpedoMovementService();\r\n    this.movementService = new MovementService();\r\n    this.lines = [];\r\n  }\r\n\r\n  update(gameData) {\r\n    super.update(gameData);\r\n\r\n    gameData.torpedos.getTorpedoFlights().forEach(flight => {\r\n      const target = gameData.ships.getShipById(flight.targetId);\r\n      if (this.torpedoMovementService.reachesTargetThisTurn(flight, target)) {\r\n        this.handleImpactingTorpedo(flight, target);\r\n        return;\r\n      } else {\r\n        this.handleTorpedo(flight);\r\n      }\r\n    });\r\n  }\r\n\r\n  shipStateChanged(ship) {\r\n    if (!this.gameData) {\r\n      return;\r\n    }\r\n\r\n    this.gameData.torpedos\r\n      .getTorpedoFlights()\r\n      .filter(flight => flight.targetId === ship.id)\r\n      .forEach(flight => {\r\n        if (this.torpedoMovementService.reachesTargetThisTurn(flight, ship)) {\r\n          this.handleImpactingTorpedo(flight, ship);\r\n        }\r\n      });\r\n  }\r\n\r\n  handleImpactingTorpedo(flight, target) {\r\n    const { torpedoIconContainer, scene, shipIconContainer } = this.services;\r\n\r\n    const icon = torpedoIconContainer.getIconByTorpedoFlight(flight);\r\n    const getRandom = getSeededRandomGenerator(icon.torpedoFlight.id);\r\n    const variance = new Vector(getRandom() * 100 - 50, getRandom() * 100 - 50);\r\n\r\n    const launchPosition = flight.launchPosition;\r\n    const targetPosition = this.movementService.getNewEndMove(\r\n      target,\r\n      this.gameData.terrain\r\n    ).position;\r\n\r\n    const torpedoPosition = launchPosition\r\n      .sub(targetPosition)\r\n      .normalize()\r\n      .multiplyScalar(500)\r\n      .add(targetPosition)\r\n      .setZ(TORPEDO_Z)\r\n      .add(variance);\r\n\r\n    icon.setPosition(torpedoPosition);\r\n    icon.setFacing(\r\n      -getCompassHeadingOfPoint(\r\n        flight.position,\r\n        flight.position.add(flight.velocity)\r\n      )\r\n    );\r\n\r\n    let line = this.lines.find(\r\n      ({ flightId, targetId }) =>\r\n        flightId === flight.id && targetId === target.id\r\n    );\r\n\r\n    if (!line) {\r\n      line = new Line(scene, {\r\n        start: torpedoPosition,\r\n        end: targetPosition.setZ(shipIconContainer.getByShip(target).shipZ),\r\n        width: 2,\r\n        color: new THREE.Color(255 / 255, 40 / 255, 40 / 255),\r\n        opacity: 0.01,\r\n        pulseAmount: 1\r\n      });\r\n      line.show();\r\n      this.lines.push({\r\n        targetId: target.id,\r\n        flightId: flight.id,\r\n        line\r\n      });\r\n    } else {\r\n      line.line.update(\r\n        torpedoPosition,\r\n        targetPosition.setZ(shipIconContainer.getByShip(target).shipZ),\r\n        2\r\n      );\r\n    }\r\n\r\n    icon.show();\r\n  }\r\n\r\n  handleTorpedo(flight) {\r\n    const { torpedoIconContainer } = this.services;\r\n\r\n    const icon = torpedoIconContainer.getIconByTorpedoFlight(flight);\r\n\r\n    const getRandom = getSeededRandomGenerator(icon.torpedoFlight.id);\r\n    const variance = new Vector(getRandom() * 30 - 15, getRandom() * 30 - 15);\r\n\r\n    icon.setPosition(flight.position.setZ(TORPEDO_Z).add(variance));\r\n    icon.setFacing(\r\n      -getCompassHeadingOfPoint(\r\n        flight.position,\r\n        flight.position.add(flight.velocity)\r\n      )\r\n    );\r\n\r\n    icon.show();\r\n  }\r\n\r\n  deactivate() {\r\n    const { torpedoIconContainer } = this.services;\r\n    torpedoIconContainer.getArray().forEach(icon => {\r\n      icon.hide();\r\n    }, this);\r\n\r\n    this.lines.forEach(line => line.line.destroy());\r\n    return super.deactivate();\r\n  }\r\n}\r\n\r\nexport default ShowTorpedoObjects;\r\n","import PhaseStrategy from \"./PhaseStrategy\";\nimport {\n  ShowDeploymentAreas,\n  ShowShipObjects,\n  RightClickShowsShipWindow,\n  MouseOverHighlightsShip,\n  MouseOverShowsMovementPath,\n  MouseOverShowsShipTooltip,\n  SelectUndeployedShip,\n  HighlightSelectedShip,\n  DeployShipOnHexClick,\n  AllowSubmittingWhenDeploymentDone,\n  DebugDrawLineFromSelectedShip,\n  SelectedShipNavigationPath,\n  SelectedShipDeploymentMovementUi,\n  ShipClickSelectsShip\n} from \"../../ui/uiStrategy\";\n\nclass DeploymentPhaseStrategy extends PhaseStrategy {\n  constructor(services) {\n    super(services);\n\n    this.strategies = [\n      new ShipClickSelectsShip(),\n      new RightClickShowsShipWindow(),\n      new ShowDeploymentAreas(),\n      new MouseOverHighlightsShip(),\n      new MouseOverShowsMovementPath(),\n      new ShowShipObjects(),\n      new MouseOverShowsShipTooltip(),\n      new SelectUndeployedShip(),\n      new HighlightSelectedShip(),\n      new DeployShipOnHexClick(),\n      new AllowSubmittingWhenDeploymentDone(),\n      //new SelectedShipNavigationPath(),\n      new SelectedShipDeploymentMovementUi()\n    ];\n  }\n\n  commitTurn(gameConnector) {\n    gameConnector.commitDeployment(this.gameData);\n  }\n}\n\nexport default DeploymentPhaseStrategy;\n","import PhaseStrategy from \"./PhaseStrategy\";\n\nclass ReplayPhaseStrategy extends PhaseStrategy {}\n\nexport default ReplayPhaseStrategy;\n","import PhaseStrategy from \"./PhaseStrategy\";\n\nimport {\n  ShowDeploymentAreas,\n  ShowShipObjects,\n  RightClickShowsShipWindow,\n  MouseOverHighlightsShip,\n  MouseOverShowsMovementPath,\n  MouseOverShowsShipTooltip,\n  SelectUndeployedShip,\n  HighlightSelectedShip,\n  DeployShipOnHexClick,\n  AllowSubmittingWhenDeploymentDone,\n  DebugDrawLineFromSelectedShip,\n  SelectedShipNavigationPath,\n  SelectedShipDeploymentMovementUi,\n  ShowWaitingStatus\n} from \"../../ui/uiStrategy\";\n\nclass WaitingPhaseStrategy extends PhaseStrategy {\n  constructor(services) {\n    super(services);\n\n    this.strategies = [\n      new ShowWaitingStatus(),\n      new RightClickShowsShipWindow(),\n      new MouseOverHighlightsShip(),\n      new MouseOverShowsMovementPath(),\n      new ShowShipObjects(),\n      new MouseOverShowsShipTooltip()\n    ];\n  }\n}\n\nexport default WaitingPhaseStrategy;\n","import PhaseStrategy from \"./PhaseStrategy\";\nimport {\n  ShowShipObjects,\n  MouseOverHighlightsShip,\n  MouseOverShowsShipTooltip,\n  HighlightSelectedShip,\n  SelectedShipMovementUi,\n  SelectFirstActiveShip,\n  AllShipsMovementPaths,\n  AllowSubmittingOnValidGameState,\n  GameShipTooltipMenuStrategy,\n  ShowUiModeButtons,\n  OwnedShipEw,\n  ShipClickSelectsShip,\n  CurrentEW,\n  WeaponArcsOnSystemMouseOver,\n  SelectWeaponOnSystemClick,\n  SelectedShipSystemList,\n  GameSystemInfoMenuStrategy,\n  SystemClickShowsSystemMenu,\n  SelectedShipEwList,\n  UnderHexForShips,\n  ShowMapIcons,\n  ShowShipBadges,\n  ShowTorpedoObjects\n} from \"../../ui/uiStrategy\";\n\nclass GamePhaseStrategy extends PhaseStrategy {\n  constructor(services) {\n    super(services);\n\n    this.strategies = [\n      new ShipClickSelectsShip(),\n      new MouseOverHighlightsShip(),\n      new ShowShipObjects(),\n      new MouseOverShowsShipTooltip(),\n      new SelectFirstActiveShip(),\n      new HighlightSelectedShip(),\n      new SelectedShipMovementUi(),\n      new AllShipsMovementPaths(),\n      new AllowSubmittingOnValidGameState(),\n      new GameShipTooltipMenuStrategy(),\n      new ShowUiModeButtons(),\n      new OwnedShipEw(),\n      new CurrentEW(),\n      new WeaponArcsOnSystemMouseOver(),\n      new SelectWeaponOnSystemClick(),\n      new SelectedShipSystemList(),\n      new GameSystemInfoMenuStrategy(),\n      new SystemClickShowsSystemMenu(),\n      new SelectedShipEwList(),\n      new UnderHexForShips(),\n      new ShowMapIcons(),\n      new ShowShipBadges(),\n      new ShowTorpedoObjects()\n    ];\n  }\n\n  commitTurn(gameConnector) {\n    gameConnector.commitTurn(this.gameData);\n  }\n}\n\nexport default GamePhaseStrategy;\n","import * as THREE from \"three\";\r\nimport Animation from \"./Animation\";\r\nimport { hexFacingToAngle } from \"../../../../model/utils/math.mjs\";\r\n\r\nclass ShipVelocityAnimation extends Animation {\r\n  constructor(shipIcon, endMove, start, end) {\r\n    super();\r\n\r\n    this.shipIcon = shipIcon;\r\n    this.endMove = endMove;\r\n\r\n    this.start = start;\r\n    this.end = end;\r\n\r\n    this.duration = end - start;\r\n\r\n    this.positionCurve = this.buildPositionCurve(\r\n      endMove.position,\r\n      endMove.position.add(endMove.velocity)\r\n    );\r\n\r\n    Animation.call(this);\r\n  }\r\n\r\n  deactivate() {}\r\n\r\n  update(gameData) {}\r\n\r\n  cleanUp() {}\r\n\r\n  getPositionAt(time) {\r\n    const turnDone = this.getMovementTurnDone({ total: time });\r\n\r\n    if (turnDone === -1) {\r\n      throw new Error(\"Don't ask ShipVelocityAnimation\");\r\n    }\r\n\r\n    const percentDone = turnDone < 1 ? turnDone % 1 : 1;\r\n\r\n    return {\r\n      facing: this.endMove.facing,\r\n      position: this.positionCurve.getPoint(percentDone)\r\n    };\r\n  }\r\n\r\n  getMovementTurnDone({ total }) {\r\n    if (total < this.start) {\r\n      return -1;\r\n    }\r\n\r\n    if (total > this.end) {\r\n      return 1;\r\n    }\r\n    const time = total - this.start;\r\n    return time / this.duration;\r\n  }\r\n\r\n  render(payload) {\r\n    const turnDone = this.getMovementTurnDone(payload);\r\n\r\n    if (turnDone === -1) {\r\n      return;\r\n    }\r\n\r\n    const percentDone = turnDone < 1 ? turnDone % 1 : 1;\r\n    this.shipIcon.setPosition(this.positionCurve.getPoint(percentDone));\r\n    this.shipIcon.setFacing(-hexFacingToAngle(this.endMove.facing));\r\n  }\r\n\r\n  buildPositionCurve(start, end) {\r\n    const point1 = start.roundToHexCenter();\r\n    const control1 = start.roundToHexCenter();\r\n    const control2 = end.roundToHexCenter();\r\n    const point2 = end.roundToHexCenter();\r\n\r\n    return new THREE.CubicBezierCurve3(\r\n      new THREE.Vector3(point1.x, point1.y, point1.z),\r\n      new THREE.Vector3(control1.x, control1.y, control1.z),\r\n      new THREE.Vector3(control2.x, control2.y, control2.z),\r\n      new THREE.Vector3(point2.x, point2.y, point2.z)\r\n    );\r\n  }\r\n}\r\n\r\nexport default ShipVelocityAnimation;\r\n","import { ShipMovementAnimation } from \"../../../animation\";\r\nimport ShipVelocityAnimation from \"../../../animation/ShipVelocityAnimation\";\r\n\r\nclass ReplayContext {\r\n  constructor(phaseStrategy) {\r\n    this.firingDuration = 0;\r\n    this.movementDuration = 0;\r\n    this.torpedoMovementDuration = 0;\r\n    this.velocityDuration = 0;\r\n    this.torpedoAttackDuration = 0;\r\n    this.phaseStrategy = phaseStrategy;\r\n  }\r\n\r\n  getTorpedoMovementStart() {\r\n    return this.movementDuration;\r\n  }\r\n\r\n  setTorpedoMovementDuration(duration) {\r\n    this.torpedoMovementDuration = duration;\r\n  }\r\n\r\n  setMovementDuration(duration) {\r\n    this.movementDuration = duration;\r\n  }\r\n\r\n  setVelocityDuration(duration) {\r\n    this.velocityDuration = duration;\r\n  }\r\n\r\n  getVelocityStart() {\r\n    return (\r\n      this.movementDuration +\r\n      this.torpedoMovementDuration +\r\n      this.firingDuration +\r\n      this.torpedoAttackDuration\r\n    );\r\n  }\r\n\r\n  getNextFireStart() {\r\n    return (\r\n      this.movementDuration + this.torpedoMovementDuration + this.firingDuration\r\n    );\r\n  }\r\n\r\n  addFireAnimationDuration(duration) {\r\n    this.firingDuration += duration;\r\n  }\r\n\r\n  getNextTorpedoAttackStart() {\r\n    return (\r\n      this.movementDuration +\r\n      this.torpedoMovementDuration +\r\n      this.firingDuration +\r\n      this.torpedoAttackDuration\r\n    );\r\n  }\r\n\r\n  addTorpedoAttackAnimationDuration(duration) {\r\n    this.torpedoAttackDuration += duration;\r\n  }\r\n\r\n  resumeReplayRewind() {\r\n    this.phaseStrategy.unpauseAndRewindAnimation();\r\n  }\r\n\r\n  pauseReplay() {\r\n    this.phaseStrategy.pauseAnimation();\r\n  }\r\n\r\n  resumeReplay() {\r\n    this.phaseStrategy.unpauseAnimation();\r\n  }\r\n\r\n  rewindToFiring() {\r\n    this.phaseStrategy.setAnimationTime(\r\n      this.movementDuration + this.torpedoMovementDuration - 1\r\n    );\r\n  }\r\n\r\n  rewindToMovement() {}\r\n\r\n  getTurnLength() {\r\n    return (\r\n      this.firingDuration +\r\n      this.movementDuration +\r\n      this.velocityDuration +\r\n      this.torpedoAttackDuration\r\n    );\r\n  }\r\n\r\n  wrapGetShootingPosition(animations) {\r\n    return icon => {\r\n      return this.getShootingPosition(icon, animations);\r\n    };\r\n  }\r\n\r\n  getShootingPosition(icon, animations) {\r\n    let animation = animations.find(\r\n      animation =>\r\n        animation instanceof ShipMovementAnimation &&\r\n        animation.shipIcon === icon\r\n    );\r\n\r\n    if (!animation) {\r\n      throw new Error(\"Animation not found\");\r\n    }\r\n\r\n    return animation.getEndPosition();\r\n  }\r\n}\r\n\r\nexport default ReplayContext;\r\n","import BoltEffect from \"../../../animation/effect/BoltEffect\";\nimport ExplosionEffect from \"../../../animation/effect/ExplosionEffect\";\n\nconst boltEffect = new BoltEffect();\n\nclass ShipWeaponAnimationService {\n  constructor(getRandom, particleEmitterContainer) {\n    this.getRandom = getRandom;\n    this.particleEmitterContainer = particleEmitterContainer;\n  }\n\n  getBoltEffect(\n    startTime,\n    startPosition,\n    endPosition,\n    speed,\n    fade,\n    duration,\n    args,\n    context\n  ) {\n    return boltEffect.create(\n      startTime,\n      startPosition,\n      endPosition,\n      speed,\n      fade,\n      duration,\n      args,\n      this.getRandom,\n      this.particleEmitterContainer,\n      context\n    );\n  }\n\n  getDamageExplosion(size, type = \"glow\", endPosition, startTime, context) {\n    return new ExplosionEffect(\n      this.particleEmitterContainer,\n      this.getRandom,\n      {\n        position: endPosition.clone(),\n        time: startTime,\n        duration: 250 + this.getRandom() * 250,\n        type,\n        size: size || 10\n      },\n      context\n    );\n  }\n}\n\nexport default ShipWeaponAnimationService;\n","class CombatLogShipMovement {\r\n  constructor(shipId) {\r\n    this.shipId = shipId;\r\n    this.replayOrder = 1;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      shipId: this.shipId\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.shipId = data.shipId;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogShipMovement;\r\n","class CombatLogShipVelocity {\r\n  constructor(shipId) {\r\n    this.shipId = shipId;\r\n    this.replayOrder = 10;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      shipId: this.shipId\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.shipId = data.shipId;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogShipVelocity;\r\n","import { Animation } from \".\";\nimport * as THREE from \"three\";\nimport { getPointBetween } from \"../../../../model/utils/math.mjs\";\n\nclass CameraPositionAnimation extends Animation {\n  constructor(position, time, endTime, gameCamera) {\n    super();\n    Animation.call(this);\n    this.time = time;\n    this.position = position;\n    this.lastTime = null;\n    this.endTime = 0;\n\n    this.gameCamera = gameCamera;\n\n    this.duration = 1000;\n\n    if (endTime === undefined) {\n      this.endTime = 300;\n    }\n\n    this.startPosition = null;\n\n    this.curve = new THREE.CubicBezierCurve(\n      new THREE.Vector2(0, 0),\n      new THREE.Vector2(0.5, 0.0),\n      new THREE.Vector2(0.5, 1),\n      new THREE.Vector2(1, 1)\n    );\n  }\n\n  render({ now, total, last, delta, zoom, back, paused }) {\n    this.smoothMove(now, total, last, delta, zoom, back);\n  }\n\n  smoothMove(now, total, last, delta, zoom, back, paused) {\n    if (back) {\n      return;\n    }\n\n    if (total > this.time && total < this.time + this.duration && !paused) {\n      if (this.startPosition === null) {\n        this.startPosition = this.gameCamera.getLookAtPosition();\n      }\n      var done = 1 - (this.time + this.duration - total) / this.duration;\n      var point = this.curve.getPoint(done).y;\n\n      var position = getPointBetween(\n        this.startPosition,\n        this.position,\n        point,\n        true\n      );\n\n      this.doMove(position);\n    } else {\n      this.startPosition = null;\n    }\n  }\n\n  instantMove(now, total, last, delta, zoom, back) {\n    if (back) {\n      return;\n    }\n\n    if (\n      this.lastTime !== null &&\n      this.lastTime < this.time &&\n      total > this.time\n    ) {\n      this.doMove(this.position);\n    }\n\n    this.lastTime = total;\n  }\n\n  doMove(position) {\n    this.gameCamera.setByLookAtPosition(position);\n  }\n}\n\nexport default CameraPositionAnimation;\n","class WeaponHitChange {\r\n  constructor(data) {\r\n    this.deserialize(data);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      baseToHit: this.baseToHit,\r\n      fireControl: this.fireControl,\r\n      dew: this.dew,\r\n      oew: this.oew,\r\n      distance: this.distance,\r\n      evasion: this.evasion,\r\n      rangeModifier: this.rangeModifier,\r\n      result: this.result,\r\n      absoluteResult: this.absoluteResult,\r\n      outOfRange: this.outOfRange,\r\n      rollingPenalty: this.rollingPenalty\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.baseToHit = data.baseToHit || 0;\r\n    this.fireControl = data.fireControl || 0;\r\n    this.dew = data.dew || 0;\r\n    this.oew = data.oew || 0;\r\n    this.distance = data.distance || 0;\r\n    this.rangeModifier = data.rangeModifier || 0;\r\n    this.result = data.result || 0;\r\n    this.absoluteResult = data.absoluteResult || 0;\r\n    this.outOfRange = data.outOfRange || false;\r\n    this.evasion = data.evasion || 0;\r\n    this.rollingPenalty = data.rollingPenalty || 0;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default WeaponHitChange;\r\n","import WeaponHitChange from \"../weapon/WeaponHitChange.mjs\";\r\n\r\nclass CombatLogWeaponFireHitResult {\r\n  constructor(result, hitChange, hitRoll) {\r\n    this.result = result;\r\n    this.hitChange = hitChange;\r\n    this.hitRoll = hitRoll;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      result: this.result,\r\n      hitChange: this.hitChange.serialize(),\r\n      hitRoll: this.hitRoll\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.result = data.result || false;\r\n    this.hitChange = new WeaponHitChange().deserialize(data.hitChange);\r\n    this.hitRoll = data.hitRoll || 1;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogWeaponFireHitResult;\r\n","import CombatLogDamageEntry from \"./CombatLogDamageEntry.mjs\";\r\nimport CombatLogWeaponFireHitResult from \"./CombatLogWeaponFireHitResult.mjs\";\r\n\r\nclass CombatLogWeaponFire {\r\n  constructor(fireOrderId, targetId, shooterId, ammo) {\r\n    this.fireOrderId = fireOrderId;\r\n    this.targetId = targetId;\r\n    this.shooterId = shooterId;\r\n    this.damages = [];\r\n    this.notes = [];\r\n    this.hitResult = null;\r\n    this.ammoName = ammo ? ammo.getShortDisplayName() : null;\r\n  }\r\n\r\n  addNote(note) {\r\n    this.notes.push(note);\r\n  }\r\n\r\n  addDamage(damageEntry) {\r\n    this.damages.push(damageEntry);\r\n  }\r\n\r\n  addHitResult(hitResult) {\r\n    this.hitResult = hitResult;\r\n  }\r\n\r\n  setShots(shotsHit, totalShots) {\r\n    this.shotsHit = shotsHit;\r\n    this.totalShots = totalShots;\r\n  }\r\n\r\n  causedDamage() {\r\n    return this.damages.length > 0;\r\n  }\r\n\r\n  getDamages(target) {\r\n    return this.damages.reduce((all, current) => {\r\n      return [\r\n        ...all,\r\n        ...current.entries.reduce((all, damageEntry) => {\r\n          const system = target.systems.getSystemById(damageEntry.systemId);\r\n\r\n          return [\r\n            ...all,\r\n            ...damageEntry.damageIds.map(id => system.damage.getDamageById(id))\r\n          ];\r\n        }, [])\r\n      ];\r\n    }, []);\r\n  }\r\n\r\n  getDestroyedSystems(target) {\r\n    return this.getDamages(target)\r\n      .filter(damage => damage.destroyedSystem)\r\n      .map(damage => damage.system);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      fireOrderId: this.fireOrderId,\r\n      targetId: this.targetId,\r\n      shooterId: this.shooterId,\r\n      damages: this.damages.map(damage => damage.serialize()),\r\n      notes: this.notes,\r\n      hitResult: this.hitResult ? this.hitResult.serialize() : null,\r\n      shotsHit: this.shotsHit,\r\n      totalShots: this.totalShots,\r\n      ammoName: this.ammoName\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.fireOrderId = data.fireOrderId;\r\n    this.targetId = data.targetId;\r\n    this.shooterId = data.shooterId;\r\n    this.damages = data.damages.map(damage =>\r\n      new CombatLogDamageEntry().deserialize(damage)\r\n    );\r\n\r\n    this.notes = data.notes || [];\r\n\r\n    this.hitResult = data.hitResult\r\n      ? new CombatLogWeaponFireHitResult().deserialize(data.hitResult)\r\n      : null;\r\n\r\n    this.shotsHit = data.shotsHit || 0;\r\n    this.totalShots = data.totalShots || 0;\r\n\r\n    this.ammoName = data.ammoName || null;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogWeaponFire;\r\n","import CombatLogWeaponFire from \"./CombatLogWeaponFire.mjs\";\r\n\r\nclass CombatLogGroupedWeaponFire {\r\n  constructor(targetId) {\r\n    this.targetId = targetId;\r\n    this.entries = [];\r\n    this.replayOrder = 5;\r\n  }\r\n\r\n  addEntry(fire) {\r\n    this.entries.push(fire);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      entries: this.entries.map(entry => entry.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.targetId = data.targetId;\r\n    this.entries = data.entries\r\n      ? data.entries.map(entry => new CombatLogWeaponFire().deserialize(entry))\r\n      : [];\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogGroupedWeaponFire;\r\n","import TextSprite from \"../renderer/sprite/TextSprite\";\nimport Animation from \"./Animation\";\nimport coordinateConverter from \"../../../../model/utils/CoordinateConverter.mjs\";\n\nconst TEXTURE_SIZE = 256;\n\nconst getKey = (position, time) => time + \"-\" + position.x + \"-\" + position.y;\n\nconst getSprite = (name, position, scene) => {\n  let sprite = null;\n\n  if (name.structure) {\n    sprite = new TextSprite(\n      name.toUpperCase(),\n      \"rgba(255, 100, 45, 0.7)\",\n      position.z + 30,\n      {\n        fontSize: \"24px\",\n        size: 512\n      }\n    );\n  } else {\n    sprite = new TextSprite(\n      name.toUpperCase(),\n      \"rgba(255, 255, 255, 0.7)\",\n      position.z + 30,\n      {\n        fontSize: \"18px\",\n        size: 512\n      }\n    );\n  }\n\n  sprite.setPosition(position);\n  sprite.setOpacity(0);\n  scene.add(sprite.mesh);\n\n  return sprite;\n};\n\nconst changeTimeIfNeccessary = (position, time, texts) => {\n  const inSameHex = getInSameHex(position, texts);\n\n  if (inSameHex.length === 0) {\n    return time;\n  }\n\n  while (isTooClose(time, inSameHex)) {\n    time += 200;\n  }\n\n  return time;\n};\n\nconst getInSameHex = (position, texts) => {\n  const gamePosition = coordinateConverter.fromGameToHex(position);\n\n  return texts.filter(text =>\n    coordinateConverter.fromGameToHex(text.position).equals(gamePosition)\n  );\n};\n\nconst isTooClose = (time, texts) => {\n  return texts.some(text => text.time - time < 200 && text.time - time > -200);\n};\n\nclass SystemDestroyedTextAnimation extends Animation {\n  constructor(scene) {\n    super();\n\n    this.scene = scene;\n\n    this.duration = 1000;\n    this.fadeOutSpeed = 2000;\n    this.velocity = 0.1;\n    this.destroyedTexts = [];\n  }\n\n  deactivate() {\n    this.destroyedTexts.forEach(destroyedText => {\n      this.scene.remove(destroyedText.sprite.mesh);\n      destroyedText.sprite.destroy();\n    }, this);\n\n    this.destroyedTexts = [];\n  }\n\n  add(position, names, time) {\n    names = [].concat(names);\n    names.filter(Boolean).forEach(name => {\n      this.destroyedTexts.push({\n        time: changeTimeIfNeccessary(position, time, this.destroyedTexts),\n        position,\n        sprite: getSprite(name, position, this.scene)\n      });\n    }, this);\n  }\n\n  render({ now, total, last, delta, zoom }) {\n    this.destroyedTexts.forEach(text => {\n      const time = text.time;\n      const sprite = text.sprite;\n\n      if (total < time || total > time + this.duration + this.fadeOutSpeed) {\n        sprite.setOpacity(0);\n        return;\n      }\n\n      sprite.setScale(zoom, zoom);\n      const ellapsedTime = total - time;\n      const newPos = {\n        ...text.position,\n        y: text.position.y + this.velocity * zoom * ellapsedTime\n      };\n      sprite.setPosition(newPos);\n\n      const fadeTime = total - (time + this.duration);\n\n      if (fadeTime < 0) {\n        sprite.setOpacity(1);\n      } else {\n        const opacity = 1 - fadeTime / this.fadeOutSpeed;\n        sprite.setOpacity(opacity);\n      }\n    }, this);\n  }\n\n  getDuration() {\n    return 0;\n  }\n}\n\nexport default SystemDestroyedTextAnimation;\n","import * as THREE from \"three\";\r\nimport Animation from \"./Animation\";\r\nimport { hexFacingToAngle } from \"../../../../model/utils/math.mjs\";\r\nimport { getCompassHeadingOfPoint } from \"../../../../model/utils/math.mjs\";\r\nimport Vector from \"../../../../model/utils/Vector.mjs\";\r\nimport { getSeededRandomGenerator } from \"../../../../model/utils/math.mjs\";\r\n\r\nclass TorpedoMovementAnimation extends Animation {\r\n  constructor(\r\n    icon,\r\n    startPosition,\r\n    endPosition,\r\n    start,\r\n    end,\r\n    launch = false,\r\n    interceptTime = null,\r\n    impact = false\r\n  ) {\r\n    super();\r\n\r\n    this.icon = icon;\r\n\r\n    this.start = start;\r\n    this.end = end;\r\n    this.duration = end - start;\r\n\r\n    this.startPosition = startPosition;\r\n    this.endPosition = endPosition;\r\n    this.interceptTime = interceptTime;\r\n\r\n    this.launch = launch;\r\n    this.impact = impact;\r\n\r\n    this.positionCurve = this.buildPositionCurve(startPosition, endPosition);\r\n\r\n    const getRandom = getSeededRandomGenerator(icon.torpedoFlight.id);\r\n    this.variance = new Vector(getRandom() * 30 - 15, getRandom() * 30 - 15);\r\n\r\n    Animation.call(this);\r\n  }\r\n\r\n  deactivate() {\r\n    this.icon.hide();\r\n  }\r\n\r\n  update(gameData) {}\r\n\r\n  cleanUp() {}\r\n\r\n  getPositionAt(time) {\r\n    const turnDone = this.getMovementTurnDone({ total: time });\r\n\r\n    if (turnDone === -1) {\r\n      throw new Error(\"Don't ask ShipVelocityAnimation\");\r\n    }\r\n\r\n    const percentDone = turnDone < 1 ? turnDone % 1 : 1;\r\n\r\n    return {\r\n      facing: this.endMove.facing,\r\n      position: this.positionCurve.getPoint(percentDone)\r\n    };\r\n  }\r\n\r\n  getInterceptPosition() {\r\n    const turnDone = this.getMovementTurnDone({ total: this.interceptTime });\r\n\r\n    const percentDone = turnDone < 1 ? turnDone % 1 : 1;\r\n    const position = this.positionCurve.getPoint(percentDone);\r\n\r\n    return new Vector(position);\r\n  }\r\n\r\n  getMovementTurnDone({ total }) {\r\n    if (total < this.start) {\r\n      return 0;\r\n    }\r\n\r\n    if (total > this.end) {\r\n      return 1;\r\n    }\r\n    const time = total - this.start;\r\n    return time / this.duration;\r\n  }\r\n\r\n  render({ total }) {\r\n    const turnDone = this.getMovementTurnDone({ total });\r\n\r\n    if (this.interceptTime !== null && total > this.interceptTime) {\r\n      this.icon.hide();\r\n      return;\r\n    }\r\n\r\n    if (turnDone === 0 && this.launch) {\r\n      this.icon.hide();\r\n      return;\r\n    }\r\n\r\n    const percentDone = turnDone < 1 ? turnDone % 1 : 1;\r\n\r\n    if (turnDone === 1 && this.impact) {\r\n      this.icon.hide();\r\n      return;\r\n    }\r\n\r\n    this.icon.show();\r\n    const position = this.positionCurve.getPoint(percentDone);\r\n\r\n    this.icon.setPosition({\r\n      x: position.x + this.variance.x,\r\n      y: position.y + this.variance.y,\r\n      z: position.z\r\n    });\r\n    this.icon.setFacing(\r\n      -getCompassHeadingOfPoint(this.startPosition, this.endPosition)\r\n    );\r\n  }\r\n\r\n  buildPositionCurve(start, end) {\r\n    /*\r\n    const point1 = start.roundToHexCenter();\r\n    const control1 = start.roundToHexCenter();\r\n    const control2 = end.roundToHexCenter();\r\n    const point2 = end.roundToHexCenter();\r\n    */\r\n\r\n    const point1 = start;\r\n    const control1 = start;\r\n    const control2 = end;\r\n    const point2 = end;\r\n\r\n    if (!this.impact) {\r\n      return new THREE.CubicBezierCurve3(\r\n        new THREE.Vector3(point1.x, point1.y, point1.z),\r\n        new THREE.Vector3(control1.x, control1.y, control1.z),\r\n        new THREE.Vector3(control2.x, control2.y, control2.z),\r\n        new THREE.Vector3(point2.x, point2.y, point2.z)\r\n      );\r\n    }\r\n\r\n    return new THREE.LineCurve3(\r\n      new THREE.Vector3(point1.x, point1.y, point1.z),\r\n      new THREE.Vector3(point2.x, point2.y, point2.z)\r\n    );\r\n  }\r\n}\r\n\r\nexport default TorpedoMovementAnimation;\r\n","import Vector from \"../utils/Vector.mjs\";\r\n\r\nclass CombatLogTorpedoMove {\r\n  constructor(torpedoFlightId, startPosition, endPosition, velocity) {\r\n    this.torpedoFlightId = torpedoFlightId;\r\n    this.startPosition = startPosition;\r\n    this.endPosition = endPosition;\r\n    this.velocity = velocity;\r\n\r\n    this.replayOrder = 4;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      torpedoFlightId: this.torpedoFlightId,\r\n      startPosition: this.startPosition,\r\n      endPosition: this.endPosition,\r\n      velocity: this.velocity\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.torpedoFlightId = data.torpedoFlightId;\r\n    this.startPosition = new Vector(data.startPosition);\r\n    this.endPosition = new Vector(data.endPosition);\r\n    this.velocity = new Vector(data.velocity);\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogTorpedoMove;\r\n","import CombatLogDamageEntry from \"./CombatLogDamageEntry.mjs\";\r\n\r\nclass CombatLogTorpedoAttack {\r\n  constructor(torpedoFlightId, targetId) {\r\n    this.torpedoFlightId = torpedoFlightId;\r\n    this.targetId = targetId;\r\n    this.damages = [];\r\n    this.notes = [];\r\n  }\r\n\r\n  addNote(note) {\r\n    this.notes.push(note);\r\n  }\r\n\r\n  addDamage(damageEntry) {\r\n    this.damages.push(damageEntry);\r\n  }\r\n\r\n  getDamages(target) {\r\n    return this.damages.reduce((all, current) => {\r\n      return [\r\n        ...all,\r\n        ...current.entries.reduce((all, damageEntry) => {\r\n          const system = target.systems.getSystemById(damageEntry.systemId);\r\n\r\n          return [\r\n            ...all,\r\n            ...damageEntry.damageIds.map(id => system.damage.getDamageById(id))\r\n          ];\r\n        }, [])\r\n      ];\r\n    }, []);\r\n  }\r\n\r\n  getDestroyedSystems(target) {\r\n    return this.getDamages(target)\r\n      .filter(damage => damage.destroyedSystem)\r\n      .map(damage => damage.system);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      torpedoFlightId: this.torpedoFlightId,\r\n      damages: this.damages.map(damage => damage.serialize()),\r\n      notes: this.notes,\r\n      targetId: this.targetId\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.torpedoFlightId = data.torpedoFlightId;\r\n    this.targetId = data.targetId;\r\n    this.damages = data.damages.map(damage =>\r\n      new CombatLogDamageEntry().deserialize(damage)\r\n    );\r\n\r\n    this.notes = data.notes || [];\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogTorpedoAttack;\r\n","import CombatLogTorpedoAttack from \"./CombatLogTorpedoAttack.mjs\";\r\n\r\nclass CombatLogGroupedTorpedoAttack {\r\n  constructor(targetId) {\r\n    this.targetId = targetId;\r\n    this.entries = [];\r\n    this.replayOrder = 6;\r\n  }\r\n\r\n  addEntry(attack) {\r\n    this.entries.push(attack);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      entries: this.entries.map(entry => entry.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.targetId = data.targetId;\r\n    this.entries = data.entries\r\n      ? data.entries.map(entry =>\r\n          new CombatLogTorpedoAttack().deserialize(entry)\r\n        )\r\n      : [];\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogGroupedTorpedoAttack;\r\n","import * as THREE from \"three\";\r\nimport ExplosionEffect from \"../effect/ExplosionEffect\";\r\nimport Animation from \"../Animation\";\r\n\r\nclass TorpedoExplosionHE extends Animation {\r\n  constructor(position, time, particleEmitterContainer, getRandom, torpedo) {\r\n    super();\r\n    this.particleEmitterContainer = particleEmitterContainer;\r\n    this.animations = [];\r\n\r\n    const explosionSize = torpedo.visuals.explosionSize;\r\n\r\n    this.animations.push(\r\n      new ExplosionEffect(\r\n        particleEmitterContainer,\r\n        getRandom,\r\n        {\r\n          position,\r\n          time: time,\r\n          duration: 250 + getRandom() * 250,\r\n          type: \"gas\",\r\n          size: getRandom() * (explosionSize * 0.3) + explosionSize,\r\n          color: new THREE.Color(51 / 255, 163 / 255, 255 / 255)\r\n        },\r\n        this\r\n      )\r\n    );\r\n\r\n    this.animations.push(\r\n      new ExplosionEffect(\r\n        particleEmitterContainer,\r\n        getRandom,\r\n        {\r\n          position,\r\n          time: time,\r\n          duration: 250 + getRandom() * 250,\r\n          type: \"glow\",\r\n          size: getRandom() * (explosionSize * 0.2) + explosionSize * 0.4\r\n        },\r\n        this\r\n      )\r\n    );\r\n  }\r\n\r\n  deactivate() {\r\n    this.particleEmitterContainer.release(this);\r\n\r\n    return super.deactivate();\r\n  }\r\n}\r\n\r\nexport default TorpedoExplosionHE;\r\n","import * as THREE from \"three\";\r\nimport ExplosionEffect from \"../effect/ExplosionEffect\";\r\nimport Animation from \"../Animation\";\r\nimport Vector from \"../../../../../model/utils/Vector.mjs\";\r\n\r\nclass TorpedoExplosionMSV extends Animation {\r\n  constructor(\r\n    position,\r\n    time,\r\n    particleEmitterContainer,\r\n    getRandom,\r\n    torpedo,\r\n    amount\r\n  ) {\r\n    super();\r\n    this.particleEmitterContainer = particleEmitterContainer;\r\n    this.animations = [];\r\n\r\n    //const amount = torpedo.damageStrategy.numberOfShots;\r\n    //console.log(amount);\r\n\r\n    const color = new THREE.Color(\r\n      torpedo.visuals.engineColor[0] * 1.5,\r\n      torpedo.visuals.engineColor[1] * 1.5,\r\n      torpedo.visuals.engineColor[2] * 1.5\r\n    );\r\n\r\n    for (let i = 0; i < amount; i++) {\r\n      const angle = getRandom() * 360;\r\n      const explosionPosition = new Vector()\r\n        .setFromAngle(angle)\r\n        .multiplyScalar(getRandom() * 10)\r\n        .add(position);\r\n\r\n      this.animations.push(\r\n        new ExplosionEffect(\r\n          particleEmitterContainer,\r\n          getRandom,\r\n          {\r\n            position: explosionPosition,\r\n            time: time + getRandom() * 500,\r\n            duration: 100 + getRandom() * 250,\r\n            type: \"glow\",\r\n            size: 2,\r\n            color: color,\r\n            opacity: 0.25\r\n          },\r\n          this\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  deactivate() {\r\n    this.particleEmitterContainer.release(this);\r\n\r\n    return super.deactivate();\r\n  }\r\n}\r\n\r\nexport default TorpedoExplosionMSV;\r\n","import {\n  ShipWeaponAnimations,\n  ShipMovementAnimation,\n  ShipSystemAnimation\n} from \"../../../animation\";\n\nimport * as THREE from \"three\";\n\nimport AnimationUiStrategy from \"../AnimationUiStrategy\";\nimport WeaponFireService from \"../../../../../../model/weapon/WeaponFireService.mjs\";\nimport { getSeededRandomGenerator } from \"../../../../../../model/utils/math.mjs\";\nimport ShipWeaponAnimationService from \"./ShipWeaponAnimationService\";\nimport CombatLogShipMovement from \"../../../../../../model/combatLog/CombatLogShipMovement.mjs\";\nimport ShipVelocityAnimation from \"../../../animation/ShipVelocityAnimation\";\nimport CombatLogShipVelocity from \"../../../../../../model/combatLog/CombatLogShipVelocity.mjs\";\nimport CameraPositionAnimation from \"../../../animation/CameraPositionAnimation\";\nimport CombatLogWeaponFire from \"../../../../../../model/combatLog/CombatLogWeaponFire.mjs\";\nimport CombatLogGroupedWeaponFire from \"../../../../../../model/combatLog/CombatLogGroupedWeaponFire.mjs\";\nimport SystemDestroyedTextAnimation from \"../../../animation/SystemDestroyedTextAnimation\";\nimport Vector from \"../../../../../../model/utils/Vector.mjs\";\nimport TorpedoMovementAnimation from \"../../../animation/TorpedoMovementAnimation\";\nimport CombatLogTorpedoMove from \"../../../../../../model/combatLog/CombatLogTorpedoMove.mjs\";\nimport CombatLogGroupedTorpedoAttack from \"../../../../../../model/combatLog/CombatLogGroupedTorpedoAttack.mjs\";\nimport { TORPEDO_Z } from \"../../../../../../model/gameConfig.mjs\";\nimport ExplosionEffect from \"../../../animation/effect/ExplosionEffect\";\nimport TorpedoExplosionHE from \"../../../animation/TorpedoExplosion/TorpedoExplosionHE\";\nimport TorpedoExplosionMSV from \"../../../animation/TorpedoExplosion/TorpedoExplosionMSV\";\n\nconst getMovesForShip = (gameDatas, ship) =>\n  gameDatas.reduce((moves, gameData) => {\n    return [\n      ...moves,\n      ...gameData.ships.getShipById(ship.id).movement.getMovement()\n    ];\n  }, []);\n\nconst getEndMoveForShip = (gameDatas, ship) =>\n  getMovesForShip(gameDatas, ship).pop();\n\nclass ReplayTurnActions extends AnimationUiStrategy {\n  constructor(replayContext) {\n    super();\n    this.replayContext = replayContext;\n\n    this.systemDestroyedTextAnimation = null;\n    this.ready = false;\n  }\n\n  async newTurn(gameDatas) {\n    const {\n      shipIconContainer,\n      particleEmitterContainer,\n      uiState,\n      scene\n    } = this.services;\n\n    await shipIconContainer.shipsLoaded();\n    await particleEmitterContainer.ready();\n\n    const gameData = gameDatas[0];\n\n    this.getRandom = getSeededRandomGenerator(\n      \"id\" + gameData.id + \"turn\" + gameData.turn\n    );\n\n    uiState.startCombatLog(this.replayContext, gameData);\n\n    this.systemDestroyedTextAnimation = new SystemDestroyedTextAnimation(scene);\n    this.animations.push(this.systemDestroyedTextAnimation);\n\n    gameData.combatLog.getForReplay().forEach(combatLogEntry => {\n      if (combatLogEntry instanceof CombatLogShipMovement) {\n        this.buildMovementAnimation(combatLogEntry, gameDatas);\n      } else if (combatLogEntry instanceof CombatLogShipVelocity) {\n        this.buildVelocityAnimation(combatLogEntry, gameDatas);\n      } else if (combatLogEntry instanceof CombatLogGroupedWeaponFire) {\n        this.buildWeaponFireAnimation(combatLogEntry, gameDatas);\n      } else if (combatLogEntry instanceof CombatLogTorpedoMove) {\n        this.buildTorpedoMoveAnimation(combatLogEntry, gameDatas);\n      } else if (combatLogEntry instanceof CombatLogGroupedTorpedoAttack) {\n        this.buildTorpedoAttackAnimation(combatLogEntry, gameDatas);\n      }\n    });\n  }\n\n  buildInterceptAnimation(\n    gameData,\n    targetIcon,\n    intercepts,\n    interceptTime,\n    interceptPosition\n  ) {\n    const { particleEmitterContainer, shipIconContainer } = this.services;\n\n    const weaponAnimationService = new ShipWeaponAnimationService(\n      this.getRandom,\n      particleEmitterContainer\n    );\n\n    intercepts.forEach(intercept => {\n      const ship = gameData.ships.getShipById(intercept.shipId);\n      const weapon = ship.systems.getSystemById(intercept.weaponId);\n\n      if (!intercept.isSucessfull()) {\n        return;\n      }\n\n      const animationName = weapon.callHandler(\"getWeaponFireAnimationName\");\n\n      if (!animationName) {\n        return;\n      }\n\n      const animation = new ShipWeaponAnimations[\n        `ShipWeapon${animationName.charAt(0).toUpperCase() +\n          animationName.slice(1)}Animation`\n      ]({\n        getRandom: this.getRandom,\n        particleEmitterContainer: particleEmitterContainer,\n        weapon,\n        getPosition: this.replayContext.wrapGetShootingPosition(\n          this.animations\n        ),\n        args: weapon.callHandler(\"getWeaponFireAnimationArguments\"),\n        weaponAnimationService,\n        targetIcon,\n        shooterIcon: shipIconContainer.getByShip(ship),\n        animationStartTime: this.replayContext.getVelocityStart(),\n        impactPosition: interceptPosition,\n        impactTime: interceptTime,\n        totalShots: weapon.callHandler(\"getTotalBurstSize\", null, 1),\n        shotsHit: intercept.isSucessfull() ? 1 : 0,\n        omitHitExplosion: true\n      });\n\n      this.animations.push(animation);\n    });\n  }\n\n  buildTorpedoAttackAnimation(combatLogEntry, gameDatas) {\n    const {\n      shipIconContainer,\n      gameCamera,\n      particleEmitterContainer,\n      torpedoIconContainer,\n      uiState\n    } = this.services;\n    const gameData = gameDatas[0];\n\n    const attackDuration = 3000;\n\n    const start = this.replayContext.getNextTorpedoAttackStart();\n    const cameraDuration = 2000;\n    const fireStart = start + cameraDuration;\n\n    let longestDuration = attackDuration;\n\n    const target = gameData.ships.getShipById(combatLogEntry.targetId);\n    const targetIcon = shipIconContainer.getByShip(target);\n\n    const { position } = this.replayContext.getShootingPosition(\n      targetIcon,\n      this.animations\n    );\n\n    this.animations.push(\n      new CameraPositionAnimation(position, start, fireStart, gameCamera)\n    );\n\n    combatLogEntry.entries.forEach(torpedoEntry => {\n      const flight = gameData.torpedos.getTorpedoFlightById(\n        torpedoEntry.torpedoFlightId\n      );\n\n      uiState.addToCombatLog(torpedoEntry);\n\n      const intercepts = gameData.combatLog.getInterceptsFor(torpedoEntry);\n\n      const intercepted = intercepts.some(intercept =>\n        intercept.isSucessfull()\n      );\n\n      const interceptTime = intercepted\n        ? fireStart + (attackDuration - 1000) + this.getRandom() * 1000\n        : null;\n\n      const targetPosition = new Vector(position)\n        .setZ(targetIcon.shipZ)\n        .add(\n          new Vector(this.getRandom() * 30 - 15, this.getRandom() * 30 - 15, 0)\n        );\n\n      const attackDistance = 1000;\n      const launchPosition = flight.launchPosition;\n      const torpedoPosition = launchPosition\n        .sub(targetPosition)\n        .normalize()\n        .multiplyScalar(attackDistance)\n        .add(targetPosition)\n        .setZ(TORPEDO_Z);\n\n      const endTime = fireStart + attackDuration + this.getRandom() * 500;\n      const animation = new TorpedoMovementAnimation(\n        torpedoIconContainer.getIconByTorpedoFlight(flight),\n        torpedoPosition,\n        targetPosition,\n        fireStart,\n        endTime,\n        flight.turnsActive === 1,\n        interceptTime,\n        true\n      );\n\n      const systemsDestroyed = torpedoEntry.getDestroyedSystems(target);\n\n      if (systemsDestroyed.length > 0) {\n        this.systemDestroyedTextAnimation.add(\n          new Vector(targetPosition.x, targetPosition.y, targetPosition.z),\n          systemsDestroyed.map(system => system.getDisplayName()),\n          endTime\n        );\n      }\n\n      const velocity = targetPosition\n        .sub(launchPosition)\n        .normalize()\n        .multiplyScalar(attackDistance / attackDuration)\n        .multiplyScalar(0.5);\n\n      const interceptPosition = animation.getInterceptPosition();\n\n      this.animations.push(animation);\n\n      this.buildInterceptAnimation(\n        gameData,\n        targetIcon,\n        intercepts,\n        interceptTime,\n        interceptPosition\n      );\n\n      if (intercepted) {\n        this.animations.push(\n          new ExplosionEffect(\n            particleEmitterContainer,\n            this.getRandom,\n            {\n              position: interceptPosition,\n              time: interceptTime,\n              duration: 250 + this.getRandom() * 250,\n              type: \"glow\",\n              size: this.getRandom() * 5 + 5,\n              color: new THREE.Color(1.0, 0.9, 0.8),\n              velocity\n            },\n            this\n          )\n        );\n      } else {\n        switch (flight.torpedo.visuals.explosionType) {\n          case \"HE\":\n            this.animations.push(\n              new TorpedoExplosionHE(\n                targetPosition,\n                endTime,\n                particleEmitterContainer,\n                this.getRandom,\n                flight.torpedo\n              )\n            );\n            break;\n          case \"MSV\":\n            this.animations.push(\n              new TorpedoExplosionMSV(\n                targetPosition,\n                endTime,\n                particleEmitterContainer,\n                this.getRandom,\n                flight.torpedo,\n                torpedoEntry.damages.length\n              )\n            );\n            break;\n          default:\n            this.animations.push(\n              new TorpedoExplosionHE(\n                targetPosition,\n                endTime,\n                particleEmitterContainer,\n                this.getRandom\n              )\n            );\n        }\n      }\n    });\n\n    this.replayContext.addTorpedoAttackAnimationDuration(\n      cameraDuration + longestDuration + 1000\n    );\n  }\n\n  buildTorpedoMoveAnimation(combatLogEntry, gameDatas) {\n    const { torpedoIconContainer } = this.services;\n\n    const duration = 3000;\n    const start = this.replayContext.getTorpedoMovementStart();\n    this.replayContext.setTorpedoMovementDuration(duration);\n\n    const flight = gameDatas[0].torpedos.getTorpedoFlightById(\n      combatLogEntry.torpedoFlightId\n    );\n\n    const startTime = start + this.getRandom() * 2000;\n    const endTime = start + duration + this.getRandom() * 1000;\n    const animation = new TorpedoMovementAnimation(\n      torpedoIconContainer.getIconByTorpedoFlight(flight),\n      combatLogEntry.startPosition.setZ(TORPEDO_Z),\n      combatLogEntry.endPosition.setZ(TORPEDO_Z),\n      startTime,\n      endTime,\n      flight.turnsActive === 1\n    );\n\n    this.animations.push(animation);\n  }\n\n  buildWeaponFireAnimation(combatLogEntry, gameDatas) {\n    const {\n      shipIconContainer,\n      gameCamera,\n      particleEmitterContainer,\n      uiState\n    } = this.services;\n    const gameData = gameDatas[0];\n\n    const weaponFireService = new WeaponFireService().update(gameData);\n    const weaponAnimationService = new ShipWeaponAnimationService(\n      this.getRandom,\n      particleEmitterContainer\n    );\n\n    const start = this.replayContext.getNextFireStart();\n    const cameraDuration = 2000;\n    const fireStart = start + cameraDuration;\n\n    let longestDuration = 0;\n\n    const target = gameData.ships.getShipById(combatLogEntry.targetId);\n    const targetIcon = shipIconContainer.getByShip(target);\n\n    const { facing, position } = this.replayContext.getShootingPosition(\n      targetIcon,\n      this.animations\n    );\n\n    this.animations.push(\n      new CameraPositionAnimation(position, start, fireStart, gameCamera)\n    );\n\n    combatLogEntry.entries.forEach(fireEntry => {\n      const fireOrder = weaponFireService.getFireOrderById(\n        fireEntry.fireOrderId\n      );\n\n      uiState.addToCombatLog(fireEntry);\n\n      const shooter = gameData.ships.getShipById(fireOrder.shooterId);\n      const weapon = shooter.systems.getSystemById(fireOrder.weaponId);\n\n      const animationName = weapon.callHandler(\"getWeaponFireAnimationName\");\n\n      if (!animationName) {\n        return;\n      }\n\n      const animation = new ShipWeaponAnimations[\n        `ShipWeapon${animationName.charAt(0).toUpperCase() +\n          animationName.slice(1)}Animation`\n      ]({\n        getRandom: this.getRandom,\n        particleEmitterContainer: particleEmitterContainer,\n        weapon,\n        getPosition: this.replayContext.wrapGetShootingPosition(\n          this.animations\n        ),\n        args: weapon.callHandler(\"getWeaponFireAnimationArguments\"),\n        weaponAnimationService,\n        targetIcon,\n        shooterIcon: shipIconContainer.getByShip(shooter),\n        animationStartTime: fireStart,\n        totalShots: fireEntry.totalShots,\n        shotsHit: fireEntry.shotsHit\n      });\n\n      this.animations.push(animation);\n      const duration = animation.getDuration();\n\n      if (duration > longestDuration) {\n        longestDuration = duration;\n      }\n\n      const systemsDestroyed = fireEntry.getDestroyedSystems(target);\n\n      if (systemsDestroyed.length > 0) {\n        this.systemDestroyedTextAnimation.add(\n          new Vector(position.x, position.y, position.z + targetIcon.shipZ),\n          systemsDestroyed.map(system => system.getDisplayName()),\n          fireStart + duration - 1000\n        );\n      }\n    });\n\n    this.replayContext.addFireAnimationDuration(\n      cameraDuration + longestDuration\n    );\n  }\n\n  buildVelocityAnimation(combatLogEntry, gameDatas) {\n    const { shipIconContainer } = this.services;\n\n    const duration = 5000;\n    const start = this.replayContext.getVelocityStart();\n    this.replayContext.setVelocityDuration(duration);\n\n    const icon = shipIconContainer.getById(combatLogEntry.shipId);\n    const ship = icon.ship;\n\n    icon.show();\n    this.animations.push(\n      new ShipVelocityAnimation(\n        icon,\n        getEndMoveForShip(gameDatas, ship),\n        start,\n        start + duration\n      )\n    );\n  }\n\n  buildMovementAnimation(combatLogEntry, gameDatas) {\n    const { shipIconContainer } = this.services;\n\n    const duration = 5000;\n    const start = 0;\n\n    const icon = shipIconContainer.getById(combatLogEntry.shipId);\n    const ship = icon.ship;\n\n    icon.show();\n\n    const animation = new ShipMovementAnimation(\n      icon,\n      getMovesForShip(gameDatas, ship),\n      start,\n      duration\n    );\n\n    if (animation.doesMove()) {\n      console.log(\"animation moves\");\n      this.replayContext.setMovementDuration(duration);\n    }\n\n    this.animations.push(animation);\n\n    this.animations.push(\n      new ShipSystemAnimation(\n        icon,\n        gameDatas[0].ships.getShipById(icon.ship.id)\n      )\n    );\n  }\n\n  deactivate() {\n    const {\n      shipIconContainer,\n      uiState,\n      particleEmitterContainer\n    } = this.services;\n    shipIconContainer.getArray().forEach(function(icon) {\n      icon.hide();\n    }, this);\n\n    uiState.hideCombatLog();\n\n    particleEmitterContainer.release(this);\n    this.animations.forEach(animation => animation.deactivate());\n\n    return super.deactivate();\n  }\n}\n\nexport default ReplayTurnActions;\n","import PhaseStrategy from \"../PhaseStrategy\";\r\nimport {\r\n  AutomaticReplay,\r\n  ShowReplayUi,\r\n  MouseOverShowsShipTooltip,\r\n  ShowMapIcons,\r\n  UnderHexForShips\r\n} from \"../../../ui/uiStrategy\";\r\nimport ReplayContext from \"./ReplayContext\";\r\nimport ReplayTurnActions from \"../../../ui/uiStrategy/replay/ReplayTurnActions\";\r\n\r\nclass AutomaticReplayPhaseStrategy extends PhaseStrategy {\r\n  constructor(services) {\r\n    super(services);\r\n\r\n    this.emitterContainer = services.particleEmitterContainer;\r\n\r\n    this.replayContext = new ReplayContext(this);\r\n    this.replayTurnActions = new ReplayTurnActions(this.replayContext);\r\n\r\n    this.strategies = [\r\n      this.replayTurnActions,\r\n      new AutomaticReplay(this, this.replayContext),\r\n      new ShowReplayUi(this.replayContext),\r\n      new MouseOverShowsShipTooltip(),\r\n      new UnderHexForShips(),\r\n      new ShowMapIcons()\r\n    ];\r\n  }\r\n\r\n  render(coordinateConverter, scene, zoom) {\r\n    const payload = super.render(coordinateConverter, scene, zoom);\r\n    this.emitterContainer.render(payload);\r\n  }\r\n\r\n  canDisturb() {\r\n    return false;\r\n  }\r\n\r\n  update(gamedata) {\r\n    this.updateStrategies(gamedata);\r\n    return this;\r\n  }\r\n\r\n  deactivate() {\r\n    super.deactivate();\r\n  }\r\n}\r\n\r\nexport default AutomaticReplayPhaseStrategy;\r\n","import AutomaticReplayPhaseStrategy from \"./AutomaticReplayPhaseStrategy\";\r\n\r\nexport default AutomaticReplayPhaseStrategy;\r\n","class GameDataCache {\r\n  constructor() {\r\n    this.replays = [];\r\n    this.currentGameData = null;\r\n  }\r\n\r\n  getGameDatasForAutomaticReplay() {\r\n    if (!this.currentGameData) {\r\n      return null;\r\n    }\r\n\r\n    const lastGameData = this.replays.find(\r\n      replay => replay.turn === this.currentGameData.turn - 1\r\n    );\r\n\r\n    if (!lastGameData) {\r\n      return null;\r\n    }\r\n\r\n    return [lastGameData, this.currentGameData];\r\n  }\r\n\r\n  setCurrent(gameData) {\r\n    this.currentGameData = gameData;\r\n  }\r\n\r\n  getCurrent() {\r\n    return this.currentGameData;\r\n  }\r\n\r\n  setReplays(replays) {\r\n    this.replays = this.replays.filter(\r\n      replay => !replays.find(newReplay => newReplay.turn === replay.turn)\r\n    );\r\n\r\n    this.replays = [...this.replays, ...replays];\r\n  }\r\n}\r\n\r\nexport default GameDataCache;\r\n","import hexagon from \"../hexagon/index.mjs\";\r\nimport uuidv4 from \"uuid/v4.js\";\r\n\r\nclass GameSlot {\r\n  constructor(data = {}, gameData) {\r\n    this.id = uuidv4();\r\n    this.gameData = gameData;\r\n    this.deserialize(data);\r\n  }\r\n\r\n  getShips() {\r\n    if (!this.gameData) {\r\n      return [];\r\n    }\r\n\r\n    return this.gameData.ships\r\n      .getShips()\r\n      .filter(ship => this.shipIds.includes(ship.id));\r\n  }\r\n\r\n  includesShip(ship) {\r\n    return this.shipIds.includes(ship.id);\r\n  }\r\n\r\n  isUsers(user) {\r\n    return this.userId === user.id;\r\n  }\r\n\r\n  addShip(ship) {\r\n    this.shipIds.push(ship.id);\r\n  }\r\n\r\n  isTaken() {\r\n    return Boolean(this.userId);\r\n  }\r\n\r\n  takeSlot(user) {\r\n    this.userId = user.id;\r\n  }\r\n\r\n  leaveSlot(user) {\r\n    if (this.userId !== user.id) {\r\n      throw Error(\"Trying to leave slot that is not occupied by player\");\r\n    }\r\n\r\n    this.userId = null;\r\n  }\r\n\r\n  isOccupiedBy(user) {\r\n    return user && this.userId === user.id;\r\n  }\r\n\r\n  setBought() {\r\n    this.bought = true;\r\n  }\r\n\r\n  isBought() {\r\n    return this.bought;\r\n  }\r\n\r\n  validate() {\r\n    if (!this.name) {\r\n      return \"Slot needs to have a name\";\r\n    }\r\n\r\n    if (!(this.deploymentLocation instanceof hexagon.Offset)) {\r\n      return \"Slot needs to have deploymentlocation of type hexagon.Offset\";\r\n    }\r\n\r\n    if (\r\n      this.deploymentRadius !== parseInt(this.deploymentRadius, 10) ||\r\n      this.deploymentRadius < 0\r\n    ) {\r\n      return \"Slot needs to have greater than zero deploymentRadius\";\r\n    }\r\n\r\n    if (this.team !== parseInt(this.team, 10) || this.team < 0) {\r\n      return \"Slot needs to have greater than zero numeric team\";\r\n    }\r\n\r\n    if (!(this.deploymentVector instanceof hexagon.Offset)) {\r\n      return \"Slot needs to have deploymentVector of type hexagon.Offset\";\r\n    }\r\n\r\n    if (this.points !== parseInt(this.points, 10) || this.points <= 0) {\r\n      return \"Slot needs to have points more than 0\";\r\n    }\r\n  }\r\n\r\n  isValidShipDeployment(ship, hex) {\r\n    return (\r\n      this.includesShip(ship) &&\r\n      hex.distanceTo(this.deploymentLocation) <= this.deploymentRadius\r\n    );\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      id: this.id,\r\n      name: this.name,\r\n      userId: this.userId,\r\n      deploymentLocation: this.deploymentLocation,\r\n      deploymentRadius: this.deploymentRadius,\r\n      deploymentVector: this.deploymentVector,\r\n      points: this.points,\r\n      shipIds: this.shipIds,\r\n      team: this.team,\r\n      bought: this.bought,\r\n      facing: this.facing\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.id = data.id || this.id;\r\n    this.name = data.name;\r\n    this.userId = data.userId || null;\r\n    this.deploymentLocation = data.deploymentLocation\r\n      ? new hexagon.Offset(data.deploymentLocation)\r\n      : new hexagon.Offset(0, 0);\r\n    this.deploymentVector = data.deploymentVector\r\n      ? new hexagon.Offset(data.deploymentVector)\r\n      : new hexagon.Offset(0, 0);\r\n    this.deploymentRadius = data.deploymentRadius || 10;\r\n    //this.deploymentRadius = 10000;\r\n    this.shipIds = data.shipIds || [];\r\n    this.points = data.points || 0;\r\n    this.bought = data.bought || false;\r\n    this.team = data.team || 1;\r\n    this.facing = data.facing || 0;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default GameSlot;\r\n","import GameSlot from \"./GameSlot.mjs\";\r\n\r\nclass GameSlots {\r\n  constructor(gameData) {\r\n    this.gameData = gameData;\r\n    this.slots = [];\r\n  }\r\n\r\n  getTeamForShip(ship) {\r\n    const slot = this.slots.find(slot => slot.includesShip(ship));\r\n\r\n    return slot.team;\r\n  }\r\n\r\n  getSlotsByTeams() {\r\n    const teams = [];\r\n\r\n    this.slots.forEach(slot => {\r\n      let team = teams.find(t => t.team === slot.team);\r\n\r\n      if (!team) {\r\n        team = {\r\n          team: slot.team,\r\n          slots: [slot]\r\n        };\r\n        teams.push(team);\r\n      } else {\r\n        team.slots.push(slot);\r\n      }\r\n    });\r\n\r\n    return teams;\r\n  }\r\n\r\n  isUsersTeamSlot(slot, user) {\r\n    const userSlot = this.slots.find(s => s.userId === user);\r\n\r\n    if (!userSlot) {\r\n      return false;\r\n    }\r\n\r\n    return slot.team === userSlot.team;\r\n  }\r\n\r\n  getUsersSlots(user) {\r\n    return this.slots.filter(slot => slot.isUsers(user));\r\n  }\r\n\r\n  getSlotByShip(ship) {\r\n    return this.slots.find(slot => slot.includesShip(ship));\r\n  }\r\n\r\n  getSlotById(id) {\r\n    return this.slots.find(slot => slot.id === id);\r\n  }\r\n\r\n  setSlots(slots) {\r\n    slots.forEach(this.addSlot.bind(this));\r\n  }\r\n\r\n  getSlots() {\r\n    return this.slots;\r\n  }\r\n\r\n  addSlot(slot) {\r\n    this.slots.push(slot);\r\n    return slot;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      slots: this.slots.map(slot => slot.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.slots = data.slots\r\n      ? data.slots.map(slotData => new GameSlot(slotData, this.gameData))\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default GameSlots;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass BoostableSystemStrategy extends ShipSystemStrategy {\r\n  constructor(power = 0, maxLevel = null) {\r\n    super();\r\n    this.power = power;\r\n\r\n    this.maxLevel = maxLevel;\r\n    this.boostLevel = 0;\r\n  }\r\n\r\n  isBoostable() {\r\n    return true;\r\n  }\r\n\r\n  /*\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Boostable\",\r\n      value: \"Boost with additional power\"\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Current boost level\",\r\n      value: this.boostLevel\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n  */\r\n\r\n  canBoost(payload, previousResponse) {\r\n    const remainginPower = this.system.shipSystems.power.getRemainingPowerOutput();\r\n\r\n    if (this.system.isDisabled()) {\r\n      return false;\r\n    }\r\n\r\n    if (this.maxLevel !== null && this.boostLevel >= this.maxLevel) {\r\n      return false;\r\n    }\r\n\r\n    return remainginPower >= this.getPowerRequiredForBoost();\r\n  }\r\n\r\n  canDeBoost(payload, previousResponse) {\r\n    return this.boostLevel > 0;\r\n  }\r\n\r\n  getPowerRequiredForBoost(payload, previousResponse = 0) {\r\n    return this.power + previousResponse;\r\n  }\r\n\r\n  getBoost(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return previousResponse + this.boostLevel;\r\n  }\r\n\r\n  getPowerRequirement(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    const power = this.boostLevel * this.power;\r\n    return power + previousResponse;\r\n  }\r\n\r\n  boost(payload, previousResponse) {\r\n    if (!this.canBoost(payload)) {\r\n      return false;\r\n    }\r\n\r\n    this.boostLevel++;\r\n  }\r\n\r\n  deBoost(payload, previousResponse) {\r\n    if (this.boostLevel === 0) {\r\n      return false;\r\n    }\r\n\r\n    this.boostLevel--;\r\n    this.system.callHandler(\"onSystemPowerLevelDecrease\");\r\n  }\r\n\r\n  receivePlayerData({ clientShip, clientSystem }) {\r\n    if (!clientSystem) {\r\n      return;\r\n    }\r\n\r\n    if (this.system.isDisabled()) {\r\n      return;\r\n    }\r\n\r\n    const clientStrategy = clientSystem.getStrategiesByInstance(\r\n      BoostableSystemStrategy\r\n    )[0];\r\n\r\n    const targetBoostlevel = clientStrategy.boostLevel;\r\n\r\n    if (this.boostLevel > targetBoostlevel) {\r\n      while (true) {\r\n        if (this.boostLevel === targetBoostlevel) {\r\n          return;\r\n        }\r\n\r\n        if (!this.canDeBoost()) {\r\n          return;\r\n        }\r\n\r\n        this.deBoost();\r\n      }\r\n    } else if (this.boostLevel < targetBoostlevel) {\r\n      while (true) {\r\n        if (this.boostLevel === targetBoostlevel) {\r\n          return;\r\n        }\r\n\r\n        if (!this.canBoost()) {\r\n          return;\r\n        }\r\n\r\n        this.boost();\r\n      }\r\n    }\r\n  }\r\n\r\n  serialize(payload, previousResponse = []) {\r\n    return {\r\n      ...previousResponse,\r\n      boostableSystemStrategy: {\r\n        boostLevel: this.boostLevel\r\n      }\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.boostLevel = data.boostableSystemStrategy\r\n      ? data.boostableSystemStrategy.boostLevel\r\n      : 0;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default BoostableSystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\nimport {\r\n  OutputReduced2,\r\n  OutputReduced4,\r\n  OutputReduced6,\r\n  OutputReduced8\r\n} from \"../criticals/index.mjs\";\r\nimport OutputReduced from \"../criticals/OutputReduced.mjs\";\r\n\r\nclass ThrustOutputSystemStrategy extends ShipSystemStrategy {\r\n  constructor(output) {\r\n    super();\r\n\r\n    this.output = output || 0;\r\n  }\r\n\r\n  getOutputForBoost(payload, previousResponse = 0) {\r\n    if (previousResponse > this.output) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return this.output;\r\n  }\r\n\r\n  getThrustOutput(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    let output = this.output;\r\n\r\n    output -= this.system.damage\r\n      .getCriticals()\r\n      .filter(critical => critical instanceof OutputReduced)\r\n      .reduce((total, current) => total + current.getOutputReduction(), 0);\r\n\r\n    if (output < 0) {\r\n      output = 0;\r\n    }\r\n\r\n    return previousResponse + this.system.callHandler(\"getBoost\") + output;\r\n  }\r\n\r\n  getPossibleCriticals(payload, previousResponse = []) {\r\n    return [\r\n      ...previousResponse,\r\n      { severity: 20, critical: new OutputReduced(2, 2) },\r\n      {\r\n        severity: 30,\r\n        critical: new OutputReduced(Math.ceil(this.output / 4), 2)\r\n      },\r\n      {\r\n        severity: 60,\r\n        critical: new OutputReduced(Math.ceil(this.output / 3), 2)\r\n      },\r\n      {\r\n        severity: 70,\r\n        critical: new OutputReduced(Math.ceil(this.output / 2), 2)\r\n      },\r\n      { severity: 30, critical: new OutputReduced(2) },\r\n      { severity: 70, critical: new OutputReduced(Math.ceil(this.output / 4)) },\r\n      { severity: 80, critical: new OutputReduced(Math.ceil(this.output / 3)) },\r\n      { severity: 90, critical: new OutputReduced(Math.ceil(this.output / 2)) }\r\n    ];\r\n  }\r\n\r\n  onSystemOffline() {\r\n    this.onSystemPowerLevelDecrease();\r\n  }\r\n\r\n  onSystemPowerLevelDecrease() {\r\n    if (\r\n      !this.system ||\r\n      !this.system.shipSystems ||\r\n      !this.system.shipSystems.ship\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.system.shipSystems.ship.movement.revertMovementsUntilValidMovement();\r\n  }\r\n}\r\n\r\nexport default ThrustOutputSystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\nimport { ForcedOffline } from \"../criticals/index.mjs\";\r\n\r\nclass RequiresPowerSystemStrategy extends ShipSystemStrategy {\r\n  constructor(power, getsCriticals = true) {\r\n    super();\r\n    this.power = power || 0;\r\n    if (this.power <= 0) {\r\n      throw new Error(\"Power must be more than zero\");\r\n    }\r\n\r\n    this.getsCriticals = getsCriticals;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      sort: \"AAAA\",\r\n      header: \"Power requirement\",\r\n      value: this.power\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  getPowerRequirement(payload, previousResponse = 0) {\r\n    return this.power + previousResponse;\r\n  }\r\n\r\n  canSetOffline(payload, previousResponse = false) {\r\n    return true;\r\n  }\r\n\r\n  canSetOnline() {\r\n    return true;\r\n  }\r\n\r\n  shouldBeOffline(payload, previousResponse = false) {\r\n    if (previousResponse === true) {\r\n      return true;\r\n    }\r\n\r\n    return this.system.hasCritical(ForcedOffline);\r\n  }\r\n\r\n  getPossibleCriticals(payload, previousResponse = []) {\r\n    if (!this.getsCriticals) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return [\r\n      ...previousResponse,\r\n      {\r\n        severity: 20,\r\n        critical: new ForcedOffline(1)\r\n      },\r\n      {\r\n        severity: 40,\r\n        critical: new ForcedOffline(2)\r\n      },\r\n      {\r\n        severity: 60,\r\n        critical: new ForcedOffline(3)\r\n      },\r\n      {\r\n        severity: 80,\r\n        critical: new ForcedOffline(4)\r\n      }\r\n    ];\r\n  }\r\n}\r\n\r\nexport default RequiresPowerSystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\nimport {\r\n  OutputReduced2,\r\n  OutputReduced4,\r\n  OutputReduced6,\r\n  OutputReduced8\r\n} from \"../criticals/index.mjs\";\r\n\r\nclass PowerOutputSystemStrategy extends ShipSystemStrategy {\r\n  constructor(output) {\r\n    super();\r\n\r\n    this.output = output || 0;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Power output\",\r\n      value: this.getPowerOutput()\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  getPowerOutput(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    let output = this.output;\r\n\r\n    if (this.system.hasCritical(OutputReduced2)) {\r\n      output -= 2;\r\n    }\r\n\r\n    if (this.system.hasCritical(OutputReduced4)) {\r\n      output -= 4;\r\n    }\r\n\r\n    if (this.system.hasCritical(OutputReduced6)) {\r\n      output -= 6;\r\n    }\r\n\r\n    if (this.system.hasCritical(OutputReduced8)) {\r\n      output -= 8;\r\n    }\r\n\r\n    if (output < 0) {\r\n      output = 0;\r\n    }\r\n\r\n    return previousResponse + output;\r\n  }\r\n\r\n  getPossibleCriticals(payload, previousResponse = []) {\r\n    return [\r\n      ...previousResponse,\r\n      { weight: 10, className: OutputReduced2 },\r\n      { weight: 7, className: OutputReduced4 },\r\n      { weight: 3, className: OutputReduced6 },\r\n      { weight: 1, className: OutputReduced8 }\r\n    ];\r\n  }\r\n}\r\n\r\nexport default PowerOutputSystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\nimport ThrustChannelHeatIncreased from \"../criticals/ThrustChannelHeatIncreased.mjs\";\nimport { OutputReduced } from \"../criticals/index.mjs\";\n\nconst directionsToString = {\n  0: \"Thrust forward\",\n  3: \"Thrust aft\",\n  1: \"Thrust starboard\",\n  2: \"Thrust starboard\",\n  4: \"Thrust port\",\n  5: \"Thrust port\",\n  6: \"Pivot right\",\n  7: \"Pivot left\",\n  8: \"Roll, Evade\"\n};\n\nclass ThrustChannelSystemStrategy extends ShipSystemStrategy {\n  constructor(output, direction) {\n    super();\n\n    this.output = output || 0;\n    this.direction = direction || 0; // 0, 3, [4,5], [1,2], 6\n    this.channeled = 0;\n    this.heatPerThrustChanneled = 0.75;\n  }\n\n  resetChanneledThrust() {\n    this.channeled = 0;\n  }\n\n  addChanneledThrust(channel) {\n    this.channeled += channel;\n  }\n\n  serialize(payload, previousResponse = []) {\n    return {\n      ...previousResponse,\n      thrustChannelSystemStrategy: {\n        channeled: this.channeled\n      }\n    };\n  }\n\n  getIconText() {\n    return this.channeled + \"/\" + this.output;\n  }\n\n  deserialize(data = {}) {\n    const thisData = data.thrustChannelSystemStrategy || {};\n    this.channeled = thisData.channeled || 0;\n\n    return this;\n  }\n\n  getDirectionString() {\n    if (Array.isArray(this.direction)) {\n      return this.direction\n        .map(direction => directionsToString[direction])\n        .join(\", \");\n    }\n\n    return directionsToString[this.direction];\n  }\n\n  getMessages(payload, previousResponse = []) {\n    previousResponse.push({\n      header: \"Output\",\n      value: this.output\n    });\n\n    previousResponse.push({\n      header: \"Manouver(s)\",\n      value: this.getDirectionString()\n    });\n\n    previousResponse.push({\n      header: \"Channeled\",\n      value: this.channeled\n    });\n\n    previousResponse.push({\n      header: \"Heat generated\",\n      value: this.getHeatGenerated()\n    });\n\n    return previousResponse;\n  }\n\n  getThrustChannel(payload, previousResponse = 0) {\n    if (this.system.isDisabled()) {\n      return previousResponse;\n    }\n\n    return previousResponse + this.getChannelOutput();\n  }\n\n  generatesHeat() {\n    return true;\n  }\n\n  getHeatPerThrustChanneled() {\n    let heat = this.heatPerThrustChanneled;\n\n    heat *=\n      1 +\n      this.system.damage\n        .getCriticals()\n        .filter(critical => critical instanceof ThrustChannelHeatIncreased)\n        .reduce((total, current) => total + current.getHeatIncrease(), 0);\n\n    return heat;\n  }\n\n  getHeatForThrust({ amount }) {\n    return amount * this.getHeatPerThrustChanneled();\n  }\n\n  getHeatGenerated(payload, previousResponse = 0) {\n    return previousResponse + this.channeled * this.getHeatPerThrustChanneled();\n  }\n\n  getThrustDirection(payload, previousResponse = null) {\n    return this.direction;\n  }\n\n  getChannelOutput() {\n    let output = this.output;\n\n    output -= this.system.damage\n      .getCriticals()\n      .filter(critical => critical instanceof OutputReduced)\n      .reduce((total, current) => total + current.getOutputReduction(), 0);\n\n    if (output < 0) {\n      output = 0;\n    }\n\n    return output;\n  }\n\n  getMaxChannelAmount() {\n    return this.getChannelOutput();\n  }\n\n  canChannelAmount(amount) {\n    return amount <= this.getMaxChannelAmount();\n  }\n\n  getChannelCost(amount) {\n    return amount;\n  }\n\n  isThruster(payload, previousResponse = 0) {\n    return true;\n  }\n\n  isDirection(direction) {\n    return (\n      this.direction === direction ||\n      (Array.isArray(this.direction) && this.direction.includes(direction))\n    );\n  }\n\n  advanceTurn() {\n    this.channeled = 0;\n  }\n\n  getPossibleCriticals(payload, previousResponse = []) {\n    return [\n      ...previousResponse,\n\n      { severity: 20, critical: new ThrustChannelHeatIncreased(0.5, 1) },\n      {\n        severity: 30,\n        critical: new OutputReduced(Math.ceil(this.output / 4), 2)\n      },\n      { severity: 40, critical: new ThrustChannelHeatIncreased(0.5, 3) },\n      { severity: 60, critical: new ThrustChannelHeatIncreased(0.5) },\n      { severity: 70, critical: new OutputReduced(Math.ceil(this.output / 4)) },\n      { severity: 80, critical: new OutputReduced(Math.ceil(this.output / 3)) },\n      { severity: 90, critical: new OutputReduced(Math.ceil(this.output / 2)) }\n    ];\n  }\n}\n\nexport default ThrustChannelSystemStrategy;\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass AllowsEvasionSystemStrategy extends ShipSystemStrategy {\r\n  constructor(evasion) {\r\n    super();\r\n\r\n    this.evasion = evasion || 0;\r\n  }\r\n\r\n  getMaxEvasion(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return previousResponse + this.evasion;\r\n  }\r\n}\r\n\r\nexport default AllowsEvasionSystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\nimport {\r\n  OutputReduced2,\r\n  OutputReduced4,\r\n  OutputReduced6,\r\n  OutputReduced8\r\n} from \"../criticals/index.mjs\";\r\nimport * as ewTypes from \"../../../electronicWarfare/electronicWarfareTypes.mjs\";\r\nimport ElectronicWarfareEntry from \"../../../electronicWarfare/ElectronicWarfareEntry.mjs\";\r\nimport Ship from \"../../Ship.mjs\";\r\nimport OutputReduced from \"../criticals/OutputReduced.mjs\";\r\n\r\nconst typeAsString = type => {\r\n  switch (type) {\r\n    case ewTypes.EW_OFFENSIVE:\r\n      return \"Offensive EW\";\r\n    case ewTypes.EW_DEFENSIVE:\r\n      return \"Defensive EW\";\r\n    case ewTypes.EW_CC:\r\n      return \"Close combat EW\";\r\n    case ewTypes.EW_OFFENSIVE_SUPPORT:\r\n      return \"Offensive support EW\";\r\n    case ewTypes.EW_DEFENSIVE_SUPPORT:\r\n      return \"Defensive EW\";\r\n    case ewTypes.EW_DISRUPTION:\r\n      return \"Disruption EW\";\r\n    case ewTypes.EW_AREA_DEFENSIVE_SUPPORT:\r\n      return \"Area defensive EW\";\r\n  }\r\n};\r\n\r\nclass ElectronicWarfareProvider extends ShipSystemStrategy {\r\n  constructor(output, allowedEwTypes) {\r\n    super();\r\n\r\n    this.output = output || 0;\r\n    this.allowedEwTypes = allowedEwTypes || [\r\n      ewTypes.EW_OFFENSIVE,\r\n      ewTypes.EW_DEFENSIVE,\r\n      ewTypes.EW_CC\r\n    ];\r\n\r\n    this.entries = [];\r\n  }\r\n\r\n  serialize(payload, previousResponse = []) {\r\n    return {\r\n      ...previousResponse,\r\n      electronicWarfareProvider: [\r\n        ...this.entries.map(entry => entry.serialize())\r\n      ]\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.entries = data.electronicWarfareProvider\r\n      ? data.electronicWarfareProvider.map(\r\n          entry =>\r\n            new ElectronicWarfareEntry(\r\n              entry.type,\r\n              entry.targetShipId,\r\n              entry.amount\r\n            )\r\n        )\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Usage/Output\",\r\n      value: this.getUsageVsOutputText()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"EW type(s)\",\r\n      value: this.allowedEwTypes.map(typeAsString).join(\", \")\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  getUsageVsOutputText() {\r\n    return this.getTotalEwUsed() + \"/\" + this.getEwOutput();\r\n  }\r\n\r\n  getValidEwTypes() {\r\n    return this.getValidEwTypes;\r\n  }\r\n\r\n  getEwEntry(type, targetId) {\r\n    return this.entries.find(\r\n      entry => entry.type === type && entry.targetShipId === targetId\r\n    );\r\n  }\r\n\r\n  assignEw({ type, target, amount }) {\r\n    if (target instanceof Ship) {\r\n      target = target.id;\r\n    }\r\n\r\n    if (!this.canUseEw({ type, amount })) {\r\n      throw new Error(\"Check validity first!\");\r\n    }\r\n\r\n    let entry = this.getEwEntry(type, target);\r\n    if (!entry && amount <= 0) {\r\n      return;\r\n    } else if (!entry) {\r\n      entry = new ElectronicWarfareEntry(type, target, amount);\r\n      this.entries.push(entry);\r\n    } else {\r\n      entry.addAmount(amount);\r\n    }\r\n  }\r\n\r\n  getEwEntries() {\r\n    return this.entries.map(entry => entry.clone());\r\n  }\r\n\r\n  canUseEw({ type, amount }) {\r\n    return this.canUseEwType(type) && this.canUseEwAmount(amount);\r\n  }\r\n\r\n  canUseEwType(type) {\r\n    return this.allowedEwTypes.includes(type);\r\n  }\r\n\r\n  canUseEwAmount(amount) {\r\n    return this.getEwOutput() >= this.getTotalEwUsed() + amount;\r\n  }\r\n\r\n  getUnusedCapacity() {\r\n    return this.getEwOutput() - this.getTotalEwUsed();\r\n  }\r\n\r\n  getTotalEwUsedByType(type) {\r\n    if (type === ewTypes.EW_DEFENSIVE) {\r\n      if (!this.canUseEwType(ewTypes.EW_DEFENSIVE)) {\r\n        return 0;\r\n      }\r\n\r\n      return this.getUnusedCapacity();\r\n    }\r\n\r\n    return this.entries\r\n      .filter(entry => entry.type === type)\r\n      .reduce((total, entry) => total + entry.getAmount(), 0);\r\n  }\r\n\r\n  getTotalEwUsed() {\r\n    return this.entries.reduce((total, entry) => total + entry.getAmount(), 0);\r\n  }\r\n\r\n  getOutputForBoost(payload, previousResponse = 0) {\r\n    if (previousResponse > this.output) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return this.output;\r\n  }\r\n\r\n  getEwOutput(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    let output = this.output;\r\n\r\n    output -= this.system.damage\r\n      .getCriticals()\r\n      .filter(critical => critical instanceof OutputReduced)\r\n      .reduce((total, current) => total + current.getOutputReduction(), 0);\r\n\r\n    return (\r\n      previousResponse + this.system.callHandler(\"getBoost\", null, 0) + output\r\n    );\r\n  }\r\n\r\n  isEwArray(payload, previousResponse = 0) {\r\n    return true;\r\n  }\r\n\r\n  resetEw() {\r\n    this.entries = [];\r\n  }\r\n\r\n  getPossibleCriticals(payload, previousResponse = []) {\r\n    return [\r\n      ...previousResponse,\r\n      { severity: 20, critical: new OutputReduced(1) },\r\n      {\r\n        severity: 40,\r\n        critical: new OutputReduced(Math.ceil(this.output / 4), 2)\r\n      },\r\n      {\r\n        severity: 50,\r\n        critical: new OutputReduced(Math.ceil(this.output / 3), 2)\r\n      },\r\n\r\n      {\r\n        severity: 60,\r\n        critical: new OutputReduced(Math.ceil(this.output / 2), 2)\r\n      },\r\n      { severity: 80, critical: new OutputReduced(Math.ceil(this.output / 4)) },\r\n      { severity: 90, critical: new OutputReduced(Math.ceil(this.output / 3)) },\r\n      { severity: 100, critical: new OutputReduced(Math.ceil(this.output / 2)) }\r\n    ];\r\n  }\r\n\r\n  censorForUser({ mine }) {\r\n    if (!mine) {\r\n      this.entries = [];\r\n    }\r\n  }\r\n\r\n  onSystemOffline() {\r\n    this.onSystemPowerLevelDecrease();\r\n  }\r\n\r\n  onSystemPowerLevelDecrease() {\r\n    if (\r\n      !this.system ||\r\n      !this.system.shipSystems ||\r\n      !this.system.shipSystems.ship\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.system.shipSystems.ship.electronicWarfare.repeatElectonicWarfare();\r\n  }\r\n}\r\n\r\nexport default ElectronicWarfareProvider;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass LargerHitProfileOnlineSystemStrategy extends ShipSystemStrategy {\r\n  constructor(front, side, hitSizeMultiplier = 0) {\r\n    super();\r\n\r\n    this.front = front;\r\n    this.side = side;\r\n    this.hitSizeMultiplier = hitSizeMultiplier;\r\n    this.turnsOffline = 0;\r\n  }\r\n\r\n  serialize(payload, previousResponse = []) {\r\n    return {\r\n      ...previousResponse,\r\n      largerHitProfileOnlineSystemStrategy: {\r\n        turnsOffline: this.turnsOffline\r\n      }\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    const thisData = data.largerHitProfileOnlineSystemStrategy || {};\r\n    this.turnsOffline = thisData.turnsOffline || 0;\r\n\r\n    return this;\r\n  }\r\n\r\n  getHitSystemSizeMultiplier(payload, previousResponse = 1) {\r\n    if (\r\n      (this.system.isDestroyed() && this.turnsOffline > 0) ||\r\n      this.turnsOffline > 1\r\n    ) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return previousResponse + this.hitSizeMultiplier;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Increases profile when online\",\r\n      value: `${this.front}/${this.side}`\r\n    });\r\n    previousResponse.push({\r\n      header: \"Modifies system hit allocation size\",\r\n      value: `x${this.hitSizeMultiplier}`\r\n    });\r\n\r\n    if (!this.system.isDestroyed()) {\r\n      if (this.turnsOffline > 1) {\r\n        previousResponse.push({\r\n          value: `NOTE: System has been offline long enough for the profile increase to cease.`\r\n        });\r\n      } else {\r\n        previousResponse.push({\r\n          value: `NOTE: System has to be offline ${2 -\r\n            this.turnsOffline} turn(s) before profile increase ceases.`\r\n        });\r\n      }\r\n    } else {\r\n      previousResponse.push({\r\n        value: `NOTE: Destroyed system will not increase ship profile.`\r\n      });\r\n    }\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  getHitProfile({ front = true }, previousResponse = 0) {\r\n    if (\r\n      (this.system.isDestroyed() && this.turnsOffline > 0) ||\r\n      this.turnsOffline > 1\r\n    ) {\r\n      return previousResponse;\r\n    }\r\n\r\n    if (front) {\r\n      return previousResponse + this.front;\r\n    } else {\r\n      return previousResponse + this.side;\r\n    }\r\n  }\r\n\r\n  advanceTurn() {\r\n    if (this.system.isDisabled()) {\r\n      this.turnsOffline++;\r\n    } else {\r\n      this.turnsOffline = 0;\r\n    }\r\n  }\r\n}\r\n\r\nexport default LargerHitProfileOnlineSystemStrategy;\r\n","import BoostableSystemStrategy from \"./BoostableSystemStrategy.mjs\";\r\n\r\nclass BoostablePlusOneOutputSystemStrategy extends BoostableSystemStrategy {\r\n  constructor(maxLevel) {\r\n    super(0, maxLevel);\r\n  }\r\n\r\n  getPowerRequiredForBoost(payload, previousResponse = 0) {\r\n    const output = this.system.callHandler(\"getOutputForBoost\", null, 0);\r\n    return output + this.boostLevel + previousResponse + 1;\r\n  }\r\n\r\n  getPowerRequirement(payload, previousResponse = 0) {\r\n    const output = this.system.callHandler(\"getOutputForBoost\", null, 0);\r\n    const power = this.boostLevel * output + this.boostLevel;\r\n    return power + previousResponse;\r\n  }\r\n}\r\n\r\nexport default BoostablePlusOneOutputSystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass ArmorBoostOfflineSystemStrategy extends ShipSystemStrategy {\r\n  constructor(armorBoost = 1) {\r\n    super();\r\n\r\n    this.armorBoost = armorBoost;\r\n  }\r\n\r\n  getArmorModifier(payload, previousResponse = 0) {\r\n    if (!this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return previousResponse + this.armorBoost;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Increased armor when offline\",\r\n      value: `+${this.armorBoost}`\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n}\r\n\r\nexport default ArmorBoostOfflineSystemStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass OutputHeatOnlineStrategy extends ShipSystemStrategy {\r\n  constructor(heatOutput, heatOutputPerBoostLevel = 1) {\r\n    super();\r\n    this.heatOutput = heatOutput;\r\n    this.heatOutputPerBoostLevel = heatOutputPerBoostLevel;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      sort: \"heat\",\r\n      header: \"Generates heat when online\",\r\n      value: `${this.getHeatGenerated()}`\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  generatesHeat() {\r\n    return true;\r\n  }\r\n\r\n  getHeatGenerated(payload, previousResponse = 0) {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    const boostLevel = this.system.callHandler(\"getBoost\", null, 0);\r\n\r\n    return (\r\n      previousResponse +\r\n      this.heatOutput +\r\n      boostLevel * this.heatOutputPerBoostLevel\r\n    );\r\n  }\r\n}\r\n\r\nexport default OutputHeatOnlineStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass FireOrderHeatStrategy extends ShipSystemStrategy {\r\n  constructor(heatPerFireOrder) {\r\n    super();\r\n    this.heatPerFireOrder = heatPerFireOrder;\r\n  }\r\n\r\n  generatesHeat() {\r\n    return true;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      sort: \"heat\",\r\n      header: \"Generates heat when fired\",\r\n      value: `${this.heatPerFireOrder}`\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  getHeatGenerated(payload, previousResponse = 0) {\r\n    const fireOrders = this.system.callHandler(\"getFireOrders\", null, []);\r\n\r\n    if (fireOrders.length === 0) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return previousResponse + fireOrders * this.heatPerFireOrder;\r\n  }\r\n}\r\n\r\nexport default FireOrderHeatStrategy;\r\n","import ShipSystemStrategy from \"./ShipSystemStrategy.mjs\";\r\n\r\nclass AlwaysTargetableSystemStrategy extends ShipSystemStrategy {\r\n  constructor(turnsOfflineToCancel = null) {\r\n    super();\r\n\r\n    this.turnsOfflineToCancel = turnsOfflineToCancel;\r\n    this.turnsOffline = 0;\r\n  }\r\n\r\n  canBeTargeted(payload, previousResponse = false) {\r\n    if (this.system.isDestroyed()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    if (\r\n      this.turnsOfflineToCancel !== null &&\r\n      this.turnsOffline >= this.turnsOfflineToCancel\r\n    ) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  serialize(payload, previousResponse = []) {\r\n    return {\r\n      ...previousResponse,\r\n      alwaysTargetableSystemStrategy: {\r\n        turnsOffline: this.turnsOffline\r\n      }\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    const thisData = data.alwaysTargetableSystemStrategy || {};\r\n    this.turnsOffline = thisData.turnsOffline || 0;\r\n\r\n    return this;\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    if (this.system.isDestroyed()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    if (this.turnsOfflineToCancel === null) {\r\n      previousResponse.push({\r\n        value: `This system can always be hit, regardless of attack direction`\r\n      });\r\n    } else {\r\n      if (this.turnsOffline >= this.turnsOfflineToCancel) {\r\n        previousResponse.push({\r\n          value: `This system has been ofline long enough to not be a valid target`\r\n        });\r\n      } else {\r\n        previousResponse.push({\r\n          value: `This system has to be ofline ${this.turnsOfflineToCancel -\r\n            this.turnsOffline} more turn to not be a valid target`\r\n        });\r\n      }\r\n    }\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  advanceTurn() {\r\n    if (this.system.isDisabled()) {\r\n      this.turnsOffline++;\r\n    } else {\r\n      this.turnsOffline = 0;\r\n    }\r\n  }\r\n}\r\n\r\nexport default AlwaysTargetableSystemStrategy;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\r\nimport WeaponHitChange from \"../../../../weapon/WeaponHitChange.mjs\";\r\nimport CombatLogWeaponFireHitResult from \"../../../../combatLog/CombatLogWeaponFireHitResult.mjs\";\r\n\r\nclass StandardHitStrategy extends ShipSystemStrategy {\r\n  constructor(fireControl = 0, numberOfShots = 1) {\r\n    super();\r\n    this.fireControl = fireControl;\r\n    this.numberOfShots = numberOfShots;\r\n  }\r\n\r\n  getBaseHitChange({ shooter, target }) {\r\n    return target.getHitProfile(shooter.getPosition());\r\n  }\r\n\r\n  checkFireOrderHits({ shooter, target, weaponSettings, combatLogEntry }) {\r\n    const toHit = this.getHitChange({ shooter, target, weaponSettings });\r\n    const roll = Math.ceil(Math.random() * 100);\r\n\r\n    const hit = roll <= toHit.result;\r\n\r\n    const result = new CombatLogWeaponFireHitResult(hit, toHit, roll);\r\n    combatLogEntry.addHitResult(result);\r\n\r\n    return result;\r\n  }\r\n\r\n  getFireControl() {\r\n    return this.fireControl;\r\n  }\r\n\r\n  getHitChange({ shooter, target, prediction = false, weaponSettings = {} }) {\r\n    const baseToHit = this.system.callHandler(\"getBaseHitChange\", {\r\n      shooter,\r\n      target,\r\n      weaponSettings\r\n    });\r\n\r\n    const dew = target.electronicWarfare.inEffect.getDefensiveEw();\r\n    const oew = shooter.electronicWarfare.inEffect.getOffensiveEw(target);\r\n\r\n    let distance = prediction\r\n      ? shooter.finalHexDistanceTo(target)\r\n      : shooter.hexDistanceTo(target);\r\n\r\n    const rangeDistance = oew === 0 ? distance * 2 : distance;\r\n\r\n    const rangeModifier =\r\n      this.system.callHandler(\"getRangeModifier\", {\r\n        distance: rangeDistance,\r\n        weaponSettings\r\n      }) *\r\n      (1 + target.movement.getEvasion() / 10);\r\n\r\n    const rollingPenalty = shooter.movement.isRolling() ? -20 : 0;\r\n\r\n    let result =\r\n      baseToHit +\r\n      rollingPenalty +\r\n      this.getFireControl() +\r\n      oew * 5 -\r\n      dew * 5 +\r\n      rangeModifier;\r\n\r\n    if (rangeModifier === false) {\r\n      result = 0;\r\n    }\r\n\r\n    const onRange = this.system.callHandler(\"isOnRange\", { distance });\r\n    const absoluteResult = result;\r\n    result = Math.floor(result);\r\n\r\n    if (result < 0) {\r\n      result = 0;\r\n    }\r\n\r\n    return new WeaponHitChange({\r\n      baseToHit,\r\n      fireControl: this.fireControl,\r\n      dew: dew,\r\n      oew: oew,\r\n      distance,\r\n      rangeModifier,\r\n      evasion: target.movement.getEvasion(),\r\n      result: onRange ? result : 0,\r\n      absoluteResult,\r\n      outOfRange: !onRange,\r\n      rollingPenalty\r\n    });\r\n  }\r\n}\r\n\r\nexport default StandardHitStrategy;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\r\n\r\nclass StandardRangeStrategy extends ShipSystemStrategy {\r\n  constructor(rangesAndPenalties) {\r\n    super();\r\n\r\n    this.rangesAndPenalties = rangesAndPenalties || [];\r\n  }\r\n\r\n  getUiComponents(payload, previousResponse = []) {\r\n    return [\r\n      ...previousResponse,\r\n      {\r\n        name: \"RangePenalty\",\r\n        props: {\r\n          rangeStrategy: this\r\n        }\r\n      }\r\n    ];\r\n  }\r\n\r\n  isOnRange({ distance }) {\r\n    return distance <= this.getMaxRange();\r\n  }\r\n\r\n  getMaxRange() {\r\n    return this.rangesAndPenalties[this.rangesAndPenalties.length - 1].range;\r\n  }\r\n\r\n  getRangeModifier({ distance: currentRange }) {\r\n    const exactModifier = this.rangesAndPenalties.find(\r\n      ({ range }) => range === currentRange\r\n    );\r\n\r\n    if (exactModifier) {\r\n      return exactModifier.modifier;\r\n    }\r\n\r\n    let start = null;\r\n    let end = null;\r\n\r\n    this.rangesAndPenalties.forEach(({ range, modifier }) => {\r\n      if ((start === null || range > start.range) && range < currentRange) {\r\n        start = { range, modifier };\r\n      } else if ((end === null || range < end.range) && range > currentRange) {\r\n        end = { range, modifier };\r\n      }\r\n    });\r\n\r\n    if (!end) {\r\n      return -200;\r\n    }\r\n\r\n    const difference = end.modifier - start.modifier;\r\n    const distance = end.range - start.range;\r\n    return Math.round(\r\n      start.modifier + (difference * (currentRange - start.range)) / distance\r\n    );\r\n  }\r\n}\r\n\r\nexport default StandardRangeStrategy;\r\n","class CombatLogWeaponOutOfArc {\r\n  constructor(fireOrderId) {\r\n    this.fireOrderId = fireOrderId;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      fireOrderId: this.fireOrderId\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.fireOrderId = data.fireOrderId;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogWeaponOutOfArc;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\r\nimport FireOrder from \"../../../../weapon/FireOrder.mjs\";\r\nimport CombatLogWeaponOutOfArc from \"../../../../combatLog/CombatLogWeaponOutOfArc.mjs\";\r\nimport CombatLogWeaponFire from \"../../../../combatLog/CombatLogWeaponFire.mjs\";\r\n\r\nclass FireOrderStrategy extends ShipSystemStrategy {\r\n  constructor(numberOfShots = 1, resolutionPriority = 10) {\r\n    super();\r\n\r\n    this.numberOfShots = numberOfShots;\r\n    this.resolutionPriority = resolutionPriority;\r\n\r\n    this.fireOrders = [];\r\n  }\r\n\r\n  executeFireOrders({ gameData }) {\r\n    this.fireOrders.forEach(fireOrder => {\r\n      const weapon = this.system;\r\n      const shooter = gameData.ships.getShipById(fireOrder.shooterId);\r\n      const target = gameData.ships.getShipById(fireOrder.targetId);\r\n      const weaponSettings = fireOrder.weaponSettings;\r\n\r\n      if (!this.system.callHandler(\"isOnArc\", { shooter, target })) {\r\n        gameData.combatLog.addEntry(new CombatLogWeaponOutOfArc(fireOrder.id));\r\n        return false;\r\n      }\r\n\r\n      if (!this.system.callHandler(\"canFire\", { shooter, target }, true)) {\r\n        return false;\r\n      }\r\n\r\n      const combatLogEntry = new CombatLogWeaponFire(\r\n        fireOrder.id,\r\n        fireOrder.targetId,\r\n        fireOrder.shooterId,\r\n        weapon.callHandler(\"getSelectedAmmo\", null, null)\r\n      );\r\n\r\n      const hitResolution = weapon.callHandler(\"checkFireOrderHits\", {\r\n        shooter,\r\n        target,\r\n        weaponSettings,\r\n        gameData,\r\n        fireOrder,\r\n        combatLogEntry\r\n      });\r\n\r\n      weapon.callHandler(\"applyDamageFromWeaponFire\", {\r\n        shooter,\r\n        target,\r\n        weaponSettings,\r\n        gameData,\r\n        fireOrder,\r\n        combatLogEntry,\r\n        hitResolution\r\n      });\r\n\r\n      weapon.callHandler(\"onWeaponFired\");\r\n      fireOrder.setResolved();\r\n      gameData.combatLog.addEntry(combatLogEntry);\r\n    });\r\n  }\r\n\r\n  usesFireOrders() {\r\n    return true;\r\n  }\r\n\r\n  getNumberOfShots() {\r\n    return this.numberOfShots;\r\n  }\r\n\r\n  getFireOrderResolutionPriority() {\r\n    return this.resolutionPriority;\r\n  }\r\n\r\n  hasFireOrder() {\r\n    return this.fireOrders.length > 0;\r\n  }\r\n\r\n  getFireOrders() {\r\n    return this.fireOrders;\r\n  }\r\n\r\n  removeFireOrders() {\r\n    this.fireOrders = [];\r\n  }\r\n\r\n  addFireOrder({ shooter, target, weaponSettings }) {\r\n    this.fireOrders = [];\r\n\r\n    let shots = this.numberOfShots;\r\n    while (shots--) {\r\n      const order = new FireOrder(shooter, target, this.system, weaponSettings);\r\n      this.fireOrders.push(order);\r\n    }\r\n\r\n    return this.fireOrders;\r\n  }\r\n\r\n  serialize(payload, previousResponse = []) {\r\n    return {\r\n      ...previousResponse,\r\n      fireOrderStrategy: this.fireOrders.map(fire => fire.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.fireOrders = data.fireOrderStrategy\r\n      ? data.fireOrderStrategy.map(entry => new FireOrder().deserialize(entry))\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n\r\n  advanceTurn(turn) {\r\n    this.fireOrders = [];\r\n  }\r\n\r\n  censorForUser({ mine }) {\r\n    if (!mine) {\r\n      this.fireOrders = [];\r\n    }\r\n  }\r\n\r\n  onSystemOffline() {\r\n    this.removeFireOrders();\r\n  }\r\n}\r\n\r\nexport default FireOrderStrategy;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\nimport { LoadingTimeIncreased } from \"../../criticals/index.mjs\";\n\nclass StandardLoadingStrategy extends ShipSystemStrategy {\n  constructor(loadingTime) {\n    super();\n    this.loadingTime = loadingTime;\n    this.turnsLoaded = loadingTime;\n    this.firedThisTurn = false;\n  }\n\n  getMessages(payload, previousResponse = []) {\n    const boostLoading = this._getBoostLoading();\n    let loading = 1 + boostLoading;\n\n    if (!Number.isInteger(loading)) {\n      loading = loading.toFixed(1);\n    }\n\n    let turnsLoaded = this.turnsLoaded;\n\n    if (!Number.isInteger(turnsLoaded)) {\n      turnsLoaded = turnsLoaded.toFixed(1);\n    }\n\n    const loadingTime = this.getLoadingTime();\n\n    if (turnsLoaded > loadingTime) {\n      turnsLoaded = loadingTime;\n    }\n\n    previousResponse.push({\n      header: \"Charging\",\n      value: `${turnsLoaded} / ${loadingTime} +${loading} per turn`\n    });\n\n    const boostPower = this.system.callHandler(\n      \"getPowerRequiredForBoost\",\n      null,\n      0\n    );\n\n    if (boostPower) {\n      previousResponse.push({\n        header: \"Charging boostable\",\n        value: `${boostPower} power required`\n      });\n    }\n\n    return previousResponse;\n  }\n\n  _getTurnsUntilLoaded() {\n    const left = this.getLoadingTime() - this.turnsLoaded;\n    const loadingPerTurn = 1 + this._getBoostLoading();\n\n    return Math.ceil(left / loadingPerTurn);\n  }\n\n  getIconText(payload, previousResponse = \"\") {\n    if (this.system.isDisabled()) {\n      return previousResponse;\n    }\n\n    const left = this._getTurnsUntilLoaded();\n    if (left <= 0) {\n      return previousResponse;\n    }\n\n    return `-${left}T`;\n  }\n\n  canFire(payload, previousResponse = true) {\n    if (!this.isLoaded()) {\n      return false;\n    }\n\n    return previousResponse;\n  }\n\n  usesLoading() {\n    return true;\n  }\n\n  onWeaponFired() {\n    this.firedThisTurn = true;\n  }\n\n  getLoadingTime() {\n    const extra = this.system.damage\n      .getCriticals()\n      .filter(critical => critical instanceof LoadingTimeIncreased)\n      .reduce((total, current) => total + current.getLoadingTimeIncrease(), 0);\n\n    return this.loadingTime + extra;\n  }\n\n  getTurnsLoaded() {\n    return this.turnsLoaded;\n  }\n\n  isReady(payload, previousResponse = null) {\n    if (previousResponse === false) {\n      return false;\n    }\n\n    return this.isLoaded();\n  }\n\n  isLoaded() {\n    return this.turnsLoaded >= this.getLoadingTime();\n  }\n\n  serialize(payload, previousResponse = []) {\n    return {\n      ...previousResponse,\n      standardLoadingStrategy: {\n        turnsLoaded: this.turnsLoaded\n      }\n    };\n  }\n\n  deserialize(data = {}) {\n    this.turnsLoaded = data.standardLoadingStrategy\n      ? data.standardLoadingStrategy.turnsLoaded\n      : 0;\n\n    return this;\n  }\n\n  advanceTurn() {\n    if (this.system.isDisabled()) {\n      this.turnsLoaded = 0;\n      return;\n    }\n\n    if (this.firedThisTurn) {\n      this.turnsLoaded = 0;\n      this.firedThisTurn = false;\n    }\n\n    const loadingStep = 1 + this._getBoostLoading();\n    this.turnsLoaded += loadingStep;\n  }\n\n  _getBoostLoading() {\n    let boost = this.system.callHandler(\"getBoost\", null, 0);\n\n    if (!boost) {\n      return 0;\n    }\n\n    const targetLoading = this.getLoadingTime() - boost;\n    return this.getLoadingTime() / targetLoading - 1;\n  }\n\n  getPossibleCriticals(payload, previousResponse = []) {\n    return [\n      ...previousResponse,\n      {\n        severity: 40,\n        critical: new LoadingTimeIncreased(this.loadingTime, 1)\n      },\n      {\n        severity: 80,\n        critical: new LoadingTimeIncreased(this.loadingTime * 3, 1)\n      },\n      { severity: 100, critical: new LoadingTimeIncreased(null, 1) }\n    ];\n  }\n}\n\nexport default StandardLoadingStrategy;\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\r\nimport {\r\n  addToDirection,\r\n  getCompassHeadingOfPoint,\r\n  hexFacingToAngle\r\n} from \"../../../../utils/math.mjs\";\r\n\r\nclass WeaponArcStrategy extends ShipSystemStrategy {\r\n  constructor(arcs = []) {\r\n    super();\r\n\r\n    this.arcs = [].concat(arcs);\r\n  }\r\n\r\n  hasArcs() {\r\n    return true;\r\n  }\r\n\r\n  isPositionOnArc({ targetPosition }) {\r\n    const shooter = this.system.shipSystems.ship;\r\n    const targetHeading = getCompassHeadingOfPoint(\r\n      shooter.getPosition(),\r\n      targetPosition\r\n    );\r\n\r\n    const shooterFacing = hexFacingToAngle(shooter.getFacing());\r\n    const arcs = this.getArcs({ facing: shooterFacing });\r\n\r\n    return arcs.some(({ start, end }) => {\r\n      if (end === start) {\r\n        return true;\r\n      } else if (end > start) {\r\n        return targetHeading >= start && targetHeading <= end;\r\n      } else if (start > end) {\r\n        return targetHeading <= end || targetHeading >= start;\r\n      }\r\n\r\n      return false;\r\n    });\r\n  }\r\n\r\n  isOnArc({ target }) {\r\n    return this.isPositionOnArc({ targetPosition: target.getPosition() });\r\n  }\r\n\r\n  getArcs({ facing = 0 }) {\r\n    return this.arcs.map(({ start, end }) => {\r\n      if (this.system.shipSystems.ship.movement.isRolled()) {\r\n        return {\r\n          start: addToDirection(addToDirection(0, -end), facing),\r\n          end: addToDirection(addToDirection(0, -start), facing)\r\n        };\r\n      }\r\n\r\n      return {\r\n        start: addToDirection(start, facing),\r\n        end: addToDirection(end, facing)\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\nexport default WeaponArcStrategy;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport { PowerOutputSystemStrategy } from \"../strategy/index.mjs\";\r\n\r\nclass Reactor extends ShipSystem {\r\n  constructor(args, output) {\r\n    super(args, [new PowerOutputSystemStrategy(output)]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Reactor\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/reactor.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return this.callHandler(\"getPowerOutput\");\r\n  }\r\n}\r\n\r\nexport default Reactor;\r\n","import StandardDamageStrategy from \"./StandardDamageStrategy.mjs\";\r\nimport Reactor from \"../../reactor/Reactor.mjs\";\r\n\r\nclass TestDamageStrategy extends StandardDamageStrategy {\r\n  constructor(damage) {\r\n    super();\r\n\r\n    this.damage = damage;\r\n  }\r\n\r\n  _getDamageForWeaponHit({ requiredToHit, rolledToHit }) {\r\n    return this.damage;\r\n  }\r\n\r\n  _chooseHitSystem({ target, shooterPosition }) {\r\n    const systems = target.systems.getSystemsForHit(shooterPosition);\r\n    return systems.find(system => system instanceof Reactor);\r\n  }\r\n\r\n  _getArmorPiercing() {\r\n    return 1000;\r\n  }\r\n}\r\n\r\nexport default TestDamageStrategy;\r\n","import StandardDamageStrategy from \"./StandardDamageStrategy.mjs\";\r\nimport CombatLogDamageEntry from \"../../../../combatLog/CombatLogDamageEntry.mjs\";\r\n\r\nclass BurstDamageStrategy extends StandardDamageStrategy {\r\n  constructor(\r\n    damageFormula,\r\n    armorPiercingFormula,\r\n    shotsFormula = 6,\r\n    maxShots = 6,\r\n    grouping = 10\r\n  ) {\r\n    super(damageFormula, armorPiercingFormula);\r\n\r\n    this.shotsFormula = shotsFormula;\r\n    this.maxShots = maxShots;\r\n    this.grouping = grouping;\r\n  }\r\n\r\n  getTotalBurstSize() {\r\n    return this.maxShots;\r\n  }\r\n\r\n  applyDamageFromWeaponFire(payload) {\r\n    const { fireOrder, combatLogEntry } = payload;\r\n    const shots = this._getNumberOfShots(payload);\r\n\r\n    combatLogEntry.setShots(shots, this.maxShots);\r\n\r\n    Array.from(Array(shots)).map(() => {\r\n      const result = new CombatLogDamageEntry();\r\n      combatLogEntry.addDamage(result);\r\n      this._doDamage(\r\n        { shooterPosition: payload.shooter.getPosition(), ...payload },\r\n        result\r\n      );\r\n      return result;\r\n    });\r\n  }\r\n\r\n  _getDamageTypeMessage() {\r\n    return \"Burst\";\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Damage type\",\r\n      value: this._getDamageTypeMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Burst size\",\r\n      value: this.maxShots\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Burst grouping\",\r\n      value: this.grouping\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Damage\",\r\n      value: this._getDamageMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Armor piercing\",\r\n      value: this._getArmorPiercingMessage()\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  _getNumberOfShots({ hitResolution }) {\r\n    const requiredToHit = hitResolution.hitChange.result;\r\n    const rolledToHit = hitResolution.hitRoll;\r\n\r\n    if (rolledToHit > requiredToHit) {\r\n      return 0;\r\n    }\r\n\r\n    if (rolledToHit <= requiredToHit - this.maxShots * this.grouping) {\r\n      return this.maxShots;\r\n    }\r\n\r\n    let shots = Math.floor((requiredToHit - rolledToHit) / this.grouping);\r\n\r\n    if (Number.isInteger(this.shotsFormula)) {\r\n      shots += this.shotsFormula;\r\n    } else {\r\n      shots += this.diceRoller.roll(this.shotsFormula).total;\r\n    }\r\n\r\n    if (shots > this.maxShots) {\r\n      shots = this.maxShots;\r\n    }\r\n\r\n    if (shots <= 0) {\r\n      shots = 1;\r\n    }\r\n\r\n    return shots;\r\n  }\r\n}\r\n\r\nexport default BurstDamageStrategy;\r\n","import StandardDamageStrategy from \"./StandardDamageStrategy.mjs\";\r\nimport Structure from \"../../structure/Structure.mjs\";\r\n\r\nclass PiercingDamageStrategy extends StandardDamageStrategy {\r\n  constructor(damageFormula, armorPiercingFormula) {\r\n    super(damageFormula, armorPiercingFormula);\r\n  }\r\n\r\n  _getDamageTypeMessage() {\r\n    return \"Piercing\";\r\n  }\r\n\r\n  getMessages(payload, previousResponse = []) {\r\n    previousResponse.push({\r\n      header: \"Damage type\",\r\n      value: this._getDamageTypeMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      value:\r\n        \"Piercing will cause damage multiple times applying new damage each time, until it runs out of armor piercing.\" +\r\n        \" Piercing will not damage other than structures multiple times.\"\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Damage\",\r\n      value: this._getDamageMessage()\r\n    });\r\n\r\n    previousResponse.push({\r\n      header: \"Armor piercing\",\r\n      value: this._getArmorPiercingMessage()\r\n    });\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  _getNumberOfShots() {\r\n    return this.maxDamages;\r\n  }\r\n\r\n  _chooseHitSystem({ target, shooterPosition }, systemsHit) {\r\n    const systems = target.systems\r\n      .getSystemsForHit(shooterPosition)\r\n      .filter(system => !systemsHit.some(hit => system.id === hit.id));\r\n    return this.hitSystemRandomizer.randomizeHitSystem(systems);\r\n  }\r\n\r\n  _doDamage(\r\n    payload,\r\n    damageResult,\r\n    armorPiercing = undefined,\r\n    shotsResolved = 0,\r\n    systemsHit = []\r\n  ) {\r\n    const { target, shooterPosition, combatLogEntry } = payload;\r\n\r\n    if (armorPiercing === 0) {\r\n      combatLogEntry.addNote(\r\n        `Pierced ${shotsResolved} times. Ran out of armor piercing.`\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (armorPiercing === undefined) {\r\n      armorPiercing = this._getArmorPiercing(payload);\r\n    }\r\n\r\n    const hitSystem = this._chooseHitSystem(\r\n      {\r\n        target,\r\n        shooterPosition\r\n      },\r\n      systemsHit\r\n    );\r\n\r\n    if (!hitSystem) {\r\n      return;\r\n    }\r\n\r\n    let result = this._doDamageToSystem(\r\n      payload,\r\n      damageResult,\r\n      hitSystem,\r\n      armorPiercing,\r\n      this._getDamageForWeaponHit(payload)\r\n    );\r\n\r\n    armorPiercing = result.armorPiercing;\r\n\r\n    if (!(hitSystem instanceof Structure)) {\r\n      systemsHit.push(hitSystem);\r\n    }\r\n\r\n    return this._doDamage(\r\n      payload,\r\n      damageResult,\r\n      armorPiercing,\r\n      shotsResolved + 1,\r\n      systemsHit\r\n    );\r\n  }\r\n}\r\n\r\nexport default PiercingDamageStrategy;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\nimport { getCompassHeadingOfPoint } from \"../../../../utils/math.mjs\";\nimport { getDistanceBetweenDirections } from \"../../../../utils/math.mjs\";\nimport WeaponHitChange from \"../../../../weapon/WeaponHitChange.mjs\";\n\nclass InterceptorStrategy extends ShipSystemStrategy {\n  constructor(numberOfIntercepts = 1, heatPerIntercept = 0) {\n    super();\n\n    this.numberOfIntercepts = numberOfIntercepts;\n    this.heatPerIntercept = heatPerIntercept;\n    this.timesIntercepted = 0;\n  }\n\n  getInterceptHeat() {\n    return this.timesIntercepted * this.heatPerIntercept;\n  }\n\n  getHeatPerIntercept() {\n    return this.heatPerIntercept;\n  }\n\n  addTimesIntercepted(amount = 1) {\n    this.timesIntercepted += amount;\n  }\n\n  getHeatGenerated(payload, previousResponse = 0) {\n    return previousResponse + this.timesIntercepted * this.heatPerIntercept;\n  }\n\n  canIntercept() {\n    return true;\n  }\n\n  getNumberOfIntercepts() {\n    return this.numberOfIntercepts;\n  }\n\n  getInterceptChance({ target, torpedoFlight, interceptTry = 1 }) {\n    let distance = interceptTry;\n    const ship = this.system.shipSystems.ship;\n\n    if (target !== ship) {\n      const torpedoDistanceToTarget = torpedoFlight.position.distanceTo(\n        target.getPosition()\n      );\n\n      const interceptorDistanceToTorpedo = ship\n        .getPosition()\n        .distanceTo(torpedoFlight.position);\n\n      const interceptorDistanceToTarget = ship\n        .getPosition()\n        .distanceTo(target.getPosition());\n\n      if (\n        torpedoDistanceToTarget > interceptorDistanceToTorpedo &&\n        interceptorDistanceToTarget < torpedoDistanceToTarget\n      ) {\n        distance += ship.hexDistanceTo(target);\n      } else {\n        distance += ship.hexDistanceTo(target) * 2;\n      }\n    }\n\n    const rangeModifier =\n      this.system.callHandler(\"getRangeModifier\", {\n        distance: distance\n      }) *\n      (1 + torpedoFlight.torpedo.getEvasion() / 10);\n\n    const fireControl = this.system.callHandler(\"getFireControl\", null, 0);\n\n    const ccew = ship.electronicWarfare.getCcEw();\n\n    const torpedoHitSize = torpedoFlight.torpedo.getHitSize();\n\n    const rollingPenalty = ship.movement.isRolling() ? -20 : 0;\n\n    return new WeaponHitChange({\n      baseToHit: torpedoHitSize,\n      fireControl,\n      dew: 0,\n      oew: ccew,\n      distance,\n      rangeModifier,\n      evasion: torpedoFlight.torpedo.getEvasion(),\n      rollingPenalty,\n      result: Math.round(\n        torpedoHitSize + rangeModifier + fireControl + ccew * 5 + rollingPenalty\n      ),\n      absoluteResult:\n        torpedoHitSize + rangeModifier + fireControl + ccew * 5 + rollingPenalty\n    });\n  }\n\n  advanceTurn() {\n    this.timesIntercepted = 0;\n  }\n}\n\nexport default InterceptorStrategy;\n","import ShipSystem from \"../ShipSystem.mjs\";\nimport {\n  ThrustChannelSystemStrategy,\n  AllowsEvasionSystemStrategy\n} from \"../strategy/index.mjs\";\n\nclass ManeuveringThruster extends ShipSystem {\n  constructor(args, channel, evasion) {\n    super(args, [\n      new ThrustChannelSystemStrategy(channel, [6, 7, 8]),\n      new AllowsEvasionSystemStrategy(evasion)\n    ]);\n  }\n\n  getDisplayName() {\n    return \"Maneuvering Thruster\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/maneuveringThruster.png\";\n  }\n\n  getIconText() {\n    return this.callHandler(\"getThrustChannel\");\n  }\n}\n\nexport default ManeuveringThruster;\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport { ThrustChannelSystemStrategy } from \"../strategy/index.mjs\";\r\n\r\nclass Thruster extends ShipSystem {\r\n  constructor(args, channel, direction) {\r\n    super(args, [new ThrustChannelSystemStrategy(channel, direction)]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Thruster\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    if (this.callHandler(\"isDirection\", 3, false)) {\r\n      return \"/img/system/thruster2.png\";\r\n    } else if (this.callHandler(\"isDirection\", 2, false)) {\r\n      return \"/img/system/thruster4.png\";\r\n    } else if (this.callHandler(\"isDirection\", 5, false)) {\r\n      return \"/img/system/thruster3.png\";\r\n    }\r\n    return \"/img/system/thruster1.png\";\r\n  }\r\n}\r\n\r\nexport default Thruster;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\nimport {\n  ThrustChannelSystemStrategy,\n  AllowsEvasionSystemStrategy\n} from \"../strategy/index.mjs\";\n\nclass ManeuveringThrusterLeft extends ShipSystem {\n  constructor(args, channel, evasion) {\n    super(args, [\n      new ThrustChannelSystemStrategy(channel, [6, 8]),\n      new AllowsEvasionSystemStrategy(evasion)\n    ]);\n  }\n\n  getDisplayName() {\n    return \"Maneuvering Thruster\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/maneuveringThrusterLeft.png\";\n  }\n\n  getIconText() {\n    return this.callHandler(\"getThrustChannel\");\n  }\n}\n\nexport default ManeuveringThrusterLeft;\n","import ShipSystem from \"../ShipSystem.mjs\";\nimport {\n  ThrustChannelSystemStrategy,\n  AllowsEvasionSystemStrategy\n} from \"../strategy/index.mjs\";\n\nclass ManeuveringThrusterRight extends ShipSystem {\n  constructor(args, channel, evasion) {\n    super(args, [\n      new ThrustChannelSystemStrategy(channel, [7, 8]),\n      new AllowsEvasionSystemStrategy(evasion)\n    ]);\n  }\n\n  getDisplayName() {\n    return \"Maneuvering Thruster\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/maneuveringThrusterRight.png\";\n  }\n\n  getIconText() {\n    return this.callHandler(\"getThrustChannel\");\n  }\n}\n\nexport default ManeuveringThrusterRight;\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport {\r\n  BoostableSystemStrategy,\r\n  ThrustOutputSystemStrategy,\r\n  RequiresPowerSystemStrategy\r\n} from \"../strategy/index.mjs\";\r\n\r\nclass Engine extends ShipSystem {\r\n  constructor(args, output, power, boostPower) {\r\n    super(args, [\r\n      new BoostableSystemStrategy(boostPower),\r\n      new ThrustOutputSystemStrategy(output),\r\n      new RequiresPowerSystemStrategy(power)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Engine\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/engine.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return this.callHandler(\"getThrustOutput\");\r\n  }\r\n}\r\n\r\nexport default Engine;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport { ElectronicWarfareProvider } from \"../strategy/index.mjs\";\r\nimport BoostablePlusOneOutputSystemStrategy from \"../strategy/BoostablePlusOneOutputSystemStrategy.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport OutputHeatOnlineStrategy from \"../strategy/OutputHeatOnlineStrategy.mjs\";\r\n\r\nclass EwArray extends ShipSystem {\r\n  constructor(args, output) {\r\n    const { heat, boostHeat, boostable = true, power = 5 } = args;\r\n    super(args, [\r\n      new ElectronicWarfareProvider(output),\r\n      new RequiresPowerSystemStrategy(power),\r\n      new OutputHeatOnlineStrategy(\r\n        heat || Math.ceil(output / 2),\r\n        boostHeat || Math.ceil(output / 3)\r\n      )\r\n    ]);\r\n\r\n    if (boostable) {\r\n      this.addStrategy(new BoostablePlusOneOutputSystemStrategy());\r\n    }\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Electronic Warfare array\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/scanner.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return this.callHandler(\"getUsageVsOutputText\");\r\n  }\r\n}\r\n\r\nexport default EwArray;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport * as ewTypes from \"../../../electronicWarfare/electronicWarfareTypes.mjs\";\r\nimport { ElectronicWarfareProvider } from \"../strategy/index.mjs\";\r\n\r\nclass CQEWArray extends ShipSystem {\r\n  constructor(args, output) {\r\n    super(args, [new ElectronicWarfareProvider(output, [ewTypes.EW_CC])]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"CQEW array\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/scanner.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return this.callHandler(\"getUsageVsOutputText\");\r\n  }\r\n}\r\n\r\nexport default CQEWArray;\r\n","import EwArray from \"./EwArray.mjs\";\r\nimport * as ewTypes from \"../../../electronicWarfare/electronicWarfareTypes.mjs\";\r\nimport { ElectronicWarfareProvider } from \"../strategy/index.mjs\";\r\n\r\nclass ElintArray extends EwArray {\r\n  constructor(args, output) {\r\n    super(args, [\r\n      new ElectronicWarfareProvider(output, [\r\n        ewTypes.EW_OFFENSIVE_SUPPORT,\r\n        ewTypes.EW_DEFENSIVE_SUPPORT,\r\n        ewTypes.EW_DISRUPTION,\r\n        ewTypes.EW_AREA_DEFENSIVE_SUPPORT\r\n      ])\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"ELINT array\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/scanner.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return this.callHandler(\"getUsageVsOutputText\");\r\n  }\r\n}\r\n\r\nexport default ElintArray;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport { ElectronicWarfareProvider } from \"../strategy/index.mjs\";\r\nimport BoostablePlusOneOutputSystemStrategy from \"../strategy/BoostablePlusOneOutputSystemStrategy.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport OutputHeatOnlineStrategy from \"../strategy/OutputHeatOnlineStrategy.mjs\";\r\nimport * as ewTypes from \"../../../electronicWarfare/electronicWarfareTypes.mjs\";\r\n\r\nclass OEWArray extends ShipSystem {\r\n  constructor(args, output) {\r\n    const { heat, boostHeat, boostable = false, power = 5 } = args;\r\n    super(args, [\r\n      new ElectronicWarfareProvider(output, [ewTypes.EW_OFFENSIVE]),\r\n      new RequiresPowerSystemStrategy(power),\r\n      new OutputHeatOnlineStrategy(\r\n        heat || Math.ceil(output / 2),\r\n        boostHeat || Math.ceil(output / 3)\r\n      )\r\n    ]);\r\n\r\n    if (boostable) {\r\n      this.addStrategy(new BoostablePlusOneOutputSystemStrategy());\r\n    }\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Offensive Electronic Warfare array\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/OEWArray.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return this.callHandler(\"getUsageVsOutputText\");\r\n  }\r\n}\r\n\r\nexport default OEWArray;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport AlwaysTargetableSystemStrategy from \"../strategy/AlwaysTargetableSystemStrategy.mjs\";\r\n\r\nclass Weapon extends ShipSystem {\r\n  constructor(args, strategies) {\r\n    super(args, strategies);\r\n\r\n    if (args.alwaysTargetable) {\r\n      this.addStrategy(new AlwaysTargetableSystemStrategy());\r\n    }\r\n  }\r\n\r\n  isWeapon() {\r\n    return true;\r\n  }\r\n\r\n  showOnSystemList() {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport default Weapon;\r\n","import Weapon from \"./Weapon.mjs\";\r\nimport FireOrderStrategy from \"../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport TestDamageStrategy from \"../strategy/weapon/TestDamageStrategy.mjs\";\r\n\r\nclass TestWeapon extends Weapon {\r\n  constructor(args, arcs) {\r\n    super(args, [\r\n      new FireOrderStrategy(1),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(10000),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: 0 },\r\n        { range: 300, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(2),\r\n      new TestDamageStrategy(10)\r\n    ]);\r\n  }\r\n}\r\n\r\nexport default TestWeapon;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\r\n\r\nclass WeaponAnimationStrategy extends ShipSystemStrategy {\r\n  constructor(animationName, animationArguments = {}) {\r\n    super();\r\n    this.animationName = animationName;\r\n    this.animationArguments = animationArguments;\r\n  }\r\n\r\n  getWeaponFireAnimationName() {\r\n    return this.animationName;\r\n  }\r\n\r\n  getWeaponFireAnimationArguments() {\r\n    return this.animationArguments;\r\n  }\r\n}\r\n\r\nexport default WeaponAnimationStrategy;\r\n","import Weapon from \"../Weapon.mjs\";\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\nimport PiercingDamageStrategy from \"../../strategy/weapon/PiercingDamageStrategy.mjs\";\nimport BoostableSystemStrategy from \"../../strategy/BoostableSystemStrategy.mjs\";\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\nimport OutputHeatOnlineStrategy from \"../../strategy/OutputHeatOnlineStrategy.mjs\";\n\nclass CoilgunLightFixed extends Weapon {\n  constructor({ id }, arcs) {\n    super({ id, hitpoints: 10, armor: 5 }, [\n      new FireOrderStrategy(1),\n      new WeaponArcStrategy(arcs),\n      new StandardHitStrategy(20),\n      new StandardRangeStrategy([\n        { range: 0, modifier: -100 },\n        { range: 200, modifier: -40 },\n        { range: 400, modifier: -200 }\n      ]),\n      new StandardLoadingStrategy(4),\n      new RequiresPowerSystemStrategy(6),\n      new BoostableSystemStrategy(6, 2),\n      new PiercingDamageStrategy(\"d7+1\", \"d6+20\"),\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\n        size: 12,\n        length: 2000,\n        speed: 5,\n        color: [0.8, 0.1, 0.4],\n        explosionSize: 20,\n        explosionType: \"gas\"\n      }),\n      new OutputHeatOnlineStrategy(4, 2)\n    ]);\n  }\n\n  getDisplayName() {\n    return \"Fixed light coilgun\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/matterCannon.png\";\n  }\n}\n\nexport default CoilgunLightFixed;\n","import Weapon from \"../Weapon.mjs\";\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\nimport PiercingDamageStrategy from \"../../strategy/weapon/PiercingDamageStrategy.mjs\";\nimport BoostableSystemStrategy from \"../../strategy/BoostableSystemStrategy.mjs\";\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\nimport OutputHeatOnlineStrategy from \"../../strategy/OutputHeatOnlineStrategy.mjs\";\n\nclass MediumCoilcunTurretedUC extends Weapon {\n  constructor({ id }, arcs) {\n    super({ id, hitpoints: 14, armor: 5 }, [\n      new FireOrderStrategy(1),\n      new WeaponArcStrategy(arcs),\n      new StandardHitStrategy(20),\n      new StandardRangeStrategy([\n        { range: 0, modifier: -200 },\n        { range: 120, modifier: -20 },\n        { range: 610, modifier: -200 }\n      ]),\n      new StandardLoadingStrategy(4),\n      new RequiresPowerSystemStrategy(10),\n      new BoostableSystemStrategy(8, 2),\n      new PiercingDamageStrategy(\"d7+1\", \"d9+25\"),\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\n        size: 12,\n        length: 2000,\n        speed: 5,\n        color: [0.8, 0.1, 0.4],\n        explosionSize: 20,\n        explosionType: \"gas\"\n      }),\n      new OutputHeatOnlineStrategy(6, 2)\n    ]);\n  }\n\n  getDisplayName() {\n    return \"Medium coilgun\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/matterCannon.png\";\n  }\n}\n\nexport default MediumCoilcunTurretedUC;\n","import Weapon from \"../Weapon.mjs\";\r\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\r\nimport PiercingDamageStrategy from \"../../strategy/weapon/PiercingDamageStrategy.mjs\";\r\n\r\nclass RailgunTurreted64gw extends Weapon {\r\n  constructor(args, arcs) {\r\n    super(args, [\r\n      new FireOrderStrategy(1),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(35),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: -100 },\r\n        { range: 10, modifier: 0 },\r\n        { range: 300, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(4),\r\n      new PiercingDamageStrategy(\"6d3\", \"4d4 + 4\"),\r\n      new WeaponAnimationStrategy(\"Bolt\", {\r\n        size: 18,\r\n        length: 2000,\r\n        speed: 6,\r\n        color: [0.8, 0.1, 0.4]\r\n      })\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"64Gw turreted railgun\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/matterCannon.png\";\r\n  }\r\n}\r\n\r\nexport default RailgunTurreted64gw;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\r\nimport PiercingDamageStrategy from \"../../strategy/weapon/PiercingDamageStrategy.mjs\";\r\n\r\nclass RailgunTurreted32gw extends Weapon {\r\n  constructor(args, arcs) {\r\n    super(args, [\r\n      new FireOrderStrategy(1),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(20),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: -100 },\r\n        { range: 10, modifier: 0 },\r\n        { range: 220, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(3),\r\n      new PiercingDamageStrategy(\"4d3\", \"3d3 + 4\"),\r\n      new WeaponAnimationStrategy(\"Bolt\", {\r\n        size: 15,\r\n        length: 2000,\r\n        speed: 5,\r\n        color: [0.8, 0.1, 0.4]\r\n      })\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"32Gw turreted railgun\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/matterCannon.png\";\r\n  }\r\n}\r\n\r\nexport default RailgunTurreted32gw;\r\n","class CargoService {\r\n  divideCargo(ship, cargo) {\r\n    if (!this.hasSpaceFor(ship, cargo)) {\r\n      throw new Error(\r\n        \"Ship has no cargo space for this. Check validity first!\"\r\n      );\r\n    }\r\n    const cargoBays = this.getBaysWithSpace(ship);\r\n\r\n    let amount = cargo.amount;\r\n    while (amount > 0) {\r\n      cargoBays.forEach(system => {\r\n        if (\r\n          amount > 0 &&\r\n          system.callHandler(\r\n            \"hasSpaceFor\",\r\n            { object: cargo.object, amount: 1 },\r\n            false\r\n          )\r\n        ) {\r\n          system.callHandler(\"addCargo\", { object: cargo.object, amount: 1 });\r\n          amount--;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  hasSpaceForHowMany(ship, cargo) {\r\n    const space = this.getShipWideCargoSpaceAvailable(ship);\r\n    return Math.floor(space / cargo.object.getSpaceRequired());\r\n  }\r\n\r\n  hasSpaceFor(ship, cargo) {\r\n    return (\r\n      this.getShipWideCargoSpaceAvailable(ship) >=\r\n      cargo.object.getSpaceRequired() * cargo.amount\r\n    );\r\n  }\r\n\r\n  getShipWideCargoSpaceAvailable(ship) {\r\n    return this.getBaysWithSpace(ship).reduce(\r\n      (total, system) =>\r\n        total + system.callHandler(\"getAvailableCargoSpace\", {}, 0),\r\n      0\r\n    );\r\n  }\r\n\r\n  getBaysWithSpace(ship) {\r\n    return ship.systems\r\n      .getSystems()\r\n      .filter(\r\n        system => system.callHandler(\"getAvailableCargoSpace\", {}, 0) > 0\r\n      );\r\n  }\r\n}\r\n\r\nexport default CargoService;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\r\nimport { cargoClasses } from \"../../cargo/cargo.mjs\";\r\nimport CargoService from \"../../../../cargo/CargoService.mjs\";\r\n\r\nclass AmmunitionStrategy extends ShipSystemStrategy {\r\n  constructor(\r\n    ammunitionClasses,\r\n    ammoPerFireOrder,\r\n    capacity,\r\n    intakeInTurn,\r\n    startLoadingAfter = 1\r\n  ) {\r\n    super();\r\n\r\n    this.ammunitionClasses = [].concat(ammunitionClasses);\r\n    this.capacity = capacity;\r\n    this.startLoadingAfter = startLoadingAfter;\r\n    this.intakeInTurn = intakeInTurn;\r\n    this.ammoPerFireOrder = ammoPerFireOrder;\r\n\r\n    this.selectedAmmo = new this.ammunitionClasses[\r\n      this.ammunitionClasses.length - 1\r\n    ]();\r\n    this.turnsOffline = 0;\r\n    this.targetLoad = this._buildInitialTargetLoad();\r\n\r\n    this.changeTargetLoad = null;\r\n    this.changeSelectedAmmo = null;\r\n\r\n    this.loaded = [];\r\n  }\r\n\r\n  _buildInitialTargetLoad() {\r\n    let amountUsed = 0;\r\n    return this.ammunitionClasses.map((className, index) => {\r\n      let amount = Math.floor(this.capacity / this.ammunitionClasses.length);\r\n      let over = amount % this.ammoPerFireOrder;\r\n      let under = over === 0 ? 0 : this.ammoPerFireOrder - over;\r\n\r\n      const last = index === this.ammunitionClasses.length - 1;\r\n\r\n      if (amount > this.capacity - amountUsed) {\r\n        amount = this.capacity - amountUsed;\r\n      } else if (last) {\r\n        amount = this.capacity - amountUsed;\r\n      } else if (over !== 0 && over <= under) {\r\n        amount -= over;\r\n      } else if (under !== 0 && amountUsed + amount + under <= this.capacity) {\r\n        amount += under;\r\n      }\r\n\r\n      amountUsed += amount;\r\n\r\n      return {\r\n        object: new className(),\r\n        amount\r\n      };\r\n    });\r\n  }\r\n\r\n  getIconText(payload, previousResponse = \"\") {\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    if (this.system.callHandler(\"isLoaded\", null, null) === false) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return this.getSelectedAmmo().getIconText();\r\n  }\r\n\r\n  getUiComponents({ myShip }, previousResponse = []) {\r\n    if (!myShip) {\r\n      return previousResponse;\r\n    }\r\n\r\n    if (this.system.isDestroyed()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return [\r\n      ...previousResponse,\r\n      {\r\n        name: \"Ammo\",\r\n        props: {\r\n          ammoStrategy: this\r\n        }\r\n      }\r\n    ];\r\n  }\r\n\r\n  getTooltipMenuButton({ myShip }, previousResponse = []) {\r\n    if (!myShip) {\r\n      return previousResponse;\r\n    }\r\n\r\n    if (this.system.isDisabled()) {\r\n      return previousResponse;\r\n    }\r\n\r\n    return [\r\n      ...previousResponse,\r\n      {\r\n        img: this.getSelectedAmmo().getBackgroundImage(),\r\n        onClickHandler: () => {\r\n          this.toggleSelectedAmmo();\r\n        },\r\n        onDisabledHandler: () => false\r\n      }\r\n    ];\r\n  }\r\n\r\n  serialize(payload, previousResponse = []) {\r\n    return {\r\n      ...previousResponse,\r\n      ammunitionStrategy: {\r\n        targetLoad: this.targetLoad.map(entry => ({\r\n          className: entry.object.constructor.name,\r\n          amount: entry.amount\r\n        })),\r\n        loaded: this.loaded.map(entry => ({\r\n          className: entry.object.constructor.name,\r\n          amount: entry.amount\r\n        })),\r\n        changeTargetLoad: this.changeTargetLoad\r\n          ? this.changeTargetLoad.map(entry => ({\r\n              className: entry.object.constructor.name,\r\n              amount: entry.amount\r\n            }))\r\n          : null,\r\n        turnsOffline: this.turnsOffline,\r\n        selectedAmmo: this.selectedAmmo.constructor.name,\r\n        changeSelectedAmmo: this.changeSelectedAmmo\r\n          ? this.changeSelectedAmmo.constructor.name\r\n          : null\r\n      }\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    const ammoData = data.ammunitionStrategy || {};\r\n    this.targetLoad = ammoData.targetLoad\r\n      ? ammoData.targetLoad.map(entry => ({\r\n          object: new cargoClasses[entry.className](),\r\n          amount: entry.amount\r\n        }))\r\n      : [];\r\n\r\n    this.loaded = ammoData.loaded\r\n      ? ammoData.loaded.map(entry => ({\r\n          object: new cargoClasses[entry.className](),\r\n          amount: entry.amount\r\n        }))\r\n      : [];\r\n\r\n    this.changeTargetLoad = ammoData.changeTargetLoad\r\n      ? ammoData.changeTargetLoad.map(entry => ({\r\n          object: new cargoClasses[entry.className](),\r\n          amount: entry.amount\r\n        }))\r\n      : null;\r\n\r\n    this.turnsOffline = ammoData.turnsOffline || 0;\r\n    this.selectedAmmo = ammoData.selectedAmmo\r\n      ? new cargoClasses[ammoData.selectedAmmo]()\r\n      : new this.ammunitionClasses[this.ammunitionClasses.length - 1]();\r\n    this.changeSelectedAmmo = ammoData.changeSelectedAmmo\r\n      ? new cargoClasses[ammoData.changeSelectedAmmo]()\r\n      : null;\r\n\r\n    return this;\r\n  }\r\n\r\n  toggleSelectedAmmo() {\r\n    let index = null;\r\n    this.loaded.forEach((entry, i) => {\r\n      if (this.getSelectedAmmo().constructor === entry.object.constructor) {\r\n        index = i;\r\n      }\r\n    });\r\n\r\n    if (index + 1 > this.loaded.length - 1) {\r\n      index = 0;\r\n    } else {\r\n      index = index + 1;\r\n    }\r\n\r\n    this.changeSelectedAmmo = this.loaded[index].object;\r\n  }\r\n\r\n  getSelectedAmmo() {\r\n    return this.changeSelectedAmmo || this.selectedAmmo;\r\n  }\r\n\r\n  getLoadingTarget() {\r\n    return this.changeTargetLoad || this.targetLoad;\r\n  }\r\n\r\n  getAmmoInMagazine() {\r\n    return this.loaded;\r\n  }\r\n\r\n  loadTargetInstant() {\r\n    this.loaded = this.targetLoad;\r\n  }\r\n\r\n  getLoadingTargetAmount() {\r\n    return this.getLoadingTarget().reduce(\r\n      (total, { amount }) => total + amount,\r\n      0\r\n    );\r\n  }\r\n\r\n  addToLoading({ object, amount }) {\r\n    if (!this.changeTargetLoad) {\r\n      this.changeTargetLoad = this.targetLoad.map(entry => ({\r\n        ...entry\r\n      }));\r\n    }\r\n\r\n    let entry = this.changeTargetLoad.find(\r\n      entry => entry.object.constructor === object.constructor\r\n    );\r\n\r\n    if (!entry && amount > 0) {\r\n      entry = {\r\n        object,\r\n        amount: 0\r\n      };\r\n\r\n      this.changeTargetLoad.push(entry);\r\n    } else if (!entry && amount < 0) {\r\n      return;\r\n    }\r\n\r\n    if (this.getLoadingTargetAmount() + amount > this.capacity) {\r\n      return;\r\n    }\r\n\r\n    if (entry.amount + amount < 0) {\r\n      return;\r\n    }\r\n\r\n    entry.amount += amount;\r\n  }\r\n\r\n  setNewLoadingTarget(target) {\r\n    this.changeTargetLoad = target;\r\n  }\r\n\r\n  setNewSelectedAmmo(ammo) {\r\n    this.changeSelectedAmmo = ammo;\r\n  }\r\n\r\n  receivePlayerData({ clientShip, clientSystem }) {\r\n    if (!clientSystem) {\r\n      return;\r\n    }\r\n\r\n    if (this.system.power.isOffline()) {\r\n      //this is fine\r\n    } else if (this.system.isDisabled()) {\r\n      return;\r\n    }\r\n\r\n    const clientStrategy = clientSystem.getStrategiesByInstance(\r\n      AmmunitionStrategy\r\n    )[0];\r\n    const changeTargetLoad = clientStrategy.changeTargetLoad;\r\n    const changeSelectedAmmo = clientStrategy.changeSelectedAmmo;\r\n\r\n    if (changeTargetLoad) {\r\n      changeTargetLoad.forEach(entry => {\r\n        if (\r\n          !this.ammunitionClasses.some(\r\n            className => entry.object instanceof className\r\n          )\r\n        ) {\r\n          throw new Error(\r\n            `Illegal ammo: '${\r\n              entry.object.constructor.name\r\n            }', allowed '${this.ammunitionClasses.join(\", \")}'`\r\n          );\r\n        }\r\n\r\n        if (!Number.isInteger(entry.amount) || entry.amount < 0) {\r\n          throw new Error(`Illegal ammo amount: '${entry.amount}'`);\r\n        }\r\n      });\r\n\r\n      if (\r\n        changeTargetLoad.reduce((total, current) => total + current.amount, 0) >\r\n        this.capacity\r\n      ) {\r\n        throw new Error(`Total capacity exeeded`);\r\n      }\r\n\r\n      this.targetLoad = changeTargetLoad;\r\n    }\r\n\r\n    if (changeSelectedAmmo) {\r\n      if (\r\n        !this.ammunitionClasses.some(\r\n          ammoClass => changeSelectedAmmo instanceof ammoClass\r\n        )\r\n      ) {\r\n        throw new Error(\r\n          `Illegal selected ammo: '${changeSelectedAmmo.constructor.name}'`\r\n        );\r\n      }\r\n\r\n      this.selectedAmmo = changeSelectedAmmo;\r\n    }\r\n  }\r\n\r\n  shouldBeOffline(payload, previousResponse = false) {\r\n    if (previousResponse === true) {\r\n      return true;\r\n    }\r\n\r\n    return this.loaded.every(({ amount }) => amount < this.ammoPerFireOrder);\r\n  }\r\n\r\n  canFire(payload, previousResponse = true) {\r\n    const entry = this.loaded.find(\r\n      load => load.object.constructor === this.selectedAmmo.constructor\r\n    );\r\n\r\n    if (!entry) {\r\n      return false;\r\n    }\r\n\r\n    if (entry.amount < this.ammoPerFireOrder) {\r\n      return false;\r\n    }\r\n\r\n    return previousResponse;\r\n  }\r\n\r\n  onIntercept() {\r\n    this.onWeaponFired();\r\n  }\r\n\r\n  onWeaponFired() {\r\n    const entry = this.loaded.find(\r\n      load => load.object.constructor === this.selectedAmmo.constructor\r\n    );\r\n\r\n    if (!entry) {\r\n      throw new Error(\r\n        \"Seems like you fired a weapon without ammo. That is not good\"\r\n      );\r\n    }\r\n\r\n    entry.amount -= this.ammoPerFireOrder;\r\n\r\n    this.system.log\r\n      .getGenericLogEntry()\r\n      .addMessage(\r\n        `Expended ordnance: ${\r\n          this.ammoPerFireOrder\r\n        } x ${this.selectedAmmo.getDisplayName()}`\r\n      );\r\n\r\n    this.loaded = this.loaded.filter(entry => entry.amount > 0);\r\n    this._changeSelectedAmmoIfOutOfAmmo();\r\n  }\r\n\r\n  advanceTurn() {\r\n    if (this.system.power.isOffline()) {\r\n      this.turnsOffline++;\r\n    } else if (this.system.isDisabled()) {\r\n      return;\r\n    } else {\r\n      this.turnsOffline = 0;\r\n    }\r\n\r\n    if (this.turnsOffline > this.startLoadingAfter) {\r\n      this._load();\r\n    }\r\n  }\r\n\r\n  _changeSelectedAmmoIfOutOfAmmo() {\r\n    if (this.loaded.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !this.loaded.find(\r\n        load => load.object.constructor === this.selectedAmmo.constructor\r\n      )\r\n    ) {\r\n      const newAmmo = this.loaded.find(\r\n        entry => entry.amount > this.ammoPerFireOrder\r\n      );\r\n\r\n      if (newAmmo) {\r\n        this.selectedAmmo = newAmmo.object;\r\n      }\r\n    }\r\n  }\r\n\r\n  _load() {\r\n    let ammoTransferredIn = 0;\r\n    let ammoTransferredOut = 0;\r\n\r\n    const ship = this.system.shipSystems.ship;\r\n    const cargoService = new CargoService();\r\n\r\n    while (true) {\r\n      if (ammoTransferredOut === this.intakeInTurn) {\r\n        break;\r\n      }\r\n\r\n      if (\r\n        this.loaded.every(loaded => {\r\n          const target = this.targetLoad.find(\r\n            target => target.object.constructor === loaded.object.constructor\r\n          );\r\n\r\n          if (target && target.amount >= loaded.amount) {\r\n            return true;\r\n          }\r\n\r\n          let extra = target ? loaded.amount - target.amount : loaded.amount;\r\n          if (extra > this.intakeInTurn - ammoTransferredOut) {\r\n            extra = this.intakeInTurn - ammoTransferredOut;\r\n          }\r\n\r\n          if (extra === 0) {\r\n            return true;\r\n          }\r\n\r\n          const spaceAvailable = cargoService.hasSpaceForHowMany(ship, {\r\n            object: loaded.object,\r\n            amount: extra\r\n          });\r\n\r\n          if (spaceAvailable === 0) {\r\n            return true;\r\n          } else if (spaceAvailable < extra) {\r\n            extra = spaceAvailable;\r\n          }\r\n\r\n          cargoService.divideCargo(ship, {\r\n            object: loaded.object,\r\n            amount: extra\r\n          });\r\n\r\n          ammoTransferredOut += extra;\r\n          loaded.amount -= extra;\r\n\r\n          return false;\r\n        })\r\n      ) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    this.loaded = this.loaded.filter(entry => entry.amount > 0);\r\n\r\n    while (true) {\r\n      if (ammoTransferredIn === this.intakeInTurn) {\r\n        break;\r\n      }\r\n\r\n      if (\r\n        this.targetLoad.every(target => {\r\n          let loaded = this.loaded.find(\r\n            loaded => target.object.constructor === loaded.object.constructor\r\n          );\r\n\r\n          if (!loaded && target.amount > 0) {\r\n            loaded = {\r\n              object: target.object,\r\n              amount: 0\r\n            };\r\n\r\n            this.loaded.push(loaded);\r\n          } else if (!loaded && target.amount === 0) {\r\n            return true;\r\n          }\r\n\r\n          if (loaded.amount >= target.amount) {\r\n            return true;\r\n          }\r\n\r\n          const cargoSystem = this.system.shipSystems\r\n            .getSystems()\r\n            .find(system =>\r\n              system.callHandler(\"getCargoEntry\", target.object, null)\r\n            );\r\n\r\n          if (!cargoSystem) {\r\n            return true;\r\n          }\r\n\r\n          const cargo = cargoSystem.callHandler(\r\n            \"getCargoEntry\",\r\n            target.object,\r\n            null\r\n          );\r\n\r\n          let missing = target.amount - loaded.amount;\r\n\r\n          if (missing > this.intakeInTurn - ammoTransferredIn) {\r\n            missing = this.intakeInTurn - ammoTransferredIn;\r\n          }\r\n\r\n          if (cargo.amount >= missing) {\r\n            loaded.amount += missing;\r\n            cargoSystem.callHandler(\"removeCargo\", {\r\n              object: cargo.object,\r\n              amount: missing\r\n            });\r\n            ammoTransferredIn += missing;\r\n          } else if (cargo.amount < missing) {\r\n            loaded.amount += cargo.amount;\r\n            cargoSystem.callHandler(\"removeCargo\", {\r\n              object: cargo.object,\r\n              amount: cargo.amount\r\n            });\r\n            ammoTransferredIn += cargo.amount;\r\n          }\r\n\r\n          return false;\r\n        })\r\n      ) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    this._changeSelectedAmmoIfOutOfAmmo();\r\n  }\r\n}\r\n\r\nexport default AmmunitionStrategy;\r\n","import Weapon from \"../Weapon.mjs\";\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\nimport BurstDamageStrategy from \"../../strategy/weapon/BurstDamageStrategy.mjs\";\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\nimport InterceptorStrategy from \"../../strategy/weapon/InterceptorStrategy.mjs\";\nimport Ammo30mm from \"../ammunition/conventional/Ammo30mm.mjs\";\nimport AmmunitionStrategy from \"../../strategy/weapon/AmmunitionStrategy.mjs\";\nimport ArmorBoostOfflineSystemStrategy from \"../../strategy/ArmorBoostOfflineSystemStrategy.mjs\";\nimport FireOrderHeatStrategy from \"../../strategy/FireOrderHeatStrategy.mjs\";\n\nclass PDC30mm extends Weapon {\n  constructor({ id }, arcs) {\n    super({ id, armor: 1, hitpoints: 4 }, [\n      new RequiresPowerSystemStrategy(1),\n      new FireOrderStrategy(1),\n      new WeaponArcStrategy(arcs),\n      new StandardHitStrategy(30),\n      new StandardRangeStrategy([\n        { range: 0, modifier: 0 },\n        { range: 10, modifier: -20 },\n        { range: 15, modifier: -50 },\n        { range: 18, modifier: -100 },\n        { range: 20, modifier: -200 }\n      ]),\n      new StandardLoadingStrategy(1),\n      new BurstDamageStrategy(null, null, 0, 6, 5),\n      new InterceptorStrategy(1, 2),\n      new AmmunitionStrategy([Ammo30mm], 6, 24, 12),\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\n        size: 6,\n        speed: 0.35,\n        color: [1.0, 0.9, 0.8],\n        explosionSize: 3\n      }),\n      new ArmorBoostOfflineSystemStrategy(3),\n      new FireOrderHeatStrategy(3)\n    ]);\n  }\n\n  getDisplayName() {\n    return \"30mm PDC\";\n  }\n\n  getBackgroundImage() {\n    return \"/img/system/gatlingPulseCannon.png\";\n  }\n\n  getSystemDescription() {\n    return \"Fast tracking 30mm rotary autocannon for point defense. Uses conventional bullets with chemical propellant.\";\n  }\n}\n\nexport default PDC30mm;\n","import Weapon from \"../Weapon.mjs\";\r\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport StandardDamageStrategy from \"../../strategy/weapon/StandardDamageStrategy.mjs\";\r\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport BoostableSystemStrategy from \"../../strategy/BoostableSystemStrategy.mjs\";\r\nimport { Ammo120mmHE, Ammo120mmAP } from \"../ammunition/conventional/index.mjs\";\r\nimport AmmunitionStrategy from \"../../strategy/weapon/AmmunitionStrategy.mjs\";\r\nimport OutputHeatOnlineStrategy from \"../../strategy/OutputHeatOnlineStrategy.mjs\";\r\nimport BurstDamageStrategy from \"../../strategy/weapon/BurstDamageStrategy.mjs\";\r\n\r\nclass RailgunFixed120mm extends Weapon {\r\n  constructor({ id }, arcs) {\r\n    super({ id, hitpoints: 8, armor: 4 }, [\r\n      new FireOrderStrategy(1),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(10),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: -100 },\r\n        { range: 30, modifier: 0 },\r\n        { range: 190, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(3),\r\n      new RequiresPowerSystemStrategy(4),\r\n      new BoostableSystemStrategy(3, 1),\r\n      new BurstDamageStrategy(null, null, 0, 2, 20),\r\n      new AmmunitionStrategy([Ammo120mmAP, Ammo120mmHE], 1, 12, 4),\r\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\r\n        size: 6,\r\n        length: 100,\r\n        speed: 1.3,\r\n        color: [1.0, 0.8, 0.4],\r\n        explosionType: \"gas\",\r\n        explosionSize: 12\r\n      }),\r\n      new OutputHeatOnlineStrategy(3, 2)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"120mm fixed railgun\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/stdParticleBeam.png\";\r\n  }\r\n}\r\n\r\nexport default RailgunFixed120mm;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport StandardDamageStrategy from \"../../strategy/weapon/StandardDamageStrategy.mjs\";\r\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport BoostableSystemStrategy from \"../../strategy/BoostableSystemStrategy.mjs\";\r\nimport Ammo140mmAP from \"../ammunition/conventional/Ammo140mmAP.mjs\";\r\nimport Ammo140mmHE from \"../ammunition/conventional/Ammo140mmHE.mjs\";\r\nimport AmmunitionStrategy from \"../../strategy/weapon/AmmunitionStrategy.mjs\";\r\nimport OutputHeatOnlineStrategy from \"../../strategy/OutputHeatOnlineStrategy.mjs\";\r\nimport BurstDamageStrategy from \"../../strategy/weapon/BurstDamageStrategy.mjs\";\r\n\r\nclass RailgunTurreted2x140mm extends Weapon {\r\n  constructor({ id }, arcs) {\r\n    super({ id, hitpoints: 12, armor: 3 }, [\r\n      new FireOrderStrategy(2),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(10),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: -50 },\r\n        { range: 10, modifier: 0 },\r\n        { range: 200, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(3),\r\n      new RequiresPowerSystemStrategy(6),\r\n      new BoostableSystemStrategy(6, 1),\r\n      new BurstDamageStrategy(null, null, 0, 3, 20),\r\n      new AmmunitionStrategy([Ammo140mmAP, Ammo140mmHE], 1, 9, 4),\r\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\r\n        size: 6,\r\n        length: 100,\r\n        speed: 1.3,\r\n        color: [1.0, 0.8, 0.4],\r\n        explosionType: \"gas\"\r\n      }),\r\n      new OutputHeatOnlineStrategy(5, 3)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"2x140mm railgun\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/twinArray.png\";\r\n  }\r\n}\r\n\r\nexport default RailgunTurreted2x140mm;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport StandardDamageStrategy from \"../../strategy/weapon/StandardDamageStrategy.mjs\";\r\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport BoostableSystemStrategy from \"../../strategy/BoostableSystemStrategy.mjs\";\r\nimport Ammo140mmAP from \"../ammunition/conventional/Ammo140mmAP.mjs\";\r\nimport Ammo140mmHE from \"../ammunition/conventional/Ammo140mmHE.mjs\";\r\nimport AmmunitionStrategy from \"../../strategy/weapon/AmmunitionStrategy.mjs\";\r\nimport OutputHeatOnlineStrategy from \"../../strategy/OutputHeatOnlineStrategy.mjs\";\r\nimport BurstDamageStrategy from \"../../strategy/weapon/BurstDamageStrategy.mjs\";\r\n\r\nclass RailgunTurreted140mmUC extends Weapon {\r\n  constructor({ id }, arcs) {\r\n    super({ id, hitpoints: 9, armor: 3 }, [\r\n      new FireOrderStrategy(1),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(15),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: -50 },\r\n        { range: 10, modifier: 0 },\r\n        { range: 250, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(3),\r\n      new RequiresPowerSystemStrategy(4),\r\n      new BoostableSystemStrategy(5, 2),\r\n      new BurstDamageStrategy(null, null, 0, 3, 15),\r\n      new AmmunitionStrategy([Ammo140mmAP, Ammo140mmHE], 1, 9, 4),\r\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\r\n        size: 6,\r\n        length: 100,\r\n        speed: 1.3,\r\n        color: [1.0, 0.8, 0.4],\r\n        explosionType: \"gas\"\r\n      }),\r\n      new OutputHeatOnlineStrategy(3, 2)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"140mm railgun\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/turretMedium1.png\";\r\n  }\r\n}\r\n\r\nexport default RailgunTurreted140mmUC;\r\n","import ShipSystemStrategy from \"../ShipSystemStrategy.mjs\";\nimport { cargoClasses } from \"../../cargo/cargo.mjs\";\nimport NoAmmunitionLoaded from \"../../weapon/ammunition/NoAmmunitionLoaded.mjs\";\nimport TorpedoFlight from \"../../../TorpedoFlight.mjs\";\n\nclass TorpedoLauncherStrategy extends ShipSystemStrategy {\n  constructor(launcherIndex, loadedTorpedo, torpedoClass, loadingTime) {\n    super();\n    this.loadingTime = loadingTime;\n    this.launcherIndex = launcherIndex;\n    this.loadedTorpedo = loadedTorpedo;\n    this.nextTorpedoClass = null;\n    this.torpedoClass = torpedoClass;\n    this.turnsLoaded = loadingTime;\n\n    this.changeAmmo = null;\n    this.previousTorpedo = null;\n    this.launchTarget = null;\n  }\n\n  getUiComponents(payload, previousResponse = []) {\n    return [\n      ...previousResponse,\n      {\n        name: \"TorpedoLauncher\",\n        props: {\n          launcherIndex: this.launcherIndex,\n          loadedTorpedo: this.loadedTorpedo,\n          loadingTime: this.loadingTime,\n          turnsLoaded:\n            this.turnsLoaded > this.loadingTime\n              ? this.loadingTime\n              : this.turnsLoaded,\n          torpedoClass: this.torpedoClass,\n          launchTarget: this.launchTarget,\n          launcher: this\n        }\n      }\n    ];\n  }\n\n  serialize(payload, previousResponse = []) {\n    const response = {\n      ...previousResponse\n    };\n\n    response[`torpedoLauncherStrategy${this.launcherIndex}`] = {\n      turnsLoaded: this.turnsLoaded,\n      loadedTorpedo: this.loadedTorpedo\n        ? this.loadedTorpedo.constructor.name\n        : null,\n      changeAmmo: this.changeAmmo,\n      launchTarget: this.launchTarget\n    };\n\n    return response;\n  }\n\n  deserialize(data = {}) {\n    const launcherData =\n      data[`torpedoLauncherStrategy${this.launcherIndex}`] || {};\n\n    this.turnsLoaded = launcherData.turnsLoaded || 0;\n    this.loadedTorpedo = launcherData.loadedTorpedo\n      ? new cargoClasses[launcherData.loadedTorpedo]()\n      : null;\n\n    this.changeAmmo = launcherData.changeAmmo || null;\n    this.launchTarget = launcherData.launchTarget || null;\n\n    return this;\n  }\n\n  loadAmmoInstant({ ammo, launcherIndex }) {\n    if (\n      launcherIndex !== this.launcherIndex ||\n      (this.loadedTorpedo &&\n        this.loadedTorpedo.constructor.name === ammo.constructor.name)\n    ) {\n      return;\n    }\n\n    this.loadedTorpedo = ammo;\n    this.turnsLoaded = this.loadingTime;\n  }\n\n  unloadAmmo({ launcherIndex }) {\n    if (launcherIndex !== this.launcherIndex) {\n      return;\n    }\n\n    //TODO: unload ammo\n  }\n\n  setLaunchTarget(shipId) {\n    if (this.turnsLoaded < this.loadingTime || !this.loadedTorpedo) {\n      return;\n    }\n\n    this.launchTarget = shipId;\n  }\n\n  launchTorpedo(payload, previousResponse) {\n    if (\n      this.turnsLoaded < this.loadingTime ||\n      !this.loadedTorpedo ||\n      !this.launchTarget\n    ) {\n      return previousResponse;\n    }\n\n    const result = new TorpedoFlight(\n      this.loadedTorpedo,\n      this.launchTarget,\n      this.system.shipSystems.ship.id,\n      this.system.id,\n      this.launcherIndex\n    );\n\n    /*\n    const possibleNewTorpedos = this.getPossibleTorpedosToLoad();\n    let newAmmo = null;\n\n    if (\n      possibleNewTorpedos.find(\n        torpedo => torpedo.constructor === this.loadedTorpedo.constructor\n      )\n    ) {\n      newAmmo = this.loadedTorpedo;\n    } else if (possibleNewTorpedos.length > 0) {\n      newAmmo = possibleNewTorpedos.pop();\n    }\n\n    this.loadedTorpedo = null;\n    this.turnsLoaded = 0;\n\n    if (newAmmo) {\n      this.receiveAmmoChange(newAmmo);\n    }\n    */\n\n    return [...previousResponse, result];\n  }\n\n  loadAmmo({ ammo, launcherIndex }) {\n    if (\n      launcherIndex !== this.launcherIndex ||\n      (this.loadedTorpedo &&\n        this.loadedTorpedo.constructor.name === ammo.constructor.name)\n    ) {\n      return;\n    }\n\n    const system = this.system.shipSystems\n      .getSystems()\n      .find(system => system.callHandler(\"hasCargo\", { object: ammo }, false));\n\n    system.callHandler(\"removeCargo\", { object: ammo });\n\n    if (this.loadedTorpedo) {\n      system.callHandler(\"addCargo\", { object: this.loadedTorpedo });\n    }\n\n    if (\n      this.previousTorpedo &&\n      this.previousTorpedo.constructor.name === ammo.constructor.name\n    ) {\n      this.loadedTorpedo = this.previousTorpedo;\n      this.turnsLoaded = this.previousTurnsLoaded;\n      this.changeAmmo = null;\n    } else {\n      if (!this.previousTorpedo) {\n        this.previousTorpedo = this.loadedTorpedo;\n        this.previousTurnsLoaded = this.turnsLoaded;\n      }\n\n      this.turnsLoaded = 0;\n      this.changeAmmo = {\n        ammo: ammo.constructor.name,\n        from: system.id\n      };\n      this.loadedTorpedo = ammo;\n    }\n\n    this.launchTarget = null;\n  }\n\n  getLoadedLaunchers(payload, previousResponse) {\n    if (this.turnsLoaded >= this.loadingTime && this.loadedTorpedo) {\n      return [...previousResponse, this];\n    }\n\n    return previousResponse;\n  }\n\n  receiveAmmoChange(changeAmmo) {\n    const ammo = new cargoClasses[changeAmmo.ammo]();\n\n    const cargoBay = this.system.shipSystems.getSystemById(changeAmmo.from);\n    if (!cargoBay.callHandler(\"hasCargo\", { object: ammo })) {\n      throw new Error(\n        `Trying to take cargo form ${cargoBay.id}, but no appropriate cargo found`\n      );\n    }\n\n    cargoBay.callHandler(\"removeCargo\", { object: ammo });\n\n    if (this.loadedTorpedo) {\n      cargoBay.callHandler(\"addCargo\", { object: this.loadedTorpedo });\n    }\n\n    this.loadedTorpedo = ammo;\n    this.turnsLoaded = 0;\n  }\n\n  receivePlayerData({ clientShip, clientSystem }) {\n    if (!clientSystem) {\n      return;\n    }\n\n    if (this.system.isDisabled()) {\n      return;\n    }\n\n    const clientStrategy = getThisStrategy(clientSystem, this.launcherIndex);\n    const changeAmmo = clientStrategy.changeAmmo;\n\n    if (changeAmmo) {\n      this.receiveAmmoChange(changeAmmo);\n    }\n\n    if (clientStrategy.launchTarget) {\n      if (this.turnsLoaded < this.loadingTime || !this.loadedTorpedo) {\n        throw new Error(\n          `Trying to set launch target, but weapon is not loaded`\n        );\n      }\n\n      this.launchTarget = clientStrategy.launchTarget;\n    }\n  }\n\n  getPossibleTorpedosToLoad() {\n    const ammo = [];\n    this.system.shipSystems.getSystems().forEach(system => {\n      const possibleAmmo = system.callHandler(\n        \"getCargoByParentClass\",\n        this.torpedoClass,\n        []\n      );\n\n      possibleAmmo.forEach(cargo => {\n        const entry = ammo.find(\n          ammoEntry =>\n            ammoEntry.object.constructor.name === cargo.object.constructor.name\n        );\n\n        if (entry) {\n          entry.amount += cargo.amount;\n        } else {\n          ammo.push({\n            object: cargo.object,\n            amount: cargo.amount\n          });\n        }\n      });\n    });\n\n    return ammo;\n  }\n\n  advanceTurn() {\n    this.changeAmmo = null;\n    this.previousTorpedo = null;\n    this.launchTarget = null;\n\n    if (this.system.isDisabled() || !this.loadedTorpedo) {\n      this.turnsLoaded = 0;\n      return;\n    }\n\n    this.turnsLoaded++;\n  }\n}\n\nconst getThisStrategy = (system, launcherIndex) => {\n  return system.strategies.find(\n    strategy =>\n      strategy instanceof TorpedoLauncherStrategy &&\n      strategy.launcherIndex === launcherIndex\n  );\n};\n\nexport default TorpedoLauncherStrategy;\n","import Weapon from \"../Weapon.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport Torpedo158 from \"../ammunition/torpedo/Torpedo158.mjs\";\r\nimport TorpedoLauncherStrategy from \"../../strategy/weapon/TorpedoLauncherStrategy.mjs\";\r\n\r\nclass TorpedoLauncher158 extends Weapon {\r\n  constructor(args) {\r\n    super(args, [new TorpedoLauncherStrategy(1, null, Torpedo158, 3)]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"1.53m torpedo launcher\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/missile1.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default TorpedoLauncher158;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport TorpedoLauncherStrategy from \"../../strategy/weapon/TorpedoLauncherStrategy.mjs\";\r\nimport Torpedo72 from \"../ammunition/torpedo/Torpedo72.mjs\";\r\n\r\nclass TorpedoLauncherDual72 extends Weapon {\r\n  constructor(args) {\r\n    super(args, [\r\n      new TorpedoLauncherStrategy(1, null, Torpedo72, 3),\r\n      new TorpedoLauncherStrategy(2, null, Torpedo72, 3)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"0.72m dual torpedo launcher\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/missile2.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default TorpedoLauncherDual72;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport Torpedo158 from \"../ammunition/torpedo/Torpedo158.mjs\";\r\nimport TorpedoLauncherStrategy from \"../../strategy/weapon/TorpedoLauncherStrategy.mjs\";\r\n\r\nclass TorpedoLauncherDual158 extends Weapon {\r\n  constructor(args) {\r\n    super(args, [\r\n      new TorpedoLauncherStrategy(1, null, Torpedo158, 3),\r\n      new TorpedoLauncherStrategy(2, null, Torpedo158, 3)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"1.53m dual torpedo launcher\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/missile2.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default TorpedoLauncherDual158;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport Torpedo158 from \"../ammunition/torpedo/Torpedo158.mjs\";\r\nimport TorpedoLauncherStrategy from \"../../strategy/weapon/TorpedoLauncherStrategy.mjs\";\r\n\r\nclass TorpedoLauncherQuadruple158 extends Weapon {\r\n  constructor(args) {\r\n    super(args, [\r\n      new TorpedoLauncherStrategy(1, null, Torpedo158, 3),\r\n      new TorpedoLauncherStrategy(2, null, Torpedo158, 3),\r\n      new TorpedoLauncherStrategy(3, null, Torpedo158, 3),\r\n      new TorpedoLauncherStrategy(4, null, Torpedo158, 3)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"4x 1.53m torpedo launcher\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/missile4.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default TorpedoLauncherQuadruple158;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport BurstDamageStrategy from \"../../strategy/weapon/BurstDamageStrategy.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\r\nimport InterceptorStrategy from \"../../strategy/weapon/InterceptorStrategy.mjs\";\r\nimport AmmunitionStrategy from \"../../strategy/weapon/AmmunitionStrategy.mjs\";\r\nimport { Ammo85mmAP, Ammo85mmHE } from \"../ammunition/conventional/index.mjs\";\r\nimport ArmorBoostOfflineSystemStrategy from \"../../strategy/ArmorBoostOfflineSystemStrategy.mjs\";\r\nimport FireOrderHeatStrategy from \"../../strategy/FireOrderHeatStrategy.mjs\";\r\n\r\nclass AutoCannon85mm extends Weapon {\r\n  constructor({ id }, arcs) {\r\n    super({ id, armor: 1, hitpoints: 6 }, [\r\n      new RequiresPowerSystemStrategy(2),\r\n      new FireOrderStrategy(1),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(20),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: 0 },\r\n        { range: 20, modifier: -20 },\r\n        { range: 50, modifier: -50 },\r\n        { range: 100, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(1),\r\n      new BurstDamageStrategy(null, null, 0, 3, 10),\r\n      new InterceptorStrategy(),\r\n      new AmmunitionStrategy([Ammo85mmAP, Ammo85mmHE], 3, 15, 6),\r\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\r\n        size: 8,\r\n        speed: 0.5,\r\n        color: [1.0, 0.7, 0.7],\r\n        explosionSize: 5\r\n      }),\r\n      new ArmorBoostOfflineSystemStrategy(3),\r\n      new FireOrderHeatStrategy(8)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"85mm Autocannon\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/lightParticleBeamShip.png\";\r\n  }\r\n}\r\n\r\nexport default AutoCannon85mm;\r\n","import TestWeapon from \"./TestWeapon.mjs\";\r\n\r\nimport * as coilguns from \"./coilgun/index.mjs\";\r\n\r\nimport PDC30mm from \"./pdc/PDC30mm.mjs\";\r\n\r\nimport * as railguns from \"./railgun/index.mjs\";\r\n\r\nimport * as launchers from \"./launcher/index.mjs\";\r\n\r\nimport AutoCannon85mm from \"./autocannon/AutoCannon85mm.mjs\";\r\n\r\nconst merged = {\r\n  TestWeapon,\r\n  PDC30mm,\r\n  ...coilguns,\r\n  ...railguns,\r\n  ...launchers,\r\n  AutoCannon85mm\r\n};\r\n\r\nexport default merged;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport {\r\n  RequiresPowerSystemStrategy,\r\n  LargerHitProfileOnlineSystemStrategy\r\n} from \"../strategy/index.mjs\";\r\nimport RadiateHeatStrategy from \"../strategy/RadiateHeatStrategy.mjs\";\r\nimport ArmorBoostOfflineSystemStrategy from \"../strategy/ArmorBoostOfflineSystemStrategy.mjs\";\r\nimport AlwaysTargetableSystemStrategy from \"../strategy/AlwaysTargetableSystemStrategy.mjs\";\r\n\r\nclass Radiator extends ShipSystem {\r\n  constructor(args, radiationCapacity = 40, extraProfile = 20, armorBoost = 5) {\r\n    super(args, [\r\n      new RequiresPowerSystemStrategy(1, false),\r\n      new LargerHitProfileOnlineSystemStrategy(extraProfile, extraProfile, 5),\r\n      new RadiateHeatStrategy(radiationCapacity),\r\n      new ArmorBoostOfflineSystemStrategy(armorBoost),\r\n      new AlwaysTargetableSystemStrategy(2)\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Radiator\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/radiator.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport default Radiator;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport StoreHeatStrategy from \"../strategy/StoreHeatStrategy.mjs\";\r\n\r\nclass HeatSink extends ShipSystem {\r\n  constructor(args, heatStorage) {\r\n    super(args, [new StoreHeatStrategy(heatStorage)]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"Heat sink\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/heatSink.png\";\r\n  }\r\n\r\n  getIconText() {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport default HeatSink;\r\n","import Radiator from \"./Radiator.mjs\";\r\n\r\nclass Radiator5x40 extends Radiator {\r\n  constructor({ id }) {\r\n    super({ id, hitpoints: 5, armor: 0 }, 10, 10, 5);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"5x40m radiator sail\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/radiator.png\";\r\n  }\r\n}\r\n\r\nexport default Radiator5x40;\r\n","import Radiator from \"./Radiator.mjs\";\r\n\r\nclass Radiator10x40 extends Radiator {\r\n  constructor({ id }) {\r\n    super({ id, hitpoints: 10, armor: 0 }, 20, 20, 6);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"10x40m radiator sail\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/radiator.png\";\r\n  }\r\n}\r\n\r\nexport default Radiator10x40;\r\n","import Radiator from \"./Radiator.mjs\";\r\n\r\nclass Radiator10x50 extends Radiator {\r\n  constructor({ id }) {\r\n    super({ id, hitpoints: 12, armor: 0 }, 24, 24, 6);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"10x50m radiator panels\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/radiator.png\";\r\n  }\r\n}\r\n\r\nexport default Radiator10x50;\r\n","import ShipSystem from \"../ShipSystem.mjs\";\r\nimport { CargoBaySystemStrategy } from \"../strategy/index.mjs\";\r\n\r\nclass CargoBay extends ShipSystem {\r\n  constructor(args, space) {\r\n    super(args, [new CargoBaySystemStrategy(space)]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return `Cargo bay ${this.callHandler(\"getTotalCargoSpace\")}m³`;\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/cargoBay.png\";\r\n  }\r\n}\r\n\r\nexport default CargoBay;\r\n","import * as thrusters from \"./thruster/index.mjs\";\r\nimport * as engines from \"./engine/index.mjs\";\r\nimport * as reactors from \"./reactor/index.mjs\";\r\nimport * as structures from \"./structure/index.mjs\";\r\nimport * as ewArrays from \"./electronicWarfare/index.mjs\";\r\nimport weapons from \"./weapon/index.mjs\";\r\nimport * as heat from \"./heat/index.mjs\";\r\nimport CargoBay from \"./cargo/CargoBay.mjs\";\r\n\r\nconst merged = {\r\n  ...thrusters,\r\n  ...engines,\r\n  ...reactors,\r\n  ...structures,\r\n  ...ewArrays,\r\n  ...weapons,\r\n  ...heat,\r\n  CargoBay\r\n};\r\n\r\nexport default merged;\r\n","import Ship from \"../../Ship.mjs\";\r\nimport systems from \"../../system/index.mjs\";\r\n\r\nclass UcRhino extends Ship {\r\n  constructor(data) {\r\n    super(data);\r\n\r\n    this.shipTypeName = 'Conley Shipyards RX11 \"Rhino\"';\r\n    this.shipModel = this.accelcost = 3;\r\n    this.rollcost = 3;\r\n    this.pivotcost = 3;\r\n    this.evasioncost = 3;\r\n\r\n    this.shipModel = \"Rhino\";\r\n    this.pointCost = 500;\r\n\r\n    this.systems.addFrontSystem([\r\n      new systems.ManeuveringThruster(\r\n        { id: 101, hitpoints: 10, armor: 3 },\r\n        3,\r\n        2\r\n      )\r\n    ]);\r\n\r\n    this.systems.addPrimarySystem([\r\n      new systems.Thruster({ id: 1, hitpoints: 10, armor: 3 }, 5, 0),\r\n      new systems.Thruster({ id: 2, hitpoints: 10, armor: 3 }, 5, 0),\r\n      new systems.Thruster({ id: 8, hitpoints: 10, armor: 3 }, 5, [1, 2]),\r\n      new systems.Thruster({ id: 9, hitpoints: 10, armor: 3 }, 5, [4, 5]),\r\n      new systems.Thruster({ id: 3, hitpoints: 10, armor: 3 }, 5, 3),\r\n      new systems.Thruster({ id: 4, hitpoints: 10, armor: 3 }, 5, 3),\r\n\r\n      new systems.Engine({ id: 5, hitpoints: 10, armor: 3 }, 12, 6, 2),\r\n      new systems.Engine({ id: 6, hitpoints: 10, armor: 3 }, 12, 6, 2),\r\n      new systems.Reactor({ id: 7, hitpoints: 10, armor: 3 }, 20),\r\n      new systems.Structure({ id: 11, hitpoints: 30, armor: 4 })\r\n    ]);\r\n\r\n    this.systems.addAftSystem([\r\n      new systems.ManeuveringThruster(\r\n        { id: 201, hitpoints: 10, armor: 3 },\r\n        3,\r\n        2\r\n      )\r\n    ]);\r\n  }\r\n}\r\n\r\nexport default UcRhino;\r\n","import Ship from \"../../Ship.mjs\";\r\nimport systems from \"../../system/index.mjs\";\r\nimport Offset from \"../../../hexagon/Offset.mjs\";\r\nimport Torpedo72MSV from \"../../system/weapon/ammunition/torpedo/Torpedo72MSV.mjs\";\r\nimport Torpedo158MSV from \"../../system/weapon/ammunition/torpedo/Torpedo158MSV.mjs\";\r\nimport Torpedo158Nuclear from \"../../system/weapon/ammunition/torpedo/Torpedo158Nuclear.mjs\";\r\nimport Ammo140mmAP from \"../../system/weapon/ammunition/conventional/Ammo140mmAP.mjs\";\r\nimport Ammo120mmAP from \"../../system/weapon/ammunition/conventional/Ammo120mmAP.mjs\";\r\nimport Ammo140mmHE from \"../../system/weapon/ammunition/conventional/Ammo140mmHE.mjs\";\r\nimport Ammo85mmAP from \"../../system/weapon/ammunition/conventional/Ammo85mmAP.mjs\";\r\nimport Ammo85mmHE from \"../../system/weapon/ammunition/conventional/Ammo85mmHE.mjs\";\r\nimport CargoService from \"../../../cargo/CargoService.mjs\";\r\nimport Ammo30mm from \"../../system/weapon/ammunition/conventional/Ammo30mm.mjs\";\r\nimport Torpedo72HE from \"../../system/weapon/ammunition/torpedo/Torpedo72HE.mjs\";\r\nimport Torpedo158MSV2 from \"../../system/weapon/ammunition/torpedo/Torpedo158MSV2.mjs\";\r\nimport Torpedo158HE from \"../../system/weapon/ammunition/torpedo/Torpedo158HE.mjs\";\r\n\r\nclass Haka extends Ship {\r\n  setShipProperties() {\r\n    this.shipTypeName = \"Haka XCD-33 Battleship\";\r\n    this.hexSizes = [\r\n      new Offset(2, 0),\r\n      new Offset(1, 0),\r\n      new Offset(0, 0),\r\n      new Offset(-1, 0)\r\n    ];\r\n    this.accelcost = 5;\r\n    this.rollcost = 18;\r\n    this.pivotcost = 10;\r\n    this.evasioncost = 10;\r\n    this.maxPivots = 1;\r\n\r\n    this.frontHitProfile = 70;\r\n    this.sideHitProfile = 160;\r\n\r\n    this.description = ``;\r\n\r\n    this.shipModel = \"Haka\";\r\n    this.pointCost = 500;\r\n\r\n    this.systems.addFrontSystem([\r\n      new systems.Thruster({ id: 103, hitpoints: 10, armor: 3 }, 5, 0),\r\n\r\n      new systems.RailgunTurreted140mmUC({ id: 118 }, { start: 210, end: 150 }),\r\n      new systems.RailgunTurreted140mmUC({ id: 119 }, { start: 210, end: 150 }),\r\n      new systems.Thruster({ id: 104, hitpoints: 10, armor: 3 }, 5, 0),\r\n\r\n      new systems.PDC30mm(\r\n        { id: 114, hitpoints: 5, armor: 3 },\r\n        { start: 200, end: 160 }\r\n      ),\r\n\r\n      new systems.PDC30mm(\r\n        { id: 115, hitpoints: 5, armor: 3 },\r\n        { start: 200, end: 160 }\r\n      ),\r\n\r\n      new systems.PDC30mm(\r\n        { id: 116, hitpoints: 5, armor: 3 },\r\n        { start: 200, end: 160 }\r\n      ),\r\n\r\n      new systems.PDC30mm(\r\n        { id: 117, hitpoints: 5, armor: 3 },\r\n        { start: 200, end: 160 }\r\n      ),\r\n\r\n      new systems.EwArray(\r\n        {\r\n          id: 120,\r\n          hitpoints: 10,\r\n          armor: 5,\r\n          boostable: false,\r\n          heat: 7,\r\n          power: 13\r\n        },\r\n        5\r\n      ),\r\n\r\n      new systems.OEWArray(\r\n        {\r\n          id: 121,\r\n          hitpoints: 10,\r\n          armor: 5,\r\n          boostable: false,\r\n          heat: 6,\r\n          power: 8\r\n        },\r\n        5\r\n      ),\r\n\r\n      new systems.Structure({\r\n        id: 111,\r\n        hitpoints: 80,\r\n        armor: 4,\r\n        cargoSpace: 400,\r\n        radiator: 15\r\n      })\r\n    ]);\r\n\r\n    this.systems.addPrimarySystem([\r\n      new systems.Engine({ id: 6, hitpoints: 20, armor: 5 }, 24, 6, 2),\r\n      new systems.Reactor({ id: 7, hitpoints: 10, armor: 8 }, 40),\r\n      new systems.Engine({ id: 4, hitpoints: 20, armor: 5 }, 24, 6, 2),\r\n      new systems.Reactor({ id: 5, hitpoints: 10, armor: 8 }, 40),\r\n      new systems.Structure({\r\n        id: 11,\r\n        hitpoints: 80,\r\n        armor: 6,\r\n        cargoSpace: 300,\r\n        heatStorage: 50\r\n      }),\r\n      new systems.EwArray({ id: 12, hitpoints: 25, armor: 6, heat: 10 }, 10),\r\n      new systems.HeatSink({ id: 13, hitpoints: 10, armor: 3 }, 100),\r\n      new systems.HeatSink({ id: 14, hitpoints: 10, armor: 3 }, 100)\r\n    ]);\r\n\r\n    this.systems.addStarboardFrontSystem([\r\n      new systems.Thruster({ id: 201, hitpoints: 10, armor: 3 }, 5, [1, 2]),\r\n\r\n      new systems.ManeuveringThrusterRight(\r\n        { id: 205, hitpoints: 10, armor: 3 },\r\n        10,\r\n        0\r\n      ),\r\n\r\n      new systems.RailgunTurreted2x140mm({ id: 202 }, { start: 345, end: 150 }),\r\n\r\n      new systems.TorpedoLauncherQuadruple158({\r\n        id: 210,\r\n        hitpoints: 15,\r\n        armor: 3\r\n      }),\r\n      new systems.TorpedoLauncherQuadruple158({\r\n        id: 211,\r\n        hitpoints: 15,\r\n        armor: 3\r\n      }),\r\n      new systems.TorpedoLauncherQuadruple158({\r\n        id: 212,\r\n        hitpoints: 15,\r\n        armor: 3\r\n      }),\r\n      new systems.TorpedoLauncherQuadruple158({\r\n        id: 213,\r\n        hitpoints: 15,\r\n        armor: 3\r\n      })\r\n    ]);\r\n\r\n    this.systems.addPortFrontSystem([\r\n      new systems.Structure({\r\n        id: 600,\r\n        hitpoints: 60,\r\n        armor: 7,\r\n        radiator: 15\r\n      }),\r\n\r\n      new systems.Thruster({ id: 601, hitpoints: 10, armor: 3 }, 5, [4, 5]),\r\n\r\n      new systems.MediumCoilcunTurretedUC({ id: 602 }, { start: 165, end: 0 }),\r\n\r\n      new systems.RailgunTurreted140mmUC(\r\n        { id: 603 },\r\n        { start: 195, end: 3.75 }\r\n      ),\r\n      new systems.RailgunTurreted140mmUC(\r\n        { id: 604 },\r\n        { start: 195, end: 3.75 }\r\n      ),\r\n\r\n      new systems.ManeuveringThrusterLeft(\r\n        { id: 605, hitpoints: 10, armor: 3 },\r\n        10,\r\n        0\r\n      ),\r\n\r\n      new systems.MediumCoilcunTurretedUC({ id: 606 }, { start: 210, end: 15 })\r\n    ]);\r\n\r\n    this.systems.addAftSystem([\r\n      new systems.Structure({\r\n        id: 411,\r\n        hitpoints: 80,\r\n        armor: 5,\r\n        heatStorage: 100,\r\n        radiator: 5\r\n      }),\r\n\r\n      new systems.PDC30mm({ id: 450 }, { start: 160, end: 340 }),\r\n\r\n      new systems.Thruster({ id: 432, hitpoints: 15, armor: 3 }, 8, 3),\r\n      new systems.Thruster({ id: 433, hitpoints: 15, armor: 3 }, 8, 3),\r\n\r\n      new systems.PDC30mm({ id: 451 }, { start: 40, end: 200 }),\r\n\r\n      new systems.PDC30mm({ id: 452 }, { start: 160, end: 340 }),\r\n      new systems.PDC30mm({ id: 453 }, { start: 160, end: 340 }),\r\n\r\n      new systems.PDC30mm({ id: 456 }, { start: 40, end: 200 }),\r\n      new systems.PDC30mm({ id: 457 }, { start: 40, end: 200 }),\r\n\r\n      new systems.PDC30mm({ id: 454 }, { start: 160, end: 340 }),\r\n      new systems.PDC30mm({ id: 455 }, { start: 40, end: 200 })\r\n    ]);\r\n\r\n    this.systems.addPortAftSystem([\r\n      new systems.Thruster({ id: 533, hitpoints: 15, armor: 3 }, 8, 3),\r\n      new systems.ManeuveringThrusterRight(\r\n        { id: 501, hitpoints: 10, armor: 3 },\r\n        10,\r\n        0\r\n      ),\r\n      new systems.Radiator10x50({ id: 502 }),\r\n      new systems.Radiator10x50({ id: 503 }),\r\n      new systems.PDC30mm({ id: 550 }, { start: 160, end: 340 }),\r\n      new systems.PDC30mm({ id: 551 }, { start: 160, end: 340 }),\r\n\r\n      new systems.PDC30mm({ id: 554 }, { start: 160, end: 340 }),\r\n      new systems.PDC30mm({ id: 555 }, { start: 160, end: 340 })\r\n    ]);\r\n\r\n    this.systems.addStarboardAftSystem([\r\n      new systems.ManeuveringThrusterLeft(\r\n        { id: 305, hitpoints: 10, armor: 3 },\r\n        10,\r\n        0\r\n      ),\r\n      new systems.Thruster({ id: 333, hitpoints: 15, armor: 3 }, 8, 3),\r\n      new systems.Radiator10x50({ id: 301 }),\r\n      new systems.Radiator10x50({ id: 302 }),\r\n      new systems.PDC30mm({ id: 352 }, { start: 40, end: 200 }),\r\n      new systems.PDC30mm({ id: 353 }, { start: 40, end: 200 }),\r\n      new systems.PDC30mm({ id: 356 }, { start: 40, end: 200 }),\r\n\r\n      new systems.PDC30mm({ id: 357 }, { start: 40, end: 200 })\r\n    ]);\r\n  }\r\n\r\n  setShipLoadout() {\r\n    super.setShipLoadout();\r\n\r\n    const cargoService = new CargoService();\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Torpedo158MSV(),\r\n      amount: 24\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Torpedo158MSV2(),\r\n      amount: 20\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Torpedo158HE(),\r\n      amount: 36\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Torpedo158Nuclear(),\r\n      amount: 6\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Ammo30mm(),\r\n      amount: 1700\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Ammo140mmAP(),\r\n      amount: 220\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Ammo140mmHE(),\r\n      amount: 550\r\n    });\r\n\r\n    const launchers = [\r\n      this.systems.getSystemById(210),\r\n      this.systems.getSystemById(211),\r\n      this.systems.getSystemById(212),\r\n      this.systems.getSystemById(213)\r\n    ];\r\n\r\n    launchers.forEach(system => {\r\n      system.callHandler(\"loadAmmoInstant\", {\r\n        ammo: new Torpedo158MSV(),\r\n        launcherIndex: 1\r\n      });\r\n      system.callHandler(\"loadAmmoInstant\", {\r\n        ammo: new Torpedo158MSV(),\r\n        launcherIndex: 2\r\n      });\r\n      system.callHandler(\"loadAmmoInstant\", {\r\n        ammo: new Torpedo158MSV2(),\r\n        launcherIndex: 3\r\n      });\r\n\r\n      system.callHandler(\"loadAmmoInstant\", {\r\n        ammo: new Torpedo158HE(),\r\n        launcherIndex: 4\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nexport default Haka;\r\n","import Ship from \"../../Ship.mjs\";\nimport systems from \"../../system/index.mjs\";\nimport Torpedo158MSV from \"../../system/weapon/ammunition/torpedo/Torpedo158MSV.mjs\";\nimport Torpedo72MSV from \"../../system/weapon/ammunition/torpedo/Torpedo72MSV.mjs\";\nimport Torpedo72HE from \"../../system/weapon/ammunition/torpedo/Torpedo72HE.mjs\";\n\nclass TestShip extends Ship {\n  setShipProperties() {\n    this.accelcost = 3;\n    this.rollcost = 3;\n    this.pivotcost = 3;\n    this.evasioncost = 3;\n\n    this.frontHitProfile = 100;\n    this.sideHitProfile = 100;\n\n    this.pointCost = 500;\n\n    this.systems.addFrontSystem([\n      new systems.TestWeapon({ id: 20, hitpoints: 6, armor: 2 }, [\n        { start: 0, end: 180 }\n      ]),\n      new systems.RailgunTurreted2x140mm({ id: 101, hitpoints: 6, armor: 2 }, [\n        { start: 0, end: 180 }\n      ]),\n      new systems.PDC30mm({ id: 102 }, [{ start: 0, end: 0 }]),\n      new systems.PDC30mm({ id: 103 }, [{ start: 0, end: 0 }])\n    ]);\n\n    this.systems.addPrimarySystem([\n      new systems.Thruster({ id: 1, hitpoints: 10, armor: 3 }, 5, 0),\n      new systems.Thruster({ id: 2, hitpoints: 10, armor: 3 }, 5, 0),\n      new systems.Thruster({ id: 8, hitpoints: 10, armor: 3 }, 5, [1, 2]),\n      new systems.Thruster({ id: 9, hitpoints: 10, armor: 3 }, 5, [4, 5]),\n      new systems.Thruster({ id: 3, hitpoints: 10, armor: 3 }, 5, 3),\n      new systems.Thruster({ id: 4, hitpoints: 10, armor: 3 }, 5, 3),\n      new systems.ManeuveringThruster(\n        { id: 10, hitpoints: 10, armor: 3 },\n        9,\n        3\n      ),\n      new systems.Engine({ id: 5, hitpoints: 10, armor: 3 }, 12, 6, 2),\n      new systems.Engine({ id: 6, hitpoints: 10, armor: 3 }, 12, 6, 2),\n      new systems.Reactor({ id: 7, hitpoints: 20, armor: 3 }, 28),\n      new systems.EwArray({ id: 11, hitpoints: 10, armor: 3 }, 10),\n      new systems.TorpedoLauncherDual158({ id: 202, hitpoints: 20, armor: 6 }),\n      new systems.TorpedoLauncherDual72({ id: 203, hitpoints: 20, armor: 6 }),\n      new systems.TorpedoLauncherDual72({ id: 206, hitpoints: 20, armor: 6 }),\n      new systems.CargoBay({ id: 204, hitpoints: 20, armor: 4 }, 500),\n      new systems.Structure({\n        id: 205,\n        hitpoints: 40,\n        armor: 5,\n        heatStorage: 200,\n        radiator: 5\n      })\n    ]);\n  }\n\n  setShipLoadout() {\n    super.setShipLoadout();\n\n    const cargoBay = this.systems.getSystemById(204);\n\n    cargoBay.callHandler(\"addCargo\", {\n      object: new Torpedo158MSV(),\n      amount: 14\n    });\n\n    cargoBay.callHandler(\"addCargo\", {\n      object: new Torpedo72MSV(),\n      amount: 14\n    });\n\n    this.systems.getSystemById(202).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo158MSV(),\n      launcherIndex: 1\n    });\n    this.systems.getSystemById(202).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo158MSV(),\n      launcherIndex: 2\n    });\n\n    this.systems.getSystemById(203).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72MSV(),\n      launcherIndex: 1\n    });\n    this.systems.getSystemById(203).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72MSV(),\n      launcherIndex: 2\n    });\n\n    this.systems.getSystemById(206).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72HE(),\n      launcherIndex: 1\n    });\n    this.systems.getSystemById(206).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72HE(),\n      launcherIndex: 2\n    });\n  }\n}\n\nexport default TestShip;\n","import Ship from \"../../Ship.mjs\";\nimport systems from \"../../system/index.mjs\";\nimport Offset from \"../../../hexagon/Offset.mjs\";\nimport Torpedo72MSV from \"../../system/weapon/ammunition/torpedo/Torpedo72MSV.mjs\";\nimport Torpedo158MSV from \"../../system/weapon/ammunition/torpedo/Torpedo158MSV.mjs\";\nimport Torpedo158Nuclear from \"../../system/weapon/ammunition/torpedo/Torpedo158Nuclear.mjs\";\nimport Ammo140mmAP from \"../../system/weapon/ammunition/conventional/Ammo140mmAP.mjs\";\nimport Ammo120mmAP from \"../../system/weapon/ammunition/conventional/Ammo120mmAP.mjs\";\nimport Ammo140mmHE from \"../../system/weapon/ammunition/conventional/Ammo140mmHE.mjs\";\nimport Ammo85mmAP from \"../../system/weapon/ammunition/conventional/Ammo85mmAP.mjs\";\nimport Ammo85mmHE from \"../../system/weapon/ammunition/conventional/Ammo85mmHE.mjs\";\nimport CargoService from \"../../../cargo/CargoService.mjs\";\nimport Ammo30mm from \"../../system/weapon/ammunition/conventional/Ammo30mm.mjs\";\nimport Torpedo72HE from \"../../system/weapon/ammunition/torpedo/Torpedo72HE.mjs\";\n\nclass Caliope extends Ship {\n  setShipProperties() {\n    this.shipTypeName = \"OuterLight Industries Caliope OI-E1 cruiser\";\n    this.hexSizes = [\n      new Offset(2, 0),\n      new Offset(1, 0),\n      new Offset(0, 0),\n      new Offset(-1, 0)\n    ];\n    this.accelcost = 3;\n    this.rollcost = 3;\n    this.pivotcost = 3;\n    this.evasioncost = 3;\n\n    this.description = `\n        Caliope cruiser was initially conceived with grandiose goals of including\n        battleship capabilities on cruiser tonnage class spaceframe. \n\n        First two Caliope A1 prototypes built by Patria Space were equipped with three Silverbreak 12 fusion engines,\n        two kinetic batteries, two light PDCs, three medium PDCs, two Hayfire 45MW railgun turrets and\n        eight 1.2m and two 3.5m missile tubes.  The spaceframes were built around and powered by \n        two Langban-Zukov class III fusion generators.\n\n        On field testing the new ships failed to meet the required specifications. The spaceframe turned out unable to\n        provide stable enough firing platform for the railgun turrets causing buildup of micro fractures\n        and resulting in subpar accuracy and reliability for the guns. Caliope was also found under armored for\n        fighting in the battleship class. \n\n        One of the prototypes where modified to Caliope A2 by substituting the railgun turrets with fixed mount railguns. \n        Filed testing of Caliope A2 showed the ship too unmanouverable to use the fixed railguns efficiently and this \n        modification failed to save the design.\n\n        Caliope project was abandoned as a failure, but subsequently aquired by OuterLight Industries when Patria Space \n        ran into finiancial difficulties. An experienced ship designed Markov Mohammed saw promise in the Caliope. \n\n        Caliope was repurposed to a long range cruiser by removing the railgun turrets. Freed space was used for extra\n        crew quarters, cargo and fuel space. The armor of the ship was reduced to gain much needed manouverability and\n        bring the spaceframe to safe structural stress levels. Abandoning the railguns left the ship with considerable\n        surplus of energy production and heat management capacity. This allowed the upgrade of the engines to more\n        powerful Silverbreak 15R model. Armament wise the new Caliope OI-B1 was equiped with four Maltech 210mm Twin kinetic\n        cannon turrets and seven 20mm Maltech PDCs. The missile launchers and magazines were left untouched.\n\n        These changes resulted in a ship considerably different from the initial design goals. First four Caliope OL-B3 cruisers\n        delivered to the Protectorate found great success in counter piracy role. Even tough Caliope is considered underarmored and\n        less than ideally manouverable for a mainstay cruiser, it can operate extended durations without resupply and it has an excellent\n        acceleration and heat management for extended chases. Perfect for running down pirates. Caliopes missile capabilities has\n        found use in fleet action as a missile picket ship. Caliopes engage in missile barrages but avoid close fighting. If \n        fleets close in, Caliopes are kept in reserve to chase down and finish damaged enemy vessels. Caliopes are also \n        suited to supplying smaller ships, altough more specialized ships can perform this role better.\n    `;\n\n    this.shipModel = \"Caliope\";\n    this.pointCost = 500;\n\n    this.systems.addFrontSystem([\n      new systems.Thruster({ id: 103, hitpoints: 10, armor: 3 }, 5, 0),\n      new systems.PDC30mm(\n        { id: 114, hitpoints: 5, armor: 3 },\n        { start: 200, end: 160 }\n      ),\n\n      new systems.PDC30mm(\n        { id: 115, hitpoints: 5, armor: 3 },\n        { start: 200, end: 160 }\n      ),\n      new systems.Thruster({ id: 104, hitpoints: 10, armor: 3 }, 5, 0),\n      new systems.Structure({\n        id: 111,\n        hitpoints: 40,\n        armor: 5,\n        heatStorage: 20,\n        radiator: 3\n      }),\n\n      new systems.ManeuveringThruster(\n        { id: 101, hitpoints: 10, armor: 3 },\n        3,\n        2\n      )\n    ]);\n\n    this.systems.addPrimarySystem([\n      new systems.Engine({ id: 6, hitpoints: 20, armor: 5 }, 24, 6, 2),\n      new systems.Reactor({ id: 7, hitpoints: 10, armor: 8 }, 20),\n      new systems.Structure({\n        id: 11,\n        hitpoints: 60,\n        armor: 4,\n        cargoSpace: 300,\n        heatStorage: 80,\n        radiator: 15\n      }),\n      new systems.EwArray({ id: 12, hitpoints: 15, armor: 6 }, 8),\n      new systems.HeatSink({ id: 13, hitpoints: 10, armor: 3 }, 100)\n    ]);\n\n    this.systems.addStarboardFrontSystem([\n      new systems.Thruster({ id: 201, hitpoints: 10, armor: 3 }, 5, [1, 2]),\n\n      new systems.RailgunTurreted2x140mm(\n        { id: 213, hitpoints: 8, armor: 4 },\n        { start: 330, end: 90 }\n      ),\n      new systems.PDC30mm(\n        { id: 202, hitpoints: 4, armor: 3 },\n        { start: 0, end: 180 }\n      ),\n      new systems.AutoCannon85mm(\n        { id: 203, hitpoints: 6, armor: 3 },\n        { start: 330, end: 160 }\n      ),\n      new systems.AutoCannon85mm(\n        { id: 204, hitpoints: 6, armor: 3 },\n        { start: 330, end: 160 }\n      )\n    ]);\n\n    this.systems.addPortFrontSystem([\n      new systems.RailgunTurreted2x140mm(\n        { id: 612, hitpoints: 8, armor: 4 },\n        { start: 270, end: 30 }\n      ),\n      new systems.Thruster({ id: 601, hitpoints: 10, armor: 3 }, 5, [4, 5]),\n\n      new systems.AutoCannon85mm(\n        { id: 603, hitpoints: 6, armor: 3 },\n        { start: 200, end: 30 }\n      ),\n      new systems.PDC30mm(\n        { id: 602, hitpoints: 4, armor: 3 },\n        { start: 180, end: 0 }\n      ),\n      new systems.AutoCannon85mm(\n        { id: 604, hitpoints: 6, armor: 3 },\n        { start: 200, end: 30 }\n      )\n    ]);\n\n    this.systems.addAftSystem([\n      new systems.ManeuveringThruster(\n        { id: 401, hitpoints: 10, armor: 3 },\n        3,\n        2\n      ),\n\n      new systems.Thruster({ id: 431, hitpoints: 15, armor: 3 }, 8, 3),\n      new systems.Thruster({ id: 432, hitpoints: 15, armor: 3 }, 8, 3),\n      new systems.Thruster({ id: 433, hitpoints: 15, armor: 3 }, 8, 3),\n\n      new systems.Structure({\n        id: 411,\n        hitpoints: 80,\n        armor: 4,\n        heatStorage: 100,\n        radiator: 5\n      }),\n      new systems.Radiator10x40({ id: 412, hitpoints: 10, armor: 3 }),\n      new systems.Reactor({ id: 407, hitpoints: 10, armor: 3 }, 30),\n      new systems.AutoCannon85mm(\n        { id: 421, hitpoints: 6, armor: 3 },\n        { start: 0, end: 0 }\n      )\n    ]);\n\n    this.systems.addPortAftSystem([\n      new systems.Radiator10x40({ id: 501 }),\n      new systems.CargoBay({ id: 502, hitpoints: 20, armor: 4 }, 150),\n      new systems.TorpedoLauncher158({ id: 503, hitpoints: 10, armor: 4 }),\n      new systems.TorpedoLauncherDual72({ id: 504, hitpoints: 10, armor: 4 }),\n      new systems.AutoCannon85mm(\n        { id: 521, hitpoints: 6, armor: 3 },\n        { start: 160, end: 30 }\n      )\n    ]);\n\n    this.systems.addStarboardAftSystem([\n      new systems.Radiator10x40({ id: 301 }),\n      new systems.CargoBay({ id: 302, hitpoints: 20, armor: 4 }, 150),\n      new systems.TorpedoLauncher158({ id: 303, hitpoints: 10, armor: 4 }),\n      new systems.TorpedoLauncherDual72({ id: 304, hitpoints: 10, armor: 4 }),\n      new systems.AutoCannon85mm(\n        { id: 321, hitpoints: 6, armor: 3 },\n        { start: 330, end: 200 }\n      )\n    ]);\n  }\n\n  setShipLoadout() {\n    super.setShipLoadout();\n\n    const cargoService = new CargoService();\n    cargoService.divideCargo(this, {\n      object: new Torpedo72MSV(),\n      amount: 12\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Torpedo72HE(),\n      amount: 12\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Torpedo158MSV(),\n      amount: 12\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Torpedo158Nuclear(),\n      amount: 2\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Ammo30mm(),\n      amount: 800\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Ammo140mmAP(),\n      amount: 40\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Ammo140mmHE(),\n      amount: 80\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Ammo85mmAP(),\n      amount: 200\n    });\n\n    cargoService.divideCargo(this, {\n      object: new Ammo85mmHE(),\n      amount: 400\n    });\n\n    this.systems.getSystemById(303).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo158MSV(),\n      launcherIndex: 1\n    });\n    this.systems.getSystemById(503).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo158MSV(),\n      launcherIndex: 1\n    });\n\n    this.systems.getSystemById(304).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72MSV(),\n      launcherIndex: 1\n    });\n    this.systems.getSystemById(304).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72HE(),\n      launcherIndex: 2\n    });\n\n    this.systems.getSystemById(504).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72MSV(),\n      launcherIndex: 1\n    });\n    this.systems.getSystemById(504).callHandler(\"loadAmmoInstant\", {\n      ammo: new Torpedo72HE(),\n      launcherIndex: 2\n    });\n  }\n}\n\nexport default Caliope;\n","import Ship from \"../../Ship.mjs\";\r\nimport systems from \"../../system/index.mjs\";\r\nimport Offset from \"../../../hexagon/Offset.mjs\";\r\nimport { RailgunTurreted32gw } from \"../../system/weapon/coilgun/index.mjs\";\r\n\r\nclass Mouros extends Ship {\r\n  setShipProperties() {\r\n    this.shipTypeName =\r\n      \"OuterLight Industries Mouros 118-A mainstay battleship\";\r\n    this.accelcost = 3;\r\n    this.rollcost = 3;\r\n    this.pivotcost = 3;\r\n    this.evasioncost = 3;\r\n    this.hexSizes = [\r\n      new Offset(-2, 0),\r\n      new Offset(-1, 0),\r\n      new Offset(0, 0),\r\n      new Offset(1, 0),\r\n      new Offset(2, 0),\r\n      new Offset(3, 0)\r\n      /*\r\n      new Offset(1, 1),\r\n      new Offset(2, 1),\r\n      new Offset(1, -1),\r\n      new Offset(2, -1),\r\n      new Offset(-1, 1),\r\n      new Offset(-0, 1),\r\n      new Offset(-1, -1),\r\n      new Offset(-0, -1)\r\n      */\r\n    ];\r\n\r\n    this.description = ``;\r\n\r\n    this.shipModel = \"Mouros\";\r\n    this.pointCost = 500;\r\n\r\n    this.systems.addFrontSystem([\r\n      new systems.ManeuveringThruster(\r\n        { id: 101, hitpoints: 10, armor: 3 },\r\n        3,\r\n        2\r\n      ),\r\n\r\n      new systems.Structure({ id: 102, hitpoints: 40, armor: 6 })\r\n    ]);\r\n\r\n    this.systems.addPrimarySystem([\r\n      new systems.Thruster({ id: 1, hitpoints: 10, armor: 3 }, 5, 0),\r\n      new systems.Thruster({ id: 2, hitpoints: 10, armor: 3 }, 5, 0),\r\n\r\n      new systems.EwArray({ id: 12, hitpoints: 30, armor: 4 }, 8),\r\n\r\n      new systems.Engine({ id: 5, hitpoints: 10, armor: 7 }, 10, 6, 2),\r\n      new systems.Reactor({ id: 7, hitpoints: 10, armor: 3 }, 20),\r\n      new systems.Structure({ id: 11, hitpoints: 50, armor: 5 })\r\n    ]);\r\n\r\n    this.systems.addAftSystem([\r\n      new systems.ManeuveringThruster(\r\n        { id: 201, hitpoints: 10, armor: 3 },\r\n        3,\r\n        2\r\n      ),\r\n\r\n      new systems.Engine({ id: 206, hitpoints: 20, armor: 7 }, 15, 6, 2),\r\n      new systems.Thruster({ id: 203, hitpoints: 10, armor: 3 }, 5, 3),\r\n      new systems.Thruster({ id: 204, hitpoints: 10, armor: 3 }, 5, 3),\r\n      new systems.Structure({ id: 202, hitpoints: 80, armor: 4 })\r\n    ]);\r\n\r\n    this.systems.addStarboardAftSystem([\r\n      new RailgunTurreted32gw(\r\n        { id: 301, hitpoints: 10, armor: 3 },\r\n        { start: 0, end: 183 }\r\n      ),\r\n\r\n      new systems.Thruster({ id: 308, hitpoints: 10, armor: 3 }, 5, [1, 2])\r\n    ]);\r\n\r\n    this.systems.addPortAftSystem([\r\n      new RailgunTurreted32gw(\r\n        { id: 501, hitpoints: 10, armor: 3 },\r\n        { start: 177, end: 0 }\r\n      ),\r\n\r\n      new systems.Thruster({ id: 508, hitpoints: 10, armor: 3 }, 5, [4, 5])\r\n    ]);\r\n  }\r\n}\r\n\r\nexport default Mouros;\r\n","import Ship from \"../../Ship.mjs\";\r\nimport systems from \"../../system/index.mjs\";\r\nimport Offset from \"../../../hexagon/Offset.mjs\";\r\nimport Torpedo72MSV from \"../../system/weapon/ammunition/torpedo/Torpedo72MSV.mjs\";\r\nimport CargoService from \"../../../cargo/CargoService.mjs\";\r\nimport Ammo30mm from \"../../system/weapon/ammunition/conventional/Ammo30mm.mjs\";\r\nimport Ammo120mmAP from \"../../system/weapon/ammunition/conventional/Ammo120mmAP.mjs\";\r\nimport Ammo120mmHE from \"../../system/weapon/ammunition/conventional/Ammo120mmHE.mjs\";\r\n\r\nclass Fulcrum extends Ship {\r\n  setShipProperties() {\r\n    this.shipTypeName = \"Arakaki Systems Fulcrum IV fleet destroyer\";\r\n    this.accelcost = 2;\r\n    this.rollcost = 4;\r\n    this.pivotcost = 1;\r\n    this.evasioncost = 3;\r\n    this.hexSizes = [new Offset(1, 0), new Offset(0, 0), new Offset(-1, 0)];\r\n\r\n    this.description = `\r\n       Fulcrum was ordered to fill the role of a fleet destroyer. A ship that packs enough of a punch in \r\n       sufficiently armored frame to engage in front line fleet combat. The design requirements allowed\r\n       a considerable defieciency in endurance making the Fulcrum a ship that needs a supporting fleet\r\n       to operate in a meaningful role on a modern battlefield. \r\n\r\n       Arakaki Systems won the contract with the Fulcrum design. Fulcrum sacrifices endurance, \r\n       heat management and some speed to bring on a battlefield a destroyed armed with a spinal\r\n       mounted railgun, three kinetic cannons on a fixed bow mount, considerable six light PDCs \r\n       and a two missile launchers. All this in well armored spaceframe. \r\n\r\n       A squadron of Fulcrums can turn a battle if employed properly, but their role and \r\n       commitment must be well planned. A Fulcrum can function in a role of escort, rail gun attack craft\r\n       or close attack craft, but lack the endurance and heat management to keep up sustained railgun fire\r\n       or the manouvers needed in close quarters. This forces Fulcrums to disengage under fleet\r\n       protection to extends radiators or in extreme cases to resupply fuel and ammunition.\r\n\r\n       While the Fulcrum has a considerable PDC grid its missile capacity is greatly lacking for anything\r\n       else than defense or employment against unarmed or disabled targets. Fulcrums are also considered\r\n       undercrewed by many fleet standards. In combat operations the crew must work and live in cramped \r\n       conditions in extended shifts. Crew compliment does not include any marines, and the ship \r\n       deck plan is not optimized for repeling boarders, nor does it have any capacity for holding prisoners.\r\n\r\n       Regardless of this long list of deficiencies, a Fulcrum can employ a combination of superior\r\n       weaponry and manouverability to create an engagement where Fulcrum can effectively either \r\n       out range or out gun its opponent. In close quarter battle a Fulcrum can engage an opponent\r\n       and with superior armor still disengage with neglible damage to critical systems.\r\n    `;\r\n\r\n    this.shipModel = \"Fulcrum\";\r\n    this.pointCost = 500;\r\n\r\n    this.systems.addFrontSystem([\r\n      new systems.Structure({\r\n        id: 100,\r\n        hitpoints: 30,\r\n        armor: 5,\r\n        heatStorage: 30\r\n      }),\r\n\r\n      new systems.CoilgunLightFixed({ id: 102 }, { start: 330, end: 30 }),\r\n      new systems.RailgunFixed120mm({ id: 103 }, { start: 330, end: 30 }),\r\n      new systems.RailgunFixed120mm({ id: 104 }, { start: 330, end: 30 }),\r\n      new systems.RailgunFixed120mm({ id: 105 }, { start: 330, end: 30 }),\r\n\r\n      new systems.Thruster({ id: 106, hitpoints: 10, armor: 3 }, 3, 0),\r\n      new systems.Thruster({ id: 107, hitpoints: 10, armor: 3 }, 3, 0),\r\n      new systems.ManeuveringThruster(\r\n        { id: 101, hitpoints: 10, armor: 3 },\r\n        3,\r\n        2\r\n      ),\r\n      new systems.TorpedoLauncherDual72({ id: 108, hitpoints: 10, armor: 4 })\r\n    ]);\r\n\r\n    this.systems.addPrimarySystem([\r\n      new systems.EwArray({ id: 12, hitpoints: 12, armor: 6 }, 7, 5),\r\n\r\n      new systems.Reactor({ id: 7, hitpoints: 15, armor: 7 }, 35),\r\n      new systems.Structure({\r\n        id: 11,\r\n        hitpoints: 30,\r\n        armor: 6,\r\n        cargoSpace: 100,\r\n        heatStorage: 70,\r\n        radiator: 5\r\n      }),\r\n\r\n      new systems.PDC30mm(\r\n        { id: 14, alwaysTargetable: true },\r\n        { start: 0, end: 0 }\r\n      )\r\n    ]);\r\n\r\n    this.systems.addAftSystem([\r\n      new systems.Structure({\r\n        id: 200,\r\n        hitpoints: 40,\r\n        armor: 6,\r\n        heatStorage: 20,\r\n        radiator: 10\r\n      }),\r\n\r\n      new systems.Engine({ id: 202, hitpoints: 20, armor: 3 }, 14, 6, 2),\r\n      new systems.ManeuveringThruster(\r\n        { id: 201, hitpoints: 10, armor: 3 },\r\n        3,\r\n        2\r\n      ),\r\n      new systems.Thruster({ id: 203, hitpoints: 15, armor: 3 }, 21, 3),\r\n\r\n      new systems.PDC30mm(\r\n        { id: 214, alwaysTargetable: true },\r\n        { start: 0, end: 0 }\r\n      ),\r\n\r\n      new systems.Radiator5x40({ id: 316 }),\r\n      new systems.CargoBay({ id: 317, hitpoints: 10, armor: 4 }, 100)\r\n    ]);\r\n\r\n    this.systems.addStarboardFrontSystem([\r\n      new systems.PDC30mm(\r\n        { id: 15, hitpoints: 5, armor: 3 },\r\n        { start: 0, end: 180 }\r\n      )\r\n    ]);\r\n\r\n    this.systems.addStarboardAftSystem([\r\n      new systems.PDC30mm(\r\n        { id: 215, hitpoints: 5, armor: 3 },\r\n        { start: 0, end: 180 }\r\n      ),\r\n\r\n      new systems.Radiator5x40({ id: 216 })\r\n    ]);\r\n\r\n    this.systems.addPortFrontSystem([\r\n      new systems.PDC30mm(\r\n        { id: 13, hitpoints: 5, armor: 3 },\r\n        { start: 180, end: 0 }\r\n      )\r\n    ]);\r\n\r\n    this.systems.addPortAftSystem([\r\n      new systems.PDC30mm(\r\n        { id: 213, hitpoints: 5, armor: 3 },\r\n        { start: 180, end: 0 }\r\n      ),\r\n\r\n      new systems.Radiator5x40({ id: 416 })\r\n    ]);\r\n  }\r\n\r\n  setShipLoadout() {\r\n    super.setShipLoadout();\r\n\r\n    const cargoService = new CargoService();\r\n    cargoService.divideCargo(this, {\r\n      object: new Torpedo72MSV(),\r\n      amount: 12\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Ammo30mm(),\r\n      amount: 120\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Ammo120mmAP(),\r\n      amount: 20\r\n    });\r\n\r\n    cargoService.divideCargo(this, {\r\n      object: new Ammo120mmHE(),\r\n      amount: 20\r\n    });\r\n\r\n    this.systems.getSystemById(108).callHandler(\"loadAmmoInstant\", {\r\n      ammo: new Torpedo72MSV(),\r\n      launcherIndex: 1\r\n    });\r\n    this.systems.getSystemById(108).callHandler(\"loadAmmoInstant\", {\r\n      ammo: new Torpedo72MSV(),\r\n      launcherIndex: 2\r\n    });\r\n  }\r\n}\r\n\r\nexport default Fulcrum;\r\n","import Weapon from \"../Weapon.mjs\";\r\nimport FireOrderStrategy from \"../../strategy/weapon/FireOrderStrategy.mjs\";\r\nimport WeaponArcStrategy from \"../../strategy/weapon/WeaponArcStrategy.mjs\";\r\nimport StandardHitStrategy from \"../../strategy/weapon/StandardHitStrategy.mjs\";\r\nimport StandardRangeStrategy from \"../../strategy/weapon/StandardRangeStrategy.mjs\";\r\nimport StandardLoadingStrategy from \"../../strategy/weapon/StandardLoadingStrategy.mjs\";\r\nimport BurstDamageStrategy from \"../../strategy/weapon/BurstDamageStrategy.mjs\";\r\nimport RequiresPowerSystemStrategy from \"../../strategy/RequiresPowerSystemStrategy.mjs\";\r\nimport WeaponAnimationStrategy from \"../../strategy/weapon/WeaponAnimationStrategy.mjs\";\r\nimport InterceptorStrategy from \"../../strategy/weapon/InterceptorStrategy.mjs\";\r\nimport { Ammo30mm } from \"../ammunition/conventional/index.mjs\";\r\nimport AmmunitionStrategy from \"../../strategy/weapon/AmmunitionStrategy.mjs\";\r\n\r\nclass X2PDC30mm extends Weapon {\r\n  constructor(args, arcs) {\r\n    super(args, [\r\n      new RequiresPowerSystemStrategy(2),\r\n      new FireOrderStrategy(2),\r\n      new WeaponArcStrategy(arcs),\r\n      new StandardHitStrategy(30),\r\n      new StandardRangeStrategy([\r\n        { range: 0, modifier: 0 },\r\n        { range: 10, modifier: -20 },\r\n        { range: 15, modifier: -50 },\r\n        { range: 18, modifier: -100 },\r\n        { range: 20, modifier: -200 }\r\n      ]),\r\n      new StandardLoadingStrategy(1),\r\n      new BurstDamageStrategy(\"d2\", \"d3+2\", 0, 6, 5),\r\n      new InterceptorStrategy(2),\r\n      new AmmunitionStrategy([Ammo30mm], 6, 36, 12),\r\n      new WeaponAnimationStrategy(\"UniversalBolt\", {\r\n        size: 6,\r\n        speed: 0.35,\r\n        color: [1.0, 0.8, 0.4],\r\n        shots: 6\r\n      })\r\n    ]);\r\n  }\r\n\r\n  getDisplayName() {\r\n    return \"2x30mm PDC\";\r\n  }\r\n\r\n  getBackgroundImage() {\r\n    return \"/img/system/gatlingPulseCannon.png\";\r\n  }\r\n}\r\n\r\nexport default X2PDC30mm;\r\n","import Ship from \"../../Ship.mjs\";\r\nimport systems from \"../../system/index.mjs\";\r\nimport Offset from \"../../../hexagon/Offset.mjs\";\r\nimport { X2PDC30mm } from \"../../system/weapon/pdc/index.mjs\";\r\nimport { RailgunTurreted64gw } from \"../../system/weapon/coilgun/index.mjs\";\r\nimport Torpedo158MSV from \"../../system/weapon/ammunition/torpedo/Torpedo158MSV.mjs\";\r\nimport Torpedo158Nuclear from \"../../system/weapon/ammunition/torpedo/Torpedo158Nuclear.mjs\";\r\n\r\nclass Impetous extends Ship {\r\n  setShipProperties() {\r\n    this.shipTypeName = \"Impetous\";\r\n    this.accelcost = 3;\r\n    this.rollcost = 3;\r\n    this.pivotcost = 3;\r\n    this.evasioncost = 3;\r\n    this.hexSizes = [\r\n      new Offset(3, 0),\r\n      new Offset(2, 0),\r\n      new Offset(1, 0),\r\n      new Offset(0, 0),\r\n      new Offset(-1, 0),\r\n      new Offset(-2, 0),\r\n      new Offset(-3, 0),\r\n      new Offset(-4, 0),\r\n      new Offset(3, 1),\r\n      new Offset(2, 1),\r\n      new Offset(1, 1),\r\n      new Offset(0, 1),\r\n      new Offset(-1, 1),\r\n      new Offset(-2, 1),\r\n      new Offset(-3, 1),\r\n      new Offset(3, -1),\r\n      new Offset(2, -1),\r\n      new Offset(1, -1),\r\n      new Offset(0, -1),\r\n      new Offset(-1, -1),\r\n      new Offset(-2, -1),\r\n      new Offset(-3, -1)\r\n    ];\r\n\r\n    this.description = ``;\r\n\r\n    this.shipModel = \"Impetous\";\r\n    this.pointCost = 500;\r\n\r\n    this.systems.addFrontSystem([\r\n      new systems.ManeuveringThruster({ id: 1, hitpoints: 10, armor: 3 }, 3, 2),\r\n      new systems.Structure({ id: 100, hitpoints: 90, armor: 5 })\r\n    ]);\r\n\r\n    this.systems.addPrimarySystem([\r\n      new systems.Thruster({ id: 601, hitpoints: 10, armor: 3 }, 5, 0),\r\n      new systems.Thruster({ id: 602, hitpoints: 10, armor: 3 }, 5, 0),\r\n      new systems.Thruster({ id: 603, hitpoints: 10, armor: 3 }, 5, 3),\r\n      new systems.Thruster({ id: 604, hitpoints: 10, armor: 3 }, 5, 3),\r\n\r\n      new systems.EwArray({ id: 612, hitpoints: 30, armor: 4 }, 8),\r\n\r\n      new systems.Engine({ id: 605, hitpoints: 10, armor: 3 }, 12, 6, 2),\r\n      new systems.Engine({ id: 606, hitpoints: 10, armor: 3 }, 12, 6, 2),\r\n      new systems.Reactor({ id: 607, hitpoints: 10, armor: 3 }, 20),\r\n      new systems.Structure({ id: 611, hitpoints: 75, armor: 6 }),\r\n\r\n      new RailgunTurreted64gw({ id: 613, hitpoints: 20, armor: 3 }, [\r\n        { start: 30, end: 150 },\r\n        { start: 210, end: 330 }\r\n      ]),\r\n      new RailgunTurreted64gw({ id: 614, hitpoints: 20, armor: 3 }, [\r\n        { start: 30, end: 150 },\r\n        { start: 210, end: 330 }\r\n      ])\r\n    ]);\r\n\r\n    this.systems.addAftSystem([\r\n      new systems.ManeuveringThruster(\r\n        { id: 201, hitpoints: 10, armor: 3 },\r\n        3,\r\n        2\r\n      ),\r\n\r\n      new systems.TorpedoLauncherDual158({ id: 202, hitpoints: 20, armor: 6 }),\r\n      new systems.TorpedoLauncherDual158({ id: 203, hitpoints: 20, armor: 6 }),\r\n      new systems.CargoBay({ id: 204, hitpoints: 20, armor: 4 }, 500),\r\n      new systems.Structure({ id: 200, hitpoints: 90, armor: 5 })\r\n    ]);\r\n\r\n    this.systems.addStarboardFrontSystem([\r\n      new X2PDC30mm(\r\n        { id: 101, hitpoints: 5, armor: 3 },\r\n        { start: 0, end: 180 }\r\n      ),\r\n      new X2PDC30mm(\r\n        { id: 102, hitpoints: 5, armor: 3 },\r\n        { start: 0, end: 180 }\r\n      ),\r\n      new X2PDC30mm(\r\n        { id: 103, hitpoints: 5, armor: 3 },\r\n        { start: 0, end: 180 }\r\n      ),\r\n\r\n      new systems.Thruster({ id: 104, hitpoints: 10, armor: 3 }, 5, [1, 2])\r\n    ]);\r\n\r\n    this.systems.addPortFrontSystem([\r\n      new X2PDC30mm(\r\n        { id: 501, hitpoints: 5, armor: 3 },\r\n        { start: 180, end: 0 }\r\n      ),\r\n      new X2PDC30mm(\r\n        { id: 502, hitpoints: 5, armor: 3 },\r\n        { start: 180, end: 0 }\r\n      ),\r\n      new X2PDC30mm(\r\n        { id: 503, hitpoints: 5, armor: 3 },\r\n        { start: 180, end: 0 }\r\n      ),\r\n\r\n      new systems.Thruster({ id: 504, hitpoints: 10, armor: 3 }, 5, [4, 5])\r\n    ]);\r\n  }\r\n\r\n  setShipLoadout() {\r\n    super.setShipLoadout();\r\n    const cargoBay = this.systems.getSystemById(204);\r\n\r\n    cargoBay.callHandler(\"addCargo\", {\r\n      object: new Torpedo158MSV(),\r\n      amount: 14\r\n    });\r\n\r\n    cargoBay.callHandler(\"addCargo\", {\r\n      object: new Torpedo158Nuclear(),\r\n      amount: 2\r\n    });\r\n\r\n    this.systems.getSystemById(202).callHandler(\"loadAmmoInstant\", {\r\n      ammo: new Torpedo158MSV(),\r\n      launcherIndex: 1\r\n    });\r\n    this.systems.getSystemById(202).callHandler(\"loadAmmoInstant\", {\r\n      ammo: new Torpedo158MSV(),\r\n      launcherIndex: 2\r\n    });\r\n\r\n    this.systems.getSystemById(203).callHandler(\"loadAmmoInstant\", {\r\n      ammo: new Torpedo158MSV(),\r\n      launcherIndex: 1\r\n    });\r\n    this.systems.getSystemById(203).callHandler(\"loadAmmoInstant\", {\r\n      ammo: new Torpedo158MSV(),\r\n      launcherIndex: 2\r\n    });\r\n  }\r\n}\r\n\r\nexport default Impetous;\r\n","import * as Uc from \"./uc/index.mjs\";\r\nimport * as Test from \"./test/index.mjs\";\r\nimport * as Protectorate from \"./protectorate/index.mjs\";\r\nimport * as Federation from \"./federation/index.mjs\";\r\n\r\nconst merged = { ...Uc, ...Protectorate, ...Test, ...Federation };\r\nexport default merged;\r\n","import ships from \"./ships/index.mjs\";\r\n\r\nexport const createShipObject = data => {\r\n  const { shipClass } = data;\r\n\r\n  console.log(\"haka is \", new ships[\"Haka\"]());\r\n  console.log(\"ship class is \", shipClass);\r\n  if (!shipClass) {\r\n    throw new Error(\"Ship class missing, can not construct a ship\");\r\n  }\r\n\r\n  try {\r\n    return new ships[shipClass](data);\r\n  } catch (e) {\r\n    console.error(`Unable to construct ship of class \"${shipClass}\"`);\r\n    throw e;\r\n  }\r\n};\r\n\r\nexport const createBareShipObject = data => {\r\n  const { shipClass } = data;\r\n  if (!shipClass) {\r\n    throw new Error(\"Ship class missing, can not construct a ship\");\r\n  }\r\n\r\n  try {\r\n    return new ships[shipClass]();\r\n  } catch (e) {\r\n    console.error(`Unable to construct plain ship of class \"${shipClass}\"`);\r\n    throw e;\r\n  }\r\n};\r\n","import { createShipObject } from \"../unit/createShipObject.mjs\";\r\n\r\nclass GameShips {\r\n  constructor(gameData) {\r\n    this.gameData = gameData;\r\n    this.ships = [];\r\n  }\r\n\r\n  isSameTeam(shipA, shipB) {\r\n    return (\r\n      this.gameData.slots.getTeamForShip(shipA) ===\r\n      this.gameData.slots.getTeamForShip(shipB)\r\n    );\r\n  }\r\n\r\n  addShip(ship) {\r\n    if (ship.id && this.getShipById(ship.id)) {\r\n      throw new Error(\"Duplicate ship id added to gamedata\");\r\n    }\r\n\r\n    this.ships.push(ship);\r\n    return this;\r\n  }\r\n\r\n  getShips() {\r\n    return this.ships;\r\n  }\r\n\r\n  getAliveShips() {\r\n    return this.ships.filter(ship => !ship.isDestroyed());\r\n  }\r\n\r\n  getShipById(id) {\r\n    return this.ships.find(ship => ship.id === id);\r\n  }\r\n\r\n  getUsersShips(user) {\r\n    return this.ships.filter(ship => ship.player.isUsers(user));\r\n  }\r\n\r\n  getShipsInSameTeam(user) {\r\n    const slot = this.gameData.slots.getUsersSlots(user);\r\n    if (!slot) {\r\n      return [];\r\n    }\r\n    const team = slot.pop().team;\r\n\r\n    return this.ships.filter(\r\n      ship => this.gameData.slots.getSlotByShip(ship).team === team\r\n    );\r\n  }\r\n\r\n  getShipsEnemyTeams(user) {\r\n    const teamShips = this.getShipsInSameTeam(user);\r\n\r\n    return this.ships.filter(ship => !teamShips.includes(ship));\r\n  }\r\n\r\n  serialize() {\r\n    return this.ships.map(ship => ship.serialize());\r\n  }\r\n\r\n  deserialize(ships = []) {\r\n    console.log(\"deserialize\");\r\n    this.ships = ships.map(shipData => {\r\n      console.log(shipData);\r\n      return createShipObject(shipData);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  setShipLoadouts() {\r\n    this.getShips().forEach(ship => ship.setShipLoadout());\r\n  }\r\n}\r\n\r\nexport default GameShips;\r\n","class GameActiveShips {\r\n  constructor(gameData) {\r\n    this.gameData = gameData;\r\n    this.shipIds = [];\r\n  }\r\n\r\n  isActive(ship) {\r\n    return this.shipIds.includes(ship.id);\r\n  }\r\n\r\n  setActive(ship) {\r\n    if (this.isActive(ship)) {\r\n      return;\r\n    }\r\n\r\n    this.shipIds.push(ship.id);\r\n  }\r\n\r\n  setInactive(ship) {\r\n    this.shipIds = this.shipIds.filter(id => id !== ship.id);\r\n  }\r\n\r\n  serialize() {\r\n    return this.shipIds;\r\n  }\r\n\r\n  deserialize(data = []) {\r\n    this.shipIds = data;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default GameActiveShips;\r\n","import Vector from \"../../model/utils/Vector.mjs\";\r\nconst TERRAIN_TYPE_SUN = \"sun\";\r\n\r\nclass GameTerrainEntity {\r\n  constructor(data) {\r\n    this.deserialize(data);\r\n  }\r\n\r\n  getGravityVector(position) {\r\n    const distance = position.distanceTo(this.position);\r\n    const actualGravity = this.gravity / Math.pow(distance, 2);\r\n\r\n    const gravityVector = this.position\r\n      .sub(position)\r\n      .normalize()\r\n      .multiplyScalar(actualGravity);\r\n\r\n    return gravityVector;\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.id = data.id || null;\r\n    this.type = data.type || TERRAIN_TYPE_SUN;\r\n    this.mass = 10000000000; // data.mass || 1000000000;\r\n    this.position = new Vector(data.position);\r\n    this.velocity = new Vector(data.velocity);\r\n    this.diameter = 7; // data.diameter || 1;\r\n    this.radius = this.affectedByGravity = this.type !== TERRAIN_TYPE_SUN;\r\n\r\n    return this;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      id: this.id,\r\n      type: this.type,\r\n      position: this.position,\r\n      velocity: this.velocity,\r\n      radius: this.diameter,\r\n      mass: this.mass\r\n    };\r\n  }\r\n}\r\n\r\nexport default GameTerrainEntity;\r\n","import Vector from \"./Vector.mjs\";\r\nimport THREE from \"three\";\r\n\r\nconst a = [\r\n  [0, 0, 0, 0, 0],\r\n  [1 / 4, 0, 0, 0, 0],\r\n  [3 / 32, 9 / 32, 0, 0, 0],\r\n  [1932 / 2197, -7200 / 2197, 7296 / 2197, 0, 0],\r\n  [439 / 216, -8, 3680 / 513, -845 / 4104, 0],\r\n  [-8 / 27, 2, -3544 / 2565, 1859 / 4104, -11 / 40]\r\n];\r\n\r\nconst bs = [16 / 135, 0, 6656 / 12825, 28561 / 56430, -9 / 50, 2 / 55];\r\n\r\nconst bsx = [25 / 216, 0, 1408 / 2565, 2197 / 4104, -1 / 5, 0];\r\n\r\nconst getCacheKey = (stage, arkFunction) => arkFunction + stage;\r\n\r\nclass ARKStep {\r\n  constructor(position, velocity, parentPosition, parentMass, dt) {\r\n    this.setValues(position, velocity, parentPosition, parentMass, dt);\r\n  }\r\n\r\n  derivativeVelocityX(position) {\r\n    const r = this.parentPosition.sub(position);\r\n    return (this.parentMass / Math.pow(r.length(), 3)) * r.x;\r\n  }\r\n\r\n  derivativeVelocityY(position) {\r\n    const r = this.parentPosition.sub(position);\r\n    return (this.parentMass / Math.pow(r.length(), 3)) * r.y;\r\n  }\r\n\r\n  sum(stage, f) {\r\n    let total = 0;\r\n    for (let i = 0; i < stage; i++) {\r\n      total += a[stage][i] * this.k(i, f);\r\n    }\r\n\r\n    return total;\r\n  }\r\n\r\n  kx(stage) {\r\n    return this.dt * (this.velocity.x + this.sum(stage, \"vx\"));\r\n  }\r\n\r\n  ky(stage) {\r\n    return this.dt * (this.velocity.y + this.sum(stage, \"vy\"));\r\n  }\r\n\r\n  kvx(stage) {\r\n    return (\r\n      this.dt *\r\n      this.derivativeVelocityX(\r\n        new Vector(\r\n          this.position.x + this.sum(stage, \"x\"),\r\n          this.position.y + this.sum(stage, \"y\")\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  kvy(stage) {\r\n    return (\r\n      this.dt *\r\n      this.derivativeVelocityY(\r\n        new Vector(\r\n          this.position.x + this.sum(stage, \"x\"),\r\n          this.position.y + this.sum(stage, \"y\")\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  k(stage, f) {\r\n    const cached = this.findCached(stage, f);\r\n    if (cached !== null) {\r\n      this.cacheHit++;\r\n      return cached;\r\n    }\r\n\r\n    this.cacheMiss++;\r\n    let result = null;\r\n\r\n    switch (f) {\r\n      case \"x\":\r\n        result = this.kx(stage);\r\n        break;\r\n      case \"y\":\r\n        result = this.ky(stage);\r\n        break;\r\n      case \"vx\":\r\n        result = this.kvx(stage);\r\n        break;\r\n      case \"vy\":\r\n        result = this.kvy(stage);\r\n        break;\r\n    }\r\n\r\n    this.setCache(stage, f, result);\r\n\r\n    return result;\r\n  }\r\n\r\n  findCached(stage, f) {\r\n    const key = getCacheKey(stage, f);\r\n    return this.cache[key] !== undefined ? this.cache[key] : null;\r\n  }\r\n\r\n  setCache(stage, f, result) {\r\n    const key = getCacheKey(stage, f);\r\n    this.cache[key] = result;\r\n  }\r\n\r\n  setValues(position, velocity, parentPosition, parentMass, dt) {\r\n    this.position = position;\r\n    this.velocity = velocity;\r\n    this.parentPosition = parentPosition;\r\n    this.parentMass = parentMass;\r\n    this.dt = dt;\r\n    this.cache = {};\r\n    this.cacheHit = 0;\r\n    this.cacheMiss = 0;\r\n    return this;\r\n  }\r\n\r\n  getAllKs(f) {\r\n    const result = [];\r\n    for (let i = 0; i < 6; i++) {\r\n      result[i] = this.k(i, f);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  weightedSum(values, k) {\r\n    return values\r\n      .map((value, i) => value * k[i])\r\n      .reduce((accumulator, current) => accumulator + current, 0);\r\n  }\r\n\r\n  subVectors(a, b) {\r\n    return a.map((valueA, i) => valueA - b[i]);\r\n  }\r\n\r\n  calculate() {\r\n    const ks = {\r\n      x: this.getAllKs(\"x\"),\r\n      y: this.getAllKs(\"y\"),\r\n      vx: this.getAllKs(\"vx\"),\r\n      vy: this.getAllKs(\"vy\")\r\n    };\r\n\r\n    const dPosition = new Vector(\r\n      this.weightedSum(bs, ks.x),\r\n      this.weightedSum(bs, ks.y)\r\n    );\r\n\r\n    const dVelocity = new Vector(\r\n      this.weightedSum(bs, ks.vx),\r\n      this.weightedSum(bs, ks.vy)\r\n    );\r\n\r\n    const error = new THREE.Vector4(\r\n      this.weightedSum(this.subVectors(bs, bsx), ks.x),\r\n      this.weightedSum(this.subVectors(bs, bsx), ks.y),\r\n      this.weightedSum(this.subVectors(bs, bsx), ks.vx),\r\n      this.weightedSum(this.subVectors(bs, bsx), ks.vy)\r\n    ).length();\r\n\r\n    return { dPosition, dVelocity, error };\r\n  }\r\n\r\n  reportCache() {\r\n    console.log(\r\n      \"total:\",\r\n      this.cacheHit + this.cacheMiss,\r\n      \"hit ratio:\",\r\n      this.cacheHit / (this.cacheHit + this.cacheMiss),\r\n      \"hit:\",\r\n      this.cacheHit,\r\n      \"miss:\",\r\n      this.cacheMiss\r\n    );\r\n  }\r\n}\r\n\r\nexport default ARKStep;\r\n","import ARKStep from \"./ARKStep.mjs\";\r\nimport Vector from \"./Vector.mjs\";\r\n\r\nconst arkStep = new ARKStep();\r\n\r\nconst MAX_ERROR = 0.001;\r\nconst MIN_ERROR = MAX_ERROR / 100;\r\n\r\nclass ARK {\r\n  constructor(gameTerrain) {\r\n    this.gameTerrain = gameTerrain;\r\n  }\r\n\r\n  calculateNewPositionVelocity(position, velocity, turn) {\r\n    let dt = 0.1;\r\n    let currentTime = 0;\r\n\r\n    let positions = [position.clone()];\r\n    /*\r\n    console.log(\r\n      \"startPosition\",\r\n      position.toString(),\r\n      \"startVelocity\",\r\n      velocity.toString()\r\n    );\r\n*/\r\n\r\n    const parent = this.gameTerrain.getParentEntity(position, turn);\r\n\r\n    if (!parent) {\r\n      const endPosition = position.add(velocity);\r\n      positions.push(endPosition);\r\n      return {\r\n        position: endPosition,\r\n        velocity,\r\n        positions,\r\n        collision: false\r\n      };\r\n    }\r\n\r\n    const parentMass = parent.mass;\r\n    const parentPosition = parent.position;\r\n\r\n    while (currentTime < 1 && dt <= 1) {\r\n      if (parent && parentPosition.distanceTo(position) < 100) {\r\n        positions.push(parentPosition.clone());\r\n        return {\r\n          position: parentPosition.clone(),\r\n          velocity: new Vector(0, 0),\r\n          positions,\r\n          collision: true\r\n        };\r\n      }\r\n\r\n      const { dPosition, dVelocity, error } = arkStep\r\n        .setValues(position, velocity, parentPosition, parentMass, dt)\r\n        .calculate();\r\n      //console.log(\"dt\", dt, \"currentTime\", currentTime);\r\n\r\n      if (error > MAX_ERROR) {\r\n        dt = dt * 0.5;\r\n        continue;\r\n      } else if (error < MIN_ERROR) {\r\n        dt = dt * 2;\r\n        continue;\r\n      } else if (currentTime + dt > 1) {\r\n        break;\r\n      } else {\r\n        position = position.add(dPosition);\r\n        velocity = velocity.add(dVelocity);\r\n        positions.push(position.clone());\r\n\r\n        //console.log(\"step\", position.toString(), \"delta time\", dt);\r\n\r\n        currentTime += dt;\r\n      }\r\n    }\r\n\r\n    dt = 1 - currentTime;\r\n    currentTime = 1;\r\n\r\n    const { dPosition: fDPosition, dVelocity: fDVelocity } = arkStep\r\n      .setValues(position, velocity, parentPosition, parentMass, dt)\r\n      .calculate();\r\n\r\n    position = position.add(fDPosition);\r\n    velocity = velocity.add(fDVelocity);\r\n    positions.push(position.clone());\r\n    /*\r\n    console.log(currentTime);\r\n\r\n    console.log(\r\n      \"endPosition\",\r\n      position.toString(),\r\n      \"endVelocity\",\r\n      velocity.toString()\r\n    );\r\n    */\r\n    return {\r\n      position,\r\n      velocity,\r\n      positions,\r\n      collision: false\r\n    };\r\n  }\r\n}\r\n\r\nexport default ARK;\r\n","import GameTerrainEntity from \"./GameTerrainEntity.mjs\";\r\nimport ARK from \"../../model/utils/ARK.mjs\";\r\n\r\nclass GameTerrain {\r\n  constructor(gameData) {\r\n    this.gameData = gameData;\r\n    this.entities = [];\r\n    this.ark = new ARK(this);\r\n  }\r\n\r\n  getEntities() {\r\n    return this.entities;\r\n  }\r\n\r\n  addEntity(entity) {\r\n    this.entities.push(entity);\r\n  }\r\n\r\n  getGravityVectorForTurn(position, velocity, turn) {\r\n    return this.ark.calculateNewPositionVelocity(position, velocity, turn);\r\n  }\r\n\r\n  getParentEntity(position, time, turn) {\r\n    return this.entities[0];\r\n  }\r\n\r\n  serialize() {\r\n    return this.entities.map(entity => entity.serialize());\r\n  }\r\n\r\n  deserialize(data = []) {\r\n    this.entities = data.map(entry => new GameTerrainEntity(entry));\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default GameTerrain;\r\n","import TorpedoFlight from \"../unit/TorpedoFlight.mjs\";\r\n\r\nclass GameTorpedos {\r\n  constructor() {\r\n    this.flights = [];\r\n  }\r\n\r\n  getTorpedoFlightById(id) {\r\n    return this.flights.find(flight => flight.id === id);\r\n  }\r\n\r\n  addTorpedoFlights(flights) {\r\n    flights = [].concat(flights);\r\n\r\n    this.flights = [...this.flights, ...flights];\r\n  }\r\n\r\n  getTorpedoFlights() {\r\n    return [...this.flights];\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      flights: this.flights.map(flight => flight.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = { flights: [] }) {\r\n    this.flights = data.flights.map(flight =>\r\n      new TorpedoFlight().deserialize(flight)\r\n    );\r\n\r\n    return this;\r\n  }\r\n\r\n  advanceTurn() {\r\n    this.flights = this.flights.filter(\r\n      flight => !flight.noLongerActive() && !flight.reachedTarget\r\n    );\r\n  }\r\n}\r\n\r\nexport default GameTorpedos;\r\n","class CombatLogTorpedoLaunch {\r\n  constructor(torpedoFlightId) {\r\n    this.torpedoFlightId = torpedoFlightId;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      torpedoFlightId: this.torpedoFlightId\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.torpedoFlightId = data.torpedoFlightId;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogTorpedoLaunch;\r\n","import WeaponHitChange from \"../weapon/WeaponHitChange.mjs\";\r\n\r\nclass CombatLogTorpedoIntercept {\r\n  constructor(torpedoFlightId, shipId, weaponId, interceptChange, roll) {\r\n    this.torpedoFlightId = torpedoFlightId;\r\n    this.shipId = shipId;\r\n    this.weaponId = weaponId;\r\n    this.interceptChange = interceptChange;\r\n    this.roll = roll;\r\n  }\r\n\r\n  isSucessfull() {\r\n    return this.roll <= this.interceptChange.result;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      torpedoFlightId: this.torpedoFlightId,\r\n      weaponId: this.weaponId,\r\n      roll: this.roll,\r\n      shipId: this.shipId,\r\n      interceptChange: this.interceptChange.serialize()\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.torpedoFlightId = data.torpedoFlightId;\r\n    this.weaponId = data.weaponId;\r\n    this.roll = data.roll;\r\n    this.shipId = data.shipId;\r\n    this.interceptChange = new WeaponHitChange().deserialize(\r\n      data.interceptChange\r\n    );\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogTorpedoIntercept;\r\n","class CombatLogTorpedoOutOfTime {\r\n  constructor(torpedoFlightId) {\r\n    this.torpedoFlightId = torpedoFlightId;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      torpedoFlightId: this.torpedoFlightId\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.torpedoFlightId = data.torpedoFlightId;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogTorpedoOutOfTime;\r\n","class CombatLogTorpedoNotArmed {\r\n  constructor(torpedoFlightId, turnsActive, armingTime) {\r\n    this.torpedoFlightId = torpedoFlightId;\r\n    this.turnsActive = turnsActive;\r\n    this.armingTime = armingTime;\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      logEntryClass: this.constructor.name,\r\n      torpedoFlightId: this.torpedoFlightId,\r\n      turnsActive: this.turnsActive,\r\n      armingTime: this.armingTime\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.torpedoFlightId = data.torpedoFlightId;\r\n    this.turnsActive = data.turnsActive;\r\n    this.armingTime = data.armingTime;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default CombatLogTorpedoNotArmed;\r\n","import CombatLogTorpedoAttack from \"./CombatLogTorpedoAttack.mjs\";\r\nimport CombatLogDamageEntry from \"./CombatLogDamageEntry.mjs\";\r\nimport CombatLogTorpedoLaunch from \"./CombatLogTorpedoLaunch.mjs\";\r\nimport CombatLogTorpedoIntercept from \"./CombatLogTorpedoIntercept.mjs\";\r\nimport CombatLogTorpedoMove from \"./CombatLogTorpedoMove.mjs\";\r\nimport CombatLogTorpedoOutOfTime from \"./CombatLogTorpedoOutOfTime.mjs\";\r\nimport CombatLogWeaponOutOfArc from \"./CombatLogWeaponOutOfArc.mjs\";\r\nimport CombatLogWeaponFire from \"./CombatLogWeaponFire.mjs\";\r\nimport CombatLogShipMovement from \"./CombatLogShipMovement.mjs\";\r\nimport CombatLogShipVelocity from \"./CombatLogShipVelocity.mjs\";\r\nimport CombatLogTorpedoNotArmed from \"./CombatLogTorpedoNotArmed.mjs\";\r\nimport CombatLogGroupedWeaponFire from \"./CombatLogGroupedWeaponFire.mjs\";\r\nimport CombatLogGroupedTorpedoAttack from \"./CombatLogGroupedTorpedoAttack.mjs\";\r\n\r\nexport const combatLogClasses = {\r\n  CombatLogTorpedoAttack,\r\n  CombatLogDamageEntry,\r\n  CombatLogTorpedoLaunch,\r\n  CombatLogTorpedoIntercept,\r\n  CombatLogTorpedoMove,\r\n  CombatLogTorpedoOutOfTime,\r\n  CombatLogWeaponOutOfArc,\r\n  CombatLogWeaponFire,\r\n  CombatLogShipMovement,\r\n  CombatLogShipVelocity,\r\n  CombatLogTorpedoNotArmed,\r\n  CombatLogGroupedWeaponFire,\r\n  CombatLogGroupedWeaponFire\r\n};\r\n","import { combatLogClasses } from \"./combatLogClasses.mjs\";\r\nimport CombatLogWeaponFire from \"./CombatLogWeaponFire.mjs\";\r\nimport CombatLogGroupedWeaponFire from \"./CombatLogGroupedWeaponFire.mjs\";\r\nimport CombatLogTorpedoAttack from \"./CombatLogTorpedoAttack.mjs\";\r\nimport CombatLogGroupedTorpedoAttack from \"./CombatLogGroupedTorpedoAttack.mjs\";\r\nimport CombatLogTorpedoIntercept from \"./CombatLogTorpedoIntercept.mjs\";\r\n\r\nclass CombatLogData {\r\n  constructor() {\r\n    this.entries = [];\r\n  }\r\n\r\n  addEntry(entry) {\r\n    this.entries.push(entry);\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      entries: this.entries.map(entry => entry.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    this.entries = data.entries\r\n      ? data.entries.map(entry =>\r\n          new combatLogClasses[entry.logEntryClass]().deserialize(entry)\r\n        )\r\n      : [];\r\n\r\n    return this;\r\n  }\r\n\r\n  advanceTurn() {\r\n    this.entries = [];\r\n  }\r\n\r\n  getInterceptsFor(torpedoAttack) {\r\n    return this.entries\r\n      .filter(entry => entry instanceof CombatLogTorpedoIntercept)\r\n      .filter(entry => entry.torpedoFlightId === torpedoAttack.torpedoFlightId);\r\n  }\r\n\r\n  getForReplay() {\r\n    const entries = [...this.entries];\r\n    const groupedFires = [];\r\n\r\n    entries\r\n      .filter(entry => entry instanceof CombatLogWeaponFire)\r\n      .forEach(fire => {\r\n        let entry = groupedFires.find(\r\n          grouped => grouped.targetId === fire.targetId\r\n        );\r\n\r\n        if (!entry) {\r\n          entry = new CombatLogGroupedWeaponFire(fire.targetId);\r\n          groupedFires.push(entry);\r\n        }\r\n\r\n        entry.addEntry(fire);\r\n      });\r\n\r\n    const groupedTorpedos = [];\r\n\r\n    entries\r\n      .filter(entry => entry instanceof CombatLogTorpedoAttack)\r\n      .forEach(torpedo => {\r\n        let entry = groupedTorpedos.find(\r\n          grouped => grouped.targetId === torpedo.targetId\r\n        );\r\n\r\n        if (!entry) {\r\n          entry = new CombatLogGroupedTorpedoAttack(torpedo.targetId);\r\n          groupedTorpedos.push(entry);\r\n        }\r\n\r\n        entry.addEntry(torpedo);\r\n      });\r\n\r\n    return [\r\n      ...this.entries.filter(entry => !(entry instanceof CombatLogWeaponFire)),\r\n      ...groupedFires,\r\n      ...groupedTorpedos\r\n    ]\r\n      .filter(entry => entry.replayOrder)\r\n      .sort((a, b) => {\r\n        if (a.replayOrder > b.replayOrder) {\r\n          return 1;\r\n        }\r\n\r\n        if (a.replayOrder < b.replayOrder) {\r\n          return -1;\r\n        }\r\n\r\n        return 0;\r\n      });\r\n  }\r\n}\r\n\r\nexport default CombatLogData;\r\n","import GameSlots from \"./GameSlots.mjs\";\r\nimport GameShips from \"./GameShips.mjs\";\r\nimport GameActiveShips from \"./GameActiveShips.mjs\";\r\nimport GameTerrain from \"./GameTerrain.mjs\";\r\nimport User from \"../User.mjs\";\r\nimport * as gameStatuses from \"./gameStatuses.mjs\";\r\nimport * as gamePhases from \"./gamePhases.mjs\";\r\nimport GameTorpedos from \"./GameTorpedos.mjs\";\r\nimport CombatLogData from \"../combatLog/CombatLogData.mjs\";\r\n\r\nclass GameData {\r\n  constructor(data) {\r\n    this.deserialize(data);\r\n  }\r\n\r\n  setStatus(status) {\r\n    this.status = status;\r\n  }\r\n\r\n  setPhase(phase) {\r\n    this.phase = phase;\r\n  }\r\n\r\n  advanceTurn() {\r\n    this.turn++;\r\n  }\r\n\r\n  addPlayer(user) {\r\n    if (this.players.find(player => player.id === user.id)) {\r\n      return;\r\n    }\r\n\r\n    this.players.push(user);\r\n  }\r\n\r\n  removePlayer(user) {\r\n    this.players = this.players.filter(player => player.id !== user.id);\r\n  }\r\n\r\n  isPlayerInGame(user) {\r\n    return this.players.find(player => player.id === user.id);\r\n  }\r\n\r\n  isPlayerActive(user) {\r\n    return this.activePlayerIds.includes(user.id);\r\n  }\r\n\r\n  setPlayerActive(user) {\r\n    if (this.isPlayerActive(user)) {\r\n      return;\r\n    }\r\n\r\n    this.activePlayerIds.push(user.id);\r\n  }\r\n\r\n  setPlayerInactive(user) {\r\n    this.activePlayerIds = this.activePlayerIds.filter(id => id !== user.id);\r\n  }\r\n\r\n  validateForGameCreate(user) {\r\n    if (!this.name) {\r\n      return \"Game needs a name\";\r\n    }\r\n\r\n    const slots = this.slots.getSlots();\r\n\r\n    if (slots.length < 2) {\r\n      return \"Game has to have atleast two slots\";\r\n    }\r\n\r\n    const teams = {};\r\n    slots.forEach(slot => (teams[slot.team] = true));\r\n\r\n    if (Object.keys(teams).length < 2) {\r\n      return \"Game has to have atleast two teams\";\r\n    }\r\n\r\n    let error = undefined;\r\n\r\n    slots.forEach(slot => {\r\n      const slotError = slot.validate();\r\n      if (slotError) {\r\n        error = slotError;\r\n      }\r\n    });\r\n\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (!slots.some(slot => slot.userId === user.id)) {\r\n      return \"Game creator has to occupy atleast one slot\";\r\n    }\r\n\r\n    if (slots.some(slot => slot.userId && slot.userId !== user.id)) {\r\n      return \"Other players can not occupy slots at this stage\";\r\n    }\r\n  }\r\n\r\n  getActiveShips() {\r\n    return this.ships\r\n      .getShips()\r\n      .filter(ship => this.activeShips.isActive(ship));\r\n  }\r\n\r\n  getActiveShipsForUser(user) {\r\n    return this.ships\r\n      .getShips()\r\n      .filter(\r\n        ship => this.activeShips.isActive(ship) && ship.player.isUsers(user)\r\n      );\r\n  }\r\n\r\n  isActiveShip(ship) {\r\n    return this.activeShips.isActive(ship);\r\n  }\r\n\r\n  setActiveShip(ship) {\r\n    this.activeShips.setActive(ship);\r\n  }\r\n\r\n  setInactiveShip(ship) {\r\n    this.activeShips.setInactive(ship);\r\n  }\r\n\r\n  getShipsForUser(user) {\r\n    return this.ships.getShips().filter(ship => ship.player.isUsers(user));\r\n  }\r\n\r\n  serialize() {\r\n    return {\r\n      id: this.id,\r\n      phase: this.phase,\r\n      name: this.name,\r\n      turn: this.turn,\r\n      data: {\r\n        activePlayerIds: this.activePlayerIds,\r\n        ...this.slots.serialize(),\r\n        terrain: this.terrain.serialize(),\r\n        combatLog: this.combatLog.serialize(),\r\n        torpedos: this.torpedos.serialize()\r\n      },\r\n      ships: this.ships.serialize(),\r\n      activeShips: this.activeShips.serialize(),\r\n      creatorId: this.creatorId,\r\n      status: this.status,\r\n      players: this.players.map(player => player.serialize())\r\n    };\r\n  }\r\n\r\n  deserialize(data = {}) {\r\n    console.log(\"deserialize gamedata\", data);\r\n    const gameData = data.data || {};\r\n    this.id = data.id || null;\r\n    this.name = data.name;\r\n    this.phase = data.phase || gamePhases.DEPLOYMENT;\r\n    this.turn = data.turn || 1;\r\n    this.players = data.players\r\n      ? data.players.map(player => new User().deserialize(player))\r\n      : [];\r\n    this.activePlayerIds = gameData.activePlayerIds || [];\r\n    this.slots = new GameSlots(this).deserialize(gameData);\r\n    this.ships = new GameShips(this).deserialize(data.ships);\r\n    this.activeShips = new GameActiveShips(this).deserialize(data.activeShips);\r\n    this.creatorId = data.creatorId;\r\n    this.status = data.status || gameStatuses.LOBBY;\r\n\r\n    this.torpedos = new GameTorpedos().deserialize(gameData.torpedos);\r\n    this.terrain = new GameTerrain(this).deserialize(gameData.terrain);\r\n    this.combatLog = new CombatLogData().deserialize(gameData.combatLog);\r\n\r\n    return this;\r\n  }\r\n\r\n  clone() {\r\n    return new GameData(this.serialize());\r\n  }\r\n\r\n  censorForUser(user) {\r\n    this.ships.getShips().forEach(ship => {\r\n      ship.movement.removeMovementForOtherTurns(this.turn);\r\n      const mine = user && ship.player.is(user);\r\n      ship.censorForUser(user, mine);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  endTurn() {\r\n    this.ships.getShips().forEach(ship => {\r\n      ship.endTurn(this.turn);\r\n    });\r\n  }\r\n\r\n  advanceTurn() {\r\n    this.turn++;\r\n    this.players.forEach(player => this.setPlayerActive(player));\r\n    this.combatLog.advanceTurn();\r\n    this.torpedos.advanceTurn();\r\n\r\n    this.ships.getShips().forEach(ship => {\r\n      ship.advanceTurn(this.turn);\r\n      this.setActiveShip(ship);\r\n    });\r\n  }\r\n}\r\n\r\nexport default GameData;\r\n","export const DEPLOYMENT = \"deployment\";\r\nexport const GAME = \"game\";\r\n","export const LOBBY = \"lobby\";\r\nexport const ACTIVE = \"active\";\r\nexport const FINISHED = \"finished\";\r\nexport const ABANDONED = \"abandoned\";\r\n","import { loadObject, cloneObject } from \"../../utils/objectLoader\";\r\nimport LineSprite from \"../sprite/LineSprite\";\r\nimport Vector from \"../../../../../model/utils/Vector.mjs\";\r\nimport Line from \"../Line\";\r\nimport * as THREE from \"three\";\r\nimport StarParticleEmitter from \"../../animation/particle/StarParticleEmitter\";\r\nimport { ParticleEmitter } from \"../../animation/particle\";\r\nimport {\r\n  TEXTURE_GLOW,\r\n  TEXTURE_STARLINE,\r\n  TEXTURE_GAS\r\n} from \"../../animation/particle/BaseParticle\";\r\nimport { getSeededRandomGenerator } from \"../../../../../model/utils/math.mjs\";\r\nimport { degreeToRadian } from \"../../../../../model/utils/math.mjs\";\r\n\r\nconst torpedoMesh = loadObject(\"/img/3d/torpedo/scene.gltf\");\r\n\r\nclass TorpedoObject {\r\n  constructor(torpedoFlight, scene) {\r\n    this.torpedoFlight = torpedoFlight;\r\n    this.scene = scene;\r\n    this.torpedo = null;\r\n\r\n    this.object = new THREE.Object3D();\r\n    this.particleEmitter = new ParticleEmitter(this.object, 10);\r\n    this.create();\r\n    this.lastAnimationTime = null;\r\n    this.totalAnimationTime = 0;\r\n\r\n    this.hidden = true;\r\n  }\r\n\r\n  hide() {\r\n    if (this.hidden) {\r\n      return;\r\n    }\r\n\r\n    this.scene.remove(this.object);\r\n    this.hidden = true;\r\n  }\r\n\r\n  show() {\r\n    if (!this.hidden) {\r\n      return;\r\n    }\r\n\r\n    this.scene.add(this.object);\r\n    this.hidden = false;\r\n  }\r\n\r\n  setFacing(facing) {\r\n    this.object.quaternion.setFromAxisAngle(\r\n      new THREE.Vector3(0, 0, 1),\r\n      degreeToRadian(facing)\r\n    );\r\n  }\r\n\r\n  setPosition(position) {\r\n    this.object.position.set(position.x, position.y, position.z);\r\n    return this;\r\n  }\r\n\r\n  getEnginePosition() {\r\n    const slot = this.torpedo.children.find(child => {\r\n      if (!child.name) {\r\n        return false;\r\n      }\r\n\r\n      if (child.name === \"thrustEffect\") {\r\n        return true;\r\n      }\r\n    });\r\n\r\n    if (!slot) {\r\n      return new Vector();\r\n    }\r\n\r\n    return new Vector(slot.position);\r\n  }\r\n\r\n  async create() {\r\n    const scene = await torpedoMesh;\r\n\r\n    const torpedo = scene.scene.children[0].clone();\r\n\r\n    this.torpedo = torpedo;\r\n\r\n    const visuals = this.torpedoFlight.torpedo.visuals;\r\n    const color = new THREE.Color(\r\n      visuals.engineColor[0],\r\n      visuals.engineColor[1],\r\n      visuals.engineColor[2]\r\n    );\r\n\r\n    //this.torpedo.position.x = 100;\r\n    //this.torpedo.position.z = 50;\r\n\r\n    /*\r\n    this.line = new Line(this.object, {\r\n      start: new Vector(0, 0, 0),\r\n      end: new Vector(0, 0, -30),\r\n      width: 0.5,\r\n      color: new THREE.Color(1, 1, 1),\r\n      opacity: 0.2\r\n      //type: \"cylinder\"\r\n    });\r\n    */\r\n\r\n    const enginePosition = this.getEnginePosition();\r\n\r\n    this.particleEmitter.mesh.position.set(\r\n      enginePosition.x,\r\n      enginePosition.y,\r\n      enginePosition.z\r\n    );\r\n    const getRandom = getSeededRandomGenerator(this.torpedoFlight.id);\r\n\r\n    const size = 10;\r\n    const sineFrequency = getRandom() * 50 + 200;\r\n\r\n    this.particleEmitter\r\n      .getParticle()\r\n      .setSize(size)\r\n      .setOpacity(0.5)\r\n      .setFadeIn(0, 0)\r\n      .setFadeOut(0, 0)\r\n      .setColor(color)\r\n      //.setVelocity(this.movement)\r\n      .setPosition({\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      })\r\n      .setTexture(TEXTURE_GLOW)\r\n      .setActivationTime(0);\r\n    //.setSine(100, 0.99);\r\n\r\n    this.particleEmitter\r\n      .getParticle()\r\n      .setSize(size)\r\n      .setOpacity(0.1)\r\n      .setFadeIn(0, 0)\r\n      .setFadeOut(0, 0)\r\n      .setColor(color)\r\n      //.setVelocity(this.movement)\r\n      .setPosition({\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      })\r\n      .setTexture(TEXTURE_GLOW)\r\n      .setActivationTime(0)\r\n      .setSine(sineFrequency, 0.99);\r\n\r\n    this.particleEmitter\r\n      .getParticle()\r\n      .setSize(size * 0.3)\r\n      .setOpacity(0.8)\r\n      .setFadeIn(0, 0)\r\n      .setFadeOut(0, 0)\r\n      .setColor(new THREE.Color(1, 1, 1))\r\n      //.setVelocity(this.movement)\r\n      .setPosition({\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      })\r\n      .setTexture(TEXTURE_GLOW)\r\n      .setActivationTime(0);\r\n\r\n    let angle = 90;\r\n    let shines = 2;\r\n    let angleChange = 0; // getRandom() * 0.05 - 0.025;\r\n\r\n    while (shines--) {\r\n      angle += 90;\r\n\r\n      /*\r\n      this.particleEmitter\r\n        .getParticle()\r\n        .setActivationTime(0)\r\n        .setFadeIn(0, 0)\r\n        .setFadeOut(0, 0)\r\n        .setSize(getRandom() * 10 + size * 5)\r\n        .setOpacity(getRandom() * 0.05 + 0.2)\r\n        .setPosition({\r\n          x: 0,\r\n          y: 0,\r\n          z: 0\r\n        })\r\n        .setColor(new THREE.Color(51 / 255, 163 / 255, 255 / 255))\r\n        //.setSine(getRandom() * 200 + 100, 0.1)\r\n        .setAngle(angle)\r\n        .setAngleChange(angleChange)\r\n        .setTexture(TEXTURE_STARLINE);\r\n      //.setSine(100, 0.5);\r\n      */\r\n\r\n      this.particleEmitter\r\n        .getParticle()\r\n        .setActivationTime(0)\r\n        .setFadeIn(0, 0)\r\n        .setFadeOut(0, 0)\r\n        .setSize(getRandom() * 10 + size * 3)\r\n        .setOpacity(0.1)\r\n        .setPosition({\r\n          x: 0,\r\n          y: 0,\r\n          z: 0\r\n        })\r\n        .setColor(color)\r\n        //.setSine(getRandom() * 200 + 100, 0.1)\r\n        .setAngle(angle)\r\n        .setAngleChange(angleChange)\r\n        .setTexture(TEXTURE_STARLINE)\r\n        .setSine(sineFrequency, 0.99);\r\n    }\r\n\r\n    this.object.add(torpedo);\r\n  }\r\n\r\n  render({ zoom }) {\r\n    if (this.lastAnimationTime === null) {\r\n      this.lastAnimationTime = Date.now();\r\n    }\r\n\r\n    var deltaTime = Date.now() - this.lastAnimationTime;\r\n\r\n    this.totalAnimationTime += deltaTime;\r\n\r\n    this.particleEmitter.render({\r\n      delta: 0,\r\n      total: this.totalAnimationTime,\r\n      last: 0,\r\n      zoom: zoom\r\n    });\r\n\r\n    this.lastAnimationTime = Date.now();\r\n  }\r\n\r\n  destroy() {\r\n    this.scene.remove(this.object);\r\n  }\r\n\r\n  update(torpedoFlight) {\r\n    this.torpedoFlight = torpedoFlight;\r\n  }\r\n}\r\n\r\nexport default TorpedoObject;\r\n","import TorpedoObject from \"../ships/TorpedoObject\";\r\n\r\nclass TorpedoIconContainer {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n\r\n    this.icons = [];\r\n  }\r\n\r\n  getArray() {\r\n    return this.icons;\r\n  }\r\n\r\n  hasIcon(id) {\r\n    return Boolean(this.getIconById(id));\r\n  }\r\n\r\n  getIconByTorpedoFlight(flight) {\r\n    let icon = this.getIconById(flight.id);\r\n    if (!icon) {\r\n      icon = new TorpedoObject(flight, this.scene);\r\n      this.icons.push(icon);\r\n    }\r\n\r\n    return icon;\r\n  }\r\n\r\n  getIconById(id) {\r\n    return this.icons.find(icon => icon.torpedoFlight.id === id);\r\n  }\r\n\r\n  render(renderPayload) {\r\n    this.icons.forEach(icon => icon.render(renderPayload));\r\n  }\r\n}\r\n\r\nexport default TorpedoIconContainer;\r\n","import MovementService from \"../../../../model/movement/MovementService\";\nimport WeaponFireService from \"../../../../model/weapon/WeaponFireService\";\nimport PhaseState from \"./PhaseState\";\nimport ShipIconContainer from \"../renderer/icon/ShipIconContainer\";\nimport ElectronicWarfareIndicatorService from \"../renderer/electronicWarfare/ElectronicWarfareIndicatorService\";\nimport TerrainRenderer from \"../renderer/TerrainRenderer\";\nimport ShipWindowManager from \"../ui/shipWindow/ShipWindowManager\";\nimport MovementPathService from \"../movement/MovementPathService\";\nimport * as gameStatus from \"../../../../model/game/gameStatuses\";\nimport * as gamePhase from \"../../../../model/game/gamePhases\";\n\nimport LobbyPhaseStrategy from \"./phaseStrategy/LobbyPhaseStrategy\";\nimport DeploymentPhaseStrategy from \"./phaseStrategy/DeploymentPhaseStrategy\";\nimport ReplayPhaseStrategy from \"./phaseStrategy/ReplayPhaseStrategy\";\nimport WaitingPhaseStrategy from \"./phaseStrategy/WaitingPhaseStrategy\";\nimport GamePhaseStrategy from \"./phaseStrategy/GamePhaseStrategy\";\nimport AutomaticReplayPhaseStrategy from \"./phaseStrategy/AutomaticReplayPhaseStrategy/index.js\";\nimport GameDataCache from \"./GameDataCache\";\nimport {\n  ParticleEmitterContainer,\n  ParticleEmitter\n} from \"../animation/particle\";\nimport GameData from \"../../../../model/game/GameData.mjs\";\nimport TorpedoIconContainer from \"../renderer/icon/TorpedoIconContainer\";\n\nclass PhaseDirector {\n  constructor(uiState, currentUser, coordinateConverter, gameConnector) {\n    this.uiState = uiState;\n    this.currentUser = currentUser;\n    this.shipIconContainer = null;\n    this.torpedoIconContainer = null;\n    this.electronicWarfareIndicatorService = null;\n    this.timeline = [];\n\n    this.phaseStrategy = null;\n    this.coordinateConverter = coordinateConverter;\n    this.shipWindowManager = null;\n    this.movementService = new MovementService();\n    this.weaponFireService = new WeaponFireService();\n    this.movementPathService = null;\n    this.terrainRenderer = null;\n    this.phaseState = new PhaseState();\n    this.gameConnector = gameConnector;\n    this.gameConnector.init(this);\n    this.scene = null;\n    this.emitterContainer = null;\n    this.camera = null;\n\n    this.gameDataCache = new GameDataCache();\n  }\n\n  init(scene, emitterContainer, camera) {\n    this.scene = scene;\n    this.emitterContainer = emitterContainer;\n    this.camera = camera;\n\n    this.shipIconContainer = new ShipIconContainer(scene, this.currentUser);\n    this.torpedoIconContainer = new TorpedoIconContainer(scene);\n    this.electronicWarfareIndicatorService = new ElectronicWarfareIndicatorService(\n      scene,\n      this.shipIconContainer,\n      this.currentUser\n    );\n    this.shipWindowManager = new ShipWindowManager(\n      this.uiState,\n      this.movementService\n    );\n\n    this.movementPathService = new MovementPathService(\n      scene,\n      this.shipIconContainer,\n      this.currentUser\n    );\n    this.terrainRenderer = new TerrainRenderer(scene);\n\n    this.uiState.setPhaseDirector(this);\n  }\n\n  closeReplay() {\n    this.phaseStrategy.deactivate();\n    this.phaseStrategy = null;\n\n    this.resolvePhaseStrategy();\n  }\n\n  startReplay() {\n    const gameDatas = this.gameDataCache.getGameDatasForAutomaticReplay();\n\n    if (!gameDatas) {\n      return;\n    }\n\n    this.activatePhaseStrategy(AutomaticReplayPhaseStrategy);\n    this.relayEvent(\"newTurn\", gameDatas);\n  }\n\n  receiveGameData(gameData) {\n    window.gameData = this.gameDataCache;\n    this.gameDataCache.setCurrent(gameData);\n    this.resolvePhaseStrategy();\n  }\n\n  receiveReplay(gameDatas) {\n    this.receiveTurnChange(gameDatas);\n  }\n\n  receiveTurnChange(gameDatas) {\n    this.gameDataCache.setCurrent(gameDatas[gameDatas.length - 1]);\n    const replays = [...gameDatas];\n    replays.splice(-1, 1);\n    this.gameDataCache.setReplays(replays);\n\n    if (!this.phaseStrategy || this.phaseStrategy.canDisturb()) {\n      this.activatePhaseStrategy(AutomaticReplayPhaseStrategy);\n    }\n\n    if (this.phaseStrategy) {\n      this.relayEvent(\"newTurn\", gameDatas);\n    }\n  }\n\n  relayEvent(name, payload) {\n    if (!this.phaseStrategy || this.phaseStrategy.inactive) {\n      return;\n    }\n\n    this.phaseStrategy.onEvent(name, payload);\n    this.shipIconContainer.onEvent(name, payload);\n  }\n\n  commitTurn() {\n    this.phaseStrategy.commitTurn(this.gameConnector);\n    return this.activatePhaseStrategy(WaitingPhaseStrategy);\n  }\n\n  render(scene, coordinateConverter, zoom) {\n    if (!this.phaseStrategy || this.phaseStrategy.inactive) {\n      return;\n    }\n\n    this.phaseStrategy.render(coordinateConverter, scene, zoom);\n    this.electronicWarfareIndicatorService.render(zoom);\n    this.uiState.render();\n  }\n\n  resolvePhaseStrategy() {\n    const gameData = this.gameDataCache.getCurrent();\n\n    if (this.phaseStrategy && !this.phaseStrategy.canDisturb()) {\n      return;\n    }\n\n    if (gameData.status === gameStatus.LOBBY) {\n      return this.activatePhaseStrategy(LobbyPhaseStrategy, gameData);\n    }\n\n    if (\n      !this.currentUser ||\n      !gameData.isPlayerInGame(this.currentUser) ||\n      this.uiState.isReplay() ||\n      gameData.status === gameStatus.FINISHED\n    ) {\n      return this.activatePhaseStrategy(ReplayPhaseStrategy, gameData);\n    }\n\n    if (!gameData.isPlayerActive(this.currentUser)) {\n      return this.activatePhaseStrategy(WaitingPhaseStrategy, gameData);\n    }\n\n    if (gameData.phase === gamePhase.DEPLOYMENT) {\n      return this.activatePhaseStrategy(DeploymentPhaseStrategy, gameData);\n    }\n\n    if (!gameData.isPlayerActive(this.currentUser)) {\n      return this.activatePhaseStrategy(WaitingPhaseStrategy, gameData);\n    }\n\n    return this.activatePhaseStrategy(GamePhaseStrategy, gameData);\n  }\n\n  activatePhaseStrategy(phaseStrategy) {\n    const gameData = this.gameDataCache.getCurrent();\n\n    this.uiState.update(gameData);\n    this.shipIconContainer.update(gameData);\n    this.movementService.update(gameData, this);\n    this.movementPathService.update(gameData);\n    this.terrainRenderer.update(gameData.terrain);\n    this.weaponFireService.update(gameData);\n\n    if (this.phaseStrategy && this.phaseStrategy instanceof phaseStrategy) {\n      this.phaseStrategy.update(gameData);\n      return;\n    }\n\n    if (this.phaseStrategy) {\n      this.phaseStrategy.deactivate();\n    }\n\n    this.phaseStrategy = new phaseStrategy(this.getServices());\n    this.phaseStrategy.activate().update(gameData);\n  }\n\n  getServices() {\n    return {\n      phaseState: this.phaseState,\n      shipIconContainer: this.shipIconContainer,\n      torpedoIconContainer: this.torpedoIconContainer,\n      electronicWarfareIndicatorService: this.electronicWarfareIndicatorService,\n      scene: this.scene,\n      shipWindowManager: this.shipWindowManager,\n      movementService: this.movementService,\n      coordinateConverter: this.coordinateConverter,\n      uiState: this.uiState,\n      currentUser: this.currentUser,\n      gameConnector: this.gameConnector,\n      movementPathService: this.movementPathService,\n      weaponFireService: this.weaponFireService,\n      particleEmitterContainer: this.emitterContainer,\n      gameCamera: this.camera\n    };\n  }\n\n  deactivate() {}\n}\n\nexport default PhaseDirector;\n","class PositionObject {\r\n  constructor(view, game, hex, entity = null) {\r\n    this.view = view;\r\n    this.game = game;\r\n    this.hex = hex;\r\n    this.entity = entity;\r\n  }\r\n}\r\n\r\nexport default PositionObject;\r\n","class GameSettings {\r\n  constructor(settings) {\r\n    this.populate(settings);\r\n  }\r\n\r\n  populate(settings = {}) {\r\n    this.settings = {\r\n      ShowAllEW: settings.ShowAllEW || {\r\n        keyCode: 87,\r\n        shiftKey: false,\r\n        altKey: false,\r\n        ctrlKey: false,\r\n        metaKey: false\r\n      },\r\n      ShowFriendlyEW: settings.ShowFriendlyEW || {\r\n        keyCode: 88,\r\n        shiftKey: false,\r\n        altKey: false,\r\n        ctrlKey: false,\r\n        metaKey: false\r\n      },\r\n      ShowEnemyEW: settings.ShowEnemyEW || {\r\n        keyCode: 89,\r\n        shiftKey: false,\r\n        altKey: false,\r\n        ctrlKey: false,\r\n        metaKey: false\r\n      },\r\n      ZoomLevelToStrategic: 0.2\r\n    };\r\n  }\r\n\r\n  set(key, value) {\r\n    if (this.settings[key] === undefined) {\r\n      throw new Error(\"Unrecognized settings key '\" + key + \"'\");\r\n    }\r\n\r\n    console.log(\"setting key\", key, \"to\", value, typeof value);\r\n    this.settings[key] = value;\r\n  }\r\n\r\n  save() {\r\n    localStorage.setItem(\"settings\", JSON.stringify(this.settings));\r\n  }\r\n\r\n  matchEvent = function(event) {\r\n    return Object.keys(this.settings).find(function(action) {\r\n      var def = this.settings[action];\r\n      if (!def || !def.keyCode) {\r\n        return false;\r\n      }\r\n\r\n      return (\r\n        def.keyCode === event.keyCode &&\r\n        def.shiftKey === event.shiftKey &&\r\n        def.altKey === event.altKey &&\r\n        def.ctrlKey === event.ctrlKey &&\r\n        def.metaKey === event.metaKey\r\n      );\r\n    }, this);\r\n  };\r\n\r\n  load() {\r\n    var settings = localStorage.getItem(\"settings\") || \"{}\";\r\n    this.populate(JSON.parse(settings));\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default GameSettings;\r\n","import { SERVER_WEBSOCKET_URL } from \"../../config\";\nimport GameData from \"../../../model/game/GameData.mjs\";\nimport * as gameMessages from \"../../../model/game/gameMessage\";\n\nclass GameConnector {\n  constructor(gameId) {\n    this.gameId = gameId;\n    this.phaseDirector = null;\n    this.webSocket = null;\n    this.open = false;\n    this.connection = null;\n    this.connectionResolve = null;\n  }\n\n  init(phaseDirector) {\n    this.phaseDirector = phaseDirector;\n  }\n\n  async deactivate() {\n    const connection = await this.connection;\n    connection.close();\n  }\n\n  connect(timeout = 0) {\n    this.connection = new Promise(resolve => {\n      setTimeout(() => {\n        this.webSocket = new WebSocket(SERVER_WEBSOCKET_URL + this.gameId);\n        this.connectionResolve = resolve;\n        this.webSocket.onerror = this.onError.bind(this);\n        this.webSocket.onmessage = this.onMessage.bind(this);\n        this.webSocket.onclose = this.onClose.bind(this);\n        this.webSocket.onopen = this.onOpen.bind(this);\n      }, timeout);\n    });\n  }\n\n  async commitTurn(gameData) {\n    const connection = await this.connection;\n    connection.send(\n      JSON.stringify({\n        type: gameMessages.MESSAGE_COMMIT_TURN,\n        payload: gameData.serialize()\n      })\n    );\n  }\n\n  async commitDeployment(gameData) {\n    const connection = await this.connection;\n    connection.send(\n      JSON.stringify({\n        type: gameMessages.MESSAGE_COMMIT_DEPLOYMENT,\n        payload: gameData.serialize()\n      })\n    );\n  }\n\n  async takeSlot(slotId) {\n    const connection = await this.connection;\n    connection.send(\n      JSON.stringify({\n        type: gameMessages.MESSAGE_TAKE_SLOT,\n        payload: slotId\n      })\n    );\n  }\n\n  async leaveSlot(slotId) {\n    const connection = await this.connection;\n    connection.send(\n      JSON.stringify({\n        type: gameMessages.MESSAGE_LEAVE_SLOT,\n        payload: slotId\n      })\n    );\n  }\n\n  async buyShips(slotId, ships) {\n    const connection = await this.connection;\n    connection.send(\n      JSON.stringify({\n        type: gameMessages.MESSAGE_BUY_SHIPS,\n        payload: {\n          slotId,\n          ships: ships.map(ship => ship.serialize())\n        }\n      })\n    );\n  }\n\n  async disconnect() {\n    this.open = false;\n    (await this.connection).close();\n  }\n\n  onOpen() {\n    this.open = true;\n    this.connectionResolve(this.webSocket);\n  }\n\n  onError() {\n    console.log(\"error\");\n    console.log(arguments);\n  }\n\n  onClose() {\n    if (this.open) {\n      this.connect(2000);\n    }\n  }\n\n  onMessage({ data }) {\n    const { type, payload } = JSON.parse(data);\n    console.log(\"message received\", type);\n\n    switch (type) {\n      case gameMessages.MESSAGE_GAMEDATA:\n        this.phaseDirector.receiveGameData(new GameData(payload));\n        break;\n\n      case gameMessages.MESSAGE_TURN_CHANGED:\n        this.phaseDirector.receiveTurnChange(\n          payload.map(entry => new GameData(entry))\n        );\n        break;\n\n      case gameMessages.MESSAGE_REPLAY:\n        this.phaseDirector.receiveReplay(\n          payload.map(entry => new GameData(entry))\n        );\n        break;\n      default:\n        throw new Error(`Unrecognized websocket message type: '${type}'`);\n    }\n  }\n}\n\nexport default GameConnector;\n","export const MESSAGE_TAKE_SLOT = \"takeSlot\";\r\nexport const MESSAGE_LEAVE_SLOT = \"leaveSlot\";\r\nexport const MESSAGE_BUY_SHIPS = \"buyShips\";\r\nexport const MESSAGE_COMMIT_TURN = \"commitTurn\";\r\nexport const MESSAGE_COMMIT_DEPLOYMENT = \"commitDeployment\";\r\nexport const MESSAGE_REQUEST_REPLAY = \"requestReplay\";\r\n\r\nexport const MESSAGE_REPLAY = \"replay\";\r\nexport const MESSAGE_GAMEDATA = \"gameData\";\r\nexport const MESSAGE_TURN_CHANGED = \"turnChanged\";\r\n","import * as THREE from \"three\";\r\nimport HexagonMath from \"../../../../../model/utils/HexagonMath\";\r\nimport HexagonTexture from \"./HexagonTexture\";\r\n\r\nconst HEX_COUNT_WIDTH = 9999;\r\nconst HEX_COUNT_HEIGHT = 9999;\r\nconst HEX_LINE_COLOR = \"rgba(255,255,255,255)\";\r\nconst HEX_FILL_COLOR = \"rgba(0,0,0,0)\";\r\nconst HEX_LINE_WIDTH = 20;\r\nconst HEX_CANVAS_SIZE = 1024;\r\nconst HEX_OPACITY = 0.1;\r\n//const HEX_MAX_OPACITY = 0.3;\r\n\r\nconst getGeometryWidth = () => HexagonMath.getGridWidth(HEX_COUNT_WIDTH);\r\n\r\nconst getGeometryHeight = () => HexagonMath.getGridHeight(HEX_COUNT_HEIGHT);\r\n\r\nclass HexGridRenderer {\r\n  constructor() {\r\n    this.material = null;\r\n    this.mesh = null;\r\n    this.minZoom = 0;\r\n    this.maxZoom = 0;\r\n    this.hexSize = 128;\r\n  }\r\n\r\n  renderHexGrid(scene, minZoom, maxZoom) {\r\n    this.minZoom = minZoom;\r\n    this.maxZoom = maxZoom;\r\n\r\n    const width = getGeometryWidth();\r\n    const height = getGeometryHeight();\r\n\r\n    const texture = HexagonTexture.getHexGridTexture(\r\n      HEX_CANVAS_SIZE,\r\n      HEX_COUNT_WIDTH,\r\n      HEX_COUNT_HEIGHT,\r\n      HEX_LINE_COLOR,\r\n      HEX_FILL_COLOR,\r\n      HEX_LINE_WIDTH\r\n    );\r\n\r\n    const geometry = new THREE.PlaneGeometry(width, height, 1, 1);\r\n    this.material = new THREE.MeshBasicMaterial({\r\n      map: texture,\r\n      transparent: true,\r\n      opacity: HEX_OPACITY,\r\n      depthWrite: false\r\n    });\r\n    this.mesh = new THREE.Mesh(geometry, this.material);\r\n    this.mesh.position.x += HexagonMath.getHexB() / 2;\r\n    this.mesh.name = \"hexgrid\";\r\n\r\n    scene.add(this.mesh);\r\n  }\r\n\r\n  onZoom = function(zoom) {\r\n    if (zoom > 1) {\r\n      //this.material.opacity = (HEX_MAX_OPACITY - HEX_OPACITY) * ((zoom - 1) / (this.maxZoom - 1)) + HEX_OPACITY;\r\n    } else {\r\n      //this.material.opacity = zoom * HEX_OPACITY;\r\n    }\r\n  };\r\n}\r\n\r\nexport default HexGridRenderer;\r\n","import * as THREE from \"three\";\r\nimport Vector from \"../../../model/utils/Vector.mjs\";\r\nimport { degreeToRadian } from \"../../../model/utils/math.mjs\";\r\nimport { ZOOM_PERSPECTIVE_MIN } from \"../../../model/gameConfig.mjs\";\r\n\r\nclass GameCamera {\r\n  constructor(zoom, width, height, z) {\r\n    this.ortho = new THREE.OrthographicCamera(\r\n      (zoom * width) / -2,\r\n      (zoom * width) / 2,\r\n      (zoom * height) / 2,\r\n      (zoom * height) / -2,\r\n      -40000,\r\n      40000\r\n    );\r\n\r\n    this.z = z;\r\n\r\n    this.ortho.position.set(0, 0, z);\r\n    this.orthoCameraAngle = 0;\r\n\r\n    this.perspectiveRatio = 10;\r\n    this.perspectiveFieldOfView = 25;\r\n\r\n    this.perspective = new THREE.PerspectiveCamera(\r\n      this.perspectiveFieldOfView,\r\n      width / height,\r\n      1,\r\n      100000\r\n    );\r\n\r\n    this.perspectiveCameraDistance = 1;\r\n\r\n    this.closeAngle = -z * 0.5;\r\n\r\n    this.setCameraAngle(this.closeAngle);\r\n\r\n    this.current = this.perspective;\r\n    window.gameCamera = this;\r\n  }\r\n\r\n  changeToMapView() {\r\n    this.setCameraAngle(0);\r\n    this.current = this.ortho;\r\n  }\r\n\r\n  changeToCloseView() {\r\n    this.setCameraAngle(this.closeAngle);\r\n    this.current = this.perspective;\r\n  }\r\n\r\n  solvePerspectiveSize() {\r\n    const adjacent = this.perspective.position.z;\r\n    const hypotenuse =\r\n      adjacent / Math.cos(degreeToRadian(this.perspectiveFieldOfView / 2));\r\n\r\n    const opposite =\r\n      Math.sin(degreeToRadian(this.perspectiveFieldOfView / 2)) * hypotenuse;\r\n\r\n    return {\r\n      width: opposite * 3 * this.perspective.aspect,\r\n      height: opposite * 2\r\n    };\r\n  }\r\n\r\n  changeCamera() {\r\n    if (this.current === this.perspective) {\r\n      this.current = this.ortho;\r\n    } else {\r\n      this.current = this.perspective;\r\n    }\r\n  }\r\n\r\n  zoomPerspective(zoom, width, height) {\r\n    const current = this.solvePerspectiveSize();\r\n    const perspectiveZoom = current.height / (height * zoom);\r\n    this.perspectiveCameraDistance /= perspectiveZoom;\r\n\r\n    if (this.perspectiveCameraDistance < ZOOM_PERSPECTIVE_MIN) {\r\n      this.perspectiveCameraDistance = ZOOM_PERSPECTIVE_MIN;\r\n    }\r\n\r\n    this.setPerspectiveCameraPositionByLookat(this.getLookAtPosition());\r\n  }\r\n\r\n  zoomCamera(zoom, width, height) {\r\n    this.ortho.left = (zoom * width) / -2;\r\n    this.ortho.right = (zoom * width) / 2;\r\n    this.ortho.top = (zoom * height) / 2;\r\n    this.ortho.bottom = (zoom * height) / -2;\r\n\r\n    this.perspective.aspect = width / height;\r\n    this.perspective.zoom = 1;\r\n    this.zoomPerspective(zoom, width, height);\r\n    //this.perspective.position.z = 1000;\r\n    this.perspective.updateProjectionMatrix();\r\n    this.ortho.updateProjectionMatrix();\r\n    this.ortho.updateMatrixWorld();\r\n  }\r\n\r\n  getPosition() {\r\n    return new Vector(this.current.position);\r\n  }\r\n\r\n  getLookAtPosition() {\r\n    return new Vector(\r\n      this.ortho.position.x,\r\n      this.ortho.position.y - this.orthoCameraAngle,\r\n      this.ortho.position.z - this.z\r\n    );\r\n  }\r\n\r\n  setByLookAtPosition(position) {\r\n    this.ortho.position.x = position.x;\r\n    this.ortho.position.y = position.y + this.orthoCameraAngle;\r\n    this.setPerspectiveCameraPositionByLookat(this.getLookAtPosition());\r\n  }\r\n\r\n  addPosition(position) {\r\n    this.ortho.position.x += position.x;\r\n    this.ortho.position.y += position.y;\r\n    this.perspective.position.x += position.x;\r\n    this.perspective.position.y += position.y;\r\n  }\r\n\r\n  setPosition(position) {\r\n    this.ortho.position.x = position.x;\r\n    this.ortho.position.y = position.y;\r\n    this.perspective.position.x += position.x;\r\n    this.perspective.position.y += position.y;\r\n  }\r\n\r\n  getCamera() {\r\n    return this.current;\r\n  }\r\n\r\n  setPerspectiveCameraPositionByLookat(lookAt) {\r\n    const perspectivePositionVector = new Vector(\r\n      0,\r\n      this.orthoCameraAngle / this.perspectiveRatio,\r\n      this.z / this.perspectiveRatio\r\n    ).normalize();\r\n\r\n    const perspectivePosition = new Vector(lookAt).add(\r\n      perspectivePositionVector.multiplyScalar(this.perspectiveCameraDistance)\r\n    );\r\n\r\n    this.perspective.position.set(\r\n      perspectivePosition.x,\r\n      perspectivePosition.y,\r\n      perspectivePosition.z\r\n    );\r\n\r\n    this.perspective.lookAt(new Vector(lookAt).toThree());\r\n  }\r\n\r\n  setCameraAngle(newAngle) {\r\n    if (newAngle > 0) {\r\n      newAngle = 0;\r\n    }\r\n\r\n    if (newAngle < -this.z) {\r\n      newAngle = -this.z;\r\n    }\r\n\r\n    const currentLookat = this.getLookAtPosition().toThree();\r\n\r\n    const delta = this.orthoCameraAngle - newAngle;\r\n\r\n    this.ortho.position.set(\r\n      this.ortho.position.x,\r\n      this.ortho.position.y - delta,\r\n      this.ortho.position.z\r\n    );\r\n    this.ortho.lookAt(currentLookat);\r\n    this.orthoCameraAngle = newAngle;\r\n\r\n    this.setPerspectiveCameraPositionByLookat(currentLookat);\r\n  }\r\n}\r\n\r\nexport default GameCamera;\r\n","import * as THREE from \"three\";\nimport HexGridRenderer from \"./renderer/hexgrid/HexGridRender\";\nimport StarField from \"./terrain/StarField\";\nimport { ZOOM_MAX, ZOOM_MIN } from \"../../../model/gameConfig\";\nimport { ParticleEmitterContainer } from \"./animation/particle\";\nimport LineSprite from \"./renderer/sprite/LineSprite\";\nimport Vector from \"../../../model/utils/Vector.mjs\";\nimport { loadObject } from \"./utils/objectLoader\";\nimport GameCamera from \"./GameCamera\";\nimport TorpedoObject from \"./renderer/ships/TorpedoObject\";\nimport TorpedoFlight from \"../../../model/unit/TorpedoFlight.mjs\";\n\nwindow.THREE = THREE;\n\nclass GameScene {\n  constructor(phaseDirector, coordinateConverter) {\n    this.phaseDirector = phaseDirector;\n    this.coordinateConverter = coordinateConverter;\n    this.hexGridRenderer = new HexGridRenderer();\n    this.particleEmitterContainer = null;\n    this.scene = null;\n    this.camera = null;\n    this.starFieldScene = null;\n    this.starFieldCamera = null;\n    this.starField = null;\n    this.width = null;\n    this.height = null;\n\n    this.element = null;\n\n    this.initialized = false;\n\n    this.zoom = 1;\n    this.zoomTarget = this.zoom;\n\n    this.cameraAngle = 0; //-500;\n\n    this.deactivated = false;\n  }\n\n  init(element, { width, height }, gameId) {\n    this.element = element;\n\n    this.scene = new THREE.Scene();\n\n    this.particleEmitterContainer = new ParticleEmitterContainer(\n      this.scene,\n      2000\n    );\n\n    this.width = width;\n    this.height = height;\n\n    this.camera = new GameCamera(this.zoom, this.width, this.height, 10000);\n\n    this.coordinateConverter.init(this.camera, this.scene);\n    this.phaseDirector.init(\n      this.scene,\n      this.particleEmitterContainer,\n      this.camera\n    );\n\n    this.starFieldScene = new THREE.Scene();\n    this.starFieldCamera = new THREE.OrthographicCamera(\n      (this.zoom * this.width) / -2,\n      (this.zoom * this.width) / 2,\n      (this.zoom * this.height) / 2,\n      (this.zoom * this.height) / -2,\n      -4000,\n      30000\n    );\n\n    this.starFieldCamera.position.set(0, 0, 500);\n    this.starFieldCamera.lookAt(0, 0, 100);\n\n    this.light = new THREE.PointLight(0xffffff, 1.0, 0);\n    this.light.position.set(0, 0, 100000);\n    this.scene.add(this.light);\n\n    const directionalLight = new THREE.DirectionalLight(0x35527a, 0.005);\n    directionalLight.position.set(0, 0, 1).normalize();\n    this.scene.add(directionalLight);\n\n    /*\n    const directionalLight3 = new THREE.DirectionalLight(0xffffff, 0.8);\n    directionalLight3.position.set(0, 1, 1).normalize();\n    directionalLight3.castShadow = true;\n    //this.scene.add(directionalLight3);\n    this.directionalLight3 = directionalLight3;\n\n    //const directionalLight4 = new THREE.DirectionalLight(0x609dc1, 0.5);\n    const directionalLight4 = new THREE.DirectionalLight(0xfff3a6, 0.02);\n    directionalLight4.position.set(0, -1, 1);\n    //this.scene.add(directionalLight4);\n*/\n    /*\n    const line = new Line(\n      this.scene,\n      { x: 406.5864317029974, y: 534.742785792575, z: 0 },\n      { x: 567.692147554496, y: 627.757214207425, z: 0 },\n      2,\n      new THREE.Color(1, 0, 0)\n    );\n\n    new Line(\n      this.scene,\n      { x: 0, y: 0, z: 0 },\n      { x: 0, y: 0, z: 100 },\n      2,\n      new THREE.Color(1, 0, 0)\n    );\n\n    */\n    /*\n    const line2 = new Line(\n      { x: 0, y: 0, z: 0 },\n      { x: 0, y: 2000, z: 0 },\n      10,\n      new THREE.Color(1, 0, 0)\n    );\n    this.scene.add(line2.mesh);\n    */\n\n    /*\n    const helper = new THREE.DirectionalLightHelper(directionalLight4, 5);\n\n    this.scene.add(helper);\n    */\n\n    //this.scene.add(new THREE.AmbientLight(0x0a0f17));\n    this.renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.renderer.setSize(this.width, this.height);\n    this.renderer.autoClear = false;\n    this.renderer.context.getExtension(\"OES_standard_derivatives\");\n    this.renderer.shadowMap.enabled = true;\n    this.renderer.shadowMap.type = THREE.PCFShadowMap;\n    this.renderer.gammaOutput = true;\n    this.renderer.gammaFactor = 2.2;\n\n    element.appendChild(this.renderer.domElement);\n\n    this.initialized = true;\n    this.hexGridRenderer.renderHexGrid(this.scene, ZOOM_MIN, ZOOM_MAX);\n    this.starField = new StarField(this.starFieldScene, gameId);\n\n    this.render();\n  }\n\n  scroll(delta) {\n    this.moveCamera({\n      x: delta.x * (1 / this.zoom),\n      y: delta.y * (1 / this.zoom)\n    });\n  }\n\n  moveCamera(position) {\n    if (!this.initialized) {\n      return;\n    }\n\n    this.camera.addPosition({\n      x: position.x * this.zoom * this.zoom * -1,\n      y: position.y * this.zoom * this.zoom\n    });\n    //this.camera.position.x -= position.x * this.zoom * this.zoom;\n    //this.camera.position.y += position.y * this.zoom * this.zoom;\n    this.starFieldCamera.position.x -=\n      position.x * this.zoom * this.zoom * 0.05;\n    this.starFieldCamera.position.y +=\n      position.y * this.zoom * this.zoom * 0.05;\n\n    this.phaseDirector.relayEvent(\"ScrollEvent\", this.camera.getPosition());\n  }\n\n  moveCameraTo(position) {\n    if (!this.initialized) {\n      return;\n    }\n\n    this.camera.setPosition({ x: position.x, y: position.y });\n\n    //this.camera.position.x = position.x;\n    //this.camera.position.y = position.y;\n    this.starFieldCamera.position.x = position.x * 0.1;\n    this.starFieldCamera.position.y = position.y * 0.1;\n\n    this.phaseDirector.relayEvent(\"ScrollEvent\", this.camera.getPosition());\n  }\n\n  zoomCamera(zoom, animationReady) {\n    this.zoom = zoom;\n\n    if (!this.initialized) {\n      return;\n    }\n\n    this.camera.zoomCamera(this.zoom, this.width, this.height);\n    this.coordinateConverter.onZoom(this.zoom);\n    this.hexGridRenderer.onZoom(this.zoom);\n\n    this.phaseDirector.relayEvent(\"ZoomEvent\", {\n      zoom: this.zoom,\n      animationReady: Boolean(animationReady)\n    });\n  }\n\n  render() {\n    if (this.deactivated) {\n      return;\n    }\n\n    this.phaseDirector.render(this.scene, this.coordinateConverter, this.zoom);\n\n    this.renderer.clear();\n    this.renderer.render(this.starFieldScene, this.starFieldCamera);\n    this.renderer.clearDepth();\n    this.renderer.render(this.scene, this.camera.getCamera());\n\n    this.animateZoom();\n    this.starField.render();\n\n    requestAnimationFrame(this.render.bind(this));\n  }\n\n  animateZoom() {\n    if (this.zoomTarget && this.zoomTarget !== this.zoom) {\n      var change = (this.zoomTarget - this.zoom) * 0.1;\n      if (\n        Math.abs(change) < 0.00001 ||\n        (this.zoomTarget === 1 && Math.abs(change) < 0.00001)\n      ) {\n        this.zoomCamera(this.zoomTarget, true);\n      } else {\n        this.zoomCamera(this.zoom + change);\n      }\n    }\n  }\n\n  onResize({ width, height }) {\n    this.width = width;\n    this.height = height;\n\n    this.zoomCamera(this.zoom);\n\n    this.renderer.setSize(window.innerWidth, window.innerHeight);\n    this.starField.resize();\n  }\n\n  changeZoom(zoom) {\n    zoom *= 0.5;\n    if (zoom < -0.5) zoom = -0.5;\n\n    this.zoominprogress = false;\n    var newzoom = this.zoom + this.zoom * zoom;\n\n    if (newzoom < ZOOM_MIN) newzoom = ZOOM_MIN;\n\n    if (newzoom > ZOOM_MAX) newzoom = ZOOM_MAX;\n\n    this.zoomTarget = newzoom;\n  }\n\n  deactivate() {\n    if (this.deactivated) {\n      return;\n    }\n\n    this.deactivated = true;\n    this.element.removeChild(this.renderer.domElement);\n    this.renderer.clear();\n    this.renderer.forceContextLoss();\n    this.renderer.domElement = null;\n    this.renderer.dispose();\n    this.renderer = null;\n  }\n}\n\nexport default GameScene;\n","import PhaseDirector from \"./phase/PhaseDirector\";\r\nimport coordinateConverter from \"../../../model/utils/CoordinateConverter\";\r\nimport PositionObject from \"./utils/PositionObject\";\r\nimport GameSettings from \"./GameSettings\";\r\nimport GameConnector from \"./GameConnector\";\r\n\r\nimport GameScene from \"./GameScene\";\r\n\r\nclass Game {\r\n  constructor(gameId, user, uiState) {\r\n    this.gameId = gameId;\r\n    this.currentUser = user;\r\n\r\n    console.log(\"game user\", user);\r\n\r\n    this.uiState = uiState;\r\n    this.coordinateConverter = coordinateConverter;\r\n\r\n    this.gameConnector = new GameConnector(gameId);\r\n    this.phaseDirector = new PhaseDirector(\r\n      this.uiState,\r\n      this.currentUser,\r\n      this.coordinateConverter,\r\n      this.gameConnector\r\n    );\r\n    this.gameScene = new GameScene(\r\n      this.phaseDirector,\r\n      this.coordinateConverter\r\n    );\r\n    this.gameSettings = new GameSettings().load();\r\n    this.sceneElement = null;\r\n\r\n    this.init = false;\r\n\r\n    this.mouseOvered = null;\r\n    this.mouseOveredHex = null;\r\n  }\r\n\r\n  getUiState() {\r\n    return this.uiState;\r\n  }\r\n\r\n  initRender(element) {\r\n    this.sceneElement = element;\r\n    this.init = true;\r\n    this.gameScene.init(element, this.getDimensions(), this.gameId);\r\n    this.gameConnector.connect();\r\n    this.onResize();\r\n  }\r\n\r\n  onMouseWheel(step) {\r\n    this.gameScene.changeZoom(step);\r\n  }\r\n\r\n  onKeyDown(event) {\r\n    const action = this.gameSettings.matchEvent(event);\r\n    this.uiState.customEvent(action, { up: false });\r\n  }\r\n\r\n  onKeyUp(event) {\r\n    const action = this.gameSettings.matchEvent(event);\r\n    this.uiState.customEvent(action, { up: true });\r\n  }\r\n\r\n  onMouseUp(position, button) {\r\n    if (!this.init) {\r\n      return;\r\n    }\r\n\r\n    const gamePos = this.coordinateConverter.fromViewPortToGame(position);\r\n    const entity = this.coordinateConverter\r\n      .getEntitiesIntersected(position, true)\r\n      .shift();\r\n    const hexPos = this.coordinateConverter.fromGameToHex(gamePos, true);\r\n\r\n    const payload = new PositionObject(position, gamePos, hexPos, entity);\r\n    console.log(payload.hex);\r\n\r\n    if (button && button === 2 && entity) {\r\n      this.phaseDirector.relayEvent(\"shipRightClicked\", payload);\r\n    } else if (entity) {\r\n      this.phaseDirector.relayEvent(\"shipClicked\", payload);\r\n    } else {\r\n      this.phaseDirector.relayEvent(\"hexClicked\", payload);\r\n    }\r\n  }\r\n\r\n  onDrag(position, delta) {\r\n    this.gameScene.scroll(delta);\r\n  }\r\n\r\n  onMouseMove(position) {\r\n    const gamePos = this.coordinateConverter.fromViewPortToGame(position);\r\n    const hexPos = this.coordinateConverter.fromGameToHex(gamePos);\r\n    const entity = this.coordinateConverter\r\n      .getEntitiesIntersected(position)\r\n      .shift();\r\n\r\n    const payload = new PositionObject(position, gamePos, hexPos, entity);\r\n\r\n    if (this.mouseOvered && entity && this.mouseOvered != entity) {\r\n      this.phaseDirector.relayEvent(\"mouseOutShip\", {\r\n        ...payload,\r\n        entity: this.mouseOvered\r\n      });\r\n\r\n      this.phaseDirector.relayEvent(\"mouseOverShip\", payload);\r\n      this.mouseOvered = entity;\r\n    } else if (this.mouseOvered == null && entity) {\r\n      this.phaseDirector.relayEvent(\"mouseOverShip\", payload);\r\n      this.mouseOvered = entity;\r\n    } else if (this.mouseOvered && !entity) {\r\n      this.phaseDirector.relayEvent(\"mouseOutShip\", {\r\n        ...payload,\r\n        entity: this.mouseOvered\r\n      });\r\n      this.mouseOvered = null;\r\n    }\r\n\r\n    if (!entity) {\r\n      if (this.mouseOveredHex && !this.mouseOveredHex.equals(payload.hex)) {\r\n        this.phaseDirector.relayEvent(\"mouseOutHex\", this.mouseOveredHex);\r\n        this.phaseDirector.relayEvent(\"mouseOverHex\", payload.hex);\r\n        this.mouseOveredHex = payload.hex;\r\n      } else if (!this.mouseOveredHex) {\r\n        this.phaseDirector.relayEvent(\"mouseOverHex\", payload.hex);\r\n        this.mouseOveredHex = payload.hex;\r\n      }\r\n    } else if (entity && this.mouseOveredHex) {\r\n      this.phaseDirector.relayEvent(\"mouseOutHex\", this.mouseOveredHex);\r\n      this.mouseOveredHex = null;\r\n    }\r\n  }\r\n\r\n  onMouseOut() {\r\n    this.phaseDirector.relayEvent(\"mouseOut\");\r\n  }\r\n\r\n  onResize() {\r\n    if (!this.sceneElement) {\r\n      return;\r\n    }\r\n\r\n    const dimensions = this.getDimensions();\r\n    this.coordinateConverter.onResize(dimensions);\r\n    this.gameScene.onResize(dimensions);\r\n  }\r\n\r\n  getDimensions() {\r\n    return {\r\n      width: this.sceneElement.offsetWidth,\r\n      height: this.sceneElement.offsetHeight\r\n    };\r\n  }\r\n\r\n  deactivate() {\r\n    console.log(\"deactivate game\");\r\n    this.gameConnector.deactivate();\r\n    this.phaseDirector.deactivate();\r\n    this.gameScene.deactivate();\r\n  }\r\n}\r\n\r\nexport default Game;\r\n","import * as gameUiModes from \"./gameUiModes\";\nimport { HEX_SIZE } from \"../../../../model/gameConfig.mjs\";\nimport { angleToHexFacing } from \"../../../../model/utils/math.mjs\";\n\nclass UIState {\n  constructor() {\n    console.log(\"construct new UiState\");\n    this.phaseDirector = null;\n    this.services = null;\n\n    this.renderListeners = [];\n\n    this.systemChangeListeners = [];\n\n    this.state = {\n      lobby: false,\n      gameData: null,\n      selectedShip: null,\n      selectedSystems: [],\n      systemInfo: null,\n      systemInfoMenu: null,\n      shipMovement: null,\n      shipTooltip: [],\n      turnReady: false,\n      shipTooltipMenuProvider: null,\n      systemMenu: {\n        systemInfoMenuProvider: null,\n        activeSystem: null,\n        activeSystemElement: null\n      },\n      shipBadges: [],\n      gameUiMode: {},\n      gameUiModeButtons: false,\n      replayUi: false,\n      combatLog: false,\n      systemList: [],\n      ewList: [],\n      stateVersion: 0\n    };\n\n    this.state.gameUiMode[gameUiModes.EW] = false;\n    this.state.gameUiMode[gameUiModes.ENEMY_WEAPONS] = false;\n    this.state.gameUiMode[gameUiModes.WEAPONS] = false;\n    this.state.gameUiMode[gameUiModes.MOVEMENT] = false;\n  }\n\n  setDispatch(dispatch) {\n    this.dispatch = dispatch;\n  }\n\n  getReducer() {\n    return this.reducer.bind(this);\n  }\n\n  getInitialState() {\n    return this.state;\n  }\n\n  reducer(state, action) {\n    this.state = {\n      ...state,\n      ...action\n    };\n\n    return this.state;\n  }\n\n  showShipBadge(icon, showName) {\n    const { coordinateConverter } = this.services;\n    const entry = this.state.shipBadges.find(\n      badge => badge.icon.ship.id === icon.ship.id\n    );\n\n    const getPosition = () => {\n      const iconPosition = icon.getPosition();\n      const iconFacing = icon.getFacing();\n      const hexFacing = angleToHexFacing(iconFacing);\n      const offset = HEX_SIZE - 15;\n\n      const hexas = icon.getShipHexas().map(gamePos => {\n        gamePos.y -= offset;\n\n        return coordinateConverter.fromGameToViewPort(gamePos);\n      });\n\n      let lowestY = null;\n      let lowestHexas = [];\n\n      hexas.forEach(hex => {\n        if (lowestY === null || hex.y > lowestY) {\n          lowestHexas = [hex];\n          lowestY = hex.y;\n        } else if (hex.y === lowestY) {\n          lowestHexas.push(hex);\n        }\n      });\n\n      const averageX =\n        lowestHexas.reduce((total, hex) => total + hex.x, 0) /\n        lowestHexas.length;\n\n      const position = {\n        x: averageX,\n        y: lowestY\n      };\n\n      return position;\n    };\n\n    if (entry) {\n      entry.icon = icon;\n      entry.version++;\n      entry.getPosition = getPosition;\n      entry.showName = showName;\n    } else {\n      this.state.shipBadges.push({\n        icon,\n        version: 0,\n        getPosition,\n        showName\n      });\n    }\n\n    this.updateState();\n  }\n\n  hideShipBadge(icon) {\n    this.state.shipBadges = this.state.shipBadges.filter(\n      entry => entry.icon.ship.id !== icon.ship.id\n    );\n\n    this.updateState();\n  }\n\n  setEwList(entries) {\n    this.state.ewList = entries;\n  }\n\n  setSystemList(systems) {\n    this.state.systemList = systems;\n    this.updateState();\n  }\n\n  isSelectedSystem(system) {\n    return this.state.selectedSystems.includes(system);\n  }\n\n  selectSystem(ship, systems) {\n    if (this.getSelectedShip() !== ship) {\n      this.selectShip(ship);\n    }\n\n    systems = []\n      .concat(systems)\n      .filter(system => !this.isSelectedSystem(system))\n      .forEach(system => this.state.selectedSystems.push(system));\n\n    this.updateState();\n    this.customEvent(\"systemSelected\", { systems });\n  }\n\n  deselectSystem(systems) {\n    systems = [].concat(systems);\n\n    this.state.selectedSystems = this.state.selectedSystems.filter(selected =>\n      systems.every(system => system.id !== selected.id)\n    );\n\n    this.updateState();\n    this.customEvent(\"systemDeselected\", { systems });\n  }\n\n  deselectAllSystems() {\n    const systems = this.state.selectedSystems;\n    this.state.selectedSystems = [];\n    this.updateState();\n    this.customEvent(\"systemDeselected\", { systems });\n  }\n\n  getSelectedSystems() {\n    return this.state.selectedSystems;\n  }\n\n  hasGameUiMode(values) {\n    values = [].concat(values);\n    return values.some(value => this.state.gameUiMode[value]);\n  }\n\n  toggleGameUiMode(value) {\n    this.state.gameUiMode[value] = !this.state.gameUiMode[value];\n    this.updateState();\n  }\n\n  showUiModeButtons(value) {\n    this.state.gameUiModeButtons = value;\n    this.updateState();\n  }\n\n  showReplayUi(value) {\n    this.state.replayUi = value;\n    this.updateState();\n  }\n\n  startCombatLog(replayContext, gameData) {\n    this.state.combatLog = {\n      gameData,\n      replayContext,\n      log: []\n    };\n  }\n\n  addToCombatLog(value) {\n    if (this.state.combatLog === false) {\n      throw new Error(\"Start combat log first\");\n    }\n\n    this.state.combatLog.log.push(value);\n    this.updateState();\n  }\n\n  hideCombatLog() {\n    this.state.combatLog = false;\n    this.updateState();\n  }\n\n  startReplay() {\n    this.phaseDirector.startReplay();\n    this.updateState();\n  }\n\n  closeReplay() {\n    this.phaseDirector.closeReplay();\n    this.updateState();\n  }\n\n  isReplay() {\n    return this.state.replay;\n  }\n\n  update(gameData) {\n    this.gameData = gameData;\n    if (this.state.selectedShip) {\n      this.selectShip(\n        this.gameData.ships.getShipById(this.state.selectedShip.id)\n      );\n\n      this.selectSystem(\n        this.getSelectedShip(),\n        this.state.selectedSystems.map(system =>\n          this.getSelectedShip().systems.getSystemById(system.id)\n        )\n      );\n    }\n  }\n\n  setTurnReady(ready) {\n    this.state.turnReady = ready;\n    this.updateState();\n  }\n\n  setWaiting(waiting) {\n    this.state.waiting = waiting;\n    this.updateState();\n  }\n\n  setPhaseDirector(phaseDirector) {\n    this.phaseDirector = phaseDirector;\n    this.services = phaseDirector.getServices();\n  }\n\n  customEvent(name, payload) {\n    if (!this.phaseDirector) {\n      return;\n    }\n\n    this.phaseDirector.relayEvent(name, payload);\n  }\n\n  commitTurn() {\n    this.phaseDirector.commitTurn();\n  }\n\n  selectShip(ship) {\n    if (this.getSelectedShip() === ship) {\n      return;\n    }\n\n    this.deselectShip();\n    this.state.selectedShip = ship;\n    this.updateState();\n    this.customEvent(\"shipSelected\", ship);\n  }\n\n  deselectShip() {\n    const ship = this.state.selectedShip;\n    this.state.selectedShip = null;\n    this.updateState();\n    this.deselectAllSystems();\n    if (ship) {\n      this.customEvent(\"shipDeselected\", ship);\n    }\n  }\n\n  getSelectedShip() {\n    return this.state.selectedShip;\n  }\n\n  isSelected(ship) {\n    return this.state.selectedShip === ship;\n  }\n\n  updateState() {\n    //this.state.stateVersion++;\n    this.dispatch(this.state);\n    this.customEvent(\"uiStateChanged\");\n  }\n\n  setTooltipMenuProvider(callBack) {\n    this.state.shipTooltipMenuProvider = callBack;\n    this.updateState();\n  }\n\n  setSystemInfoMenuProvider(callBack) {\n    this.state.systemMenu.systemInfoMenuProvider = callBack;\n    this.updateState();\n  }\n\n  setSystemMenuActiveSystem(system, element) {\n    this.state.systemMenu.activeSystem = system;\n    this.state.systemMenu.activeSystemElement = element;\n    this.updateState();\n  }\n\n  setGameData(gameData) {\n    this.state.gameData = gameData.serialize();\n    this.updateState();\n  }\n\n  setLobby(status) {\n    this.state.lobby = status;\n    this.updateState();\n  }\n\n  getState() {\n    return this.state;\n  }\n\n  showSystemInfo(args) {\n    this.state.systemInfo = args;\n    this.updateState();\n  }\n\n  hideSystemInfo() {\n    this.state.systemInfo = null;\n    this.updateState();\n  }\n\n  showSystemInfoMenu(args) {\n    this.state.systemInfoMenu = args;\n    this.updateState();\n  }\n\n  hideSystemInfoMenu() {\n    this.state.systemInfoMenu = null;\n    this.updateState();\n  }\n\n  shipStateChanged(ship) {\n    this.customEvent(\"shipStateChanged\", ship);\n  }\n\n  shipSystemStateChanged(ship, system) {\n    this.customEvent(\"shipSystemStateChanged\", { ship, system });\n    this.systemChangeListeners.forEach(callBack => callBack(ship, system));\n  }\n\n  showShipTooltip(icon, ui = false) {\n    const { coordinateConverter } = this.services;\n    const ship = icon.ship;\n\n    this.hideShipTooltip(ship);\n    this.state.shipTooltip.push({\n      ship,\n      getPosition: () =>\n        coordinateConverter.fromGameToViewPort(icon.getPosition()),\n      ui\n    });\n    this.updateState();\n  }\n\n  hideShipTooltip(ship) {\n    this.state.shipTooltip = this.state.shipTooltip.filter(\n      tooltip => tooltip.ship.id !== ship.id\n    );\n    this.updateState();\n  }\n\n  showShipDeploymentMovement(ship) {\n    const {\n      shipIconContainer,\n      coordinateConverter,\n      movementService\n    } = this.services;\n\n    this.state.shipMovement = {\n      ship,\n      type: \"deploy\",\n      movementService,\n      getPosition: () =>\n        coordinateConverter.fromGameToViewPort(\n          shipIconContainer.getByShip(ship).getPosition()\n        )\n    };\n    this.updateState();\n  }\n\n  showShipMovement(ship) {\n    const {\n      shipIconContainer,\n      coordinateConverter,\n      movementService\n    } = this.services;\n\n    this.state.shipMovement = {\n      ship,\n      type: \"game\",\n      movementService,\n      getPosition: () =>\n        coordinateConverter.fromGameToViewPort(\n          shipIconContainer.getByShip(ship).getPosition()\n        )\n    };\n    this.updateState();\n  }\n\n  hideShipMovement() {\n    this.state.shipMovement = null;\n    this.updateState();\n  }\n\n  render() {\n    this.renderListeners.forEach(listener => listener());\n  }\n\n  subscribeToRender(callBack) {\n    this.renderListeners.push(callBack);\n  }\n\n  unsubscribeFromRender(callBack) {\n    this.renderListeners = this.renderListeners.filter(\n      listener => listener !== callBack\n    );\n  }\n\n  subscribeToSystemChange(callBack) {\n    this.systemChangeListeners.push(callBack);\n  }\n\n  unsubscribeFromSystemChange(callBack) {\n    this.systemChangeListeners = this.systemChangeListeners.filter(\n      listener => listener !== callBack\n    );\n  }\n}\n\nexport default UIState;\n","import React, { Component } from \"react\";\r\n\r\nimport {\r\n  SubTitle,\r\n  DarkContainer,\r\n  Section,\r\n  SectionRight,\r\n  Button,\r\n  Value\r\n} from \"../../../../styled\";\r\nclass FleetList extends Component {\r\n  openShipWindow(ship) {\r\n    return () => {\r\n      const { uiState } = this.props;\r\n      uiState.openShipWindow(ship);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { ships, onReady, bought } = this.props;\r\n\r\n    return (\r\n      <DarkContainer>\r\n        <Section>\r\n          <SubTitle>Current fleet for slot</SubTitle>\r\n          <SectionRight>\r\n            {!bought && ships.length > 0 && (\r\n              <Button buttonStyle=\"button\" onClick={onReady}>\r\n                Ready\r\n              </Button>\r\n            )}\r\n          </SectionRight>\r\n        </Section>\r\n        {ships.map((ship, i) => (\r\n          <Button\r\n            key={`fleetlist-ship-${i}`}\r\n            buttonStyle=\"text\"\r\n            onClick={this.openShipWindow(ship)}\r\n          >\r\n            {ship.shipTypeName} <Value>{ship.pointCost}</Value> points\r\n          </Button>\r\n        ))}\r\n      </DarkContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FleetList;\r\n","import React, { Component } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nimport {\r\n  Title,\r\n  InputAndLabel,\r\n  Container,\r\n  Section,\r\n  Label,\r\n  Value,\r\n  SectionRight,\r\n  Button,\r\n  icons,\r\n  colors\r\n} from \"../../styled\";\r\n\r\nconst selected = css`\r\n  box-shadow: 0px 0px 3px 3px rgba(222, 235, 255, 0.5);\r\n  color: #0a3340;\r\n  background-color: ${colors.border};\r\n  border-color: ${colors.blue};\r\n`;\r\n\r\nconst SlotContainer = styled(Container)`\r\n  ${props => (props.selected ? selected : \"\")}\r\n`;\r\n\r\nclass Slot extends Component {\r\n  handleChange() {}\r\n\r\n  getPlayerName(slot) {\r\n    const { gameData } = this.props;\r\n\r\n    const user = gameData.players.find(user => user.id === slot.userId);\r\n    return user.username;\r\n  }\r\n\r\n  leaveSlot(slot) {\r\n    return () => {\r\n      const { uiState } = this.props;\r\n      uiState.customEvent(\"leaveSlot\", slot);\r\n    };\r\n  }\r\n\r\n  takeSlot(slot) {\r\n    return () => {\r\n      const { uiState } = this.props;\r\n      uiState.customEvent(\"takeSlot\", slot);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      slot,\r\n      edit,\r\n      take,\r\n      currentUser,\r\n      selectedSlot,\r\n      children\r\n    } = this.props;\r\n\r\n    return (\r\n      <SlotContainer selected={selectedSlot && selectedSlot.id === slot.id}>\r\n        <Section>\r\n          {edit ? (\r\n            <>\r\n              <InputAndLabel\r\n                label=\"Slot name\"\r\n                id={`slotName-${slot.name}`}\r\n                placeholder=\"slot name\"\r\n                value={slot.name}\r\n                onChange={this.handleChange}\r\n                error={!slot.name ? \"Name is required\" : false}\r\n              />\r\n\r\n              <InputAndLabel\r\n                label=\"Points\"\r\n                id={`slotPoints-${slot.name}`}\r\n                placeholder=\"5000\"\r\n                value={slot.points}\r\n                onChange={this.handleChange}\r\n                error={\r\n                  slot.points !== parseInt(slot.points, 10) || slot.points <= 0\r\n                    ? \"Points must be a positive number\"\r\n                    : false\r\n                }\r\n              />\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Title>{slot.name}</Title>\r\n              <Title>\r\n                Points: <Value>{slot.points}</Value>\r\n              </Title>\r\n              <SectionRight>\r\n                {slot.isTaken() && (\r\n                  <Title>\r\n                    Player: <Value>{this.getPlayerName(slot)}</Value>\r\n                  </Title>\r\n                )}\r\n                {currentUser && !slot.isTaken() && take && (\r\n                  <Button\r\n                    onClick={this.takeSlot(slot)}\r\n                    type=\"button\"\r\n                    buttonStyle=\"button-grey\"\r\n                  >\r\n                    Take slot\r\n                  </Button>\r\n                )}\r\n                {take && currentUser && slot.isOccupiedBy(currentUser) && (\r\n                  <Button\r\n                    onClick={this.leaveSlot(slot)}\r\n                    type=\"button\"\r\n                    icon={icons.X}\r\n                  />\r\n                )}\r\n              </SectionRight>\r\n            </>\r\n          )}\r\n        </Section>\r\n\r\n        <Section>\r\n          {edit ? (\r\n            <>\r\n              <InputAndLabel\r\n                label=\"Deployment position (X,Y):\"\r\n                id={`deploymentPosition-${slot.name}`}\r\n                placeholder=\"0\"\r\n                value={`${slot.deploymentLocation.q},${\r\n                  slot.deploymentLocation.r\r\n                }`}\r\n                onChange={this.handleChange}\r\n              />\r\n\r\n              <InputAndLabel\r\n                label=\"Deployment vector (X,Y):\"\r\n                id={`deploymentVector-${slot.name}`}\r\n                placeholder=\"0\"\r\n                value={`${slot.deploymentVector.q},${slot.deploymentVector.r}`}\r\n                onChange={this.handleChange}\r\n              />\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Label>\r\n                Deployment position:\r\n                <Value>{` ${slot.deploymentLocation.q},${\r\n                  slot.deploymentLocation.r\r\n                }`}</Value>\r\n              </Label>\r\n              <Label>\r\n                Deployment vector:\r\n                <Value>{`${slot.deploymentVector.q},${\r\n                  slot.deploymentVector.r\r\n                }`}</Value>\r\n              </Label>\r\n              <Label>\r\n                Deployment radius: <Value> {slot.deploymentRadius}</Value>\r\n              </Label>\r\n            </>\r\n          )}\r\n        </Section>\r\n\r\n        <Section>\r\n          {edit && (\r\n            <InputAndLabel\r\n              label=\"Deployment radius:\"\r\n              id={`deploymentRadius-${slot.name}`}\r\n              placeholder=\"0\"\r\n              value={slot.deploymentRadius}\r\n              onChange={this.handleChange}\r\n            />\r\n          )}\r\n        </Section>\r\n        {children}\r\n      </SlotContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Slot;\r\n","import React, { Component } from \"react\";\r\nimport FleetList from \"./FleetList\";\r\n\r\nimport Slot from \"../../../createGame/Slot\";\r\n\r\nimport { Title, DarkContainer } from \"../../../../styled\";\r\nclass LobbySlots extends Component {\r\n  mapTeamsToComponents() {\r\n    const { gameData, selectedSlot, ships, uiState, onReady } = this.props;\r\n\r\n    return gameData.slots.getSlotsByTeams().map(team => {\r\n      return (\r\n        <DarkContainer key={`team-${team.team}`}>\r\n          <Title>TEAM: {team.team}</Title>\r\n          {team.slots.map(slot => {\r\n            if (selectedSlot && slot.id === selectedSlot.id) {\r\n              return (\r\n                <Slot key={slot.id} slot={slot} {...this.props}>\r\n                  <FleetList\r\n                    bought={slot.isBought()}\r\n                    onReady={onReady}\r\n                    uiState={uiState}\r\n                    ships={ships}\r\n                  />\r\n                </Slot>\r\n              );\r\n            } else {\r\n              return <Slot key={slot.id} slot={slot} {...this.props} />;\r\n            }\r\n          })}\r\n        </DarkContainer>\r\n      );\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return <>{this.mapTeamsToComponents()}</>;\r\n  }\r\n}\r\n\r\nexport default LobbySlots;\r\n","class Faction {\r\n  constructor(name, ships) {\r\n    this.name = name;\r\n    this.ships = ships;\r\n  }\r\n}\r\n\r\nexport default [\r\n  new Faction(\"United Colonies\", [\"UcRhino\", \"Haka\"]),\r\n  new Faction(\"The Expanse Protecorate\", [\"Caliope\", \"Fulcrum\", \"Mouros\"]),\r\n  new Faction(\"Federation Navy\", [\"Impetous\"])\r\n];\r\n","import React, { Component } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  DarkContainer,\r\n  Section,\r\n  SubTitle,\r\n  Button,\r\n  Value\r\n} from \"../../../../styled\";\r\nimport ships from \"../../../../../model/unit/ships\";\r\n\r\nclass Faction extends Component {\r\n  buyShip(className) {\r\n    const { buyShip } = this.props;\r\n    return () => {\r\n      buyShip(className);\r\n    };\r\n  }\r\n\r\n  openShipWindow(ship) {\r\n    return () => {\r\n      const { uiState } = this.props;\r\n      uiState.openShipWindow(ship);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { faction } = this.props;\r\n\r\n    return (\r\n      <div>\r\n        <SubTitle>{faction.name}</SubTitle>\r\n        {faction.ships\r\n          .map(ship => new ships[ship]())\r\n          .map(ship => (\r\n            <Section key={`fleetStoreEntry-${ship.shipClass}`}>\r\n              <Button buttonStyle=\"text\" onClick={this.openShipWindow(ship)}>\r\n                {ship.shipTypeName} <Value>{ship.pointCost}</Value> points\r\n              </Button>\r\n\r\n              <Button\r\n                buttonStyle=\"button\"\r\n                onClick={this.buyShip(ship.shipClass)}\r\n              >\r\n                Add to fleet\r\n              </Button>\r\n            </Section>\r\n          ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Faction;\r\n","import React, { Component } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport factions from \"../../../../../model/unit/ships/factions\";\r\nimport Faction from \"./Faction\";\r\n\r\nimport { Title, DarkContainer, Section } from \"../../../../styled\";\r\n\r\nconst FleetContainer = styled(DarkContainer)`\r\n  flex-grow: 1;\r\n  margin-left: 10px;\r\n`;\r\n\r\nclass FleetStore extends Component {\r\n  render() {\r\n    return (\r\n      <FleetContainer>\r\n        {factions.map(faction => (\r\n          <Faction key={faction.name} faction={faction} {...this.props} />\r\n        ))}\r\n      </FleetContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FleetStore;\r\n","import React, { Component } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport GameData from \"../../../../../model/game/GameData\";\r\nimport LobbySlots from \"./LobbySlots\";\r\nimport FleetStore from \"./FleetStore\";\r\nimport shipClasses from \"../../../../../model/unit/ships\";\r\n\r\nimport { Title, PanelContainer, Section } from \"../../../../styled\";\r\n\r\nconst LobbyContainer = styled(PanelContainer)`\r\n  width: 1200px;\r\n  position: absolute;\r\n  top: 20px;\r\n  max-height: calc(100vh - 40px);\r\n  left: calc(50vw - 600px);\r\n  right: calc(50vw - 600px);\r\n  z-index: 3;\r\n`;\r\n\r\nclass Lobby extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      selectedSlot: null,\r\n      ships: []\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    let { gameData, currentUser } = nextProps;\r\n    if (!gameData) {\r\n      return prevState;\r\n    }\r\n\r\n    gameData = new GameData(gameData);\r\n\r\n    if (!prevState.selectedSlot) {\r\n      const selectedSlot =\r\n        gameData.slots\r\n          .getSlots()\r\n          .find(slot => slot.isOccupiedBy(currentUser)) || null;\r\n\r\n      const ships = selectedSlot ? selectedSlot.getShips() : [];\r\n      return {\r\n        ...prevState,\r\n        selectedSlot,\r\n        ships\r\n      };\r\n    }\r\n\r\n    return prevState;\r\n  }\r\n\r\n  selectSlot() {}\r\n\r\n  buyShip(shipClass) {\r\n    const ship = new shipClasses[shipClass]();\r\n    const { selectedSlot, ships } = this.state;\r\n\r\n    if (!selectedSlot) {\r\n      return;\r\n    }\r\n\r\n    const totalCost = [...ships, ship].reduce(\r\n      (acc, ship) => acc + ship.getPointCost(),\r\n      0\r\n    );\r\n\r\n    if (totalCost > selectedSlot.points) {\r\n      alert(\"Too costly\");\r\n      return;\r\n    }\r\n\r\n    this.setState({ ships: [...ships, ship] });\r\n  }\r\n\r\n  onReady() {\r\n    const { uiState } = this.props;\r\n    const { selectedSlot, ships } = this.state;\r\n    uiState.customEvent(\"buyShips\", { slot: selectedSlot, ships });\r\n  }\r\n\r\n  render() {\r\n    let { uiState, gameData, currentUser, game } = this.props;\r\n\r\n    const { selectedSlot, ships } = this.state;\r\n\r\n    if (!gameData) {\r\n      return null;\r\n    }\r\n\r\n    gameData = new GameData(gameData);\r\n\r\n    return (\r\n      <LobbyContainer>\r\n        <Section>\r\n          <div>\r\n            <Title>GAME: '{gameData.name}'</Title>\r\n            <Title>Take a slot and buy ships</Title>\r\n            <LobbySlots\r\n              gameData={gameData}\r\n              edit={false}\r\n              currentUser={currentUser}\r\n              take={true}\r\n              select={true}\r\n              selectedSlot={selectedSlot}\r\n              game={game}\r\n              ships={ships}\r\n              uiState={uiState}\r\n              onReady={this.onReady.bind(this)}\r\n            />\r\n          </div>\r\n          <FleetStore uiState={uiState} buyShip={this.buyShip.bind(this)} />\r\n        </Section>\r\n      </LobbyContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Lobby;\r\n","import Lobby from \"./Lobby\";\r\n\r\nexport default Lobby;\r\n","import ShipTooltip from \"./ShipTooltip\";\r\n\r\nexport default ShipTooltip;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  ContainerRoundedRightBottom,\r\n  Title,\r\n  icons,\r\n  SectionRight,\r\n  Section,\r\n  colors,\r\n  TooltipButton\r\n} from \"../../../styled\";\r\nimport * as gamePhases from \"../../../../model/game/gamePhases\";\r\n\r\nconst TurnHeaderContainer = styled.div`\r\n  position: absolute;\r\n  top: -1px;\r\n  left: -1px;\r\n  padding-right: 10px;\r\n  z-index: 3;\r\n`;\r\n\r\nconst ReadySection = styled(SectionRight)`\r\n  align-items: center;\r\n`;\r\n\r\nconst ReadyContainer = styled.div`\r\n  ${props => (props.ready ? \"cursor:pointer;\" : \"cursor:not-allowed;\")}\r\n`;\r\n\r\nclass TurnHeader extends React.PureComponent {\r\n  onReady() {\r\n    const { uiState, ready } = this.props;\r\n\r\n    if (!ready) {\r\n      return;\r\n    }\r\n\r\n    uiState.commitTurn();\r\n  }\r\n\r\n  render() {\r\n    const { gameData, ready, waiting } = this.props;\r\n    return (\r\n      <TurnHeaderContainer>\r\n        <Section>\r\n          <Title>\r\n            {`TURN: ${gameData.turn}`}{\" \"}\r\n            {gameData.phase === gamePhases.DEPLOYMENT && \"DEPLOYMENT\"}\r\n            {waiting && \" Waiting\"}\r\n          </Title>\r\n          {!waiting && (\r\n            <ReadySection>\r\n              <TooltipButton onClick={this.onReady.bind(this)}>\r\n                <icons.CheckMark />\r\n              </TooltipButton>\r\n            </ReadySection>\r\n          )}\r\n        </Section>\r\n      </TurnHeaderContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TurnHeader;\r\n","import * as React from \"react\";\nimport styled, { css } from \"styled-components\";\n\nconst Container = styled.div`\n  position: absolute;\n  left: 50%;\n  bottom: 125px;\n  opacity: 0.85;\n  user-select: none;\n  z-index: 3;\n`;\n\nconst Text = css`\n  color: white;\n  font-family: arial;\n  font-size: 16px;\n  text-transform: uppercase;\n`;\n\nconst TextContainer = styled.div`\n  ${Text}\n  position: absolute;\n  width: 600px;\n  left: calc(50% - 300px);\n  bottom: 0;\n  padding: 2px 0;\n  /* background-color: rgba(0, 0, 0, 0.5); */\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  text-shadow: black 0px 0px 13px, black 0px 0px 13px, black 0px 0px 13px;\n  cursor: default;\n`;\n\nconst Power = styled.div`\n  ${Text}\n  font-size: 36px;\n  font-weight: bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  width: 50px;\n  height: 60px;\n  left: -25px;\n  bottom: -30px;\n`;\n\nconst TextRow = styled.div`\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  margin: 5px 0 0 0;\n\n  div {\n    padding: 0 5px;\n    white-space: nowrap;\n  }\n`;\n\nconst TextRowSmall = styled(TextRow)`\n  font-size: 14px;\n  text-transform: none;\n`;\n\nclass Movement extends React.Component {\n  render() {\n    const { ship, movementService, children, ui = true } = this.props;\n\n    return (\n      <>\n        <Container id=\"shipMovementActual\">\n          {children}\n          {ui && <Power>{ship.movement.getRemainingThrustOutput()}</Power>}\n        </Container>\n      </>\n    );\n  }\n}\n\nexport default Movement;\n","import styled, { css } from \"styled-components\";\nimport { Clickable } from \"../../../../styled\";\n\nconst Container = styled.div`\n  position: absolute;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0.5;\n\n  svg #svg-path {\n    fill: white;\n    ${props => props.overChannel && \"fill:#4c7ca8;\"}\n    ${props => props.disabled && \"fill: #8f2626;\"}\n  }\n  ${Clickable}\n\n  ${props =>\n    props.active &&\n    css`\n      animation: blinker 1s linear infinite;\n\n      @keyframes blinker {\n        50% {\n          opacity: 0;\n        }\n      }\n    `}\n`;\n\nexport default Container;\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport { Arrow } from \"../../../../styled/icon\";\nimport {\n  getPointInDirection,\n  hexFacingToAngle\n} from \"../../../../../model/utils/math\";\n\nimport Container from \"./Container\";\n\nconst ButtonContainer = styled(Container)`\n\n  ${props => `transform: rotate(${props.direction + 90}deg);`}\n\n  ${props => `left: calc(${props.x}px - 16px);`}\n  ${props => `top: calc(${props.y}px - 16px);`}\n`;\n\nclass ThrustButton extends React.Component {\n  getPosition(direction) {\n    return getPointInDirection(75, -hexFacingToAngle(direction), 0, 0);\n  }\n\n  canThrust() {\n    const { ship, movementService, direction } = this.props;\n    return movementService.canThrust(ship, direction);\n  }\n\n  thrust(can) {\n    if (!can) {\n      return;\n    }\n\n    const { ship, movementService, direction } = this.props;\n    return movementService.thrust(ship, direction);\n  }\n\n  render() {\n    const { direction } = this.props;\n\n    const can = this.canThrust();\n    const { overChannel } = can;\n\n    return (\n      <ButtonContainer\n        overChannel={overChannel}\n        disabled={!can}\n        direction={hexFacingToAngle(direction)}\n        onClick={this.thrust.bind(this, can)}\n        {...this.getPosition(direction)}\n      >\n        <Arrow />\n      </ButtonContainer>\n    );\n  }\n}\n\nexport default ThrustButton;\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Clickable } from \"../../../../styled\";\r\nimport { Cancel } from \"../../../../styled/icon\";\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  width: 32px;\r\n  height: 32px;\r\n  left: 125px;\r\n  top: 53px;\r\n  ${Clickable}\r\n`;\r\n\r\nclass RevertButton extends React.Component {\r\n  canRevert() {\r\n    const { movementService, ship } = this.props;\r\n    return movementService.canRevert(ship);\r\n  }\r\n\r\n  revert() {\r\n    const { movementService, ship } = this.props;\r\n    return movementService.revert(ship);\r\n  }\r\n\r\n  render() {\r\n    if (!this.canRevert()) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Container onClick={this.revert.bind(this)}>\r\n        <Cancel />\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RevertButton;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { X } from \"../../../../styled/icon\";\r\nimport Container from \"./Container\";\r\n\r\nconst ButtonContainer = styled(Container)`\r\n  left: -175px;\r\n  top: 53px;\r\n`;\r\n\r\nclass CancelButton extends React.Component {\r\n  canCancel() {\r\n    const { movementService, ship } = this.props;\r\n    return movementService.canCancel(ship);\r\n  }\r\n\r\n  cancel() {\r\n    const { movementService, ship } = this.props;\r\n    return movementService.cancel(ship);\r\n  }\r\n\r\n  render() {\r\n    if (!this.canCancel()) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <ButtonContainer onClick={this.cancel.bind(this)}>\r\n        <X />\r\n      </ButtonContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CancelButton;\r\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport { Pivot } from \"../../../../styled/icon\";\nimport Container from \"./Container\";\n\nconst ButtonContainer = styled(Container)`\n  left: 25px;\n  top: -16px;\n\n  ${props =>\n    props.pivotDirection === 1\n      ? \"left: -57px;\"\n      : \"transform: rotate(-180deg) scaleY(-1);\"};\n`;\n\nclass PivotButton extends React.Component {\n  canPivot() {\n    const { ship, movementService, pivotDirection } = this.props;\n    return movementService.canPivot(ship, pivotDirection);\n  }\n\n  pivot() {\n    const { ship, movementService, pivotDirection } = this.props;\n    if (!movementService.canPivot(ship, pivotDirection)) {\n      return;\n    }\n\n    return movementService.pivot(ship, pivotDirection);\n  }\n\n  render() {\n    const { pivotDirection } = this.props;\n\n    const can = this.canPivot();\n\n    return (\n      <ButtonContainer\n        pivotDirection={pivotDirection}\n        onClick={this.pivot.bind(this)}\n        disabled={!can}\n      >\n        <Pivot />\n      </ButtonContainer>\n    );\n  }\n}\n\nexport default PivotButton;\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport { Clickable } from \"../../../../styled\";\nimport { Roll } from \"../../../../styled/icon\";\nimport Container from \"./Container\";\n\nconst RollContainer = styled(Container)`\n  position: absolute;\n  width: 32px;\n  height: 32px;\n  left: -16px;\n  top: -65px;\n  ${Clickable}\n`;\n\nclass RollButton extends React.Component {\n  canRoll() {\n    const { movementService, ship } = this.props;\n    return movementService.canRoll(ship);\n  }\n\n  roll() {\n    const { movementService, ship } = this.props;\n    if (!movementService.canRoll(ship)) {\n      return;\n    }\n\n    return movementService.roll(ship);\n  }\n\n  render() {\n    const { ship } = this.props;\n    return (\n      <RollContainer\n        active={ship.movement.isRolling()}\n        onClick={this.roll.bind(this)}\n        disabled={!this.canRoll()}\n      >\n        <Roll />\n      </RollContainer>\n    );\n  }\n}\n\nexport default RollButton;\n","import * as React from \"react\";\nimport styled from \"styled-components\";\nimport { Clickable } from \"../../../../styled\";\nimport { Evade } from \"../../../../styled/icon\";\nimport Container from \"./Container\";\n\nconst EvadeContainer = styled(Container)`\n  position: absolute;\n  width: 26px;\n  height: 26px;\n  left: -13px;\n  top: 28px;\n  ${Clickable}\n`;\n\nconst RotatedContainer = styled(EvadeContainer)`\n  transform: rotate(180deg);\n  top: 79px;\n`;\n\nconst Evasion = styled.div`\n  color: white;\n  font-family: arial;\n  font-size: 24px;\n  text-transform: uppercase;\n  font-weight: bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  width: 50px;\n  height: 20px;\n  left: -25px;\n  top: 57px;\n`;\n\nclass EvadeButton extends React.Component {\n  canEvade(step) {\n    const { movementService, ship } = this.props;\n    return movementService.canEvade(ship, step);\n  }\n\n  evade(step) {\n    const { movementService, ship } = this.props;\n    if (!movementService.canEvade(ship, step)) {\n      return;\n    }\n\n    return movementService.evade(ship, step);\n  }\n\n  render() {\n    const { ship } = this.props;\n    const canMore = this.canEvade(1);\n    const canLess = this.canEvade(-1);\n    return (\n      <>\n        <EvadeContainer\n          key=\"evade-more\"\n          onClick={this.evade.bind(this, 1)}\n          disabled={!canMore}\n        >\n          <Evade />\n        </EvadeContainer>\n\n        <Evasion>{ship.movement.getEvasion()}</Evasion>\n        <RotatedContainer\n          key=\"evade-less\"\n          onClick={this.evade.bind(this, -1)}\n          disabled={!canLess}\n        >\n          <Evade />\n        </RotatedContainer>\n      </>\n    );\n  }\n}\n\nexport default EvadeButton;\n","import * as React from \"react\";\r\nimport Movement from \"./Movement\";\r\nimport ThrustButton from \"./ThrustButton\";\r\nimport RevertButton from \"./RevertButton\";\r\nimport CancelButton from \"./CancelButton\";\r\nimport PivotButton from \"./PivotButton\";\r\nimport RollButton from \"./RollButton\";\r\nimport EvadeButton from \"./EvadeButton\";\r\n\r\nclass GameMovement extends React.PureComponent {\r\n  render() {\r\n    const { ship, movementService, ...rest } = this.props;\r\n\r\n    return (\r\n      <Movement ship={ship} movementService={movementService} {...rest}>\r\n        <ThrustButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          direction={0}\r\n        />\r\n\r\n        <ThrustButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          direction={1}\r\n        />\r\n\r\n        <ThrustButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          direction={2}\r\n        />\r\n\r\n        <ThrustButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          direction={3}\r\n        />\r\n\r\n        <ThrustButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          direction={4}\r\n        />\r\n\r\n        <ThrustButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          direction={5}\r\n        />\r\n\r\n        <RevertButton ship={ship} movementService={movementService} />\r\n\r\n        <CancelButton ship={ship} movementService={movementService} />\r\n\r\n        <PivotButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          pivotDirection={-1}\r\n        />\r\n\r\n        <PivotButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          pivotDirection={1}\r\n        />\r\n\r\n        <RollButton ship={ship} movementService={movementService} />\r\n\r\n        <EvadeButton ship={ship} movementService={movementService} />\r\n      </Movement>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GameMovement;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Pivot } from \"../../../../styled/icon\";\r\nimport Container from \"./Container\";\r\n\r\nconst ButtonContainer = styled(Container)`\r\n  left: 125px;\r\n  top: 103px;\r\n\r\n  ${props =>\r\n    props.pivotDirection === 1\r\n      ? \"left: -175px; transform: rotate(-90deg);\"\r\n      : \"transform: rotate(-90deg) scaleY(-1);\"}\r\n`;\r\n\r\nclass DeploymentPivotButton extends React.Component {\r\n  pivot() {\r\n    const { ship, movementService, pivotDirection } = this.props;\r\n    return movementService.doDeploymentTurn(ship, pivotDirection);\r\n  }\r\n\r\n  render() {\r\n    const { pivotDirection } = this.props;\r\n\r\n    return (\r\n      <ButtonContainer\r\n        pivotDirection={pivotDirection}\r\n        onClick={this.pivot.bind(this)}\r\n      >\r\n        <Pivot />\r\n      </ButtonContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DeploymentPivotButton;\r\n","import * as React from \"react\";\r\nimport Movement from \"./Movement\";\r\nimport DeploymentPivotButton from \"./DeploymentPivotButton\";\r\n\r\nclass DeploymentMovementButtons extends React.PureComponent {\r\n  render() {\r\n    const { ship, movementService, ...rest } = this.props;\r\n\r\n    return (\r\n      <Movement\r\n        ship={ship}\r\n        movementService={movementService}\r\n        ui={false}\r\n        {...rest}\r\n      >\r\n        <DeploymentPivotButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          pivotDirection={-1}\r\n        />\r\n\r\n        <DeploymentPivotButton\r\n          ship={ship}\r\n          movementService={movementService}\r\n          pivotDirection={1}\r\n        />\r\n      </Movement>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DeploymentMovementButtons;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport * as gameUiModes from \"./gameUiModes\";\r\nimport { TooltipMenu, TooltipButton } from \"../../../styled\";\r\nimport { Replay } from \"../../../styled/icon\";\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  left: 500px;\r\n  display: flex;\r\n  z-index: 3;\r\n`;\r\n\r\nconst ReplayButton = styled(TooltipButton)`\r\n  margin-left: 32px;\r\n`;\r\n\r\nclass GameUiModeButtons extends React.PureComponent {\r\n  render() {\r\n    const { ew, movement, weapons, enemy_weapons, uiState } = this.props;\r\n\r\n    return (\r\n      <Container>\r\n        <TooltipButton\r\n          selected={enemy_weapons}\r\n          img=\"/img/targetShip.png\"\r\n          onClick={() => uiState.toggleGameUiMode(gameUiModes.ENEMY_WEAPONS)}\r\n        />\r\n        <TooltipButton\r\n          selected={weapons}\r\n          img=\"/img/firing.png\"\r\n          onClick={() => uiState.toggleGameUiMode(gameUiModes.WEAPONS)}\r\n        />\r\n        <TooltipButton\r\n          selected={ew}\r\n          img=\"/img/addOEW.png\"\r\n          onClick={() => uiState.toggleGameUiMode(gameUiModes.EW)}\r\n        />\r\n        <TooltipButton\r\n          selected={movement}\r\n          img=\"/img/selectShip.png\"\r\n          onClick={() => uiState.toggleGameUiMode(gameUiModes.MOVEMENT)}\r\n        />\r\n        <ReplayButton onClick={() => uiState.startReplay()}>\r\n          <Replay />\r\n        </ReplayButton>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GameUiModeButtons;\r\n","import * as React from \"react\";\r\nimport OEWButtons from \"./OEWButtons\";\r\n\r\nclass EwList extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    const { ship, uiState, ewList, selectedShip } = this.props;\r\n\r\n    const { gameData } = uiState;\r\n    if (!ship) {\r\n      return null;\r\n    }\r\n\r\n    return ewList.map((entry, index) => {\r\n      const target = gameData.ships.getShipById(entry.targetShipId);\r\n      return (\r\n        <OEWButtons\r\n          highlight\r\n          name={target.name}\r\n          uiState={uiState}\r\n          key={`ew-list-${index}`}\r\n          ship={selectedShip}\r\n          target={target}\r\n          oew={selectedShip.electronicWarfare.getOffensiveEw(\r\n            entry.targetShipId\r\n          )}\r\n        />\r\n      );\r\n    });\r\n  }\r\n}\r\n\r\nexport default EwList;\r\n","import * as React from \"react\";\nimport SystemIcon from \"./SystemIcon\";\n\nclass SystemList extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const { ship, uiState, systems, ...rest } = this.props;\n\n    if (!ship) {\n      return null;\n    }\n\n    return systems.map(system => (\n      <SystemIcon\n        scs\n        uiState={uiState}\n        key={`system-list-${system.id}`}\n        system={system}\n        ship={ship}\n        {...rest}\n      />\n    ));\n  }\n}\n\nexport default SystemList;\n","import * as React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport SystemList from \"../system/SystemList\";\r\nimport EwList from \"../electronicWarfare/EwList\";\r\nimport CCEWButtons from \"../electronicWarfare/CCEWButtons\";\r\nimport GameShipTooltipMenu from \"../shipTooltip/GameShipTooltipMenu\";\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  left: 0;\r\n  bottom: 0;\r\n  width: calc(50% - 100px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  z-index: 3;\r\n`;\r\n\r\nconst SubContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  flex-wrap: wrap-reverse;\r\n`;\r\n\r\nclass LeftPanel extends React.PureComponent {\r\n  render() {\r\n    const { uiState, systemList, ewList, ...rest } = this.props;\r\n\r\n    if (!uiState.state.selectedShip) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Container>\r\n        <SubContainer>\r\n          {ewList && (\r\n            <EwList\r\n              ship={uiState.state.selectedShip}\r\n              uiState={uiState}\r\n              ewList={ewList}\r\n              {...rest}\r\n            />\r\n          )}\r\n        </SubContainer>\r\n        <GameShipTooltipMenu\r\n          ship={uiState.state.selectedShip}\r\n          uiState={uiState}\r\n        />\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LeftPanel;\r\n","import * as React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { TooltipButton, Button } from \"../../../../styled\";\r\nimport { Pause, Play, X } from \"../../../../styled/icon\";\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  left: 500px;\r\n  display: flex;\r\n  z-index: 3;\r\n`;\r\n\r\nconst RotatedButton = styled(TooltipButton)`\r\n  transform: rotate(180deg);\r\n`;\r\n\r\nclass ReplayUi extends React.PureComponent {\r\n  render() {\r\n    const { uiState, replayContext } = this.props;\r\n\r\n    return (\r\n      <Container>\r\n        <Button onClick={() => replayContext.rewindToFiring()}>Firing</Button>\r\n\r\n        <RotatedButton onClick={() => replayContext.resumeReplayRewind()}>\r\n          <Play />\r\n        </RotatedButton>\r\n        <TooltipButton onClick={() => replayContext.pauseReplay()}>\r\n          <Pause />\r\n        </TooltipButton>\r\n        <TooltipButton onClick={() => replayContext.resumeReplay()}>\r\n          <Play />\r\n        </TooltipButton>\r\n        <TooltipButton onClick={() => uiState.closeReplay()}>\r\n          <X />\r\n        </TooltipButton>\r\n      </Container>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ReplayUi;\r\n","import styled from \"styled-components\";\r\n\r\nexport const Highlight = styled.span`\r\n  color: #6daaff;\r\n`;\r\n\r\nexport const DangerHighlight = styled.span`\r\n  color: #db4949;\r\n  font-weight: bold;\r\n`;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Highlight, DangerHighlight } from \"./styled\";\r\n\r\nconst HitChangeContainer = styled.div`\r\n  margin-left: 5px;\r\n`;\r\n\r\nclass HitChange extends React.Component {\r\n  render() {\r\n    const { resolution, totalShots, shotsHit } = this.props;\r\n\r\n    return (\r\n      <HitChangeContainer>\r\n        Change to hit: <Highlight>{resolution.hitChange.result}</Highlight>. Hit\r\n        roll: <Highlight>{resolution.hitRoll}</Highlight>.\r\n        {resolution.result ? (\r\n          <Highlight>\r\n            <b>{` ${shotsHit}/${totalShots} Hit!`}</b>\r\n          </Highlight>\r\n        ) : (\r\n          <DangerHighlight>\r\n            <b> Miss!</b>\r\n          </DangerHighlight>\r\n        )}\r\n      </HitChangeContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HitChange;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Highlight, DangerHighlight } from \"./styled\";\r\n\r\nconst DamageContainer = styled.div``;\r\n\r\nclass DamageLine extends React.Component {\r\n  render() {\r\n    const { target, gameData, combatLogEntry } = this.props;\r\n\r\n    const damages = combatLogEntry.getDamages(target);\r\n    const systemsDestroyed = combatLogEntry.getDestroyedSystems(target);\r\n\r\n    const totalDamage = damages.reduce((total, current) => {\r\n      return total + current.amount;\r\n    }, 0);\r\n\r\n    const totalArmor = damages.reduce((total, current) => {\r\n      return total + current.armor;\r\n    }, 0);\r\n\r\n    return (\r\n      <DamageContainer>\r\n        Damage caused: <DangerHighlight>{totalDamage}</DangerHighlight>.\r\n        Mitigated by armor <Highlight>{totalArmor}</Highlight>.\r\n        {systemsDestroyed.length > 0 && (\r\n          <>\r\n            {\" \"}\r\n            Systems destroyed:{\" \"}\r\n            <DangerHighlight>\r\n              {systemsDestroyed\r\n                .map(system => system.getDisplayName())\r\n                .join(\", \")}\r\n            </DangerHighlight>\r\n          </>\r\n        )}\r\n      </DamageContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DamageLine;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport HitChange from \"./HitChange\";\r\nimport { Highlight, DangerHighlight } from \"./styled\";\r\nimport DamageLine from \"./DamageLine\";\r\nimport CombatLogWeaponFire from \"../../../../../model/combatLog/CombatLogWeaponFire.mjs\";\r\nimport WeaponFireService from \"../../../../../model/weapon/WeaponFireService.mjs\";\r\nimport CombatLogTorpedoAttack from \"../../../../../model/combatLog/CombatLogTorpedoAttack.mjs\";\r\n\r\nconst LineContainer = styled.div`\r\n  color: #d6d6d6;\r\n  font-family: arial;\r\n  font-size: 12px;\r\n  padding: 8px 8px 8px 8px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  border-bottom: 1px dashed gray;\r\n`;\r\n\r\nconst SubLine = styled.div`\r\n  display: flex;\r\n`;\r\n\r\nconst IndentedSubline = styled(SubLine)`\r\n  margin-left: 50px;\r\n  margin-top: 4px;\r\n`;\r\n\r\nclass CombatLogLine extends React.Component {\r\n  getTorpedoAttackLine() {\r\n    const { combatLogEntry, gameData, replayContext } = this.props;\r\n\r\n    const target = gameData.ships.getShipById(combatLogEntry.targetId);\r\n    const flight = gameData.torpedos.getTorpedoFlightById(\r\n      combatLogEntry.torpedoFlightId\r\n    );\r\n\r\n    const targetName = target.name.trim();\r\n\r\n    return (\r\n      <LineContainer>\r\n        <SubLine>\r\n          <DangerHighlight>TORPEDO STRIKE:&nbsp;</DangerHighlight>\r\n          <Highlight>&nbsp;{flight.torpedo.getDisplayName()}&nbsp;</Highlight>\r\n          strikes {targetName}\r\n        </SubLine>\r\n        {combatLogEntry.notes.length > 0 && (\r\n          <IndentedSubline>{combatLogEntry.notes.join(\". \")}</IndentedSubline>\r\n        )}\r\n        {combatLogEntry.damages.length > 0 && (\r\n          <IndentedSubline>\r\n            <DamageLine\r\n              target={target}\r\n              gameData={gameData}\r\n              combatLogEntry={combatLogEntry}\r\n            />\r\n          </IndentedSubline>\r\n        )}\r\n      </LineContainer>\r\n    );\r\n  }\r\n\r\n  getWeaponFireLine() {\r\n    const { combatLogEntry, gameData, replayContext } = this.props;\r\n\r\n    const weaponFireService = new WeaponFireService().update(gameData);\r\n    const fireOrder = weaponFireService.getFireOrderById(\r\n      combatLogEntry.fireOrderId\r\n    );\r\n\r\n    const target = gameData.ships.getShipById(fireOrder.targetId);\r\n    const shooter = gameData.ships.getShipById(fireOrder.shooterId);\r\n    const weapon = shooter.systems.getSystemById(fireOrder.weaponId);\r\n\r\n    const hit = combatLogEntry.hitResult.result;\r\n    const shooterName = shooter.name.trim();\r\n    const targetName = target.name.trim();\r\n    const weaponName = weapon.getDisplayName();\r\n\r\n    return (\r\n      <LineContainer>\r\n        <SubLine>\r\n          <DangerHighlight>FIRE:&nbsp;</DangerHighlight>\r\n          {shooterName} fires{\" \"}\r\n          <Highlight>\r\n            &nbsp;{weaponName}&nbsp;\r\n            {combatLogEntry.ammoName && `(${combatLogEntry.ammoName})`}&nbsp;\r\n          </Highlight>{\" \"}\r\n          at {targetName}.\r\n          <HitChange\r\n            resolution={combatLogEntry.hitResult}\r\n            totalShots={combatLogEntry.totalShots}\r\n            shotsHit={combatLogEntry.shotsHit}\r\n          />\r\n        </SubLine>\r\n        {combatLogEntry.notes.length > 0 && (\r\n          <IndentedSubline>{combatLogEntry.notes.join(\" \")}</IndentedSubline>\r\n        )}\r\n        {hit && (\r\n          <IndentedSubline>\r\n            <DamageLine\r\n              target={target}\r\n              gameData={gameData}\r\n              combatLogEntry={combatLogEntry}\r\n            />\r\n          </IndentedSubline>\r\n        )}\r\n      </LineContainer>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { combatLogEntry } = this.props;\r\n\r\n    if (combatLogEntry instanceof CombatLogWeaponFire) {\r\n      return this.getWeaponFireLine();\r\n    } else if (combatLogEntry instanceof CombatLogTorpedoAttack) {\r\n      return this.getTorpedoAttackLine();\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n\r\nexport default CombatLogLine;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport CombatLogLine from \"./CombatLogLine\";\r\n\r\nconst LogContainer = styled.div`\r\n  position: fixed;\r\n  left: 0;\r\n  bottom: 0;\r\n  height: 150px;\r\n  width: 33%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  overflow-y: scroll;\r\n  padding-top: 8px;\r\n  z-index: 3;\r\n  scrollbar-width: 0;\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 0;\r\n  }\r\n`;\r\n\r\nclass CombatLog extends React.Component {\r\n  render() {\r\n    const { replayContext, gameData, log } = this.props;\r\n\r\n    return (\r\n      <LogContainer>\r\n        {log.map((logEntry, i) => (\r\n          <CombatLogLine\r\n            gameData={gameData}\r\n            replayContext={replayContext}\r\n            key={`combatlog-line-${i}`}\r\n            combatLogEntry={logEntry}\r\n          />\r\n        ))}\r\n      </LogContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CombatLog;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport GamePositionComponent from \"../GamePositionComponent\";\r\nimport { Tooltip, IconAndLabel } from \"../../../../styled\";\r\nimport TorpedoMovementService from \"../../../../../model/movement/TorpedoMovementService.mjs\";\r\nimport GameData from \"../../../../../model/game/GameData.mjs\";\r\n\r\nconst ShipBadgeContainer = styled.div`\r\n  text-align: left;\r\n  position: relative;\r\n  z-index: 0;\r\n  display: flex;\r\n  flex-direction: row;\r\n  color: white;\r\n  font-family: arial;\r\n  margin-left: -50%;\r\n  font-size: 12px;\r\n\r\n  animation: fadein 2s;\r\n\r\n  @keyframes fadein {\r\n    from {\r\n      opacity: 0;\r\n    }\r\n    to {\r\n      opacity: 1;\r\n    }\r\n  }\r\n`;\r\n\r\nconst DewBadge = styled(IconAndLabel)`\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 20px;\r\n  height: 20px;\r\n  margin: 0 1px;\r\n`;\r\n\r\nconst ShipName = styled.div`\r\n  /* background-color: rgba(0, 0, 0, 0.5);\r\n  padding: 3px 5px; */\r\n  margin-right: 5px;\r\n`;\r\n\r\nconst BackgroundContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  align-items: center;\r\n  padding: 3px 5px;\r\n`;\r\n\r\nconst Icon = styled.div`\r\n  width: 15px;\r\n  height: 15px;\r\n  background-size: cover;\r\n  background-color: transparent;\r\n  background-image: ${props => `url(${props.background})`};\r\n  margin: 0 3px 0 0;\r\n`;\r\n\r\nconst BadgeIconAndLabel = styled.div`\r\n  display: flex;\r\n  height: 100%;\r\n  align-items: center;\r\n`;\r\n\r\nconst BadgeIcon = styled(BadgeIconAndLabel)`\r\n  ${Icon} {\r\n    margin: 0;\r\n  }\r\n`;\r\n\r\nconst Badges = styled.div`\r\n  display: flex;\r\n  hieght: 100%;\r\n\r\n  ${BadgeIconAndLabel} {\r\n    margin-left: 5px;\r\n\r\n    &:first-child {\r\n      margin-left: 0px;\r\n    }\r\n  }\r\n`;\r\n\r\nconst WarningBadge = styled(BadgeIcon)`\r\n  animation: blinker 1s linear infinite;\r\n\r\n  @keyframes blinker {\r\n    50% {\r\n      opacity: 0;\r\n    }\r\n  }\r\n`;\r\n\r\nconst getNumberOfMissilesImpacting = (ship, gameData) => {\r\n  const torpedoMovementService = new TorpedoMovementService();\r\n  const gameDataObject = new GameData(gameData);\r\n\r\n  return gameDataObject.torpedos\r\n    .getTorpedoFlights()\r\n    .filter(flight => flight.targetId === ship.id)\r\n    .filter(flight =>\r\n      torpedoMovementService.reachesTargetThisTurn(flight, ship)\r\n    ).length;\r\n};\r\n\r\nclass ShipBadge extends React.PureComponent {\r\n  render() {\r\n    const { icon, version, getPosition, uiState, showName } = this.props;\r\n    const { currentUser } = uiState.services;\r\n    const isMine = icon.ship.player.is(currentUser);\r\n\r\n    const missiles = getNumberOfMissilesImpacting(\r\n      icon.ship,\r\n      uiState.state.gameData\r\n    );\r\n\r\n    return (\r\n      <GamePositionComponent\r\n        getPosition={getPosition}\r\n        uiState={uiState}\r\n        marginTop={0}\r\n        marginLeft={0}\r\n      >\r\n        <ShipBadgeContainer>\r\n          <BackgroundContainer>\r\n            {false && showName && <ShipName>{icon.ship.name}</ShipName>}\r\n\r\n            <Badges>\r\n              {isMine && missiles > 0 && (\r\n                <WarningBadge>\r\n                  <Icon background=\"/img/system/missile1.png\" />\r\n                  {missiles}\r\n                </WarningBadge>\r\n              )}\r\n\r\n              {isMine && !icon.ship.systems.power.isValidPower() && (\r\n                <WarningBadge>\r\n                  <Icon background=\"/img/offline.png\" />\r\n                </WarningBadge>\r\n              )}\r\n\r\n              {isMine && (\r\n                <BadgeIconAndLabel>\r\n                  <Icon background=\"/img/dewBadge2.png\" />\r\n                  {icon.ship.electronicWarfare.getDefensiveEw()}\r\n                </BadgeIconAndLabel>\r\n              )}\r\n              <BadgeIconAndLabel>\r\n                <Icon background=\"/img/dewBadge.png\" />\r\n                {icon.ship.electronicWarfare.inEffect.getDefensiveEw()}\r\n              </BadgeIconAndLabel>\r\n\r\n              {isMine && (\r\n                <BadgeIconAndLabel>\r\n                  <Icon background=\"/img/ccewBadge2.png\" />\r\n                  {icon.ship.electronicWarfare.getCcEw()}\r\n                </BadgeIconAndLabel>\r\n              )}\r\n              <BadgeIconAndLabel>\r\n                <Icon background=\"/img/ccewBadge.png\" />\r\n                {icon.ship.electronicWarfare.inEffect.getCcEw()}\r\n              </BadgeIconAndLabel>\r\n            </Badges>\r\n          </BackgroundContainer>\r\n        </ShipBadgeContainer>\r\n      </GamePositionComponent>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ShipBadge;\r\n","import React, { useReducer } from \"react\";\r\n\r\nexport const GameStateStore = React.createContext({});\r\nexport const GameDispatchStore = React.createContext({});\r\n\r\nconst GameStoreProvider = ({ uiState, children }) => {\r\n  const [state, dispatch] = useReducer(\r\n    uiState.getReducer(),\r\n    uiState.getInitialState()\r\n  );\r\n\r\n  uiState.setDispatch(dispatch);\r\n\r\n  return (\r\n    <GameDispatchStore.Provider value={dispatch}>\r\n      <GameStateStore.Provider value={state}>\r\n        {children}\r\n      </GameStateStore.Provider>\r\n    </GameDispatchStore.Provider>\r\n  );\r\n};\r\n\r\nexport default GameStoreProvider;\r\n","import React, { useContext } from \"react\";\r\nimport Lobby from \"./lobby\";\r\nimport ShipTooltip from \"../ui/shipTooltip\";\r\nimport TurnHeader from \"../ui/TurnHeader\";\r\nimport GameMovement from \"../ui/movement/GameMovement\";\r\nimport DeploymentMovement from \"../ui/movement/DeploymentMovement\";\r\nimport GameUiModeButtons from \"../ui/GameUiModeButtons\";\r\nimport LeftPanel from \"../ui/leftPanel/LeftPanel\";\r\nimport ReplayUI from \"../ui/replay/ReplayUI\";\r\nimport * as gamePhases from \"../../../../model/game/gamePhases\";\r\nimport CombatLog from \"../ui/combatLog/CombatLog\";\r\nimport ShipBadge from \"../ui/shipBadge/ShipBadge\";\r\nimport { StateStore } from \"../../../state/StoreProvider\";\r\nimport { GameStateStore } from \"../GameStoreProvider\";\r\n\r\nconst GameUiComponent = ({ game }) => {\r\n  const { currentUser } = useContext(StateStore);\r\n  const state = useContext(GameStateStore);\r\n  const uiState = game.getUiState();\r\n\r\n  return (\r\n    <>\r\n      {state.lobby && (\r\n        <Lobby\r\n          uiState={uiState}\r\n          gameData={state.gameData}\r\n          game={game}\r\n          currentUser={currentUser}\r\n        />\r\n      )}\r\n\r\n      {state.shipTooltip.map((tooltip, index) => (\r\n        <ShipTooltip\r\n          key={`tooltip-ship-${index}`}\r\n          uiState={uiState}\r\n          {...state}\r\n          {...tooltip}\r\n        />\r\n      ))}\r\n\r\n      {state.gameData &&\r\n        (state.gameData.phase === gamePhases.GAME ||\r\n          state.gameData.phase === gamePhases.DEPLOYMENT) && (\r\n          <TurnHeader\r\n            uiState={uiState}\r\n            gameData={uiState.state.gameData}\r\n            ready={uiState.state.turnReady}\r\n            waiting={uiState.state.waiting}\r\n          />\r\n        )}\r\n\r\n      {state.shipMovement && state.shipMovement.type === \"deploy\" && (\r\n        <DeploymentMovement {...state.shipMovement} uiState={uiState} />\r\n      )}\r\n\r\n      {state.shipMovement && state.shipMovement.type === \"game\" && (\r\n        <GameMovement {...state.shipMovement} uiState={uiState} />\r\n      )}\r\n\r\n      {state.gameUiModeButtons && (\r\n        <GameUiModeButtons uiState={uiState} {...state.gameUiMode} />\r\n      )}\r\n\r\n      {state.replayUi && (\r\n        <ReplayUI uiState={uiState} replayContext={state.replayUi} />\r\n      )}\r\n\r\n      <LeftPanel uiState={uiState} {...state} />\r\n\r\n      {uiState.state.combatLog && (\r\n        <CombatLog\r\n          uiState={uiState}\r\n          replayContext={state.combatLog.replayContext}\r\n          gameData={state.combatLog.gameData}\r\n          log={state.combatLog.log}\r\n        />\r\n      )}\r\n\r\n      {state.shipBadges.map(({ version, icon, getPosition, showName }) => (\r\n        <ShipBadge\r\n          key={`ship-badge-${icon.ship.id}`}\r\n          icon={icon}\r\n          getPosition={getPosition}\r\n          version={version}\r\n          uiState={uiState}\r\n          showName={showName}\r\n        />\r\n      ))}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default GameUiComponent;\r\n","import GameComponent from \"./components/GameComponent\";\r\n\r\nexport default GameComponent;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport GameSceneComponent from \"./GameSceneComponent\";\r\nimport Game from \"../Game\";\r\nimport UIState from \"../ui/UIState\";\r\nimport GameUiComponent from \"./GameUiComponent\";\r\nimport { StateStore } from \"../../../state/StoreProvider\";\r\nimport GameStoreProvider from \"../GameStoreProvider\";\r\nimport LoginFloater from \"../../login/LoginFloater\";\r\n\r\nconst GameComponent = ({ match }) => {\r\n  const { currentUser } = useContext(StateStore);\r\n  const [uiState, setUiState] = useState(null);\r\n  const [game, setGame] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const newUiState = new UIState();\r\n    const newGame = new Game(match.params.gameid, currentUser, newUiState);\r\n    setUiState(newUiState);\r\n    setGame(newGame);\r\n  }, [currentUser, setUiState, setGame]);\r\n\r\n  if (!uiState || !game || currentUser === undefined) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <GameStoreProvider uiState={uiState}>\r\n      <GameSceneComponent game={game} currentUser={currentUser} />\r\n      <GameUiComponent game={game} />\r\n      <LoginFloater />\r\n    </GameStoreProvider>\r\n  );\r\n};\r\n\r\nexport default GameComponent;\r\n","import Logout from \"./Logout\";\r\n\r\nexport default Logout;\r\n","import React, { useContext } from \"react\";\r\nimport { Formik } from \"formik\";\r\nimport * as Yup from \"yup\";\r\nimport { getCurrentUser } from \"../../state/actions\";\r\nimport { login as loginUser, register as registerUser } from \"../../api/user\";\r\n\r\nimport {\r\n  Title,\r\n  InputAndLabel,\r\n  PanelContainer,\r\n  Button,\r\n  Error\r\n} from \"../../styled\";\r\nimport { DispatchStore } from \"../../state/StoreProvider\";\r\n\r\nclass Register extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      error: null\r\n    };\r\n  }\r\n\r\n  onSubmit = async (values, { setSubmitting }) => {\r\n    const dispatch = useContext(DispatchStore);\r\n    this.setState({ error: null });\r\n\r\n    let { username, password } = values;\r\n    username = username.trim();\r\n    password = password.trim();\r\n\r\n    try {\r\n      await registerUser(username, password);\r\n      await loginUser(username, password);\r\n      await getCurrentUser(dispatch);\r\n    } catch (error) {\r\n      this.setState({ error: error.data });\r\n    }\r\n    setSubmitting(false);\r\n  };\r\n\r\n  render() {\r\n    const { error } = this.state;\r\n\r\n    return (\r\n      <Formik\r\n        initialValues={{ username: \"\", password: \"\", passwordConfirm: \"\" }}\r\n        onSubmit={this.onSubmit}\r\n        validationSchema={Yup.object({\r\n          username: Yup.string()\r\n            .min(2, \"Username must be atleast 2 characters\")\r\n            .required(\"Required\"),\r\n          password: Yup.string()\r\n            .min(2, \"Password must be atleast 16 characters\")\r\n            .required(\"Required\"),\r\n          passwordConfirm: Yup.string()\r\n            .oneOf([Yup.ref(\"password\"), null], \"Passwords must match\")\r\n            .required(\"Required\")\r\n        })}\r\n      >\r\n        {props => {\r\n          const {\r\n            values,\r\n            touched,\r\n            errors,\r\n            isSubmitting,\r\n            handleChange,\r\n            handleBlur,\r\n            handleSubmit\r\n          } = props;\r\n\r\n          return (\r\n            <PanelContainer as=\"form\" onSubmit={handleSubmit}>\r\n              <Title>\r\n                Register a new user {error && <Error>{error}</Error>}\r\n              </Title>\r\n\r\n              <InputAndLabel\r\n                label=\"Username\"\r\n                id=\"username\"\r\n                placeholder=\"Username\"\r\n                value={values.username}\r\n                onChange={handleChange}\r\n                onBlur={handleBlur}\r\n                error={touched.username && errors.username}\r\n              />\r\n\r\n              <InputAndLabel\r\n                label=\"Password\"\r\n                id=\"password\"\r\n                placeholder=\"Password\"\r\n                value={values.password}\r\n                onChange={handleChange}\r\n                onBlur={handleBlur}\r\n                error={touched.password && errors.password}\r\n                type=\"password\"\r\n              />\r\n\r\n              <InputAndLabel\r\n                label=\"Confirm password\"\r\n                id=\"passwordConfirm\"\r\n                placeholder=\"Confirm password\"\r\n                value={values.passwordConfirm}\r\n                onChange={handleChange}\r\n                onBlur={handleBlur}\r\n                error={touched.passwordConfirm && errors.passwordConfirm}\r\n                type=\"password\"\r\n              />\r\n\r\n              <Button\r\n                buttonStyle=\"button-grey\"\r\n                type=\"submit\"\r\n                disabled={isSubmitting || Object.entries(errors).length !== 0}\r\n              >\r\n                Register\r\n              </Button>\r\n            </PanelContainer>\r\n          );\r\n        }}\r\n      </Formik>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Register;\r\n","import React, { useContext, useEffect } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport { getCurrentUser } from \"../../state/actions\";\r\nimport { logout as logoutUser } from \"../../api/user\";\r\nimport { DispatchStore, StateStore } from \"../../state/StoreProvider\";\r\n\r\nconst Logout = ({ location }) => {\r\n  const dispatch = useContext(DispatchStore);\r\n  const { currentUser } = useContext(StateStore);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      await logoutUser();\r\n      await getCurrentUser(dispatch);\r\n    })();\r\n  }, [dispatch]);\r\n\r\n  if (!currentUser) {\r\n    return <Redirect to={{ pathname: \"/\", state: { from: location } }} />;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default Logout;\r\n","import React, { Component } from \"react\";\r\n\r\nimport Slot from \"./Slot\";\r\n\r\nimport { Title, DarkContainer } from \"../../styled\";\r\n\r\nclass Slots extends Component {\r\n  mapTeamsToComponents() {\r\n    const { gameData } = this.props;\r\n    return gameData.slots.getSlotsByTeams().map(team => {\r\n      return (\r\n        <DarkContainer key={`team-${team.team}`}>\r\n          <Title>TEAM: {team.team}</Title>\r\n          {team.slots.map(slot => (\r\n            <Slot key={slot.id} slot={slot} {...this.props} />\r\n          ))}\r\n        </DarkContainer>\r\n      );\r\n    });\r\n  }\r\n\r\n  handleChange() {}\r\n\r\n  render() {\r\n    return <>{this.mapTeamsToComponents()}</>;\r\n  }\r\n}\r\n\r\nexport default Slots;\r\n","import React, {\r\n  Component,\r\n  useContext,\r\n  useState,\r\n  useEffect,\r\n  useCallback\r\n} from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\nimport GameData from \"../../../model/game/GameData\";\r\nimport GameSlot from \"../../../model/game/GameSlot\";\r\nimport hexagon from \"../../../model/hexagon\";\r\nimport Slots from \"./Slots\";\r\nimport { createGame } from \"../../api/game\";\r\n\r\nimport {\r\n  Title,\r\n  InputAndLabel,\r\n  PanelContainer,\r\n  Button,\r\n  Link\r\n} from \"../../styled\";\r\nimport { StateStore } from \"../../state/StoreProvider\";\r\n\r\nconst Container = styled(PanelContainer)`\r\n  width: 1200px;\r\n`;\r\n\r\nconst CreateGame = ({ location }) => {\r\n  const state = useContext(StateStore);\r\n  const user = state.currentUser;\r\n  const [gameData, setGameData] = useState(new GameData());\r\n\r\n  useEffect(() => {\r\n    gameData.slots.addSlot(\r\n      new GameSlot({\r\n        name: \"Blue\",\r\n        team: 1,\r\n        points: 3000,\r\n        userId: user.id,\r\n        deploymentLocation: new hexagon.Offset(-150, 0),\r\n        deploymentVector: new hexagon.Offset(10, 0)\r\n      })\r\n    );\r\n\r\n    gameData.slots.addSlot(\r\n      new GameSlot({\r\n        name: \"Red\",\r\n        team: 2,\r\n        points: 3000,\r\n        userId: null,\r\n        deploymentLocation: new hexagon.Offset(150, 0),\r\n        deploymentVector: new hexagon.Offset(-10, 0)\r\n      })\r\n    );\r\n\r\n    gameData.addPlayer(user);\r\n    gameData.name = \"Test game\";\r\n\r\n    setGameData(gameData.clone());\r\n  }, [setGameData]);\r\n\r\n  const changeGameName = useCallback(\r\n    e => {\r\n      gameData.name = e.target.value;\r\n      setGameData(gameData.clone());\r\n    },\r\n    [gameData, setGameData]\r\n  );\r\n\r\n  const createGameCallBack = useCallback(() => {\r\n    (async () => {\r\n      try {\r\n        const response = await createGame(gameData);\r\n        console.log(response);\r\n        gameData.id = response.data.gameId;\r\n        setGameData(gameData.clone());\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    })();\r\n  }, [gameData, setGameData]);\r\n\r\n  console.log(\"render\", gameData);\r\n  if (gameData.id) {\r\n    return (\r\n      <Redirect\r\n        to={{ pathname: `/game/${gameData.id}`, state: { from: location } }}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <Link to=\"/\">\r\n        <Button type=\"button\" buttonStyle=\"button-grey\">\r\n          Back\r\n        </Button>\r\n      </Link>\r\n      <Title>Create game</Title>\r\n      <InputAndLabel\r\n        placeholder=\"name\"\r\n        value={gameData.name}\r\n        onChange={changeGameName}\r\n        error={!gameData.name ? \"Name is required\" : false}\r\n      />\r\n\r\n      <Slots gameData={gameData} />\r\n      <Button\r\n        type=\"button\"\r\n        buttonStyle=\"button-grey\"\r\n        onClick={createGameCallBack}\r\n      >\r\n        Create game\r\n      </Button>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default CreateGame;\r\n","import CreateGame from \"./CreateGame\";\r\n\r\nexport default CreateGame;\r\n","import React, { Component, useContext } from \"react\";\r\nimport { BrowserRouter as Router, Route, Redirect } from \"react-router-dom\";\r\nimport Home from \"./view/home\";\r\nimport Game from \"./view/game\";\r\nimport Register from \"./view/register\";\r\nimport Logout from \"./view/logout\";\r\nimport CreateGame from \"./view/createGame\";\r\nimport { StateStore } from \"./state/StoreProvider\";\r\n\r\nconst PrivateRoute = ({ component: Component, authed, ...rest }) => {\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={props =>\r\n        authed === true ? (\r\n          <Component {...props} />\r\n        ) : (\r\n          <Redirect to={{ pathname: \"/\", state: { from: props.location } }} />\r\n        )\r\n      }\r\n    />\r\n  );\r\n};\r\n\r\nclass Routes extends Component {\r\n  render() {\r\n    const state = this.context;\r\n    const user = state.currentUser;\r\n\r\n    if (user === undefined) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Router>\r\n        <Route exact path=\"/\" component={Home} />\r\n        <PrivateRoute\r\n          authed={Boolean(user)}\r\n          exact\r\n          path=\"/createGame\"\r\n          component={CreateGame}\r\n        />\r\n        <Route exact path=\"/logout\" component={Logout} />\r\n        <PrivateRoute\r\n          authed={Boolean(user)}\r\n          path=\"/game/:gameid\"\r\n          component={Game}\r\n        />\r\n      </Router>\r\n    );\r\n  }\r\n}\r\n\r\nRoutes.contextType = StateStore;\r\n\r\nexport default Routes;\r\n","import React, { Component } from \"react\";\nimport Router from \"./Router\";\n\nimport StoreProvider from \"./state/StoreProvider\";\n\nclass App extends Component {\n  render() {\n    return (\n      <StoreProvider>\n        <Router />\n      </StoreProvider>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./client/App\";\nimport * as serviceWorker from \"./client/serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}