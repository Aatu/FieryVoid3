(this["webpackJsonpclient"] = this["webpackJsonpclient"] || []).push([[0],{

/***/ 156:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(316);


/***/ }),

/***/ 316:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var criticals_namespaceObject = {};
__webpack_require__.r(criticals_namespaceObject);
__webpack_require__.d(criticals_namespaceObject, "ThrustChannelHeatIncreased", function() { return criticals_ThrustChannelHeatIncreased; });
__webpack_require__.d(criticals_namespaceObject, "ForcedOfflineOverheat", function() { return criticals_ForcedOfflineOverheat; });
__webpack_require__.d(criticals_namespaceObject, "ForcedOffline", function() { return criticals_ForcedOffline; });
__webpack_require__.d(criticals_namespaceObject, "LoadingTimeIncreased", function() { return criticals_LoadingTimeIncreased; });
__webpack_require__.d(criticals_namespaceObject, "OutputReduced2", function() { return criticals_OutputReduced2; });
__webpack_require__.d(criticals_namespaceObject, "OutputReduced4", function() { return criticals_OutputReduced4; });
__webpack_require__.d(criticals_namespaceObject, "OutputReduced6", function() { return criticals_OutputReduced6; });
__webpack_require__.d(criticals_namespaceObject, "OutputReduced8", function() { return criticals_OutputReduced8; });
__webpack_require__.d(criticals_namespaceObject, "OutputReduced", function() { return criticals_OutputReduced; });
var torpedo_namespaceObject = {};
__webpack_require__.r(torpedo_namespaceObject);
__webpack_require__.d(torpedo_namespaceObject, "Torpedo158MSV2", function() { return torpedo_Torpedo158MSV2; });
__webpack_require__.d(torpedo_namespaceObject, "Torpedo158MSV", function() { return torpedo_Torpedo158MSV; });
__webpack_require__.d(torpedo_namespaceObject, "Torpedo158Nuclear", function() { return torpedo_Torpedo158Nuclear; });
__webpack_require__.d(torpedo_namespaceObject, "Torpedo72MSV", function() { return torpedo_Torpedo72MSV; });
__webpack_require__.d(torpedo_namespaceObject, "Torpedo72HE", function() { return torpedo_Torpedo72HE; });
__webpack_require__.d(torpedo_namespaceObject, "Torpedo158HE", function() { return torpedo_Torpedo158HE; });
var conventional_namespaceObject = {};
__webpack_require__.r(conventional_namespaceObject);
__webpack_require__.d(conventional_namespaceObject, "Ammo30mm", function() { return conventional_Ammo30mm; });
__webpack_require__.d(conventional_namespaceObject, "Ammo85mmHE", function() { return conventional_Ammo85mmHE; });
__webpack_require__.d(conventional_namespaceObject, "Ammo85mmAP", function() { return conventional_Ammo85mmAP; });
__webpack_require__.d(conventional_namespaceObject, "Ammo140mmAP", function() { return conventional_Ammo140mmAP; });
__webpack_require__.d(conventional_namespaceObject, "Ammo140mmHE", function() { return conventional_Ammo140mmHE; });
__webpack_require__.d(conventional_namespaceObject, "Ammo120mmAP", function() { return conventional_Ammo120mmAP; });
__webpack_require__.d(conventional_namespaceObject, "Ammo120mmHE", function() { return conventional_Ammo120mmHE; });
var ships_namespaceObject = {};
__webpack_require__.r(ships_namespaceObject);
__webpack_require__.d(ships_namespaceObject, "Gunship", function() { return uc_Gunship; });
__webpack_require__.d(ships_namespaceObject, "Rhino", function() { return uc_Rhino; });
__webpack_require__.d(ships_namespaceObject, "Capital", function() { return uc_Capital; });
__webpack_require__.d(ships_namespaceObject, "Caliope", function() { return protectorate_Caliope; });
__webpack_require__.d(ships_namespaceObject, "Fulcrum", function() { return protectorate_Fulcrum; });
__webpack_require__.d(ships_namespaceObject, "Mouros", function() { return protectorate_Mouros; });
__webpack_require__.d(ships_namespaceObject, "Impetous", function() { return federation_Impetous; });
__webpack_require__.d(ships_namespaceObject, "Haka", function() { return uc_Haka; });
var Colors_namespaceObject = {};
__webpack_require__.r(Colors_namespaceObject);
__webpack_require__.d(Colors_namespaceObject, "blue", function() { return blue; });
__webpack_require__.d(Colors_namespaceObject, "darkBlue", function() { return darkBlue; });
__webpack_require__.d(Colors_namespaceObject, "border", function() { return border; });
__webpack_require__.d(Colors_namespaceObject, "borderDark", function() { return borderDark; });
__webpack_require__.d(Colors_namespaceObject, "text", function() { return Colors_text; });
__webpack_require__.d(Colors_namespaceObject, "textDanger", function() { return textDanger; });
__webpack_require__.d(Colors_namespaceObject, "lightBlue", function() { return lightBlue; });
__webpack_require__.d(Colors_namespaceObject, "systemWindowBorder", function() { return systemWindowBorder; });
__webpack_require__.d(Colors_namespaceObject, "systemBorder", function() { return systemBorder; });
__webpack_require__.d(Colors_namespaceObject, "systemWindowPrimaryBorder", function() { return systemWindowPrimaryBorder; });
__webpack_require__.d(Colors_namespaceObject, "tooltipButtonColor", function() { return tooltipButtonColor; });
__webpack_require__.d(Colors_namespaceObject, "mediumBlue", function() { return mediumBlue; });
__webpack_require__.d(Colors_namespaceObject, "hitpoints", function() { return hitpoints; });
__webpack_require__.d(Colors_namespaceObject, "hitpointsCritical", function() { return hitpointsCritical; });
__webpack_require__.d(Colors_namespaceObject, "red", function() { return red; });
__webpack_require__.d(Colors_namespaceObject, "fuel", function() { return Colors_fuel; });
var icon_namespaceObject = {};
__webpack_require__.r(icon_namespaceObject);
__webpack_require__.d(icon_namespaceObject, "Arrow", function() { return icon_Arrow; });
__webpack_require__.d(icon_namespaceObject, "ArrowSmall", function() { return icon_ArrowSmall; });
__webpack_require__.d(icon_namespaceObject, "Roll", function() { return icon_Roll; });
__webpack_require__.d(icon_namespaceObject, "X", function() { return icon_X; });
__webpack_require__.d(icon_namespaceObject, "Evade", function() { return icon_Evade; });
__webpack_require__.d(icon_namespaceObject, "Pivot", function() { return icon_Pivot; });
__webpack_require__.d(icon_namespaceObject, "Cancel", function() { return icon_Cancel; });
__webpack_require__.d(icon_namespaceObject, "CheckMark", function() { return icon_CheckMark; });
__webpack_require__.d(icon_namespaceObject, "Play", function() { return icon_Play; });
__webpack_require__.d(icon_namespaceObject, "Pause", function() { return icon_Pause; });
__webpack_require__.d(icon_namespaceObject, "Replay", function() { return icon_Replay; });
var user_namespaceObject = {};
__webpack_require__.r(user_namespaceObject);
__webpack_require__.d(user_namespaceObject, "login", function() { return login; });
__webpack_require__.d(user_namespaceObject, "register", function() { return register; });
__webpack_require__.d(user_namespaceObject, "getCurrentUser", function() { return getCurrentUser; });
__webpack_require__.d(user_namespaceObject, "logout", function() { return logout; });
var thruster_namespaceObject = {};
__webpack_require__.r(thruster_namespaceObject);
__webpack_require__.d(thruster_namespaceObject, "ManeuveringThruster", function() { return thruster_ManeuveringThruster; });
__webpack_require__.d(thruster_namespaceObject, "Thruster", function() { return thruster_Thruster; });
__webpack_require__.d(thruster_namespaceObject, "ManeuveringThrusterLeft", function() { return thruster_ManeuveringThrusterLeft; });
__webpack_require__.d(thruster_namespaceObject, "ManeuveringThrusterRight", function() { return thruster_ManeuveringThrusterRight; });
__webpack_require__.d(thruster_namespaceObject, "ChemicalThruster", function() { return thruster_ChemicalThruster; });
var engine_namespaceObject = {};
__webpack_require__.r(engine_namespaceObject);
__webpack_require__.d(engine_namespaceObject, "Engine", function() { return engine_Engine; });
var reactor_namespaceObject = {};
__webpack_require__.r(reactor_namespaceObject);
__webpack_require__.d(reactor_namespaceObject, "Reactor", function() { return reactor_Reactor; });
var structure_namespaceObject = {};
__webpack_require__.r(structure_namespaceObject);
__webpack_require__.d(structure_namespaceObject, "Structure", function() { return structure_Structure; });
var electronicWarfare_namespaceObject = {};
__webpack_require__.r(electronicWarfare_namespaceObject);
__webpack_require__.d(electronicWarfare_namespaceObject, "EwArray", function() { return electronicWarfare_EwArray; });
__webpack_require__.d(electronicWarfare_namespaceObject, "CQEWArray", function() { return electronicWarfare_CQEWArray; });
__webpack_require__.d(electronicWarfare_namespaceObject, "ElintArray", function() { return electronicWarfare_ElintArray; });
__webpack_require__.d(electronicWarfare_namespaceObject, "OEWArray", function() { return electronicWarfare_OEWArray; });
var coilgun_namespaceObject = {};
__webpack_require__.r(coilgun_namespaceObject);
__webpack_require__.d(coilgun_namespaceObject, "CoilgunLightFixed", function() { return coilgun_CoilgunLightFixed; });
__webpack_require__.d(coilgun_namespaceObject, "RailgunTurreted64gw", function() { return coilgun_RailgunTurreted64gw; });
__webpack_require__.d(coilgun_namespaceObject, "RailgunTurreted32gw", function() { return coilgun_RailgunTurreted32gw; });
__webpack_require__.d(coilgun_namespaceObject, "MediumCoilgunTurretedUC", function() { return coilgun_MediumCoilgunTurretedUC; });
var railgun_namespaceObject = {};
__webpack_require__.r(railgun_namespaceObject);
__webpack_require__.d(railgun_namespaceObject, "RailgunFixed120mm", function() { return railgun_RailgunFixed120mm; });
__webpack_require__.d(railgun_namespaceObject, "RailgunTurreted2x140mm", function() { return railgun_RailgunTurreted2x140mm; });
__webpack_require__.d(railgun_namespaceObject, "RailgunTurreted140mmUC", function() { return railgun_RailgunTurreted140mmUC; });
var launcher_namespaceObject = {};
__webpack_require__.r(launcher_namespaceObject);
__webpack_require__.d(launcher_namespaceObject, "TorpedoLauncher158", function() { return launcher_TorpedoLauncher158; });
__webpack_require__.d(launcher_namespaceObject, "TorpedoLauncherDual72", function() { return launcher_TorpedoLauncherDual72; });
__webpack_require__.d(launcher_namespaceObject, "TorpedoLauncherDual158", function() { return launcher_TorpedoLauncherDual158; });
__webpack_require__.d(launcher_namespaceObject, "TorpedoLauncherQuadruple158", function() { return launcher_TorpedoLauncherQuadruple158; });
var heat_namespaceObject = {};
__webpack_require__.r(heat_namespaceObject);
__webpack_require__.d(heat_namespaceObject, "Radiator", function() { return heat_Radiator; });
__webpack_require__.d(heat_namespaceObject, "HeatSink", function() { return heat_HeatSink; });
__webpack_require__.d(heat_namespaceObject, "Radiator5x40", function() { return heat_Radiator5x40; });
__webpack_require__.d(heat_namespaceObject, "Radiator10x40", function() { return heat_Radiator10x40; });
__webpack_require__.d(heat_namespaceObject, "Radiator10x50", function() { return heat_Radiator10x50; });
var uc_namespaceObject = {};
__webpack_require__.r(uc_namespaceObject);
__webpack_require__.d(uc_namespaceObject, "UcRhino", function() { return uc_UcRhino; });
__webpack_require__.d(uc_namespaceObject, "Haka", function() { return ships_uc_Haka; });
var test_namespaceObject = {};
__webpack_require__.r(test_namespaceObject);
__webpack_require__.d(test_namespaceObject, "TestShip", function() { return test_TestShip; });
var protectorate_namespaceObject = {};
__webpack_require__.r(protectorate_namespaceObject);
__webpack_require__.d(protectorate_namespaceObject, "Caliope", function() { return ships_protectorate_Caliope; });
__webpack_require__.d(protectorate_namespaceObject, "Mouros", function() { return ships_protectorate_Mouros; });
__webpack_require__.d(protectorate_namespaceObject, "Fulcrum", function() { return ships_protectorate_Fulcrum; });
var federation_namespaceObject = {};
__webpack_require__.r(federation_namespaceObject);
__webpack_require__.d(federation_namespaceObject, "Impetous", function() { return ships_federation_Impetous; });

// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(0);
var react_default = /*#__PURE__*/__webpack_require__.n(react);

// EXTERNAL MODULE: ./node_modules/react-dom/index.js
var react_dom = __webpack_require__(142);
var react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js
var classCallCheck = __webpack_require__(1);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js
var createClass = __webpack_require__(2);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js + 1 modules
var possibleConstructorReturn = __webpack_require__(4);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js
var getPrototypeOf = __webpack_require__(3);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js
var inherits = __webpack_require__(5);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js + 1 modules
var objectWithoutProperties = __webpack_require__(14);

// EXTERNAL MODULE: ./node_modules/react-router/esm/react-router.js + 1 modules
var react_router = __webpack_require__(32);

// EXTERNAL MODULE: ./node_modules/react-router-dom/esm/react-router-dom.js
var react_router_dom = __webpack_require__(31);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules
var slicedToArray = __webpack_require__(21);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js
var taggedTemplateLiteral = __webpack_require__(8);

// EXTERNAL MODULE: ./node_modules/styled-components/dist/styled-components.browser.esm.js
var styled_components_browser_esm = __webpack_require__(7);

// CONCATENATED MODULE: ./src/model/utils/math.mjs
var math_distance=function distance(x1,y1,x2,y2){if(y1.x!==undefined&&x1.x!==undefined){x2=y1.x;y2=y1.y;y1=x1.y;x1=x1.x;}return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2));};var distance3d=function distance3d(pointA,pointB){var dx=pointB.x-pointA.x;var dy=pointB.y-pointA.y;var dz=pointB.z-pointA.z;var dist=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)+Math.pow(dz,2));return dist;};var getSeededRandomGenerator=function getSeededRandomGenerator(seed){function xmur3(str){for(var i=0,h=1779033703^str.length;i<str.length;i++){h=Math.imul(h^str.charCodeAt(i),3432918353);h=h<<13|h>>>19;}return function(){h=Math.imul(h^h>>>16,2246822507);h=Math.imul(h^h>>>13,3266489909);return(h^=h>>>16)>>>0;};}var seedGenerator=xmur3(seed);var xoshiro128ss=function xoshiro128ss(a,b,c,d){return function(){var t=b<<9,r=a*5;r=(r<<7|r>>>25)*9;c^=a;d^=b;b^=c;a^=d;c^=t;d=d<<11|d>>>21;return(r>>>0)/4294967296;};};return xoshiro128ss(seedGenerator(),seedGenerator(),seedGenerator(),seedGenerator());};var addToDirection=function addToDirection(current,add){add=add%360;var ret=0;if(current+add>360){ret=add-(360-current);}else if(current+add<0){ret=360+(current+add);}else{ret=current+add;}return ret;};var getDistanceBetweenDirections=function getDistanceBetweenDirections(start,end){var direction=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;if(end===start){return 0;}if(direction>0){if(end<start){return 360-start+end;}else{return end-start;}}else{if(end>start){return 360-end+start;}else{return start-end;}}};var getPointBetween=function getPointBetween(start,end,percentage,noRound){var x=start.x+percentage*(end.x-start.x);var y=start.y+percentage*(end.y-start.y);if(noRound){return{x:x,y:y};}return{x:Math.floor(x),y:Math.floor(y)};};var getPointBetween3d=function getPointBetween3d(start,end,percentage,noRound){var x=start.x+percentage*(end.x-start.x);var y=start.y+percentage*(end.y-start.y);var z=start.z+percentage*(end.z-start.z);if(noRound){return{x:x,y:y,z:z};}return{x:Math.floor(x),y:Math.floor(y),z:Math.floor(z)};};var getPointBetweenInDistance=function getPointBetweenInDistance(start,end,distance,noRound){var totalDistance=distance3d(start,end);var percentage=distance/totalDistance;return getPointBetween3d(start,end,percentage,noRound);};var getDistanceBetweenShipsInHex=function getDistanceBetweenShipsInHex(s1,s2){var start=s1.getHexPosition();var end=s2.getHexPosition();return start.distanceTo(end);};var getAngleBetween=function getAngleBetween(angle1,angle2,right){var difference;if(right){if(angle1>angle2){difference=360-angle1+angle2;}else{difference=angle2-angle1;}}else{if(angle1<angle2){difference=(angle1+(360-angle2))*-1;}else{difference=angle2-angle1;}}return difference;};var addToHexFacing=function addToHexFacing(facing,add){if(facing+add>5){return addToHexFacing(0,facing+add-6);}if(facing+add<0){return addToHexFacing(6,facing+add);}return facing+add;};var getPointInDirection=function getPointInDirection(r,a,cx,cy,noRound){a=-a;var x=cx+r*Math.cos(a*Math.PI/180);var y=cy+r*Math.sin(a*Math.PI/180);if(noRound){return{x:x,y:y};}return{x:Math.round(x),y:Math.round(y)};};var getArcLength=function getArcLength(start,end){var a=0;if(start>end){a=360-start+end;}else{a=end-start;}return a;};var isInArc=function isInArc(direction,start,end){//direction: 300 start: 360 end: 240
direction=Math.round(direction);if(start===end)return true;if(direction===0&&start===360||direction===0&&end===360)return true;if(start>end){return direction>=start||direction<=end;}else if(direction>=start&&direction<=end){return true;}return false;};var radianToDegree=function radianToDegree(angle){return angle*(180.0/Math.PI);};var degreeToRadian=function degreeToRadian(angle){return angle/(180.0/Math.PI);};var getCompassHeadingOfPoint=function getCompassHeadingOfPoint(observer,target){var heading=radianToDegree(Math.atan2(target.y-observer.y,target.x-observer.x));if(heading>0){heading=360-heading;}else{heading=Math.abs(heading);}return heading;};var hexFacingToAngle=function hexFacingToAngle(d){switch(d){case 0:return 0;case 1:return 60;case 2:return 120;case 3:return 180;case 4:return 240;default:return 300;}};var angleToHexFacing=function angleToHexFacing(d){switch(d){case 0:return 0;case 60:return 1;case 120:return 2;case 180:return 3;case 240:return 4;default:return 5;}};var shuffleArray=function shuffleArray(a){for(var i=a.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var _ref=[a[j],a[i]];a[i]=_ref[0];a[j]=_ref[1];}return a;};
// CONCATENATED MODULE: ./src/client/view/game/components/GameSceneComponent.js
function _templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  z-index: 2;\n  width: 100%;\n  height: 100%;\n  background-color: transparent;\n"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  width: 100%;\n  height: 100%;\n  background-size: cover;\n  background-color: #030910;\n  box-shadow: inset 0px 0px 200px rgba(0, 0, 0, 1);\n"]);_templateObject=function _templateObject(){return data;};return data;}var WebglCanvas=styled_components_browser_esm["b" /* default */].div(_templateObject());//background-color: #0b121a;
var ClickCatcher=styled_components_browser_esm["b" /* default */].div(_templateObject2());var getMousePositionInObservedElement=function getMousePositionInObservedElement(event,element){if(event.touches){return{x:event.originalEvent.touches[0].pageX-element.offset().left,y:event.originalEvent.touches[0].pageY-element.offset().top,xR:(event.originalEvent.touches[0].pageX-element.offset().left)/window.innerWidth*2-1,yR:-((event.originalEvent.touches[0].pageY-element.offset().top)/window.innerHeight)*2+1};}return{x:event.clientX,y:event.clientY,xR:event.clientX/element.offsetWidth*2-1,yR:-(event.clientY/element.offsetHeight)*2+1};};var GameSceneComponent_GameSceneComponent=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(GameSceneComponent,_React$Component);function GameSceneComponent(props){var _this;Object(classCallCheck["a" /* default */])(this,GameSceneComponent);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameSceneComponent).call(this,props));// create a ref to store the textInput DOM element
_this.onTouchStart=function(event){event.stopPropagation();event.preventDefault();};_this.onWheel=function(event){event.stopImmediatePropagation();event.preventDefault();var game=_this.props.game;var delta=Math.sign(event.deltaY);game.onMouseWheel(delta);};_this.onResize=function(){var game=_this.props.game;game.onResize();};_this.canvasRef=react["createRef"]();_this.clickCatcherRef=react["createRef"]();_this.mouseDownPosition=null;_this.lastDraggingPosition=null;_this.draggingThreshold=5;return _this;}Object(createClass["a" /* default */])(GameSceneComponent,[{key:"componentDidMount",value:function componentDidMount(){var game=this.props.game;window.addEventListener("resize",this.onResize);this.clickCatcherRef.current.addEventListener("wheel",this.onWheel);window.addEventListener("touchstart",this.onTouchStart);document.addEventListener("keydown",this.onKeyDown.bind(this),false);document.addEventListener("keyup",this.onKeyUp.bind(this),false);game.initRender(this.canvasRef.current);}},{key:"componentWillUnmount",value:function componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown.bind(this),false);document.removeEventListener("keyup",this.onKeyUp.bind(this),false);window.removeEventListener("resize",this.onResize);this.clickCatcherRef.current.removeEventListener("wheel",this.onWheel);window.removeEventListener("touchstart",this.onTouchStart);}},{key:"onMouseDown",value:function onMouseDown(event){event.stopPropagation();event.preventDefault();this.mouseDownPosition=getMousePositionInObservedElement(event,this.clickCatcherRef.current);}},{key:"onMouseUp",value:function onMouseUp(event){event.stopPropagation();event.preventDefault();var game=this.props.game;if(!this.lastDraggingPosition){game.onMouseUp(getMousePositionInObservedElement(event,this.clickCatcherRef.current),event.button);}this.mouseDownPosition=null;this.lastDraggingPosition=null;}},{key:"onMouseMove",value:function onMouseMove(event){event.stopPropagation();event.preventDefault();var game=this.props.game;if(this.mouseDownPosition===null){game.onMouseMove(getMousePositionInObservedElement(event,this.canvasRef.current));return;}var position=getMousePositionInObservedElement(event,this.clickCatcherRef.current);if(!this.lastDraggingPosition&&math_distance(this.mouseDownPosition,position)>this.draggingThreshold){this.lastDraggingPosition=this.mouseDownPosition;}if(this.lastDraggingPosition){var delta={x:position.x-this.lastDraggingPosition.x,y:position.y-this.lastDraggingPosition.y};this.lastDraggingPosition=position;game.onDrag(position,delta);}}},{key:"onMouseOut",value:function onMouseOut(event){var game=this.props.game;this.mouseDownPosition=null;this.lastDraggingPosition=null;game.onMouseOut(event);}},{key:"onKeyDown",value:function onKeyDown(event){var game=this.props.game;game.onKeyDown(event);}},{key:"onKeyUp",value:function onKeyUp(event){var game=this.props.game;game.onKeyUp(event);}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.props.game.initRender(this.canvasRef.current);}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(nextProps,nextState){/*
    if (this.props.game != nextProps.game) {
      this.props.game.deactivate();
      return true;
    }
  */return false;}},{key:"render",value:function render(){return react["createElement"](react["Fragment"],null,react["createElement"](ClickCatcher,{ref:this.clickCatcherRef,onMouseOut:this.onMouseOut.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this),onMouseMove:this.onMouseMove.bind(this),onKeyUp:this.onKeyUp.bind(this),onContextMenu:function onContextMenu(e){e.preventDefault();e.stopPropagation();}}),react["createElement"](WebglCanvas,{ref:this.canvasRef}));}}]);return GameSceneComponent;}(react["Component"]);/* harmony default export */ var components_GameSceneComponent = (GameSceneComponent_GameSceneComponent);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(13);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 3 modules
var toConsumableArray = __webpack_require__(11);

// EXTERNAL MODULE: ./node_modules/three/build/three.js
var three = __webpack_require__(20);

// CONCATENATED MODULE: ./src/model/gameConfig.mjs
var HEX_SIZE=25.0;var ZOOM_MAX=40;var ZOOM_MIN=0.05;var ZOOM_PERSPECTIVE_MIN=100;var ZOOM_FOR_MAPICONS=4;var ZOOM_FOR_SHIPBADGE=2;var ZOOM_FOR_SHIPBADGE_NAME=0.5;var TORPEDO_Z=30;var COLOR_FRIENDLY=new three.Color(0/255,138/255,255/255);//new THREE.Color(39 / 255, 196 / 255, 39 / 255);
var COLOR_ENEMY=new three.Color(196/255,39/255,39/255);var COLOR_FRIENDLY_HIGHLIGHT=COLOR_FRIENDLY.clone().multiplyScalar(1.5);var COLOR_ENEMY_HIGHLIGHT=COLOR_ENEMY.clone().multiplyScalar(1.5);var COLOR_OEW_FRIENDLY=new three.Color(160/255,150/255,250/255);var COLOR_OEW_ENEMY=new three.Color(255/255,40/255,40/255);var MEDIUM_WEAPON_RANGE=25;
// CONCATENATED MODULE: ./src/model/hexagon/Offset.mjs
var NEIGHBOURS=[[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:0,r:1},{q:1,r:1}],[{q:1,r:0},{q:0,r:-1},{q:-1,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}]];var Offset_Offset=/*#__PURE__*/function(){function Offset(q,r){Object(classCallCheck["a" /* default */])(this,Offset);if(q===undefined){console.trace();}if(q instanceof Offset||q.q!==undefined&&q.r!==undefined){var offset=q;this.q=offset.q;this.r=offset.r;}else{this.q=q;this.r=r;}}Object(createClass["a" /* default */])(Offset,[{key:"getNeighbours",value:function getNeighbours(){var neighbours=[];NEIGHBOURS[this.r&1].forEach(function(neighbour){neighbours.push(this.add(new Offset(neighbour)));},this);return neighbours;}},{key:"getNeighbourAtHeading",value:function getNeighbourAtHeading(heading){if(heading>=330||heading<=30){return this.add(new Offset(1,0));}else if(heading>=150&&heading<=210){return this.add(new Offset(-1,0));}else if(heading>30&&heading<90){return this.add(new Offset(1,-1));}else if(heading>=90&&heading<150){return this.add(new Offset(0,-1));}else if(heading>210&&heading<=270){return this.add(new Offset(0,1));}else if(heading>270&&heading<330){return this.add(new Offset(1,1));}}},{key:"add",value:function add(offset){return this.toCube().add(offset.toCube()).toOffset();}},{key:"subtract",value:function subtract(offset){return this.toCube().subtract(offset.toCube()).toOffset();}},{key:"scale",value:function scale(_scale){return this.toCube().scale(_scale).toOffset();}},{key:"moveToDirection",value:function moveToDirection(direction,steps){return this.toCube().moveToDirection(direction,steps).toOffset();}},{key:"equals",value:function equals(offset){return this.q===offset.q&&this.r===offset.r;}},{key:"getNeighbourAtDirection",value:function getNeighbourAtDirection(direction){var neighbours=this.getNeighbours();return neighbours[direction];}},{key:"distanceTo",value:function distanceTo(target){return this.toCube().distanceTo(target.toCube());}},{key:"ring",value:function ring(radius){return this.toCube().ring(radius).map(function(cube){return cube.toOffset();});}},{key:"spiral",value:function spiral(radius){return this.toCube().spiral(radius).map(function(cube){return cube.toOffset();});}},{key:"clone",value:function clone(){return new Offset(this);}},{key:"toCube",value:function toCube(){var x=this.q-(this.r+(this.r&1))/2;var z=this.r;var y=-x-z;/*
        var x, y, z;
        switch (this.layout) {
            case Offset.ODD_R:
                x = this.q - (this.r - (this.r & 1)) / 2;
                z = this.r;
                y = -x - z;
                break;
            case Offset.EVEN_R:
                x = this.q - (this.r + (this.r&1)) / 2;
                z = this.r;
                y = -x - z;
                break;
        }
        */return new hexagon_Cube(x,y,z).round();}},{key:"toVector",value:function toVector(){return utils_CoordinateConverter.fromHexToGame(this);}},{key:"drawLine",value:function drawLine(target,distance){return this.toCube().drawLine(target.toCube(),distance).map(function(cube){return cube.toOffset();});}},{key:"toString",value:function toString(){return"(".concat(this.q,", ").concat(this.r,")");}},{key:"rotate",value:function rotate(facing){return this.toCube().rotate(facing).toOffset();}},{key:"normalize",value:function normalize(){return this.toCube().normalize().toOffset();}}]);return Offset;}();/* harmony default export */ var hexagon_Offset = (Offset_Offset);
// CONCATENATED MODULE: ./src/model/hexagon/Cube.mjs
var PRECISION=4;var lerp=function lerp(a,b,t){return a+(b-a)*t;};var cubeLerp=function cubeLerp(a,b,t){return new Cube_Cube(lerp(a.x,b.x,t),lerp(a.y,b.y,t),lerp(a.z,b.z,t));};var Cube_Cube=/*#__PURE__*/function(){function Cube(x,y,z){Object(classCallCheck["a" /* default */])(this,Cube);if(x instanceof Cube||x.x!==undefined&&x.y!==undefined&&x.z!==undefined){var cube=x;this.x=this._formatNumber(cube.x);this.y=this._formatNumber(cube.y);this.z=this._formatNumber(cube.z);}else{this.x=this._formatNumber(x);this.y=this._formatNumber(y);this.z=this._formatNumber(z);}this.neighbours=[{x:1,y:-1,z:0},{x:1,y:0,z:-1},{x:0,y:1,z:-1},{x:-1,y:1,z:0},{x:-1,y:0,z:1},{x:0,y:-1,z:1}];this._validate();}Object(createClass["a" /* default */])(Cube,[{key:"round",value:function round(){if(this.x%1===0&&this.y%1===0&&this.z%1===0){return this;}var rx=Math.round(this.x);var ry=Math.round(this.y);var rz=Math.round(this.z);var x_diff=Math.abs(rx-this.x);var y_diff=Math.abs(ry-this.y);var z_diff=Math.abs(rz-this.z);if(x_diff>y_diff&&x_diff>z_diff){rx=-ry-rz;}else if(y_diff>z_diff){ry=-rx-rz;}else{rz=-rx-ry;}return new Cube(rx,ry,rz);}},{key:"_validate",value:function _validate(){if(Math.abs(this.x+this.y+this.z)>0.001){throw new Error("Invalid Cube coordinates: ("+this.x+", "+this.y+", "+this.z+")");}}},{key:"getNeighbours",value:function getNeighbours(){var neighbours=[];this.neighbours.forEach(function(neighbour){neighbours.push(this.add(new Cube(neighbour)));},this);return neighbours;}},{key:"moveToDirection",value:function moveToDirection(direction){var steps=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return this.add(new Cube(this.neighbours[direction]).scale(steps));}},{key:"add",value:function add(cube){return new Cube(this.x+cube.x,this.y+cube.y,this.z+cube.z);}},{key:"subtract",value:function subtract(cube){return new Cube(this.x-cube.x,this.y-cube.y,this.z-cube.z);}},{key:"scale",value:function scale(_scale){return new Cube(this.x*_scale,this.y*_scale,this.z*_scale);}},{key:"distanceTo",value:function distanceTo(cube){return Math.max(Math.abs(this.x-cube.x),Math.abs(this.y-cube.y),Math.abs(this.z-cube.z));}},{key:"equals",value:function equals(cube){return this.x===cube.x&&this.y===cube.y&&this.z===cube.z;}},{key:"clone",value:function clone(){return new Cube(this);}},{key:"getFacing",value:function getFacing(neighbour){var index=-1;var delta=neighbour.subtract(this);this.neighbours.some(function(hex,i){if(delta.equals(hex)){index=i;return true;}return false;});return index;}},{key:"ring",value:function ring(radius){var results=[];if(radius===0){return results;}var cube=this.moveToDirection(4,radius);for(var i=0;i<6;i++){for(var j=0;j<radius;j++){results.push(cube);cube=cube.moveToDirection(i);}}return results;}},{key:"spiral",value:function spiral(radius){var results=[this.clone()];for(var k=1;k<=radius;k++){results=results.concat(this.ring(k));}return results;}},{key:"toOffset",value:function toOffset(){var q=this.x+(this.z+(this.z&1))/2;var r=this.z;return new hexagon_Offset(q,r);//EVEN_R
}/*
        Cube.prototype.toOffset = function()
        {
            var q = this.x + (this.z - (this.z & 1)) / 2;
            var r = this.z;
    
            return new hexagon.Offset(q, r); //ODD_R
        };
    */},{key:"toString",value:function toString(){return"("+this.x+","+this.y+","+this.z+")";}},{key:"_formatNumber",value:function _formatNumber(number){return parseFloat(number.toFixed(PRECISION));}},{key:"normalize",value:function normalize(){return this.drawLine(new Cube(0,0,0),1)[0];}},{key:"drawLine",value:function drawLine(target){var distance=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=this.distanceTo(target);if(distance===null){distance=n;}var results=[];for(var i=distance;i>=0;i--){results.push(cubeLerp(target,this,1.0/n*i).round());}return results;}},{key:"rotate",value:function rotate(facing){var result=this;var takeStep=function takeStep(cube){return new Cube(-cube.y,-cube.z,-cube.x);};while(facing--){result=takeStep(result);}return result;}}]);return Cube;}();/* harmony default export */ var hexagon_Cube = (Cube_Cube);
// CONCATENATED MODULE: ./src/model/hexagon/index.mjs
/* harmony default export */ var hexagon = ({Cube:hexagon_Cube,Offset:hexagon_Offset});
// CONCATENATED MODULE: ./src/model/utils/HexagonMath.mjs
var HexagonMath_getHexA=function getHexA(hexSize){if(!hexSize){hexSize=HEX_SIZE;}return hexSize*Math.sin(30/180*Math.PI);};var HexagonMath_getHexB=function getHexB(hexSize){if(!hexSize){hexSize=HEX_SIZE;}return hexSize*Math.cos(30/180*Math.PI);};var HexagonMath_getHexHeight=function getHexHeight(hexSize){if(!hexSize){hexSize=HEX_SIZE;}return hexSize+2*HexagonMath_getHexA(hexSize);};var HexagonMath_getHexWidth=function getHexWidth(hexSize){if(!hexSize){hexSize=HEX_SIZE;}return HexagonMath_getHexB(hexSize)*2;};var HexagonMath_getHexRowHeight=function getHexRowHeight(hexSize){if(!hexSize){hexSize=HEX_SIZE;}return hexSize+HexagonMath_getHexA(hexSize);};var HexagonMath_getTextureHeight=function getTextureHeight(hexSize){if(!hexSize){hexSize=HEX_SIZE;}return Math.floor(hexSize+HexagonMath_getHexHeight(hexSize));};var HexagonMath_getTextureWidth=function getTextureWidth(hexSize){if(!hexSize){hexSize=HEX_SIZE;}return HexagonMath_getHexWidth(hexSize)*2;};var getGridWidth=function getGridWidth(hexCountWidth){return HexagonMath_getHexWidth()*(hexCountWidth+0.5);};var HexagonMath_getGridHeight=function getGridHeight(hexCountHeight){var amount=Math.floor(hexCountHeight/2);var height=amount*(HexagonMath_getHexHeight()+HEX_SIZE);if(hexCountHeight%2!==0){height+=HexagonMath_getHexHeight();}return height;};/* harmony default export */ var HexagonMath = ({getHexA:HexagonMath_getHexA,getHexB:HexagonMath_getHexB,getHexHeight:HexagonMath_getHexHeight,getHexWidth:HexagonMath_getHexWidth,getHexRowHeight:HexagonMath_getHexRowHeight,getTextureHeight:HexagonMath_getTextureHeight,getTextureWidth:HexagonMath_getTextureWidth,getGridWidth:getGridWidth,getGridHeight:HexagonMath_getGridHeight});
// CONCATENATED MODULE: ./src/model/utils/CoordinateConverter.mjs
var getShipIcon=function getShipIcon(object3d){do{if(object3d.userData.icon){return object3d.userData.icon;}object3d=object3d.parent;}while(object3d.parent);return null;};var CoordinateConverter_CoordinateConverter=/*#__PURE__*/function(){function CoordinateConverter(){Object(classCallCheck["a" /* default */])(this,CoordinateConverter);this.hexlenght=HEX_SIZE;this.width=0;this.height=0;this.zoom=1;this.camera=null;this.scene=null;this.raycaster=new three.Raycaster();}Object(createClass["a" /* default */])(CoordinateConverter,[{key:"init",value:function init(camera,scene){this.camera=camera;this.scene=scene;}},{key:"onResize",value:function onResize(_ref){var width=_ref.width,height=_ref.height;this.width=width;this.height=height;}},{key:"onZoom",value:function onZoom(zoom){this.zoom=zoom;}},{key:"fromHexToViewport",value:function fromHexToViewport(hex){return this.fromGameToViewPort(this.fromHexToGame(hex));}},{key:"getHexHeightViewport",value:function getHexHeightViewport(){return HexagonMath.getHexHeight()/this.zoom;}},{key:"getHexDistance",value:function getHexDistance(){var hex1=new hexagon.Offset(0,0);var hex2=hex1.getNeighbourAtDirection(0);return math_distance(this.fromHexToGame(hex1),this.fromHexToGame(hex2));}},{key:"fromGameToHex",value:function fromGameToHex(gameCoordinates){if(!gameCoordinates){console.trace();}var q=(1/3*Math.sqrt(3)*gameCoordinates.x-1/3*gameCoordinates.y)/this.hexlenght;var r=2/3*gameCoordinates.y/this.hexlenght;var x=q;var z=r;var y=-x-z;return new hexagon.Cube(x,y,z).round().toOffset();}},{key:"fromHexToGame",value:function fromHexToGame(offsetHex){if(offsetHex instanceof hexagon.Cube){offsetHex=offsetHex.toOffset();}if(!(offsetHex instanceof hexagon.Offset)){offsetHex=new hexagon.Offset(offsetHex.q,offsetHex.r);}var x=this.hexlenght*Math.sqrt(3)*(offsetHex.q-0.5*(offsetHex.r&1));var y=this.hexlenght*3/2*offsetHex.r;return new utils_Vector(x,y,0);}},{key:"fromViewPortToGame",value:function fromViewPortToGame(pos){var result={x:0,y:0,z:0};this.raycaster.setFromCamera({x:pos.xR,y:pos.yR},this.camera.getCamera());var intersects=this.raycaster.intersectObjects(this.scene.children,true);intersects.forEach(function(intersected){if(intersected.object.name==="hexgrid"){result.x=intersected.point.x;result.y=intersected.point.y;result.z=intersected.point.z;}});return result;}},{key:"getEntitiesIntersected",value:function getEntitiesIntersected(pos){var debug=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var result=[];this.raycaster.setFromCamera({x:pos.xR,y:pos.yR},this.camera.getCamera());var intersects=this.raycaster.intersectObjects(this.scene.children,true);intersects.forEach(function(intersected){if(intersected.object.name!=="hexgrid"){var icon=getShipIcon(intersected.object);icon&&!result.includes(icon)&&result.push(icon);}});return result;}},{key:"fromGameToViewPort",value:function fromGameToViewPort(pos){var vector=new three.Vector3();vector.set(pos.x,pos.y,pos.z||0);// map to normalized device coordinate (NDC) space
vector.project(this.camera.getCamera());// map to 2D screen space
vector.x=Math.round((vector.x+1)*this.width/2);vector.y=Math.round((-vector.y+1)*this.height/2);vector.z=0;return{x:vector.x,y:vector.y};/*
        var cameraPos = this.camera.position;
        var zoom = this.zoom;
        var windowDimensions = { width: this.width, height: this.height };

        var positionFromCamera = { x: pos.x - cameraPos.x, y: pos.y - cameraPos.y };
        var withZoom = { x: positionFromCamera.x / zoom, y: positionFromCamera.y / zoom };
        var positionFromCenterOfScreen = { x: withZoom.x + windowDimensions.width / 2, y: windowDimensions.height / 2 - withZoom.y };

        return positionFromCenterOfScreen;
        */}}]);return CoordinateConverter;}();var CoordinateConverter_coordinateConverter=new CoordinateConverter_CoordinateConverter();/* harmony default export */ var utils_CoordinateConverter = (CoordinateConverter_coordinateConverter);
// CONCATENATED MODULE: ./src/model/utils/Vector.mjs
var helperA=new three.Vector3();var helperB=new three.Vector3();var Vector_Vector=/*#__PURE__*/function(){function Vector(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var z=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;Object(classCallCheck["a" /* default */])(this,Vector);if(x instanceof three.Vector3||x instanceof Vector){this.x=x.x;this.y=x.y;this.z=x.z;}else if(x instanceof three.Vector2){this.x=x.x;this.y=x.y;this.z=0;}else if(typeof x==="object"){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0;}else{this.x=x;this.y=y;this.z=z;}}Object(createClass["a" /* default */])(Vector,[{key:"clone",value:function clone(){return new Vector(this.x,this.y,this.z);}},{key:"serialize",value:function serialize(){return{x:this.x,y:this.y,z:this.z};}},{key:"setX",value:function setX(x){return new Vector(x,this.y,this.z);}},{key:"setY",value:function setY(y){return new Vector(this.x,y,this.z);}},{key:"setZ",value:function setZ(z){return new Vector(this.x,this.y,z);}},{key:"setFromAngle",value:function setFromAngle(a){return new Vector(Math.cos(degreeToRadian(a)),Math.sin(degreeToRadian(a))).normalize();}},{key:"distanceTo",value:function distanceTo(vector){vector=new Vector(vector);helperA.set(this.x,this.y,this.z);helperB.set(vector.x,vector.y,vector.z);return helperA.distanceTo(helperB);}},{key:"add",value:function add(vector){vector=new Vector(vector);helperA.set(this.x,this.y,this.z);helperB.set(vector.x,vector.y,vector.z);helperA.add(helperB);return new Vector(helperA.x,helperA.y,helperA.z);}},{key:"dot",value:function dot(vector){helperA.set(this.x,this.y,this.z);helperB.set(vector.x,vector.y,vector.z);return helperA.dot(helperB);}},{key:"subtract",value:function subtract(vector){return this.sub(vector);}},{key:"sub",value:function sub(vector){vector=new Vector(vector);helperA.set(this.x,this.y,this.z);helperB.set(vector.x,vector.y,vector.z);helperA.sub(helperB);return new Vector(helperA.x,helperA.y,helperA.z);}},{key:"normalize",value:function normalize(){helperA.set(this.x,this.y,this.z);helperA.normalize();return new Vector(helperA.x,helperA.y,helperA.z);}},{key:"multiplyScalar",value:function multiplyScalar(scalar){helperA.set(this.x,this.y,this.z);helperA.multiplyScalar(scalar);return new Vector(helperA.x,helperA.y,helperA.z);}},{key:"length",value:function length(){helperA.set(this.x,this.y,this.z);return helperA.length();}},{key:"applyMatrix4",value:function applyMatrix4(matrix){helperA.set(this.x,this.y,this.z);return new Vector(helperA.applyMatrix4(matrix));}},{key:"equals",value:function equals(vector){if(!vector){return false;}return this.x===vector.x&&this.y===vector.y&&this.z===vector.z;}},{key:"round",value:function round(){return new Vector(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z));}},{key:"roundToHexCenter",value:function roundToHexCenter(){return utils_CoordinateConverter.fromHexToGame(utils_CoordinateConverter.fromGameToHex(this));}},{key:"toOffset",value:function toOffset(){return utils_CoordinateConverter.fromGameToHex(this);}},{key:"toString",value:function toString(){return"(x:".concat(this.x,", y:").concat(this.y,", z:").concat(this.z,")");}},{key:"toThree",value:function toThree(){return new three.Vector3(this.x,this.y,this.z);}},{key:"toObject",value:function toObject(){return{x:this.x,y:this.y,z:this.z};}}]);return Vector;}();/* harmony default export */ var utils_Vector = (Vector_Vector);
// CONCATENATED MODULE: ./src/model/movement/RequiredThrust.mjs
var RequiredThrust_RequiredThrust=/*#__PURE__*/function(){function RequiredThrust(ship,move){Object(classCallCheck["a" /* default */])(this,RequiredThrust);this.requirements={};this.fullfilments={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[]};if(move){switch(move.type){case movement_movementTypes.SPEED:this.requireSpeed(ship,move);break;case movement_movementTypes.PIVOT:this.requirePivot(ship,move);break;case movement_movementTypes.ROLL:this.requireRoll(ship);break;case movement_movementTypes.EVADE:this.requireEvade(ship,move);break;default:}}}Object(createClass["a" /* default */])(RequiredThrust,[{key:"serialize",value:function serialize(){return{requirements:this.requirements,fullfilments:this.fullfilments};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.requirements=data.requirements||{};this.fullfilments=data.fullfilments||{0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[]};return this;}},{key:"getTotalAmountRequired",value:function getTotalAmountRequired(){var _this=this;return Object.keys(this.requirements).reduce(function(total,direction){var required=_this.requirements[direction]||0;return total+required;},0);}},{key:"getRequirement",value:function getRequirement(direction){if(!this.requirements[direction]){return 0;}return this.requirements[direction]-this.getFulfilledAmount(direction);}},{key:"isFulfilled",value:function isFulfilled(){var _this2=this;return Object.keys(this.requirements).every(function(direction){return _this2.getRequirement(direction)===0;});}},{key:"fulfill",value:function fulfill(direction,amount,thruster){this.fullfilments[direction].push({amount:amount,thrusterId:thruster.id});if(this.requirements[direction]<this.getFulfilledAmount(direction)){throw new Error("Fulfilled too much!");}}},{key:"getFulfilledAmount",value:function getFulfilledAmount(direction){return this.fullfilments[direction].reduce(function(total,entry){return total+entry.amount;},0);}},{key:"getFulfilments",value:function getFulfilments(){var _this3=this;return Object.keys(this.fullfilments).map(function(key){return _this3.fullfilments[key];}).filter(function(fulfillment){return fulfillment.length>0;});}},{key:"requireRoll",value:function requireRoll(ship){this.requirements[8]=ship.rollcost;}},{key:"requireEvade",value:function requireEvade(ship,move){this.requirements[8]=ship.evasioncost*move.value;}},{key:"requirePivot",value:function requirePivot(ship,move){if(ship.movement.isRolled()){if(move.value===1){this.requirements[7]=ship.pivotcost;}else{this.requirements[6]=ship.pivotcost;}}else{if(move.value===1){this.requirements[6]=ship.pivotcost;}else{this.requirements[7]=ship.pivotcost;}}}},{key:"requireSpeed",value:function requireSpeed(ship,move){var facing=move.facing;var direction=move.value;var actualDirection=addToHexFacing(addToHexFacing(direction,-facing),3);if(ship.movement.isRolled()&&[1,2,4,5].includes(actualDirection)){this.requirements[addToHexFacing(actualDirection,3)]=ship.accelcost;}else{this.requirements[actualDirection]=ship.accelcost;}}},{key:"accumulate",value:function accumulate(total){var _this4=this;Object.keys(this.requirements).forEach(function(direction){total[direction]=total[direction]?total[direction]+_this4.requirements[direction]:_this4.requirements[direction];});return total;}}]);return RequiredThrust;}();/* harmony default export */ var movement_RequiredThrust = (RequiredThrust_RequiredThrust);
// CONCATENATED MODULE: ./src/model/movement/MovementOrder.mjs
var MovementOrder_MovementOrder=/*#__PURE__*/function(){function MovementOrder(id,type,position,velocity,facing,rolled,turn){var value=arguments.length>7&&arguments[7]!==undefined?arguments[7]:0;var requiredThrust=arguments.length>8&&arguments[8]!==undefined?arguments[8]:undefined;var index=arguments.length>9&&arguments[9]!==undefined?arguments[9]:0;var evasion=arguments.length>10&&arguments[10]!==undefined?arguments[10]:0;Object(classCallCheck["a" /* default */])(this,MovementOrder);this.id=id;this.type=type;this.facing=facing;this.rolled=rolled;this.turn=turn;this.value=value;this.requiredThrust=requiredThrust||new movement_RequiredThrust();this.index=index;this.setPosition(position);this.setVelocity(velocity);this.evasion=evasion;}Object(createClass["a" /* default */])(MovementOrder,[{key:"round",value:function round(){var position=this.position.round();var velocity=this.velocity.round();var clone=this.clone();clone.setPosition(position);clone.setVelocity(velocity);return clone;}},{key:"setPosition",value:function setPosition(position){if(position instanceof hexagon.Offset){position=utils_CoordinateConverter.fromHexToGame(position);}this.position=position;}},{key:"setVelocity",value:function setVelocity(velocity){if(velocity instanceof hexagon.Offset){velocity=utils_CoordinateConverter.fromHexToGame(velocity);}this.velocity=velocity;}},{key:"setEvasion",value:function setEvasion(evasion){this.evasion=evasion;return this;}},{key:"getFacing",value:function getFacing(){return this.facing;}},{key:"getPosition",value:function getPosition(){return this.position;}},{key:"getVelocity",value:function getVelocity(){return this.velocity;}},{key:"getHexPosition",value:function getHexPosition(){return utils_CoordinateConverter.fromGameToHex(this.position);}},{key:"getHexVelocity",value:function getHexVelocity(){return utils_CoordinateConverter.fromGameToHex(this.velocity);}},{key:"setRequiredThrust",value:function setRequiredThrust(req){this.requiredThrust=req;return this;}},{key:"setId",value:function setId(id){this.id=id;return this;}},{key:"setIndex",value:function setIndex(index){this.index=index;return this;}},{key:"serialize",value:function serialize(){return{id:this.id,type:this.type,position:this.position.serialize(),velocity:this.velocity.serialize(),facing:this.facing,rolled:this.rolled,turn:this.turn,value:this.value,requiredThrust:this.requiredThrust.serialize(),index:this.index,evasion:this.evasion};}},{key:"deserialize",value:function deserialize(data){this.id=data.id;this.type=data.type;this.position=new utils_Vector(data.position);this.velocity=new utils_Vector(data.velocity);this.facing=data.facing;this.rolled=data.rolled;this.turn=data.turn;this.value=data.value;this.index=data.index;this.evasion=data.evasion||0;this.requiredThrust=new movement_RequiredThrust().deserialize(data.requiredThrust);return this;}},{key:"equals",value:function equals(move){return this.type===move.type&&this.position.roundToHexCenter().equals(move.position.roundToHexCenter())&&this.velocity.roundToHexCenter().equals(move.velocity.roundToHexCenter())&&this.facing===move.facing&&this.rolled===move.rolled&&this.turn===move.turn&&this.value===move.value;}},{key:"isSpeed",value:function isSpeed(){return this.type===movement_movementTypes.SPEED;}},{key:"isDeploy",value:function isDeploy(){return this.type===movement_movementTypes.DEPLOY;}},{key:"isStart",value:function isStart(){return this.type===movement_movementTypes.START;}},{key:"isEvade",value:function isEvade(){return this.type===movement_movementTypes.EVADE;}},{key:"isRoll",value:function isRoll(){return this.type===movement_movementTypes.ROLL;}},{key:"isEnd",value:function isEnd(){return this.type===movement_movementTypes.END;}},{key:"isPivot",value:function isPivot(){return this.type===movement_movementTypes.PIVOT;}},{key:"isCancellable",value:function isCancellable(){return this.isSpeed()||this.isPivot()||this.isEvade()||this.isRoll();}},{key:"isPlayerAdded",value:function isPlayerAdded(){return this.isSpeed()||this.isPivot()||this.isEvade()||this.isRoll();}},{key:"clone",value:function clone(){return new MovementOrder(this.id,this.type,this.position,this.velocity,this.facing,this.rolled,this.turn,this.value,this.requiredThrust,this.index,this.evasion);}},{key:"isOpposite",value:function isOpposite(move){switch(move.type){case movement_movementTypes.SPEED:return this.isSpeed()&&this.value===addToHexFacing(move.value,3);default:return false;}}}]);return MovementOrder;}();/* harmony default export */ var movement_MovementOrder = (MovementOrder_MovementOrder);
// CONCATENATED MODULE: ./src/model/movement/movementTypes.mjs
var movementTypes={START:"start",END:"end",DEPLOY:"deploy",SPEED:"speed",PIVOT:"pivot",EVADE:"evade",ROLL:"roll"};/* harmony default export */ var movement_movementTypes = (movementTypes);
// CONCATENATED MODULE: ./src/model/movement/MovementResolver.mjs
var MovementResolver_MovementResolver=/*#__PURE__*/function(){function MovementResolver(ship,movementService,turn){Object(classCallCheck["a" /* default */])(this,MovementResolver);this.ship=ship;this.movementService=movementService;this.turn=turn;}Object(createClass["a" /* default */])(MovementResolver,[{key:"billAndPay",value:function billAndPay(bill){var commit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(bill.pay()){var newMovement=bill.getMoves();if(commit){this.ship.movement.replaceMovement(newMovement);this.movementService.shipStateChanged(this.ship);}return true;}else if(commit){throw new Error("Tried to commit move that was not legal. Check legality first!");}else{return false;}}},{key:"canRoll",value:function canRoll(){return this.roll(false);}},{key:"roll",value:function roll(){var commit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var rollMove=this.ship.movement.getRollMove();var endMove=this.ship.movement.getLastEndMoveOrSurrogate();var movements=this.ship.movement.getMovement();if(rollMove){movements=movements.filter(function(move){return!move.isRoll();});}else{rollMove=new movement_MovementOrder(null,movement_movementTypes.ROLL,endMove.position,endMove.velocity,endMove.facing,endMove.rolled,this.turn,endMove.rolled?false:true);var playerAdded=movements.filter(function(move){return move.isPlayerAdded();});var nonPlayerAdded=movements.filter(function(move){return!move.isPlayerAdded();});movements=[].concat(Object(toConsumableArray["a" /* default */])(nonPlayerAdded),[rollMove],Object(toConsumableArray["a" /* default */])(playerAdded));}var bill=new movement_ThrustBill(this.ship,movements);return this.billAndPay(bill,commit);}},{key:"canEvade",value:function canEvade(step){return this.evade(step,false);}},{key:"evade",value:function evade(step){var commit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var evadeMove=this.ship.movement.getEvadeMove();var endMove=this.ship.movement.getLastEndMoveOrSurrogate();if(evadeMove){if(evadeMove.value+step>this.ship.movement.getMaxEvasion()){return false;}if(evadeMove.value+step<0){return false;}evadeMove.value+=step;}else{if(step<0){return false;}evadeMove=new movement_MovementOrder(null,movement_movementTypes.EVADE,endMove.position,endMove.velocity,endMove.facing,endMove.rolled,this.turn,1);}var playerAdded=this.ship.movement.getMovement().filter(function(move){return move.isPlayerAdded()&&!move.isRoll()&&!move.isEvade();});var nonPlayerAdded=this.ship.movement.getMovement().filter(function(move){return!move.isPlayerAdded()||move.isRoll();});var movements=evadeMove.value===0?[].concat(Object(toConsumableArray["a" /* default */])(nonPlayerAdded),Object(toConsumableArray["a" /* default */])(playerAdded)):[].concat(Object(toConsumableArray["a" /* default */])(nonPlayerAdded),[evadeMove],Object(toConsumableArray["a" /* default */])(playerAdded));var bill=new movement_ThrustBill(this.ship,movements);return this.billAndPay(bill,commit);}},{key:"canPivot",value:function canPivot(pivotDirection){return this.pivot(pivotDirection,false);}},{key:"pivot",value:function pivot(pivotDirection){var commit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var lastMove=this.ship.movement.getLastMove();var pivotMove=new movement_MovementOrder(null,movement_movementTypes.PIVOT,lastMove.position,lastMove.velocity,addToHexFacing(lastMove.facing,pivotDirection),lastMove.rolled,this.turn,pivotDirection);var movements=this.ship.movement.getMovement();if(lastMove.isPivot()&&lastMove.value!==pivotDirection){movements.pop();}else{if(this.ship.maxPivots!==null&&this.ship.movement.getMovement().filter(function(move){return move.isPivot();}).length>=this.ship.maxPivots){return false;}movements.push(pivotMove);}var bill=new movement_ThrustBill(this.ship,movements);return this.billAndPay(bill,commit);}},{key:"canThrust",value:function canThrust(direction){return this.thrust(direction,false);}},{key:"thrust",value:function thrust(direction){var commit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var lastMove=this.ship.movement.getLastMove();var thrustMove=new movement_MovementOrder(null,movement_movementTypes.SPEED,lastMove.position,lastMove.getHexVelocity().moveToDirection(direction),lastMove.facing,lastMove.rolled,this.turn,direction);var movements=this.ship.movement.getMovement();if(lastMove.isSpeed()&&lastMove.value===addToHexFacing(direction,3)){movements.pop();}else{movements.push(thrustMove);}var bill=new movement_ThrustBill(this.ship,movements);return this.billAndPay(bill,commit);}},{key:"canCancel",value:function canCancel(){return this.ship.movement.getMovement().some(function(move){return move.isCancellable();});}},{key:"cancel",value:function cancel(){var toCancel=this.ship.movement.getLastMove();if(!toCancel||!toCancel.isCancellable()){return;}this.ship.movement.removeMovement(toCancel);var bill=new movement_ThrustBill(this.ship,this.ship.movement.getMovement());return this.billAndPay(bill,true);}},{key:"canRevert",value:function canRevert(){return this.ship.movement.getMovement().some(function(move){return move.isPlayerAdded();});}},{key:"revert",value:function revert(){var _this=this;this.ship.movement.getMovement().filter(function(move){return move.isCancellable();}).forEach(function(move){return _this.ship.movement.removeMovement(move);});this.movementService.shipStateChanged(this.ship);}}]);return MovementResolver;}();/* harmony default export */ var movement_MovementResolver = (MovementResolver_MovementResolver);
// CONCATENATED MODULE: ./src/model/movement/ThrustBill.mjs
var ThrustBill_ThrustBill=/*#__PURE__*/function(){function ThrustBill(ship,movement){Object(classCallCheck["a" /* default */])(this,ThrustBill);this.ship=ship;this.movement=movement.map(function(move){return move.clone();});this.thrusters=ship.systems.getSystems().filter(function(system){return system.callHandler("isThruster",null,false);}).filter(function(system){return!system.isDisabled();}).map(function(thruster){return new movement_ThrustAssignment(thruster);});this.buildRequiredThrust(this.movement);this.fuel=this.ship.movement.getFuel();this.paid=null;this.directionsRequired=this.getRequiredThrustDirections();}Object(createClass["a" /* default */])(ThrustBill,[{key:"getRequiredThrustDirections",value:function getRequiredThrustDirections(){var result=this.movement.reduce(function(accumulator,move){return move.requiredThrust.accumulate(accumulator);},{});result[0]=result[0]||0;result[1]=result[1]||0;result[2]=result[2]||0;result[3]=result[3]||0;result[4]=result[4]||0;result[5]=result[5]||0;result[6]=result[6]||0;result[7]=result[7]||0;result[8]=result[8]||0;return result;}},{key:"getTotalThrustRequired",value:function getTotalThrustRequired(){var totalRequired=this.getRequiredThrustDirections();return totalRequired[0]+totalRequired[1]+totalRequired[2]+totalRequired[3]+totalRequired[4]+totalRequired[5]+totalRequired[6]+totalRequired[7]+totalRequired[8];}},{key:"getCurrentThrustRequired",value:function getCurrentThrustRequired(){return this.directionsRequired[0]+this.directionsRequired[1]+this.directionsRequired[2]+this.directionsRequired[3]+this.directionsRequired[4]+this.directionsRequired[5]+this.directionsRequired[6]+this.directionsRequired[7]+this.directionsRequired[8];}},{key:"isPaid",value:function isPaid(){/*
    console.log(
      "isPaid, required",
      this.getCurrentThrustRequired(),
      "this.fuel",
      this.fuel,
      "fuel required",
      this.totalFuelRequirement()
    );
    */return this.getCurrentThrustRequired()===0&&this.fuel>=this.totalFuelRequirement();}},{key:"totalFuelRequirement",value:function totalFuelRequirement(){return this.thrusters.reduce(function(all,thruster){return all+thruster.getFuelRequirement();},0);}},{key:"getAllUsableThrusters",value:function getAllUsableThrusters(direction){var _this=this;return this.thrusters.filter(function(thruster){var capacity=thruster.getThrustCapacity();return thruster.isDirection(direction)&&capacity>0&&_this.fuel>=thruster.getNextThrustFuelCost();}).sort(this.sortThrusters);}},{key:"sortThrusters",value:function sortThrusters(a,b){var _a$getOverheat=a.getOverheat(),aHeat=_a$getOverheat.overheatPercentage,aCooling=_a$getOverheat.coolingPercent;var _b$getOverheat=b.getOverheat(),bHeat=_b$getOverheat.overheatPercentage,bCooling=_b$getOverheat.coolingPercent;if(aHeat>bHeat){return-1;}if(aHeat<bHeat){return 1;}if(aCooling>bCooling){return-1;}if(aCooling<bCooling){return 1;}if(a.getNextThrustFuelCost()>b.getNextThrustFuelCost()){return-1;}if(a.getNextThrustFuelCost()<b.getNextThrustFuelCost()){return 1;}if(a.channeled>b.channeled){return-1;}if(a.channeled<b.channeled){return 1;}return 0;}},{key:"pay",value:function pay(){if(this.paid!==null){throw new Error("Thrust bill is already paid!");}try{this.process();this.paid=this.isPaid();return this.paid;}catch(e){if(e.message==="over budget"){this.paid=false;return this.paid;}throw e;}}},{key:"process",value:function process(){var _this2=this;Object.keys(this.directionsRequired).forEach(function(direction){var required=_this2.directionsRequired[direction];direction=parseInt(direction,10);if(required===0){return;}_this2.useThrusters(direction,required);});return this.isPaid();}},{key:"useThrusters",value:function useThrusters(direction,required){var assigned=0;while(true){var thrusters=this.getAllUsableThrusters(direction);if(assigned===required){return;}if(thrusters.length===0){return;}var thruster=thrusters.pop();thruster.channel(1);this.directionsRequired[direction]-=1;assigned+=1;}}},{key:"buildRequiredThrust",value:function buildRequiredThrust(movement){var _this3=this;movement.forEach(function(move){return move.setRequiredThrust(new movement_RequiredThrust(_this3.ship,move));});}},{key:"getMoves",value:function getMoves(){var _this4=this;[0,1,2,3,4,5,6,7,8].forEach(function(direction){_this4.thrusters.forEach(function(thruster){if(!thruster.isDirection(direction)){return;}var free=thruster.channeled-thruster.assigned;if(free===0){return;}_this4.movement.forEach(function(move){var required=move.requiredThrust.getRequirement(direction);if(required===0){return;}if(required>free){move.requiredThrust.fulfill(direction,free,thruster.thruster);thruster.addAssigned(free);free=0;}else{move.requiredThrust.fulfill(direction,required,thruster.thruster);thruster.addAssigned(required);free-=required;}});});});if(!this.movement.every(function(move){return move.requiredThrust.isFulfilled();})){throw new Error("Not all moves are fulfilled");}return this.movement;}}]);return ThrustBill;}();/* harmony default export */ var movement_ThrustBill = (ThrustBill_ThrustBill);
// CONCATENATED MODULE: ./src/model/movement/ThrustAssignment.mjs
var ThrustAssignment_ThrustAssignment=/*#__PURE__*/function(){function ThrustAssignment(thruster){Object(classCallCheck["a" /* default */])(this,ThrustAssignment);this.thruster=thruster;this.directions=[].concat(thruster.callHandler("getThrustDirection"));this.paid=0;this.channeled=0;this.capacity=thruster.callHandler("getThrustOutput",null,0);this.assigned=0;}Object(createClass["a" /* default */])(ThrustAssignment,[{key:"addAssigned",value:function addAssigned(amount){this.assigned+=amount;}},{key:"getOverheat",value:function getOverheat(){var oldChannel=this.thruster.callHandler("getChanneledThrust",null,0);this.thruster.callHandler("setChanneledThrust",this.channeled);var payload=this.thruster.heat.predictHeatChange();this.thruster.callHandler("setChanneledThrust",oldChannel);return payload;}},{key:"getFuelRequirement",value:function getFuelRequirement(){return this.thruster.callHandler("getFuelRequirement",this.channeled,0);}},{key:"getNextThrustFuelCost",value:function getNextThrustFuelCost(){return this.thruster.callHandler("getFuelRequirement",this.channeled+1,0)-this.thruster.callHandler("getFuelRequirement",this.channeled,0);}},{key:"isDirection",value:function isDirection(direction){return this.directions.includes(direction);}},{key:"canChannel",value:function canChannel(){return this.channeled<this.capacity;}},{key:"getThrustCapacity",value:function getThrustCapacity(){var capacity=this.capacity-this.channeled;if(capacity<0){return 0;}return capacity;}},{key:"channel",value:function channel(amount){this.channeled+=amount;}},{key:"undoChannel",value:function undoChannel(amount){if(this.channeled-amount<0){throw new Error("Can not undo channel more than channeled");}this.channeled=this.channeled-amount;}}]);return ThrustAssignment;}();/* harmony default export */ var movement_ThrustAssignment = (ThrustAssignment_ThrustAssignment);
// CONCATENATED MODULE: ./src/model/movement/index.mjs

// CONCATENATED MODULE: ./src/model/movement/MovementService.mjs
var MovementService_MovementService=/*#__PURE__*/function(){function MovementService(){Object(classCallCheck["a" /* default */])(this,MovementService);this.gamedata=null;}Object(createClass["a" /* default */])(MovementService,[{key:"update",value:function update(gamedata,phaseDirector){this.gamedata=gamedata;this.phaseDirector=phaseDirector;return this;}},{key:"isMoved",value:function isMoved(ship,turn){var end=this.getLastEndMove(ship);if(!end){return false;}return end.turn===turn;}},{key:"getShipsInSameHex",value:function getShipsInSameHex(ship,hex){var _this=this;hex=hex&&this.getMostRecentMove(ship).position;return this.gamedata.ships.filter(function(ship2){return ship2.isDestroyed()&&ship!==ship2&&_this.getMostRecentMove(ship2).position.equals(hex);});}},{key:"getNewEndMove",value:function getNewEndMove(ship,terrain){var startMove=ship.movement.getLastEndMoveOrSurrogate();var lastMove=ship.movement.getLastMove();var vector=lastMove.getVelocity();var _terrain$getGravityVe=terrain.getGravityVectorForTurn(startMove.position,vector),position=_terrain$getGravityVe.position,velocity=_terrain$getGravityVe.velocity;return new movement_MovementOrder(null,movement_movementTypes.END,position,velocity,lastMove.facing,lastMove.rolled,startMove.turn+1,0).setEvasion(ship.movement.getEvasion());}},{key:"deploy",value:function deploy(ship,pos){var deployMove=ship.movement.getDeployMove();if(!deployMove){var lastMove=ship.movement.getLastMove();deployMove=new movement_MovementOrder(-1,movement_movementTypes.DEPLOY,pos,lastMove.velocity,lastMove.facing,lastMove.rolled,this.gamedata.turn,0,null,1);ship.movement.addMovement(deployMove);}else{deployMove.setPosition(pos);ship.movement.replaceDeployMove(deployMove);}}},{key:"doDeploymentTurn",value:function doDeploymentTurn(ship,step){var deployMove=ship.movement.getDeployMove();var newfacing=addToHexFacing(deployMove.facing,step);deployMove.facing=newfacing;ship.movement.replaceDeployMove(deployMove);this.shipStateChanged(ship);}},{key:"getPositionAtStartOfTurn",value:function getPositionAtStartOfTurn(ship,currentTurn){if(currentTurn===undefined){currentTurn=this.gamedata.turn;}var move=null;for(var i=ship.movement.length-1;i>=0;i--){move=ship.movement[i];if(move.turn<currentTurn){break;}}return new hexagon.Offset(move.position);}},{key:"shipStateChanged",value:function shipStateChanged(ship){this.phaseDirector.relayEvent("shipStateChanged",ship);}},{key:"canThrust",value:function canThrust(ship,direction){return new movement_MovementResolver(ship,this,this.gamedata.turn).canThrust(direction);}},{key:"thrust",value:function thrust(ship,direction){new movement_MovementResolver(ship,this,this.gamedata.turn).thrust(direction);}},{key:"canCancel",value:function canCancel(ship){return new movement_MovementResolver(ship,this,this.gamedata.turn).canCancel();}},{key:"canRevert",value:function canRevert(ship){return new movement_MovementResolver(ship,this,this.gamedata.turn).canRevert();}},{key:"cancel",value:function cancel(ship){new movement_MovementResolver(ship,this,this.gamedata.turn).cancel();}},{key:"revert",value:function revert(ship){new movement_MovementResolver(ship,this,this.gamedata.turn).revert();}},{key:"canPivot",value:function canPivot(ship,turnDirection){if(turnDirection!==1&&turnDirection!==-1){throw new Error("While pivoting direction must be 1 or -1");}return new movement_MovementResolver(ship,this,this.gamedata.turn).canPivot(turnDirection);}},{key:"pivot",value:function pivot(ship,turnDirection){if(turnDirection!==1&&turnDirection!==-1){throw new Error("While pivoting direction must be 1 or -1");}return new movement_MovementResolver(ship,this,this.gamedata.turn).pivot(turnDirection);}},{key:"canRoll",value:function canRoll(ship){return new movement_MovementResolver(ship,this,this.gamedata.turn).canRoll();}},{key:"roll",value:function roll(ship){return new movement_MovementResolver(ship,this,this.gamedata.turn).roll();}},{key:"canEvade",value:function canEvade(ship,step){if(step!==1&&step!==-1){throw new Error("While evading step must be 1 or -1");}if(ship.movement.getEvasion()+step>ship.movement.getMaxEvasion()){return false;}return new movement_MovementResolver(ship,this,this.gamedata.turn).canEvade(step);}},{key:"evade",value:function evade(ship,step){if(step!==1&&step!==-1){throw new Error("While evading step must be 1 or -1");}return new movement_MovementResolver(ship,this,this.gamedata.turn).evade(step);}}]);return MovementService;}();/* harmony default export */ var movement_MovementService = (MovementService_MovementService);
// CONCATENATED MODULE: ./src/model/unit/ShipPower.mjs
var ShipPower_ShipPower=/*#__PURE__*/function(){function ShipPower(shipSystems){Object(classCallCheck["a" /* default */])(this,ShipPower);this.shipSystems=shipSystems;}Object(createClass["a" /* default */])(ShipPower,[{key:"getPowerOutput",value:function getPowerOutput(){return this.shipSystems.getSystems().reduce(function(acc,system){return acc+system.power.getPowerOutput();},0);}},{key:"getPowerRequired",value:function getPowerRequired(){return this.shipSystems.getSystems().filter(function(system){return!system.power.isOffline();}).reduce(function(acc,system){return acc+system.power.getPowerRequirement();},0);}},{key:"getRemainingPowerOutput",value:function getRemainingPowerOutput(){return this.getPowerOutput()-this.getPowerRequired();}},{key:"isValidPower",value:function isValidPower(){return this.getRemainingPowerOutput()>=0||this.getPowerRequired()===0;}},{key:"canSetOffline",value:function canSetOffline(system){return system.power.canSetOffline();}},{key:"canSetOnline",value:function canSetOnline(system){if(!system.power.canSetOnline()){return false;}return this.getRemainingPowerOutput()>=system.power.getPowerRequirement();}},{key:"copyPower",value:function copyPower(ship){this.shipSystems.getSystems().forEach(function(system){var otherSystem=ship.systems.getSystemById(system.id);if(otherSystem.power.isGoingOffline()&&system.power.isOnline()){system.power.setOffline();}if(otherSystem.power.isGoingOnline()&&system.power.isOffline()){system.power.setOnline();}});}},{key:"forceValidPower",value:function forceValidPower(){var _this=this;var systems=shuffleArray(this.shipSystems.getSystems());systems.forEach(function(system){if(_this.canSetOffline(system)&&!_this.isValidPower()){system.power.setOffline();}});}},{key:"advanceTurn",value:function advanceTurn(turn){}}]);return ShipPower;}();/* harmony default export */ var unit_ShipPower = (ShipPower_ShipPower);
// EXTERNAL MODULE: ./node_modules/uuid/v4.js
var v4 = __webpack_require__(28);

// CONCATENATED MODULE: ./src/model/unit/system/DamageEntry.mjs
var DamageEntry_DamageEntry=/*#__PURE__*/function(){function DamageEntry(){var amount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var armor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;Object(classCallCheck["a" /* default */])(this,DamageEntry);if(!Number.isInteger(amount)||Number.isNaN(amount)||!Number.isInteger(armor)||Number.isNaN(armor)){throw new Error("Trying to construct damageEntry with invalid damage or armor ".concat(amount,", ").concat(armor));}this.amount=amount;if(this.amount<0){this.amount=0;}this.armor=armor;this.id=v4();this.destroyedSystem=false;this.system=null;this.new=true;}Object(createClass["a" /* default */])(DamageEntry,[{key:"isNew",value:function isNew(){return this.new;}},{key:"setSystem",value:function setSystem(system){this.system=system;}},{key:"setDestroyedSystem",value:function setDestroyedSystem(){this.destroyedSystem=true;}},{key:"serialize",value:function serialize(){return{amount:this.amount,armor:this.armor,id:this.id,destroyedSystem:this.destroyedSystem};}},{key:"deserialize",value:function deserialize(data){this.id=data.id||v4();this.amount=data.amount||0;this.armor=data.armor||0;this.destroyedSystem=data.destroyedSystem||false;this.new=false;if(!Number.isInteger(this.amount)||Number.isNaN(this.amount)||!Number.isInteger(this.armor)||Number.isNaN(this.armor)){throw new Error("Trying to deserialize damageEntry with invalid damage or armor ".concat(this.amount,", ").concat(this.armor));}return this;}},{key:"getDamage",value:function getDamage(){return this.amount;}},{key:"advanceTurn",value:function advanceTurn(){return this;}}]);return DamageEntry;}();/* harmony default export */ var system_DamageEntry = (DamageEntry_DamageEntry);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get.js + 1 modules
var get = __webpack_require__(10);

// CONCATENATED MODULE: ./src/model/unit/system/criticals/Critical.mjs
var Critical_Critical=/*#__PURE__*/function(){function Critical(){var duration=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;Object(classCallCheck["a" /* default */])(this,Critical);this.id=v4();this.duration=Number.isInteger(duration)?duration+1:null;this.turnsRemaining=this.duration;}Object(createClass["a" /* default */])(Critical,[{key:"getMessage",value:function getMessage(){return"";}},{key:"serialize",value:function serialize(){return{className:this.getClassName(),id:this.id,duration:this.duration,turnsRemaining:this.turnsRemaining};}},{key:"deserialize",value:function deserialize(data){this.id=data.id||null;this.turnsRemaining=data.turnsRemaining||null;this.duration=data.duration||null;return this;}},{key:"advanceTurn",value:function advanceTurn(){if(this.turnsRemaining!==null&&this.turnsRemaining>0){this.turnsRemaining--;}}},{key:"excludes",value:function excludes(critical){return false;}},{key:"isReplacedBy",value:function isReplacedBy(critical){return false;}},{key:"isFixed",value:function isFixed(){return this.turnsRemaining===0;}},{key:"getDuration",value:function getDuration(){return this.duration;}},{key:"getClassName",value:function getClassName(){return this.constructor.name;}}]);return Critical;}();/* harmony default export */ var criticals_Critical = (Critical_Critical);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/OutputReduced.mjs
var OutputReduced_OutputReduced=/*#__PURE__*/function(_Critical){Object(inherits["a" /* default */])(OutputReduced,_Critical);function OutputReduced(outputReduction,duration){var _this;Object(classCallCheck["a" /* default */])(this,OutputReduced);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OutputReduced).call(this,duration));_this.outputReduction=outputReduction;return _this;}Object(createClass["a" /* default */])(OutputReduced,[{key:"serialize",value:function serialize(){return Object(objectSpread2["a" /* default */])({},Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(OutputReduced.prototype),"serialize",this).call(this),{outputReduction:this.outputReduction});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(OutputReduced.prototype),"deserialize",this).call(this,data);this.outputReduction=data.outputReduction||1;return this;}},{key:"getMessage",value:function getMessage(){if(this.duration){return"Output decreased by ".concat(this.outputReduction," for ").concat(this.turnsRemaining," turns");}return"Output decreased by ".concat(this.outputReduction);}},{key:"getOutputReduction",value:function getOutputReduction(){return this.outputReduction;}},{key:"excludes",value:function excludes(critical){if(!(critical instanceof OutputReduced)){return false;}if(critical.outputReduction!==this.outputReduction){return false;}if(critical.getDuration()!==null&&this.getDuration()!==null){return critical.getDuration()<=this.turnsRemaining;}return false;}},{key:"isReplacedBy",value:function isReplacedBy(critical){if(!(critical instanceof OutputReduced)){return false;}if(critical.getDuration()!==null&&this.getDuration()!==null){if(critical.outputReduction!==this.outputReduction){return false;}return critical.getDuration()>this.turnsRemaining;}return false;}}]);return OutputReduced;}(criticals_Critical);/* harmony default export */ var criticals_OutputReduced = (OutputReduced_OutputReduced);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/OutputReduced2.mjs
var OutputReduced2_OutputReduced2=/*#__PURE__*/function(_OutputReduced){Object(inherits["a" /* default */])(OutputReduced2,_OutputReduced);function OutputReduced2(duration){Object(classCallCheck["a" /* default */])(this,OutputReduced2);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OutputReduced2).call(this,2,duration));}return OutputReduced2;}(criticals_OutputReduced);/* harmony default export */ var criticals_OutputReduced2 = (OutputReduced2_OutputReduced2);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/OutputReduced4.mjs
var OutputReduced4_OutputReduced4=/*#__PURE__*/function(_OutputReduced){Object(inherits["a" /* default */])(OutputReduced4,_OutputReduced);function OutputReduced4(duration){Object(classCallCheck["a" /* default */])(this,OutputReduced4);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OutputReduced4).call(this,4,duration));}return OutputReduced4;}(criticals_OutputReduced);/* harmony default export */ var criticals_OutputReduced4 = (OutputReduced4_OutputReduced4);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/OutputReduced6.mjs
var OutputReduced6_OutputReduced6=/*#__PURE__*/function(_OutputReduced){Object(inherits["a" /* default */])(OutputReduced6,_OutputReduced);function OutputReduced6(duration){Object(classCallCheck["a" /* default */])(this,OutputReduced6);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OutputReduced6).call(this,6,duration));}return OutputReduced6;}(criticals_OutputReduced);/* harmony default export */ var criticals_OutputReduced6 = (OutputReduced6_OutputReduced6);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/OutputReduced8.mjs
var OutputReduced8_OutputReduced8=/*#__PURE__*/function(_OutputReduced){Object(inherits["a" /* default */])(OutputReduced8,_OutputReduced);function OutputReduced8(duration){Object(classCallCheck["a" /* default */])(this,OutputReduced8);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OutputReduced8).call(this,8,duration));}return OutputReduced8;}(criticals_OutputReduced);/* harmony default export */ var criticals_OutputReduced8 = (OutputReduced8_OutputReduced8);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/LoadingTimeIncreased.mjs
var LoadingTimeIncreased_LoadingTimeIncreased=/*#__PURE__*/function(_Critical){Object(inherits["a" /* default */])(LoadingTimeIncreased,_Critical);function LoadingTimeIncreased(duration,loadingTimeIncrease){var _this;Object(classCallCheck["a" /* default */])(this,LoadingTimeIncreased);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(LoadingTimeIncreased).call(this,duration));_this.loadingTimeIncrease=loadingTimeIncrease;return _this;}Object(createClass["a" /* default */])(LoadingTimeIncreased,[{key:"serialize",value:function serialize(){return Object(objectSpread2["a" /* default */])({},Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(LoadingTimeIncreased.prototype),"serialize",this).call(this),{loadingTimeIncrease:this.loadingTimeIncrease});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(LoadingTimeIncreased.prototype),"deserialize",this).call(this,data);this.loadingTimeIncrease=data.loadingTimeIncrease||1;return this;}},{key:"getMessage",value:function getMessage(){if(this.duration){return"Charging time increased by ".concat(this.loadingTimeIncrease," for ").concat(this.turnsRemaining," turns");}return"Charging time increased by ".concat(this.loadingTimeIncrease);}},{key:"getLoadingTimeIncrease",value:function getLoadingTimeIncrease(){return this.loadingTimeIncrease;}},{key:"excludes",value:function excludes(critical){if(!(critical instanceof LoadingTimeIncreased)){return false;}if(critical.loadingTimeIncrease<this.loadingTimeIncrease){return true;}if(critical.loadingTimeIncrease>this.loadingTimeIncrease){return false;}if(critical.getDuration()!==null&&this.getDuration()===null){return true;}return critical.getDuration()<=this.turnsRemaining;}},{key:"isReplacedBy",value:function isReplacedBy(critical){if(!(critical instanceof LoadingTimeIncreased)){return false;}if(critical.loadingTimeIncrease>this.loadingTimeIncrease){return true;}if(critical.getDuration()===null&&this.getDuration()!==null){return true;}return critical.getDuration()>this.turnsRemaining;}}]);return LoadingTimeIncreased;}(criticals_Critical);/* harmony default export */ var criticals_LoadingTimeIncreased = (LoadingTimeIncreased_LoadingTimeIncreased);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/ForcedOffline.mjs
var ForcedOffline_ForcedOffline=/*#__PURE__*/function(_Critical){Object(inherits["a" /* default */])(ForcedOffline,_Critical);function ForcedOffline(){Object(classCallCheck["a" /* default */])(this,ForcedOffline);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ForcedOffline).apply(this,arguments));}Object(createClass["a" /* default */])(ForcedOffline,[{key:"getMessage",value:function getMessage(){return"Forced offline for ".concat(this.turnsRemaining," turns");}},{key:"excludes",value:function excludes(critical){return critical instanceof ForcedOffline&&critical.getDuration()<=this.turnsRemaining;}},{key:"isReplacedBy",value:function isReplacedBy(critical){return critical instanceof ForcedOffline&&critical.getDuration()>this.turnsRemaining;}}]);return ForcedOffline;}(criticals_Critical);/* harmony default export */ var criticals_ForcedOffline = (ForcedOffline_ForcedOffline);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/ForcedOfflineOverheat.mjs
var ForcedOfflineOverheat_ForcedOfflineOverheat=/*#__PURE__*/function(_Critical){Object(inherits["a" /* default */])(ForcedOfflineOverheat,_Critical);function ForcedOfflineOverheat(){Object(classCallCheck["a" /* default */])(this,ForcedOfflineOverheat);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ForcedOfflineOverheat).apply(this,arguments));}Object(createClass["a" /* default */])(ForcedOfflineOverheat,[{key:"getMessage",value:function getMessage(){return"Forced offline until system heat lowers to 0.5 or below";}},{key:"excludes",value:function excludes(critical){return critical instanceof ForcedOfflineOverheat;}},{key:"isFixed",value:function isFixed(system){return system.heat.getOverheatPercentage()<0.5;}}]);return ForcedOfflineOverheat;}(criticals_Critical);/* harmony default export */ var criticals_ForcedOfflineOverheat = (ForcedOfflineOverheat_ForcedOfflineOverheat);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/ThrustChannelHeatIncreased.mjs
var ThrustChannelHeatIncreased_ThrustChannelHeatIncreased=/*#__PURE__*/function(_Critical){Object(inherits["a" /* default */])(ThrustChannelHeatIncreased,_Critical);function ThrustChannelHeatIncreased(){var _this;var heatMultiplier=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0.5;var duration=arguments.length>1?arguments[1]:undefined;Object(classCallCheck["a" /* default */])(this,ThrustChannelHeatIncreased);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ThrustChannelHeatIncreased).call(this,duration));_this.heatMultiplier=heatMultiplier;return _this;}Object(createClass["a" /* default */])(ThrustChannelHeatIncreased,[{key:"serialize",value:function serialize(){return Object(objectSpread2["a" /* default */])({},Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ThrustChannelHeatIncreased.prototype),"serialize",this).call(this),{heatMultiplier:this.heatMultiplier});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ThrustChannelHeatIncreased.prototype),"deserialize",this).call(this,data);this.heatMultiplier=data.heatMultiplier||0.5;return this;}},{key:"getMessage",value:function getMessage(){if(this.duration){return"Heat per thrust increased by ".concat(this.heatMultiplier," for ").concat(this.turnsRemaining," turns");}return"Heat per thrust increased by ".concat(this.heatMultiplier);}},{key:"getHeatIncrease",value:function getHeatIncrease(){return this.heatMultiplier;}},{key:"excludes",value:function excludes(critical){if(!(critical instanceof ThrustChannelHeatIncreased)){return false;}if(critical.heatMultiplier!==this.heatMultiplier){return false;}if(critical.getDuration()!==null&&this.getDuration()!==null){return critical.getDuration()<=this.turnsRemaining;}return false;}},{key:"isReplacedBy",value:function isReplacedBy(critical){if(!(critical instanceof ThrustChannelHeatIncreased)){return false;}if(critical.getDuration()!==null&&this.getDuration()!==null){if(critical.heatMultiplier!==this.heatMultiplier){return false;}return critical.getDuration()>this.turnsRemaining;}return false;}}]);return ThrustChannelHeatIncreased;}(criticals_Critical);/* harmony default export */ var criticals_ThrustChannelHeatIncreased = (ThrustChannelHeatIncreased_ThrustChannelHeatIncreased);
// CONCATENATED MODULE: ./src/model/unit/system/criticals/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/SystemDamage.mjs
var SystemDamage_SystemDamage=/*#__PURE__*/function(){function SystemDamage(system){Object(classCallCheck["a" /* default */])(this,SystemDamage);this.system=system;this.entries=[];this.criticals=[];}Object(createClass["a" /* default */])(SystemDamage,[{key:"serialize",value:function serialize(){return{entries:this.entries.map(function(entry){return entry.serialize();}),criticals:this.criticals.map(function(entry){return entry.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.entries=data.entries?data.entries.map(function(entry){return new system_DamageEntry().deserialize(entry);}):[];this.criticals=data.criticals?data.criticals.map(function(entry){return new criticals_namespaceObject[entry.className]().deserialize(entry);}):[];return this;}},{key:"addDamage",value:function addDamage(damage){this.entries.push(damage);}},{key:"getDamageById",value:function getDamageById(id){var entry=this.entries.find(function(damage){return damage.id===id;});if(entry){entry.setSystem(this.system);}return entry;}},{key:"addCritical",value:function addCritical(critical){this.criticals.push(critical);}},{key:"filterReplaced",value:function filterReplaced(critical){this.criticals=this.criticals.filter(function(old){return!old.isReplacedBy(critical);});}},{key:"hasCritical",value:function hasCritical(object){switch(typeof object){case"object":return this.criticals.some(function(crit){return crit.constructor===object.constructor;});case"function":return this.criticals.some(function(crit){return crit instanceof object;});case"string":return this.criticals.some(function(crit){return crit.constructor.name===object;});}}},{key:"getCriticals",value:function getCriticals(){return this.criticals;}},{key:"hasAnyCritical",value:function hasAnyCritical(){return this.criticals.length>0;}},{key:"getTotalDamage",value:function getTotalDamage(){var damage=this.entries.reduce(function(acc,entry){return acc+entry.getDamage();},0);if(damage>this.system.hitpoints){return this.system.hitpoints;}return damage;}},{key:"getPercentUnDamaged",value:function getPercentUnDamaged(){return 1-this.getTotalDamage()/this.system.hitpoints;}},{key:"getNewDamage",value:function getNewDamage(){return this.entries.filter(function(entry){return entry.new;}).reduce(function(acc,entry){return acc+entry.getDamage();},0);}},{key:"isDestroyed",value:function isDestroyed(){return this.getTotalDamage()>=this.system.hitpoints;}},{key:"advanceTurn",value:function advanceTurn(){var _this=this;this.entries=this.entries.map(function(entry){return entry.advanceTurn();}).filter(Boolean);this.criticals.forEach(function(critical){return critical.advanceTurn();});this.criticals=this.criticals.filter(function(critical){return!critical.isFixed(_this.system);});}}]);return SystemDamage;}();/* harmony default export */ var system_SystemDamage = (SystemDamage_SystemDamage);
// CONCATENATED MODULE: ./src/model/unit/system/PowerEntry.mjs
var POWER_TYPE_OFFLINE="offline";var POWER_TYPE_BOOST="boost";var POWER_TYPE_GO_OFFLINE="go-offline";var POWER_TYPE_GO_ONLINE="go-online";var PowerEntry_PowerEntry=/*#__PURE__*/function(){function PowerEntry(powerType){var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;Object(classCallCheck["a" /* default */])(this,PowerEntry);this.type=powerType;this.amount=amount;}Object(createClass["a" /* default */])(PowerEntry,[{key:"isOffline",value:function isOffline(){return this.type===POWER_TYPE_OFFLINE;}},{key:"isGoingOffline",value:function isGoingOffline(){return this.type===POWER_TYPE_GO_OFFLINE;}},{key:"isGoingOnline",value:function isGoingOnline(){return this.type===POWER_TYPE_GO_ONLINE;}},{key:"isBoost",value:function isBoost(){return this.type===POWER_TYPE_BOOST;}},{key:"getAmount",value:function getAmount(){return this.amount;}},{key:"setAmount",value:function setAmount(amount){this.amount=amount;}},{key:"serialize",value:function serialize(){return{type:this.type,amount:this.amount};}},{key:"deserialize",value:function deserialize(data){this.type=data.type;this.amount=data.amount||0;return this;}}]);return PowerEntry;}();/* harmony default export */ var system_PowerEntry = (PowerEntry_PowerEntry);
// CONCATENATED MODULE: ./src/model/unit/system/SystemPower.mjs
var SystemPower_SystemPower=/*#__PURE__*/function(){function SystemPower(system){Object(classCallCheck["a" /* default */])(this,SystemPower);this.system=system;this.entries=[];}Object(createClass["a" /* default */])(SystemPower,[{key:"serialize",value:function serialize(){return{entries:this.entries.map(function(entry){return entry.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.entries=data.entries?data.entries.map(function(entry){return new system_PowerEntry().deserialize(entry);}):[];return this;}},{key:"isOffline",value:function isOffline(){if(this.system.isDestroyed()){return false;}return(this.entries.some(function(entry){return entry.isOffline();})||this.isGoingOffline())&&!this.isGoingOnline();}},{key:"isOnline",value:function isOnline(){return!this.isOffline();}},{key:"isGoingOnline",value:function isGoingOnline(){return this.entries.some(function(entry){return entry.isGoingOnline();});}},{key:"isGoingOffline",value:function isGoingOffline(){return this.entries.some(function(entry){return entry.isGoingOffline();});}},{key:"forceOffline",value:function forceOffline(){if(this.isOffline()||!this.canSetOffline()){return;}this.entries=this.entries.filter(function(entry){return entry.type!==POWER_TYPE_GO_ONLINE;});this.entries.push(new system_PowerEntry(POWER_TYPE_GO_OFFLINE));}},{key:"setOffline",value:function setOffline(){this.forceOffline();this.system.callHandler("onSystemOffline");}},{key:"canSetOffline",value:function canSetOffline(){return!this.isOffline()&&this.system.callHandler("canSetOffline",null,false);}},{key:"canSetOnline",value:function canSetOnline(){if(this.system.callHandler("shouldBeOffline",null,false)){return false;}return this.isOffline()&&this.system.callHandler("canSetOnline",null,false);}},{key:"setOnline",value:function setOnline(){if(!this.isOffline()){return;}this.entries=this.entries.filter(function(entry){return entry.type!==POWER_TYPE_GO_OFFLINE;});this.entries.push(new system_PowerEntry(POWER_TYPE_GO_ONLINE));this.system.callHandler("onSystemOnline");}},{key:"getPowerOutput",value:function getPowerOutput(){return this.system.callHandler("getPowerOutput",null,0);}},{key:"getPowerRequirement",value:function getPowerRequirement(){return this.system.callHandler("getPowerRequirement",null,0);}},{key:"advanceTurn",value:function advanceTurn(){if(this.isOffline()){this.entries=[new system_PowerEntry(POWER_TYPE_OFFLINE)];}else{this.entries=[];}}}]);return SystemPower;}();/* harmony default export */ var system_SystemPower = (SystemPower_SystemPower);
// CONCATENATED MODULE: ./src/model/unit/system/SystemHeat.mjs
var SystemHeat_SystemHeat=/*#__PURE__*/function(){function SystemHeat(system){Object(classCallCheck["a" /* default */])(this,SystemHeat);this.system=system;this.heat=0;this.overheat=0;this.heatTransferPerStructure=0.5;this.overheatLimitPerStructure=1;this.overheatTransferRatio=0.5;this.heatTransferred=0;}Object(createClass["a" /* default */])(SystemHeat,[{key:"serialize",value:function serialize(){return{heat:this.heat,overheat:this.overheat};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.heat=data.heat||0;this.overheat=data.overheat||0;return this;}},{key:"getHeatTransferPerStructure",value:function getHeatTransferPerStructure(){return this.system.callHandler("getHeatTransferPerStructure",null,0)+this.heatTransferPerStructure;}},{key:"getHeat",value:function getHeat(){return this.heat;}},{key:"getMaxTransferHeat",value:function getMaxTransferHeat(){if(this.isHeatStorage()){return 0;}return this.system.hitpoints*this.getHeatTransferPerStructure();}},{key:"getOverheatTransferRatio",value:function getOverheatTransferRatio(){return this.system.callHandler("getOverheatTransferRatio",null,0)||this.overheatTransferRatio;}},{key:"getTransferOverHeat",value:function getTransferOverHeat(){var ratio=this.getOverheatTransferRatio();var overheat=this.overheat>0?this.overheat:0;var withRatio=overheat*ratio;if(withRatio<ratio){if(ratio>overheat){return overheat;}return ratio;}return withRatio;}},{key:"getTransferHeat",value:function getTransferHeat(){var max=this.getMaxTransferHeat()-this.heatTransferred;if(max<=0){return 0;}if(max>this.heat){var overheatTransfer=max-this.heat;if(overheatTransfer>this.getTransferOverHeat()){overheatTransfer=this.getTransferOverHeat();}return this.heat+overheatTransfer;}return max;}},{key:"getHeatGenerated",value:function getHeatGenerated(){return this.system.callHandler("getHeatGenerated",null,0);}},{key:"getHeatPerStructure",value:function getHeatPerStructure(){return this.getHeat()/this.system.hitpoints;}},{key:"shouldDisplayHeat",value:function shouldDisplayHeat(){return this.system.callHandler("generatesHeat",null,false)||this.isHeatStorage();}},{key:"predictHeatChange",value:function predictHeatChange(){if(this.isHeatStorage()||this.system.isDestroyed()){return{overheat:0,newHeat:0,overheatPercentage:0,cooling:0,overHeatThreshold:0,maximumPossibleOverheatReduction:0};}var newHeat=this.getHeatGenerated();var heat=this.heat+newHeat;var cooling=this.getMaxTransferHeat();var finalHeat=heat>=cooling?heat-cooling:0;var heatCooling=cooling>heat?heat:cooling;var maxOverheatCooling=heatCooling<cooling?cooling-heatCooling:0;var overheatCooling=maxOverheatCooling>this.overheat*this.getOverheatTransferRatio()?this.overheat*this.getOverheatTransferRatio():maxOverheatCooling;var cumulatedOverheat=this.overheat+finalHeat;var actualOverheatCooling=overheatCooling<=cumulatedOverheat?overheatCooling:cumulatedOverheat;var overheat=cumulatedOverheat-actualOverheatCooling;var maximumPossibleOverheatReduction=this.getOverheatTransferRatio();return{overheat:overheat,newHeat:newHeat,overheatPercentage:overheat/this.getOverheatTreshold(),cooling:heatCooling+actualOverheatCooling,maxCooling:this.getMaxTransferHeat(),coolingPercent:(heatCooling+actualOverheatCooling)/cooling,overHeatThreshold:this.getOverheatTreshold(),maximumPossibleOverheatReduction:maximumPossibleOverheatReduction};}},{key:"generateHeat",value:function generateHeat(){var newHeat=this.getHeatGenerated();this.heat+=newHeat;return newHeat;}},{key:"isHeatStorage",value:function isHeatStorage(){return this.system.callHandler("canStoreHeat",null,false);}},{key:"getMaxHeatStoreCapacity",value:function getMaxHeatStoreCapacity(){return this.system.callHandler("getHeatStoreAmount",null,0);}},{key:"getHeatStoreCapacity",value:function getHeatStoreCapacity(){var capacity=this.getMaxHeatStoreCapacity()-this.heat;if(capacity<=0){return 0;}return capacity;}},{key:"changeHeat",value:function changeHeat(change){if(change<0){if(change>this.heat){this.overheat+=change+this.heat;this.heat=0;}else{this.heat+=change;}this.heatTransferred+=Math.abs(change);}else{this.heat+=change;}return this;}},{key:"markNewOverheat",value:function markNewOverheat(){if(this.isHeatStorage()){return;}this.overheat+=this.heat;this.heat=0;}},{key:"getOverheat",value:function getOverheat(){if(this.isHeatStorage()){return 0;}return this.overheat;}},{key:"getOverheatTreshold",value:function getOverheatTreshold(){return this.system.hitpoints*this.overheatLimitPerStructure;}},{key:"getOverheatPercentage",value:function getOverheatPercentage(){var extra=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(this.isHeatStorage()){return 0;}return(this.overheat+extra)/this.getOverheatTreshold();}},{key:"getRadiateHeatCapacity",value:function getRadiateHeatCapacity(){return this.system.callHandler("getHeatRadiationCapacity",null,0);}},{key:"radiateHeat",value:function radiateHeat(heat){return this.system.callHandler("radiateHeat",heat);}},{key:"advanceTurn",value:function advanceTurn(){this.heatTransferred=0;}}]);return SystemHeat;}();/* harmony default export */ var system_SystemHeat = (SystemHeat_SystemHeat);
// CONCATENATED MODULE: ./src/model/unit/system/ShipSystemLog/ShipSystemLogEntry.mjs
var ShipSystemLogEntry_ShipSystemLogEntry=/*#__PURE__*/function(){function ShipSystemLogEntry(system){Object(classCallCheck["a" /* default */])(this,ShipSystemLogEntry);this.system=system;this.turn=null;this.messages=[];}Object(createClass["a" /* default */])(ShipSystemLogEntry,[{key:"setTurn",value:function setTurn(turn){this.turn=turn;}},{key:"addMessage",value:function addMessage(message){this.messages.push(message);}},{key:"getMessage",value:function getMessage(){return this.messages;}},{key:"isOpen",value:function isOpen(){return this.turn===null;}},{key:"isTurn",value:function isTurn(turn){return this.turn===turn;}},{key:"serialize",value:function serialize(){return{className:this.constructor.name,messages:this.messages,turn:this.turn};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.turn=data.turn||null;this.messages=data.messages||[];return this;}}]);return ShipSystemLogEntry;}();/* harmony default export */ var ShipSystemLog_ShipSystemLogEntry = (ShipSystemLogEntry_ShipSystemLogEntry);
// CONCATENATED MODULE: ./src/model/utils/format.mjs
var formatNumber=function formatNumber(number){if(number*10%1>0){return number.toFixed(2);}if(number%1>0){return number.toFixed(1);}return number;};
// CONCATENATED MODULE: ./src/model/unit/system/ShipSystemLog/ShipSystemLogEntryHeat.mjs
var ShipSystemLogEntryHeat_ShipSystemLogEntryHeat=/*#__PURE__*/function(_ShipSystemLogEntry){Object(inherits["a" /* default */])(ShipSystemLogEntryHeat,_ShipSystemLogEntry);function ShipSystemLogEntryHeat(system){var _this;Object(classCallCheck["a" /* default */])(this,ShipSystemLogEntryHeat);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryHeat).call(this,system));_this.initialOverheat=0;_this.initialOverheatPercentage=0;_this.heatGenerated=0;_this.heatCooled=0;_this.heatRadiated=0;_this.overheat=0;_this.overheatPercentage=0;_this.isForcedOffline=0;_this.intialHeatStored=0;_this.newHeatStored=0;_this.heatGivenToRadiators=0;return _this;}Object(createClass["a" /* default */])(ShipSystemLogEntryHeat,[{key:"setIntialHeatStored",value:function setIntialHeatStored(heat){this.intialHeatStored=heat;}},{key:"addNewHeatStored",value:function addNewHeatStored(amount){this.newHeatStored+=amount;}},{key:"addHeatGivenToRadiators",value:function addHeatGivenToRadiators(amount){this.heatGivenToRadiators+=amount;}},{key:"setInitialOverheat",value:function setInitialOverheat(heat,percentage){this.initialOverheat=heat;this.initialOverheatPercentage=percentage;}},{key:"setHeatGenerated",value:function setHeatGenerated(heat){this.heatGenerated=heat;}},{key:"setNewOverheat",value:function setNewOverheat(heat,percentage){this.overheat=heat;this.overheatPercentage=percentage;this.heatCooled=this.heatGenerated+this.initialOverheat-this.overheat;}},{key:"setHeatRadiated",value:function setHeatRadiated(heat){this.heatRadiated=heat;}},{key:"setForcedOffline",value:function setForcedOffline(){this.isForcedOffline=true;}},{key:"serialize",value:function serialize(){return Object(objectSpread2["a" /* default */])({},Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryHeat.prototype),"serialize",this).call(this),{initialOverheat:this.initialOverheat,initialOverheatPercentage:this.initialOverheatPercentage,heatGenerated:this.heatGenerated,heatCooled:this.heatCooled,heatRadiated:this.heatRadiated,overheat:this.overheat,overheatPercentage:this.overheatPercentage,isForcedOffline:this.isForcedOffline,intialHeatStored:this.intialHeatStored,newHeatStored:this.newHeatStored,heatGivenToRadiators:this.heatGivenToRadiators});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryHeat.prototype),"deserialize",this).call(this,data);this.initialOverheat=data.initialOverheat||0;this.initialOverheatPercentage=data.initialOverheatPercentage||0;this.heatGenerated=data.heatGenerated||0;this.heatCooled=data.heatCooled||0;this.heatRadiated=data.heatRadiated||0;this.overheat=data.overheat||0;this.overheatPercentage=data.overheatPercentage||0;this.isForcedOffline=data.isForcedOffline||0;this.intialHeatStored=data.intialHeatStored||0;this.newHeatStored=data.newHeatStored||0;this.heatGivenToRadiators=data.heatGivenToRadiators||0;return this;}},{key:"getMessage",value:function getMessage(){var messages=[];var isRadiator=this.system.callHandler("isRadiator",null,false);var isStorage=this.system.heat.isHeatStorage();if(isStorage){messages=[].concat(Object(toConsumableArray["a" /* default */])(messages),Object(toConsumableArray["a" /* default */])(this.getHeatStorageMessage()));}if(isRadiator){messages=[].concat(Object(toConsumableArray["a" /* default */])(messages),Object(toConsumableArray["a" /* default */])(this.getRadiatorMessage()));}if(!isRadiator&&!isStorage){messages=[].concat(Object(toConsumableArray["a" /* default */])(messages),Object(toConsumableArray["a" /* default */])(this.getRegularMessage()));}return messages;}},{key:"getRadiatorMessage",value:function getRadiatorMessage(){if(this.heatRadiated){return["Radiated ".concat(formatNumber(this.heatRadiated)," units of heat.")];}return[];}},{key:"getHeatStorageMessage",value:function getHeatStorageMessage(){var messages=[];if(this.heatGivenToRadiators||this.newHeatStored){messages.push("Added ".concat(formatNumber(this.newHeatStored)," units of heat. Transfered ").concat(formatNumber(this.heatGivenToRadiators)," units of heat to radiators."));}messages.push("Stored ".concat(formatNumber(this.intialHeatStored+this.newHeatStored-this.heatGivenToRadiators)," units of heat."));return messages;}},{key:"getRegularMessage",value:function getRegularMessage(){var messages=[];if(this.heatGenerated||this.heatCooled){messages.push("Added ".concat(formatNumber(this.heatGenerated)," and cooled ").concat(formatNumber(this.heatCooled)," units of heat."));}var heatMessage="Current system heat was ".concat(formatNumber(this.overheat),".");messages.push();if(this.overheat){heatMessage+=" Overheating ".concat(Math.round(this.overheatPercentage*100),"%.");}messages.push(heatMessage);if(this.isForcedOffline){messages.push("System forced offline until overheat is less than 50%.");}return messages;}}]);return ShipSystemLogEntryHeat;}(ShipSystemLog_ShipSystemLogEntry);/* harmony default export */ var ShipSystemLog_ShipSystemLogEntryHeat = (ShipSystemLogEntryHeat_ShipSystemLogEntryHeat);
// CONCATENATED MODULE: ./src/model/unit/system/ShipSystemLog/ShipSystemLogEntryCriticalHit.mjs
var ShipSystemLogEntryCriticalHit_ShipSystemLogEntryCriticalHit=/*#__PURE__*/function(_ShipSystemLogEntry){Object(inherits["a" /* default */])(ShipSystemLogEntryCriticalHit,_ShipSystemLogEntry);function ShipSystemLogEntryCriticalHit(system){var _this;Object(classCallCheck["a" /* default */])(this,ShipSystemLogEntryCriticalHit);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryCriticalHit).call(this,system));_this.newDamagePoints=0;_this.overHeatPoints=0;_this.oldDamagePoints=0;_this.criticalMessage="";_this.extraPoints=0;return _this;}Object(createClass["a" /* default */])(ShipSystemLogEntryCriticalHit,[{key:"setExtraPoints",value:function setExtraPoints(amount){this.extraPoints=amount;}},{key:"setNewDamagePoints",value:function setNewDamagePoints(damage){this.newDamagePoints=damage;}},{key:"setOldDamagePoints",value:function setOldDamagePoints(damage){this.oldDamagePoints=damage;}},{key:"setOverHeatPoints",value:function setOverHeatPoints(amount){this.overHeatPoints+=amount;}},{key:"setCriticalMessage",value:function setCriticalMessage(message){this.criticalMessage=message;}},{key:"serialize",value:function serialize(){return Object(objectSpread2["a" /* default */])({},Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryCriticalHit.prototype),"serialize",this).call(this),{newDamagePoints:this.newDamagePoints,overHeatPoints:this.overHeatPoints,oldDamagePoints:this.oldDamagePoints,criticalMessage:this.criticalMessage,extraPoints:this.extraPoints});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryCriticalHit.prototype),"deserialize",this).call(this,data);this.newDamagePoints=data.newDamagePoints||0;this.overHeatPoints=data.overHeatPoints||0;this.oldDamagePoints=data.oldDamagePoints||0;this.criticalMessage=data.criticalMessage||"";this.extraPoints=data.extraPoints||0;return this;}},{key:"getMessage",value:function getMessage(){var messages=["Tested for critical damage:","Existing damage: ".concat(this.oldDamagePoints,", new: ").concat(this.newDamagePoints,", overheat: ").concat(this.overHeatPoints,", random: ").concat(this.extraPoints,", total: ").concat(this.oldDamagePoints+this.newDamagePoints+this.overHeatPoints+this.extraPoints)];if(this.criticalMessage){messages.push("Resulted in critical:");messages.push("\"".concat(this.criticalMessage,"\""));}return messages;}}]);return ShipSystemLogEntryCriticalHit;}(ShipSystemLog_ShipSystemLogEntry);/* harmony default export */ var ShipSystemLog_ShipSystemLogEntryCriticalHit = (ShipSystemLogEntryCriticalHit_ShipSystemLogEntryCriticalHit);
// CONCATENATED MODULE: ./src/model/unit/system/ShipSystemLog/ShipSystemLogEntryDamage.mjs
var ShipSystemLogEntryDamage_ShipSystemLogEntryDamage=/*#__PURE__*/function(_ShipSystemLogEntry){Object(inherits["a" /* default */])(ShipSystemLogEntryDamage,_ShipSystemLogEntry);function ShipSystemLogEntryDamage(system){var _this;Object(classCallCheck["a" /* default */])(this,ShipSystemLogEntryDamage);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryDamage).call(this,system));_this.damage=0;_this.blockedByArmor=0;_this.wasDestroyed=false;return _this;}Object(createClass["a" /* default */])(ShipSystemLogEntryDamage,[{key:"addDamage",value:function addDamage(damageEntry){this.damage+=damageEntry.amount;this.blockedByArmor+=damageEntry.armor;if(damageEntry.destroyedSystem){this.wasDestroyed=true;}}},{key:"serialize",value:function serialize(){return Object(objectSpread2["a" /* default */])({},Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryDamage.prototype),"serialize",this).call(this),{blockedByArmor:this.blockedByArmor,damage:this.damage,wasDestroyed:this.wasDestroyed});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShipSystemLogEntryDamage.prototype),"deserialize",this).call(this,data);this.blockedByArmor=data.blockedByArmor||0;this.damage=data.damage||0;this.wasDestroyed=data.wasDestroyed||false;return this;}},{key:"getMessage",value:function getMessage(){var messages=["Suffered ".concat(this.damage," points of damge. Armor blocked ").concat(this.addBlockedByArmor," points.")];if(this.wasDestroyed){messages.push("System was destroyed");}return messages;}}]);return ShipSystemLogEntryDamage;}(ShipSystemLog_ShipSystemLogEntry);/* harmony default export */ var ShipSystemLog_ShipSystemLogEntryDamage = (ShipSystemLogEntryDamage_ShipSystemLogEntryDamage);
// CONCATENATED MODULE: ./src/model/unit/system/ShipSystemLog/systemLogEntryClasses.mjs
var systemLogEntryClasses={ShipSystemLogEntry:ShipSystemLog_ShipSystemLogEntry,ShipSystemLogEntryHeat:ShipSystemLog_ShipSystemLogEntryHeat,ShipSystemLogEntryCriticalHit:ShipSystemLog_ShipSystemLogEntryCriticalHit,ShipSystemLogEntryDamage:ShipSystemLog_ShipSystemLogEntryDamage};
// CONCATENATED MODULE: ./src/model/unit/system/ShipSystemLog/ShipSystemLog.mjs
var ShipSystemLog_ShipSystemLog=/*#__PURE__*/function(){function ShipSystemLog(system){Object(classCallCheck["a" /* default */])(this,ShipSystemLog);this.system=system;this.log=[];}Object(createClass["a" /* default */])(ShipSystemLog,[{key:"getGenericLogEntry",value:function getGenericLogEntry(){var entry=new ShipSystemLog_ShipSystemLogEntry();this.log.push(entry);return entry;}},{key:"getOpenLogEntryByClass",value:function getOpenLogEntryByClass(className){var entry=this.log.filter(function(entry){return entry.isOpen();}).find(function(entry){return entry instanceof className;});if(!entry){entry=new className(this.system);this.log.push(entry);}return entry;}},{key:"serialize",value:function serialize(){return{log:this.log.map(function(entry){return entry.serialize();})};}},{key:"getMessagesForTurn",value:function getMessagesForTurn(turn){return this.log.filter(function(entry){return entry.isTurn(turn);}).reduce(function(all,entry){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(entry.getMessage()));},[]);}},{key:"getWithTurns",value:function getWithTurns(){var turns=[];this.log.forEach(function(entry){var turnEntry=turns.find(function(turnEntry){return turnEntry.turn===entry.turn;});if(!turnEntry){turnEntry={turn:entry.turn,messages:[]};turns.push(turnEntry);}turnEntry.messages=[].concat(Object(toConsumableArray["a" /* default */])(turnEntry.messages),Object(toConsumableArray["a" /* default */])(entry.getMessage()));});return turns;}},{key:"deserialize",value:function deserialize(){var _this=this;var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.log=data.log||[];this.log=this.log.map(function(entry){return new systemLogEntryClasses[entry.className](_this.system).deserialize(entry);});return this;}},{key:"endTurn",value:function endTurn(turn){this.log.filter(function(entry){return entry.isOpen();}).forEach(function(entry){return entry.setTurn(turn);});}},{key:"advanceTurn",value:function advanceTurn(turn){}}]);return ShipSystemLog;}();/* harmony default export */ var system_ShipSystemLog_ShipSystemLog = (ShipSystemLog_ShipSystemLog);
// CONCATENATED MODULE: ./src/model/unit/system/ShipSystem.mjs
var ShipSystem_ShipSystem=/*#__PURE__*/function(){function ShipSystem(){var _this=this;var args=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var strategies=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];Object(classCallCheck["a" /* default */])(this,ShipSystem);this.id=args.id;this.hitpoints=args.hitpoints;this.armor=args.armor||0;this.strategies=strategies;if(!this.hitpoints){throw new Error("System must have hitpoints");}this.strategies.forEach(function(strategy){return strategy.init(_this);});this.damage=new system_SystemDamage(this);this.power=new system_SystemPower(this);this.shipSystems=null;this.heat=new system_SystemHeat(this);this.log=new system_ShipSystemLog_ShipSystemLog(this);}Object(createClass["a" /* default */])(ShipSystem,[{key:"getSystemDescription",value:function getSystemDescription(){return"";}},{key:"addStrategy",value:function addStrategy(strategy){this.strategies.push(strategy);strategy.init(this);}},{key:"addShipSystemsReference",value:function addShipSystemsReference(shipSystems){this.shipSystems=shipSystems;}},{key:"getSystemInfo",value:function getSystemInfo(ship){var heatMessages=[];if(this.heat.shouldDisplayHeat()){if(!this.heat.isHeatStorage()){heatMessages.push({sort:"heat",component:"SystemHeatBar",props:{currentOverheat:this.heat.getOverheatPercentage(),prediction:this.heat.predictHeatChange()}});}}return[{sort:"AAA",value:[{header:"Hitpoints",value:"".concat(this.getRemainingHitpoints(),"/").concat(this.hitpoints)},{header:"Armor",value:"".concat(this.getArmor())}]}].concat(heatMessages,Object(toConsumableArray["a" /* default */])(this.callHandler("getMessages",null,[])));}},{key:"getDisplayName",value:function getDisplayName(){return null;}},{key:"getBackgroundImage",value:function getBackgroundImage(){return null;}},{key:"getIconText",value:function getIconText(){return this.callHandler("getIconText",null,"");}},{key:"isDestroyed",value:function isDestroyed(){return this.damage.isDestroyed();}},{key:"isDisabled",value:function isDisabled(){return this.power.isOffline()||this.isDestroyed();}},{key:"getArmor",value:function getArmor(){var armorMod=this.callHandler("getArmorModifier",null,0);return this.armor+armorMod;}},{key:"getRemainingHitpoints",value:function getRemainingHitpoints(){return this.hitpoints-this.getTotalDamage();}},{key:"getTotalDamage",value:function getTotalDamage(){return this.damage.getTotalDamage();}},{key:"addDamage",value:function addDamage(damage){var shipWasDestroyed=this.shipSystems?this.shipSystems.isDestroyed():undefined;var systemWasDestroyed=this.isDestroyed();this.damage.addDamage(damage);if(!systemWasDestroyed&&this.isDestroyed()){damage.setDestroyedSystem();}var logEntry=this.log.getOpenLogEntryByClass(ShipSystemLog_ShipSystemLogEntryDamage);logEntry.addDamage(damage);if(this.shipSystems&&shipWasDestroyed===false&&this.shipSystems.isDestroyed()){this.shipSystems.markDestroyedThisTurn();}}},{key:"addCritical",value:function addCritical(critical){this.damage.addCritical(critical);}},{key:"hasAnyCritical",value:function hasAnyCritical(){return this.damage.hasAnyCritical();}},{key:"hasCritical",value:function hasCritical(name){return this.damage.hasCritical(name);}},{key:"callHandler",value:function callHandler(name){var payload=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var response=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;this.strategies.forEach(function(strategy){response=strategy.callHandler(name,payload,response);});return response;}},{key:"getStrategiesByInstance",value:function getStrategiesByInstance(instance){return this.strategies.filter(function(strategy){return strategy instanceof instance;});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.damage.deserialize(data.damage);this.power.deserialize(data.power);this.heat.deserialize(data.heat);this.log.deserialize(data.log);this.callHandler("deserialize",data);return this;}},{key:"serialize",value:function serialize(){return Object(objectSpread2["a" /* default */])({damage:this.damage.serialize(),power:this.power.serialize(),heat:this.heat.serialize(),log:this.log.serialize()},this.callHandler("serialize"));}},{key:"endTurn",value:function endTurn(turn){this.log.endTurn(turn);}},{key:"advanceTurn",value:function advanceTurn(turn){this.damage.advanceTurn(turn);this.power.advanceTurn(turn);this.heat.advanceTurn(turn);this.log.advanceTurn(turn);this.callHandler("advanceTurn",turn);}},{key:"isWeapon",value:function isWeapon(){return false;}},{key:"showOnSystemList",value:function showOnSystemList(){return false;}}]);return ShipSystem;}();/* harmony default export */ var system_ShipSystem = (ShipSystem_ShipSystem);
// EXTERNAL MODULE: ./node_modules/rpg-dice-roller/lib/umd/bundle.js
var bundle = __webpack_require__(145);

// CONCATENATED MODULE: ./src/model/unit/system/strategy/ShipSystemStrategy.mjs
var ShipSystemStrategy_ShipSystemStrategy=/*#__PURE__*/function(){function ShipSystemStrategy(){Object(classCallCheck["a" /* default */])(this,ShipSystemStrategy);this.system=null;this.diceRoller=new bundle.DiceRoller();}Object(createClass["a" /* default */])(ShipSystemStrategy,[{key:"init",value:function init(system){this.system=system;}},{key:"hasHandler",value:function hasHandler(name){return Boolean(this[name]);}},{key:"callHandler",value:function callHandler(name){var payload=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var previousResponse=arguments.length>2?arguments[2]:undefined;if(!this.hasHandler(name)){return previousResponse;}return this[name](payload,previousResponse);}}]);return ShipSystemStrategy;}();/* harmony default export */ var strategy_ShipSystemStrategy = (ShipSystemStrategy_ShipSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/cargo/CargoEntity.mjs
var CargoEntity_CargoEntity=/*#__PURE__*/function(){function CargoEntity(){Object(classCallCheck["a" /* default */])(this,CargoEntity);}Object(createClass["a" /* default */])(CargoEntity,[{key:"getSpaceRequired",value:function getSpaceRequired(){return 0.1;}},{key:"getCargoInfo",value:function getCargoInfo(){return[];}},{key:"getDisplayName",value:function getDisplayName(){return"";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"";}}]);return CargoEntity;}();/* harmony default export */ var cargo_CargoEntity = (CargoEntity_CargoEntity);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo.mjs
var Torpedo_Torpedo=/*#__PURE__*/function(_CargoEntity){Object(inherits["a" /* default */])(Torpedo,_CargoEntity);function Torpedo(_ref){var _this;var _ref$minRange=_ref.minRange,minRange=_ref$minRange===void 0?100:_ref$minRange,_ref$maxRange=_ref.maxRange,maxRange=_ref$maxRange===void 0?300:_ref$maxRange,_ref$hitSize=_ref.hitSize,hitSize=_ref$hitSize===void 0?0:_ref$hitSize,_ref$evasion=_ref.evasion,evasion=_ref$evasion===void 0?30:_ref$evasion;Object(classCallCheck["a" /* default */])(this,Torpedo);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo).call(this));_this.minRange=minRange;_this.maxRange=maxRange;_this.hitSize=hitSize;_this.evasion=evasion;_this.damageStrategy=null;_this.visuals={engineColor:[51/255,163/255,255/255],explosionType:"HE",explosionSize:15};return _this;}Object(createClass["a" /* default */])(Torpedo,[{key:"getStrikeDistance",value:function getStrikeDistance(flight,target){return 1;}},{key:"getHitSize",value:function getHitSize(){return this.hitSize;}},{key:"getEvasion",value:function getEvasion(){return this.evasion;}},{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Torpedo.prototype),"getCargoInfo",this).call(this);return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{header:"Range",value:"".concat(this.minRange," \u2013 ").concat(this.maxRange," hexes")},{header:"Evasion",value:"+".concat(this.evasion*10,"% range penalty")}],Object(toConsumableArray["a" /* default */])(this.damageStrategy.getMessages()));}}]);return Torpedo;}(cargo_CargoEntity);/* harmony default export */ var torpedo_Torpedo = (Torpedo_Torpedo);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo158.mjs
var Torpedo158_Torpedo158=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo158,_Torpedo);function Torpedo158(_ref){var _ref$minRange=_ref.minRange,minRange=_ref$minRange===void 0?MEDIUM_WEAPON_RANGE*2:_ref$minRange,_ref$maxRange=_ref.maxRange,maxRange=_ref$maxRange===void 0?Math.round(MEDIUM_WEAPON_RANGE*4.5):_ref$maxRange,_ref$hitSize=_ref.hitSize,hitSize=_ref$hitSize===void 0?0:_ref$hitSize,_ref$evasion=_ref.evasion,evasion=_ref$evasion===void 0?30:_ref$evasion;Object(classCallCheck["a" /* default */])(this,Torpedo158);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo158).call(this,{minRange:minRange,maxRange:maxRange,hitSize:hitSize,evasion:evasion}));}return Torpedo158;}(torpedo_Torpedo);/* harmony default export */ var torpedo_Torpedo158 = (Torpedo158_Torpedo158);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js
var objectDestructuringEmpty = __webpack_require__(146);

// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/utils/HitSystemRandomizer.mjs
var HitSystemRandomizer_HitSystemRandomizer=/*#__PURE__*/function(){function HitSystemRandomizer(){Object(classCallCheck["a" /* default */])(this,HitSystemRandomizer);}Object(createClass["a" /* default */])(HitSystemRandomizer,[{key:"rollForSystem",value:function rollForSystem(totalStructure){return Math.ceil(Math.random()*totalStructure);}},{key:"randomizeHitSystem",value:function randomizeHitSystem(systems){var _this=this;if(systems.length===0){return null;}var totalStructure=systems.reduce(function(total,system){return total+_this.getSystemHitSize(system);},0);var roll=this.rollForSystem(totalStructure);var tested=0;return systems.find(function(system){if(roll>tested&&roll<=_this.getSystemHitSize(system)+tested){return true;}tested+=_this.getSystemHitSize(system);return false;});}},{key:"getSystemHitSize",value:function getSystemHitSize(system){return system.hitpoints*system.callHandler("getHitSystemSizeMultiplier",null,1);}}]);return HitSystemRandomizer;}();/* harmony default export */ var utils_HitSystemRandomizer = (HitSystemRandomizer_HitSystemRandomizer);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogDamageEntry.mjs
var CombatLogDamageEntry_CombatLogDamageEntry=/*#__PURE__*/function(){function CombatLogDamageEntry(){Object(classCallCheck["a" /* default */])(this,CombatLogDamageEntry);this.entries=[];this.notes=[];}Object(createClass["a" /* default */])(CombatLogDamageEntry,[{key:"addNote",value:function addNote(note){this.notes.push(note);}},{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,entries:this.entries,notes:this.notes};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.entries=data.entries||[];this.notes=data.notes||[];return this;}},{key:"add",value:function add(system,damage){this.entries.push({systemId:system.id,damageIds:[].concat(damage).map(function(d){return d.id;})});}},{key:"getDamages",value:function getDamages(target){return this.entries.reduce(function(total,_ref){var systemId=_ref.systemId,damageIds=_ref.damageIds;var system=target.systems.getSystemById(systemId);return total.concat(damageIds.map(function(damageId){return system.damage.getDamageById(damageId);}));},[]);}}]);return CombatLogDamageEntry;}();/* harmony default export */ var combatLog_CombatLogDamageEntry = (CombatLogDamageEntry_CombatLogDamageEntry);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/StandardDamageStrategy.mjs
var StandardDamageStrategy_StandardDamageStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(StandardDamageStrategy,_ShipSystemStrategy);function StandardDamageStrategy(){var _this;var damageFormula=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var armorPiercingFormula=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;Object(classCallCheck["a" /* default */])(this,StandardDamageStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StandardDamageStrategy).call(this));_this.damageFormula=damageFormula;_this.armorPiercingFormula=armorPiercingFormula;_this.hitSystemRandomizer=new utils_HitSystemRandomizer();return _this;}Object(createClass["a" /* default */])(StandardDamageStrategy,[{key:"getTotalBurstSize",value:function getTotalBurstSize(){return 1;}},{key:"_getDamageMessage",value:function _getDamageMessage(){var messages=[];if(this.damageFormula){messages.push(this.damageFormula);}var ammo=this.system.callHandler("getSelectedAmmo",null,null);if(ammo){messages.push(ammo.damageFormula);}return messages.join(" + ammo: ");}},{key:"_getArmorPiercingMessage",value:function _getArmorPiercingMessage(){var messages=[];if(this.armorPiercingFormula){messages.push(this.armorPiercingFormula);}var ammo=this.system.callHandler("getSelectedAmmo",null,null);if(ammo){messages.push(ammo.armorPiercingFormula);}return messages.join(" + ammo: ");}},{key:"_getDamageTypeMessage",value:function _getDamageTypeMessage(){return"Standard";}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Damage type",value:this._getDamageTypeMessage()});previousResponse.push({header:"Damage",value:this._getDamageMessage()});previousResponse.push({header:"Armor piercing",value:this._getArmorPiercingMessage()});return previousResponse;}},{key:"applyDamageFromWeaponFire",value:function applyDamageFromWeaponFire(payload){var fireOrder=payload.fireOrder,combatLogEntry=payload.combatLogEntry,hitResolution=payload.hitResolution;var hit=hitResolution.result;var result=new combatLog_CombatLogDamageEntry();combatLogEntry.addDamage(result);if(hit){combatLogEntry.setShots(1,1);this._doDamage(Object(objectSpread2["a" /* default */])({shooterPosition:payload.shooter.getPosition()},payload),result);}else{combatLogEntry.setShots(0,1);}}},{key:"_doDamage",value:function _doDamage(payload,damageResult,lastSection){var armorPiercing=arguments.length>3&&arguments[3]!==undefined?arguments[3]:undefined;var damage=arguments.length>4&&arguments[4]!==undefined?arguments[4]:undefined;var target=payload.target,shooterPosition=payload.shooterPosition;if(armorPiercing===undefined){armorPiercing=this._getArmorPiercing(payload);}if(damage===undefined){damage=this._getDamageForWeaponHit(payload);}var hitSystem=this._chooseHitSystem({target:target,shooterPosition:shooterPosition,lastSection:lastSection});if(!hitSystem){damageResult.addNote("Unable to find system to hit");return;}var result=this._doDamageToSystem(payload,damageResult,hitSystem,armorPiercing,damage);armorPiercing=result.armorPiercing;damage=result.damage;if(damage===0){return damageResult;}var overkillSystem=this._findOverkillStructure(hitSystem,target);if(!overkillSystem){return this._doDamage(payload,damageResult,target.systems.sections.getSectionBySystem(hitSystem),armorPiercing,damage);}result=this._doDamageToSystem(payload,damageResult,overkillSystem,armorPiercing,damage);armorPiercing=result.armorPiercing;damage=result.damage;if(damage===0){return;}return this._doDamage(payload,damageResult,target.systems.sections.getSectionBySystem(overkillSystem),armorPiercing,damage);}},{key:"_findOverkillStructure",value:function _findOverkillStructure(system,ship){var section=ship.systems.sections.getSectionBySystem(system);var structure=section.getStructure();if(!structure||structure.id===system.id||structure.isDestroyed()){return null;}return structure;}},{key:"_doDamageToSystem",value:function _doDamageToSystem(_ref,damageResult,hitSystem,armorPiercing,damage){Object(objectDestructuringEmpty["a" /* default */])(_ref);var armor=hitSystem.getArmor();var finalArmor=armor-armorPiercing;if(finalArmor<0){finalArmor=0;}damage-=finalArmor;var armorPiercingLeft=armorPiercing-armor;if(armorPiercingLeft<0){armorPiercingLeft=0;}if(damage<0){damage=0;}var entry=null;if(damage>hitSystem.getRemainingHitpoints()){if(hitSystem.getRemainingHitpoints()<=0){throw new Error("Trying to damage destroyed system");}entry=new system_DamageEntry(hitSystem.getRemainingHitpoints(),finalArmor);damage-=hitSystem.getRemainingHitpoints();}else{entry=new system_DamageEntry(damage,finalArmor);damage=0;}hitSystem.addDamage(entry);damageResult.add(hitSystem,entry);return{armorPiercing:armorPiercingLeft,damage:damage};}},{key:"_chooseHitSystem",value:function _chooseHitSystem(_ref2){var target=_ref2.target,shooterPosition=_ref2.shooterPosition,lastSection=_ref2.lastSection;return this.hitSystemRandomizer.randomizeHitSystem(target.systems.getSystemsForHit(shooterPosition,lastSection));}},{key:"_getDamageForWeaponHit",value:function _getDamageForWeaponHit(_ref3){var requiredToHit=_ref3.requiredToHit,rolledToHit=_ref3.rolledToHit;var damage=0;if(Number.isInteger(this.damageFormula)){damage=this.damageFormula;}else if(this.damageFormula!==null){damage=this.diceRoller.roll(this.damageFormula).total;}if(!this.system){return damage;}var ammo=this.system.callHandler("getSelectedAmmo",null,null);if(!ammo){return damage;}return damage+ammo.getDamage(this.diceRoller);}},{key:"_getArmorPiercing",value:function _getArmorPiercing(){var armorPiercing=0;if(Number.isInteger(this.armorPiercingFormula)){armorPiercing=this.armorPiercingFormula;}else if(this.armorPiercingFormula!==null){armorPiercing=this.diceRoller.roll(this.armorPiercingFormula).total;}if(!this.system){return armorPiercing;}var ammo=this.system.callHandler("getSelectedAmmo",null,null);if(!ammo){return armorPiercing;}return armorPiercing+ammo.getArmorPiercing(this.diceRoller);}}]);return StandardDamageStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_StandardDamageStrategy = (StandardDamageStrategy_StandardDamageStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/torpedoDamageStrategy/MSVTorpedoDamageStrategy.mjs
var MSVTorpedoDamageStrategy_MSVTorpedoDamageStrategy=/*#__PURE__*/function(_StandardDamageStrate){Object(inherits["a" /* default */])(MSVTorpedoDamageStrategy,_StandardDamageStrate);function MSVTorpedoDamageStrategy(damageFormula,armorPiercingFormula,rangePenalty,numberOfShots){var _this;var strikeHitChance=arguments.length>4&&arguments[4]!==undefined?arguments[4]:20;var minStrikeDistance=arguments.length>5&&arguments[5]!==undefined?arguments[5]:1;Object(classCallCheck["a" /* default */])(this,MSVTorpedoDamageStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(MSVTorpedoDamageStrategy).call(this,damageFormula,armorPiercingFormula));_this.rangePenalty=rangePenalty;_this.numberOfShots=numberOfShots;_this.strikeHitChance=strikeHitChance;_this.minStrikeDistance=minStrikeDistance;_this.msv=true;return _this;}Object(createClass["a" /* default */])(MSVTorpedoDamageStrategy,[{key:"getAttackRunMessages",value:function getAttackRunMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[{header:"Strike distance",value:this.getStrikeDistance(payload)}];}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Number of SVs",value:this.numberOfShots});previousResponse.push({header:"Damage per SV",value:this.damageFormula});previousResponse.push({header:"Armor piercing per SV",value:this.armorPiercingFormula});previousResponse.push({header:"SV range penalty",value:this.rangePenalty});previousResponse.push({header:"Target hit chance",value:"".concat(this.strikeHitChance,"%")});return previousResponse;}},{key:"_getDamageForWeaponHit",value:function _getDamageForWeaponHit(_ref){var torpedoFlight=_ref.torpedoFlight;if(Number.isInteger(this.damageFormula)){return Math.ceil(this.damageFormula);}return Math.ceil(this.diceRoller.roll(this.damageFormula).total);}},{key:"_getArmorPiercing",value:function _getArmorPiercing(_ref2){var torpedoFlight=_ref2.torpedoFlight;if(Number.isInteger(this.armorPiercingFormula)){return Math.round(this.armorPiercingFormula);}return Math.round(this.diceRoller.roll(this.armorPiercingFormula).total);}},{key:"getHitChance",value:function getHitChance(_ref3){var target=_ref3.target,torpedoFlight=_ref3.torpedoFlight,distance=_ref3.distance;var hitProfile=target.getHitProfile(torpedoFlight.strikePosition);var rangeModifier=this.rangePenalty*(1+target.movement.getEvasion()/10)*distance;return hitProfile-rangeModifier;}},{key:"getStrikeDistance",value:function getStrikeDistance(payload){var distance=11;while(distance--){if(distance===this.minStrikeDistance){return distance;}if(this.getHitChance(Object(objectSpread2["a" /* default */])({},payload,{distance:distance}))>=this.strikeHitChance){return distance;}}return 1;}},{key:"applyDamageFromWeaponFire",value:function applyDamageFromWeaponFire(payload){var torpedoFlight=payload.torpedoFlight,combatLogEvent=payload.combatLogEvent;var attackPosition=torpedoFlight.strikePosition;var shots=this.numberOfShots;var distance=this.getStrikeDistance(payload);var hitChance=this.getHitChance(Object(objectSpread2["a" /* default */])({},payload,{distance:distance}));combatLogEvent.addNote("MSV with ".concat(this.numberOfShots," projectiles at distance ").concat(distance," with hit chance of ").concat(hitChance,"% each."));var hits=0;while(shots--){var roll=Math.ceil(Math.random()*100);var hit=roll<=hitChance;if(hit){hits++;var result=new combatLog_CombatLogDamageEntry();combatLogEvent.addDamage(result);this._doDamage(Object(objectSpread2["a" /* default */])({shooterPosition:attackPosition},payload),result);}}combatLogEvent.addNote("".concat(hits," MSVs hit target."));}}]);return MSVTorpedoDamageStrategy;}(weapon_StandardDamageStrategy);/* harmony default export */ var torpedoDamageStrategy_MSVTorpedoDamageStrategy = (MSVTorpedoDamageStrategy_MSVTorpedoDamageStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo158MSV.mjs
var Torpedo158MSV_Torpedo158MSV=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo158MSV,_Torpedo);function Torpedo158MSV(){var _this;Object(classCallCheck["a" /* default */])(this,Torpedo158MSV);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo158MSV).call(this,{}));_this.damageStrategy=new torpedoDamageStrategy_MSVTorpedoDamageStrategy("d3+3",0,15,32);_this.visuals={engineColor:[255/255,222/255,120/255],explosionType:"MSV"};return _this;}Object(createClass["a" /* default */])(Torpedo158MSV,[{key:"getStrikeDistance",value:function getStrikeDistance(flight,target){return this.damageStrategy.getStrikeDistance({target:target,torpedoFlight:flight});}},{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Torpedo158MSV.prototype),"getCargoInfo",this).call(this);return[{value:"A long range torpedo with Multiple Strike Vehicles."}].concat(Object(toConsumableArray["a" /* default */])(previousResponse));}},{key:"getDisplayName",value:function getDisplayName(){return"Shrike 1.53m MSV torpedo";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/torpedoMSV.png";}}]);return Torpedo158MSV;}(torpedo_Torpedo158);/* harmony default export */ var torpedo_Torpedo158MSV = (Torpedo158MSV_Torpedo158MSV);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo158MSV2.mjs
var Torpedo158MSV2_Torpedo158MSV2=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo158MSV2,_Torpedo);function Torpedo158MSV2(){var _this;Object(classCallCheck["a" /* default */])(this,Torpedo158MSV2);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo158MSV2).call(this,{evasion:35}));_this.damageStrategy=new torpedoDamageStrategy_MSVTorpedoDamageStrategy("d3",0,5,84,10);_this.visuals={engineColor:[255/255,222/255,120/255],explosionType:"MSV"};return _this;}Object(createClass["a" /* default */])(Torpedo158MSV2,[{key:"getStrikeDistance",value:function getStrikeDistance(flight,target){return this.damageStrategy.getStrikeDistance({target:target,torpedoFlight:flight});}},{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Torpedo158MSV2.prototype),"getCargoInfo",this).call(this);return[{value:"A long range torpedo with Multiple Strike Vehicles. Designed to supress smaller targets."}].concat(Object(toConsumableArray["a" /* default */])(previousResponse));}},{key:"getDisplayName",value:function getDisplayName(){return"Shrike B 1.53m saturation MSV torpedo";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/torpedoMSV2.png";}}]);return Torpedo158MSV2;}(torpedo_Torpedo158);/* harmony default export */ var torpedo_Torpedo158MSV2 = (Torpedo158MSV2_Torpedo158MSV2);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/ExplosiveDamageStrategy.mjs
var ExplosiveDamageStrategy_ExplosiveDamageStrategy=/*#__PURE__*/function(_StandardDamageStrate){Object(inherits["a" /* default */])(ExplosiveDamageStrategy,_StandardDamageStrate);function ExplosiveDamageStrategy(damageFormula,armorPiercingFormula){var _this;var numberOfDamagesFormula=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;Object(classCallCheck["a" /* default */])(this,ExplosiveDamageStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ExplosiveDamageStrategy).call(this,damageFormula,armorPiercingFormula));_this.numberOfDamagesFormula=numberOfDamagesFormula;return _this;}Object(createClass["a" /* default */])(ExplosiveDamageStrategy,[{key:"_getDamageTypeMessage",value:function _getDamageTypeMessage(){return"Explosive";}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Damage type",value:this._getDamageTypeMessage()});previousResponse.push({header:"Number of hits",value:this.numberOfDamagesFormula});previousResponse.push({header:"Damage per hit",value:this._getDamageMessage()});previousResponse.push({header:"Armor piercing per hit",value:this._getArmorPiercingMessage()});return previousResponse;}},{key:"_getNumberOfDamagesForWeaponHit",value:function _getNumberOfDamagesForWeaponHit(){if(Number.isInteger(this.numberOfDamagesFormula)){return this.numberOfDamagesFormula;}return this.diceRoller.roll(this.numberOfDamagesFormula).total;}},{key:"_doDamage",value:function _doDamage(payload,damageResult){var target=payload.target,shooterPosition=payload.shooterPosition;var numberOfDamages=this._getNumberOfDamagesForWeaponHit();while(numberOfDamages--){var hitSystem=this._chooseHitSystem({target:target,shooterPosition:shooterPosition});if(!hitSystem){return;}this._doDamageToSystem(payload,damageResult,hitSystem,this._getArmorPiercing(),this._getDamageForWeaponHit(payload));}}}]);return ExplosiveDamageStrategy;}(weapon_StandardDamageStrategy);/* harmony default export */ var weapon_ExplosiveDamageStrategy = (ExplosiveDamageStrategy_ExplosiveDamageStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/torpedoDamageStrategy/HETorpedoDamageStrategy.mjs
var HETorpedoDamageStrategy_HETorpedoDamageStrategy=/*#__PURE__*/function(_ExplosiveDamageStrat){Object(inherits["a" /* default */])(HETorpedoDamageStrategy,_ExplosiveDamageStrat);function HETorpedoDamageStrategy(damageFormula,armorPiercingFormula,numberOfHitsFormula){Object(classCallCheck["a" /* default */])(this,HETorpedoDamageStrategy);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(HETorpedoDamageStrategy).call(this,damageFormula,armorPiercingFormula,numberOfHitsFormula));}Object(createClass["a" /* default */])(HETorpedoDamageStrategy,[{key:"getAttackRunMessages",value:function getAttackRunMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[{header:"Strike distance",value:this.getStrikeDistance(payload)}];}},{key:"_getDamageMessage",value:function _getDamageMessage(){return this.damageFormula;}},{key:"_getArmorPiercingMessage",value:function _getArmorPiercingMessage(){return this.armorPiercingFormula;}},{key:"getStrikeDistance",value:function getStrikeDistance(){return 1;}},{key:"applyDamageFromWeaponFire",value:function applyDamageFromWeaponFire(payload){var torpedoFlight=payload.torpedoFlight,combatLogEvent=payload.combatLogEvent;var attackPosition=torpedoFlight.launchPosition;var result=new combatLog_CombatLogDamageEntry();combatLogEvent.addDamage(result);this._doDamage(Object(objectSpread2["a" /* default */])({shooterPosition:attackPosition},payload),result);}}]);return HETorpedoDamageStrategy;}(weapon_ExplosiveDamageStrategy);/* harmony default export */ var torpedoDamageStrategy_HETorpedoDamageStrategy = (HETorpedoDamageStrategy_HETorpedoDamageStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo158Nuclear.mjs
var Torpedo158Nuclear_Torpedo158Nuclear=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo158Nuclear,_Torpedo);function Torpedo158Nuclear(args){var _this;Object(classCallCheck["a" /* default */])(this,Torpedo158Nuclear);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo158Nuclear).call(this,{evasion:20}));_this.damageStrategy=new torpedoDamageStrategy_HETorpedoDamageStrategy("d10+4",0,"d20+60");return _this;}Object(createClass["a" /* default */])(Torpedo158Nuclear,[{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Torpedo158Nuclear.prototype),"getCargoInfo",this).call(this);return[{value:"A long range torpedo with a nuclear payload."}].concat(Object(toConsumableArray["a" /* default */])(previousResponse));}},{key:"getDisplayName",value:function getDisplayName(){return"Bodkin 1.53m nuclear torpedo";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/torpedoNuclear.png";}}]);return Torpedo158Nuclear;}(torpedo_Torpedo158);/* harmony default export */ var torpedo_Torpedo158Nuclear = (Torpedo158Nuclear_Torpedo158Nuclear);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo72.mjs
var Torpedo72_Torpedo72=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo72,_Torpedo);function Torpedo72(_ref){var _ref$minRange=_ref.minRange,minRange=_ref$minRange===void 0?MEDIUM_WEAPON_RANGE*2:_ref$minRange,_ref$maxRange=_ref.maxRange,maxRange=_ref$maxRange===void 0?Math.round(MEDIUM_WEAPON_RANGE*3.5):_ref$maxRange,_ref$hitSize=_ref.hitSize,hitSize=_ref$hitSize===void 0?0:_ref$hitSize,_ref$evasion=_ref.evasion,evasion=_ref$evasion===void 0?50:_ref$evasion;Object(classCallCheck["a" /* default */])(this,Torpedo72);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo72).call(this,{minRange:minRange,maxRange:maxRange,hitSize:hitSize,evasion:evasion}));}return Torpedo72;}(torpedo_Torpedo);/* harmony default export */ var torpedo_Torpedo72 = (Torpedo72_Torpedo72);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo72MSV.mjs
var Torpedo72MSV_Torpedo72MSV=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo72MSV,_Torpedo);function Torpedo72MSV(){var _this;Object(classCallCheck["a" /* default */])(this,Torpedo72MSV);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo72MSV).call(this,{}));_this.damageStrategy=new torpedoDamageStrategy_MSVTorpedoDamageStrategy("d3+3",0,15,25);_this.visuals={engineColor:[255/255,222/255,120/255],explosionType:"MSV"};return _this;}Object(createClass["a" /* default */])(Torpedo72MSV,[{key:"getStrikeDistance",value:function getStrikeDistance(flight,target){return this.damageStrategy.getStrikeDistance({target:target,torpedoFlight:flight});}},{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Torpedo72MSV.prototype),"getCargoInfo",this).call(this);return[{value:"A medium range torpedo with Multiple Strike Vehicles."}].concat(Object(toConsumableArray["a" /* default */])(previousResponse));}},{key:"getDisplayName",value:function getDisplayName(){return"Avalanche 0.72m MSV torpedo";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/torpedoMSVsmall.png";}}]);return Torpedo72MSV;}(torpedo_Torpedo72);/* harmony default export */ var torpedo_Torpedo72MSV = (Torpedo72MSV_Torpedo72MSV);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo72HE.mjs
var Torpedo72HE_Torpedo72HE=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo72HE,_Torpedo);function Torpedo72HE(){var _this;Object(classCallCheck["a" /* default */])(this,Torpedo72HE);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo72HE).call(this,{}));_this.damageStrategy=new torpedoDamageStrategy_HETorpedoDamageStrategy("d8+4",0,"d3+3");return _this;}Object(createClass["a" /* default */])(Torpedo72HE,[{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Torpedo72HE.prototype),"getCargoInfo",this).call(this);return[{value:"A medium range torpedo with high explosive warhead."}].concat(Object(toConsumableArray["a" /* default */])(previousResponse));}},{key:"getDisplayName",value:function getDisplayName(){return"Pike 0.72m HE torpedo";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/torpedoHEsmall.png";}}]);return Torpedo72HE;}(torpedo_Torpedo72);/* harmony default export */ var torpedo_Torpedo72HE = (Torpedo72HE_Torpedo72HE);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/Torpedo158HE.mjs
var Torpedo158HE_Torpedo158HE=/*#__PURE__*/function(_Torpedo){Object(inherits["a" /* default */])(Torpedo158HE,_Torpedo);function Torpedo158HE(){var _this;Object(classCallCheck["a" /* default */])(this,Torpedo158HE);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Torpedo158HE).call(this,{}));_this.damageStrategy=new torpedoDamageStrategy_HETorpedoDamageStrategy("d10+4",0,"d8+6");return _this;}Object(createClass["a" /* default */])(Torpedo158HE,[{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Torpedo158HE.prototype),"getCargoInfo",this).call(this);return[{value:"A long range torpedo with high explosive warhead."}].concat(Object(toConsumableArray["a" /* default */])(previousResponse));}},{key:"getDisplayName",value:function getDisplayName(){return"Meteor 1.53m HE torpedo";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/torpedoHE.png";}}]);return Torpedo158HE;}(torpedo_Torpedo158);/* harmony default export */ var torpedo_Torpedo158HE = (Torpedo158HE_Torpedo158HE);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/torpedo/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/Ammo.mjs
var Ammo_Ammo=/*#__PURE__*/function(_CargoEntity){Object(inherits["a" /* default */])(Ammo,_CargoEntity);function Ammo(damageFormula,armorPiercingFormula){var _this;Object(classCallCheck["a" /* default */])(this,Ammo);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo).call(this));_this.damageFormula=damageFormula;_this.armorPiercingFormula=armorPiercingFormula;return _this;}Object(createClass["a" /* default */])(Ammo,[{key:"getDamage",value:function getDamage(diceRoller){if(Number.isInteger(this.damageFormula)){return this.armorPiercingFormula;}return diceRoller.roll(this.damageFormula).total;}},{key:"getArmorPiercing",value:function getArmorPiercing(diceRoller){if(Number.isInteger(this.armorPiercingFormula)){return this.armorPiercingFormula;}return diceRoller.roll(this.armorPiercingFormula).total;}},{key:"getCargoInfo",value:function getCargoInfo(){var previousResponse=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Ammo.prototype),"getCargoInfo",this).call(this);return[{header:"Damage",value:this.damageFormula},{header:"Armor piercing",value:this.armorPiercingFormula}].concat(Object(toConsumableArray["a" /* default */])(previousResponse));}},{key:"getIconText",value:function getIconText(){return"";}}]);return Ammo;}(cargo_CargoEntity);/* harmony default export */ var ammunition_Ammo = (Ammo_Ammo);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/Ammo30mm.mjs
var Ammo30mm_Ammo30mm=/*#__PURE__*/function(_Ammo){Object(inherits["a" /* default */])(Ammo30mm,_Ammo);function Ammo30mm(){Object(classCallCheck["a" /* default */])(this,Ammo30mm);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo30mm).call(this,"d2","d3+2"));}Object(createClass["a" /* default */])(Ammo30mm,[{key:"getSpaceRequired",value:function getSpaceRequired(){return 0.01;}},{key:"getDisplayName",value:function getDisplayName(){return"30mm PDC shell";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"30mm";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/ammo/30mm.png";}}]);return Ammo30mm;}(ammunition_Ammo);/* harmony default export */ var conventional_Ammo30mm = (Ammo30mm_Ammo30mm);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/Ammo85mmHE.mjs
var Ammo85mmHE_Ammo85mmHE=/*#__PURE__*/function(_Ammo){Object(inherits["a" /* default */])(Ammo85mmHE,_Ammo);function Ammo85mmHE(){Object(classCallCheck["a" /* default */])(this,Ammo85mmHE);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo85mmHE).call(this,"2d4+2",0));}Object(createClass["a" /* default */])(Ammo85mmHE,[{key:"getSpaceRequired",value:function getSpaceRequired(){return 0.02;}},{key:"getDisplayName",value:function getDisplayName(){return"85mm high explosive shell";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"85mm HE";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/ammo/85mmHE.png";}},{key:"getIconText",value:function getIconText(){return"HE";}}]);return Ammo85mmHE;}(ammunition_Ammo);/* harmony default export */ var conventional_Ammo85mmHE = (Ammo85mmHE_Ammo85mmHE);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/Ammo85mmAP.mjs
var Ammo85mmAP_Ammo85mmAP=/*#__PURE__*/function(_Ammo){Object(inherits["a" /* default */])(Ammo85mmAP,_Ammo);function Ammo85mmAP(){Object(classCallCheck["a" /* default */])(this,Ammo85mmAP);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo85mmAP).call(this,"d3","2d3+2"));}Object(createClass["a" /* default */])(Ammo85mmAP,[{key:"getSpaceRequired",value:function getSpaceRequired(){return 0.02;}},{key:"getDisplayName",value:function getDisplayName(){return"85mm armor piercing shell";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"85mm AP";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/ammo/85mmAP.png";}},{key:"getIconText",value:function getIconText(){return"AP";}}]);return Ammo85mmAP;}(ammunition_Ammo);/* harmony default export */ var conventional_Ammo85mmAP = (Ammo85mmAP_Ammo85mmAP);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/Ammo140mmAP.mjs
var Ammo140mmAP_Ammo140mmAP=/*#__PURE__*/function(_Ammo){Object(inherits["a" /* default */])(Ammo140mmAP,_Ammo);function Ammo140mmAP(){Object(classCallCheck["a" /* default */])(this,Ammo140mmAP);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo140mmAP).call(this,"2d3+6",12));}Object(createClass["a" /* default */])(Ammo140mmAP,[{key:"getDisplayName",value:function getDisplayName(){return"140mm armor piercing railgun projectile";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"140mm AP";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/ammo/140mmAP.png";}},{key:"getIconText",value:function getIconText(){return"AP";}}]);return Ammo140mmAP;}(ammunition_Ammo);/* harmony default export */ var conventional_Ammo140mmAP = (Ammo140mmAP_Ammo140mmAP);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/Ammo140mmHE.mjs
var Ammo140mmHE_Ammo140mmHE=/*#__PURE__*/function(_Ammo){Object(inherits["a" /* default */])(Ammo140mmHE,_Ammo);function Ammo140mmHE(){Object(classCallCheck["a" /* default */])(this,Ammo140mmHE);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo140mmHE).call(this,"2d5 + 10",0));}Object(createClass["a" /* default */])(Ammo140mmHE,[{key:"getDisplayName",value:function getDisplayName(){return"140mm high explosive railgun projectile";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"140mm HE";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/ammo/140mmHE.png";}},{key:"getIconText",value:function getIconText(){return"HE";}}]);return Ammo140mmHE;}(ammunition_Ammo);/* harmony default export */ var conventional_Ammo140mmHE = (Ammo140mmHE_Ammo140mmHE);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/Ammo120mmAP.mjs
var Ammo120mmAP_Ammo120mmAP=/*#__PURE__*/function(_Ammo){Object(inherits["a" /* default */])(Ammo120mmAP,_Ammo);function Ammo120mmAP(){Object(classCallCheck["a" /* default */])(this,Ammo120mmAP);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo120mmAP).call(this,"2d3+5",10));}Object(createClass["a" /* default */])(Ammo120mmAP,[{key:"getDisplayName",value:function getDisplayName(){return"120mm armor piercing railgun projectile";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"120mm AP";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/ammo/120mmAP.png";}},{key:"getIconText",value:function getIconText(){return"AP";}}]);return Ammo120mmAP;}(ammunition_Ammo);/* harmony default export */ var conventional_Ammo120mmAP = (Ammo120mmAP_Ammo120mmAP);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/Ammo120mmHE.mjs
var Ammo120mmHE_Ammo120mmHE=/*#__PURE__*/function(_Ammo){Object(inherits["a" /* default */])(Ammo120mmHE,_Ammo);function Ammo120mmHE(){Object(classCallCheck["a" /* default */])(this,Ammo120mmHE);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo120mmHE).call(this,"2d4 + 10",0));}Object(createClass["a" /* default */])(Ammo120mmHE,[{key:"getDisplayName",value:function getDisplayName(){return"120mm high explosive railgun projectile";}},{key:"getShortDisplayName",value:function getShortDisplayName(){return"120mm HE";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/ammo/120mmHE.png";}},{key:"getIconText",value:function getIconText(){return"HE";}}]);return Ammo120mmHE;}(ammunition_Ammo);/* harmony default export */ var conventional_Ammo120mmHE = (Ammo120mmHE_Ammo120mmHE);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/conventional/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/NoAmmunitionLoaded.mjs
var NoAmmunitionLoaded_NoAmmunitionLoaded=/*#__PURE__*/function(_CargoEntity){Object(inherits["a" /* default */])(NoAmmunitionLoaded,_CargoEntity);function NoAmmunitionLoaded(){Object(classCallCheck["a" /* default */])(this,NoAmmunitionLoaded);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(NoAmmunitionLoaded).apply(this,arguments));}Object(createClass["a" /* default */])(NoAmmunitionLoaded,[{key:"getDisplayName",value:function getDisplayName(){return"NO AMMUNITION LOADED";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/noAmmo.png";}}]);return NoAmmunitionLoaded;}(cargo_CargoEntity);/* harmony default export */ var ammunition_NoAmmunitionLoaded = (NoAmmunitionLoaded_NoAmmunitionLoaded);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/ammunition/index.mjs
var ammunition=Object(objectSpread2["a" /* default */])({},torpedo_namespaceObject,{},conventional_namespaceObject,{NoAmmunitionLoaded:ammunition_NoAmmunitionLoaded});
// CONCATENATED MODULE: ./src/model/unit/system/cargo/cargo.mjs
var cargoClasses=Object(objectSpread2["a" /* default */])({},ammunition);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/CargoBaySystemStrategy.mjs
var CargoBaySystemStrategy_CargoBaySystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(CargoBaySystemStrategy,_ShipSystemStrategy);function CargoBaySystemStrategy(space){var _this;Object(classCallCheck["a" /* default */])(this,CargoBaySystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CargoBaySystemStrategy).call(this));_this.space=space;_this.cargo=[];return _this;}Object(createClass["a" /* default */])(CargoBaySystemStrategy,[{key:"getUiComponents",value:function getUiComponents(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{name:"CargoList",props:{list:this.cargo.map(function(cargo){return{object:cargo.object,amount:cargo.amount};})}}]);}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{cargoBaySystemStrategy:this.cargo.map(function(cargo){return{className:cargo.object.constructor.name,amount:cargo.amount};})});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.cargo=data.cargoBaySystemStrategy?data.cargoBaySystemStrategy.map(function(data){return{object:new cargoClasses[data.className](),amount:data.amount};}):[];return this;}},{key:"getTotalCargoSpace",value:function getTotalCargoSpace(){return this.space;}},{key:"getAvailableCargoSpace",value:function getAvailableCargoSpace(){return this.space-this.getCargoSpaceUsed();}},{key:"getCargoSpaceUsed",value:function getCargoSpaceUsed(){return this.cargo.reduce(function(total,_ref){var object=_ref.object,amount=_ref.amount;return total+object.getSpaceRequired()*amount;},0);}},{key:"hasSpaceFor",value:function hasSpaceFor(_ref2){var object=_ref2.object,amount=_ref2.amount;return this.getAvailableCargoSpace()>=object.getSpaceRequired()*amount;}},{key:"getCargoEntry",value:function getCargoEntry(object){return this.cargo.find(function(stored){return stored.object.constructor===object.constructor;});}},{key:"getCargoByParentClass",value:function getCargoByParentClass(parentClass){return this.cargo.filter(function(cargo){return cargo.object instanceof parentClass;});}},{key:"hasCargo",value:function hasCargo(_ref3){var object=_ref3.object,_ref3$amount=_ref3.amount,amount=_ref3$amount===void 0?1:_ref3$amount;var entry=this.getCargoEntry(object);if(!entry){return false;}return entry.amount>=amount;}},{key:"removeCargo",value:function removeCargo(_ref4){var object=_ref4.object,_ref4$amount=_ref4.amount,amount=_ref4$amount===void 0?1:_ref4$amount;var entry=this.getCargoEntry(object);if(!entry||entry.amount<amount){throw new Error("Check hasCargo first!");}entry.amount-=amount;this.cargo=this.cargo.filter(function(entry){return entry.amount>0;});}},{key:"addCargo",value:function addCargo(_ref5){var object=_ref5.object,_ref5$amount=_ref5.amount,amount=_ref5$amount===void 0?1:_ref5$amount;if(!this.hasSpaceFor({object:object,amount:amount})){throw new Error("No space in cargo bay");}var entry=this.getCargoEntry(object);if(entry){entry.amount+=amount;}else{entry={object:new cargoClasses[object.constructor.name](),amount:amount};this.cargo.push(entry);}}}]);return CargoBaySystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_CargoBaySystemStrategy = (CargoBaySystemStrategy_CargoBaySystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/StoreHeatStrategy.mjs
var StoreHeatStrategy_StoreHeatStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(StoreHeatStrategy,_ShipSystemStrategy);function StoreHeatStrategy(heatCapacity){var _this;Object(classCallCheck["a" /* default */])(this,StoreHeatStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StoreHeatStrategy).call(this));_this.heatCapacity=heatCapacity;return _this;}Object(createClass["a" /* default */])(StoreHeatStrategy,[{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{header:"Stores heat without overheating",value:"".concat(this.heatCapacity)},{header:"Heat stored",value:Math.round(this.system.heat.getHeat())}]);}},{key:"canStoreHeat",value:function canStoreHeat(){if(this.system.isDisabled()){return false;}return true;}},{key:"getHeatStoreAmount",value:function getHeatStoreAmount(payload,previousResponse){if(this.system.isDisabled()){return previousResponse;}return previousResponse+this.heatCapacity;}}]);return StoreHeatStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_StoreHeatStrategy = (StoreHeatStrategy_StoreHeatStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/RadiateHeatStrategy.mjs
var RadiateHeatStrategy_RadiateHeatStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(RadiateHeatStrategy,_ShipSystemStrategy);function RadiateHeatStrategy(radiationCapacity){var _this;Object(classCallCheck["a" /* default */])(this,RadiateHeatStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RadiateHeatStrategy).call(this));_this.radiationCapacity=radiationCapacity;_this.heatRadiated=0;return _this;}Object(createClass["a" /* default */])(RadiateHeatStrategy,[{key:"isRadiator",value:function isRadiator(){return true;}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Radiates heat",value:"".concat(this.getHeatRadiationCapacity())});return previousResponse;}},{key:"getRadiatedHeat",value:function getRadiatedHeat(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return this.heatRadiated+previousResponse;}},{key:"getHeatRadiationCapacity",value:function getHeatRadiationCapacity(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var undamaged=this.system.damage.getPercentUnDamaged();var capacity=Math.floor(this.radiationCapacity*undamaged)-this.heatRadiated;if(capacity<0){capacity=0;}return previousResponse+capacity;}},{key:"radiateHeat",value:function radiateHeat(heat){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var heatLeft=heat-previousResponse;if(heatLeft<=0){return previousResponse;}var capacity=this.getHeatRadiationCapacity();if(capacity<heatLeft){heatLeft=capacity;}this.heatRadiated+=heatLeft;return previousResponse+heatLeft;}}]);return RadiateHeatStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_RadiateHeatStrategy = (RadiateHeatStrategy_RadiateHeatStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/FuelTankSystemStrategy.mjs
var FuelTankSystemStrategy_FuelTankSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(FuelTankSystemStrategy,_ShipSystemStrategy);function FuelTankSystemStrategy(space){var _this;Object(classCallCheck["a" /* default */])(this,FuelTankSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(FuelTankSystemStrategy).call(this));_this.space=space;_this.fuel=0;return _this;}Object(createClass["a" /* default */])(FuelTankSystemStrategy,[{key:"getFuel",value:function getFuel(){return this.fuel;}},{key:"getFuelSpace",value:function getFuelSpace(){return this.space;}},{key:"setMaxFuel",value:function setMaxFuel(){this.fuel=this.space;}},{key:"setFuel",value:function setFuel(fuel){if(fuel>this.space){throw new Error("No space for fuel");}this.fuel=fuel;}},{key:"takeFuel",value:function takeFuel(amount){if(amount>this.fuel){throw new Error("Trying to take more fuel than exists");}this.fuel-=amount;}},{key:"addFuel",value:function addFuel(amount){if(this.fuel+amount>this.space){throw new Error("No space for fuel");}this.fuel+=amount;}},{key:"getUiComponents",value:function getUiComponents(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{name:"SystemFuelBar",props:{space:this.space,fuel:this.fuel}}]);}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{fuelTankSystemStrategy:{fuel:this.fuel}});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.fuel=data.fuelTankSystemStrategy?data.fuelTankSystemStrategy.fuel:0;return this;}}]);return FuelTankSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_FuelTankSystemStrategy = (FuelTankSystemStrategy_FuelTankSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/structure/Structure.mjs
var Structure_Structure=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(Structure,_ShipSystem);function Structure(_ref){var _this;var _ref$cargoSpace=_ref.cargoSpace,cargoSpace=_ref$cargoSpace===void 0?0:_ref$cargoSpace,_ref$heatStorage=_ref.heatStorage,heatStorage=_ref$heatStorage===void 0?0:_ref$heatStorage,_ref$radiator=_ref.radiator,radiator=_ref$radiator===void 0?0:_ref$radiator,_ref$fuel=_ref.fuel,fuel=_ref$fuel===void 0?0:_ref$fuel,args=Object(objectWithoutProperties["a" /* default */])(_ref,["cargoSpace","heatStorage","radiator","fuel"]);Object(classCallCheck["a" /* default */])(this,Structure);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Structure).call(this,args));if(cargoSpace){_this.addStrategy(new strategy_CargoBaySystemStrategy(cargoSpace));}if(heatStorage){_this.addStrategy(new strategy_StoreHeatStrategy(heatStorage));}if(radiator){_this.addStrategy(new strategy_RadiateHeatStrategy(radiator));}if(fuel){_this.addStrategy(new strategy_FuelTankSystemStrategy(fuel));}return _this;}Object(createClass["a" /* default */])(Structure,[{key:"getDisplayName",value:function getDisplayName(){return"Structure";}}]);return Structure;}(system_ShipSystem);/* harmony default export */ var structure_Structure = (Structure_Structure);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/systemLocation.mjs
var SYSTEM_LOCATION_PRIMARY=0;var SYSTEM_LOCATION_FRONT=1;var SYSTEM_LOCATION_AFT=2;var SYSTEM_LOCATION_PORT_FRONT=31;var SYSTEM_LOCATION_PORT_AFT=32;var SYSTEM_LOCATION_STARBOARD_FRONT=41;var SYSTEM_LOCATION_STARBOARD_AFT=42;
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/SystemSection.mjs
var SystemSection_SystemSection=/*#__PURE__*/function(){function SystemSection(location){Object(classCallCheck["a" /* default */])(this,SystemSection);this.location=location;this.systems=[];}Object(createClass["a" /* default */])(SystemSection,[{key:"getOffsetHex",value:function getOffsetHex(){switch(this.location){case SYSTEM_LOCATION_PRIMARY:return new hexagon.Offset(0,0);case SYSTEM_LOCATION_FRONT:return new hexagon.Offset(1,0);case SYSTEM_LOCATION_AFT:return new hexagon.Offset(-1,0);case SYSTEM_LOCATION_PORT_FRONT:return new hexagon.Offset(1,1);case SYSTEM_LOCATION_PORT_AFT:return new hexagon.Offset(0,1);case SYSTEM_LOCATION_STARBOARD_FRONT:return new hexagon.Offset(1,-1);case SYSTEM_LOCATION_STARBOARD_AFT:return new hexagon.Offset(0,-1);}}},{key:"hasUndestroyedStructure",value:function hasUndestroyedStructure(){return this.systems.some(function(system){return system instanceof structure_Structure&&!system.isDisabled();});}},{key:"addSystem",value:function addSystem(system){this.systems.push(system);return this;}},{key:"getSystems",value:function getSystems(){return this.systems;}},{key:"isLocation",value:function isLocation(location){return this.location===location;}},{key:"hasSystems",value:function hasSystems(){return this.systems.length>0;}},{key:"getStructure",value:function getStructure(){return this.systems.find(function(system){return system instanceof structure_Structure;});}},{key:"getNonStructureSystems",value:function getNonStructureSystems(){return this.systems.filter(function(system){return!(system instanceof structure_Structure);});}}]);return SystemSection;}();/* harmony default export */ var systemSection_SystemSection = (SystemSection_SystemSection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/PrimarySection.mjs
var PrimarySection_PrimarySection=/*#__PURE__*/function(_SystemSection){Object(inherits["a" /* default */])(PrimarySection,_SystemSection);function PrimarySection(){Object(classCallCheck["a" /* default */])(this,PrimarySection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(PrimarySection).call(this,SYSTEM_LOCATION_PRIMARY));}return PrimarySection;}(systemSection_SystemSection);/* harmony default export */ var systemSection_PrimarySection = (PrimarySection_PrimarySection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/AftSection.mjs
var AftSection_AftSection=/*#__PURE__*/function(_SystemSection){Object(inherits["a" /* default */])(AftSection,_SystemSection);function AftSection(){Object(classCallCheck["a" /* default */])(this,AftSection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AftSection).call(this,SYSTEM_LOCATION_AFT));}return AftSection;}(systemSection_SystemSection);/* harmony default export */ var systemSection_AftSection = (AftSection_AftSection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/FrontSection.mjs
var FrontSection_FrontSection=/*#__PURE__*/function(_SystemSection){Object(inherits["a" /* default */])(FrontSection,_SystemSection);function FrontSection(){Object(classCallCheck["a" /* default */])(this,FrontSection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(FrontSection).call(this,SYSTEM_LOCATION_FRONT));}return FrontSection;}(systemSection_SystemSection);/* harmony default export */ var systemSection_FrontSection = (FrontSection_FrontSection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/PortAftSection.mjs
var PortAftSection_PortAftSection=/*#__PURE__*/function(_SystemSection){Object(inherits["a" /* default */])(PortAftSection,_SystemSection);function PortAftSection(){Object(classCallCheck["a" /* default */])(this,PortAftSection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(PortAftSection).call(this,SYSTEM_LOCATION_PORT_AFT));}return PortAftSection;}(systemSection_SystemSection);/* harmony default export */ var systemSection_PortAftSection = (PortAftSection_PortAftSection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/PortFrontSection.mjs
var PortFrontSection_PortFrontSection=/*#__PURE__*/function(_SystemSection){Object(inherits["a" /* default */])(PortFrontSection,_SystemSection);function PortFrontSection(){Object(classCallCheck["a" /* default */])(this,PortFrontSection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(PortFrontSection).call(this,SYSTEM_LOCATION_PORT_FRONT));}return PortFrontSection;}(systemSection_SystemSection);/* harmony default export */ var systemSection_PortFrontSection = (PortFrontSection_PortFrontSection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/StarboardFrontSection.mjs
var StarboardFrontSection_StarboardFrontSection=/*#__PURE__*/function(_SystemSection){Object(inherits["a" /* default */])(StarboardFrontSection,_SystemSection);function StarboardFrontSection(){Object(classCallCheck["a" /* default */])(this,StarboardFrontSection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StarboardFrontSection).call(this,SYSTEM_LOCATION_STARBOARD_FRONT));}return StarboardFrontSection;}(systemSection_SystemSection);/* harmony default export */ var systemSection_StarboardFrontSection = (StarboardFrontSection_StarboardFrontSection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/StarboardAftSection.mjs
var StarboardAftSection_StarboardAftSection=/*#__PURE__*/function(_SystemSection){Object(inherits["a" /* default */])(StarboardAftSection,_SystemSection);function StarboardAftSection(){Object(classCallCheck["a" /* default */])(this,StarboardAftSection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StarboardAftSection).call(this,SYSTEM_LOCATION_STARBOARD_AFT));}return StarboardAftSection;}(systemSection_SystemSection);/* harmony default export */ var systemSection_StarboardAftSection = (StarboardAftSection_StarboardAftSection);
// CONCATENATED MODULE: ./src/model/unit/system/systemSection/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/ShipSystemSections.mjs
var ShipSystemSections_ShipSystemSections=/*#__PURE__*/function(){function ShipSystemSections(ship){Object(classCallCheck["a" /* default */])(this,ShipSystemSections);this.ship=ship;this.sections=[new systemSection_PrimarySection(),new systemSection_FrontSection(),new systemSection_AftSection(),new systemSection_PortFrontSection(),new systemSection_PortAftSection(),new systemSection_StarboardFrontSection(),new systemSection_StarboardAftSection()];}Object(createClass["a" /* default */])(ShipSystemSections,[{key:"getHitSectionHeading",value:function getHitSectionHeading(shooterPosition,shipPosition,shipFacing){var heading=addToDirection(getCompassHeadingOfPoint(shipPosition,shooterPosition),-shipFacing);if(this.ship.movement.isRolled()){return addToDirection(0,-heading);}return heading;}},{key:"getNextSectionForHit",value:function getNextSectionForHit(heading,lastSection){return this.sections.find(function(section){var location=section.getOffsetHex();var intervening=location.getNeighbourAtHeading(heading);return lastSection.getOffsetHex().equals(intervening);});}},{key:"getSectionsThatCanBeHit",value:function getSectionsThatCanBeHit(heading){var _this=this;return this.sections.filter(function(section){var location=section.getOffsetHex();var intervening=location.getNeighbourAtHeading(heading);return _this.sections.every(function(blockingSection){if(!blockingSection.getOffsetHex().equals(intervening)){return true;}else if(!blockingSection.hasUndestroyedStructure()){return true;}else if(blockingSection===section){return true;}else{return false;}});});}},{key:"getHitSections",value:function getHitSections(shooterPosition,shipPosition,shipFacing,lastSection){var heading=this.getHitSectionHeading(shooterPosition,shipPosition,shipFacing);if(!lastSection){return this.getSectionsThatCanBeHit(heading);}var result=[];while(true){var newSection=this.getNextSectionForHit(heading,lastSection);if(!newSection){return result;}result=result.concat(newSection);if(newSection.hasUndestroyedStructure()){return result;}lastSection=newSection;}}},{key:"hasSectionWithStructure",value:function hasSectionWithStructure(type){return this.getSection(type).getStructure();}},{key:"hasFrontSectionWithStructure",value:function hasFrontSectionWithStructure(){return this.hasSectionWithStructure(systemSection_FrontSection);}},{key:"hasStarboardFrontSectionWithStructure",value:function hasStarboardFrontSectionWithStructure(){return this.hasSectionWithStructure(systemSection_StarboardFrontSection);}},{key:"hasStarboardAftSectionWithStructure",value:function hasStarboardAftSectionWithStructure(){return this.hasSectionWithStructure(systemSection_StarboardAftSection);}},{key:"hasPortFrontSectionWithStructure",value:function hasPortFrontSectionWithStructure(){return this.hasSectionWithStructure(systemSection_PortFrontSection);}},{key:"hasPortAftSectionWithStructure",value:function hasPortAftSectionWithStructure(){return this.hasSectionWithStructure(systemSection_PortAftSection);}},{key:"hasAftSectionWithStructure",value:function hasAftSectionWithStructure(){return this.hasSectionWithStructure(systemSection_AftSection);}},{key:"getPrimarySection",value:function getPrimarySection(){return this.getSection(systemSection_PrimarySection);}},{key:"getFrontSection",value:function getFrontSection(){return this.getSection(systemSection_FrontSection);}},{key:"getAftSection",value:function getAftSection(){return this.getSection(systemSection_AftSection);}},{key:"getStarboardFrontSection",value:function getStarboardFrontSection(){return this.getSection(systemSection_StarboardFrontSection);}},{key:"getStarboardAftSection",value:function getStarboardAftSection(){return this.getSection(systemSection_StarboardAftSection);}},{key:"getPortFrontSection",value:function getPortFrontSection(){return this.getSection(systemSection_PortFrontSection);}},{key:"getPortAftSection",value:function getPortAftSection(){return this.getSection(systemSection_PortAftSection);}},{key:"getSection",value:function getSection(location){return this.sections.find(function(section){return section instanceof location;});}},{key:"getSectionBySystem",value:function getSectionBySystem(system){return this.sections.find(function(section){return section.systems.find(function(otherSystem){return system.id===otherSystem.id;});});}},{key:"getSectionsWithStructure",value:function getSectionsWithStructure(){return this.sections.filter(function(section){return section.getStructure();});}}]);return ShipSystemSections;}();/* harmony default export */ var system_ShipSystemSections = (ShipSystemSections_ShipSystemSections);
// CONCATENATED MODULE: ./src/model/unit/ShipSystems.mjs
var ShipSystems_ShipSystems=/*#__PURE__*/function(){function ShipSystems(ship){Object(classCallCheck["a" /* default */])(this,ShipSystems);this.ship=ship;this.systems={};this.systemsAsArray=[];this.sections=new system_ShipSystemSections(ship);this.power=new unit_ShipPower(this);}Object(createClass["a" /* default */])(ShipSystems,[{key:"markDestroyedThisTurn",value:function markDestroyedThisTurn(){this.ship.markDestroyedThisTurn();}},{key:"isDestroyed",value:function isDestroyed(){var structuresDestroyed=this.sections.sections.reduce(function(total,section){var structure=section.getStructure();if(structure&&structure.isDestroyed()){return total+1;}return total;},0);var structures=this.sections.sections.reduce(function(total,section){if(section.getStructure()){return total+1;}return total;},0);var primaryStructure=this.sections.getPrimarySection().getStructure();return(!primaryStructure||primaryStructure.isDestroyed())&&structuresDestroyed>structures/2;}},{key:"getSectionsForHit",value:function getSectionsForHit(attackPosition,lastSection){return this.sections.getHitSections(attackPosition,this.ship.getPosition(),hexFacingToAngle(this.ship.getFacing()),lastSection);}},{key:"getSystemsForHit",value:function getSystemsForHit(attackPosition,lastSection){var systems=this.getSectionsForHit(attackPosition,lastSection).reduce(function(all,section){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(section.getSystems().filter(function(system){return!system.isDestroyed();})));},[]);return[].concat(Object(toConsumableArray["a" /* default */])(systems),Object(toConsumableArray["a" /* default */])(this.getSystems().filter(function(system){return system.callHandler("canBeTargeted",null,false);})));}},{key:"addSystem",value:function addSystem(system,section){if(this.getSystemById(system.id)){throw new Error("System with duplicate id! "+system.id);}if(!system.id){throw new Error("System with falsy id!");}this.systems[system.id]=system;this.systemsAsArray.push(system);section.addSystem(system);system.addShipSystemsReference(this);return this;}},{key:"addPrimarySystem",value:function addPrimarySystem(systems){var _this=this;systems=[].concat(systems);systems.forEach(function(system){return _this.addSystem(system,_this.sections.getPrimarySection());});return this;}},{key:"addFrontSystem",value:function addFrontSystem(systems){var _this2=this;systems=[].concat(systems);systems.forEach(function(system){return _this2.addSystem(system,_this2.sections.getFrontSection());});return this;}},{key:"addAftSystem",value:function addAftSystem(systems){var _this3=this;systems=[].concat(systems);systems.forEach(function(system){return _this3.addSystem(system,_this3.sections.getAftSection());});return this;}},{key:"addStarboardFrontSystem",value:function addStarboardFrontSystem(systems){var _this4=this;systems=[].concat(systems);systems.forEach(function(system){return _this4.addSystem(system,_this4.sections.getStarboardFrontSection());});return this;}},{key:"addStarboardAftSystem",value:function addStarboardAftSystem(systems){var _this5=this;systems=[].concat(systems);systems.forEach(function(system){return _this5.addSystem(system,_this5.sections.getStarboardAftSection());});return this;}},{key:"addPortFrontSystem",value:function addPortFrontSystem(systems){var _this6=this;systems=[].concat(systems);systems.forEach(function(system){return _this6.addSystem(system,_this6.sections.getPortFrontSection());});return this;}},{key:"addPortAftSystem",value:function addPortAftSystem(systems){var _this7=this;systems=[].concat(systems);systems.forEach(function(system){return _this7.addSystem(system,_this7.sections.getPortAftSection());});return this;}},{key:"getSystemById",value:function getSystemById(id){return this.systems[id];}},{key:"getSystems",value:function getSystems(){return this.systemsAsArray;}},{key:"deserialize",value:function deserialize(){var _this8=this;var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];data.forEach(function(systemData){var system=_this8.getSystemById(systemData.systemId);if(system){system.deserialize(systemData.data);}});return this;}},{key:"serialize",value:function serialize(){return this.systemsAsArray.map(function(system){return{systemId:system.id,data:system.serialize()};});}},{key:"endTurn",value:function endTurn(turn){this.getSystems().forEach(function(system){system.endTurn(turn);});}},{key:"advanceTurn",value:function advanceTurn(turn){this.getSystems().forEach(function(system){system.advanceTurn(turn);});this.power.advanceTurn(turn);return this;}},{key:"getRequiredPhasesForReceivingPlayerData",value:function getRequiredPhasesForReceivingPlayerData(){return this.getSystems().map(function(system){return system.callHandler("getRequiredPhasesForReceivingPlayerData",null,0);}).sort(function(a,b){if(a>b){return-1;}if(a<b){return 1;}return 0;})[0];}},{key:"receivePlayerData",value:function receivePlayerData(clientShip,gameData,phase){this.getSystems().forEach(function(system){if(phase>system.callHandler("getRequiredPhasesForReceivingPlayerData",null,1)){return;}system.callHandler("receivePlayerData",{clientShip:clientShip,clientSystem:clientShip.systems.getSystemById(system.id),gameData:gameData,phase:phase});});}},{key:"censorForUser",value:function censorForUser(user,mine){this.getSystems().forEach(function(system){system.callHandler("censorForUser",{user:user,mine:mine});});}},{key:"callAllSystemHandlers",value:function callAllSystemHandlers(name,payload){return this.getSystems().reduce(function(total,system){return[].concat(Object(toConsumableArray["a" /* default */])(total),Object(toConsumableArray["a" /* default */])([].concat(system.callHandler(name,payload))));},[]).filter(Boolean);}},{key:"getTotalHeat",value:function getTotalHeat(){return this.getSystems().reduce(function(total,system){return total+system.heat.getHeat();},0);}},{key:"getTotalHeatStorage",value:function getTotalHeatStorage(){return this.getSystems().reduce(function(total,system){return total+system.heat.getMaxHeatStoreCapacity();},0);}},{key:"getTotalHeatStored",value:function getTotalHeatStored(){return this.getSystems().filter(function(system){return system.heat.isHeatStorage();}).reduce(function(total,system){return total+system.heat.getHeat();},0);}},{key:"getPassiveHeatChange",value:function getPassiveHeatChange(){var producedAndTransferred=this.getSystems().reduce(function(total,system){var _system$heat$predictH=system.heat.predictHeatChange(),cooling=_system$heat$predictH.cooling;return total+cooling;},0);var heatRadiated=this.getSystems().reduce(function(total,system){return total+system.heat.getRadiateHeatCapacity();},0);return producedAndTransferred-heatRadiated;}}]);return ShipSystems;}();/* harmony default export */ var unit_ShipSystems = (ShipSystems_ShipSystems);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js + 2 modules
var wrapNativeSuper = __webpack_require__(153);

// CONCATENATED MODULE: ./src/model/electronicWarfare/electronicWarfareTypes.mjs
var EW_OFFENSIVE="oew";var EW_DEFENSIVE="dew";var EW_CC="ccew";var EW_OFFENSIVE_SUPPORT="soew";var EW_DEFENSIVE_SUPPORT="sdew";var EW_DISRUPTION="disew";var EW_AREA_DEFENSIVE_SUPPORT="adew";
// CONCATENATED MODULE: ./src/model/electronicWarfare/ElectronicWarfareEntry.mjs
var ElectronicWarfareEntry_ElectronicWarfareEntry=/*#__PURE__*/function(){function ElectronicWarfareEntry(type,targetShipId,amount){Object(classCallCheck["a" /* default */])(this,ElectronicWarfareEntry);this.deserialize({type:type,targetShipId:targetShipId,amount:amount});}Object(createClass["a" /* default */])(ElectronicWarfareEntry,[{key:"clone",value:function clone(){return new ElectronicWarfareEntry(this.type,this.targetShipId,this.amount);}},{key:"addAmount",value:function addAmount(amount){this.amount+=amount;}},{key:"getAmount",value:function getAmount(){return this.amount;}},{key:"getType",value:function getType(){return this.type;}},{key:"getActualPower",value:function getActualPower(){switch(this.type){case EW_OFFENSIVE:case EW_DEFENSIVE:case EW_CC:case EW_OFFENSIVE_SUPPORT:case EW_DEFENSIVE_SUPPORT:return this.amount;case EW_DISRUPTION:return this.amount/3;case EW_AREA_DEFENSIVE_SUPPORT:return this.amount/2.5;}}},{key:"getEfficiency",value:function getEfficiency(){switch(this.type){case EW_OFFENSIVE:case EW_DEFENSIVE:case EW_CC:case EW_OFFENSIVE_SUPPORT:case EW_DEFENSIVE_SUPPORT:return 1;case EW_DISRUPTION:return 3;case EW_AREA_DEFENSIVE_SUPPORT:return 2.5;}}},{key:"serialize",value:function serialize(){return{type:this.type,targetShipId:this.targetShipId,amount:this.amount};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.type=data.type;this.targetShipId=data.targetShipId;this.amount=data.amount;return this;}}]);return ElectronicWarfareEntry;}();/* harmony default export */ var electronicWarfare_ElectronicWarfareEntry = (ElectronicWarfareEntry_ElectronicWarfareEntry);
// CONCATENATED MODULE: ./src/model/unit/ShipCurrentElectronicWarfare.mjs
var ShipCurrentElectronicWarfare_ShipCurrentElectronicWarfare=/*#__PURE__*/function(){function ShipCurrentElectronicWarfare(dew,ccew,entries){Object(classCallCheck["a" /* default */])(this,ShipCurrentElectronicWarfare);this.dew=dew;this.ccew=ccew;this.entries=entries?entries.map(function(entry){return entry.clone();}):[];}Object(createClass["a" /* default */])(ShipCurrentElectronicWarfare,[{key:"serialize",value:function serialize(){return{dew:this.dew,ccew:this.ccew,entries:this.entries.map(function(entry){return entry.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.dew=data.dew||0;this.ccew=data.ccew||0;this.entries=data.entries?data.entries.map(function(entry){return new electronicWarfare_ElectronicWarfareEntry().deserialize(entry);}):[];return this;}},{key:"getDefensiveEw",value:function getDefensiveEw(){return this.dew;}},{key:"getCcEw",value:function getCcEw(){return this.ccew;}},{key:"getOffensiveEw",value:function getOffensiveEw(target){return this.getFromEntries(EW_OFFENSIVE,target);}},{key:"getAllOew",value:function getAllOew(){var combined=[];this.entries.filter(function(entry){return entry.getType()===EW_OFFENSIVE;}).forEach(function(entry){var existing=combined.find(function(combinedEntry){return combinedEntry.targetShipId===entry.targetShipId;});if(existing){existing.amount+=entry.amount;}else{combined.push(entry.clone());}});return combined;}},{key:"getFromEntries",value:function getFromEntries(type,target){if(target instanceof unit_Ship){target=target.id;}return this.entries.filter(function(entry){return entry.type===type&&entry.targetShipId===target;}).reduce(function(total,entry){return total+entry.getAmount();},0);}}]);return ShipCurrentElectronicWarfare;}();/* harmony default export */ var unit_ShipCurrentElectronicWarfare = (ShipCurrentElectronicWarfare_ShipCurrentElectronicWarfare);
// CONCATENATED MODULE: ./src/model/unit/ShipElectronicWarfare.mjs
var ShipElectronicWarfare_UnableToAssignEw=/*#__PURE__*/function(_Error){Object(inherits["a" /* default */])(UnableToAssignEw,_Error);function UnableToAssignEw(){Object(classCallCheck["a" /* default */])(this,UnableToAssignEw);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(UnableToAssignEw).apply(this,arguments));}return UnableToAssignEw;}(Object(wrapNativeSuper["a" /* default */])(Error));var ShipElectronicWarfare_ShipElectronicWarfare=/*#__PURE__*/function(){function ShipElectronicWarfare(ship){Object(classCallCheck["a" /* default */])(this,ShipElectronicWarfare);this.ship=ship;this.inEffect=new unit_ShipCurrentElectronicWarfare();}Object(createClass["a" /* default */])(ShipElectronicWarfare,[{key:"serialize",value:function serialize(){return this.inEffect.serialize();}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.inEffect.deserialize(data);return this;}},{key:"activatePlannedElectronicWarfare",value:function activatePlannedElectronicWarfare(){this.inEffect=new unit_ShipCurrentElectronicWarfare(this.getDefensiveEw(),this.getCcEw(),this.getAllEntries());}},{key:"canAssignCcEw",value:function canAssignCcEw(amount){return this.canAssignEw(EW_CC,this.ship.id,amount);}},{key:"assignCcEw",value:function assignCcEw(amount){this.assingEw(EW_CC,this.ship.id,amount);}},{key:"assignOffensiveEw",value:function assignOffensiveEw(target,amount){this.assingEw(EW_OFFENSIVE,target,amount);}},{key:"canAssignOffensiveEw",value:function canAssignOffensiveEw(target,amount){return this.canAssignEw(EW_OFFENSIVE,target,amount);}},{key:"getCcEw",value:function getCcEw(){return this.getEw(EW_CC,this.ship.id);}},{key:"getDefensiveEw",value:function getDefensiveEw(){return this.getEw(EW_DEFENSIVE);}},{key:"getOffensiveEw",value:function getOffensiveEw(target){return this.getEw(EW_OFFENSIVE,target);}},{key:"getEw",value:function getEw(type,target){if(target&&target instanceof unit_Ship){target=target.id;}if(type===EW_DEFENSIVE){return this.getEwArrays().reduce(function(total,system){return total+system.callHandler("getTotalEwUsedByType",type);},0);}var result=this.getAllEntries().filter(function(entry){return entry.type===type&&entry.targetShipId===target;}).reduce(function(total,entry){return total+entry.getAmount();},0);return result;}},{key:"assingEw",value:function assingEw(type,target,amount){if(target&&target instanceof unit_Ship){target=target.id;}var entries=this.getAllEntries();entries.push(new electronicWarfare_ElectronicWarfareEntry(type,target,amount));this.assignEntries(entries);}},{key:"canAssignEw",value:function canAssignEw(type,target,amount){var entries=this.getAllEntries();try{this.assingEw(type,target,amount);this.assignEntries(entries);return true;}catch(e){if(e instanceof ShipElectronicWarfare_UnableToAssignEw){this.assignEntries(entries);return false;}throw e;}}},{key:"getAllOew",value:function getAllOew(){var combined=[];this.getEwArrays().reduce(function(all,system){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(system.callHandler("getEwEntries")));},[]).filter(function(entry){return entry.getType()===EW_OFFENSIVE;}).forEach(function(entry){var existing=combined.find(function(combinedEntry){return combinedEntry.targetShipId===entry.targetShipId;});if(existing){existing.amount+=entry.amount;}else{combined.push(entry.clone());}});return combined;}},{key:"getAllEntries",value:function getAllEntries(){return this.getEwArrays().reduce(function(all,system){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(system.callHandler("getEwEntries")));},[]);}},{key:"getEwArrays",value:function getEwArrays(){return this.ship.systems.getSystems().filter(function(system){return system.callHandler("isEwArray");});}},{key:"repeatElectonicWarfare",value:function repeatElectonicWarfare(){this.assignEntries(this.getAllEntries(),true);}},{key:"removeAll",value:function removeAll(){this.getEwArrays().forEach(function(system){return system.callHandler("resetEw");});}},{key:"assignEntries",value:function assignEntries(entries){var _this=this;var allowIncomplete=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.removeAll();var negativeEntries=entries.filter(function(entry){return entry.getAmount()<0;});entries.filter(function(entry){return entry.getAmount()>0;}).sort(function(a,b){if(a.type===EW_OFFENSIVE&&b.type!==EW_OFFENSIVE){return 1;}if(a.type!==EW_OFFENSIVE&&b.type===EW_OFFENSIVE){return-1;}return 0;}).map(function(entry){negativeEntries.filter(function(negativeEntry){return negativeEntry.type===entry.type&&negativeEntry.targetShipId===entry.targetShipId;}).forEach(function(negativeEntry){if(entry.getAmount()>=Math.abs(negativeEntry.getAmount())){entry.amount+=negativeEntry.getAmount();negativeEntry.amount=0;}else if(Math.abs(negativeEntry.getAmount())>entry.getAmount()){negativeEntry.amount+=entry.getAmount();entry.amount=0;}});return entry;}).filter(function(entry){return entry.getAmount()!==0;}).forEach(function(entry){return _this.assignPositiveEW(entry,allowIncomplete);});if(negativeEntries.some(function(entry){return entry.getAmount()!==0;})){throw new ShipElectronicWarfare_UnableToAssignEw("Invalid EW, negative entries left");}}},{key:"assignPositiveEW",value:function assignPositiveEW(entry,allowIncomplete){var amount=entry.getAmount();while(amount>0){var availableSystems=this.getAvailableSystemsForEntry(entry);if(availableSystems.length===0){if(allowIncomplete){return;}else{throw new ShipElectronicWarfare_UnableToAssignEw("Invalid EW");}}availableSystems.shift().callHandler("assignEw",{type:entry.type,target:entry.targetShipId,amount:1});amount--;}}},{key:"getAvailableSystemsForEntry",value:function getAvailableSystemsForEntry(entry){return this.getEwArrays().filter(function(system){return system.callHandler("canUseEw",{type:entry.type,amount:1});}).sort(function(a,b){var aValidTypes=a.callHandler("getValidEwTypes");var bValidTypes=b.callHandler("getValidEwTypes");if(aValidTypes.length>bValidTypes.length){return-1;}else if(aValidTypes.length<bValidTypes.length){return 1;}return 0;});}}]);return ShipElectronicWarfare;}();/* harmony default export */ var unit_ShipElectronicWarfare = (ShipElectronicWarfare_ShipElectronicWarfare);
// CONCATENATED MODULE: ./src/model/User.mjs
var User_User=/*#__PURE__*/function(){function User(id,username){var accessLevel=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;Object(classCallCheck["a" /* default */])(this,User);this.id=id;this.username=username;this.accessLevel=accessLevel;}Object(createClass["a" /* default */])(User,[{key:"serialize",value:function serialize(){return{id:this.id,username:this.username,accessLevel:this.accessLevel};}},{key:"deserialize",value:function deserialize(data){this.id=data.id;this.username=data.username;this.accessLevel=data.accessLevel;return this;}}]);return User;}();/* harmony default export */ var model_User = (User_User);
// CONCATENATED MODULE: ./src/model/unit/ShipPlayer.mjs
var ShipPlayer_ShipPlayer=/*#__PURE__*/function(){function ShipPlayer(){Object(classCallCheck["a" /* default */])(this,ShipPlayer);this.user=null;}Object(createClass["a" /* default */])(ShipPlayer,[{key:"is",value:function is(user){return user&&this.user.id===user.id;}},{key:"setUser",value:function setUser(user){this.user=user;}},{key:"isUsers",value:function isUsers(user){return user&&this.user&&this.user.id===user.id;}},{key:"deserialize",value:function deserialize(user){this.user=user?new model_User().deserialize(user):undefined;return this;}},{key:"serialize",value:function serialize(){return this.user?this.user.serialize():undefined;}}]);return ShipPlayer;}();/* harmony default export */ var unit_ShipPlayer = (ShipPlayer_ShipPlayer);
// CONCATENATED MODULE: ./src/model/unit/ShipMovement.mjs
var ShipMovement_ShipMovement=/*#__PURE__*/function(){function ShipMovement(ship){Object(classCallCheck["a" /* default */])(this,ShipMovement);this.ship=ship;this.moves=[];}Object(createClass["a" /* default */])(ShipMovement,[{key:"addMovement",value:function addMovement(move){this.moves.push(move.clone());this.buildIndex();}},{key:"removeMovement",value:function removeMovement(move){var toDelete=this.moves.find(function(other){return other.equals(move);});this.moves=this.moves.filter(function(other){return other!==toDelete;});this.buildIndex();}},{key:"replaceLastMove",value:function replaceLastMove(move){this.moves[this.moves.length-1]=move;this.buildIndex();}},{key:"removeMovementExceptEnd",value:function removeMovementExceptEnd(turn){this.moves=this.moves.filter(function(move){return move.turn<turn||move.isEnd()||move.isDeploy()||move.isStart();});this.buildIndex();}},{key:"removeMovementForTurn",value:function removeMovementForTurn(turn){this.moves=this.moves.filter(function(move){return move.turn<turn||move.isStart();});this.buildIndex();}},{key:"removeMovementForOtherTurns",value:function removeMovementForOtherTurns(turn){this.moves=this.moves.filter(function(move){return move.turn===turn;});this.buildIndex();}},{key:"getMovement",value:function getMovement(){return this.moves.map(function(move){return move.clone();});}},{key:"getPlayerAddedMovement",value:function getPlayerAddedMovement(){return this.moves.filter(function(move){return move.isPlayerAdded();}).map(function(move){return move.clone();});}},{key:"getLastMove",value:function getLastMove(){if(this.moves.length===0){return null;}return this.moves[this.moves.length-1].clone();}},{key:"getStartMove",value:function getStartMove(){var start=this.moves.find(function(move){return move.isStart();});if(!start){return null;}return start.clone();}},{key:"getDeployMove",value:function getDeployMove(){var deploy=this.moves.find(function(move){return move.isDeploy();});if(!deploy){return null;}return deploy.clone();}},{key:"replaceDeployMove",value:function replaceDeployMove(newMove){this.moves=this.moves.map(function(move){if(move.isDeploy()){return newMove;}else{return move.clone();}});}},{key:"replaceMovement",value:function replaceMovement(newMovement){this.moves=[].concat(Object(toConsumableArray["a" /* default */])(this.moves.filter(function(move){return!move.isPlayerAdded();})),Object(toConsumableArray["a" /* default */])(newMovement.filter(function(move){return move.isPlayerAdded();})));this.moves=this.moves.map(function(move){return move.clone();});this.buildIndex();}},{key:"buildIndex",value:function buildIndex(){var _this=this;var lastIndex=null;this.moves.forEach(function(move){if(lastIndex===null&&(move.isEnd()||move.isStart()||move.isDeploy())&&move.index!==0){lastIndex=move.index;}else if(lastIndex!==null){lastIndex++;move.index=lastIndex;}});this.ship.systems.callAllSystemHandlers("resetChanneledThrust");this.moves.forEach(function(move){var fulfilments=move.requiredThrust.getFulfilments();fulfilments.forEach(function(fulfilment){fulfilment.forEach(function(_ref){var amount=_ref.amount,thrusterId=_ref.thrusterId;_this.ship.systems.getSystemById(thrusterId).callHandler("addChanneledThrust",amount);});});});}},{key:"getLastEndMove",value:function getLastEndMove(){var end=this.moves.slice().reverse().find(function(move){return move.isEnd();});if(!end){return null;}return end.clone();}},{key:"getLastEndMoveOrSurrogate",value:function getLastEndMoveOrSurrogate(){var end=this.getLastEndMove();if(!end){var deploy=this.getDeployMove();if(!deploy){var start=this.getStartMove();return start;}return deploy;}return end;}},{key:"getEvadeMove",value:function getEvadeMove(){var move=this.moves.find(function(move){return move.isEvade();});if(!move){return null;}return move.clone();}},{key:"isRolled",value:function isRolled(){var end=this.getLastEndMoveOrSurrogate();return end.rolled;}},{key:"isRolling",value:function isRolling(){return this.getRollMove();}},{key:"getRollMove",value:function getRollMove(){var move=this.moves.find(function(move){return move.isRoll();});if(!move){return null;}return move.clone();}},{key:"getEvasion",value:function getEvasion(){var move=this.getEvadeMove();if(!move){return 0;}return move.value;}},{key:"getActiveEvasion",value:function getActiveEvasion(){var move=this.getLastEndMoveOrSurrogate();if(!move){return 0;}return move.evasion;}},{key:"getThrustOutput",value:function getThrustOutput(){return this.ship.systems.getSystems().reduce(function(acc,system){return system.callHandler("getThrustOutput",null,acc);},0);}},{key:"getThrustRequired",value:function getThrustRequired(){return this.moves.filter(function(move){return move.requiredThrust;}).reduce(function(total,move){return total+move.requiredThrust.getTotalAmountRequired();},0);}},{key:"getRemainingThrustOutput",value:function getRemainingThrustOutput(){return this.getThrustOutput()-this.getThrustRequired();}},{key:"getThrusters",value:function getThrusters(){return this.ship.systems.getSystems().filter(function(system){return system.callHandler("isThruster");}).filter(function(system){return!system.isDisabled();});}},{key:"getMaxEvasion",value:function getMaxEvasion(){return this.ship.systems.getSystems().reduce(function(acc,system){return system.callHandler("getMaxEvasion",null,acc);},0);}},{key:"isOverlapping",value:function isOverlapping(otherShip){var shipPosition=this.ship.getHexPosition();var shipFacing=this.ship.getFacing();var otherShipPosition=otherShip.getHexPosition();var otherShipFacing=otherShip.getFacing();return this.ship.hexSizes.some(function(hex){return otherShip.hexSizes.some(function(otherHex){return shipPosition.add(hex.rotate(shipFacing)).equals(otherShipPosition.add(otherHex.rotate(otherShipFacing)));});});}},{key:"hasValidMovement",value:function hasValidMovement(){var bill=new movement_ThrustBill(this.ship,this.getMovement());var result=bill.pay();return result;}},{key:"revertMovementsUntilValidMovement",value:function revertMovementsUntilValidMovement(){var _this2=this;var canRevert=function canRevert(){return _this2.getMovement().some(function(move){return move.isPlayerAdded();});};while(true){if(this.hasValidMovement()){var bill=new movement_ThrustBill(this.ship,this.getMovement());bill.pay();var newMovement=bill.getMoves();this.ship.movement.replaceMovement(newMovement);return;}if(!canRevert()){throw new Error("Ship does not have valid movement, but can not revert either");}this.removeMovement(this.getMovement().filter(function(move){return move.isCancellable();}).pop());}}},{key:"applyRoll",value:function applyRoll(){var endMove=this.getLastEndMove();var rollMove=this.getRollMove();if(rollMove){endMove.rolled=!endMove.rolled;}this.replaceLastMove(endMove);}},{key:"getFuel",value:function getFuel(){return this.ship.systems.getSystems().reduce(function(all,system){return all+system.callHandler("getFuel",null,0);},0);}},{key:"getFuelSpace",value:function getFuelSpace(){return this.ship.systems.getSystems().reduce(function(all,system){return all+system.callHandler("getFuelSpace",null,0);},0);}},{key:"getFuelCost",value:function getFuelCost(){return this.ship.systems.getSystems().reduce(function(all,system){return all+system.callHandler("getFuelRequirement",null,0);},0);}},{key:"payFuelCost",value:function payFuelCost(){var _this3=this;var shipFuel=this.getFuel();var fuelCost=this.getFuelCost();var paid=0;if(fuelCost>shipFuel){throw new Error("Unable to pay fuel cost. This should not happen since moves should be validated!:E");}var payFuel=function payFuel(){var tank=_this3.ship.systems.getSystems().filter(function(system){return system.callHandler("getFuel",null,0)>0;}).sort(function(a,b){var aFuel=a.callHandler("getFuel",null,0);var bFuel=b.callHandler("getFuel",null,0);if(aFuel>bFuel){return 1;}if(aFuel<bFuel){return-1;}return 0;}).pop();if(!tank){throw new Error("Unable to pay fuel cost. This should not happen since moves should be validated!:E");}tank.callHandler("takeFuel",1);};while(paid<fuelCost){payFuel();paid++;}}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.moves=data.map(function(moveData){return new movement_MovementOrder().deserialize(moveData);});return this;}},{key:"serialize",value:function serialize(){return this.moves.map(function(move){return move.serialize();});}}]);return ShipMovement;}();/* harmony default export */ var unit_ShipMovement = (ShipMovement_ShipMovement);
// CONCATENATED MODULE: ./src/model/unit/Ship.mjs
var Ship_Ship=/*#__PURE__*/function(){function Ship(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(classCallCheck["a" /* default */])(this,Ship);this.systems=new unit_ShipSystems(this);this.pointCost=0;this.accelcost=1;this.rollcost=1;this.pivotcost=1;this.maxPivots=null;this.evasioncost=1;this.frontHitProfile=30;this.sideHitProfile=50;this.hexSizes=[];this.shipModel=null;this.shipTypeName="";this.setShipProperties();this.deserialize(data);}Object(createClass["a" /* default */])(Ship,[{key:"setShipProperties",value:function setShipProperties(){}},{key:"getFrontHitProfile",value:function getFrontHitProfile(){return this.frontHitProfile+this.systems.callAllSystemHandlers("getHitProfile",{front:true}).reduce(function(total,entry){return total+entry;},0);}},{key:"getSideHitProfile",value:function getSideHitProfile(){return this.sideHitProfile+this.systems.callAllSystemHandlers("getHitProfile",{front:false}).reduce(function(total,entry){return total+entry;},0);}},{key:"getHitProfile",value:function getHitProfile(position){var heading=addToDirection(getCompassHeadingOfPoint(this.getPosition(),position),-hexFacingToAngle(this.getFacing()));if(heading>=330||heading<=30||heading>=150&&heading<=210){return this.getFrontHitProfile();}else{return this.getSideHitProfile();}}},{key:"getPointCost",value:function getPointCost(){return this.pointCost;}},{key:"getFacing",value:function getFacing(){var lastMove=this.movement.getLastEndMoveOrSurrogate();if(!lastMove){return null;}return lastMove.getFacing();}},{key:"getPosition",value:function getPosition(){var lastMove=this.movement.getLastEndMoveOrSurrogate();if(!lastMove){return null;}return lastMove.getPosition();}},{key:"getHexPosition",value:function getHexPosition(){return utils_CoordinateConverter.fromGameToHex(this.getPosition());}},{key:"distanceTo",value:function distanceTo(target){return this.getPosition().distanceTo(target.getPosition());}},{key:"hexDistanceTo",value:function hexDistanceTo(target){return this.getHexPosition().distanceTo(target.getHexPosition());}},{key:"getVelocity",value:function getVelocity(){var lastMove=this.movement.getLastEndMoveOrSurrogate();if(!lastMove){return null;}return lastMove.getVelocity();}},{key:"getIconHexas",value:function getIconHexas(){var hexFacing=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return this.hexSizes.map(function(hex){return hex.rotate(hexFacing);});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var shipData=data.shipData||{};this.id=data.id||null;this.name=data.name||"Unnamed ship ";this.shipClass=this.constructor.name;this.slotId=data.slotId||null;this.systems.deserialize(shipData.systems);this.player=new unit_ShipPlayer(this).deserialize(shipData.player);this.movement=new unit_ShipMovement(this).deserialize(data.movement);this.electronicWarfare=new unit_ShipElectronicWarfare(this).deserialize(shipData.electronicWarfare);this.destroyedThisTurn=shipData.destroyedThisTurn||false;return this;}},{key:"serialize",value:function serialize(){/*
    NOTE: shipData gets serialized normally. Everything else has custom handling
    If you want to serialize something, serialize it inside of shipData
    (This is like the fifth time I am wondering why stuff doesnt get serialized:P)  
    */return{id:this.id,gameId:this.gameId,name:this.name,shipClass:this.shipClass,slotId:this.slotId,movement:this.movement.serialize(),shipData:{systems:this.systems.serialize(),player:this.player.serialize(),electronicWarfare:this.electronicWarfare.serialize(),destroyedThisTurn:this.destroyedThisTurn}};}},{key:"isDestroyed",value:function isDestroyed(){return this.systems.isDestroyed();}},{key:"isDestroyedThisTurn",value:function isDestroyedThisTurn(){return this.destroyedThisTurn;}},{key:"markDestroyedThisTurn",value:function markDestroyedThisTurn(){this.destroyedThisTurn=true;}},{key:"censorForUser",value:function censorForUser(user,mine){if(!mine){this.movement.removeMovementExceptEnd(this.turn);}this.systems.censorForUser(user,mine);}},{key:"endTurn",value:function endTurn(turn){this.systems.endTurn(turn);}},{key:"advanceTurn",value:function advanceTurn(turn){this.movement.removeMovementForOtherTurns(turn);this.systems.advanceTurn(turn);this.electronicWarfare.activatePlannedElectronicWarfare();this.electronicWarfare.removeAll();this.destroyedThisTurn=false;return this;}},{key:"getRequiredPhasesForReceivingPlayerData",value:function getRequiredPhasesForReceivingPlayerData(){return this.systems.getRequiredPhasesForReceivingPlayerData();}},{key:"receivePlayerData",value:function receivePlayerData(clientShip,gameData,phase){this.systems.receivePlayerData(clientShip,gameData,phase);}},{key:"setShipLoadout",value:function setShipLoadout(){this.systems.callAllSystemHandlers("onGameStart");this.systems.callAllSystemHandlers("loadTargetInstant");this.systems.callAllSystemHandlers("setMaxFuel");}}]);return Ship;}();/* harmony default export */ var unit_Ship = (Ship_Ship);
// CONCATENATED MODULE: ./src/model/weapon/FireOrder.mjs
var FireOrder_FireOrder=/*#__PURE__*/function(){function FireOrder(shooterId,targetId,weaponId){var weaponSettigs=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};Object(classCallCheck["a" /* default */])(this,FireOrder);this.id=null;this.shooterId=shooterId instanceof unit_Ship?shooterId.id:shooterId;this.targetId=shooterId instanceof unit_Ship?targetId.id:targetId;this.weaponId=weaponId instanceof system_ShipSystem?weaponId.id:weaponId;this.weaponSettigs=weaponSettigs;this.resolved=false;}Object(createClass["a" /* default */])(FireOrder,[{key:"setId",value:function setId(id){this.id=id;return this;}},{key:"setResolved",value:function setResolved(){this.resolved=true;return this;}},{key:"serialize",value:function serialize(){return{id:this.id,shooterId:this.shooterId,targetId:this.targetId,weaponId:this.weaponId,weaponSettigs:this.weaponSettigs,resolved:this.resolved};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.id=data.id||null;this.shooterId=data.shooterId;this.targetId=data.targetId;this.weaponId=data.weaponId;this.weaponSettigs=data.weaponSettigs||{};this.resolved=data.resolved;return this;}}]);return FireOrder;}();/* harmony default export */ var weapon_FireOrder = (FireOrder_FireOrder);
// CONCATENATED MODULE: ./src/model/weapon/WeaponFireService.mjs
var WeaponFireService_WeaponFireService=/*#__PURE__*/function(){function WeaponFireService(){Object(classCallCheck["a" /* default */])(this,WeaponFireService);this.gamedata=null;}Object(createClass["a" /* default */])(WeaponFireService,[{key:"update",value:function update(gamedata){this.gamedata=gamedata;return this;}},{key:"getAllFireOrders",value:function getAllFireOrders(){var _this=this;return this.gamedata.ships.getShips().reduce(function(all,ship){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(_this.getAllFireOrdersForShip(ship)));},[]);}},{key:"getFireOrderById",value:function getFireOrderById(id){return this.getAllFireOrders().find(function(order){return order.id===id;});}},{key:"getAllFireOrdersForShip",value:function getAllFireOrdersForShip(shooter){return shooter.systems.getSystems().reduce(function(all,system){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(system.callHandler("getFireOrders",{},[])));},[]);}},{key:"systemHasFireOrder",value:function systemHasFireOrder(system){var fireOrders=system.callHandler("getFireOrders");return fireOrders&&fireOrders.length>0;}},{key:"getSystemFireOrderTargetId",value:function getSystemFireOrderTargetId(system){var fireOrders=system.callHandler("getFireOrders");return fireOrders&&fireOrders.length>0?fireOrders[0].targetId:null;}},{key:"systemHasFireOrderAgainstShip",value:function systemHasFireOrderAgainstShip(system,target){var fireOrders=system.callHandler("getFireOrders",null,[]);return fireOrders.some(function(order){return order.targetId===target.id;});}},{key:"addFireOrder",value:function addFireOrder(shooter,target,weapon){if(!this.canFire(shooter,target,weapon)){throw new Error("Check validity first");}return weapon.callHandler("addFireOrder",{shooter:shooter,target:target});}},{key:"removeFireOrders",value:function removeFireOrders(shooter,weapon){weapon.callHandler("removeFireOrders");}},{key:"canFire",value:function canFire(shooter,target,weapon){if(shooter.isDestroyed()||target.isDestroyed()||weapon.isDisabled()||!weapon.callHandler("usesFireOrders",null,false)){return false;}if(!weapon.callHandler("isOnArc",{target:target},true)){return false;}if(!weapon.callHandler("canFire",null,true)){return false;}return true;}}]);return WeaponFireService;}();/* harmony default export */ var weapon_WeaponFireService = (WeaponFireService_WeaponFireService);
// CONCATENATED MODULE: ./src/client/view/game/phase/PhaseState.js
var PhaseState_PhaseState=/*#__PURE__*/function(){function PhaseState(){Object(classCallCheck["a" /* default */])(this,PhaseState);this.state={};}Object(createClass["a" /* default */])(PhaseState,[{key:"set",value:function set(key,payload){this.state[key]=payload;}},{key:"get",value:function get(key){return this.state[key];}}]);return PhaseState;}();/* harmony default export */ var phase_PhaseState = (PhaseState_PhaseState);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js
var regenerator = __webpack_require__(9);
var regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);

// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
var asyncToGenerator = __webpack_require__(12);

// EXTERNAL MODULE: ./node_modules/three/build/three.module.js
var three_module = __webpack_require__(6);

// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/starVertexShader.js
var starVertexShader="\n    attribute vec3 color;\n    attribute float opacity;\n    attribute float size;\n    attribute float sizeChange;\n    attribute float angle;\n    attribute float angleChange;\n    attribute float activationGameTime;\n    attribute float textureNumber;\n    attribute float parallaxFactor;\n    attribute float sineFrequency;\n    attribute float sineAmplitude;\n    uniform float gameTime;\n    varying vec4  vColor;\n    varying float vAngle;\n    varying float textureN;\n    void main()\n    {\n    \n        float elapsedTime = gameTime - activationGameTime;\n\n        if (elapsedTime < 0.0) {\n            gl_PointSize = 0.0;\n            gl_Position = vec4( 0.0, 0.0, 0.0, 1.0 );\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\n            textureN = textureNumber;\n            return;\n        }\n        \n\n        float currentOpacity = opacity;\n        if (sineFrequency > 0.0) {\n            currentOpacity = opacity + (sineAmplitude * 0.5 * sin(gameTime/sineFrequency) + sineAmplitude);\n        }\n\n        if ( currentOpacity > 0.0 && elapsedTime >= 0.0)\n        {\n            vColor = vec4( color, currentOpacity );\n        } else {\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n\n        vAngle = angle + angleChange * elapsedTime;\n        textureN = textureNumber;\n\n        vec3 modPos = vec3( position.x - (cameraPosition.x * parallaxFactor), position.y - (cameraPosition.y * parallaxFactor), position.z );\n\n\n        gl_PointSize = clamp(size + (sizeChange * elapsedTime), 0.0, 1024.0);\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( modPos, 1.0 );\n        \n    }\n";/* harmony default export */ var shader_starVertexShader = (starVertexShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/starFragmentShader.js
var starFragmentShader="\n    uniform sampler2D texture;\n    varying vec4 vColor;\n    varying float vAngle;\n    varying float textureN;\n    void main()\n    {\n        gl_FragColor = vColor;\n        if (gl_FragColor.a == 0.0) {\n            return;\n        }\n\n        float c = cos(vAngle);\n        float s = sin(vAngle);\n        float textureAmount = 8.0;\n        vec2 tPos = vec2((mod(textureN, textureAmount) * (1.0 / textureAmount)), (floor(textureN / textureAmount) * (1.0 / textureAmount)));\n\n        vec2 pos = vec2(gl_PointCoord.x, gl_PointCoord.y);\n        vec2 tCen = vec2(0.5, 0.5);\n\n        vec2 rPos = vec2(\n            tCen.x + c * (pos.x - tCen.x) - s * (pos.y - tCen.y),\n            tCen.y + s * (pos.x - tCen.x) + c * (pos.y - tCen.y)\n        );\n\n        rPos = clamp(rPos, 0.0, 1.0);\n\n        vec2 finalPos = vec2(\n            (rPos.x / textureAmount + tPos.x),\n            1.0 - (rPos.y / textureAmount + tPos.y)\n        );\n\n        vec4 rotatedTexture = texture2D(texture, finalPos);\n        gl_FragColor = gl_FragColor * rotatedTexture;\n    }\n";/* harmony default export */ var shader_starFragmentShader = (starFragmentShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/effectVertexShader.js
var effectVertexShader="\n    attribute vec3 color;\n    attribute float opacity;\n    attribute float fadeInTime;\n    attribute float fadeInSpeed;\n    attribute float fadeOutTime;\n    attribute float fadeOutSpeed;\n    attribute float size;\n    attribute float sizeChange;\n    attribute float angle;\n    attribute vec3 velocity;\n    attribute vec3 acceleration;\n    attribute float activationGameTime;\n    attribute float textureNumber;\n    attribute float sine;\n    attribute float repeat;\n    uniform float zoomLevel;\n    uniform float gameTime;\n    varying vec4  vColor;\n    varying float vAngle;\n    varying float textureN;\n\n\n    //500432\n    vec2 getAngleAndChange() {\n        float finalChange = floor(angle / 10000.0) / 1000.0;\n        float finalAngle = (angle - floor(angle / 10000.0) * 10000.0) / 1000.0;\n\n        return vec2(finalAngle, finalChange);\n    }\n\n    void main()\n    {\n        float modGameTime = gameTime;\n        if (repeat > 0.0) {\n            modGameTime = gameTime - (repeat * floor(gameTime/repeat));\n        }\n\n        float elapsedTime = modGameTime - activationGameTime;\n\n        if (elapsedTime < 0.0 || (fadeOutTime > 0.0 && modGameTime - (fadeOutTime + fadeOutSpeed) > 0.0)) {\n            gl_PointSize = 0.0;\n            gl_Position = vec4( 0.0, 0.0, 0.0, 1.0 );\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\n            textureN = textureNumber;\n            return;\n        }\n\n        float currentOpacity = 0.0;\n        if (fadeInSpeed == 0.0) {\n            currentOpacity = opacity;\n        }\n\n\n        if (fadeInSpeed > 0.0 && modGameTime > fadeInTime)\n        {\n            float fadeIn = (modGameTime - fadeInTime) / fadeInSpeed;\n        if (fadeIn > 1.0) fadeIn = 1.0;\n            currentOpacity =  opacity * fadeIn;\n        }\n\n        if (fadeOutSpeed > 0.0 && modGameTime > fadeOutTime)\n        {\n            float fadeOut = (modGameTime - fadeOutTime) / fadeOutSpeed;\n        if (fadeOut > 1.0) fadeOut = 1.0;\n            currentOpacity =  currentOpacity * (1.0 - fadeOut);\n        }\n\n        if ( currentOpacity > 0.0 && elapsedTime >= 0.0)\n        {\n            float sineAmplitude = sine - floor(sine);\n            float sineFrequency = floor(sine);\n\n            if (sineFrequency > 0.0) {\n                currentOpacity *= (sineAmplitude * 0.5 * sin(elapsedTime/sineFrequency) + sineAmplitude);\n            }\n            \n            vColor = vec4( color, currentOpacity );\n        } else {\n            vColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n\n        vec2 angleData = getAngleAndChange();\n        vAngle = angleData.x + angleData.y * elapsedTime;\n        textureN = textureNumber;\n\n        vec3 displacement = velocity * elapsedTime;\n        vec3 accelerationDisplacement  = elapsedTime * elapsedTime * 0.5 * acceleration;\n\n        vec3 modPos = position + displacement + accelerationDisplacement;\n\n\n        gl_PointSize = clamp(size + (sizeChange * elapsedTime), 0.0, 1024.0) * zoomLevel;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( modPos, 1.0 );\n    }\n";/* harmony default export */ var shader_effectVertexShader = (effectVertexShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/effectFragmentShader.js
var effectFragmentShader="\n    uniform sampler2D texture;\n    varying vec4 vColor;\n    varying float vAngle;\n    varying float textureN;\n    void main()\n    {\n        gl_FragColor = vColor;\n        if (gl_FragColor.a == 0.0) {\n            return;\n        }\n\n        float c = cos(vAngle);\n        float s = sin(vAngle);\n        float textureAmount = 8.0;\n        vec2 tPos = vec2((mod(textureN, textureAmount) * (1.0 / textureAmount)), (floor(textureN / textureAmount) * (1.0 / textureAmount)));\n\n        vec2 pos = vec2(gl_PointCoord.x, gl_PointCoord.y);\n        vec2 tCen = vec2(0.5, 0.5);\n\n        vec2 rPos = vec2(\n            tCen.x + c * (pos.x - tCen.x) - s * (pos.y - tCen.y),\n            tCen.y + s * (pos.x - tCen.x) + c * (pos.y - tCen.y)\n        );\n\n        rPos = clamp(rPos, 0.0, 1.0);\n\n        vec2 finalPos = vec2(\n            (rPos.x / textureAmount + tPos.x),\n            1.0 - (rPos.y / textureAmount + tPos.y)\n        );\n\n        vec4 rotatedTexture = texture2D(texture, finalPos);\n        gl_FragColor = gl_FragColor * rotatedTexture;\n    }\n";/* harmony default export */ var shader_effectFragmentShader = (effectFragmentShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/spriteFragmentShader.js
var spriteFragmentShader="\n    uniform sampler2D texture;\n    uniform float overlayAlpha;\n    uniform vec3 overlayColor;\n    uniform float opacity;\n\n    varying vec2 vUv;\n\n    void main() {\n        vec4 textureColor = texture2D(texture, vUv);\n        vec4 finalColor = textureColor;\n\n        if (overlayAlpha > 0.0 && textureColor.a > 0.0){\n            //finalColor = vec4(overlayColor, textureColor.a);\n            //finalColor = mix(textureColor, overlayColor, overlayAlpha);\n            //finalColor = (1.0 - t1.a) * t0 + t1.a * t1;\n            finalColor = (1.0 - overlayAlpha) * textureColor + overlayAlpha * vec4(overlayColor, 1.0);\n            finalColor.a = textureColor.a;\n        }\n\n        if (finalColor.a > 0.0) {\n            finalColor.a *= opacity;\n        }\n\n        gl_FragColor = finalColor;\n    }\n";/* harmony default export */ var shader_spriteFragmentShader = (spriteFragmentShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/spriteVertexShader.js
var spriteVertexShader="\n    varying vec2 vUv;\n\n    void main() {\n        vUv = uv;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n    }\n";/* harmony default export */ var shader_spriteVertexShader = (spriteVertexShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/lineFragmentShader.js
var lineFragmentShader="\n\n    uniform float time;\n    varying vec3 vColor;\n    varying vec2 vUv;\n    varying float vOpacity;\n    varying float vDashRatio;\n    varying vec2 vPulse;\n\n    vec4 getPulse(vec4 color) {\n        float pulseAmount = vPulse.x;\n        float pulseSpeed = vPulse.y;\n\n        if (pulseAmount == 0.0 || pulseSpeed == 0.0) {\n            return color;\n        }\n\n        float pulseTime = mod(time * pulseSpeed, 1.0);\n        float y = mod(vUv.y * pulseAmount, 1.0);\n   \n        float diff = y - pulseTime;\n        if (diff < 0.0) {\n            diff = 1.0 + diff;\n        }\n\n        if (diff > 0.9) {\n            diff = 1.0 - ((diff - 0.9) * 10.0);\n        }\n    \n        color += diff * 0.1;\n\n        return color;\n    }\n\n    vec4 blendSides(vec4 color) {\n        float treshold = 0.4;\n        if (vUv.x < treshold) {\n            color.a *= vUv.x * 1.0 / treshold;\n        } else if (vUv.x > 1.0 - treshold) {\n            color.a *= (1.0 - vUv.x) * 1.0 / treshold;;\n        }\n\n        return color;\n    }\n\n    vec4 getDashedColor(vec4 color) {\n\n        if (vDashRatio == 0.0) {\n            return color;\n        }\n\n        float y = vUv.y;\n\n        if ( mod(floor(y * 10.0 / (vDashRatio * 10.0)), 2.0) == 0.0 ) {\n            discard;\n        }\n\n        float modulus = mod(y, vDashRatio) / vDashRatio;\n        if (modulus < 0.2) {\n            color.a *= modulus * 5.0;\n        } else if (modulus > 0.8) {\n            color.a *= (1.0 - modulus) * 5.0;\n        }\n\n        return color;\n    }\n\n    void main() {\n        vec4 finalColor = vec4(vColor, 1.0);\n\n        if (finalColor.a > 0.0) {\n            finalColor.a *= vOpacity;\n        }\n\n        finalColor = getDashedColor(finalColor);\n        finalColor = blendSides(finalColor);\n        finalColor = getPulse(finalColor);\n       \n        gl_FragColor = finalColor; \n    }\n";/* harmony default export */ var shader_lineFragmentShader = (lineFragmentShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/lineVertexShader.js
var lineVertexShader="\n\n    attribute vec3 color;\n    attribute float opacity;\n    attribute float dashRatio;\n    attribute vec2 pulse;\n    varying float vOpacity;\n    varying vec3 vColor;\n    varying vec2 vUv;\n    varying float vDashRatio;\n    varying vec2 vPulse;\n\n    void main() {\n        vUv = uv;\n        vColor = color;\n        vPulse = pulse;\n        vOpacity = opacity;\n        vDashRatio = dashRatio;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n    }\n";/* harmony default export */ var shader_lineVertexShader = (lineVertexShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/boltVertexShader.js
var boltVertexShader="\n    precision highp float;\n    uniform mat4 modelMatrix;\n    uniform mat4 viewMatrix;\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n    uniform float gameTime;\n    uniform float zoomLevel;\n    attribute vec3 position;\n    attribute vec3 offset;\n    attribute float opacity;\n    attribute vec2 uv;\n    attribute float textureNumber;\n    attribute vec3 scale;\n    attribute vec4 quaternion;\n    attribute vec3 color;\n    attribute vec3 velocity;\n    attribute float activationGameTime;\n    attribute float deactivationGameTime;\n    attribute float deactivationFade;\n    attribute float repeat;\n    varying float vActivationGameTime;\n    varying float vDeactivationGameTime;\n    varying vec3 vColor;\n    varying vec2 vUv;\n    varying float vOpacity;\n    varying float vRepeat;\n\n    float getGameTime() {\n        float modGameTime = gameTime;\n        if (repeat > 0.0) {\n            modGameTime = gameTime - (repeat * floor(gameTime/repeat));\n        }\n\n        return modGameTime;\n    }\n\n    float getScale() {\n        return 1.0;\n    }\n\n    vec2 resolveUv() {\n        float textureAmount = 8.0;\n        vec2 tPos = vec2(\n            (mod(textureNumber, textureAmount) * (1.0 / textureAmount)),\n            (floor(textureNumber / textureAmount) * (1.0 / textureAmount))\n        );\n        \n        vec2 finalPos = vec2((uv.x / textureAmount + tPos.x), 1.0 - (uv.y / textureAmount + tPos.y));\n\n        return finalPos;\n    }\n\n    // http://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/\n    vec3 applyQuaternionToVector(vec3 v ){\n        return v + 2.0 * cross( quaternion.xyz, cross( quaternion.xyz, v ) + quaternion.w * v );\n    }\n\n    float getTimeToEnd() {\n        float speed = length(velocity);\n\n        if (speed > 0.0) {  \n            float length = scale.x;\n            float timeToEnd = length / speed;\n            return timeToEnd ;\n        } else {  \n            return 0.0;\n        }\n    }\n\n    float getFadeOpacity() {\n\n        float modGameTime = getGameTime();\n\n        if (deactivationFade == 0.0) {\n            return 1.0;\n        }\n\n        if (modGameTime < (deactivationGameTime - deactivationFade)) {\n            return 1.0;\n        }\n\n        float fade = modGameTime - (deactivationGameTime - deactivationFade);\n\n        if (fade > deactivationFade) {\n            fade = deactivationFade;\n        }\n\n        float ratio = fade / deactivationFade;\n\n        return 1.0 - ratio;\n        \n    }\n\n    int active(float vertexDeltaTime) {\n        \n        float modGameTime = getGameTime();\n\n        if (opacity == 0.0) {\n            return 0;\n        }\n\n        if (activationGameTime > modGameTime) {\n            return 0;\n        }\n\n        if (deactivationGameTime + vertexDeltaTime < modGameTime) {\n            return 0;\n        }\n        \n        return 1;\n    }\n\n    void main() {\n\n        float timeToEnd = getTimeToEnd();\n\n        if (active(timeToEnd) == 0) {\n            gl_Position = vec4(0.0);\n            vOpacity = 0.0;\n            return;\n        }\n\n        float currentOpacity = opacity;\n\n        if (zoomLevel < 1.0) {\n            currentOpacity += (1.0 - zoomLevel) * 0.5;\n        }\n\n        float modGameTime = getGameTime();\n\n        float elapsedTime = modGameTime - activationGameTime;\n\n        vOpacity = currentOpacity * getFadeOpacity();\n        vUv = resolveUv();\n        vColor = color;\n        vActivationGameTime = activationGameTime + timeToEnd * uv.y;\n        vDeactivationGameTime = deactivationGameTime + timeToEnd * uv.y;\n        \n\n        vRepeat = repeat;\n        \n        gl_Position = projectionMatrix * modelViewMatrix * vec4((offset + velocity * elapsedTime) + applyQuaternionToVector(position * scale), 1.0 );      \n     \n        //gl_Position = projectionMatrix * modelViewMatrix * vec4( offset + applyQuaternionToVector(position) * scale, 1.0 );      \n      }\n\n";/* harmony default export */ var shader_boltVertexShader = (boltVertexShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/boltFragmentShader.js
var boltFragmentShader="\n    precision highp float;\n    uniform sampler2D map;\n    uniform float gameTime;\n    varying vec2 vUv;\n    varying float vOpacity;\n    varying vec3 vColor;\n    varying float vActivationGameTime;\n    varying float vDeactivationGameTime;\n    varying float vRepeat;\n\n    float getGameTime() {\n        float modGameTime = gameTime;\n        if (vRepeat > 0.0) {\n            modGameTime = gameTime - (vRepeat * floor(gameTime/vRepeat));\n        }\n\n        return modGameTime;\n    }\n\n    void main() {\n\n        float modGameTime = getGameTime();\n\n        if (vOpacity == 0.0) {\n            discard;\n        }\n\n        if (vActivationGameTime > modGameTime) {\n            discard;\n        }\n\n        if (vDeactivationGameTime < modGameTime) {\n            discard;\n        }\n\n        vec4 finalColor = vec4(vColor.rgb, texture2D(map, vUv).a * vOpacity);\n        gl_FragColor = finalColor;\n    }\n";/* harmony default export */ var shader_boltFragmentShader = (boltFragmentShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/line2dVertexShader.js
var line2dVertexShader="\n    precision highp float;\n    uniform mat4 modelMatrix;\n    uniform mat4 viewMatrix;\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n    uniform vec3 color;\n    uniform float opacity;\n    attribute vec3 position;\n    attribute vec2 uv;\n    varying vec2 vUv;\n    varying float vOpacity;\n    varying vec3 vColor;\n\n    void main() {\n       \n        vUv = uv;\n        vOpacity = opacity;\n        vColor = color;\n        /*\n        vPulse = pulse;\n        vDashRatio = dashRatio;\n        */\n       \n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);    \n    }\n";/* harmony default export */ var shader_line2dVertexShader = (line2dVertexShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/line2dFragmentShader.js
var line2dFragmentShader="\n    precision highp float;\n    uniform sampler2D map;\n    uniform float textureRepeat;\n    uniform vec2 pulse;\n    uniform float time;\n    varying vec2 vUv;\n    varying float vOpacity;\n    varying vec3 vColor;\n\n    vec4 getPulse(vec4 color) {\n        float pulseAmount = pulse.x;\n        float pulseSpeed = pulse.y;\n\n        if (pulseAmount == 0.0 || pulseSpeed == 0.0) {\n            return color;\n        }\n\n        float pulseTime = mod(time * pulseSpeed, 1.0);\n        float y = mod(vUv.y * pulseAmount, 1.0);\n   \n        float diff = y - pulseTime;\n        if (diff < 0.0) {\n            diff = 1.0 + diff;\n        }\n\n        if (diff > 0.9) {\n            diff = 1.0 - ((diff - 0.9) * 10.0);\n        }\n    \n        color.a *= 1.0 + (diff);\n\n        return color;\n    }\n\n    vec4 repeatTexture() {\n        vec2 textureUv = vec2(\n            vUv.x,\n            vUv.y * textureRepeat\n        );\n\n        return texture2D(map, textureUv);\n    }\n\n    void main() {\n       \n      \n        float finalOpacity = repeatTexture().a * vOpacity;\n        vec4 finalColor = vec4(vColor, finalOpacity);\n        gl_FragColor = getPulse(finalColor);\n        \n    }\n";/* harmony default export */ var shader_line2dFragmentShader = (line2dFragmentShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/effectSpriteFragmentShader.js
var effectSpriteFragmentShader="\n    uniform sampler2D texture;\n    uniform vec3 overlayColor;\n    uniform float opacity;\n    uniform float textureNumber;\n\n    varying vec2 vUv;\n\n    vec4 sampleTexture() {\n        float textureAmount = 8.0;\n        vec2 tPos = vec2((mod(textureNumber, textureAmount) * (1.0 / textureAmount)), (floor(textureNumber / textureAmount) * (1.0 / textureAmount)));\n\n        vec2 finalPos = vec2(\n            (vUv.x / textureAmount + tPos.x),\n            1.0 - (vUv.y / textureAmount + tPos.y)\n        );\n\n        return texture2D(texture, finalPos);\n    }\n\n    void main() {\n        vec4 textureColor = sampleTexture();\n        vec4 finalColor = textureColor;\n\n        if (textureColor.a > 0.0){\n            //finalColor = vec4(overlayColor, textureColor.a);\n            //finalColor = mix(textureColor, overlayColor, overlayAlpha);\n            //finalColor = (1.0 - t1.a) * t0 + t1.a * t1;\n\n            finalColor =  textureColor * vec4(overlayColor, 1.0);\n            finalColor.a = textureColor.a;\n        }\n\n        if (finalColor.a > 0.0) {\n            finalColor.a *= opacity;\n        }\n\n        gl_FragColor = finalColor;\n    }\n";/* harmony default export */ var shader_effectSpriteFragmentShader = (effectSpriteFragmentShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/effectSpriteVertexShader.js
var effectSpriteVertexShader="\n    varying vec2 vUv;\n\n    void main() {\n        vUv = uv;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n    }\n";/* harmony default export */ var shader_effectSpriteVertexShader = (effectSpriteVertexShader);
// CONCATENATED MODULE: ./src/client/view/game/renderer/shader/index.js

// EXTERNAL MODULE: ./node_modules/three/examples/jsm/loaders/GLTFLoader.js
var GLTFLoader = __webpack_require__(147);

// CONCATENATED MODULE: ./src/client/view/game/utils/objectLoader.js
var loader=new GLTFLoader["a" /* GLTFLoader */]();var entities=[];var cloneObject=function cloneObject(source){var cloneMaterial=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var sourceLookup=new Map();var cloneLookup=new Map();var clone=source.scene.clone();var animations=source.animations;parallelTraverse(source.scene,clone,function(sourceNode,clonedNode){sourceLookup.set(clonedNode,sourceNode);cloneLookup.set(sourceNode,clonedNode);});clone.traverse(function(node){if(!node.isSkinnedMesh)return;var clonedMesh=node;var sourceMesh=sourceLookup.get(node);var sourceBones=sourceMesh.skeleton.bones;clonedMesh.skeleton=sourceMesh.skeleton.clone();clonedMesh.bindMatrix.copy(sourceMesh.bindMatrix);clonedMesh.skeleton.bones=sourceBones.map(function(bone){return cloneLookup.get(bone);});clonedMesh.bind(clonedMesh.skeleton,clonedMesh.bindMatrix);});if(cloneMaterial){clone.traverse(function(node){if(node.isMesh){node.material=node.material.clone();}});}return{scene:clone,animations:animations};};var parallelTraverse=function parallelTraverse(a,b,callback){callback(a,b);for(var i=0;i<a.children.length;i++){parallelTraverse(a.children[i],b.children[i],callback);}};var loadObject=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(url){var cached,_object,entity,object;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:cached=entities.find(function(entity){return entity.url===url;});if(!cached){_context.next=6;break;}_context.next=4;return cached.value;case 4:_object=_context.sent;return _context.abrupt("return",cloneObject(_object));case 6:entity={url:url,value:new Promise(function(resolve,reject){try{loader.load(url,function(object){resolve(object);});}catch(e){throw new Error("Unable to load asset ".concat(url));}})};entities.push(entity);_context.next=10;return entity.value;case 10:object=_context.sent;return _context.abrupt("return",cloneObject(object));case 12:case"end":return _context.stop();}}},_callee);}));return function loadObject(_x){return _ref.apply(this,arguments);};}();
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/LineSprite.js
var GEOMETRY=loadObject("/img/3d/line3/scene.gltf");var LineSprite_getTexture=function getTexture(){var type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";switch(type){case"dashed":return new three_module["TextureLoader"]().load("/img/line/dash.png");case"dashed-arrow":return new three_module["TextureLoader"]().load("/img/line/dashArrow.png");case"dashed-circle":return new three_module["TextureLoader"]().load("/img/line/dashCircle.png");default:return new three_module["TextureLoader"]().load("/img/line/full.png");}};var LineSprite_LineSprite=/*#__PURE__*/function(){function LineSprite(start,end,lineWidth){var args=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};Object(classCallCheck["a" /* default */])(this,LineSprite);this.args=args;this.mesh=null;this.color=args.color||new three_module["Color"](1,1,1);this.opacity=args.opacity||1;this.material=new three_module["RawShaderMaterial"]({uniforms:{map:{value:LineSprite_getTexture(args.type)},time:{type:"f",value:0.0},zoom:{type:"f",value:0.0},color:{type:"v3",value:this.color},opacity:{type:"f",value:this.opacity},textureRepeat:{type:"f",value:1.0},pulse:{type:"v2",value:[args.pulseAmount||0,args.pulseSpeed||1]}},transparent:true,depthWrite:false,depthTest:true,side:three_module["DoubleSide"],blending:args.blending||three_module["NormalBlending"],vertexShader:shader_line2dVertexShader,fragmentShader:shader_line2dFragmentShader//wireframe: true
});this.start=start;this.end=end;this.lineWidth=lineWidth;this.create();this.update(start,end,lineWidth,true);this.animate();}Object(createClass["a" /* default */])(LineSprite,[{key:"animate",value:function animate(){var now=Date.now();this.material.uniforms.time.value=now%1000*0.001;this.material.needsUpdate=true;requestAnimationFrame(this.animate.bind(this));}},{key:"addTo",value:function(){var _addTo=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(scene){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.scene=scene;_context.next=3;return GEOMETRY;case 3:scene.add(this.mesh);case 4:case"end":return _context.stop();}}},_callee,this);}));function addTo(_x){return _addTo.apply(this,arguments);}return addTo;}()},{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(){var geometry;return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.material.uniforms.map.value.wrapT=three_module["RepeatWrapping"];this.material.uniforms.map.value.minFilter=this.args.minFilter||three_module["LinearMipmapNearestFilter"];this.material.needsUpdate=true;_context2.next=5;return GEOMETRY;case 5:geometry=_context2.sent;this.mesh=new three_module["Mesh"](geometry.scene.children[0].geometry.clone(),this.material);case 7:case"end":return _context2.stop();}}},_callee2,this);}));function create(){return _create.apply(this,arguments);}return create;}()},{key:"updateTextureSize",value:function(){var _updateTextureSize=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee3(size){var distance,textureRepeat;return regenerator_default.a.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:this.args.textureSize=size;distance=this.start.distanceTo(this.end);textureRepeat=this.args.textureSize?distance/this.args.textureSize:1;if(this.args.roundTestureRepeate){textureRepeat=Math.round(textureRepeat);}this.material.uniforms.textureRepeat.value=textureRepeat;case 5:case"end":return _context3.stop();}}},_callee3,this);}));function updateTextureSize(_x2){return _updateTextureSize.apply(this,arguments);}return updateTextureSize;}()},{key:"update",value:function(){var _update=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee4(start,end){var lineWidth,force,direction,distance,position,testureRepeat,_args4=arguments;return regenerator_default.a.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:lineWidth=_args4.length>2&&_args4[2]!==undefined?_args4[2]:1;force=_args4.length>3?_args4[3]:undefined;_context4.next=4;return GEOMETRY;case 4:if(lineWidth!==this.lineWidth||force){this.mesh.scale.setY(this.lineWidth);}if(!start.equals(this.start)||!end.equals(this.end)||force){direction=end.sub(start);this.mesh.quaternion.setFromUnitVectors(new three_module["Vector3"](1,0,0).normalize(),direction.normalize());distance=start.distanceTo(end);this.mesh.scale.setX(distance);position=start.add(direction.multiplyScalar(0.5));this.mesh.position.set(position.x,position.y,position.z);testureRepeat=this.args.textureSize?distance/this.args.textureSize:1;if(this.args.roundTestureRepeate){testureRepeat=Math.round(testureRepeat);}this.material.uniforms.textureRepeat.value=testureRepeat;this.material.needsUpdate=true;}this.start=start;this.end=end;this.lineWidth=lineWidth;return _context4.abrupt("return",this);case 10:case"end":return _context4.stop();}}},_callee4,this);}));function update(_x3,_x4){return _update.apply(this,arguments);}return update;}()},{key:"render",value:function render(zoom){/*
    if (zoom > 1) {
      this.material.uniforms.opacity.value =
        this.opacity * (1 + (zoom - 1) * 0.5);
    }
    */ //this.mesh.scale.setY(this.lineWidth * (zoom * 0.5));
/*
    const distance = this.start.distanceTo(this.end) / zoom;

    this.material.uniforms.textureRepeat.value = this.args.textureSize
      ? distance / this.args.textureSize
      : 1;
      */}},{key:"hide",value:function(){var _hide=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee5(){return regenerator_default.a.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return GEOMETRY;case 2:this.mesh.visible=false;return _context5.abrupt("return",this);case 4:case"end":return _context5.stop();}}},_callee5,this);}));function hide(){return _hide.apply(this,arguments);}return hide;}()},{key:"show",value:function(){var _show=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee6(){return regenerator_default.a.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return GEOMETRY;case 2:this.mesh.visible=true;return _context6.abrupt("return",this);case 4:case"end":return _context6.stop();}}},_callee6,this);}));function show(){return _show.apply(this,arguments);}return show;}()},{key:"destroy",value:function(){var _destroy=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee7(){return regenerator_default.a.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return GEOMETRY;case 2:this.scene.remove(this.mesh);this.mesh.material.dispose();case 4:case"end":return _context7.stop();}}},_callee7,this);}));function destroy(){return _destroy.apply(this,arguments);}return destroy;}()}]);return LineSprite;}();/* harmony default export */ var sprite_LineSprite = (LineSprite_LineSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/Sprite.js
var textureLoader=new three_module["TextureLoader"]();var geometries={};var baseMaterial=new three_module["ShaderMaterial"]({vertexShader:shader_spriteVertexShader,fragmentShader:shader_spriteFragmentShader,transparent:true,depthWrite:false});var Sprite_Sprite=/*#__PURE__*/function(){function Sprite(image,size,z){Object(classCallCheck["a" /* default */])(this,Sprite);this.z=z||0;this.mesh=null;this.size=size;this.opacity=1;this.uniforms={texture:{type:"t",value:new three_module["DataTexture"](null,0,0)},overlayAlpha:{type:"f",value:0.0},overlayColor:{type:"v3",value:new three_module["Color"](0,0,0)},opacity:{type:"f",value:1.0}};this.color=null;this.mesh=this.create(size,image);}Object(createClass["a" /* default */])(Sprite,[{key:"getMaterial",value:function getMaterial(){return baseMaterial;}},{key:"hide",value:function hide(){this.mesh.visible=false;return this;}},{key:"show",value:function show(){this.mesh.visible=true;return this;}},{key:"replaceColor",value:function replaceColor(color){this.uniforms.overlayColor.value=color;return this;}},{key:"revertColor",value:function revertColor(){if(!this.color){return;}this.uniforms.overlayColor.value=this.color;}},{key:"setPosition",value:function setPosition(pos){this.mesh.position.x=pos.x;this.mesh.position.y=pos.y;return this;}},{key:"getPosition",value:function getPosition(){return this.mesh.position;}},{key:"isPosition",value:function isPosition(position){return this.mesh.position.x===position.x&&this.mesh.position.y===position.y&&this.mesh.position.z===position.z;}},{key:"setOpacity",value:function setOpacity(opacity){this.opacity=opacity;this.uniforms.opacity.value=opacity;return this;}},{key:"multiplyOpacity",value:function multiplyOpacity(m){this.uniforms.opacity.value=this.opacity*m;return this;}},{key:"setOverlayColorAlpha",value:function setOverlayColorAlpha(alpha){this.uniforms.overlayAlpha.value=alpha;return this;}},{key:"setOverlayColor",value:function setOverlayColor(color){this.color=color;this.uniforms.overlayColor.value=color;return this;}},{key:"isOverlayColor",value:function isOverlayColor(color){return this.color.r===color.r&&this.color.g===color.g&&this.color.b===color.b;}},{key:"setScale",value:function setScale(width,height){this.mesh.scale.set(width,height,1);return this;}},{key:"destroy",value:function destroy(){this.mesh.material.dispose();}},{key:"setFacing",value:function setFacing(facing){this.mesh.rotation.z=degreeToRadian(facing);return this;}},{key:"getFacing",value:function getFacing(){return radianToDegree(this.mesh.rotation.z);}},{key:"create",value:function create(size,image){var material=this.getMaterial();var geometry=geometries[""+size.width+"-"+size.height]||function(){var geometry=new three_module["PlaneGeometry"](size.width,size.height,1,1);geometries[""+size.width+"-"+size.height]=geometry;return geometry;}();if(typeof image=="string"){image=textureLoader.load("img/spritesheet.png");}this.uniforms.texture.value=image;this.material=material.clone();this.material.uniforms=this.uniforms;this.material.depthTest=true;var mesh=new three_module["Mesh"](geometry,this.material);mesh.position.z=this.z;return mesh;}}]);return Sprite;}();/* harmony default export */ var sprite_Sprite = (Sprite_Sprite);
// CONCATENATED MODULE: ./src/client/view/game/utils/graphics.js
var clearCanvas=function clearCanvas(canvasid){var canvas=document.getElementById(canvasid);canvas.getContext("2d").clearRect(0,0,canvas.width,canvas.height);};var clearContext=function clearContext(context,canvas){context.clearRect(0,0,canvas.width,canvas.height);};var clearSmallCanvas=function clearSmallCanvas(context){context.clearRect(0,0,100,100);};var getCanvas=function getCanvas(canvasid){//console.log(canvasid);
var canvas=document.getElementById(canvasid);if(!canvas){console.log("Canvas is null");console.trace();return null;}var context=canvas.getContext("2d");return context;};var graphics_drawCone=function drawCone(canvas,start,p1,p2,arcs,w){canvas.lineWidth=w;canvas.beginPath();canvas.moveTo(start.x,start.y);canvas.lineTo(p1.x,p1.y);canvas.arc(start.x,start.y,math_distance(start,p1),degreeToRadian(arcs.start),degreeToRadian(arcs.end),false);//canvas.lineTo(start.x,start.y);
canvas.closePath();canvas.stroke();canvas.fill();};var drawBox=function drawBox(canvas,p,w,h,lw){canvas.lineWidth=lw;canvas.beginPath();canvas.moveTo(p.x-w/2,p.y+h/2);canvas.lineTo(p.x+w/2,p.y+h/2);canvas.lineTo(p.x+w/2,p.y-h/2);canvas.lineTo(p.x-w/2,p.y-h/2);canvas.closePath();canvas.stroke();canvas.fill();};var drawCircle=function drawCircle(canvas,x,y,r,w){if(r<1)r=1;canvas.lineWidth=w;canvas.beginPath();canvas.arc(x,y,r,0,Math.PI*2,true);canvas.closePath();canvas.stroke();};var drawHollowCircleAndFill=function drawHollowCircleAndFill(canvas,x,y,r,r2,w){canvas.beginPath();canvas.arc(x,y,r2,0,Math.PI*2,false);// outer (filled)
canvas.moveTo(x+r,y);canvas.arc(x,y,r,0,Math.PI*2,true);// inner (unfills it)
canvas.stroke();canvas.fill();};var drawEllipseSegment=function drawEllipseSegment(canvas,x,y,rx,ry,s,e){canvas.beginPath();//.ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle [, anticlockwise]);
canvas.ellipse(x,y,rx,ry,0,s,e,false);canvas.closePath();canvas.stroke();};var graphics_drawCircleSegment=function drawCircleSegment(canvas,x,y,r,r2,s,e){canvas.beginPath();canvas.arc(x,y,r2,s,e,false);// outer (filled)
var p1=getPointInDirection(r,-radianToDegree(e),x,y);canvas.lineTo(p1.x,p1.y);canvas.arc(x,y,r,e,s,true);// inner (unfills it)
var p2=getPointInDirection(r2,-radianToDegree(s),x,y);canvas.lineTo(p2.x,p2.y);canvas.closePath();canvas.stroke();canvas.fill();};var graphics_drawDottedCircle=function drawDottedCircle(canvas,x,y,r,r2,segments,gapratio){var deg=360/segments;var gap=deg*gapratio;for(var d=0;d<360;d+=deg){graphics_drawCircleSegment(canvas,x,y,r,r2,degreeToRadian(d),degreeToRadian(d+deg-gap));}};var graphics_drawFilledCircle=function drawFilledCircle(canvas,x,y,r1,r2){graphics_drawCircleSegment(canvas,x,y,r1,r2,degreeToRadian(0),degreeToRadian(360));};var graphics_drawFilledEllipse=function drawFilledEllipse(canvas,x,y,r1,r2){drawEllipseSegment(canvas,x,y,r1,r2,degreeToRadian(0),degreeToRadian(360));};var drawCircleAndFill=function drawCircleAndFill(canvas,x,y,r,w){canvas.lineWidth=w;canvas.beginPath();canvas.arc(x,y,r,0,Math.PI*2,true);canvas.closePath();canvas.stroke();canvas.fill();};var drawCircleNoStroke=function drawCircleNoStroke(canvas,x,y,r,w){canvas.lineWidth=w;canvas.beginPath();canvas.arc(x,y,r,0,Math.PI*2,true);canvas.closePath();canvas.fill();};var drawLine=function drawLine(canvas,x1,y1,x2,y2,w){canvas.lineWidth=w;canvas.beginPath();canvas.moveTo(x1,y1);canvas.lineTo(x2,y2);canvas.stroke();};var graphics_drawArrow=function drawArrow(canvas,x,y,a,s,w){var p1,p2,p3,p4,p5,p6,p7;p1=getPointInDirection(s*0.5,-a,x,y);p2=getPointInDirection(s*0.5,-addToDirection(a,-140),p1.x,p1.y);p3=getPointInDirection(s*0.15,-addToDirection(a,90),p2.x,p2.y);p4=getPointInDirection(s*0.5,-addToDirection(a,180),p3.x,p3.y);p7=getPointInDirection(s*0.5,-addToDirection(a,140),p1.x,p1.y);p6=getPointInDirection(s*0.15,-addToDirection(a,-90),p7.x,p7.y);p5=getPointInDirection(s*0.5,-addToDirection(a,180),p6.x,p6.y);canvas.lineWidth=w;canvas.beginPath();canvas.moveTo(p1.x,p1.y);canvas.lineTo(p2.x,p2.y);canvas.lineTo(p3.x,p3.y);canvas.lineTo(p4.x,p4.y);canvas.lineTo(p5.x,p5.y);canvas.lineTo(p6.x,p6.y);canvas.lineTo(p7.x,p7.y);canvas.closePath();canvas.fill();canvas.stroke();};var drawX=function drawX(canvas,x,y,l,w){x=parseInt(x);y=parseInt(y);l=parseInt(l);canvas.lineWidth=w;canvas.beginPath();canvas.moveTo(x-l,y-l);canvas.lineTo(x+l,y+l);canvas.stroke();canvas.beginPath();canvas.moveTo(x-l,y+l);canvas.lineTo(x+l,y-l);canvas.stroke();};var drawCenteredHexagon=function drawCenteredHexagon(canvas,x,y,l,leftside,topleft,topright){var a=l*Math.sin(30/180*Math.PI);var b=l*Math.cos(30/180*Math.PI);x=x-b;y=y-a*2;drawHexagon(canvas,x,y,l,leftside,topleft,topright);};var drawHexagon=function drawHexagon(canvas,x,y,l,leftside,topleft,topright){var a=l*Math.sin(30/180*Math.PI);var b=l*Math.cos(30/180*Math.PI);var p1,p2,p3,p4,p5,p6;p1={x:x,y:y+a+l};p2={x:x,y:y+a};p3={x:x+b,y:y};p4={x:x+2*b,y:y+a};p5={x:x+2*b,y:y+a+l};p6={x:x+b,y:y+2*l};canvas.beginPath();if(leftside){canvas.moveTo(p1.x,p1.y);canvas.lineTo(p2.x,p2.y);}else{canvas.moveTo(p2.x,p2.y);}if(topleft){canvas.lineTo(p3.x,p3.y);}else{canvas.moveTo(p3.x,p3.y);}if(topright){canvas.lineTo(p4.x,p4.y);}else{canvas.moveTo(p4.x,p4.y);}canvas.lineTo(p5.x,p5.y);canvas.lineTo(p6.x,p6.y);canvas.lineTo(p1.x,p1.y);canvas.closePath();canvas.stroke();canvas.fill();};var drawAndRotate=function drawAndRotate(canvas,w,h,iw,ih,angle,img,rolled){var x=Math.round(w/2);var y=Math.round(h/2);var width=iw/2;var height=ih/2;if(rolled)angle=360-angle;angle=angle*Math.PI/180;canvas.save();canvas.translate(x,y);if(rolled)canvas.scale(1,-1);canvas.rotate(angle);canvas.drawImage(img,-width/2,-height/2,width,height);canvas.rotate(-angle);canvas.translate(-x,-y);canvas.restore();};
// CONCATENATED MODULE: ./src/client/view/game/utils/abstractCanvas.js
var abstractCanvas_create=function create(width,height,debug){var canvas=document.createElement("canvas");canvas.width=width;canvas.height=height;canvas.style.zIndex=1000;canvas.style.position="absolute";canvas.style.top="3px";canvas.style.left="3px";canvas.style.border="1px solid red";if(debug){document.body.appendChild(canvas);}return canvas;};/* harmony default export */ var abstractCanvas = ({create:abstractCanvas_create});
// CONCATENATED MODULE: ./src/client/view/game/renderer/hexgrid/HexagonTexture.js
var HexagonTexture_createCanvas=function createCanvas(width,height,debug){return abstractCanvas.create(width,height,debug);};var HexagonTexture_getTexture=function getTexture(canvas,gridWidth,gridHeight){if(gridWidth===undefined){gridWidth=1;}if(gridHeight===undefined){gridHeight=1;}var texture=new three_module["Texture"](canvas);texture.needsUpdate=true;texture.wrapS=three_module["RepeatWrapping"];texture.wrapT=three_module["RepeatWrapping"];texture.repeat.set(getHorizontalRepeat(gridWidth),getVerticalRepeat(gridHeight));texture.offset.set(0,0.16666);return texture;};var getHorizontalRepeat=function getHorizontalRepeat(hexagons){return 3/4+(hexagons-1)*2/4;};var getVerticalRepeat=function getVerticalRepeat(hexagons){return 4/6+(hexagons-1)*3/6;};var HexagonTexture_renderHexGrid=function renderHexGrid(canvasSize,lineColor,fillColor,lineWidth,repeat){var scale={x:1,y:1};var width=canvasSize;var hl=width/4/Math.cos(30/180*Math.PI);var a=HexagonMath.getHexA(hl);var b=HexagonMath.getHexB(hl);var x=b;var height=HexagonMath.getTextureHeight(hl);var canvas=HexagonTexture_createCanvas(width,height,false);var context=canvas.getContext("2d",{antialias:true});context.fillStyle=lineColor;context.strokeStyle=lineColor;context.fillStyle=fillColor;context.lineWidth=lineWidth;context.scale(scale.x,scale.y);if(repeat){drawCenteredHexagon(context,x,0,hl,true,true,true);drawCenteredHexagon(context,x*3,0,hl,true,true,true);}drawCenteredHexagon(context,x*2,hl+a,hl,true,true,true);if(repeat){drawCenteredHexagon(context,x,hl*3,hl,true,true,true);drawCenteredHexagon(context,x*3,hl*3,hl,true,true,true);}var canvas2=HexagonTexture_createCanvas(width,width,false);canvas2.getContext("2d",{antialias:true}).drawImage(canvas,0,0,width,height,0,0,width,width);return canvas2;};var getHexGridTexture=function getHexGridTexture(canvasSize,gridWidth,gridHeight,lineColor,fillColor,lineWidth){return HexagonTexture_getTexture(HexagonTexture_renderHexGrid(canvasSize,lineColor,fillColor,lineWidth,true),gridWidth,gridHeight);};var getHexTexture=function getHexTexture(canvasSize,lineColor,fillColor,lineWidth){return HexagonTexture_getTexture(HexagonTexture_renderHexGrid(canvasSize,lineColor,fillColor,lineWidth),1,1);};/* harmony default export */ var HexagonTexture = ({renderHexGrid:HexagonTexture_renderHexGrid,getHexGridTexture:getHexGridTexture,getHexTexture:getHexTexture});
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/HexagonSprite.js
var TEXTURE_SIZE=512;var TEXTURE=null;var HexagonSprite_createTexture=function createTexture(){var canvas=HexagonTexture.renderHexGrid(TEXTURE_SIZE,getStrokeColor(),getFillColor(),10);var tex=new three_module["Texture"](canvas);tex.needsUpdate=true;TEXTURE=tex;};var getStrokeColor=function getStrokeColor(){return"rgba(255,255,255,0.50)";};var getFillColor=function getFillColor(){return"rgba(255,255,255,0.15)";};var HexagonSprite_HexagonSprite=/*#__PURE__*/function(_Sprite){Object(inherits["a" /* default */])(HexagonSprite,_Sprite);function HexagonSprite(position){var _this;var z=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var scale=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;Object(classCallCheck["a" /* default */])(this,HexagonSprite);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(HexagonSprite).call(this,null,{width:HexagonMath.getTextureWidth()*scale,height:HexagonMath.getTextureHeight()*scale},z));if(!TEXTURE){HexagonSprite_createTexture();}_this.uniforms.texture.value=TEXTURE;_this.setPosition(position);return _this;}return HexagonSprite;}(sprite_Sprite);/* harmony default export */ var sprite_HexagonSprite = (HexagonSprite_HexagonSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/ShipEWSprite.js
var ShipEWSprite_TEXTURE_SIZE=1028;var getDEWWidth=function getDEWWidth(DEW){if(DEW===0){return 0;}return DEW*3+5;};var getEvasionWidth=function getEvasionWidth(evasion){if(evasion===0){return 0;}return evasion*3+5;};var getCCEWWidth=function getCCEWWidth(CCEW){if(CCEW===0){return 0;}return CCEW*3+5;};var ShipEWSprite_drawDEW=function drawDEW(context,DEW,ratios){if(!DEW){return;}var a=0.4;if(DEW<3){a=0.7;}context.strokeStyle="rgba(144,185,208, 0.7)";context.lineWidth=getDEWWidth(DEW);var _getDEWRadiuses=getDEWRadiuses(DEW,ratios),r1=_getDEWRadiuses.r1,r2=_getDEWRadiuses.r2;graphics_drawFilledEllipse(context,ShipEWSprite_TEXTURE_SIZE/2,ShipEWSprite_TEXTURE_SIZE/2,r1,r2);};var getDEWRadiuses=function getDEWRadiuses(DEW,ratios){return{r1:ShipEWSprite_TEXTURE_SIZE*0.7*ratios.x/2+getDEWWidth(DEW),r2:ShipEWSprite_TEXTURE_SIZE*0.7*ratios.y/2+getDEWWidth(DEW)};};var getCCEWRadiuses=function getCCEWRadiuses(DEW,evasion,CCEW,ratios){var _getDEWRadiuses2=getDEWRadiuses(DEW,ratios),r1=_getDEWRadiuses2.r1,r2=_getDEWRadiuses2.r2;return{r1:r1+getDEWWidth(DEW)/2+15+getEvasionWidth(evasion)/2+15+getCCEWWidth(CCEW)/2,r2:r2+getDEWWidth(DEW)/2+15+getEvasionWidth(evasion)/2+15+getCCEWWidth(CCEW)/2};};var getEvasionRadiuses=function getEvasionRadiuses(DEW,evasion,ratios){var _getDEWRadiuses3=getDEWRadiuses(DEW,ratios),r1=_getDEWRadiuses3.r1,r2=_getDEWRadiuses3.r2;return{r1:r1+getDEWWidth(DEW)/2+15+getEvasionWidth(evasion)/2,r2:r2+getDEWWidth(DEW)/2+15+getEvasionWidth(evasion)/2};};var ShipEWSprite_drawEvasion=function drawEvasion(context,DEW,evasion,ratios){if(!evasion){return;}var a=0.7;if(evasion<3){a=0.9;}context.strokeStyle="rgba(20,140,128, 0.9)";context.lineWidth=getEvasionWidth(evasion);context.setLineDash([15,5]);var _getEvasionRadiuses=getEvasionRadiuses(DEW,evasion,ratios),r1=_getEvasionRadiuses.r1,r2=_getEvasionRadiuses.r2;graphics_drawFilledEllipse(context,ShipEWSprite_TEXTURE_SIZE/2,ShipEWSprite_TEXTURE_SIZE/2,r1,r2);context.setLineDash([]);};var ShipEWSprite_drawCCEW=function drawCCEW(context,DEW,evasion,CCEW,ratios){if(!CCEW){return;}var a=0.7;if(CCEW<3){a=0.9;}context.strokeStyle="rgba(20,80,128, 0.9)";context.lineWidth=getCCEWWidth(CCEW);context.setLineDash([15,5]);var _getCCEWRadiuses=getCCEWRadiuses(DEW,evasion,CCEW,ratios),r1=_getCCEWRadiuses.r1,r2=_getCCEWRadiuses.r2;graphics_drawFilledEllipse(context,ShipEWSprite_TEXTURE_SIZE/2,ShipEWSprite_TEXTURE_SIZE/2,r1,r2);context.setLineDash([]);};var ShipEWSprite_ShipEWSprite=/*#__PURE__*/function(_Sprite){Object(inherits["a" /* default */])(ShipEWSprite,_Sprite);function ShipEWSprite(size,z,dimensions){var _this;Object(classCallCheck["a" /* default */])(this,ShipEWSprite);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipEWSprite).call(this,null,size,z));_this.DEW=0;_this.CCEW=0;_this.dimensions=dimensions;return _this;}Object(createClass["a" /* default */])(ShipEWSprite,[{key:"calculateRadiusRatios",value:function calculateRadiusRatios(){var max=this.dimensions.x>this.dimensions.y?this.dimensions.x:this.dimensions.y;var ratios={x:this.dimensions.x/max,y:this.dimensions.y/max};return ratios;}},{key:"update",value:function update(DEW,CCEW,evasion){if(this.DEW===DEW&&this.CCEW===CCEW&&this.evasion===evasion){return;}this.DEW=DEW;this.CCEW=CCEW;this.evasion=evasion;var canvas=abstractCanvas.create(ShipEWSprite_TEXTURE_SIZE,ShipEWSprite_TEXTURE_SIZE);var context=canvas.getContext("2d");ShipEWSprite_drawDEW(context,DEW,this.calculateRadiusRatios());ShipEWSprite_drawEvasion(context,DEW,evasion,this.calculateRadiusRatios());ShipEWSprite_drawCCEW(context,DEW,evasion,CCEW,this.calculateRadiusRatios());var texture=new three_module["Texture"](canvas);texture.needsUpdate=true;this.uniforms.texture.value=texture;}}]);return ShipEWSprite;}(sprite_Sprite);/* harmony default export */ var sprite_ShipEWSprite = (ShipEWSprite_ShipEWSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/ShipFacingSprite.js
var ShipFacingSprite_texture=null;var ShipFacingSprite_TEXTURE_SIZE=256;var ShipFacingSprite_createTexture=function createTexture(){if(ShipFacingSprite_texture){return;}var canvas=abstractCanvas.create(ShipFacingSprite_TEXTURE_SIZE,ShipFacingSprite_TEXTURE_SIZE);var context=canvas.getContext("2d");context.strokeStyle="rgba(0,0,255,1.0)";context.fillStyle="rgba(0,0,255,0.5)";graphics_drawArrow(context,ShipFacingSprite_TEXTURE_SIZE/2,ShipFacingSprite_TEXTURE_SIZE/2,0,ShipFacingSprite_TEXTURE_SIZE/2,1);ShipFacingSprite_texture=new three_module["Texture"](canvas);ShipFacingSprite_texture.needsUpdate=true;};var ShipFacingSprite_ShipFacingSprite=/*#__PURE__*/function(_Sprite){Object(inherits["a" /* default */])(ShipFacingSprite,_Sprite);function ShipFacingSprite(size,z,opacity){var _this;Object(classCallCheck["a" /* default */])(this,ShipFacingSprite);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipFacingSprite).call(this,null,size,z));_this.setOpacity(opacity);ShipFacingSprite_createTexture();_this.uniforms.texture.value=ShipFacingSprite_texture;return _this;}return ShipFacingSprite;}(sprite_Sprite);/* harmony default export */ var sprite_ShipFacingSprite = (ShipFacingSprite_ShipFacingSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/DottedCircleSprite.js
var DottedCircleSprite_texture=null;var DottedCircleSprite_TEXTURE_SIZE=512;var DottedCircleSprite_createTexture=function createTexture(){if(DottedCircleSprite_texture){return;}var canvas=abstractCanvas.create(DottedCircleSprite_TEXTURE_SIZE,DottedCircleSprite_TEXTURE_SIZE);var context=canvas.getContext("2d");context.strokeStyle="rgba(78,220,25,1.0)";context.fillStyle="rgba(78,220,25,0.5)";graphics_drawDottedCircle(context,DottedCircleSprite_TEXTURE_SIZE/2,DottedCircleSprite_TEXTURE_SIZE/2,DottedCircleSprite_TEXTURE_SIZE*0.4,DottedCircleSprite_TEXTURE_SIZE*0.5,12,0.3);DottedCircleSprite_texture=new three_module["Texture"](canvas);DottedCircleSprite_texture.needsUpdate=true;};var DottedCircleSprite_DottedCircleSprite=/*#__PURE__*/function(_Sprite){Object(inherits["a" /* default */])(DottedCircleSprite,_Sprite);function DottedCircleSprite(size,z,opacity){var _this;Object(classCallCheck["a" /* default */])(this,DottedCircleSprite);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(DottedCircleSprite).call(this,null,size,z));_this.setOpacity(opacity);DottedCircleSprite_createTexture();_this.uniforms.texture.value=DottedCircleSprite_texture;return _this;}return DottedCircleSprite;}(sprite_Sprite);/* harmony default export */ var sprite_DottedCircleSprite = (DottedCircleSprite_DottedCircleSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/TextSprite.js
var TextSprite_TEXTURE_SIZE=256;var TextSprite_TextSprite=/*#__PURE__*/function(){function TextSprite(text,color,z,args){Object(classCallCheck["a" /* default */])(this,TextSprite);if(!args){args={};}this.z=z||0;var size=args.size||TextSprite_TEXTURE_SIZE;this.color=color||"rgba(255,255,255,1)";this.fontSize=args.fontSize||"32px";this.font=args.font||"Arial Black";var canvas=abstractCanvas.create(size,size);var context=canvas.getContext("2d");context.save();context.fillStyle=this.color;context.font=this.fontSize+" "+this.font;context.textAlign="center";context.textBaseline="middle";context.shadowOffsetX=0;context.shadowOffsetY=0;context.shadowColor="rgba(0,0,0,1)";context.shadowBlur=8;context.fillText(text,Math.round(size/2),Math.round(size/2));context.restore();var geometry=new three_module["PlaneGeometry"](size,size,1,1);var texture=new three_module["Texture"](canvas);texture.needsUpdate=true;this.material=new three_module["MeshBasicMaterial"]({map:texture,transparent:true,depthTest:false,depthWrite:false});this.mesh=new three_module["Mesh"](geometry,this.material);}Object(createClass["a" /* default */])(TextSprite,[{key:"setScale",value:function setScale(width,height){this.mesh.scale.set(width,height,1);}},{key:"hide",value:function hide(){this.mesh.visible=false;return this;}},{key:"show",value:function show(){this.mesh.visible=true;return this;}},{key:"setOpacity",value:function setOpacity(opacity){this.material.opacity=opacity;}},{key:"setPosition",value:function setPosition(pos){this.mesh.position.x=pos.x;this.mesh.position.y=pos.y;this.mesh.position.z=this.z;return this;}},{key:"destroy",value:function destroy(){this.mesh.material.dispose();}}]);return TextSprite;}();/* harmony default export */ var sprite_TextSprite = (TextSprite_TextSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/CircleSprite.js
var CircleSprite_texture=null;var CircleSprite_TEXTURE_SIZE=256;var CircleSprite_createTexture=function createTexture(){if(CircleSprite_texture){return;}var canvas=abstractCanvas.create(CircleSprite_TEXTURE_SIZE,CircleSprite_TEXTURE_SIZE);var context=canvas.getContext("2d");context.strokeStyle="rgba(255,255,255,1.0)";context.fillStyle="rgba(255,255,255,0.5)";drawCircleAndFill(context,CircleSprite_TEXTURE_SIZE/2,CircleSprite_TEXTURE_SIZE/2,CircleSprite_TEXTURE_SIZE*0.3,4);CircleSprite_texture=new three_module["Texture"](canvas);CircleSprite_texture.needsUpdate=true;};var CircleSprite_CircleSprite=/*#__PURE__*/function(_Sprite){Object(inherits["a" /* default */])(CircleSprite,_Sprite);function CircleSprite(position,size,z,opacity){var _this;Object(classCallCheck["a" /* default */])(this,CircleSprite);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CircleSprite).call(this,null,size,z));_this.setOpacity(opacity);CircleSprite_createTexture();_this.uniforms.texture.value=CircleSprite_texture;_this.setPosition(position);return _this;}return CircleSprite;}(sprite_Sprite);/* harmony default export */ var sprite_CircleSprite = (CircleSprite_CircleSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/ShipMapSprite.js
var ShipMapSprite_baseMaterial=new three_module["ShaderMaterial"]({vertexShader:shader_spriteVertexShader,fragmentShader:shader_spriteFragmentShader,transparent:true,depthWrite:false//blending: THREE.AdditiveBlending
});var ShipMapSprite_texture=new three_module["TextureLoader"]().load("/img/shipMapIcon.png");var textureMovementTarget=new three_module["TextureLoader"]().load("/img/shipMapIconMovementTarget.png");var ShipMapSprite_ShipMapSprite=/*#__PURE__*/function(_Sprite){Object(inherits["a" /* default */])(ShipMapSprite,_Sprite);function ShipMapSprite(position,size,z,opacity){var _this;var movementTarget=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;Object(classCallCheck["a" /* default */])(this,ShipMapSprite);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipMapSprite).call(this,null,size,z));_this.setOpacity(opacity);if(movementTarget){_this.uniforms.texture.value=textureMovementTarget;}else{_this.uniforms.texture.value=ShipMapSprite_texture;}_this.setPosition(position);return _this;}Object(createClass["a" /* default */])(ShipMapSprite,[{key:"getMaterial",value:function getMaterial(){return ShipMapSprite_baseMaterial;}}]);return ShipMapSprite;}(sprite_Sprite);/* harmony default export */ var sprite_ShipMapSprite = (ShipMapSprite_ShipMapSprite);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/index.js

// CONCATENATED MODULE: ./src/client/view/game/renderer/Line.js
var hexagonMesh=null;var Line_baseMaterial=new three_module["ShaderMaterial"]({vertexShader:shader_lineVertexShader,fragmentShader:shader_lineFragmentShader,transparent:true,depthWrite:false,//depthTest: false,
side:three_module["DoubleSide"],blending:three_module["AdditiveBlending"]});var Line_uniforms={time:{type:"f",value:0.0}};Line_baseMaterial.uniforms=Line_uniforms;/*
const baseMaterial = new THREE.MeshBasicMaterial({
  color: new THREE.Color(0, 1, 0)
});
*/var animate=function animate(){var now=Date.now();Line_baseMaterial.uniforms.time.value=now%1000*0.001;Line_baseMaterial.needsUpdate=true;requestAnimationFrame(animate);};var verticeAmount=16;animate();var Line_Line=/*#__PURE__*/function(){function Line(scene){var _this=this;var args=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Object(classCallCheck["a" /* default */])(this,Line);if(!args){args={};}this.scene=scene;this.mesh=null;this.start=args.start;this.end=args.end;this.width=args.width||10;this.pulseAmount=args.pulseAmount||0;this.pulseSpeed=args.pulseSpeed||1;this.dashSize=args.dashSize||0;this.length=new three_module["Vector3"]().subVectors(this.start,this.end).length();this.type=args.type||"laser";this.ready=new Promise(function(resolve){_this.resolveReady=resolve;});this.color=args.color;this.opacity=args.opacity;this.currentRotationMatrix=null;this.create(this.start,this.end,this.width);}Object(createClass["a" /* default */])(Line,[{key:"getGeometry",value:function(){var _getGeometry=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var object;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(hexagonMesh){_context.next=7;break;}_context.next=3;return loadObject("/img/3d/line2/scene.gltf");case 3:object=_context.sent;hexagonMesh=object.scene.children[0];hexagonMesh.rotation.set(hexagonMesh.rotation.x+degreeToRadian(90),hexagonMesh.rotation.y,hexagonMesh.rotation.z);hexagonMesh.material=Line_baseMaterial;case 7:return _context.abrupt("return",hexagonMesh);case 8:case"end":return _context.stop();}}},_callee);}));function getGeometry(){return _getGeometry.apply(this,arguments);}return getGeometry;}()},{key:"createMesh",value:function(){var _createMesh=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(width,height){var mesh;return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.getGeometry();case 2:mesh=_context2.sent;mesh=mesh.clone();mesh.geometry=mesh.geometry.clone();//mesh.material = baseMaterial.clone();
mesh.scale.set(width,width,height);return _context2.abrupt("return",mesh);case 7:case"end":return _context2.stop();}}},_callee2,this);}));function createMesh(_x,_x2){return _createMesh.apply(this,arguments);}return createMesh;}()},{key:"getVertexAmount",value:function getVertexAmount(){switch(this.type){case"cylinder":return 14;case"laser":return 16;}}},{key:"setPulse",value:function setPulse(amount){var speed=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this.pulseAmount=amount;this.pulseSpeed=speed;if(!this.pulseAttribute){var pulses=[];for(var i=0;i<this.getVertexAmount();i++){pulses.push(this.pulseAmount,this.pulseSpeed);}this.pulseAttribute=new three_module["BufferAttribute"](new Float32Array(pulses),2).setDynamic(true);this.mesh.geometry.setAttribute("pulse",this.pulseAttribute);}else{for(var _i=0;_i<this.getVertexAmount();_i++){this.pulseAttribute.setXY(_i,this.pulseAmount,this.pulseSpeed);}}this.dashAttribute.needsUpdate=true;}},{key:"setDashed",value:function setDashed(dashSize){this.dashRatio=dashSize/this.length;if(!this.dashAttribute){var dashes=[];for(var i=0;i<this.getVertexAmount();i++){dashes.push(this.dashRatio);}this.dashAttribute=new three_module["BufferAttribute"](new Float32Array(dashes),1).setDynamic(true);this.mesh.geometry.setAttribute("dashRatio",this.dashAttribute);}else{for(var _i2=0;_i2<this.getVertexAmount();_i2++){this.dashAttribute.setX(_i2,this.dashAttribute);}}this.dashAttribute.needsUpdate=true;}},{key:"setColorAttribute",value:function setColorAttribute(color){var colors=[];for(var i=0;i<this.getVertexAmount();i++){colors.push(color.r,color.g,color.b);}this.colorAttribute=new three_module["BufferAttribute"](new Float32Array(colors),3).setDynamic(true);this.mesh.geometry.setAttribute("color",this.colorAttribute);this.colorAttribute.needsUpdate=true;}},{key:"setColor",value:function(){var _setColor=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee3(color){var i;return regenerator_default.a.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.ready;case 2:this.color=color;for(i=0;i<this.getVertexAmount();i++){this.colorAttribute.setXYZ(i,this.color.r,this.color.g,this.color.b);}this.colorAttribute.needsUpdate=true;case 5:case"end":return _context3.stop();}}},_callee3,this);}));function setColor(_x3){return _setColor.apply(this,arguments);}return setColor;}()},{key:"setOpacity",value:function setOpacity(opacity){this.opacity=opacity;if(!this.opacityAttribute){var opacitys=[];for(var i=0;i<this.getVertexAmount();i++){opacitys.push(opacity);}this.opacityAttribute=new three_module["BufferAttribute"](new Float32Array(opacitys),1).setDynamic(true);this.mesh.geometry.setAttribute("opacity",this.opacityAttribute);}else{for(var _i3=0;_i3<this.getVertexAmount();_i3++){this.opacityAttribute.setX(_i3,this.opacity);}}this.opacityAttribute.needsUpdate=true;}},{key:"getOrientation",value:function getOrientation(pointX,pointY){var orientation=new three_module["Matrix4"]();orientation.lookAt(pointX,pointY,new three_module["Object3D"]().up);orientation.multiply(new three_module["Matrix4"]().set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));return orientation;}},{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee4(pointX,pointY,lineWidth){var mesh,orientation;return regenerator_default.a.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.createMesh(lineWidth,this.length);case 2:mesh=_context4.sent;orientation=this.getOrientation(pointX,pointY);mesh.applyMatrix(orientation);this.currentRotationMatrix=orientation;mesh.position.x=(pointY.x+pointX.x)/2;mesh.position.y=(pointY.y+pointX.y)/2;mesh.position.z=(pointY.z+pointX.z)/2;this.scene.add(mesh);this.mesh=mesh;this.resolveReady(true);this.setColorAttribute(this.color);this.setOpacity(this.opacity);this.setDashed(this.dashSize);this.setPulse(this.pulseAmount,this.pulseSpeed);case 16:case"end":return _context4.stop();}}},_callee4,this);}));function create(_x4,_x5,_x6){return _create.apply(this,arguments);}return create;}()},{key:"updateMesh",value:function updateMesh(){var orientation=this.getOrientation(this.start,this.end);this.mesh.applyMatrix(new three_module["Matrix4"]().getInverse(this.currentRotationMatrix));this.mesh.scale.set(this.width,this.width,this.length);this.mesh.applyMatrix(orientation);this.currentRotationMatrix=orientation;this.mesh.position.x=(this.end.x+this.start.x)/2;this.mesh.position.y=(this.end.y+this.start.y)/2;this.mesh.position.z=(this.end.z+this.start.z)/2;}},{key:"update",value:function(){var _update=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee5(start,end,lineWidth){return regenerator_default.a.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this.ready;case 2:this.width=lineWidth;this.start=start;this.end=end;this.length=new three_module["Vector3"]().subVectors(this.start,this.end).length();this.updateMesh();case 7:case"end":return _context5.stop();}}},_callee5,this);}));function update(_x7,_x8,_x9){return _update.apply(this,arguments);}return update;}()},{key:"setEnd",value:function setEnd(end){this.update(this.start,end,this.width);}},{key:"setLineWidth",value:function setLineWidth(lineWidth){this.width=lineWidth;this.mesh.scale.set(this.width,this.width,this.length);}},{key:"multiplyOpacity",value:function multiplyOpacity(m){this.setOpacity(this.opacity*m);}},{key:"hide",value:function(){var _hide=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee6(){return regenerator_default.a.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return this.ready;case 2:this.mesh.visible=false;return _context6.abrupt("return",this);case 4:case"end":return _context6.stop();}}},_callee6,this);}));function hide(){return _hide.apply(this,arguments);}return hide;}()},{key:"show",value:function(){var _show=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee7(){return regenerator_default.a.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return this.ready;case 2:this.mesh.visible=true;return _context7.abrupt("return",this);case 4:case"end":return _context7.stop();}}},_callee7,this);}));function show(){return _show.apply(this,arguments);}return show;}()},{key:"destroy",value:function(){var _destroy=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee8(){return regenerator_default.a.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return this.ready;case 2:this.scene.remove(this.mesh);case 3:case"end":return _context8.stop();}}},_callee8,this);}));function destroy(){return _destroy.apply(this,arguments);}return destroy;}()}]);return Line;}();/* harmony default export */ var renderer_Line = (Line_Line);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/ShipMapIcon.js
var ShipMapIcon_ShipMapIcon=/*#__PURE__*/function(){function ShipMapIcon(icon){Object(classCallCheck["a" /* default */])(this,ShipMapIcon);this.icon=icon;this.size={width:25,height:25};this.normalSprite=new sprite_ShipMapSprite({x:0,y:0,z:0},this.size,0,1);this.movementTargetSprite=new sprite_ShipMapSprite({x:0,y:0,z:0},{width:30,height:30},0,1,true);this.sprite=this.normalSprite;this.sprite.mesh.userData={icon:icon};this.sprite.hide();this.normalSprite.hide();this.movementTargetSprite.hide();this.scene=null;}Object(createClass["a" /* default */])(ShipMapIcon,[{key:"setMovementTarget",value:function setMovementTarget(){this.scene.remove(this.sprite.mesh);this.sprite=this.movementTargetSprite;this.scene.add(this.sprite.mesh);return this;}},{key:"replaceColor",value:function replaceColor(color){this.sprite.replaceColor(color);return this;}},{key:"revertColor",value:function revertColor(){this.sprite.revertColor(this.color);return this;}},{key:"addTo",value:function addTo(scene){this.scene=scene;scene.add(this.sprite.mesh);}},{key:"setScale",value:function setScale(scale){this.sprite.setScale(scale,scale);return this;}},{key:"setRotation",value:function setRotation(rotation){this.normalSprite.setFacing(rotation);this.movementTargetSprite.setFacing(rotation);return this;}},{key:"setOverlayColor",value:function setOverlayColor(color){this.sprite.setOverlayColor(color);return this;}},{key:"setOverlayColorAlpha",value:function setOverlayColorAlpha(alpha){this.sprite.setOverlayColorAlpha(alpha);return this;}},{key:"show",value:function show(){this.sprite.show();return this;}},{key:"hide",value:function hide(){this.sprite.hide();return this;}}]);return ShipMapIcon;}();/* harmony default export */ var ships_ShipMapIcon = (ShipMapIcon_ShipMapIcon);
// CONCATENATED MODULE: ./src/client/view/game/animation/Animation.js
var Animation_Animation=/*#__PURE__*/function(){function Animation(getRandom){Object(classCallCheck["a" /* default */])(this,Animation);this.getRandom=getRandom||Math.random;this.active=false;this.started=false;this.done=false;}Object(createClass["a" /* default */])(Animation,[{key:"start",value:function start(){this.active=true;}},{key:"stop",value:function stop(){this.active=false;}},{key:"setIsDone",value:function setIsDone(done){this.done=done;return this;}},{key:"setStartCallback",value:function setStartCallback(callback){this.startCallback=callback;return this;}},{key:"setDoneCallback",value:function setDoneCallback(callback){this.doneCallback=callback;return this;}},{key:"callStartCallback",value:function callStartCallback(total){if(!this.started&&total>this.time){this.startCallback&&this.startCallback();this.started=true;}}},{key:"callDoneCallback",value:function callDoneCallback(total){if(total>this.time+this.duration&&!this.done){this.doneCallback&&this.doneCallback();this.done=true;}}},{key:"getDuration",value:function getDuration(){return 0;}},{key:"deactivate",value:function deactivate(){}},{key:"reset",value:function reset(){}},{key:"cleanUp",value:function cleanUp(){}},{key:"update",value:function update(gameData){}},{key:"render",value:function render(now,total,last,delta,goingBack){}},{key:"getRandomPosition",value:function getRandomPosition(distance){return new utils_Vector(this.getRandom()*distance-distance*0.5,this.getRandom()*distance-distance*0.5,this.getRandom()*distance-distance*0.5);}}]);return Animation;}();/* harmony default export */ var animation_Animation = (Animation_Animation);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/BaseParticle.js
var changeAttribute=function changeAttribute(geometry,index,key,values){values=[].concat(values);var target=geometry.attributes[key].array;values.forEach(function(value,i){target[index*values.length+i]=value;});geometry.attributes[key].needsUpdate=true;};var TEXTURE_GAS=0;var TEXTURE_BOLT=1;var TEXTURE_GLOW=2;var TEXTURE_RING=3;var TEXTURE_STARLINE=4;var BaseParticle_BaseParticle=/*#__PURE__*/function(){function BaseParticle(material,geometry){Object(classCallCheck["a" /* default */])(this,BaseParticle);this.material=material;this.geometry=geometry;this.index=0;this.emitter=null;this.texture={gas:TEXTURE_GAS,bolt:TEXTURE_BOLT,glow:TEXTURE_GLOW,ring:TEXTURE_RING,starLine:TEXTURE_STARLINE};}Object(createClass["a" /* default */])(BaseParticle,[{key:"create",value:function create(index,emitter){this.index=index;this.emitter=emitter;this.setInitialValues();return this;}},{key:"aquire",value:function aquire(index,emitter){this.index=index;this.emitter=emitter;return this;}},{key:"setInitialValues",value:function setInitialValues(){this.setPosition({x:0,y:0,z:0});this.setColor(new three_module["Color"](0,0,0));this.setOpacity(0.0);this.setFadeIn(0.0,0.0);this.setFadeOut(0.0,0.0);this.setSize(0.0);this.setSizeChange(0.0);this.setAngle(0.0,0.0);this.setActivationTime(0.0);this.setVelocity(new three_module["Vector3"](0,0,0));this.setAcceleration(new three_module["Vector3"](0,0,0));this.setTexture(this.texture.glow);this.setRepeat(0);return this;}},{key:"serialize",value:function serialize(){return{index:this.index,emitter:this.emitter,opacity:this.geometry.attributes["opacity"].array[this.index]};}},{key:"getIndex",value:function getIndex(){return this.index;}},{key:"setRepeat",value:function setRepeat(repeat){changeAttribute(this.geometry,this.index,"repeat",repeat);return this;}},{key:"setSine",value:function setSine(frequency,amplitude){var value=Math.floor(frequency)+amplitude;changeAttribute(this.geometry,this.index,"sine",value);return this;}},{key:"setTexture",value:function setTexture(tex){changeAttribute(this.geometry,this.index,"textureNumber",tex);return this;}},{key:"setSize",value:function setSize(size){changeAttribute(this.geometry,this.index,"size",size);return this;}},{key:"setSizeChange",value:function setSizeChange(size){changeAttribute(this.geometry,this.index,"sizeChange",size);return this;}},{key:"setColor",value:function setColor(color){changeAttribute(this.geometry,this.index,"color",[color.r,color.g,color.b]);return this;}},{key:"setOpacity",value:function setOpacity(opacity){changeAttribute(this.geometry,this.index,"opacity",opacity);return this;}},{key:"setFadeIn",value:function setFadeIn(time){var speed=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1000;changeAttribute(this.geometry,this.index,"fadeInTime",time);changeAttribute(this.geometry,this.index,"fadeInSpeed",speed);return this;}},{key:"setFadeOut",value:function setFadeOut(time){var speed=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1000;changeAttribute(this.geometry,this.index,"fadeOutTime",time);changeAttribute(this.geometry,this.index,"fadeOutSpeed",speed);return this;}},{key:"setPosition",value:function setPosition(pos){changeAttribute(this.geometry,this.index,"position",[pos.x,pos.y,pos.z],true);return this;}},{key:"setAngle",value:function setAngle(angle){var change=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var value=Math.floor(degreeToRadian(angle)*1000)+Math.floor(degreeToRadian(change)*1000)*10000;changeAttribute(this.geometry,this.index,"angle",value);return this;}},{key:"setVelocity",value:function setVelocity(velocity){changeAttribute(this.geometry,this.index,"velocity",[velocity.x,velocity.y,velocity.z]);return this;}},{key:"setAcceleration",value:function setAcceleration(acceleration){changeAttribute(this.geometry,this.index,"acceleration",[acceleration.x,acceleration.y,acceleration.z]);return this;}},{key:"deactivate",value:function deactivate(){this.setInitialValues();return this;}},{key:"setActivationTime",value:function setActivationTime(gameTime){changeAttribute(this.geometry,this.index,"activationGameTime",gameTime);return this;}}]);return BaseParticle;}();/* harmony default export */ var particle_BaseParticle = (BaseParticle_BaseParticle);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/ParticleEmitter.js
var ParticleEmitter_texture=new three_module["TextureLoader"]().load("/img/effect/effectTextures1024.png");var ParticleEmitter_ParticleEmitter=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ParticleEmitter,_Animation);function ParticleEmitter(scene,particleCount){var _this;var args=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};Object(classCallCheck["a" /* default */])(this,ParticleEmitter);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ParticleEmitter).call(this));var blending=args.blending||three_module["AdditiveBlending"];if(!particleCount){particleCount=1000;}_this.scene=scene;_this.free=[];for(var i=0;i<particleCount;i++){_this.free.push(i);}_this.effects=0;var uniforms={gameTime:{type:"f",value:0.0},zoomLevel:{type:"f",value:1.0},texture:{type:"t",value:ParticleEmitter_texture}};_this.particleGeometry=new three_module["BufferGeometry"]();_this.particleGeometry.setAttribute("position",new three_module["Float32BufferAttribute"](new Float32Array(particleCount*3),3).setDynamic(true));_this.particleGeometry.setAttribute("size",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("sizeChange",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("color",new three_module["Float32BufferAttribute"](new Float32Array(particleCount*3),3).setDynamic(true));_this.particleGeometry.setAttribute("opacity",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("fadeInTime",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("fadeInSpeed",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("fadeOutTime",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("fadeOutSpeed",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("activationGameTime",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("velocity",new three_module["Float32BufferAttribute"](new Float32Array(particleCount*3),3).setDynamic(true));_this.particleGeometry.setAttribute("acceleration",new three_module["Float32BufferAttribute"](new Float32Array(particleCount*3),3).setDynamic(true));_this.particleGeometry.setAttribute("textureNumber",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("angle",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("sine",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("repeat",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.dynamic=true;_this.particleGeometry.setDrawRange(0,particleCount);_this.particleMaterial=new three_module["ShaderMaterial"]({uniforms:uniforms,vertexShader:shader_effectVertexShader,fragmentShader:shader_effectFragmentShader,transparent:true,blending:blending,depthWrite:false,depthTest:false});/*
        THREE.NormalBlending = 0;
        THREE.AdditiveBlending = 1;
        THREE.SubtractiveBlending = 2;
        THREE.MultiplyBlending = 3;
        THREE.AdditiveAlphaBlending = 4;
        */_this.flyParticle=new particle_BaseParticle(_this.particleMaterial,_this.particleGeometry);while(particleCount--){_this.flyParticle.create(particleCount).setInitialValues();}_this.mesh=new three_module["Points"](_this.particleGeometry,_this.particleMaterial);_this.mesh.position.set(0,0,0);_this.mesh.frustumCulled=false;_this.needsUpdate=false;_this.scene.add(_this.mesh);return _this;}Object(createClass["a" /* default */])(ParticleEmitter,[{key:"setPosition",value:function setPosition(_ref){var x=_ref.x,y=_ref.y,z=_ref.z;this.mesh.position.set(x,y,z);this.needsUpdate=true;}},{key:"cleanUp",value:function cleanUp(){this.mesh.material.dispose();this.scene.remove(this.mesh);}},{key:"render",value:function render(_ref2){var total=_ref2.total,zoom=_ref2.zoom;this.particleMaterial.uniforms.gameTime.value=total;this.particleMaterial.uniforms.zoomLevel.value=1/zoom;this.mesh.material.needsUpdate=true;}},{key:"hasFree",value:function hasFree(){return this.free.length>0;}},{key:"getParticle",value:function getParticle(){if(this.free.length===0){return false;}var i=this.free.pop();return this.flyParticle.create(i,this);}},{key:"getByIndex",value:function getByIndex(index){return this.flyParticle.aquire(index,this);}},{key:"freeParticles",value:function freeParticles(particleIndices){particleIndices=[].concat(particleIndices);particleIndices.forEach(function(i){this.flyParticle.create(i).setInitialValues();},this);this.free=this.free.concat(particleIndices);}}]);return ParticleEmitter;}(animation_Animation);/* harmony default export */ var particle_ParticleEmitter = (ParticleEmitter_ParticleEmitter);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/BoltParticleEmitter/BoltInstance.js
var BoltInstance_BoltInstance=/*#__PURE__*/function(){function BoltInstance(boltContainer){Object(classCallCheck["a" /* default */])(this,BoltInstance);this.boltContainer=boltContainer;this.index=null;this.emitter=null;}Object(createClass["a" /* default */])(BoltInstance,[{key:"serialize",value:function serialize(){return{index:this.index,emitter:this.emitter};}},{key:"setIndex",value:function setIndex(index){this.index=index;return this;}},{key:"setEmitter",value:function setEmitter(emitter){this.emitter=emitter;return this;}},{key:"setOpacity",value:function setOpacity(opacity){this.boltContainer.setOpacity(this.index,opacity);return this;}},{key:"setPosition",value:function setPosition(position){this.boltContainer.setPosition(this.index,position);return this;}},{key:"setScale",value:function setScale(){var length=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var width=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this.boltContainer.setScale(this.index,{x:length,y:width,z:width});return this;}},{key:"setRotation",value:function setRotation(rotation){var quaternion=new three_module["Quaternion"]();quaternion.setFromUnitVectors(new three_module["Vector3"](1,0,0).normalize(),new utils_Vector(rotation).normalize());this.boltContainer.setQuaternion(this.index,quaternion);return this;}},{key:"unsetTexture",value:function unsetTexture(){this.boltContainer.setTexture(this.index,-1);return this;}},{key:"setGasTexture",value:function setGasTexture(){this.boltContainer.setTexture(this.index,0);return this;}},{key:"setBoltTexture",value:function setBoltTexture(){this.boltContainer.setTexture(this.index,1);return this;}},{key:"setHaloTexture",value:function setHaloTexture(){this.boltContainer.setTexture(this.index,2);return this;}},{key:"setRayTexture",value:function setRayTexture(){this.boltContainer.setTexture(this.index,3);return this;}},{key:"setColor",value:function setColor(color){this.boltContainer.setColor(this.index,color);return this;}},{key:"setVelocity",value:function setVelocity(velocity){this.boltContainer.setVelocity(this.index,velocity);return this;}},{key:"setActivationTime",value:function setActivationTime(time){this.boltContainer.setActivationTime(this.index,time);return this;}},{key:"setDeactivationTime",value:function setDeactivationTime(time,fade){this.boltContainer.setDeactivationTime(this.index,time,fade);return this;}},{key:"setRepeat",value:function setRepeat(repeat){this.boltContainer.setRepeat(this.index,repeat);return this;}}]);return BoltInstance;}();/* harmony default export */ var BoltParticleEmitter_BoltInstance = (BoltInstance_BoltInstance);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/BoltParticleEmitter/BoltContainer.js
var BoltContainer_BoltContainer=/*#__PURE__*/function(){function BoltContainer(offsetAttribute,opacityAttribute,textureNumberAttribute,scaleAttribute,quaternionAttribute,colorAttribute,velocityAttribute,activationGameTimeAttribute,deactivationGameTimeAttribute,deactivationFadeAttribute,repeatAttribute,amount,mesh,scene,numberCreated){Object(classCallCheck["a" /* default */])(this,BoltContainer);this.amount=amount;this.offsetAttribute=offsetAttribute;this.opacityAttribute=opacityAttribute;this.textureNumberAttribute=textureNumberAttribute;this.scaleAttribute=scaleAttribute;this.quaternionAttribute=quaternionAttribute;this.colorAttribute=colorAttribute;this.velocityAttribute=velocityAttribute;this.activationGameTimeAttribute=activationGameTimeAttribute;this.deactivationGameTimeAttribute=deactivationGameTimeAttribute;this.deactivationFadeAttribute=deactivationFadeAttribute;this.repeatAttribute=repeatAttribute;this.mesh=mesh;this.scene=scene;this.numberCreated=numberCreated;this.free=[];for(var i=0;i<this.amount;i++){this.free.push(i);}this.flyBolt=new BoltParticleEmitter_BoltInstance(this);}Object(createClass["a" /* default */])(BoltContainer,[{key:"setRenderOrder",value:function setRenderOrder(order){//console.log(this.mesh.renderOrder);
//console.log("setting renderOrder ", order);
//this.mesh.renderOrder = order;
}},{key:"hasFree",value:function hasFree(){return this.free.length>0;}},{key:"discard",value:function discard(){this.scene.remove(this.mesh);}},{key:"resetIndex",value:function resetIndex(){this.used=0;}},{key:"unassignEverything",value:function unassignEverything(){var opacitys=[];for(var i=0;i<this.amount;i++){opacitys.push(0);}this.opacityAttribute.setArray(opacitys);this.opacityAttribute.needsUpdate=true;this.used=0;}},{key:"freeParticles",value:function freeParticles(particleIndices){var _this=this;particleIndices=[].concat(particleIndices);particleIndices=particleIndices.filter(function(index){return!_this.free.includes(index);});particleIndices.forEach(function(i){this.opacityAttribute.setX(i,0);},this);this.opacityAttribute.needsUpdate=true;this.free=this.free.concat(particleIndices);}},{key:"getParticle",value:function getParticle(){if(this.free.length===0){throw new Error("Container is full");}return this.flyBolt.setIndex(this.free.pop()).setEmitter(this);}},{key:"setOpacity",value:function setOpacity(index,opacity){this.opacityAttribute.setX(index,opacity);this.opacityAttribute.needsUpdate=true;}},{key:"setPosition",value:function setPosition(index,position){this.offsetAttribute.setXYZ(index,position.x,position.y,position.z);this.offsetAttribute.needsUpdate=true;}},{key:"setParentPosition",value:function setParentPosition(_ref){var x=_ref.x,y=_ref.y,z=_ref.z;this.mesh.position.set(x,y,z);}},{key:"setScale",value:function setScale(index,scale){this.scaleAttribute.setXYZ(index,scale.x,scale.y,scale.z);this.scaleAttribute.needsUpdate=true;}},{key:"setQuaternion",value:function setQuaternion(index,quaternion){this.quaternionAttribute.setXYZW(index,quaternion.x,quaternion.y,quaternion.z,quaternion.w);this.quaternionAttribute.needsUpdate=true;}},{key:"setTexture",value:function setTexture(index,texture){this.textureNumberAttribute.setX(index,texture);this.textureNumberAttribute.needsUpdate=true;}},{key:"setColor",value:function setColor(index,color){this.colorAttribute.setXYZ(index,color.r,color.g,color.b);this.colorAttribute.needsUpdate=true;}},{key:"setVelocity",value:function setVelocity(index,velocity){this.velocityAttribute.setXYZ(index,velocity.x,velocity.y,velocity.z);this.velocityAttribute.needsUpdate=true;}},{key:"setActivationTime",value:function setActivationTime(index,time){this.activationGameTimeAttribute.setX(index,time);this.activationGameTimeAttribute.needsUpdate=true;}},{key:"setDeactivationTime",value:function setDeactivationTime(index,time){var fade=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;this.deactivationGameTimeAttribute.setX(index,time);this.deactivationFadeAttribute.setX(index,fade);this.deactivationGameTimeAttribute.needsUpdate=true;this.deactivationFadeAttribute.needsUpdate=true;}},{key:"setRepeat",value:function setRepeat(index,repeat){this.repeatAttribute.setX(index,repeat);this.repeatAttribute.needsUpdate=true;}}]);return BoltContainer;}();/* harmony default export */ var BoltParticleEmitter_BoltContainer = (BoltContainer_BoltContainer);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/BoltParticleEmitter/BoltInstanceFactory.js
var loadedCube=null;var BoltInstanceFactory_numberCreated=0;var BoltInstanceFactory_BoltInstanceFactory=/*#__PURE__*/function(){function BoltInstanceFactory(scene){var _this=this;Object(classCallCheck["a" /* default */])(this,BoltInstanceFactory);this.scene=scene;this.ready=new Promise(/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(resolve){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(loadedCube){_context.next=4;break;}_context.next=3;return _this.loadCube();case 3:loadedCube=_context.sent;case 4:resolve(true);case 5:case"end":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());var texture=new three_module["TextureLoader"]().load(//"/img/offline.png"
"/img/effect/effectTextures1024.png");//texture.minFilter = THREE.LinearMipMapNearestFilter;
/*
    THREE.NearestFilter
THREE.NearestMipMapNearestFilter
THREE.NearestMipMapLinearFilter
THREE.LinearFilter
THREE.LinearMipMapNearestFilter
THREE.LinearMipMapLinearFilter
*/this.material=new three_module["RawShaderMaterial"]({uniforms:{map:{value:texture},gameTime:{type:"f",value:0.0},zoomLevel:{type:"f",value:0.0}},transparent:true,depthWrite:false,depthTest:false,side:three_module["DoubleSide"],blending:three_module["AdditiveBlending"],vertexShader:shader_boltVertexShader,fragmentShader:shader_boltFragmentShader//wireframe: true
});this.start=Date.now()/3000;}Object(createClass["a" /* default */])(BoltInstanceFactory,[{key:"render",value:function render(_ref2){var total=_ref2.total,zoom=_ref2.zoom;this.material.uniforms.gameTime.value=total;this.material.uniforms.zoomLevel.value=1/zoom;this.material.needsUpdate=true;}},{key:"create",value:function create(){var size=arguments.length>0&&arguments[0]!==undefined?arguments[0]:2000;return this.makeInstanced(loadedCube,size);}},{key:"loadCube",value:function(){var _loadCube=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(){var cube,cubeGeometry;return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!loadedCube){_context2.next=2;break;}return _context2.abrupt("return",loadedCube);case 2:_context2.next=4;return loadObject("/img/3d/effect/bolt/scene.gltf");case 4:cube=_context2.sent;cubeGeometry=cube.scene.children[0].geometry;//cubeGeometry.rotateY((90 * Math.PI) / 180);
//cubeGeometry.scale(0.5, 0.5, 0.5);
loadedCube=cubeGeometry;return _context2.abrupt("return",loadedCube);case 8:case"end":return _context2.stop();}}},_callee2);}));function loadCube(){return _loadCube.apply(this,arguments);}return loadCube;}()},{key:"makeInstanced",value:function makeInstanced(original,amount){original=original.clone();var offsetAttribute,opacityAttribute,textureNumberAttribute,scaleAttribute,quaternionAttribute,colorAttribute,velocityAttribute,activationGameTimeAttribute,deactivationGameTimeAttribute,deactivationFadeAttribute,repeatAttribute;var geometry=new three_module["InstancedBufferGeometry"]();geometry.index=original.index;geometry.attributes.position=original.attributes.position;geometry.attributes.uv=original.attributes.uv;var offsets=[];var opacitys=[];var textureNumbers=[];var scales=[];var quaternions=[];var colors=[];var velocitys=[];var activations=[];var deactivations=[];var fades=[];var repeats=[];for(var i=0;i<amount;i++){offsets.push(0,0,0.5);opacitys.push(0);textureNumbers.push(-1);scales.push(1,1,1);quaternions.push(0,1,0,0);colors.push(0,0,0);velocitys.push(0,0,0);activations.push(0);deactivations.push(0);fades.push(0);repeats.push(0);}offsetAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(offsets),3).setDynamic(true);opacityAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(opacitys),1).setDynamic(true);textureNumberAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(textureNumbers),1).setDynamic(true);scaleAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(scales),3).setDynamic(true);quaternionAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(quaternions),4).setDynamic(true);colorAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(colors),3).setDynamic(true);velocityAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(velocitys),3).setDynamic(true);activationGameTimeAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(activations),1).setDynamic(true);deactivationGameTimeAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(deactivations),1).setDynamic(true);deactivationFadeAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(fades),1).setDynamic(true);repeatAttribute=new three_module["InstancedBufferAttribute"](new Float32Array(repeats),1).setDynamic(true);geometry.setAttribute("offset",offsetAttribute);geometry.setAttribute("opacity",opacityAttribute);geometry.setAttribute("textureNumber",textureNumberAttribute);geometry.setAttribute("scale",scaleAttribute);geometry.setAttribute("quaternion",quaternionAttribute);geometry.setAttribute("color",colorAttribute);geometry.setAttribute("velocity",velocityAttribute);geometry.setAttribute("activationGameTime",activationGameTimeAttribute);geometry.setAttribute("deactivationGameTime",deactivationGameTimeAttribute);geometry.setAttribute("deactivationFade",deactivationFadeAttribute);geometry.setAttribute("repeat",repeatAttribute);var mesh=new three_module["Mesh"](geometry,this.material);mesh.frustumCulled=false;this.scene.add(mesh);BoltInstanceFactory_numberCreated++;return new BoltParticleEmitter_BoltContainer(offsetAttribute,opacityAttribute,textureNumberAttribute,scaleAttribute,quaternionAttribute,colorAttribute,velocityAttribute,activationGameTimeAttribute,deactivationGameTimeAttribute,deactivationFadeAttribute,repeatAttribute,amount,mesh,this.scene,BoltInstanceFactory_numberCreated);}}]);return BoltInstanceFactory;}();/* harmony default export */ var BoltParticleEmitter_BoltInstanceFactory = (BoltInstanceFactory_BoltInstanceFactory);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/ParticleEmitterContainer.js
var ParticleEmitterContainer_ParticleEmitterContainer=/*#__PURE__*/function(){function ParticleEmitterContainer(scene,defaultParticleAmount){var _this=this;Object(classCallCheck["a" /* default */])(this,ParticleEmitterContainer);this.scene=scene;this.defaultParticleAmount=defaultParticleAmount;this.boltInstanceFactory=new BoltParticleEmitter_BoltInstanceFactory(this.scene);this.reservations=[];this.emitters={star:[],bolt:[],effect:[],normal:[]};this._isReady=false;this.readyPromise=new Promise(/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(resolve){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.boltInstanceFactory.ready;case 2:_this._isReady=true;resolve(true);case 4:case"end":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());this.position=new utils_Vector();}Object(createClass["a" /* default */])(ParticleEmitterContainer,[{key:"ready",value:function ready(){return this.readyPromise;}},{key:"isReady",value:function isReady(){return this._isReady;}},{key:"createParticleEmitter",value:function createParticleEmitter(type){switch(type){case"star":return this.createStarParticleEmitter();case"bolt":return this.createBoltParticleEmitter();case"normal":return this.createNormalParticleEmitter();case"effect":default:return this.createEffectParticleEmitter();}}},{key:"createStarParticleEmitter",value:function createStarParticleEmitter(){var emitter=new particle_StarParticleEmitter(this.scene,this.defaultParticleAmount);emitter.setPosition(this.position);return emitter;}},{key:"createEffectParticleEmitter",value:function createEffectParticleEmitter(){var emitter=new particle_ParticleEmitter(this.scene,this.defaultParticleAmount);emitter.setPosition(this.position);return emitter;}},{key:"createNormalParticleEmitter",value:function createNormalParticleEmitter(){var emitter=new particle_ParticleEmitter(this.scene,this.defaultParticleAmount,{blending:three_module["NormalBlending"]});emitter.setPosition(this.position);return emitter;}},{key:"createBoltParticleEmitter",value:function createBoltParticleEmitter(){var emitter=this.boltInstanceFactory.create(this.defaultParticleAmount);emitter.setParentPosition(this.position);return emitter;}},{key:"getParticle",value:function getParticle(reserver){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"effect";var emitter=this.emitters[type].find(function(emitter){return emitter.hasFree();});if(!emitter){emitter=this.createParticleEmitter(type);this.emitters[type].push(emitter);}var particle=emitter.getParticle();this.reservations.push({reserver:reserver,emitter:emitter,index:particle.index});return particle;}},{key:"getStarParticle",value:function getStarParticle(reserver){return this.getParticle(reserver,"star");}},{key:"getBoltParticle",value:function getBoltParticle(reserver){return this.getParticle(reserver,"bolt");}},{key:"getEffectParticle",value:function getEffectParticle(reserver){return this.getParticle(reserver,"effect");}},{key:"getNormalParticle",value:function getNormalParticle(reserver){return this.getParticle(reserver,"normal");}},{key:"setPosition",value:function setPosition(position){this.position=position;this.emitters.bolt.forEach(function(emitter){return emitter.setParentPosition(position);});this.emitters.star.forEach(function(emitter){return emitter.setPosition(position);});this.emitters.effect.forEach(function(emitter){return emitter.setPosition(position);});this.emitters.normal.forEach(function(emitter){return emitter.setPosition(position);});}},{key:"cleanUp",value:function cleanUp(){this.emitters.star.forEach(function(emitter){emitter.cleanUp();});this.emitters.bolt.forEach(function(emitter){emitter.cleanUp();});this.emitters.effect.forEach(function(emitter){emitter.cleanUp();});this.emitters.normal.forEach(function(emitter){emitter.cleanUp();});this.emitters={star:[],bolt:[],effect:[],normal:[]};}},{key:"release",value:function release(reserver){this.reservations.forEach(function(reservation){if(reservation.reserver===reserver){reservation.emitter.freeParticles(reservation.index);}});}},{key:"render",value:function render(payload){this.emitters.star.forEach(function(emitter){emitter.render(payload);});this.emitters.effect.forEach(function(emitter){emitter.render(payload);});this.emitters.normal.forEach(function(emitter){emitter.render(payload);});this.boltInstanceFactory.render(payload);}}]);return ParticleEmitterContainer;}();/* harmony default export */ var particle_ParticleEmitterContainer = (ParticleEmitterContainer_ParticleEmitterContainer);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/StarParticle.js
var StarParticle_changeAttribute=function changeAttribute(geometry,index,key,values){values=[].concat(values);var target=geometry.attributes[key].array;values.forEach(function(value,i){target[index*values.length+i]=value;});geometry.attributes[key].needsUpdate=true;};var StarParticle_StarParticle=/*#__PURE__*/function(){function StarParticle(material,geometry){Object(classCallCheck["a" /* default */])(this,StarParticle);this.material=material;this.geometry=geometry;this.index=0;this.emitter=null;this.texture={gas:0,bolt:1,glow:2,ring:3,starLine:4};}Object(createClass["a" /* default */])(StarParticle,[{key:"create",value:function create(index,emitter){this.index=index;this.emitter=emitter;return this;}},{key:"setInitialValues",value:function setInitialValues(){this.setPosition({x:0,y:0});this.setColor(new three_module["Color"](0,0,0));this.setOpacity(0.0);this.setSize(0.0);this.setSizeChange(0.0);this.setAngle(0.0);this.setAngleChange(0.0);this.setActivationTime(0.0);this.setTexture(this.texture.glow);this.setParallaxFactor(0.0);this.setSineFrequency(0.0);this.setSineAmplitude(1);return this;}},{key:"serialize",value:function serialize(){return{index:this.index,emitter:this.emitter};}},{key:"setTexture",value:function setTexture(tex){StarParticle_changeAttribute(this.geometry,this.index,"textureNumber",tex);return this;}},{key:"setParallaxFactor",value:function setParallaxFactor(parallaxFactor){StarParticle_changeAttribute(this.geometry,this.index,"parallaxFactor",-1.0+parallaxFactor);return this;}},{key:"setSineFrequency",value:function setSineFrequency(sineFrequency){StarParticle_changeAttribute(this.geometry,this.index,"sineFrequency",sineFrequency);return this;}},{key:"setSineAmplitude",value:function setSineAmplitude(sineAmplitude){StarParticle_changeAttribute(this.geometry,this.index,"sineAmplitude",sineAmplitude);return this;}},{key:"setSize",value:function setSize(size){StarParticle_changeAttribute(this.geometry,this.index,"size",size);return this;}},{key:"setSizeChange",value:function setSizeChange(size){StarParticle_changeAttribute(this.geometry,this.index,"sizeChange",size);return this;}},{key:"setColor",value:function setColor(color){StarParticle_changeAttribute(this.geometry,this.index,"color",[color.r,color.g,color.b]);return this;}},{key:"setOpacity",value:function setOpacity(opacity){StarParticle_changeAttribute(this.geometry,this.index,"opacity",opacity);return this;}},{key:"setPosition",value:function setPosition(pos){StarParticle_changeAttribute(this.geometry,this.index,"position",[pos.x,pos.y,pos.z||0],true);return this;}},{key:"setAngle",value:function setAngle(angle){StarParticle_changeAttribute(this.geometry,this.index,"angle",degreeToRadian(angle));return this;}},{key:"setAngleChange",value:function setAngleChange(angle){StarParticle_changeAttribute(this.geometry,this.index,"angleChange",degreeToRadian(angle));return this;}},{key:"deactivate",value:function deactivate(){this.setInitialValues();return this;}},{key:"setActivationTime",value:function setActivationTime(gameTime){StarParticle_changeAttribute(this.geometry,this.index,"activationGameTime",gameTime);return this;}}]);return StarParticle;}();/* harmony default export */ var particle_StarParticle = (StarParticle_StarParticle);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/StarParticleEmitter.js
var StarParticleEmitter_texture=new three_module["TextureLoader"]().load("/img/effect/effectTextures1024.png");var StarParticleEmitter_StarParticleEmitter=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(StarParticleEmitter,_Animation);function StarParticleEmitter(scene,particleCount,args){var _this;Object(classCallCheck["a" /* default */])(this,StarParticleEmitter);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StarParticleEmitter).call(this));if(!args){args={};}var blending=args.blending||three_module["AdditiveBlending"];if(!particleCount){particleCount=1000;}_this.scene=scene;_this.free=[];for(var i=0;i<particleCount;i++){_this.free.push(i);}_this.effects=0;var uniforms={gameTime:{type:"f",value:0.0},texture:{type:"t",value:StarParticleEmitter_texture}};_this.particleGeometry=new three_module["BufferGeometry"]();_this.particleGeometry.setAttribute("position",new three_module["Float32BufferAttribute"](new Float32Array(particleCount*3),3).setDynamic(true));_this.particleGeometry.setAttribute("size",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("sizeChange",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("color",new three_module["Float32BufferAttribute"](new Float32Array(particleCount*3),3).setDynamic(true));_this.particleGeometry.setAttribute("opacity",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("activationGameTime",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("textureNumber",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("angle",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("angleChange",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("parallaxFactor",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("sineFrequency",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.setAttribute("sineAmplitude",new three_module["Float32BufferAttribute"](new Float32Array(particleCount),1).setDynamic(true));_this.particleGeometry.dynamic=true;_this.particleGeometry.setDrawRange(0,particleCount);_this.particleMaterial=new three_module["ShaderMaterial"]({uniforms:uniforms,vertexShader:shader_starVertexShader,fragmentShader:shader_starFragmentShader,transparent:true,blending:blending,depthWrite:false//Try removing this if problems with transparency
});/*
        THREE.NormalBlending = 0;
        THREE.AdditiveBlending = 1;
        THREE.SubtractiveBlending = 2;
        THREE.MultiplyBlending = 3;
        THREE.AdditiveAlphaBlending = 4;
        */_this.flyParticle=new particle_StarParticle(_this.particleMaterial,_this.particleGeometry);while(particleCount--){_this.flyParticle.create(particleCount).setInitialValues();}_this.mesh=new three_module["Points"](_this.particleGeometry,_this.particleMaterial);_this.mesh.frustumCulled=false;//this.mesh.matrixAutoUpdate = false;
_this.mesh.position.set(0,0,args.z||-10);_this.needsUpdate=false;_this.scene.add(_this.mesh);return _this;}Object(createClass["a" /* default */])(StarParticleEmitter,[{key:"setPosition",value:function setPosition(_ref){var x=_ref.x,y=_ref.y,z=_ref.z;this.mesh.position.set(x,y,z);this.needsUpdate=true;}},{key:"cleanUp",value:function cleanUp(){this.mesh.material.dispose();this.scene.remove(this.mesh);}},{key:"render",value:function render(_ref2){var total=_ref2.total;this.particleMaterial.uniforms.gameTime.value=total;this.mesh.material.needsUpdate=true;}},{key:"hasFree",value:function hasFree(){return this.free.length>0;}},{key:"getParticle",value:function getParticle(){if(this.free.length===0){return false;}var i=this.free.pop();return this.flyParticle.create(i);}},{key:"freeParticles",value:function freeParticles(particleIndices){particleIndices=[].concat(particleIndices);particleIndices.forEach(function(i){this.flyParticle.create(i).setInitialValues();},this);this.free=this.free.concat(particleIndices);}}]);return StarParticleEmitter;}(animation_Animation);/* harmony default export */ var particle_StarParticleEmitter = (StarParticleEmitter_StarParticleEmitter);
// CONCATENATED MODULE: ./src/client/view/game/animation/particle/index.js

// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/ShipObjectBoundingBox.js
var ShipObjectBoundingBox_ShipObjectBoundingBox=/*#__PURE__*/function(){function ShipObjectBoundingBox(ship){Object(classCallCheck["a" /* default */])(this,ShipObjectBoundingBox);this.ship=ship;}Object(createClass["a" /* default */])(ShipObjectBoundingBox,[{key:"init",value:function init(dimensions){this.dimensions=dimensions;}},{key:"getAmountOfVerticalSections",value:function getAmountOfVerticalSections(){var amount=1;if(this.ship.systems.sections.hasFrontSectionWithStructure()){amount++;}if(this.ship.systems.sections.hasAftSectionWithStructure()){amount++;}return amount;}},{key:"getAmountOfHorizontalSections",value:function getAmountOfHorizontalSections(section){var amount=1;if(section instanceof systemSection_FrontSection){if(this.ship.systems.sections.hasStarboardFrontSectionWithStructure()){amount++;}if(this.ship.systems.sections.hasPortFrontSectionWithStructure()){amount++;}return amount;}else if(section instanceof systemSection_PrimarySection){return 1;}else if(section instanceof systemSection_AftSection){if(this.ship.systems.sections.hasStarboardAftSectionWithStructure()){amount++;}if(this.ship.systems.sections.hasPortAftSectionWithStructure()){amount++;}return amount;}else if(section instanceof systemSection_PortFrontSection){if(this.ship.systems.sections.hasStarboardFrontSectionWithStructure()){amount++;}if(this.ship.systems.sections.hasFrontSectionWithStructure()){amount++;}return amount;}else if(section instanceof systemSection_StarboardFrontSection){if(this.ship.systems.sections.hasPortFrontSectionWithStructure()){amount++;}if(this.ship.systems.sections.hasFrontSectionWithStructure()){amount++;}return amount;}else if(section instanceof systemSection_PortAftSection){if(this.ship.systems.sections.hasStarboardAftSectionWithStructure()){amount++;}if(this.ship.systems.sections.hasAftSectionWithStructure()){amount++;}return amount;}else if(section instanceof systemSection_StarboardAftSection){if(this.ship.systems.sections.hasPortAftSectionWithStructure()){amount++;}if(this.ship.systems.sections.hasAftSectionWithStructure()){amount++;}return amount;}}},{key:"getBoundsForSectionDisregardStructure",value:function getBoundsForSectionDisregardStructure(section){var _this$getX=this.getX(section,true),startX=_this$getX.start,endX=_this$getX.end;var _this$getY=this.getY(section,true),startY=_this$getY.start,endY=_this$getY.end;return{start:new utils_Vector(startX,startY,-this.dimensions.z/2),end:new utils_Vector(endX,endY,this.dimensions.z/2)};}},{key:"getBoundsForSection",value:function getBoundsForSection(section){var _this$getX2=this.getX(section),startX=_this$getX2.start,endX=_this$getX2.end;var _this$getY2=this.getY(section),startY=_this$getY2.start,endY=_this$getY2.end;return{start:new utils_Vector(startX,startY,-this.dimensions.z/2),end:new utils_Vector(endX,endY,this.dimensions.z/2)};}},{key:"getY",value:function getY(section){var disregardStructure=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var horizontal=disregardStructure?3:this.getAmountOfHorizontalSections(section);if(section instanceof systemSection_FrontSection||section instanceof systemSection_AftSection){return{start:-this.dimensions.y/horizontal/2,end:this.dimensions.y/horizontal/2};}else if(section instanceof systemSection_StarboardFrontSection||section instanceof systemSection_StarboardAftSection){return{start:-this.dimensions.y/2,// -50
end:-this.dimensions.y/2+this.dimensions.y/horizontal// -50 + (100, 50, 33) = 50, 0, -17
};}else if(section instanceof systemSection_PortFrontSection||section instanceof systemSection_PortAftSection){return{start:this.dimensions.y/2-this.dimensions.y/horizontal,// 50 - (100, 50, 33) = -50, 0, 17
end:this.dimensions.y/2// 50
};}else if(section instanceof systemSection_PrimarySection){return{start:-this.dimensions.y/2,end:this.dimensions.y/2};}}},{key:"getX",value:function getX(section){var disregardStructure=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var vertical=disregardStructure?3:this.getAmountOfVerticalSections();if(section instanceof systemSection_FrontSection||section instanceof systemSection_StarboardFrontSection||section instanceof systemSection_PortFrontSection){return{start:this.dimensions.x/2-this.dimensions.x/vertical,//50 - (100, 50, 33) = -50, 0, 17,
end:this.dimensions.x/2// 50
};}else if(section instanceof systemSection_PrimarySection){return{start:-this.dimensions.x/vertical/2,end:this.dimensions.x/vertical/2};}else if(section instanceof systemSection_AftSection||section instanceof systemSection_StarboardAftSection||section instanceof systemSection_PortAftSection){return{start:-this.dimensions.x/2,// -50
end:-this.dimensions.x/2+this.dimensions.x/vertical// -50 + (100, 50, 33) = 50, 0, -33
};}}},{key:"getRandomPositionForSystem",value:function getRandomPositionForSystem(system){var getRandom=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Math.random;var section=this.ship.systems.sections.getSectionBySystem(system);var bounds=this.getBoundsForSectionDisregardStructure(section);var boundSize=new utils_Vector(Math.abs(bounds.end.x-bounds.start.x),Math.abs(bounds.end.y-bounds.start.y),Math.abs(bounds.end.z-bounds.start.z));var offset=new utils_Vector(boundSize.x*getRandom(),boundSize.y*getRandom(),boundSize.z*getRandom());return bounds.start.add(offset).setZ(0);}},{key:"getRandomPositionOnShip",value:function getRandomPositionOnShip(){var getRandom=arguments.length>0&&arguments[0]!==undefined?arguments[0]:Math.random;return new utils_Vector(getRandom()*this.dimensions.x-this.dimensions.x/2,getRandom()*this.dimensions.y-this.dimensions.y/2);}}]);return ShipObjectBoundingBox;}();/* harmony default export */ var ships_ShipObjectBoundingBox = (ShipObjectBoundingBox_ShipObjectBoundingBox);
// CONCATENATED MODULE: ./src/client/view/game/animation/effect/BoltEffect.js
var BoltEffect_BoltEffect=/*#__PURE__*/function(){function BoltEffect(){Object(classCallCheck["a" /* default */])(this,BoltEffect);}Object(createClass["a" /* default */])(BoltEffect,[{key:"create",value:function create(startTime,startPosition,endPosition,speed,fade,duration,args,getRandom,particleEmitterContainer,context){this.particleEmitterContainer=particleEmitterContainer;var velocity=new utils_Vector(endPosition).sub(startPosition).normalize().multiplyScalar(speed);this.duration=this.createBolt(startTime,startPosition,endPosition,duration,velocity,speed,fade,args,particleEmitterContainer,getRandom,context);}},{key:"createBolt",value:function createBolt(startTime,startPosition,endPosition,duration,velocity,speed,fade,args,particleEmitterContainer,getRandom,context){var size=args.size||10;var directionNormal=endPosition.sub(startPosition).normalize();var color=args.color?new three_module["Color"](args.color[0],args.color[1],args.color[2]):new three_module["Color"](1,0,0);var tailLength=args.length?args.length:size*2;var repeat=args.repeat||0;particleEmitterContainer.getBoltParticle(context).setScale(tailLength,size).setOpacity(0.5).setPosition(startPosition).setBoltTexture().setRotation(directionNormal).setColor(color).setVelocity(velocity).setActivationTime(startTime).setDeactivationTime(startTime+duration,fade).setRepeat(repeat);var coreLength=(args.length?args.length:size*2)*0.5;var corePosition=coreLength*0.2;var coreTime=corePosition/speed;var coreOpacity=args.coreOpacity||0.5;particleEmitterContainer.getBoltParticle(context)//.setActivationTime(0)
.setScale(coreLength,size*0.5).setOpacity(coreOpacity).setPosition(startPosition).setBoltTexture().setRotation(directionNormal)//.setVelocity(velocity)
.setColor(new three_module["Color"](1,1,1)).setVelocity(velocity).setActivationTime(startTime+coreTime).setDeactivationTime(startTime+duration+coreTime,fade).setRepeat(repeat);return duration+coreTime;}}]);return BoltEffect;}();/* harmony default export */ var effect_BoltEffect = (BoltEffect_BoltEffect);
// CONCATENATED MODULE: ./src/client/view/game/animation/effect/ExplosionEffect.js
var ExplosionEffect_boltEffect=new effect_BoltEffect();var ExplosionEffect_ExplosionEffect=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ExplosionEffect,_Animation);function ExplosionEffect(emitterContainer,getRandom){var _this;var args=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var context=arguments.length>3?arguments[3]:undefined;Object(classCallCheck["a" /* default */])(this,ExplosionEffect);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ExplosionEffect).call(this,getRandom));_this.getRandomColor=function(){if(this.color){return this.color;}return new three_module["Color"]().setRGB(1,(155-Math.floor(Math.random()*75))/255,Math.floor(Math.random()*155)/255);};_this.getSmokeColor=function(){var c=(Math.random()*50+20)/255;return new three_module["Color"]().setRGB(c,c,c+0.05);};_this.emitterContainer=emitterContainer;_this.position=args.position||new utils_Vector();_this.time=args.time||0;_this.type=args.type||"gas";_this.size=args.size||16;_this.speed=args.speed||1;_this.ring=args.ring||false;_this.duration=args.duration;_this.color=args.color;_this.opacity=args.opacity||1;_this.repeat=args.repeat||0;_this.movement=args.velocity||new utils_Vector();_this.context=context;_this.create();return _this;}Object(createClass["a" /* default */])(ExplosionEffect,[{key:"create",value:function create(){switch(this.type){case"gas":this.createGas();break;case"glow":this.createGlow();break;case"emp":this.createEMP();break;case"pillar":this.createPillar();break;default:this.createGas();break;}}},{key:"createGlow",value:function createGlow(){var amount=3;this.createMainGlow(amount,this.size);this.createCore(this.size,TEXTURE_GLOW);this.createWhiteCenter(this.size*2,0.8);}},{key:"createGas",value:function createGas(){var amount=Math.ceil(this.size/4);if(amount>6){amount=6;}var shootoffs=Math.ceil(Math.random()*20+10);this.createShootOffs(shootoffs,this.size);this.createMainGlow(1,this.size);this.createCore(this.size,TEXTURE_GLOW);this.createMain(amount,this.size);this.createWhiteCenter(this.size*2,0.5);}},{key:"createPillar",value:function createPillar(){//if ( this.ring)
//	this.createRing(this.size, emitter);
var amount=Math.ceil(this.size/4);if(amount>6){amount=6;}var shootoffs=Math.ceil(Math.random()*20+10);this.createPillars(shootoffs,this.size);this.createMainGlow(Math.ceil(amount/2),this.size);}},{key:"createEMP",value:function createEMP(){//if ( this.ring)
//	this.createRing(this.size, emitter);
var amount=Math.ceil(this.size/4);if(amount>6){amount=6;}this.createEmpGlow(Math.ceil(amount/2),this.size);this.createWhiteCenter(this.size*4,0.5);this.createEmpCore(this.size,TEXTURE_GAS);}},{key:"createWhiteCenter",value:function createWhiteCenter(size,opacity){if(!opacity){opacity=1.0;}var activation=this.time;var fadeInSpeed=100;var fadeOutAt=activation+fadeInSpeed;//amount = 1;
this.emitterContainer.getParticle(this.context).setSize(size/4)//.setSizeChange(128)
.setOpacity(opacity*this.opacity).setFadeIn(activation,fadeInSpeed).setFadeOut(fadeOutAt,500).setColor({r:1,g:1,b:1}).setPosition({x:this.position.x,y:this.position.y,z:this.position.z}).setTexture(TEXTURE_GLOW).setActivationTime(activation).setRepeat(this.repeat).setVelocity(this.speed);}},{key:"createShootOffs",value:function createShootOffs(amount,radius,args){while(amount--){this.createShootOff(radius,args);}}},{key:"createShootOff",value:function createShootOff(radius,args){if(!args){args={};}var speed=(Math.random()*0.2+0.1)*this.speed*this.size*0.01;var startPosition=args.position||this.position;var endPosition=args.target||new utils_Vector(Math.random()-0.5,Math.random()-0.5,Math.random()-0.5).normalize().multiplyScalar((Math.random()*10+3)*this.size).add(startPosition);var color=this.getRandomColor();ExplosionEffect_boltEffect.create(this.time+Math.floor(Math.random()*30/this.speed),new utils_Vector(startPosition),new utils_Vector(endPosition),speed*1.5,args.fadeOutSpeed||Math.random()*500+250,Math.floor(Math.random()*500+250)/this.speed,{size:radius/3,color:[color.r,color.g,color.b],coreOpacity:0.1,repeat:this.repeat},this.getRandom,this.emitterContainer,this.context);}},{key:"createPillars",value:function createPillars(amount,radius){var size=radius;//amount = 1;
while(amount--){var particle=this.emitterContainer.getParticle(this.context);var activationTime=this.time+Math.floor(Math.random()*30/this.speed);var fadeOutAt=activationTime+Math.floor(Math.random()*50/this.speed);var angle=Math.floor(Math.random()*360);var target=getPointInDirection(0.1,-angle,0,0);particle.setSize(Math.floor(Math.random()*size)+size/2).setOpacity(Math.random()*0.1+0.9).setFadeIn(activationTime,Math.random()*50+25).setFadeOut(fadeOutAt,Math.random()*500/this.speed+250/this.speed).setColor(ExplosionEffect_getYellowColor()).setPosition({x:this.position.x,y:this.position.y,z:this.position.z}).setVelocity(target).setAngle(angle).setTexture(TEXTURE_BOLT).setActivationTime(activationTime).setRepeat(this.repeat);this.createShootOff(radius,{angle:angle,activationTime:activationTime});}}},{key:"createCore",value:function createCore(radius,texture){var size=radius;var particle=this.emitterContainer.getParticle(this.context);var activationTime=this.time+Math.random()*0.005/this.speed;var fadeOutAt=activationTime+Math.random()*0.02/this.speed+0.03/this.speed;particle.setSize(Math.floor(Math.random()*size/2)+size).setOpacity(Math.random()*0.2+0.6).setFadeIn(activationTime,Math.random()*0.005+0.0025).setFadeOut(fadeOutAt,Math.random()*0.05/this.speed+0.025/this.speed).setOpacity(this.opacity*0.5).setColor(ExplosionEffect_getCoreColor()).setPosition({x:this.position.x,// + Math.floor(Math.random()*radius/10)-radius/5,
y:this.position.y,// + Math.floor(Math.random()*radius/10)-radius/5,
z:this.position.z}).setAngle(45).setTexture(texture).setVelocity(this.movement).setAngle(Math.floor(Math.random()*360),Math.floor(Math.random()*20*this.speed)-10*this.speed).setActivationTime(activationTime).setRepeat(this.repeat);}},{key:"createEmpGlow",value:function createEmpGlow(amount,radius){var size=radius*2;while(amount--){var particle=this.emitterContainer.getParticle(this.context);var activationTime=this.time;var fadeOutAt=activationTime;particle.setSize(size).setSizeChange(0.004*this.size).setOpacity(Math.random()*0.1+0.2).setFadeIn(activationTime,Math.random()*0.005+0.0025).setFadeOut(fadeOutAt,(Math.random()*200+800)/this.speed).setColor({r:122/255,g:221/255,b:255/255}).setVelocity(this.movement).setPosition({x:this.position.x,y:this.position.y,z:this.position.z}).setTexture(TEXTURE_GLOW).setActivationTime(activationTime).setRepeat(this.repeat);}}},{key:"createEmpCore",value:function createEmpCore(radius,texture){var size=radius;var particle=this.emitterContainer.getParticle(this.context);var activationTime=this.time;var fadeOutAt=activationTime;particle.setSize(size*0.9).setSizeChange(0.0039*this.size).setOpacity(Math.random()*0.2+0.6).setFadeIn(activationTime,0.1).setFadeOut(fadeOutAt,(Math.random()*200+800)/this.speed).setColor(ExplosionEffect_getCoreColor()).setPosition({x:this.position.x,// + Math.floor(Math.random()*radius/10)-radius/5,
y:this.position.y,// + Math.floor(Math.random()*radius/10)-radius/5,
z:this.position.z}).setAngle(45).setTexture(texture).setVelocity(this.movement).setAngle(Math.floor(Math.random()*360),5*this.speed).setActivationTime(activationTime).setRepeat(this.repeat);}},{key:"createMain",value:function createMain(amount,radius){var size=radius;this.emitterContainer.getNormalParticle(this.context).setSize(this.size).setOpacity(1).setFadeOut(this.time+500).setColor(ExplosionEffect_getCoreColor()).setPosition({x:this.position.x+(Math.floor(Math.random()*radius)-radius)/8,y:this.position.y+(Math.floor(Math.random()*radius)-radius)/8,z:this.position.z+(Math.floor(Math.random()*radius)-radius)/8}).setTexture(TEXTURE_GLOW).setActivationTime(this.time);this.emitterContainer.getNormalParticle(this.context).setSize(this.size*2).setOpacity(0.5).setFadeOut(this.time+500).setColor(ExplosionEffect_getYellowColor()).setPosition({x:this.position.x+(Math.floor(Math.random()*radius)-radius)/8,y:this.position.y+(Math.floor(Math.random()*radius)-radius)/8,z:this.position.z+(Math.floor(Math.random()*radius)-radius)/8}).setTexture(TEXTURE_GLOW).setActivationTime(this.time);while(amount--){var particle=this.emitterContainer.getParticle(this.context);var activationTime=this.time+Math.floor(Math.random()*300/this.speed);var fadeOutAt=activationTime+Math.floor(Math.random()*500/this.speed);particle.setSize(Math.floor(Math.random()*size)+size/2).setSizeChange(this.size*0.003).setOpacity(Math.random()*0.1+0.05).setFadeIn(activationTime,Math.random()*50+25).setFadeOut(fadeOutAt,Math.random()*500/this.speed+500/this.speed).setColor(this.getRandomColor()).setPosition({x:this.position.x+(Math.floor(Math.random()*radius)-radius)/8,y:this.position.y+(Math.floor(Math.random()*radius)-radius)/8,z:this.position.z+(Math.floor(Math.random()*radius)-radius)/8}).setVelocity(this.movement).setAngle(Math.floor(Math.random()*360)).setActivationTime(activationTime).setTexture(TEXTURE_GAS).setRepeat(this.repeat);}}},{key:"createMainGlow",value:function createMainGlow(amount,radius){var size=radius*2;while(amount--){var particle=this.emitterContainer.getParticle(this.context);var activationTime=this.time+Math.floor(Math.random()*0.03/this.speed);var fadeOutAt=this.duration?activationTime+this.duration:activationTime+Math.floor(Math.random()*0.05/this.speed);particle.setSize(Math.floor(Math.random()*size/2)+size).setOpacity(Math.random()*0.1+0.4).setFadeIn(activationTime,Math.random()*0.005+0.0025).setFadeOut(fadeOutAt,(Math.random()*200+800)/this.speed).setColor(this.getRandomColor()).setVelocity(this.movement).setOpacity(this.opacity).setPosition({x:this.position.x,y:this.position.y,z:this.position.z}).setTexture(TEXTURE_GLOW).setActivationTime(activationTime).setRepeat(this.repeat);}}},{key:"deactivate",value:function deactivate(){this.emitterContainer.release(this);}}]);return ExplosionEffect;}(animation_Animation);var ExplosionEffect_getCoreColor=function getCoreColor(){return new three_module["Color"]().setRGB(255,255,255);};var ExplosionEffect_getYellowColor=function getYellowColor(){return new three_module["Color"]().setRGB(1,(Math.floor(Math.random()*20)+235)/255,(Math.floor(Math.random()*10)+130)/255);};/* harmony default export */ var effect_ExplosionEffect = (ExplosionEffect_ExplosionEffect);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/ShipObjectSectionDamageEffect.js
var ShipObjectSectionDamageEffect_ShipObjectSectionDamageEffect=/*#__PURE__*/function(){function ShipObjectSectionDamageEffect(ship){Object(classCallCheck["a" /* default */])(this,ShipObjectSectionDamageEffect);this.ship=ship;this.damageCache=[];this.animationTime=0;this.center=null;this.scene=null;}Object(createClass["a" /* default */])(ShipObjectSectionDamageEffect,[{key:"init",value:function init(boundingBox,particleContainer,shipZ,center,scene){this.boundingBox=boundingBox;this.particleContainer=particleContainer;this.shipZ=shipZ;this.center=center;this.particleContainer.setPosition(Object(objectSpread2["a" /* default */])({},this.center,{z:this.center.z+this.shipZ}));this.scene=scene;}},{key:"createDamage",value:function createDamage(){this.removeDamage();this.ship.systems.sections.getSectionsWithStructure().filter(function(section){return section.getStructure().isDestroyed();}).forEach(this.createDamageForSection.bind(this));}},{key:"createDamageForSections",value:function createDamageForSections(sections){this.removeDamage();sections.forEach(this.createDamageForSection.bind(this));}},{key:"removeDamage",value:function removeDamage(){this.damageCache.forEach(function(_ref){var particles=_ref.particles;return particles.forEach(function(_ref2){var index=_ref2.index,emitter=_ref2.emitter;return emitter.getByIndex(index).setOpacity(0);});});}},{key:"setShipZ",value:function setShipZ(shipZ){this.shipZ=shipZ;this.particleContainer.setPosition(Object(objectSpread2["a" /* default */])({},this.center,{z:this.center.z+this.shipZ}));}},{key:"activateFromCache",value:function activateFromCache(section){var cached=this.damageCache.find(function(_ref3){var location=_ref3.location;return section.location===location;});if(!cached){return false;}cached.particles.forEach(function(_ref4){var index=_ref4.index,emitter=_ref4.emitter,opacity=_ref4.opacity;return emitter.getByIndex(index).setOpacity(opacity);});return true;}},{key:"createDamageForSection",value:function createDamageForSection(section){var _this=this;if(this.activateFromCache(section)){return;}var getRandom=getSeededRandomGenerator(this.ship.id+section.location);var bounds=this.boundingBox.getBoundsForSection(section);var particles=[];var dimensionDebugCube=function dimensionDebugCube(){var getColor=function getColor(){switch(section.location){case 0:return 0x0000ff;case 1:return 0x00ff00;case 2:return 0x000000;case 31:return 0xffff00;case 32:return 0x00ffff;case 41:return 0x990000;case 42:return 0x000099;}};var cube=new three_module["Mesh"](new three_module["BoxGeometry"](1,1,1),new three_module["MeshBasicMaterial"]({color:getColor(),wireframe:true}));var c=bounds.start.add(bounds.end).multiplyScalar(0.5).add(_this.center);cube.scale.set(Math.abs(bounds.end.x-bounds.start.x),Math.abs(bounds.end.y-bounds.start.y),Math.abs(bounds.end.z-bounds.start.z));cube.position.set(c.x,c.y,c.z+_this.shipZ);_this.scene.add(cube);};//dimensionDebugCube();
var boundSize=new utils_Vector(Math.abs(bounds.end.x-bounds.start.x),Math.abs(bounds.end.y-bounds.start.y),Math.abs(bounds.end.z-bounds.start.z));var count=Math.ceil(boundSize.x*boundSize.y/500)+Math.floor(getRandom()*3);while(count--){var offset=new utils_Vector(boundSize.x*getRandom(),boundSize.y*getRandom(),boundSize.z*getRandom());var size=getRandom()*0.5+0.5;var position=bounds.start.add(offset).setZ(0);var random=getRandom();particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),Object(toConsumableArray["a" /* default */])(ShipObjectSectionDamageEffect_createGlow(position,size,this.particleContainer,getRandom,this)));particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),Object(toConsumableArray["a" /* default */])(ShipObjectSectionDamageEffect_createSmoke(position,size,this.particleContainer,getRandom,this)));if(random<0.5){var sparkCount=Math.floor(getRandom()*10)+5;while(sparkCount--){particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),Object(toConsumableArray["a" /* default */])(ShipObjectSectionDamageEffect_createSpark(position,this.particleContainer,getRandom,this)));}}}this.damageCache.push({location:section.location,particles:particles});}},{key:"render",value:function render(payload){this.animationTime+=payload.delta;this.particleContainer.render(Object(objectSpread2["a" /* default */])({},payload,{total:this.animationTime}));}}]);return ShipObjectSectionDamageEffect;}();var ShipObjectSectionDamageEffect_createSmoke=function createSmoke(position,size,particleContainer,getRandom,context){var activation=0;var count=Math.floor(getRandom()*2)+2;var particles=[];particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),[particleContainer.getNormalParticle(context).setSize((getRandom()*3+15)*size).setOpacity(0.8).setColor({r:0,g:0,b:0}).setPosition(position.toObject()).setTexture(TEXTURE_GLOW).setAngle(getRandom()*360,(getRandom()-0.5)*0.01).setActivationTime(activation).serialize()]);while(count--){var fadeInSpeed=getRandom()*1000+3000;var fadeOutAt=activation+fadeInSpeed;var fadeOutSpeed=getRandom()*1000+3000;var repeat=fadeOutAt+fadeOutSpeed;particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),[particleContainer.getNormalParticle(context).setSize((getRandom()*10+5)*size).setSizeChange(getRandom()*0.002+0.002).setOpacity(1).setFadeIn(activation,fadeInSpeed).setFadeOut(fadeOutAt,fadeOutSpeed).setColor(ShipObjectSectionDamageEffect_getSmokeColor()).setPosition(position.toObject()).setTexture(TEXTURE_GAS).setAngle(getRandom()*360,(getRandom()-0.5)*0.001+0.001).setActivationTime(activation).setRepeat(repeat).serialize()]);activation+=getRandom()*1000;}return particles;};var ShipObjectSectionDamageEffect_createGlow=function createGlow(position,size,particleContainer,getRandom,context){var activation=0;var count=Math.floor(getRandom()*2)+2;var particles=[];particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),[particleContainer.getNormalParticle(context).setSize((getRandom()*5+10)*size).setOpacity(0.6).setColor(ShipObjectSectionDamageEffect_getYellowRandomColor()).setPosition(position.toObject()).setTexture(TEXTURE_GLOW).setActivationTime(activation).serialize()]);particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),[particleContainer.getParticle(context).setSize((getRandom()*3+4)*size).setOpacity(0.6).setColor({r:1,g:1,b:1}).setPosition(position.toObject()).setTexture(TEXTURE_GLOW).setActivationTime(activation).serialize()]);while(count--){var fadeInSpeed=getRandom()*500;var fadeOutAt=activation+fadeInSpeed;var fadeOutSpeed=getRandom()*1000+500;var repeat=fadeOutAt+fadeOutSpeed;var modPosition=position.add(new utils_Vector(getRandom()-0.5,getRandom()-0.5,getRandom()-0.5).normalize().multiplyScalar(getRandom()*2*size));particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),[particleContainer.getParticle(context).setSize((getRandom()*10+5)*size).setSizeChange(-0.002).setOpacity(0.3).setFadeIn(activation,fadeInSpeed).setFadeOut(fadeOutAt,fadeOutSpeed).setColor(ShipObjectSectionDamageEffect_getYellowRandomColor()).setPosition(modPosition.toObject()).setTexture(TEXTURE_GLOW).setAngle(getRandom()*360,(getRandom()-0.5)*0.1).setActivationTime(activation).setRepeat(repeat).serialize()]);activation+=getRandom()*1000;}return particles;};var ShipObjectSectionDamageEffect_createSpark=function createSpark(position,particleContainer,getRandom,context){var activation=0;var fadeInSpeed=100;var fadeOutAt=activation+fadeInSpeed;var fadeOutSpeed=getRandom()*1000+500;var particles=[];var velocity=new utils_Vector(getRandom()-0.5,getRandom()-0.5,getRandom()-0.5).normalize().multiplyScalar(0.005+getRandom()*0.005);var repeat=fadeOutAt+fadeOutSpeed;particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),[particleContainer.getParticle(context).setSize(2).setSizeChange(-0.002).setOpacity(0.6).setFadeIn(activation,fadeInSpeed).setFadeOut(fadeOutAt,fadeOutSpeed).setColor(ShipObjectSectionDamageEffect_getYellowRandomColor()).setPosition(position.toObject()).setTexture(TEXTURE_GLOW).setActivationTime(activation).setRepeat(repeat).setVelocity(velocity).serialize()]);particles=[].concat(Object(toConsumableArray["a" /* default */])(particles),[particleContainer.getParticle(context).setSize(1).setSizeChange(-0.005).setOpacity(1).setFadeIn(activation,fadeInSpeed).setFadeOut(fadeOutAt,fadeOutSpeed).setColor({r:1,g:1,b:1}).setPosition(position.toObject()).setTexture(TEXTURE_GLOW).setActivationTime(activation).setRepeat(repeat).setVelocity(velocity).serialize()]);return particles;};var ShipObjectSectionDamageEffect_getYellowRandomColor=function getYellowRandomColor(){return new three_module["Color"]().setRGB(1,(155-Math.floor(Math.random()*75))/255,Math.floor(Math.random()*20)/255);};var ShipObjectSectionDamageEffect_getRandomColor=function getRandomColor(){return new three_module["Color"]().setRGB(1,(155-Math.floor(Math.random()*75))/255,Math.floor(Math.random()*155)/255);};var ShipObjectSectionDamageEffect_getSmokeColor=function getSmokeColor(){var c=(Math.random()*50+20)/255;return new three_module["Color"]().setRGB(c,c,c+0.05);};/* harmony default export */ var ships_ShipObjectSectionDamageEffect = (ShipObjectSectionDamageEffect_ShipObjectSectionDamageEffect);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/ShipObject.js
var ShipObject_ShipObject=/*#__PURE__*/function(){function ShipObject(ship,scene){var _this=this;Object(classCallCheck["a" /* default */])(this,ShipObject);this.shipId=ship.id;this.ship=ship;this.systemLocations={};this.bumpMap=null;this.scene=scene;this.mesh=new three_module["Object3D"]();//this.mesh.castShadow = true;
//this.mesh.receiveShadow = true;
this.shipObject=null;this.systemObjects=[];this.resolveShipObjectLoaded=null;this.isShipObjectLoaded=new Promise(function(resolve,reject){_this.resolveShipObjectLoaded=resolve;});this.mapIcon=null;this.hexSprites=[];this.hexSpriteContainer=new three_module["Object3D"]();this.ghostShipObject=null;this.shipSideSprite=null;this.shipEWSprite=null;this.shipSelectedSprite=null;this.line=null;this.defaultHeight=50;this.sideSpriteSize=100;this.position={x:0,y:0,z:0};this.shipZ=null;this.hidden=false;this.emissiveReplaced=[];this.ghost=false;this.forcedEmissiveColor=null;this.opacity=1;this.rotation=0;this.roll=0;this.dimensions={x:100,y:100};this.center={x:0,y:0};this.ewSpriteDimensions=null;this.shipObjectBoundingBox=new ships_ShipObjectBoundingBox(ship);this.shipObjectSectionDamageEffect=new ships_ShipObjectSectionDamageEffect(ship);this.consumeShipdata(this.ship);}Object(createClass["a" /* default */])(ShipObject,[{key:"setShipObject",value:function setShipObject(object){var _this2=this;this.shipObject=object;if(this.bumpMap){object.scene.children.forEach(function(mesh){mesh.material.bumpMap=_this2.bumpMap;mesh.material.bumpScale=0.5;mesh.material.bumpMap.flipY=false;mesh.material.needsUpdate=true;});}this.shipObject.traverse(function(child){child.userData={icon:_this2};});object.addTo(this.mesh);this.resolveShipObjectLoaded(true);}},{key:"clone",value:function clone(){return new ships_namespaceObject[this.ship.shipModel](this.ship,this.scene);}},{key:"consumeShipdata",value:function consumeShipdata(ship){this.ship=ship;}},{key:"createMesh",value:function createMesh(){var _this3=this;if(this.shipZ===null){this.shipZ=this.defaultHeight;}var opacity=0.5;this.line=new renderer_Line(this.mesh,{start:{x:0,y:0,z:0},end:{x:0,y:0,z:this.defaultHeight},width:5,color:new three_module["Color"](1,1,1),opacity:0.1});this.line.hide();this.shipSelectedSprite=new sprite_DottedCircleSprite({width:this.overlaySpriteSize,height:this.overlaySpriteSize},this.defaultHeight,opacity);//this.ship.hexSizes.forEach(position => {
var sprite=new sprite_HexagonSprite(new utils_Vector(0,0)).setOpacity(0.5).setOverlayColorAlpha(1);this.hexSprites.push(sprite);this.hexSpriteContainer.add(sprite.mesh);//});
this.hexSpriteContainer.visible=false;this.mapIcon=new ships_ShipMapIcon(this);this.mapIcon.addTo(this.mesh);this.mesh.add(this.hexSpriteContainer);/*
    this.shipSelectedSprite.setOverlayColor(COLOR_MINE);
    this.shipSelectedSprite.setOverlayColorAlpha(1);
    this.mesh.add(this.shipSelectedSprite.mesh);
    //shipSelectedSprite.hide();
    */ /*
    this.shipSideSprite = new CircleSprite(
      { width: this.sideSpriteSize, height: this.sideSpriteSize },
      0.01,
      opacity
    );
    this.mesh.add(this.shipSideSprite.mesh);
    */ //this.mesh.name = "ship";
//this.mesh.userData = { icon: this };
var dimensionDebugCube=function dimensionDebugCube(){var cube=new three_module["Mesh"](new three_module["BoxGeometry"](1,1,1),new three_module["MeshBasicMaterial"]({color:0xffffff,wireframe:true}));cube.scale.set(_this3.dimensions.x,_this3.dimensions.y,_this3.dimensions.z);cube.position.set(_this3.center.x,_this3.center.y,_this3.center.z+_this3.shipZ);_this3.hexSpriteContainer.add(cube);};//dimensionDebugCube();
var particleContainer=new particle_ParticleEmitterContainer(this.hexSpriteContainer,1000);this.shipObjectBoundingBox.init(this.dimensions);this.shipObjectSectionDamageEffect.init(this.shipObjectBoundingBox,particleContainer,this.shipZ,this.center,this.hexSpriteContainer);this.scene.add(this.mesh);this.hide();}},{key:"showEwSprite",value:function(){var _showEwSprite=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(dew,ccew,evasion){var dimensions,max;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.isShipObjectLoaded;case 2:if(!this.shipEWSprite){dimensions=this.ewSpriteDimensions||this.dimensions;max=dimensions.x>dimensions.y?dimensions.x:dimensions.y;this.shipEWSprite=new sprite_ShipEWSprite({width:max*1.5,height:max*1.5},this.shipZ,dimensions);this.shipEWSprite.setPosition(this.center);this.hexSpriteContainer.add(this.shipEWSprite.mesh);this.shipEWSprite.hide();}this.shipEWSprite.update(dew,ccew,evasion);this.shipEWSprite.show();case 5:case"end":return _context.stop();}}},_callee,this);}));function showEwSprite(_x,_x2,_x3){return _showEwSprite.apply(this,arguments);}return showEwSprite;}()},{key:"hideEwSprite",value:function(){var _hideEwSprite=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(){return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.isShipObjectLoaded;case 2:this.shipEWSprite.hide();case 3:case"end":return _context2.stop();}}},_callee2,this);}));function hideEwSprite(){return _hideEwSprite.apply(this,arguments);}return hideEwSprite;}()},{key:"create",value:function create(){this.createMesh();}},{key:"setPosition",value:function(){var _setPosition=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee3(x,y){return regenerator_default.a.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(typeof x==="object"){y=x.y;x=x.x;}this.position={x:x,y:y,z:0};if(this.mesh){this.mesh.position.set(x,y,0);}_context3.next=5;return this.isShipObjectLoaded;case 5:this.shipObject.object.position.set(0,0,this.shipZ);case 6:case"end":return _context3.stop();}}},_callee3,this);}));function setPosition(_x4,_x5){return _setPosition.apply(this,arguments);}return setPosition;}()},{key:"setShipZ",value:function setShipZ(z){this.shipZ=z;this.setPosition(this.position);this.shipObjectSectionDamageEffect.setShipZ(z);}},{key:"getPosition",value:function getPosition(){return new utils_Vector(this.position);}},{key:"setRotation",value:function(){var _setRotation=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee4(){var tmpQuaternion;return regenerator_default.a.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.isShipObjectLoaded;case 2:this.shipObject.object.quaternion.setFromAxisAngle(new three_module["Vector3"](0,0,1),degreeToRadian(this.rotation));tmpQuaternion=new three_module["Quaternion"]();tmpQuaternion.setFromAxisAngle(new three_module["Vector3"](1,0,0).normalize(),degreeToRadian(this.roll)).normalize();this.shipObject.object.quaternion.multiply(tmpQuaternion);this.hexSpriteContainer.rotation.z=degreeToRadian(this.rotation);this.mapIcon.setRotation(this.rotation);case 8:case"end":return _context4.stop();}}},_callee4,this);}));function setRotation(){return _setRotation.apply(this,arguments);}return setRotation;}()},{key:"setFacing",value:function(){var _setFacing=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee5(rotation){return regenerator_default.a.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(this.rotation===rotation)){_context5.next=2;break;}return _context5.abrupt("return");case 2:this.rotation=rotation;this.setRotation();case 4:case"end":return _context5.stop();}}},_callee5,this);}));function setFacing(_x6){return _setFacing.apply(this,arguments);}return setFacing;}()},{key:"getFacing",value:function getFacing(){return-this.rotation;}},{key:"setRoll",value:function(){var _setRoll=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee6(roll){return regenerator_default.a.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!(this.roll===roll)){_context6.next=2;break;}return _context6.abrupt("return");case 2:this.roll=roll;this.setRotation();case 4:case"end":return _context6.stop();}}},_callee6,this);}));function setRoll(_x7){return _setRoll.apply(this,arguments);}return setRoll;}()},{key:"getRoll",value:function getRoll(){return this.roll;}},{key:"setOpacity",value:function(){var _setOpacity=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee7(opacity){return regenerator_default.a.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return this.isShipObjectLoaded;case 2:this.opacity=opacity;this.replaceOpacity(opacity);case 4:case"end":return _context7.stop();}}},_callee7,this);}));function setOpacity(_x8){return _setOpacity.apply(this,arguments);}return setOpacity;}()},{key:"hideShip",value:function hideShip(){if(!this.shipObject){return;}this.shipObject.object.visible=false;}},{key:"showShip",value:function showShip(){if(!this.shipObject){return;}this.shipObject.object.visible=true;}},{key:"hide",value:function hide(){if(this.hidden){return;}this.scene.remove(this.mesh);this.hidden=true;}},{key:"show",value:function show(){if(!this.hidden){return;}this.scene.add(this.mesh);this.hidden=false;}},{key:"setOverlayColorAlpha",value:function setOverlayColorAlpha(alpha){}/*
  getMovements(turn) {
    return this.movements.filter(function(movement) {
      return turn === undefined || movement.turn === turn;
    }, this);
  }
*/},{key:"setScale",value:function setScale(width,height){}},{key:"showSideSprite",value:function showSideSprite(value){}},{key:"setHighlighted",value:function setHighlighted(value){}},{key:"setSideSpriteOpacity",value:function setSideSpriteOpacity(opacity){}/*
  showBDEW() {
    var BDEW = this.ship.ew.getBDEW();
    if (!BDEW || this.BDEWSprite) {
      return;
    }

    var hexDistance = window.coordinateConverter.getHexDistance();
    var dis = 20 * hexDistance;

    var color = this.ship.player.isMine()
      ? new THREE.Color(160 / 255, 250 / 255, 100 / 255)
      : new THREE.Color(255 / 255, 157 / 255, 0 / 255);

    var geometry = new THREE.CircleGeometry(dis, 64, 0);
    var material = new THREE.MeshBasicMaterial({
      color: color,
      opacity: 0.2,
      transparent: true
    });
    var circle = new THREE.Mesh(geometry, material);
    circle.position.z = -1;
    this.mesh.add(circle);
    this.BDEWSprite = circle;

    return null;
  }

  hideBDEW() {
    this.mesh.remove(this.BDEWSprite);
    this.BDEWSprite = null;
  }

*/},{key:"replaceSocketByName",value:function(){var _replaceSocketByName=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee8(names,entity){var _this4=this;return regenerator_default.a.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:names=[].concat(names);_context8.next=3;return this.isShipObjectLoaded;case 3:names.forEach(function(_ref){var name=_ref.name,id=_ref.id;var slot=_this4.shipObject.scene.children.find(function(child){if(!child.name){return false;}if(child.name===name){return true;}});if(!slot){return;}if(!entity){_this4.shipObject.scene.remove(slot);return;}var newEntity=entity.clone().setId(id);newEntity.object.position.copy(slot.position);newEntity.object.rotation.copy(slot.rotation);newEntity.object.quaternion.copy(slot.quaternion);_this4.shipObject.scene.remove(slot);newEntity.addTo(_this4.shipObject.object);_this4.systemObjects.push(newEntity);_this4.systemLocations[id]=slot.position;});case 4:case"end":return _context8.stop();}}},_callee8,this);}));function replaceSocketByName(_x9,_x10){return _replaceSocketByName.apply(this,arguments);}return replaceSocketByName;}()},{key:"replaceOpacity",value:function(){var _replaceOpacity=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee9(opacity){return regenerator_default.a.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return this.isShipObjectLoaded;case 2:this.shipObject.traverse(function(child){child.material.transparent=true;child.material.opacity=opacity;child.material.needsUpdate=true;});case 3:case"end":return _context9.stop();}}},_callee9,this);}));function replaceOpacity(_x11){return _replaceOpacity.apply(this,arguments);}return replaceOpacity;}()},{key:"revertOpacity",value:function(){var _revertOpacity=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee10(){var _this5=this;return regenerator_default.a.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return this.isShipObjectLoaded;case 2:this.shipObject.traverse(function(child){child.material.opacity=_this5.opacity;child.material.needsUpdate=true;});case 3:case"end":return _context10.stop();}}},_callee10,this);}));function revertOpacity(){return _revertOpacity.apply(this,arguments);}return revertOpacity;}()},{key:"forceEmissive",value:function forceEmissive(color){this.forcedEmissiveColor=color;this.replaceEmissive(color);this.emissiveReplaced=[];}},{key:"replaceEmissive",value:function(){var _replaceEmissive=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee11(color){var _this6=this;return regenerator_default.a.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return this.isShipObjectLoaded;case 2:this.shipObject.traverse(function(child){var replacement=_this6.emissiveReplaced.find(function(replacement){return replacement.object===child;});if(!replacement){_this6.emissiveReplaced.push({object:child,color:child.material.emissive,map:child.material.emissiveMap});}child.material.emissiveMap=null;child.material.emissive=color;child.material.needsUpdate=true;});case 3:case"end":return _context11.stop();}}},_callee11,this);}));function replaceEmissive(_x12){return _replaceEmissive.apply(this,arguments);}return replaceEmissive;}()},{key:"revertEmissive",value:function(){var _revertEmissive=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee12(){var _this7=this;return regenerator_default.a.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return this.isShipObjectLoaded;case 2:this.shipObject.traverse(function(child){var replacement=_this7.emissiveReplaced.find(function(replacement){return replacement.object===child;});if(_this7.forcedEmissiveColor){child.material.emissiveMap=null;child.material.emissive=_this7.forcedEmissiveColor;child.material.needsUpdate=true;}else if(replacement){child.material.emissiveMap=replacement.map;child.material.emissive=replacement.color;child.material.needsUpdate=true;}});case 3:case"end":return _context12.stop();}}},_callee12,this);}));function revertEmissive(){return _revertEmissive.apply(this,arguments);}return revertEmissive;}()},{key:"setGhostShip",value:function setGhostShip(mine){this.ghost=true;//this.setGhostShipEmissive(mine);
//this.setOpacity(0.2);
}},{key:"setGhostShipEmissive",value:function(){var _setGhostShipEmissive=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee13(color){return regenerator_default.a.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return this.isShipObjectLoaded;case 2:this.forceEmissive(color);this.hexSprites.forEach(function(hexSprite){return hexSprite.setOverlayColor(new three_module["Color"](color));});case 4:case"end":return _context13.stop();}}},_callee13,this);}));function setGhostShipEmissive(_x13){return _setGhostShipEmissive.apply(this,arguments);}return setGhostShipEmissive;}()},{key:"showMapIcon",value:function showMapIcon(color){this.mapIcon.setOverlayColor(color).setOverlayColorAlpha(1).show();this.hideShip();}},{key:"hideMapIcon",value:function hideMapIcon(){this.mapIcon.hide();this.showShip();}},{key:"isGhostShip",value:function isGhostShip(){return this.ghost;}},{key:"render",value:function render(renderPayload){this.systemObjects.forEach(function(object){return object.render(renderPayload);});this.shipObjectSectionDamageEffect.render(renderPayload);}},{key:"playSystemAnimation",value:function playSystemAnimation(system,name){var object=this.systemObjects.find(function(object){return object.id===system.id;});if(!object){return;}//console.log("animate", name, system);
object.playAnimation(name);}},{key:"setSystemAnimation",value:function setSystemAnimation(system,name,time){var object=this.systemObjects.find(function(object){return object.id===system.id;});if(!object){return;}//console.log("set animation", name, system);
object.setAnimation(name,time);}},{key:"disableSystemAnimation",value:function disableSystemAnimation(system,name){var object=this.systemObjects.find(function(object){return object.id===system.id;});if(!object){return;}//console.log("disable", name, system);
object.disableAnimation(name);}},{key:"getShipHexas",value:function getShipHexas(){var iconPosition=this.getPosition();var iconFacing=this.getFacing();var hexFacing=angleToHexFacing(iconFacing);return this.ship.getIconHexas(hexFacing).map(function(hex){return utils_CoordinateConverter.fromHexToGame(hex).add(iconPosition);});}},{key:"getCenter",value:function getCenter(){var hexas=this.getShipHexas();var lowest=new utils_Vector();var highest=new utils_Vector();hexas.forEach(function(position){if(position.x<lowest.x){lowest.x=position.x;}if(position.y<lowest.y){lowest.y=position.y;}if(position.x>highest.x){highest.x=position.x;}if(position.y<highest.y){highest.y=position.y;}});return lowest.add(highest).multiplyScalar(0.5);}}]);return ShipObject;}();/* harmony default export */ var ships_ShipObject = (ShipObject_ShipObject);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/uc/Gunship.js
//import * as THREE from "three";
var Gunship_Gunship=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Gunship,_ShipObject);function Gunship(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Gunship);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Gunship).call(this,ship,scene));_this.defaultHeight=30;_this.sideSpriteSize=50;_this.create();return _this;}Object(createClass["a" /* default */])(Gunship,[{key:"create",value:function create(){var _this2=this;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Gunship.prototype),"create",this).call(this);window.Loader.loadObject("img/3d/gunship/gunship.obj",function(object){window.Loader.loadTexturesAndAssign(object.children[0],{},null,"img/3d/gunship/normal.png");window.Loader.loadTexturesAndAssign(object.children[1],{},null,"img/3d/turretNormal.png");window.Loader.loadTexturesAndAssign(object.children[2],{},null,"img/3d/turretNormal.png");window.Loader.loadTexturesAndAssign(object.children[3],{},null,"img/3d/turretNormal.png");window.Loader.loadTexturesAndAssign(object.children[6],{},null,"img/3d/turretNormal.png");window.Loader.loadTexturesAndAssign(object.children[7],{},null,"img/3d/turretNormal.png");window.Loader.loadTexturesAndAssign(object.children[4],{},"img/3d/diffuseThruster.png","img/3d/normalThruster.png");window.Loader.loadTexturesAndAssign(object.children[5],{},"img/3d/diffuseThruster.png","img/3d/normalThruster.png");object.scale.set(5,5,5);_this2.startRotation={x:90,y:90,z:0};_this2.shipObject=object;_this2.setRotation(_this2.rotation.x,_this2.rotation.y,_this2.rotation.z);_this2.mesh.add(_this2.shipObject);object.position.set(0,0,_this2.shipZ);});}}]);return Gunship;}(ships_ShipObject);/* harmony default export */ var uc_Gunship = (Gunship_Gunship);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/uc/Rhino.js
var Rhino_Rhino=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Rhino,_ShipObject);function Rhino(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Rhino);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Rhino).call(this,ship,scene));_this.defaultHeight=50;_this.sideSpriteSize=30;_this.overlaySpriteSize=80;_this.create();return _this;}Object(createClass["a" /* default */])(Rhino,[{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var object,radiator,autoCannon,shipMaterial;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Rhino.prototype),"create",this).call(this);_context.next=3;return loadObject("/img/3d/caliope/scene.gltf");case 3:object=_context.sent;//object.scale.set(2, 2, 2);
this.startRotation={x:90,y:90,z:0};this.shipObject=object;this.setRotation(this.rotation.x,this.rotation.y,this.rotation.z);this.mesh.add(this.shipObject);object.position.set(0,0,this.shipZ);_context.next=11;return loadObject("/img/3d/radiator/scene.gltf");case 11:radiator=_context.sent;_context.next=14;return loadObject("/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf");case 14:autoCannon=_context.sent;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Rhino.prototype),"replaceSocketByName",this).call(this,["engine_pylon_top_front","engine_pylon_left_front","engine_pylon_right_front"],radiator);Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Rhino.prototype),"replaceSocketByName",this).call(this,["engine_pylon_top","engine_pylon_left","engine_pylon_right","main_hull_front_left_bottom","main_hull_front_left_top","main_hull_front_right_bottom","main_hull_front_right_top"],autoCannon);_context.t0=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Rhino.prototype),"replaceSocketByName",this);_context.t1=this;_context.t2=["font_hull_bottom","font_hull_top","main_hull_front_left_side","main_hull_front_right_side"];_context.next=22;return loadObject("/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf");case 22:_context.t3=_context.sent;_context.t0.call.call(_context.t0,_context.t1,_context.t2,_context.t3);_context.t4=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Rhino.prototype),"replaceSocketByName",this);_context.t5=this;_context.t6=["thruster_top","thruster_right","thruster_left"];_context.next=29;return loadObject("/img/3d/systems/thrusters/5mThruster/scene.gltf");case 29:_context.t7=_context.sent;_context.t4.call.call(_context.t4,_context.t5,_context.t6,_context.t7);shipMaterial=this.shipObject.children[0].material;shipMaterial.emissive=new three_module["Color"](1,1,1);shipMaterial.emissiveMap=new three_module["TextureLoader"]().load("/img/3d/caliope/emissiveMap.png");shipMaterial.emissiveMap.flipY=false;/*
    this.shipObject.traverse(o => {
      if (o.isMesh) {
        o.material.emissive = new THREE.Color(1, 1, 1);
        o.material.emissiveMap = new THREE.TextureLoader().load(
          "/img/3d/caliope/baseColor.png"
        );
        o.material.emissiveMap.flipY = false;


      }
    });

    */case 35:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()},{key:"render",value:function render(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Rhino.prototype),"render",this).call(this);if(this.shipObject){this.shipObject.rotation.y+=0.006;}}}]);return Rhino;}(ships_ShipObject);/* harmony default export */ var uc_Rhino = (Rhino_Rhino);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/uc/Capital.js
var Capital_Capital=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Capital,_ShipObject);function Capital(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Capital);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Capital).call(this,ship,scene));_this.defaultHeight=50;_this.sideSpriteSize=50;_this.create();return _this;}Object(createClass["a" /* default */])(Capital,[{key:"create",value:function create(){var _this2=this;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Capital.prototype),"create",this).call(this);window.Loader.loadObject("img/3d/capital/capital.obj",function(object){window.Loader.loadTexturesAndAssign(object.children[0],{normalScale:new three_module["Vector2"](0.5,0.5),shininess:10,color:new three_module["Color"](1,1,1)},"img/3d/capital/diffuse.png","img/3d/capital/normalEdit.png");object.scale.set(3,3,3);_this2.startRotation={x:90,y:90,z:0};_this2.shipObject=object;_this2.setRotation(_this2.rotation.x,_this2.rotation.y,_this2.rotation.z);_this2.mesh.add(_this2.shipObject);object.position.set(0,0,_this2.shipZ);});}}]);return Capital;}(ships_ShipObject);/* harmony default export */ var uc_Capital = (Capital_Capital);
// CONCATENATED MODULE: ./src/client/view/game/renderer/object3d/Object3d.js
var loadObject3d=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(url){var object;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return loadObject(url);case 2:object=_context.sent;return _context.abrupt("return",new Object3d_Object3d(object.scene,object.animations));case 4:case"end":return _context.stop();}}},_callee);}));return function loadObject3d(_x){return _ref.apply(this,arguments);};}();var Object3d_Object3d=/*#__PURE__*/function(){function Object3d(scene,animations){Object(classCallCheck["a" /* default */])(this,Object3d);this.id=null;this.object=new three_module["Object3D"]();this.scene=scene;this.animations=animations;this.actions=[];this.object.add(this.scene);this.animationMixer=new three_module["AnimationMixer"](this.scene);this.loopAnimation("ambient");}Object(createClass["a" /* default */])(Object3d,[{key:"traverse",value:function traverse(callBack){this.object.traverse(function(child){if(child.isMesh){callBack(child);}if(child instanceof Object3d){child.traverse(callBack);}});}},{key:"disableAnimation",value:function disableAnimation(name){var clip=three_module["AnimationClip"].findByName(this.animations,name);if(!clip){return;}var action=this.animationMixer.clipAction(clip);action.reset();action.weight=0;action.paused=true;}},{key:"playAnimation",value:function playAnimation(name){var clip=three_module["AnimationClip"].findByName(this.animations,name);if(!clip){return;}var action=this.animationMixer.clipAction(clip);action.reset();action.weight=1;action.clampWhenFinished=true;action.loop=three_module["LoopOnce"];action.time=0;action.paused=false;action.play();}},{key:"loopAnimation",value:function loopAnimation(name){var clip=three_module["AnimationClip"].findByName(this.animations,name);if(!clip){return;}var action=this.animationMixer.clipAction(clip);action.reset();action.weight=1;action.clampWhenFinished=true;action.loop=three_module["LoopRepeat"];action.time=0;action.paused=false;action.play();}},{key:"setAnimation",value:function setAnimation(name,time){var clip=three_module["AnimationClip"].findByName(this.animations,name);if(!clip){return;}var action=this.animationMixer.clipAction(clip);action.reset();action.weight=1;action.clampWhenFinished=true;action.loop=three_module["LoopOnce"];action.time=time;action.paused=true;action.play();}},{key:"addTo",value:function addTo(scene){scene.add(this.object);}},{key:"removeFrom",value:function removeFrom(scene){scene.remove(this.object);}},{key:"clone",value:function clone(){var clone=cloneObject(this);var object=new Object3d(clone.scene,clone.animations);object.setId(this.id);return object;}},{key:"setId",value:function setId(id){this.id=id;return this;}},{key:"render",value:function render(_ref2){var delta=_ref2.delta;this.animationMixer.update(delta*0.001);}}]);return Object3d;}();/* harmony default export */ var object3d_Object3d = (Object3d_Object3d);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/uc/Haka.js
var Haka_textureLoader=new three_module["TextureLoader"]();var Haka_Haka=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Haka,_ShipObject);function Haka(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Haka);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Haka).call(this,ship,scene));_this.defaultHeight=80;_this.sideSpriteSize=30;_this.overlaySpriteSize=80;_this.dimensions=new utils_Vector(150,40,40);_this.center=new utils_Vector(0,0,0);_this.ewSpriteDimensions=new utils_Vector(180,80);_this.create();return _this;}Object(createClass["a" /* default */])(Haka,[{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var object;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"create",this).call(this);_context.next=3;return loadObject3d("/img/3d/ships/uc/haka/scene.gltf");case 3:object=_context.sent;_context.next=6;return Haka_textureLoader.load("/img/3d/ships/uc/haka/heightMap.png");case 6:this.bumpMap=_context.sent;_context.t0=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"replaceSocketByName",this);_context.t1=this;_context.t2=[{name:"socket_middle_pylon_top",id:602},{name:"socket_front_top_1",id:606}];_context.next=12;return loadObject3d("/img/3d/systems/weapons/coilgun/turreted32GwRailgun/scene.gltf");case 12:_context.t3=_context.sent;_context.t0.call.call(_context.t0,_context.t1,_context.t2,_context.t3);_context.t4=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"replaceSocketByName",this);_context.t5=this;_context.t6=[{name:"socket_middle_pylon_bottom",id:202}];_context.next=19;return loadObject3d("/img/3d/systems/weapons/railgun/2x140mmRailgunTurret/scene.gltf");case 19:_context.t7=_context.sent;_context.t4.call.call(_context.t4,_context.t5,_context.t6,_context.t7);_context.t8=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"replaceSocketByName",this);_context.t9=this;_context.t10=[{name:"socket_main_pylon_left",id:118},{name:"socket_main_pylon_right",id:119},{name:"socket_front_top_2",id:603},{name:"socket_front_top_3",id:604}];_context.next=26;return loadObject3d("/img/3d/systems/weapons/railgun/140mmRailgunTurret/scene.gltf");case 26:_context.t11=_context.sent;_context.t8.call.call(_context.t8,_context.t9,_context.t10,_context.t11);_context.t12=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"replaceSocketByName",this);_context.t13=this;_context.t14=[{name:"socket_engine_1",id:123},{name:"socket_engine_2",id:123},{name:"socket_engine_3",id:123},{name:"socket_engine_4",id:123}];_context.next=33;return loadObject3d("/img/3d/systems/thrusters/10mThruster/scene.gltf");case 33:_context.t15=_context.sent;_context.t12.call.call(_context.t12,_context.t13,_context.t14,_context.t15);_context.t16=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"replaceSocketByName",this);_context.t17=this;_context.t18=[{name:"socket_engine_pylon_1",id:550},{name:"socket_engine_pylon_2",id:551},{name:"socket_engine_pylon_3",id:554},{name:"socket_engine_pylon_4",id:555},{name:"socket_engine_pylon_5",id:352},{name:"socket_engine_pylon_6",id:353},{name:"socket_engine_pylon_7",id:356},{name:"socket_engine_pylon_8",id:357},{name:"socket_engine_pylon_9",id:451},{name:"socket_engine_pylon_10",id:456},{name:"socket_engine_pylon_11",id:450},{name:"socket_engine_pylon_12",id:452},{name:"socket_engine_pylon_13",id:457},{name:"socket_engine_pylon_14",id:455},{name:"socket_engine_pylon_15",id:453},{name:"socket_engine_pylon_16",id:454},{name:"socket_main_right_1",id:114},{name:"socket_main_right_2",id:115},{name:"socket_main_left_1",id:116},{name:"socket_main_left_2",id:117}];_context.next=40;return loadObject3d("/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf");case 40:_context.t19=_context.sent;_context.t16.call.call(_context.t16,_context.t17,_context.t18,_context.t19);_context.t20=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"replaceSocketByName",this);_context.t21=this;_context.t22=[{name:"socket_radiator_5",id:301},{name:"socket_radiator_6",id:302},{name:"socket_radiator_7",id:502},{name:"socket_radiator_8",id:503}];_context.next=47;return loadObject3d("/img/3d/systems/radiators/10x40/scene.gltf");case 47:_context.t23=_context.sent;_context.t20.call.call(_context.t20,_context.t21,_context.t22,_context.t23);Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"replaceSocketByName",this).call(this,[{name:"socket_radiator_1",id:416},{name:"socket_radiator_2",id:216},{name:"socket_radiator_3",id:416},{name:"socket_radiator_4",id:216}],null);/*
     new systems.PDC30mm({ id: 450 }, { start: 160, end: 340 }),
      new systems.PDC30mm({ id: 451 }, { start: 160, end: 340 }),

      new systems.PDC30mm({ id: 452 }, { start: 40, end: 200 }),
      new systems.PDC30mm({ id: 453 }, { start: 40, end: 200 }),

      new systems.PDC30mm({ id: 454 }, { start: 160, end: 340 }),
      new systems.PDC30mm({ id: 455 }, { start: 160, end: 340 }),

      new systems.PDC30mm({ id: 456 }, { start: 40, end: 200 }),
      new systems.PDC30mm({ id: 457 }, { start: 40, end: 200 })
      */this.setShipObject(object);case 51:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()}]);return Haka;}(ships_ShipObject);/* harmony default export */ var uc_Haka = (Haka_Haka);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/protectorate/Caliope.js
var Caliope_textureLoader=new three_module["TextureLoader"]();var Caliope_Caliope=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Caliope,_ShipObject);function Caliope(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Caliope);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Caliope).call(this,ship,scene));_this.defaultHeight=80;_this.sideSpriteSize=30;_this.overlaySpriteSize=80;_this.dimensions=new utils_Vector(80,22,8);_this.center=new utils_Vector(0,0,0);_this.ewSpriteDimensions=new utils_Vector(95,40);_this.create();return _this;}Object(createClass["a" /* default */])(Caliope,[{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var object,radiator,autoCannon;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"create",this).call(this);_context.next=3;return loadObject3d("/img/3d/caliope/scene.gltf");case 3:object=_context.sent;_context.next=6;return Caliope_textureLoader.load("/img/3d/caliope/heightMap.png");case 6:this.bumpMap=_context.sent;object.object.position.set(0,0,this.defaultHeight);_context.next=10;return loadObject3d("/img/3d/radiator/scene.gltf");case 10:radiator=_context.sent;_context.next=13;return loadObject3d("/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf");case 13:autoCannon=_context.sent;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"replaceSocketByName",this).call(this,[{name:"engine_pylon_top_front",id:412},{name:"engine_pylon_left_front",id:501},{name:"engine_pylon_right_front",id:301}],radiator);Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"replaceSocketByName",this).call(this,[{name:"engine_pylon_top",id:421},{name:"engine_pylon_left",id:521},{name:"engine_pylon_right",id:321}],autoCannon);Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"replaceSocketByName",this).call(this,[{name:"main_hull_front_left_bottom",id:603},{name:"main_hull_front_left_top",id:604},{name:"main_hull_front_right_bottom",id:203},{name:"main_hull_front_right_top",id:204}],autoCannon);_context.t0=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"replaceSocketByName",this);_context.t1=this;_context.t2=[{name:"front_hull_right_side",id:213},{name:"front_hull_left_side",id:612}];_context.next=22;return loadObject3d("/img/3d/systems/weapons/railgun/2x140mmRailgunTurret/scene.gltf");case 22:_context.t3=_context.sent;_context.t0.call.call(_context.t0,_context.t1,_context.t2,_context.t3);_context.t4=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"replaceSocketByName",this);_context.t5=this;_context.t6=[{name:"font_hull_bottom",id:115},{name:"font_hull_top",id:114},{name:"main_hull_front_left_side",id:602},{name:"main_hull_front_right_side",id:202}];_context.next=29;return loadObject3d("/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf");case 29:_context.t7=_context.sent;_context.t4.call.call(_context.t4,_context.t5,_context.t6,_context.t7);_context.t8=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"replaceSocketByName",this);_context.t9=this;_context.t10=[{name:"thruster_top",id:123},{name:"thruster_right",id:123},{name:"thruster_left",id:123}];_context.next=36;return loadObject3d("/img/3d/systems/thrusters/5mThruster/scene.gltf");case 36:_context.t11=_context.sent;_context.t8.call.call(_context.t8,_context.t9,_context.t10,_context.t11);this.setShipObject(object);/*
    const shipMaterial = this.shipObject.children[0].material;

    shipMaterial.emissive = new THREE.Color(1, 1, 1);
    shipMaterial.emissiveMap = new THREE.TextureLoader().load(
      "/img/3d/caliope/emissiveMap.png"
    );
    shipMaterial.emissiveMap.flipY = false;
*/ /*
    this.shipObject.traverse(o => {
      if (o.isMesh) {
        o.material.emissive = new THREE.Color(1, 1, 1);
        o.material.emissiveMap = new THREE.TextureLoader().load(
          "/img/3d/caliope/baseColor.png"
        );
        o.material.emissiveMap.flipY = false;


      }
    });

    */case 39:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()}]);return Caliope;}(ships_ShipObject);/* harmony default export */ var protectorate_Caliope = (Caliope_Caliope);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/protectorate/Fulcrum.js
var Fulcrum_textureLoader=new three_module["TextureLoader"]();var Fulcrum_Fulcrum=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Fulcrum,_ShipObject);function Fulcrum(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Fulcrum);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Fulcrum).call(this,ship,scene));_this.defaultHeight=100;_this.sideSpriteSize=30;_this.overlaySpriteSize=80;_this.dimensions=new utils_Vector(55,12,12);_this.center=new utils_Vector(0,0,0);_this.ewSpriteDimensions=new utils_Vector(65,30);_this.create();return _this;}Object(createClass["a" /* default */])(Fulcrum,[{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var object;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Fulcrum.prototype),"create",this).call(this);_context.next=3;return loadObject3d("/img/3d/ships/protectorate/fulcrum/scene.gltf");case 3:object=_context.sent;_context.next=6;return Fulcrum_textureLoader.load("/img/3d/ships/protectorate/fulcrum/heightMap.png");case 6:this.bumpMap=_context.sent;object.object.position.set(0,0,this.defaultHeight);_context.t0=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Fulcrum.prototype),"replaceSocketByName",this);_context.t1=this;_context.t2=[{name:"rear_hull_radiator_left",id:416},{name:"rear_hull_radiator_right",id:216},{name:"rear_hull_radiator_bottom",id:316}];_context.next=13;return loadObject3d("/img/3d/systems/radiators/5x40mSail/scene.gltf");case 13:_context.t3=_context.sent;_context.t0.call.call(_context.t0,_context.t1,_context.t2,_context.t3);_context.t4=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Fulcrum.prototype),"replaceSocketByName",this);_context.t5=this;_context.t6=[{name:"front_plate_center",id:102}];_context.next=20;return loadObject3d("/img/3d/systems/weapons/coilgun/fixed22GwCoilgun/scene.gltf");case 20:_context.t7=_context.sent;_context.t4.call.call(_context.t4,_context.t5,_context.t6,_context.t7);_context.t8=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Fulcrum.prototype),"replaceSocketByName",this);_context.t9=this;_context.t10=[{name:"front_hull_pdc_bottom",id:14},{name:"front_hull_pdc_left",id:13},{name:"front_hull_pdc_right",id:15},{name:"rear_hull_pdc_top",id:214},{name:"rear_hull_pdc_right",id:215},{name:"rear_hull_pdc_left",id:213}];_context.next=27;return loadObject3d("/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf");case 27:_context.t11=_context.sent;_context.t8.call.call(_context.t8,_context.t9,_context.t10,_context.t11);_context.t12=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Fulcrum.prototype),"replaceSocketByName",this);_context.t13=this;_context.t14=[{name:"thruster",id:123}];_context.next=34;return loadObject3d("/img/3d/systems/thrusters/5mThruster/scene.gltf");case 34:_context.t15=_context.sent;_context.t12.call.call(_context.t12,_context.t13,_context.t14,_context.t15);this.setShipObject(object);case 37:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()}]);return Fulcrum;}(ships_ShipObject);/* harmony default export */ var protectorate_Fulcrum = (Fulcrum_Fulcrum);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/protectorate/Mouros.js
var Mouros_Mouros=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Mouros,_ShipObject);function Mouros(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Mouros);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Mouros).call(this,ship,scene));_this.defaultHeight=10;_this.sideSpriteSize=30;_this.overlaySpriteSize=80;_this.create();return _this;}Object(createClass["a" /* default */])(Mouros,[{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var object;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Mouros.prototype),"create",this).call(this);_context.next=3;return loadObject3d("/img/3d/ships/protectorate/Mouros/scene.gltf");case 3:object=_context.sent;//this.startRotation = { x: 90, y: 90, z: 0 };
this.setRotation(this.rotation.x,this.rotation.y,this.rotation.z);object.object.position.set(0,0,this.defaultHeight);_context.t0=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Mouros.prototype),"replaceSocketByName",this);_context.t1=this;_context.t2=[{name:"Middle_hull_depress_top",id:123},{name:"Middle_hull_depress_left",id:123},{name:"Middle_hull_depress_right",id:123}];_context.next=11;return loadObject3d("/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf"//"/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf"
);case 11:_context.t3=_context.sent;_context.t0.call.call(_context.t0,_context.t1,_context.t2,_context.t3);_context.t4=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Mouros.prototype),"replaceSocketByName",this);_context.t5=this;_context.t6=[{name:"Middle_hull_frame_top",id:123},{name:"Middle_hull_frame_left",id:123},{name:"Middle_hull_frame_right",id:123}];_context.next=18;return loadObject3d("/img/3d/systems/weapons/conventional/140mmCannonTurret/scene.gltf");case 18:_context.t7=_context.sent;_context.t4.call.call(_context.t4,_context.t5,_context.t6,_context.t7);_context.t8=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Mouros.prototype),"replaceSocketByName",this);_context.t9=this;_context.t10=[{name:"railgun_turret_mount_right",id:123},,{name:"railgun_turret_mount_left",id:123}];_context.next=25;return loadObject3d("/img/3d/systems/weapons/coilgun/turreted32GwRailgun/scene.gltf");case 25:_context.t11=_context.sent;_context.t8.call.call(_context.t8,_context.t9,_context.t10,_context.t11);_context.t12=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Mouros.prototype),"replaceSocketByName",this);_context.t13=this;_context.t14=[{name:"thruster_1",id:123},{name:"thruster_6",id:123},{name:"thruster_2",id:123},{name:"thruster_4",id:123},{name:"thruster_3",id:123},{name:"thruster_5",id:123}];_context.next=32;return loadObject3d("/img/3d/systems/thrusters/8mThruster/scene.gltf");case 32:_context.t15=_context.sent;_context.t12.call.call(_context.t12,_context.t13,_context.t14,_context.t15);this.setShipObject(object);case 35:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()}]);return Mouros;}(ships_ShipObject);/* harmony default export */ var protectorate_Mouros = (Mouros_Mouros);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/federation/Impetous.js
var Impetous_Impetous=/*#__PURE__*/function(_ShipObject){Object(inherits["a" /* default */])(Impetous,_ShipObject);function Impetous(ship,scene){var _this;Object(classCallCheck["a" /* default */])(this,Impetous);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Impetous).call(this,ship,scene));_this.defaultHeight=15;_this.sideSpriteSize=30;_this.overlaySpriteSize=80;_this.create();return _this;}Object(createClass["a" /* default */])(Impetous,[{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var object;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Impetous.prototype),"create",this).call(this);_context.next=3;return loadObject3d("/img/3d/ships/federation/Impetous/scene.gltf");case 3:object=_context.sent;//object.scale.set(2, 2, 2);
this.startRotation={x:90,y:90,z:0};this.setRotation(this.rotation.x,this.rotation.y,this.rotation.z);object.object.position.set(0,0,this.defaultHeight);/*
    super.replaceSocketByName(
      [
        { name: "Middle_hull_depress_top", id: 123 },
        { name: "Middle_hull_frame_top", id: 123 },
        { name: "Middle_hull_depress_left", id: 123 },
        { name: "Middle_hull_depress_right", id: 123 },
        { name: "Middle_hull_frame_left", id: 123 },
        { name: "Middle_hull_frame_right", id: 123 }
      ],
      await loadObject3d(
        "/img/3d/systems/weapons/conventional/30mmPDC/scene.gltf"
      )
    );

    super.replaceSocketByName(
      [
        { name: "railgun_turret_mount_right", id: 123 },
        ,
        { name: "railgun_turret_mount_left", id: 123 }
      ],
      await loadObject3d(
        "/img/3d/systems/weapons/coilgun/turreted64GwRailgun/scene.gltf"
      )
    );

    */_context.t0=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Impetous.prototype),"replaceSocketByName",this);_context.t1=this;_context.t2=[{name:"engine_mount_2",id:123},{name:"engine_mount_3",id:123},{name:"engine_mount_4",id:123},{name:"engine_mount_5",id:123}];_context.next=12;return loadObject3d("/img/3d/systems/thrusters/10mThruster/scene.gltf");case 12:_context.t3=_context.sent;_context.t0.call.call(_context.t0,_context.t1,_context.t2,_context.t3);_context.t4=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Impetous.prototype),"replaceSocketByName",this);_context.t5=this;_context.t6=[{name:"front-wing-left-mount1",id:501},{name:"front-wing-left-mount2",id:502},{name:"front-wing-left-mount3",id:503},{name:"front-wing-right-mount1",id:101},{name:"front-wing-right-mount2",id:102},{name:"front-wing-right-mount3",id:103}];_context.next=19;return loadObject3d("/img/3d/systems/weapons/conventional/2x30mmPDC/scene.gltf");case 19:_context.t7=_context.sent;_context.t4.call.call(_context.t4,_context.t5,_context.t6,_context.t7);_context.t8=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Impetous.prototype),"replaceSocketByName",this);_context.t9=this;_context.t10=[{name:"middle-top-mount1",id:623}];_context.next=26;return loadObject3d("/img/3d/systems/weapons/coilgun/turreted64GwRailgun/scene.gltf");case 26:_context.t11=_context.sent;_context.t8.call.call(_context.t8,_context.t9,_context.t10,_context.t11);_context.t12=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Impetous.prototype),"replaceSocketByName",this);_context.t13=this;_context.t14=[{name:"front-wing-left-top-mount1",id:623},{name:"front-wing-left-bottom-mount1",id:623},{name:"aft-wing-left-top-mount1",id:623},{name:"aft-wing-left-bottom-mount1",id:623}];_context.next=33;return loadObject3d("/img/3d/systems/weapons/conventional/2x140mmCannonTurret/scene.gltf");case 33:_context.t15=_context.sent;_context.t12.call.call(_context.t12,_context.t13,_context.t14,_context.t15);_context.t16=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Impetous.prototype),"replaceSocketByName",this);_context.t17=this;_context.t18=[{name:"front-wing-left-top-mount2",id:623},{name:"front-wing-left-bottom-mount2",id:623}];_context.next=40;return loadObject3d("/img/3d/systems/weapons/conventional/85mmAutoCannon/scene.gltf");case 40:_context.t19=_context.sent;_context.t16.call.call(_context.t16,_context.t17,_context.t18,_context.t19);this.setShipObject(object);case 43:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()}]);return Impetous;}(ships_ShipObject);/* harmony default export */ var federation_Impetous = (Impetous_Impetous);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/index.js

// CONCATENATED MODULE: ./src/client/view/game/renderer/icon/ShipIconContainer.js
var buildShipArray=function buildShipArray(iconsAsObject){return Object.keys(iconsAsObject).map(function(key){return iconsAsObject[key];});};var ShipIconContainer_createIcon=function createIcon(ship,scene){return new ships_namespaceObject[ship.shipModel](ship,scene);};var ShipIconContainer_createGhostShipIcon=function createGhostShipIcon(ship,scene,currentUser){var icon=new ships_namespaceObject[ship.shipModel](ship,scene);icon.setGhostShip(ship.player.is(currentUser));icon.hide();return icon;};var ShipIconContainer_ShipIconContainer=/*#__PURE__*/function(){function ShipIconContainer(scene,currentUser){Object(classCallCheck["a" /* default */])(this,ShipIconContainer);this.iconsAsObject={};this.iconsAsArray=[];this.scene=scene;this.currentUser=currentUser;this.ghostShipIcons=[];}Object(createClass["a" /* default */])(ShipIconContainer,[{key:"shipsLoaded",value:function shipsLoaded(){return Promise.all(this.iconsAsArray.map(function(icon){return icon.isShipObjectLoaded;}));}},{key:"getGhostShipIconByShip",value:function getGhostShipIconByShip(ship){var icon=this.ghostShipIcons.find(function(icon){return icon.ship===ship;});if(!icon){icon=ShipIconContainer_createGhostShipIcon(ship,this.scene,this.currentUser);this.ghostShipIcons.push(icon);}return icon;}},{key:"update",value:function update(gamedata){var _this=this;gamedata.ships.getShips().forEach(function(ship){if(!_this.hasIcon(ship.id)){_this.iconsAsObject[ship.id]=ShipIconContainer_createIcon(ship,_this.scene);}else{_this.iconsAsObject[ship.id].consumeShipdata(ship);}var ghost=_this.ghostShipIcons.find(function(icon){return icon.ship.id===ship.id;});if(ghost){ghost.consumeShipdata(ship);}});this.iconsAsArray=buildShipArray(this.iconsAsObject);}},{key:"getByShip",value:function getByShip(ship){return this.iconsAsObject[ship.id];}},{key:"getById",value:function getById(id){return this.iconsAsObject[id];}},{key:"onEvent",value:function onEvent(name,payload){var target=this["on"+name];if(target&&typeof target==="function"){target.call(this,payload);}}},{key:"onZoomEvent",value:function onZoomEvent(payload){var zoom=payload.zoom;var alpha=zoom>2?zoom-2:0;if(alpha>1){alpha=1;}this.iconsAsArray.forEach(function(icon){icon.setOverlayColorAlpha(alpha);});}},{key:"getArray",value:function getArray(){return this.iconsAsArray;}},{key:"hasIcon",value:function hasIcon(shipId){return Boolean(this.iconsAsObject[shipId]);}},{key:"getIconById",value:function getIconById(shipId){return this.iconsAsObject[shipId];}},{key:"getIconsInProximity",value:function getIconsInProximity(payload){var hexHeight=this.coordinateConverter.getHexHeightViewport();var currentDistance=hexHeight/10;var icons=[];if(currentDistance<30){icons=this.getIconsInSameHex(payload.hex);}else{var closest=null;var closestDistance=null;this.iconsAsArray.forEach(function(shipIcon){var currentDistance=math_distance(shipIcon.getPosition(),payload.game);if(currentDistance<10&&(!closest||currentDistance<closestDistance)){closest=shipIcon;closestDistance=currentDistance;}},this);if(closest)icons.push(closest);}return icons;}},{key:"getIconsInSameHex",value:function getIconsInSameHex(hex){return this.iconsAsArray.filter(function(shipIcon){return this.coordinateConverter.fromGameToHex(shipIcon.getPosition()).equals(hex);},this);}},{key:"getFinalMovementInSameHex",value:function getFinalMovementInSameHex(hex){return this.iconsAsArray.filter(function(shipIcon){return!shipIcon.ship.isDestroyed()&&shipIcon.getLastMovement().position.equals(hex);},this);}},{key:"render",value:function render(renderPayload){this.iconsAsArray.forEach(function(icon){return icon.render(renderPayload);});}}]);return ShipIconContainer;}();/* harmony default export */ var icon_ShipIconContainer = (ShipIconContainer_ShipIconContainer);
// CONCATENATED MODULE: ./src/client/view/game/renderer/electronicWarfare/OEWIndicator.js
var OEWIndicator_OEWIndicator=/*#__PURE__*/function(){function OEWIndicator(shipIcon,targetIcon,targetGhost,shipGhost,amount,mine,scene){Object(classCallCheck["a" /* default */])(this,OEWIndicator);this.scene=scene;this.shipIcon=shipIcon;this.targetIcon=targetIcon;this.targetGhost=targetGhost;this.shipGhost=shipGhost;this.amount=amount;this.mine=mine;this.visible=false;this.targetPosition=!this.targetGhost||this.targetGhost.hidden?targetIcon.getPosition():targetGhost.getPosition();this.shipPosition=!this.shipGhost||this.shipGhost.hidden?this.shipIcon.getPosition():this.shipGhost.getPosition();this.line=this.createLine();}Object(createClass["a" /* default */])(OEWIndicator,[{key:"createLine",value:function createLine(){var line=new sprite_LineSprite(this.shipIcon.getPosition().setZ(this.getZ()),this.targetPosition.setZ(this.getZ()),this.amount*1+5,{color:this.mine?COLOR_OEW_FRIENDLY:COLOR_OEW_ENEMY,opacity:0.5,type:"dashed-circle",textureSize:this.amount*1+5,//minFilter: THREE.NearestFilter,
pulseAmount:1});line.addTo(this.scene);return line;}},{key:"getZ",value:function getZ(){return 0;}},{key:"remove",value:function remove(){this.line.destroy();}},{key:"render",value:function render(zoom){if(!this.visible){return;}//this.line.render(zoom);
var newTargetPosition=!this.targetGhost||this.targetGhost.hidden?this.targetIcon.getPosition():this.targetGhost.getPosition();var newShipPosition=!this.shipGhost||this.shipGhost.hidden?this.shipIcon.getPosition():this.shipGhost.getPosition();if(!this.shipPosition.equals(newShipPosition)||!this.targetPosition.equals(newTargetPosition)){this.shipPosition=newShipPosition;this.targetPosition=newTargetPosition;this.line.update(this.shipPosition.setZ(this.getZ()),this.targetPosition.setZ(this.getZ()),this.amount*1+5);if(this.line&&this.line.updateTextureSize){this.line.updateTextureSize(this.amount*1+5);}}}},{key:"update",value:function update(ship,amount){this.ship=ship;if(this.amount!==amount){this.amount=amount;this.line.update(this.shipPosition.setZ(this.getZ()),this.targetPosition.setZ(this.getZ()),this.amount*1+5);if(this.line&&this.line.updateTextureSize){this.line.updateTextureSize(this.amount*1+5);}}return this;}},{key:"show",value:function show(){this.visible=true;this.line.show();}},{key:"hide",value:function hide(){this.visible=false;this.line.hide();}}]);return OEWIndicator;}();/* harmony default export */ var electronicWarfare_OEWIndicator = (OEWIndicator_OEWIndicator);
// CONCATENATED MODULE: ./src/client/view/game/renderer/electronicWarfare/ShipEWIndicators.js
var ShipEWIndicators_ShipEWIndicators=/*#__PURE__*/function(){function ShipEWIndicators(ship,shipIconContainer,currentUser,scene){Object(classCallCheck["a" /* default */])(this,ShipEWIndicators);this.ship=ship;this.icon=shipIconContainer.getByShip(ship);this.shipIconContainer=shipIconContainer;this.currentUser=currentUser;this.scene=scene;this.oew=[];this.update(this.ship);}Object(createClass["a" /* default */])(ShipEWIndicators,[{key:"update",value:function update(ship,useGhost){this.ship=ship;this.createOEW(useGhost);return this;}},{key:"show",value:function show(){this.oew.forEach(function(oew){return oew.show();});return this;}},{key:"hide",value:function hide(){this.oew.forEach(function(oew){return oew.hide();});return this;}},{key:"isShip",value:function isShip(ship){return this.ship.id===ship.id;}},{key:"render",value:function render(zoom){this.oew.forEach(function(oew){return oew.render(zoom);});}},{key:"createOEW",value:function(){var _createOEW=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var _this=this;var old,newOew;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.shipIconContainer.shipsLoaded();case 2:old=this.oew;newOew=this.ship.electronicWarfare.getAllOew().map(function(ewEntry){var targetIcon=_this.shipIconContainer.getById(ewEntry.targetShipId);var targetGhost=_this.shipIconContainer.getGhostShipIconByShip(targetIcon.ship);var shipGhost=_this.shipIconContainer.getGhostShipIconByShip(_this.icon.ship);var indicator=_this.oew.find(function(oew){return oew.targetIcon===targetIcon;});if(!indicator){indicator=new electronicWarfare_OEWIndicator(_this.icon,targetIcon,targetGhost,shipGhost,ewEntry.amount,_this.ship.player.is(_this.currentUser),_this.scene);}return indicator.update(_this.ship,ewEntry.amount);});old.filter(function(indicator){return newOew.every(function(indicatorNew){return indicatorNew!==indicator;});}).forEach(function(indicator){return indicator.remove();});this.oew=newOew;case 6:case"end":return _context.stop();}}},_callee,this);}));function createOEW(){return _createOEW.apply(this,arguments);}return createOEW;}()}]);return ShipEWIndicators;}();/* harmony default export */ var electronicWarfare_ShipEWIndicators = (ShipEWIndicators_ShipEWIndicators);
// CONCATENATED MODULE: ./src/client/view/game/renderer/electronicWarfare/CurrentOEWIndicator.js
var CurrentOEWIndicator_COLOR_OEW_FRIENDLY=new three_module["Color"](100/255,90/255,250/255);var CurrentOEWIndicator_COLOR_OEW_ENEMY=new three_module["Color"](255/255,40/255,40/255);var CurrentOEWIndicator_CurrentOEWIndicator=/*#__PURE__*/function(_OEWIndicator){Object(inherits["a" /* default */])(CurrentOEWIndicator,_OEWIndicator);function CurrentOEWIndicator(shipIcon,targetIcon,amount,mine,scene){Object(classCallCheck["a" /* default */])(this,CurrentOEWIndicator);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CurrentOEWIndicator).call(this,shipIcon,targetIcon,null,null,amount,mine,scene));}Object(createClass["a" /* default */])(CurrentOEWIndicator,[{key:"createLine",value:function createLine(){return new renderer_Line(this.scene,{start:Object(objectSpread2["a" /* default */])({},this.shipIcon.getPosition(),{z:this.getZ()}),end:Object(objectSpread2["a" /* default */])({},this.targetPosition,{z:this.getZ()}),width:this.amount*1+5,color:this.mine?CurrentOEWIndicator_COLOR_OEW_FRIENDLY:CurrentOEWIndicator_COLOR_OEW_ENEMY,opacity:0.1,pulseAmount:1,dashSize:0});}},{key:"getZ",value:function getZ(){return 0;return this.mine?15:30;}}]);return CurrentOEWIndicator;}(electronicWarfare_OEWIndicator);/* harmony default export */ var electronicWarfare_CurrentOEWIndicator = (CurrentOEWIndicator_CurrentOEWIndicator);
// CONCATENATED MODULE: ./src/client/view/game/renderer/electronicWarfare/ShipCurrentEWIndicators.js
var ShipCurrentEWIndicators_ShipCurrentEWIndicators=/*#__PURE__*/function(){function ShipCurrentEWIndicators(ship,shipIconContainer,currentUser,scene){Object(classCallCheck["a" /* default */])(this,ShipCurrentEWIndicators);this.ship=ship;this.icon=shipIconContainer.getByShip(ship);this.shipIconContainer=shipIconContainer;this.currentUser=currentUser;this.scene=scene;this.oew=[];this.update(this.ship);}Object(createClass["a" /* default */])(ShipCurrentEWIndicators,[{key:"update",value:function update(ship){this.ship=ship;this.oew=this.createOEW();return this;}},{key:"show",value:function show(){this.oew.forEach(function(oew){return oew.show();});return this;}},{key:"hide",value:function hide(){this.oew.forEach(function(oew){return oew.hide();});return this;}},{key:"isShip",value:function isShip(ship){return this.ship.id===ship.id;}},{key:"render",value:function render(zoom){this.oew.forEach(function(oew){return oew.render(zoom);});}},{key:"createOEW",value:function createOEW(){var _this=this;var old=this.oew;var newOew=this.ship.electronicWarfare.inEffect.getAllOew().map(function(ewEntry){var targetIcon=_this.shipIconContainer.getById(ewEntry.targetShipId);var indicator=_this.oew.find(function(oew){return oew.targetIcon===targetIcon;});if(!indicator){indicator=new electronicWarfare_CurrentOEWIndicator(_this.icon,targetIcon,ewEntry.amount,_this.ship.player.is(_this.currentUser),_this.scene);}return indicator.update(_this.ship,ewEntry.amount);});old.filter(function(indicator){return newOew.every(function(indicatorNew){return indicatorNew!==indicator;});}).forEach(function(indicator){return indicator.remove();});return newOew;}}]);return ShipCurrentEWIndicators;}();/* harmony default export */ var electronicWarfare_ShipCurrentEWIndicators = (ShipCurrentEWIndicators_ShipCurrentEWIndicators);
// CONCATENATED MODULE: ./src/client/view/game/renderer/electronicWarfare/ElectronicWarfareIndicatorService.js
var COLOR_OEW_DIST=new three_module["Color"](255/255,157/255,0/255);var COLOR_SDEW=new three_module["Color"](109/255,189/255,255/255);var COLOR_OEW_SOEW=new three_module["Color"](1,1,1);var ElectronicWarfareIndicatorService_ElectronicWarfareIndicatorService=/*#__PURE__*/function(){function ElectronicWarfareIndicatorService(scene,iconContainer,currentUser){Object(classCallCheck["a" /* default */])(this,ElectronicWarfareIndicatorService);this.scene=scene;this.shipIconContainer=iconContainer;this.currentUser=currentUser;this.indicators=[];this.currentIndicators=[];}Object(createClass["a" /* default */])(ElectronicWarfareIndicatorService,[{key:"getCurrentIndicators",value:function getCurrentIndicators(ship){var indicator=this.currentIndicators.find(function(indicator){return indicator.isShip(ship);});if(!indicator){indicator=new electronicWarfare_ShipCurrentEWIndicators(ship,this.shipIconContainer,this.currentUser,this.scene);this.currentIndicators.push(indicator);}return indicator;}},{key:"getIndicators",value:function getIndicators(ship){var indicator=this.indicators.find(function(indicator){return indicator.isShip(ship);});if(!indicator){indicator=new electronicWarfare_ShipEWIndicators(ship,this.shipIconContainer,this.currentUser,this.scene);this.indicators.push(indicator);}return indicator;}},{key:"render",value:function render(zoom){this.indicators.forEach(function(indicator){return indicator.render(zoom);});this.currentIndicators.forEach(function(indicator){return indicator.render(zoom);});}},{key:"showCurrentForShip",value:function showCurrentForShip(ship){this.getCurrentIndicators(ship).update(ship).show();}},{key:"hideCurrentForShip",value:function hideCurrentForShip(ship){this.getCurrentIndicators(ship).update(ship).hide();}},{key:"showForShip",value:function showForShip(ship){this.getIndicators(ship).update(ship).show();}},{key:"hideForShip",value:function hideForShip(ship){this.getIndicators(ship).update(ship).hide();}},{key:"hideAll",value:function hideAll(){this.indicators.forEach(function(indicators){return indicators.hide();});}},{key:"hideAllCurrent",value:function hideAllCurrent(){this.currentIndicators.forEach(function(indicators){return indicators.hide();});}}]);return ElectronicWarfareIndicatorService;}();/* harmony default export */ var electronicWarfare_ElectronicWarfareIndicatorService = (ElectronicWarfareIndicatorService_ElectronicWarfareIndicatorService);
// CONCATENATED MODULE: ./src/client/view/game/renderer/TerrainRenderer.js
var TerrainRenderer_TerrainRenderer=/*#__PURE__*/function(){function TerrainRenderer(scene){Object(classCallCheck["a" /* default */])(this,TerrainRenderer);this.scene=scene;this.terrain=null;this.terrainObjects=[];}Object(createClass["a" /* default */])(TerrainRenderer,[{key:"init",value:function init(){}},{key:"update",value:function update(terrain){var _this=this;//TODO: This creates new objects every time gamedata updates.
return;this.terrain=terrain;this.terrainObjects=this.terrain.getEntities().forEach(function(entity){return{entity:entity,object:_this.createObject(entity)};});}},{key:"createObject",value:function(){var _createObject=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(entity){var object,material,scale;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return loadObject("/img/3d/sphere/scene.gltf");case 2:object=_context.sent;material=object.children[0].material;material.emissive=new three_module["Color"](1,1,1);object.position.set(0,0,0);scale=HexagonMath.getHexWidth()*entity.diameter;object.scale.set(scale,scale,scale);this.scene.add(object);case 9:case"end":return _context.stop();}}},_callee,this);}));function createObject(_x){return _createObject.apply(this,arguments);}return createObject;}()},{key:"render",value:function render(){}}]);return TerrainRenderer;}();/* harmony default export */ var renderer_TerrainRenderer = (TerrainRenderer_TerrainRenderer);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipWindow/ShipWindowManager.js
var ShipWindowManager_ShipWindowManager=/*#__PURE__*/function(){function ShipWindowManager(uiState,movementService){Object(classCallCheck["a" /* default */])(this,ShipWindowManager);this.uiState=uiState;this.movementService=movementService;this.ships=[];}Object(createClass["a" /* default */])(ShipWindowManager,[{key:"open",value:function open(ship){this.ships=this.ships.filter(function(otherShip){return otherShip.player.user!==ship.player.user;});if(!this.ships.includes(ship)){this.ships.push(ship);}this.uiState.setShipWindows({ships:this.ships,movementService:this.movementService});}},{key:"close",value:function close(ship){this.ships=this.ships.filter(function(openShip){return openShip!==ship;});this.uiState.setShipWindows({ships:this.ships,movementService:this.movementService});}},{key:"closeAll",value:function closeAll(){this.ships=[];this.uiState.setShipWindows({ships:this.ships,movementService:this.movementService});}},{key:"update",value:function update(){this.uiState.setShipWindows({ships:this.ships,movementService:this.movementService});}}]);return ShipWindowManager;}();/* harmony default export */ var shipWindow_ShipWindowManager = (ShipWindowManager_ShipWindowManager);
// CONCATENATED MODULE: ./src/client/view/game/movement/MovementPath.js
var MovementPath_MovementPath=/*#__PURE__*/function(){function MovementPath(ship,scene,terrain,ghost,mine){Object(classCallCheck["a" /* default */])(this,MovementPath);this.ship=ship;this.scene=scene;this.terrain=terrain;this.ghost=ghost;this.color=mine?COLOR_FRIENDLY:COLOR_ENEMY;//this.color = new THREE.Color(19 / 255, 96 / 255, 19 / 255);
this.objects=[];this.movementService=new movement_MovementService();this.create();}Object(createClass["a" /* default */])(MovementPath,[{key:"remove",value:function remove(){var _this=this;this.objects.forEach(function(object3d){_this.scene.remove(object3d.mesh);object3d.destroy();});this.ghost.hide();}},{key:"create",value:function create(){/*
    const startMove = this.movementService.getNewEndMove(
      this.ship,
      this.terrain
    );
    */var startMove=this.ship.movement.getLastEndMoveOrSurrogate();var start=startMove.position;var endMove=this.movementService.getNewEndMove(this.ship,this.terrain);var end=endMove.position;var line=MovementPath_createMovementLine(this.scene,start,end,this.color,0.5,this.ghost.shipZ);this.objects.push(line);MovementPath_createMovementFacing(this.ghost,endMove.facing,end,this.color);}}]);return MovementPath;}();var MovementPath_createMovementLine=function createMovementLine(scene,position,target,color){var opacity=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0.8;var z=arguments.length>5?arguments[5]:undefined;var line=new sprite_LineSprite(new utils_Vector({x:position.x,y:position.y,z:z}),new utils_Vector({x:target.x,y:target.y,z:z}),30,{color:color,opacity:opacity,type:"dashed-arrow",textureSize:30,pulseAmount:1,roundTestureRepeate:true});line.addTo(scene);return line;};var MovementPath_createMovementFacing=function createMovementFacing(ghost,facing,target,color){ghost.show();ghost.setPosition(target);ghost.setFacing(-hexFacingToAngle(facing));ghost.setGhostShipEmissive(color);ghost.setOpacity(0.2);ghost.mapIcon.setMovementTarget().replaceColor(color).setOverlayColorAlpha(1).show();/*
  const size = coordinateConverter.getHexDistance() * 1.5;
  const facingSprite = new ShipFacingSprite(
    { width: size, height: size },
    0.01,
    1.6,
    facing
  );
  facingSprite.setPosition(target);
  facingSprite.setOverlayColor(color);
  facingSprite.setOverlayColorAlpha(1);
  facingSprite.setFacing(hexFacingToAngle(facing));

  return facingSprite;
  */};/* harmony default export */ var movement_MovementPath = (MovementPath_MovementPath);
// CONCATENATED MODULE: ./src/client/view/game/movement/MovementPathService.js
var MovementPathService_MovementPathService=/*#__PURE__*/function(){function MovementPathService(scene,shipIconContainer,currentUser){Object(classCallCheck["a" /* default */])(this,MovementPathService);this.scene=scene;this.shipIconContainer=shipIconContainer;this.terrain=null;this.currentUser=currentUser;this.paths=[];}Object(createClass["a" /* default */])(MovementPathService,[{key:"getPath",value:function getPath(ship){return this.paths.find(function(path){return path.ship.id===ship.id;});}},{key:"update",value:function update(gameData){this.terrain=gameData.terrain;}},{key:"hideAllMovementPaths",value:function hideAllMovementPaths(){var _this=this;this.paths.forEach(function(path){return path.movementPath.remove(_this.scene);});this.paths=[];}},{key:"hideMovementPath",value:function hideMovementPath(ship){var path=this.getPath(ship);if(!path){return;}path.movementPath.remove(this.scene);this.paths=this.paths.filter(function(path){return path.ship!==ship;});}},{key:"showMovementPath",value:function showMovementPath(ship){var path=this.getPath(ship);if(!path){path={ship:ship,ghost:this.shipIconContainer.getGhostShipIconByShip(ship),movementPath:null};this.paths.push(path);}if(path.movementPath){//TODO: this is inefficient and causes flickering
path.movementPath.remove(this.scene);}path.ship=ship;path.movementPath=new movement_MovementPath(ship,this.scene,this.terrain,path.ghost,ship.player.is(this.currentUser));}}]);return MovementPathService;}();/* harmony default export */ var movement_MovementPathService = (MovementPathService_MovementPathService);
// CONCATENATED MODULE: ./src/model/game/gameStatuses.mjs
var LOBBY="lobby";var ACTIVE="active";var FINISHED="finished";var ABANDONED="abandoned";
// CONCATENATED MODULE: ./src/model/game/gamePhases.mjs
var DEPLOYMENT="deployment";var GAME="game";
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/PhaseStrategy.js
var getInterestingStuffInPosition=function getInterestingStuffInPosition(payload,shipIconContainer){var mouseovered=payload.entities.filter(function(entity){return entity instanceof window.ShipObject&&!entity.ship.isDestroyed();});if(mouseovered.length>0){return mouseovered;}return shipIconContainer.getIconsInProximity(payload).filter(function(icon){return!icon.ship.isDestroyed();});};var PhaseStrategy_PhaseStrategy=/*#__PURE__*/function(){function PhaseStrategy(services){Object(classCallCheck["a" /* default */])(this,PhaseStrategy);this.services=services;this.strategies=[];this.inactive=true;this.gameData=null;this.animationPaused=true;this.animationReversed=false;this.currentDeltaTime=0;this.animationStartTime=0;this.totalAnimationTime=0;this.lastAnimationTime=0;this.animationEndtime=0;this.animationTurnLength=null;}Object(createClass["a" /* default */])(PhaseStrategy,[{key:"onEvent",value:function onEvent(name,payload){this.callStrategies(name,payload);}},{key:"updateStrategies",value:function updateStrategies(gamedata){this.strategies.forEach(function(strategy){return strategy.update(gamedata);});}},{key:"activateStrategies",value:function activateStrategies(){var _this=this;this.strategies.forEach(function(strategy){return strategy.activate(_this.services);});}},{key:"callStrategies",value:function callStrategies(functionName,payload){this.strategies.forEach(function(strategy){if(strategy[functionName]&&(!payload||!payload.stopped)){strategy[functionName](payload);}});}},{key:"render",value:function render(coordinateConverter,scene,zoom){this.updateDeltaTime(this.animationPaused);this.updateTotalAnimationTime(this.animationPaused);var _this$services=this.services,shipIconContainer=_this$services.shipIconContainer,torpedoIconContainer=_this$services.torpedoIconContainer;var renderPayload={delta:this.currentDeltaTime,total:this.totalAnimationTime,last:this.lastAnimationTime,zoom:zoom};this.callStrategies("render",renderPayload);shipIconContainer&&shipIconContainer.render(renderPayload);torpedoIconContainer&&torpedoIconContainer.render(renderPayload);return renderPayload;}},{key:"animateFromTo",value:function animateFromTo(start,end){this.animationStartTime=start;this.totalAnimationTime=start;this.animationReversed=false;this.lastAnimationTime=null;this.currentDeltaTime=0;this.animationEndtime=end;this.animationPaused=false;}},{key:"pauseAnimation",value:function pauseAnimation(){this.animationPaused=true;}},{key:"unpauseAnimation",value:function unpauseAnimation(){this.animationReversed=false;this.animationPaused=false;}},{key:"unpauseAndRewindAnimation",value:function unpauseAndRewindAnimation(){this.animationReversed=true;this.animationPaused=false;}},{key:"setAnimationTime",value:function setAnimationTime(time){this.totalAnimationTime=time;this.lastAnimationTime=null;this.currentDeltaTime=0;}},{key:"updateTotalAnimationTime",value:function updateTotalAnimationTime(){if(this.animationPaused){return;}if(this.animationReversed){this.totalAnimationTime-=this.currentDeltaTime;if(this.totalAnimationTime<this.animationStartTime){this.totalAnimationTime=this.animationStartTime;this.animationPaused=true;}}else{this.totalAnimationTime+=this.currentDeltaTime;if(this.animationEndtime&&this.totalAnimationTime>=this.animationEndtime){this.totalAnimationTime=this.animationEndtime;this.animationPaused=true;}}}},{key:"updateDeltaTime",value:function updateDeltaTime(){var now=Date.now();if(!this.lastAnimationTime){this.lastAnimationTime=now;this.currentDeltaTime=0;}this.currentDeltaTime=now-this.lastAnimationTime;this.lastAnimationTime=now;}},{key:"update",value:function update(gamedata){var uiState=this.services.uiState;this.gameData=gamedata;uiState.setGameData(gamedata);this.updateStrategies(gamedata);return this;}},{key:"activate",value:function activate(){this.inactive=false;this.activateStrategies();return this;}},{key:"deactivate",value:function deactivate(){this.inactive=true;this.callStrategies("deactivate");return this;}},{key:"triggerEvent",value:function triggerEvent(name,payload){this.callStrategies(name,payload);}},{key:"onScrollEvent",value:function onScrollEvent(payload){this.callStrategies("onScroll",payload);}},{key:"onZoomEvent",value:function onZoomEvent(payload){this.callStrategies("onZoom",payload);}},{key:"canDisturb",value:function canDisturb(){return true;}},{key:"commitTurn",value:function commitTurn(gameConnector){}}]);return PhaseStrategy;}();/* harmony default export */ var phaseStrategy_PhaseStrategy = (PhaseStrategy_PhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/LobbyPhaseStrategy.js
var LobbyPhaseStrategy_LobbyPhaseStrategy=/*#__PURE__*/function(_PhaseStrategy){Object(inherits["a" /* default */])(LobbyPhaseStrategy,_PhaseStrategy);function LobbyPhaseStrategy(){Object(classCallCheck["a" /* default */])(this,LobbyPhaseStrategy);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(LobbyPhaseStrategy).apply(this,arguments));}Object(createClass["a" /* default */])(LobbyPhaseStrategy,[{key:"update",value:function update(gamedata){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(LobbyPhaseStrategy.prototype),"update",this).call(this,gamedata);var uiState=this.services.uiState;uiState.setLobby(true);return this;}},{key:"onEvent",value:function onEvent(name,payload){switch(name){case"takeSlot":return this.services.gameConnector.takeSlot(payload.id);case"leaveSlot":return this.services.gameConnector.leaveSlot(payload.id);case"buyShips":return this.services.gameConnector.buyShips(payload.slot.id,payload.ships);default:return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(LobbyPhaseStrategy.prototype),"onEvent",this).call(this,name,payload);}}},{key:"deactivate",value:function deactivate(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(LobbyPhaseStrategy.prototype),"deactivate",this).call(this);var uiState=this.services.uiState;uiState.setLobby(false);return this;}}]);return LobbyPhaseStrategy;}(phaseStrategy_PhaseStrategy);/* harmony default export */ var phaseStrategy_LobbyPhaseStrategy = (LobbyPhaseStrategy_LobbyPhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/UiStrategy.js
var UiStrategy_UiStrategy=/*#__PURE__*/function(){function UiStrategy(){Object(classCallCheck["a" /* default */])(this,UiStrategy);this.services=null;this.gameData=null;}Object(createClass["a" /* default */])(UiStrategy,[{key:"deactivate",value:function deactivate(){}},{key:"activate",value:function activate(services){this.services=services;}},{key:"update",value:function update(gameData){this.gameData=gameData;}},{key:"stopEvent",value:function stopEvent(payload){payload.stopped=true;}}]);return UiStrategy;}();/* harmony default export */ var uiStrategy_UiStrategy = (UiStrategy_UiStrategy);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/MouseOverShowsMovementPath.js
var MouseOverShowsMovementPath_MouseOverShowsMovementPath=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(MouseOverShowsMovementPath,_UiStrategy);function MouseOverShowsMovementPath(){Object(classCallCheck["a" /* default */])(this,MouseOverShowsMovementPath);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(MouseOverShowsMovementPath).apply(this,arguments));}Object(createClass["a" /* default */])(MouseOverShowsMovementPath,[{key:"deactivate",value:function deactivate(){var movementPathService=this.services.movementPathService;movementPathService.hideAllMovementPaths();}},{key:"mouseOverShip",value:function mouseOverShip(payload){var movementPathService=this.services.movementPathService;movementPathService.hideAllMovementPaths();movementPathService.showMovementPath(payload.entity.ship);}},{key:"mouseOutShip",value:function mouseOutShip(){var movementPathService=this.services.movementPathService;movementPathService.hideAllMovementPaths();}}]);return MouseOverShowsMovementPath;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_MouseOverShowsMovementPath = (MouseOverShowsMovementPath_MouseOverShowsMovementPath);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/SelectedShipMovementPath.js
var hideAllMovementPaths=function hideAllMovementPaths(shipIconContainer){shipIconContainer.getArray().forEach(function(icon){icon.hideMovementPath();});};var SelectedShipMovementPath_SelectedShipMovementPath=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectedShipMovementPath,_UiStrategy);function SelectedShipMovementPath(){Object(classCallCheck["a" /* default */])(this,SelectedShipMovementPath);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectedShipMovementPath).apply(this,arguments));}Object(createClass["a" /* default */])(SelectedShipMovementPath,[{key:"deactivate",value:function deactivate(){var shipIconContainer=this.services.shipIconContainer;hideAllMovementPaths(shipIconContainer);}},{key:"update",value:function update(gameData){var uiState=this.services.uiState;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(SelectedShipMovementPath.prototype),"update",this).call(this,gameData);var ship=uiState.getSelectedShip();if(ship){this.shipStateChanged(ship);}}},{key:"shipStateChanged",value:function shipStateChanged(ship){var _this$services=this.services,shipIconContainer=_this$services.shipIconContainer,uiState=_this$services.uiState;if(uiState.getSelectedShip()!==ship||!this.gameData){return;}hideAllMovementPaths(shipIconContainer);shipIconContainer.getByShip(ship).showMovementPath(this.gameData.terrain);}},{key:"shipSelected",value:function shipSelected(ship){var shipIconContainer=this.services.shipIconContainer;if(!this.gameData){return;}hideAllMovementPaths(shipIconContainer);shipIconContainer.getByShip(ship).showMovementPath(this.gameData.terrain);}},{key:"mouseOutShip",value:function mouseOutShip(payload){var uiState=this.services.uiState;var ship=uiState.getSelectedShip();if(ship){this.shipStateChanged(ship);}}},{key:"shipDeselected",value:function shipDeselected(){var shipIconContainer=this.services.shipIconContainer;hideAllMovementPaths(shipIconContainer);}}]);return SelectedShipMovementPath;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_SelectedShipMovementPath = (SelectedShipMovementPath_SelectedShipMovementPath);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/HighlightSelectedShip.js
var HighlightSelectedShip_HighlightSelectedShip=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(HighlightSelectedShip,_UiStrategy);function HighlightSelectedShip(){var _this;Object(classCallCheck["a" /* default */])(this,HighlightSelectedShip);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(HighlightSelectedShip).call(this));_this.active=false;_this.activeTime=0;_this.icon=null;//currentOpacity = opacity + (sineAmplitude * 0.5 * sin(gameTime/sineFrequency) + sineAmplitude)
return _this;}Object(createClass["a" /* default */])(HighlightSelectedShip,[{key:"hide",value:function hide(){var shipIconContainer=this.services.shipIconContainer;if(this.icon){this.icon.revertEmissive();this.icon.mapIcon.revertColor();this.icon.hexSprites.forEach(function(sprite){return sprite.revertColor();});var ghost=shipIconContainer.getGhostShipIconByShip(this.icon.ship);ghost.revertOpacity();ghost.mapIcon.setMovementTarget();ghost.mapIcon.revertColor();}this.icon=null;}},{key:"deactivate",value:function deactivate(){this.hide();}},{key:"shipSelected",value:function shipSelected(ship){var shipIconContainer=this.services.shipIconContainer;this.active=true;this.activeTime=0;this.icon=shipIconContainer.getByShip(ship);}},{key:"shipDeselected",value:function shipDeselected(ship){var shipIconContainer=this.services.shipIconContainer;this.active=true;this.activeTime=0;this.hide();}},{key:"render",value:function render(_ref){var delta=_ref.delta;var shipIconContainer=this.services.shipIconContainer;if(!this.active){return;}var sineAmplitude=1;var sineFrequency=200;var opacity=0.5*Math.sin(this.activeTime/sineFrequency)+sineAmplitude*0.5;opacity=0.2+0.6*opacity;var ghost=shipIconContainer.getGhostShipIconByShip(this.icon.ship);//if (ghost.hidden) {
var color=COLOR_FRIENDLY_HIGHLIGHT.clone().multiplyScalar(opacity);this.icon.replaceEmissive(color);ghost.setGhostShipEmissive(color);ghost.replaceOpacity(opacity);ghost.mapIcon.setMovementTarget().replaceColor(color).setOverlayColorAlpha(1);this.icon.hexSprites.forEach(function(sprite){return sprite.replaceColor(color.clone());});this.icon.mapIcon.replaceColor(color);this.activeTime+=delta;}}]);return HighlightSelectedShip;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_HighlightSelectedShip = (HighlightSelectedShip_HighlightSelectedShip);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/movement/SelectedShipMovementUi.js
var SelectedShipMovementUi_SelectedShipMovementUi=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectedShipMovementUi,_UiStrategy);function SelectedShipMovementUi(){Object(classCallCheck["a" /* default */])(this,SelectedShipMovementUi);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectedShipMovementUi).apply(this,arguments));}Object(createClass["a" /* default */])(SelectedShipMovementUi,[{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.hideShipMovement();}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(SelectedShipMovementUi.prototype),"update",this).call(this,gameData);this.shipStateChanged();}},{key:"shipStateChanged",value:function shipStateChanged(){var uiState=this.services.uiState;var ship=uiState.getSelectedShip();if(ship){uiState.showShipMovement(ship,true);}}},{key:"shipSelected",value:function shipSelected(ship){var uiState=this.services.uiState;uiState.showShipMovement(ship,true);}},{key:"shipDeselected",value:function shipDeselected(){var uiState=this.services.uiState;uiState.hideShipMovement();}}]);return SelectedShipMovementUi;}(uiStrategy_UiStrategy);/* harmony default export */ var movement_SelectedShipMovementUi = (SelectedShipMovementUi_SelectedShipMovementUi);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowDeploymentAreas.js
var ShowDeploymentAreas_ShowDeploymentAreas=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(ShowDeploymentAreas,_UiStrategy);function ShowDeploymentAreas(){var _this;Object(classCallCheck["a" /* default */])(this,ShowDeploymentAreas);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowDeploymentAreas).call(this));_this.areas=[];return _this;}Object(createClass["a" /* default */])(ShowDeploymentAreas,[{key:"deactivate",value:function deactivate(){var scene=this.services.scene;this.areas.forEach(function(area){area.sprites.forEach(function(sprite){scene.remove(sprite.mesh);sprite.destroy();});});}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowDeploymentAreas.prototype),"update",this).call(this,gameData);var _this$services=this.services,scene=_this$services.scene,coordinateConverter=_this$services.coordinateConverter,currentUser=_this$services.currentUser;this.areas=gameData.slots.getSlots().map(function(slot){var hexagons=slot.deploymentLocation.spiral(slot.deploymentRadius);var color=new three_module["Color"](1,1,1);if(slot.isUsers(currentUser)){color=new three_module["Color"](39/255,196/255,39/255);}else if(!gameData.slots.isUsersTeamSlot(slot,currentUser)){color=new three_module["Color"](196/255,39/255,39/255);}return{slot:slot,sprites:hexagons.map(function(hex){var sprite=new sprite_HexagonSprite(coordinateConverter.fromHexToGame(hex));sprite.setOpacity(0.5);sprite.setOverlayColor(color);sprite.setOverlayColorAlpha(0.5);scene.add(sprite.mesh);return sprite;})};});}},{key:"selectShip",value:function selectShip(ship){}}]);return ShowDeploymentAreas;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_ShowDeploymentAreas = (ShowDeploymentAreas_ShowDeploymentAreas);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js
var assertThisInitialized = __webpack_require__(15);

// CONCATENATED MODULE: ./src/client/view/game/animation/ShipMovementAnimation/ShipEvasionMovementPath.js
var ShipEvasionMovementPath_getRandomPosition=function getRandomPosition(maxDistance,getRandom){return{x:getRandom()*maxDistance-maxDistance/2,y:getRandom()*maxDistance-maxDistance/2};};var ShipEvasionMovementPath_constructFirstCurve=function constructFirstCurve(nextPosition){return new three_module["CubicBezierCurve"](new three_module["Vector2"](0,0),new three_module["Vector2"](0,0),new three_module["Vector2"](nextPosition.x*-1,nextPosition.y*-1),new three_module["Vector2"](0,0));};var ShipEvasionMovementPath_constructEvasionCurve=function constructEvasionCurve(currentPosition,nextPosition){return new three_module["CubicBezierCurve"](new three_module["Vector2"](0,0),new three_module["Vector2"](currentPosition.x,currentPosition.y),new three_module["Vector2"](nextPosition.x*-1,nextPosition.y*-1),new three_module["Vector2"](0,0));};var constructEvasionCurves=function constructEvasionCurves(evasion,maxDistance,getRandom){var curves=[];if(evasion===0){return[];}var positions=new Array(evasion+1).fill(0).map(function(i){return ShipEvasionMovementPath_getRandomPosition(maxDistance,getRandom);});for(var i=0;i<positions.length;i++){var position=positions[i];var nextPosition=i===positions.length-1?{x:0,y:0}:positions[i+1];if(i===0){curves.push(ShipEvasionMovementPath_constructFirstCurve(nextPosition));}else{curves.push(ShipEvasionMovementPath_constructEvasionCurve(position,nextPosition));}}return curves;};var ShipEvasionMovementPath_ShipEvasionMovementPath=/*#__PURE__*/function(){function ShipEvasionMovementPath(seed,evasion){Object(classCallCheck["a" /* default */])(this,ShipEvasionMovementPath);this.evasion=evasion;this.curves=constructEvasionCurves(this.evasion,100/this.evasion,getSeededRandomGenerator(seed));}Object(createClass["a" /* default */])(ShipEvasionMovementPath,[{key:"getOffset",value:function getOffset(percent){if(this.evasion===0){return{x:0,y:0};}var point=(this.curves.length-1)*percent;var curveNumber=Math.floor(point);var decimal=point-Math.floor(point);var curve=this.curves[curveNumber];return curve.getPoint(decimal);}}]);return ShipEvasionMovementPath;}();/* harmony default export */ var ShipMovementAnimation_ShipEvasionMovementPath = (ShipEvasionMovementPath_ShipEvasionMovementPath);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipMovementAnimation/PivotSteps.js
var shouldEaseIn=function shouldEaseIn(startsAndEnds,startEndIndex,between,betweenIndex,move){if(!between[betweenIndex-1]){if(!startsAndEnds[startEndIndex-1]){return true;}else{var lastBetween=startsAndEnds[startEndIndex-1].between;var lastMove=lastBetween[lastBetween.length-1];if(!lastMove.isPivot()||lastMove.value!==move.value){return true;}else{return false;}}}else{var _lastMove=between[betweenIndex-1];if(!_lastMove.isPivot()||_lastMove.value!==move.value){return true;}else{return false;}}};var shouldEaseOut=function shouldEaseOut(startsAndEnds,startEndIndex,between,betweenIndex,move){if(!between[betweenIndex+1]){if(!startsAndEnds[startEndIndex+1]){return true;}else{var nextBetween=startsAndEnds[startEndIndex+1].between;var nextMove=nextBetween[0];if(!nextMove.isPivot()||nextMove.value!==move.value){return true;}else{return false;}}}else{var _nextMove=between[betweenIndex+1];if(!_nextMove.isPivot()||_nextMove.value!==move.value){return true;}else{return false;}}};var betweenMap=function betweenMap(startsAndEnds,startEndIndex,between,betweenIndex,move){if(!move.isPivot()){return null;}return{pivot:move.value===1?60:-60,easeIn:shouldEaseIn(startsAndEnds,startEndIndex,between,betweenIndex,move),easeOut:shouldEaseOut(startsAndEnds,startEndIndex,between,betweenIndex,move)};};var PivotSteps_startsAndEndsToSteps=function startsAndEndsToSteps(startsAndEnds){return startsAndEnds.map(function(_ref,startEndIndex){var start=_ref.start,end=_ref.end,between=_ref.between;return{startFacing:hexFacingToAngle(start.facing),endFacing:hexFacingToAngle(end.facing),steps:between.map(function(move,i){return betweenMap(startsAndEnds,startEndIndex,between,i,move);})};});};var PivotSteps_setStartFacings=function setStartFacings(path){return path.map(function(_ref2){var startFacing=_ref2.startFacing,endFacing=_ref2.endFacing,steps=_ref2.steps;return{startFacing:startFacing,endFacing:endFacing,steps:steps.map(function(step){if(step===null){return{facing:startFacing};}var newStep=Object(objectSpread2["a" /* default */])({},step,{startFacing:startFacing});startFacing=addToDirection(startFacing,step.pivot);return newStep;})};});};var PivotSteps_movesToSteps=function movesToSteps(moves){var startsAndEnds=[];var between=[];var start=null;moves.forEach(function(move){if(move.isDeploy()){start=move;}else if(move.isEnd()&&!start){start=move;}else if(move.isEnd()){startsAndEnds.push({start:start,between:Object(toConsumableArray["a" /* default */])(between),end:move});start=move;between=[];}else if(start&&move.isPivot()){between.push(move);}else if(start&&move.isSpeed()){between.push(move);}});return PivotSteps_setStartFacings(PivotSteps_startsAndEndsToSteps(startsAndEnds));};var PivotSteps_PivotPath=/*#__PURE__*/function(){function PivotPath(moves){Object(classCallCheck["a" /* default */])(this,PivotPath);this.moves=moves;this.path=PivotSteps_movesToSteps(moves);}Object(createClass["a" /* default */])(PivotPath,[{key:"getFacing",value:function getFacing(turn,percentDone){var steps=this.path[turn]||this.path[this.path.length-1];var length=steps.steps.length;if(length===0){return steps.endFacing;}else{var stepIndex=this.path[turn]?Math.floor(length*percentDone):length-1;var stepDone=this.path[turn]?length*percentDone%1:1;var step=steps.steps[stepIndex];if(step.facing!==undefined){return step.facing;}return addToDirection(step.startFacing,step.pivot*stepDone);}}}]);return PivotPath;}();/* harmony default export */ var PivotSteps = (PivotSteps_PivotPath);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipMovementAnimation/ShipMovementAnimation.js
var ShipMovementAnimation_ShipMovementAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ShipMovementAnimation,_Animation);function ShipMovementAnimation(shipIcon,moves,start,end){var _this;Object(classCallCheck["a" /* default */])(this,ShipMovementAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipMovementAnimation).call(this));_this.shipIcon=shipIcon;_this.moves=moves;_this.doneCallback=null;_this.start=start;_this.end=end;_this.duration=end-start;_this.positionCurves=_this.movesToCurves(moves);_this.pivotSteps=new PivotSteps(moves);_this.startRoll=moves[0].rolled?180:0;_this.endRoll=moves[0].rolled===moves[moves.length-1].rolled?_this.startRoll:_this.startRoll+180;_this.easeInOut=new three_module["CubicBezierCurve"](new three_module["Vector2"](0,0),new three_module["Vector2"](0.75,0),new three_module["Vector2"](0.25,1),new three_module["Vector2"](1,1));/*

    this.positionCurve = this.buildPositionCurve();
    this.rotations = this.buildRotations();
    this.evasionOffset = new ShipEvasionMovementPath(
      this.turn * this.ship.id,
      this.movementService.getEvasion(this.ship)
    );

    /*
    this.turnCurve = new THREE.CubicBezierCurve(
      new THREE.Vector2(0, 0),
      new THREE.Vector2(0.25, 0.25),
      new THREE.Vector2(0.75, 0.75),
      new THREE.Vector2(1, 1)
    );

    */animation_Animation.call(Object(assertThisInitialized["a" /* default */])(_this));return _this;}Object(createClass["a" /* default */])(ShipMovementAnimation,[{key:"doesMove",value:function doesMove(){return!new utils_Vector(this.positionCurves[0].getPoint(0)).equals(new utils_Vector(this.positionCurves[0].getPoint(1)));}},{key:"deactivate",value:function deactivate(){}},{key:"update",value:function update(gameData){}},{key:"cleanUp",value:function cleanUp(){}},{key:"getEndPosition",value:function getEndPosition(){return this.getPositionAndFacing(1,1);}},{key:"getPositionAt",value:function getPositionAt(time){var turnDone=this.getMovementTurnDone({total:time});var turn=Math.floor(turnDone);var percentDone=turnDone<1?turnDone%1:1;return this.getPositionAndFacing(turn,percentDone);}},{key:"getMovementTurnDone",value:function getMovementTurnDone(_ref){var total=_ref.total;if(total<this.start){return 0;}if(total>this.end){return 1;}var time=total-this.start;return time/this.duration;}},{key:"getCurrentRoll",value:function getCurrentRoll(turnDone){var between=-getAngleBetween(this.startRoll,this.endRoll);if(between===0){return this.endRoll;}return addToDirection(this.startRoll,between*this.easeInOut.getPoint(turnDone).y);}},{key:"render",value:function render(payload){if(this.shipIcon.ship.isDestroyed()&&!this.shipIcon.ship.isDestroyedThisTurn()){this.shipIcon.hide();return;}var turnDone=this.getMovementTurnDone(payload);var turn=Math.floor(turnDone);var percentDone=turnDone<1?turnDone%1:1;var _this$getPositionAndF=this.getPositionAndFacing(turn,percentDone),position=_this$getPositionAndF.position,facing=_this$getPositionAndF.facing;var roll=this.getCurrentRoll(turnDone);this.shipIcon.setPosition(position);this.shipIcon.setFacing(-facing);this.shipIcon.setRoll(roll);}},{key:"getPositionAndFacing",value:function getPositionAndFacing(turn,percentDone){var position=this.positionCurves[turn]?this.positionCurves[turn].getPoint(percentDone):this.positionCurves[this.positionCurves.length-1].getPoint(1);var facing=this.pivotSteps.getFacing(turn,percentDone);return{position:position,facing:facing};}},{key:"movesToCurves",value:function movesToCurves(moves){var _this2=this;var startsAndEnds=[];var start=null;moves.forEach(function(move){if(move.isDeploy()){start=move;}else if(move.isEnd()&&!start){start=move;}else if(move.isEnd()){startsAndEnds.push({start:start,end:move});start=move;}});var curves=startsAndEnds.map(function(_ref2){var start=_ref2.start,end=_ref2.end;return _this2.buildPositionCurve(start,end);});return curves;}},{key:"buildPositionCurve",value:function buildPositionCurve(start,end){var startPosition=start.position;var point1=startPosition.roundToHexCenter();var control1=startPosition.roundToHexCenter();var control2=end.position.roundToHexCenter();var point2=end.position.roundToHexCenter();/*
    const point1 = start.position.roundToHexCenter();
    const control1 = start.position.add(start.velocity.multiplyScalar(0.5));
    const control2 = end.position.sub(end.velocity.multiplyScalar(0.5));
    const point2 = end.position.roundToHexCenter();
    */ /*
    return new THREE.QuadraticBezierCurve3(
      new THREE.Vector3(point1.x, point1.y, point1.z),
      new THREE.Vector3(control1.x, control1.y, control1.z),
      new THREE.Vector3(point2.x, point2.y, point2.z)
    );
    */return new three_module["CubicBezierCurve3"](new three_module["Vector3"](point1.x,point1.y,point1.z),new three_module["Vector3"](control1.x,control1.y,control1.z),new three_module["Vector3"](control2.x,control2.y,control2.z),new three_module["Vector3"](point2.x,point2.y,point2.z));}}]);return ShipMovementAnimation;}(animation_Animation);/* harmony default export */ var animation_ShipMovementAnimation_ShipMovementAnimation = (ShipMovementAnimation_ShipMovementAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipMovementAnimation/index.js
/* harmony default export */ var animation_ShipMovementAnimation = (animation_ShipMovementAnimation_ShipMovementAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipIdleMovementAnimation.js
var ShipIdleMovementAnimation_ShipIdleMovementAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ShipIdleMovementAnimation,_Animation);function ShipIdleMovementAnimation(shipIcon,gameTerrain){var _this;Object(classCallCheck["a" /* default */])(this,ShipIdleMovementAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipIdleMovementAnimation).call(this));_this.gameTerrain=gameTerrain;_this.shipIcon=shipIcon;_this.ship=shipIcon.ship;_this.duration=0;_this.movementService=new movement_MovementService();_this.position=_this.getPosition();_this.facing=_this.getFacing();_this.roll=_this.getRoll();return _this;}Object(createClass["a" /* default */])(ShipIdleMovementAnimation,[{key:"update",value:function update(){this.position=this.getPosition();this.facing=this.getFacing();this.roll=this.getRoll();}},{key:"deactivate",value:function deactivate(){}},{key:"render",value:function render(now,total,last,delta,zoom,back,paused){this.shipIcon.setPosition(this.position);this.shipIcon.setFacing(-this.facing);this.shipIcon.setFacing(-this.facing);this.shipIcon.setRoll(this.roll);}},{key:"getRoll",value:function getRoll(){var roll=this.shipIcon.ship.movement.isRolled()?180:0;if(this.shipIcon.ship.movement.isRolling()){return roll+90;}return roll;}},{key:"getPosition",value:function getPosition(){var end=this.ship.movement.getLastEndMoveOrSurrogate();return end.position;}},{key:"getFacing",value:function getFacing(){return hexFacingToAngle(this.ship.movement.getLastEndMoveOrSurrogate().facing);}}]);return ShipIdleMovementAnimation;}(animation_Animation);/* harmony default export */ var animation_ShipIdleMovementAnimation = (ShipIdleMovementAnimation_ShipIdleMovementAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipSystemAnimation.js
var ShipSystemAnimation_ShipSystemAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ShipSystemAnimation,_Animation);function ShipSystemAnimation(icon,ship){var _this;Object(classCallCheck["a" /* default */])(this,ShipSystemAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipSystemAnimation).call(this));_this.icon=icon;_this.ship=ship||icon.ship;_this.updateAll();return _this;}Object(createClass["a" /* default */])(ShipSystemAnimation,[{key:"updateAll",value:function updateAll(){var _this2=this;this.ship.systems.getSystems().forEach(function(system){return _this2.updateSystem(system);});}},{key:"updateSystem",value:function updateSystem(system){if(system.power.isGoingOffline()){this.icon.disableSystemAnimation(system,"online");this.icon.playSystemAnimation(system,"offline");}else if(system.power.isGoingOnline()){this.icon.disableSystemAnimation(system,"offline");this.icon.playSystemAnimation(system,"online");}else if(system.isDisabled()){this.icon.disableSystemAnimation(system,"online");this.icon.setSystemAnimation(system,"offline",100);}else if(system.power.isOffline()){this.icon.disableSystemAnimation(system,"online");this.icon.setSystemAnimation(system,"offline",100);}else if(system.power.isOnline()){this.icon.disableSystemAnimation(system,"offline");this.icon.setSystemAnimation(system,"online",100);}return this;}}]);return ShipSystemAnimation;}(animation_Animation);/* harmony default export */ var animation_ShipSystemAnimation = (ShipSystemAnimation_ShipSystemAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipWeaponAnimation/ShipWeaponAnimation.js
var ShipWeaponAnimation_ShipWeaponAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ShipWeaponAnimation,_Animation);function ShipWeaponAnimation(props){var _this;Object(classCallCheck["a" /* default */])(this,ShipWeaponAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipWeaponAnimation).call(this,props.getRandom));_this.particleEmitterContainer=props.particleEmitterContainer;_this.props=props;return _this;}Object(createClass["a" /* default */])(ShipWeaponAnimation,[{key:"transformLocation",value:function transformLocation(location,icon,facing,roll){var object=new three_module["Object3D"]();object.quaternion.setFromAxisAngle(new three_module["Vector3"](0,0,1),degreeToRadian(-hexFacingToAngle(facing)));var tmpQuaternion=new three_module["Quaternion"]();tmpQuaternion.setFromAxisAngle(new three_module["Vector3"](1,0,0).normalize(),degreeToRadian(roll)).normalize();object.quaternion.multiply(tmpQuaternion);var result=location.clone();result.applyQuaternion(object.quaternion);result.z+=icon.shipZ;return result;}},{key:"getLocationForSystemOrRandomLocationOnSection",value:function getLocationForSystemOrRandomLocationOnSection(system,icon,facing){var roll=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;if(roll!==0){throw new Error("Roll is not yet implemented");}var location=this.getLocationForSystem(system,icon,facing,roll=0);if(!location.equals(new utils_Vector())){return location;}location=icon.shipObjectBoundingBox.getRandomPositionForSystem(system,this.getRandom);return this.transformLocation(location.toThree(),icon,facing,roll);}},{key:"getRandomLocationOnShip",value:function getRandomLocationOnShip(icon,facing){var roll=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var location=icon.shipObjectBoundingBox.getRandomPositionOnShip(this.getRandom);if(roll!==0){throw new Error("Roll is not yet implemented");}if(!location){return new utils_Vector();}return this.transformLocation(location.toThree(),icon,facing,roll);}},{key:"getLocationForSystem",value:function getLocationForSystem(system,icon,facing){var roll=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var location=icon.systemLocations[system.id];if(roll!==0){throw new Error("Roll is not yet implemented");}if(!location){return new utils_Vector();}return this.transformLocation(location,icon,facing,roll);}}]);return ShipWeaponAnimation;}(animation_Animation);/* harmony default export */ var animation_ShipWeaponAnimation_ShipWeaponAnimation = (ShipWeaponAnimation_ShipWeaponAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipWeaponAnimation/ShipWeaponBoltAnimation.js
var ShipWeaponBoltAnimation_ShipWeaponBoltAnimation=/*#__PURE__*/function(_ShipWeaponAnimation){Object(inherits["a" /* default */])(ShipWeaponBoltAnimation,_ShipWeaponAnimation);function ShipWeaponBoltAnimation(time,combatLogEntry,fireOrder,weapon,shooterIcon,targetIcon,getPosition,getRandom,particleEmitterContainer,args,weaponAnimationService){var _this;Object(classCallCheck["a" /* default */])(this,ShipWeaponBoltAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipWeaponBoltAnimation).call(this,getRandom));var hit=Boolean(combatLogEntry.shotsHit);_this.particleEmitterContainer=particleEmitterContainer;_this.extraWait=getRandom()*2000;var startTime=time+_this.extraWait;var speed=args.speed||1;var startPosition=getPosition(shooterIcon,startTime).position.add(_this.getLocationForSystem(weapon,shooterIcon,getPosition(shooterIcon,startTime).facing));startPosition.z+=shooterIcon.shipZ;var endPosition=getPosition(targetIcon,startTime).position.add(_this.getRandomPosition(20));endPosition.z+=targetIcon.shipZ;var distance=startPosition.distanceTo(endPosition);_this.duration=distance/speed;var fade=0;if(!hit){var extra=getRandom()*300+300;_this.duration+=extra;fade=extra*0.8;}_this.animations=[];_this.animations.push(weaponAnimationService.getBoltEffect(startTime,startPosition,endPosition.clone(),speed,fade,_this.duration,args,Object(assertThisInitialized["a" /* default */])(_this)));_this.explosion=null;if(!combatLogEntry.causedDamage()){return Object(possibleConstructorReturn["a" /* default */])(_this);}if(hit){weaponAnimationService.getDamageExplosion(args.explosionSize,endPosition,startTime+_this.duration,Object(assertThisInitialized["a" /* default */])(_this));_this.duration+=1000;}return _this;}Object(createClass["a" /* default */])(ShipWeaponBoltAnimation,[{key:"getDuration",value:function getDuration(){return this.duration+this.extraWait;}},{key:"deactivate",value:function deactivate(){this.particleEmitterContainer.release(this);}}]);return ShipWeaponBoltAnimation;}(animation_ShipWeaponAnimation_ShipWeaponAnimation);/* harmony default export */ var ShipWeaponAnimation_ShipWeaponBoltAnimation = (ShipWeaponBoltAnimation_ShipWeaponBoltAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipWeaponAnimation/ShipWeaponBoltBurstAnimation.js
var ShipWeaponBoltBurstAnimation_ShipWeaponBoltBurstAnimation=/*#__PURE__*/function(_ShipWeaponAnimation){Object(inherits["a" /* default */])(ShipWeaponBoltBurstAnimation,_ShipWeaponAnimation);function ShipWeaponBoltBurstAnimation(time,combatLogEntry,fireOrder,weapon,shooterIcon,targetIcon,getPosition,getRandom,particleEmitterContainer,args,weaponAnimationService){var _this;Object(classCallCheck["a" /* default */])(this,ShipWeaponBoltBurstAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipWeaponBoltBurstAnimation).call(this,getRandom));_this.animations=[];_this.particleEmitterContainer=particleEmitterContainer;var missesFirst=_this.getRandom()>0.5;var speed=args.speed||1;_this.extraWait=getRandom()*2000;var startTime=time+_this.extraWait;var startPosition=getPosition(shooterIcon,startTime).position.add(_this.getLocationForSystem(weapon,shooterIcon,getPosition(shooterIcon,startTime).facing));startPosition.z+=shooterIcon.shipZ;var endPosition=getPosition(targetIcon,startTime).position.add(_this.getRandomPosition(20));endPosition.z+=targetIcon.shipZ;var distance=startPosition.distanceTo(endPosition);_this.duration=distance/speed;var offsetVector=_this.getRandomPosition(5);var missExtra=getRandom()*300+300;var missFade=missExtra*0.8;var totalShots=combatLogEntry.totalShots;var shotsHit=combatLogEntry.shotsHit;_this.startExtra=0;for(var shotNumber=1;shotNumber<=totalShots;shotNumber++){_this.startExtra=30/speed*shotNumber;if(missesFirst&&shotNumber<=totalShots-shotsHit||!missesFirst&&shotNumber>shotsHit){_this.animations.push(weaponAnimationService.getBoltEffect(_this.startExtra+startTime,startPosition,endPosition.clone(),speed,missFade,_this.duration+missExtra,args,Object(assertThisInitialized["a" /* default */])(_this)));}else{_this.animations.push(weaponAnimationService.getBoltEffect(_this.startExtra+startTime,startPosition,endPosition.clone(),speed,0,_this.duration,args,Object(assertThisInitialized["a" /* default */])(_this)));weaponAnimationService.getDamageExplosion(args.explosionSize,endPosition,_this.startExtra+startTime+_this.duration,Object(assertThisInitialized["a" /* default */])(_this));}endPosition=endPosition.add(offsetVector);}return _this;}Object(createClass["a" /* default */])(ShipWeaponBoltBurstAnimation,[{key:"getDuration",value:function getDuration(){return this.duration+this.extraWait+this.startExtra+1000;}},{key:"deactivate",value:function deactivate(){this.particleEmitterContainer.release(this);}}]);return ShipWeaponBoltBurstAnimation;}(animation_ShipWeaponAnimation_ShipWeaponAnimation);/* harmony default export */ var ShipWeaponAnimation_ShipWeaponBoltBurstAnimation = (ShipWeaponBoltBurstAnimation_ShipWeaponBoltBurstAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipWeaponAnimation/ShipWeaponUniversalBoltAnimation.js
var ShipWeaponUniversalBoltAnimation_ShipWeaponUniversalBoltAnimation=/*#__PURE__*/function(_ShipWeaponAnimation){Object(inherits["a" /* default */])(ShipWeaponUniversalBoltAnimation,_ShipWeaponAnimation);function ShipWeaponUniversalBoltAnimation(props){var _this;Object(classCallCheck["a" /* default */])(this,ShipWeaponUniversalBoltAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipWeaponUniversalBoltAnimation).call(this,props));var args=props.args,weaponAnimationService=props.weaponAnimationService,omitHitExplosion=props.omitHitExplosion;_this.animations=[];_this.speed=args.speed||1;_this.duration=0;_this.setShots();_this.setStartPosition();_this.setEndPosition();_this.setStartTime();var missExtra=_this.getRandom()*300+300;var missFade=missExtra*0.8;_this.shots.forEach(function(shot){var duration=_this.startPosition.distanceTo(_this.endPosition.add(shot.offset))/_this.speed;_this.animations.push(weaponAnimationService.getBoltEffect(_this.startTime+shot.startExtra,_this.startPosition.clone(),_this.endPosition.clone(),_this.speed,shot.hit?0:missFade,shot.hit?duration:duration+missExtra,props.args,Object(assertThisInitialized["a" /* default */])(_this)));if(shot.hit&&!omitHitExplosion){_this.animations.push(weaponAnimationService.getDamageExplosion(props.args.explosionSize,props.args.explosionType,_this.endPosition.add(shot.offset),_this.startTime+shot.startExtra+duration,Object(assertThisInitialized["a" /* default */])(_this)));}});return _this;}Object(createClass["a" /* default */])(ShipWeaponUniversalBoltAnimation,[{key:"setShots",value:function setShots(){var _this$props=this.props,totalShots=_this$props.totalShots,shotsHit=_this$props.shotsHit,args=_this$props.args;var startExtra=0;this.shots=[];var hitsStart=Math.floor(this.getRandom()*(totalShots-shotsHit));var offsetVector=this.getRandomPosition(args.size);var length=args.length||10;for(var currentShot=0;currentShot<totalShots;currentShot++){var hit=currentShot>=hitsStart&&currentShot<hitsStart+shotsHit;startExtra=5*length/this.speed*currentShot;var n=currentShot-hitsStart;var offset=new utils_Vector();if(n<0){offset=offset.sub(offsetVector.multiplyScalar(Math.abs(n)));}else if(n>0){offset=offset.add(offsetVector.multiplyScalar(Math.abs(n)));}this.shots.push({startExtra:startExtra,hit:hit,offset:offset});}}},{key:"getFirstHit",value:function getFirstHit(){return this.shots.find(function(shot){return shot.hit;});}},{key:"setEndPosition",value:function setEndPosition(){var _this$props2=this.props,targetIcon=_this$props2.targetIcon,impactPosition=_this$props2.impactPosition,getPosition=_this$props2.getPosition,shotsHit=_this$props2.shotsHit,fireEntry=_this$props2.fireEntry;if(impactPosition){if(shotsHit===0){this.endPosition=impactPosition.add(this.getRandomPosition(20));}else{this.endPosition=impactPosition;}}else{var _getPosition=getPosition(targetIcon.ship),position=_getPosition.position,facing=_getPosition.facing;if(shotsHit===0){this.endPosition=this.getRandomLocationOnShip(targetIcon,facing).add(position).add(this.getRandomPosition(50));}else{var damage=fireEntry.damages.length>0?fireEntry.damages[Math.floor(this.getRandom()*fireEntry.damages.length)]:null;var damageEntry=damage&&damage.entries.length>0?damage.entries[Math.floor(this.getRandom()*damage.entries.length)]:null;if(damageEntry){var system=targetIcon.ship.systems.getSystemById(damageEntry.systemId);this.endPosition=this.getLocationForSystemOrRandomLocationOnSection(system,targetIcon,facing).add(position);}else{this.endPosition=getPosition(targetIcon.ship).position.add(this.getRandomPosition(20));this.endPosition.z+=targetIcon.shipZ;}}}}},{key:"setStartTime",value:function setStartTime(){var _this$props3=this.props,animationStartTime=_this$props3.animationStartTime,impactTime=_this$props3.impactTime;if(impactTime){this.startWait=0;var firstHit=this.getFirstHit();var startExtra=firstHit?firstHit.startExtra:0;var distance=this.startPosition.distanceTo(this.endPosition);this.duration=distance/this.speed;this.startTime=impactTime-(startExtra+this.duration);}else{this.startWait=this.getRandom()*2000;this.startTime=animationStartTime+this.startWait;var _distance=this.startPosition.distanceTo(this.endPosition);this.duration=_distance/this.speed;}}},{key:"setStartPosition",value:function setStartPosition(){var _this$props4=this.props,shooterIcon=_this$props4.shooterIcon,weapon=_this$props4.weapon,getPosition=_this$props4.getPosition;this.startPosition=getPosition(shooterIcon.ship).position.add(this.getLocationForSystem(weapon,shooterIcon,getPosition(shooterIcon.ship).facing));}},{key:"getDuration",value:function getDuration(){return this.duration+this.startWait+1000;}},{key:"deactivate",value:function deactivate(){this.particleEmitterContainer.release(this);}}]);return ShipWeaponUniversalBoltAnimation;}(animation_ShipWeaponAnimation_ShipWeaponAnimation);/* harmony default export */ var ShipWeaponAnimation_ShipWeaponUniversalBoltAnimation = (ShipWeaponUniversalBoltAnimation_ShipWeaponUniversalBoltAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipWeaponAnimation/index.js
/* harmony default export */ var animation_ShipWeaponAnimation = ({ShipWeaponAnimation:animation_ShipWeaponAnimation_ShipWeaponAnimation,ShipWeaponBoltAnimation:ShipWeaponAnimation_ShipWeaponBoltAnimation,ShipWeaponBoltBurstAnimation:ShipWeaponAnimation_ShipWeaponBoltBurstAnimation,ShipWeaponUniversalBoltAnimation:ShipWeaponAnimation_ShipWeaponUniversalBoltAnimation});
// CONCATENATED MODULE: ./src/client/view/game/animation/index.js

// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/AnimationUiStrategy.js
var AnimationUiStrategy_AnimationUiStrategy=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(AnimationUiStrategy,_UiStrategy);function AnimationUiStrategy(){var _this;Object(classCallCheck["a" /* default */])(this,AnimationUiStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AnimationUiStrategy).call(this));_this.animations=[];return _this;}Object(createClass["a" /* default */])(AnimationUiStrategy,[{key:"deactivate",value:function deactivate(){this.removeAllAnimations();Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(AnimationUiStrategy.prototype),"deactivate",this).call(this);}},{key:"render",value:function render(payload){this.animations.forEach(function(animation){return animation.render(payload);});}},{key:"removeAllAnimations",value:function removeAllAnimations(){this.animations.forEach(function(animation){return animation.deactivate();});this.animations=[];}},{key:"removeAnimation",value:function removeAnimation(toRemove){this.animations=this.animations.filter(function(animation){return animation!==animation;});toRemove.deactivate();}}]);return AnimationUiStrategy;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_AnimationUiStrategy = (AnimationUiStrategy_AnimationUiStrategy);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipDamageAnimation.js
var ShipDamageAnimation_ShipDamageAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ShipDamageAnimation,_Animation);function ShipDamageAnimation(icon,sections){var _this;var start=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var end=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;Object(classCallCheck["a" /* default */])(this,ShipDamageAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipDamageAnimation).call(this));_this.icon=icon;_this.sections=sections;_this.start=start;_this.end=end;_this.active=false;return _this;}Object(createClass["a" /* default */])(ShipDamageAnimation,[{key:"render",value:function render(_ref){var total=_ref.total;if(this.end&&total>=this.end&&!this.active){return;}if(this.end&&total>=this.end&&this.active){this.deactivate();return;}if(this.active&&total<this.start){this.deactivate();return;}if(!this.active&&total>=this.start){this.activate();}}},{key:"activate",value:function(){var _activate=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.active=true;_context.next=3;return this.icon.isShipObjectLoaded;case 3:if(this.sections){this.icon.shipObjectSectionDamageEffect.createDamageForSections(this.sections);}else{this.icon.shipObjectSectionDamageEffect.createDamage();}case 4:case"end":return _context.stop();}}},_callee,this);}));function activate(){return _activate.apply(this,arguments);}return activate;}()},{key:"deactivate",value:function(){var _deactivate=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(){return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.active=false;_context2.next=3;return this.icon.isShipObjectLoaded;case 3:this.icon.shipObjectSectionDamageEffect.removeDamage();case 4:case"end":return _context2.stop();}}},_callee2,this);}));function deactivate(){return _deactivate.apply(this,arguments);}return deactivate;}()}]);return ShipDamageAnimation;}(animation_Animation);/* harmony default export */ var animation_ShipDamageAnimation = (ShipDamageAnimation_ShipDamageAnimation);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowShipObjects.js
var ShowShipObjects_ShowShipObjects=/*#__PURE__*/function(_AnimationUiStrategy){Object(inherits["a" /* default */])(ShowShipObjects,_AnimationUiStrategy);function ShowShipObjects(){Object(classCallCheck["a" /* default */])(this,ShowShipObjects);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowShipObjects).call(this));}Object(createClass["a" /* default */])(ShowShipObjects,[{key:"update",value:function(){var _update=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(gamedata){var _this=this;var shipIconContainer;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowShipObjects.prototype),"update",this).call(this,gamedata);shipIconContainer=this.services.shipIconContainer;_context.next=4;return shipIconContainer.shipsLoaded();case 4:shipIconContainer.getArray().forEach(function(icon){var ship=icon.ship;if(ship.isDestroyed()){icon.hide();}else{icon.show();_this.animations.push(new animation_ShipIdleMovementAnimation(icon,gamedata.terrain));_this.animations.push(new animation_ShipSystemAnimation(icon));_this.animations.push(new animation_ShipDamageAnimation(icon));}return _this;});case 5:case"end":return _context.stop();}}},_callee,this);}));function update(_x){return _update.apply(this,arguments);}return update;}()},{key:"shipStateChanged",value:function shipStateChanged(ship){this.animations.filter(function(animation){return animation.ship===ship;}).forEach(function(animation){animation.update();});}},{key:"shipSystemStateChanged",value:function shipSystemStateChanged(_ref){var ship=_ref.ship,system=_ref.system;this.animations.filter(function(animation){return animation.ship===ship;}).forEach(function(animation){if(animation.updateSystem){animation.updateSystem(system);}});}},{key:"deactivate",value:function deactivate(){var shipIconContainer=this.services.shipIconContainer;shipIconContainer.getArray().forEach(function(icon){icon.hide();},this);return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowShipObjects.prototype),"deactivate",this).call(this);}}]);return ShowShipObjects;}(uiStrategy_AnimationUiStrategy);/* harmony default export */ var uiStrategy_ShowShipObjects = (ShowShipObjects_ShowShipObjects);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/RightClickShowsShipWindow.js
var RightClickShowsShipWindow_RightClickShowsShipWindow=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(RightClickShowsShipWindow,_UiStrategy);function RightClickShowsShipWindow(){Object(classCallCheck["a" /* default */])(this,RightClickShowsShipWindow);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RightClickShowsShipWindow).apply(this,arguments));}Object(createClass["a" /* default */])(RightClickShowsShipWindow,[{key:"shipRightClicked",value:function shipRightClicked(payload){var uiState=this.services.uiState;//TODO: open tooltip in ship window mode?
}}]);return RightClickShowsShipWindow;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_RightClickShowsShipWindow = (RightClickShowsShipWindow_RightClickShowsShipWindow);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/MouseOverShowsShipTooltip.js
var MouseOverShowsShipTooltip_MouseOverShowsShipTooltip=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(MouseOverShowsShipTooltip,_UiStrategy);function MouseOverShowsShipTooltip(){var _this;Object(classCallCheck["a" /* default */])(this,MouseOverShowsShipTooltip);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(MouseOverShowsShipTooltip).call(this));_this.clickedShip=null;_this.clickedEnemy=null;_this.mouseOveredShip=null;return _this;}Object(createClass["a" /* default */])(MouseOverShowsShipTooltip,[{key:"shipTooltipClosed",value:function shipTooltipClosed(ship){if(this.clickedShip===ship){this.clickedShip=null;}if(this.clickedEnemy===ship){this.clickedEnemy=null;}}},{key:"shipStateChanged",value:function shipStateChanged(ship){var _this$services=this.services,uiState=_this$services.uiState,shipIconContainer=_this$services.shipIconContainer,currentUser=_this$services.currentUser;var isMine=ship.player.is(currentUser);if(this.clickedShip===ship){uiState.showShipTooltip(ship,true,isMine);}if(this.clickedEnemy===ship){uiState.showShipTooltip(ship,true,isMine);}}},{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;if(this.clickedShip){uiState.hideShipTooltip(this.clickedShip);}if(this.clickedEnemy){uiState.hideShipTooltip(this.clickedEnemy);}}},{key:"shipClicked",value:function shipClicked(payload){var _this$services2=this.services,uiState=_this$services2.uiState,currentUser=_this$services2.currentUser;var ship=payload.entity.ship;var isMine=ship.player.is(currentUser);if(isMine&&this.clickedShip){uiState.hideShipTooltip(this.clickedShip);}if(!isMine&&this.clickedEnemy){uiState.hideShipTooltip(this.clickedEnemy);}uiState.showShipTooltip(payload.entity.ship,true,isMine);if(isMine){this.clickedShip=ship;}else{this.clickedEnemy=ship;}if(this.mouseOveredShip===this.clickedShip||this.mouseOveredShip===this.clickedEnemy){this.mouseOveredShip=null;}}/*
  hexClicked() {
    const { uiState } = this.services;

    if (uiState.state.systemMenu.activeSystem) {
      return;
    }

    if (this.clickedShip) {
      uiState.hideShipTooltip(this.clickedShip);
      this.clickedShip = null;
    }

    if (this.clickedEnemy) {
      uiState.hideShipTooltip(this.clickedEnemy);
      this.clickedEnemy = null;
    }
  }
  */},{key:"mouseOverShip",value:function mouseOverShip(payload){var _this$services3=this.services,uiState=_this$services3.uiState,currentUser=_this$services3.currentUser;var ship=payload.entity.ship;var isMine=ship.player.is(currentUser);if(isMine&&this.clickedShip===ship){return;}if(!isMine&&this.clickedEnemy===ship){return;}if(this.mouseOveredShip){uiState.hideShipTooltip(this.mouseOveredShip);}if(isMine&&this.clickedShip){uiState.hideShipTooltip(this.clickedShip);}if(!isMine&&this.clickedEnemy){uiState.hideShipTooltip(this.clickedEnemy);}uiState.showShipTooltip(payload.entity.ship,false,isMine);this.mouseOveredShip=payload.entity.ship;}},{key:"mouseOutShip",value:function mouseOutShip(payload){var _this$services4=this.services,shipIconContainer=_this$services4.shipIconContainer,currentUser=_this$services4.currentUser;var ship=payload.entity.ship;var isMine=ship.player.is(currentUser);if(isMine&&this.clickedShip===payload.entity.ship){return;}if(!isMine&&this.clickedEnemy===payload.entity.ship){return;}var uiState=this.services.uiState;uiState.hideShipTooltip(payload.entity.ship);this.mouseOveredShip=null;if(isMine&&this.clickedShip){uiState.showShipTooltip(this.clickedShip,true,isMine);}if(!isMine&&this.clickedEnemy){uiState.showShipTooltip(this.clickedEnemy,true,isMine);}}}]);return MouseOverShowsShipTooltip;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_MouseOverShowsShipTooltip = (MouseOverShowsShipTooltip_MouseOverShowsShipTooltip);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/MouseOverHighlightsShip.js
var MouseOverHighlightsShip_MouseOverHighlightsShip=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(MouseOverHighlightsShip,_UiStrategy);function MouseOverHighlightsShip(){Object(classCallCheck["a" /* default */])(this,MouseOverHighlightsShip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(MouseOverHighlightsShip).apply(this,arguments));}Object(createClass["a" /* default */])(MouseOverHighlightsShip,[{key:"deactivate",value:function deactivate(payload){this.hide();}},{key:"show",value:function show(payload){var currentUser=this.services.currentUser;if(payload.entity.ship.player.isUsers(currentUser)){payload.entity.replaceEmissive(COLOR_FRIENDLY);}else{payload.entity.replaceEmissive(COLOR_ENEMY);}}},{key:"hide",value:function hide(){var shipIconContainer=this.services.shipIconContainer;shipIconContainer.getArray().forEach(function(icon){icon.revertEmissive();});}},{key:"mouseOverShip",value:function mouseOverShip(payload){this.show(payload);}},{key:"mouseOutShip",value:function mouseOutShip(payload){this.hide();}},{key:"mouseOut",value:function mouseOut(){this.hide();}}]);return MouseOverHighlightsShip;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_MouseOverHighlightsShip = (MouseOverHighlightsShip_MouseOverHighlightsShip);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/deployment/SelectUndeployedShip.js
var SelectUndeployedShip_SelectUndeployedShip=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectUndeployedShip,_UiStrategy);function SelectUndeployedShip(){Object(classCallCheck["a" /* default */])(this,SelectUndeployedShip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectUndeployedShip).apply(this,arguments));}Object(createClass["a" /* default */])(SelectUndeployedShip,[{key:"update",value:function update(gameData){var _this$services=this.services,uiState=_this$services.uiState,currentUser=_this$services.currentUser;if(uiState.getSelectedShip()){return;}var ships=gameData.getShipsForUser(currentUser);var ship=ships.find(function(s){return s.movement.getDeployMove();});if(!ship){ship=ships[0];}if(!ship){return;}uiState.selectShip(ship);}}]);return SelectUndeployedShip;}(uiStrategy_UiStrategy);/* harmony default export */ var deployment_SelectUndeployedShip = (SelectUndeployedShip_SelectUndeployedShip);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/deployment/DeployShipOnHexClick.js
var DeployShipOnHexClick_DeployShipOnHexClick=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(DeployShipOnHexClick,_UiStrategy);function DeployShipOnHexClick(){Object(classCallCheck["a" /* default */])(this,DeployShipOnHexClick);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(DeployShipOnHexClick).apply(this,arguments));}Object(createClass["a" /* default */])(DeployShipOnHexClick,[{key:"hexClicked",value:function hexClicked(_ref){var hex=_ref.hex;var _this$services=this.services,uiState=_this$services.uiState,movementService=_this$services.movementService;var ship=uiState.getSelectedShip();if(!ship||!this.gameData){return;}var slot=this.gameData.slots.getSlotByShip(ship);if(!slot.isValidShipDeployment(ship,hex)){return;}if(this.gameData.ships.getShips().find(function(otherShip){return otherShip!==ship&&otherShip.getHexPosition().equals(hex);})){return;}movementService.deploy(ship,hex);uiState.shipStateChanged(ship);}}]);return DeployShipOnHexClick;}(uiStrategy_UiStrategy);/* harmony default export */ var deployment_DeployShipOnHexClick = (DeployShipOnHexClick_DeployShipOnHexClick);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/deployment/AllowSubmittingWhenDeploymentDone.js
var AllowSubmittingWhenDeploymentDone_AllowSubmittingWhenDeploymentDone=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(AllowSubmittingWhenDeploymentDone,_UiStrategy);function AllowSubmittingWhenDeploymentDone(){Object(classCallCheck["a" /* default */])(this,AllowSubmittingWhenDeploymentDone);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AllowSubmittingWhenDeploymentDone).apply(this,arguments));}Object(createClass["a" /* default */])(AllowSubmittingWhenDeploymentDone,[{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.setTurnReady(false);}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(AllowSubmittingWhenDeploymentDone.prototype),"update",this).call(this,gameData);this.checkDeployment();}},{key:"shipStateChanged",value:function shipStateChanged(){this.checkDeployment();}},{key:"checkDeployment",value:function checkDeployment(){var _this=this;var _this$services=this.services,currentUser=_this$services.currentUser,uiState=_this$services.uiState;var result=this.gameData.ships.getShips().every(function(ship){if(!ship.player.isUsers(currentUser)){return true;}var slot=_this.gameData.slots.getSlotByShip(ship);if(slot.isValidShipDeployment(ship,ship.getHexPosition())){return true;}return false;});uiState.setTurnReady(result);}}]);return AllowSubmittingWhenDeploymentDone;}(uiStrategy_UiStrategy);/* harmony default export */ var deployment_AllowSubmittingWhenDeploymentDone = (AllowSubmittingWhenDeploymentDone_AllowSubmittingWhenDeploymentDone);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/DebugDrawLineFromSelectedShip.js
var DebugDrawLineFromSelectedShip_DebugDrawLineFromSelectedShip=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(DebugDrawLineFromSelectedShip,_UiStrategy);function DebugDrawLineFromSelectedShip(){var _this;Object(classCallCheck["a" /* default */])(this,DebugDrawLineFromSelectedShip);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(DebugDrawLineFromSelectedShip).call(this));_this.sprites=[];return _this;}Object(createClass["a" /* default */])(DebugDrawLineFromSelectedShip,[{key:"mouseOverHex",value:function mouseOverHex(hex){var _this$services=this.services,uiState=_this$services.uiState,coordinateConverter=_this$services.coordinateConverter,scene=_this$services.scene;var ship=uiState.getSelectedShip();if(!ship){return;}var positions=hex.drawLine(ship.getHexPosition(),5);this.sprites=positions.map(function(position){var sprite=new sprite_HexagonSprite(coordinateConverter.fromHexToGame(position));scene.add(sprite.mesh);return sprite;});}},{key:"mouseOutHex",value:function mouseOutHex(hex){var scene=this.services.scene;this.sprites.forEach(function(sprite){scene.remove(sprite.mesh);sprite.destroy();});this.sprites=[];}}]);return DebugDrawLineFromSelectedShip;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_DebugDrawLineFromSelectedShip = (DebugDrawLineFromSelectedShip_DebugDrawLineFromSelectedShip);
// CONCATENATED MODULE: ./src/client/view/game/movement/NavigationalMovementPath.js
var NavigationalMovementPath_NavigationalMovementPath=/*#__PURE__*/function(){function NavigationalMovementPath(terrain,position,velocity,turns,coordinateConverter,scene){Object(classCallCheck["a" /* default */])(this,NavigationalMovementPath);this.terrain=terrain;this.position=position;this.velocity=velocity;this.turns=turns;this.coordinateConverter=coordinateConverter;this.scene=scene;this.objects=[];this.create();}Object(createClass["a" /* default */])(NavigationalMovementPath,[{key:"remove",value:function remove(){var _this=this;this.objects.forEach(function(object3d){_this.scene.remove(object3d.mesh);object3d.destroy();});}},{key:"create",value:function create(){var turns=1000;var start=performance.now();var position=this.position;var velocity=this.velocity;while(turns--){var _this$terrain$getGrav=this.terrain.getGravityVectorForTurn(position,velocity,1),newPosition=_this$terrain$getGrav.position,newVelocity=_this$terrain$getGrav.velocity,positions=_this$terrain$getGrav.positions,collision=_this$terrain$getGrav.collision;velocity=newVelocity;position=newPosition;//this.createLine(positions);
if(collision){break;}}console.log("building path took",performance.now()-start,"ms");}},{key:"createLine",value:function createLine(positions){var _this2=this;//positions.forEach(pos => console.log(pos.toString()));
var start=positions.shift();positions.forEach(function(end){var line=new sprite_LineSprite(start,end,5,new three_module["Color"](132/255,165/255,206/255),0.5);_this2.scene.add(line.mesh);_this2.objects.push(line);start=end;});}}]);return NavigationalMovementPath;}();/* harmony default export */ var movement_NavigationalMovementPath = (NavigationalMovementPath_NavigationalMovementPath);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/SelectedShipNavigationPath.js
var SelectedShipNavigationPath_SelectedShipNavigationPath=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectedShipNavigationPath,_UiStrategy);function SelectedShipNavigationPath(){var _this;Object(classCallCheck["a" /* default */])(this,SelectedShipNavigationPath);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectedShipNavigationPath).call(this));_this.ship=null;_this.path=null;return _this;}Object(createClass["a" /* default */])(SelectedShipNavigationPath,[{key:"deactivate",value:function deactivate(){if(this.path){this.path.remove();}}},{key:"update",value:function update(gameData){var uiState=this.services.uiState;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(SelectedShipNavigationPath.prototype),"update",this).call(this,gameData);this.show(uiState.getSelectedShip());}},{key:"shipStateChanged",value:function shipStateChanged(){if(this.ship){if(this.path){this.path.remove();}this.show(this.ship);}}},{key:"shipSelected",value:function shipSelected(ship){this.show(ship);}},{key:"show",value:function show(ship){if(!this.gameData){return;}var _this$services=this.services,coordinateConverter=_this$services.coordinateConverter,scene=_this$services.scene;if(!ship){return;}this.ship=ship;var move=ship.movement.getLastEndMoveOrSurrogate();this.path=new movement_NavigationalMovementPath(this.gameData.terrain,move.position,move.velocity,100,coordinateConverter,scene);}},{key:"shipDeselected",value:function shipDeselected(ship){if(this.path){this.path.remove();}}}]);return SelectedShipNavigationPath;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_SelectedShipNavigationPath = (SelectedShipNavigationPath_SelectedShipNavigationPath);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/deployment/SelectedShipDeploymentMovementUi.js
var SelectedShipDeploymentMovementUi_SelectedShipDeploymentMovementUi=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectedShipDeploymentMovementUi,_UiStrategy);function SelectedShipDeploymentMovementUi(){Object(classCallCheck["a" /* default */])(this,SelectedShipDeploymentMovementUi);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectedShipDeploymentMovementUi).apply(this,arguments));}Object(createClass["a" /* default */])(SelectedShipDeploymentMovementUi,[{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.hideShipMovement();}},{key:"shipStateChanged",value:function shipStateChanged(){var uiState=this.services.uiState;var ship=uiState.getSelectedShip();if(ship){uiState.showShipDeploymentMovement(ship,true);}}},{key:"shipSelected",value:function shipSelected(ship){var uiState=this.services.uiState;uiState.showShipDeploymentMovement(ship,true);}},{key:"shipDeselected",value:function shipDeselected(){var uiState=this.services.uiState;uiState.hideShipMovement();}}]);return SelectedShipDeploymentMovementUi;}(uiStrategy_UiStrategy);/* harmony default export */ var deployment_SelectedShipDeploymentMovementUi = (SelectedShipDeploymentMovementUi_SelectedShipDeploymentMovementUi);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowWaitingStatus.js
var ShowWaitingStatus_ShowWaitingStatus=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(ShowWaitingStatus,_UiStrategy);function ShowWaitingStatus(){Object(classCallCheck["a" /* default */])(this,ShowWaitingStatus);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowWaitingStatus).apply(this,arguments));}Object(createClass["a" /* default */])(ShowWaitingStatus,[{key:"activate",value:function activate(services){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowWaitingStatus.prototype),"activate",this).call(this,services);var uiState=this.services.uiState;uiState.setWaiting(true);}},{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.setWaiting(false);}}]);return ShowWaitingStatus;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_ShowWaitingStatus = (ShowWaitingStatus_ShowWaitingStatus);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/SelectFirstActiveShip.js
var SelectFirstActiveShip_SelectFirstActiveShip=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectFirstActiveShip,_UiStrategy);function SelectFirstActiveShip(){Object(classCallCheck["a" /* default */])(this,SelectFirstActiveShip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectFirstActiveShip).apply(this,arguments));}Object(createClass["a" /* default */])(SelectFirstActiveShip,[{key:"update",value:function(){var _update=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(gameData){var _this$services,uiState,currentUser,gameCamera,shipIconContainer,oldShip,newShip,ship,icon;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$services=this.services,uiState=_this$services.uiState,currentUser=_this$services.currentUser,gameCamera=_this$services.gameCamera,shipIconContainer=_this$services.shipIconContainer;if(!(uiState.getSelectedShip()&&gameData.activeShips.isActive(uiState.getSelectedShip()))){_context.next=6;break;}oldShip=uiState.getSelectedShip();newShip=gameData.ships.getShipById(oldShip.id);if(oldShip!==newShip){uiState.selectShip(newShip);}return _context.abrupt("return");case 6:ship=gameData.getActiveShipsForUser(currentUser).pop();if(!ship){_context.next=13;break;}uiState.selectShip(ship);_context.next=11;return shipIconContainer.shipsLoaded();case 11:icon=shipIconContainer.getByShip(ship);gameCamera.setByLookAtPosition(icon.getPosition());case 13:case"end":return _context.stop();}}},_callee,this);}));function update(_x){return _update.apply(this,arguments);}return update;}()}]);return SelectFirstActiveShip;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_SelectFirstActiveShip = (SelectFirstActiveShip_SelectFirstActiveShip);
// CONCATENATED MODULE: ./src/client/view/game/ui/gameUiModes.js
var WEAPONS="weapons";var ENEMY_WEAPONS="enemy_weapons";var MOVEMENT="movement";var EW="ew";
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/AllShipsMovementPaths.js
var AllShipsMovementPaths_AllShipsMovementPaths=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(AllShipsMovementPaths,_UiStrategy);function AllShipsMovementPaths(){Object(classCallCheck["a" /* default */])(this,AllShipsMovementPaths);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AllShipsMovementPaths).apply(this,arguments));}Object(createClass["a" /* default */])(AllShipsMovementPaths,[{key:"deactivate",value:function deactivate(){var movementPathService=this.services.movementPathService;movementPathService.hideAllMovementPaths();}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(AllShipsMovementPaths.prototype),"update",this).call(this,gameData);this.show();}},{key:"uiStateChanged",value:function uiStateChanged(){if(!this.gameData){return;}this.show();}},{key:"shipStateChanged",value:function shipStateChanged(ship){var _this$services=this.services,movementPathService=_this$services.movementPathService,uiState=_this$services.uiState;if(!this.gameData){return;}if(!uiState.hasGameUiMode(MOVEMENT)||uiState.getSelectedShip()!==ship){return;}movementPathService.showMovementPath(ship);}},{key:"mouseOutShip",value:function mouseOutShip(){this.show();}},{key:"show",value:function show(){var _this$services2=this.services,movementPathService=_this$services2.movementPathService,uiState=_this$services2.uiState;if(uiState.hasGameUiMode(MOVEMENT)){var ships=this.gameData.ships.getAliveShips();ships.forEach(function(ship){return movementPathService.showMovementPath(ship);});}else{movementPathService.hideAllMovementPaths();/*
      const ship = uiState.getSelectedShip();
      if (ship) {
        movementPathService.showMovementPath(ship);
      }
      */}}}]);return AllShipsMovementPaths;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_AllShipsMovementPaths = (AllShipsMovementPaths_AllShipsMovementPaths);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/AllowSubmittingOnValidGameState.js
var AllowSubmittingOnValidGameState_AllowSubmittingOnValidGameState=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(AllowSubmittingOnValidGameState,_UiStrategy);function AllowSubmittingOnValidGameState(){Object(classCallCheck["a" /* default */])(this,AllowSubmittingOnValidGameState);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AllowSubmittingOnValidGameState).apply(this,arguments));}Object(createClass["a" /* default */])(AllowSubmittingOnValidGameState,[{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.setTurnReady(false);}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(AllowSubmittingOnValidGameState.prototype),"update",this).call(this,gameData);var uiState=this.services.uiState;uiState.setTurnReady(true);}}]);return AllowSubmittingOnValidGameState;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_AllowSubmittingOnValidGameState = (AllowSubmittingOnValidGameState_AllowSubmittingOnValidGameState);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/replay/AutomaticReplay.js
var AutomaticReplay_AutomaticReplay=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(AutomaticReplay,_UiStrategy);function AutomaticReplay(phaseStrategy,replayContext){var _this;Object(classCallCheck["a" /* default */])(this,AutomaticReplay);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AutomaticReplay).call(this));_this.phaseStrategy=phaseStrategy;_this.replayContext=replayContext;return _this;}Object(createClass["a" /* default */])(AutomaticReplay,[{key:"newTurn",value:function(){var _newTurn=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(gameDatas){var _this2=this;var shipIconContainer;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:shipIconContainer=this.services.shipIconContainer;_context.next=3;return shipIconContainer.shipsLoaded();case 3:setTimeout(function(){_this2.phaseStrategy.animateFromTo(0);},500);case 4:case"end":return _context.stop();}}},_callee,this);}));function newTurn(_x){return _newTurn.apply(this,arguments);}return newTurn;}()},{key:"render",value:function render(_ref){var delta=_ref.delta,total=_ref.total;if(total>=this.replayContext.getTurnLength()+2000){var uiState=this.services.uiState;uiState.closeReplay();}}}]);return AutomaticReplay;}(uiStrategy_UiStrategy);/* harmony default export */ var replay_AutomaticReplay = (AutomaticReplay_AutomaticReplay);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/replay/ShowReplayUi.js
var ShowReplayUi_ShowReplayUi=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(ShowReplayUi,_UiStrategy);function ShowReplayUi(replayContext){var _this;Object(classCallCheck["a" /* default */])(this,ShowReplayUi);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowReplayUi).call(this));_this.replayContext=replayContext;return _this;}Object(createClass["a" /* default */])(ShowReplayUi,[{key:"activate",value:function activate(services){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowReplayUi.prototype),"activate",this).call(this,services);var uiState=this.services.uiState;uiState.showReplayUi(this.replayContext);}},{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.showReplayUi(false);}}]);return ShowReplayUi;}(uiStrategy_UiStrategy);/* harmony default export */ var replay_ShowReplayUi = (ShowReplayUi_ShowReplayUi);
// CONCATENATED MODULE: ./src/client/styled/Colors.js
var blue="#deebff";var darkBlue="#04161C";var border="#496791";var borderDark="#37465a";var Colors_text="#DEEBFF";var textDanger="#da5656";var lightBlue="#6daaff";var red="#a82a2a";var systemWindowBorder="#6e6c6c";var systemWindowPrimaryBorder="#aaaaaa";var systemBorder="#bebebe";var tooltipButtonColor="#3b3b60";var mediumBlue="#142b4b";var hitpoints="#427231";var hitpointsCritical="#ed6738";var Colors_fuel="#295591";
// CONCATENATED MODULE: ./src/client/styled/icon/Arrow.js
var Arrow_Arrow=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(Arrow,_React$Component);function Arrow(){Object(classCallCheck["a" /* default */])(this,Arrow);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Arrow).apply(this,arguments));}Object(createClass["a" /* default */])(Arrow,[{key:"render",value:function render(){var _this$props$size=this.props.size,size=_this$props$size===void 0?"90%":_this$props$size;return react["createElement"]("svg",{id:"arrow",xmlns:"http://www.w3.org/2000/svg",width:size,height:size,viewBox:"0 0 32.75 32.75"},react["createElement"]("path",{id:"svg-path",d:"M30.434,15.938c-0.791,0.933-1.917,1.411-3.052,1.411c-0.913,0-1.834-0.312-2.587-0.951l-4.421-3.753V28.75 c0,2.209-1.791,4-4,4c-2.209,0-4-1.791-4-4V12.646l-4.42,3.754c-1.683,1.431-4.208,1.226-5.639-0.459 c-1.43-1.684-1.224-4.208,0.46-5.638l11.01-9.351c1.493-1.27,3.686-1.27,5.178,0l11.011,9.351 C31.658,11.73,31.863,14.255,30.434,15.938z"}));}}]);return Arrow;}(react["Component"]);/* harmony default export */ var icon_Arrow = (Arrow_Arrow);
// CONCATENATED MODULE: ./src/client/styled/icon/ArrowSmall.js
var ArrowSmall_ArrowSmall=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(ArrowSmall,_React$Component);function ArrowSmall(){Object(classCallCheck["a" /* default */])(this,ArrowSmall);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ArrowSmall).apply(this,arguments));}Object(createClass["a" /* default */])(ArrowSmall,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"100%":_this$props$size;return react["createElement"]("svg",{xmlns:"http://www.w3.org/2000/svg",id:"Capa_1",width:size,height:size,viewBox:"0 0 438.533 438.533"},react["createElement"]("path",{id:"svg-path",d:"M409.133,109.203c-19.608-33.592-46.205-60.189-79.798-79.796C295.736,9.801,259.058,0,219.273,0 c-39.781,0-76.47,9.801-110.063,29.407c-33.595,19.604-60.192,46.201-79.8,79.796C9.801,142.8,0,179.489,0,219.267 c0,39.78,9.804,76.463,29.407,110.062c19.607,33.592,46.204,60.189,79.799,79.798c33.597,19.605,70.283,29.407,110.063,29.407 s76.47-9.802,110.065-29.407c33.593-19.602,60.189-46.206,79.795-79.798c19.603-33.596,29.403-70.284,29.403-110.062 C438.533,179.485,428.732,142.795,409.133,109.203z M334.332,232.111L204.71,361.736c-3.617,3.613-7.896,5.428-12.847,5.428 c-4.952,0-9.235-1.814-12.85-5.428l-29.121-29.13c-3.617-3.613-5.426-7.898-5.426-12.847c0-4.941,1.809-9.232,5.426-12.847 l87.653-87.646l-87.657-87.65c-3.617-3.612-5.426-7.898-5.426-12.845c0-4.949,1.809-9.231,5.426-12.847l29.121-29.13 c3.619-3.615,7.898-5.424,12.85-5.424c4.95,0,9.233,1.809,12.85,5.424l129.622,129.621c3.613,3.614,5.42,7.898,5.42,12.847 C339.752,224.213,337.945,228.498,334.332,232.111z",fill:color}));}}]);return ArrowSmall;}(react["Component"]);/* harmony default export */ var icon_ArrowSmall = (ArrowSmall_ArrowSmall);
// CONCATENATED MODULE: ./src/client/styled/icon/Roll.js
var Roll_Roll=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(Roll,_React$Component);function Roll(){Object(classCallCheck["a" /* default */])(this,Roll);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Roll).apply(this,arguments));}Object(createClass["a" /* default */])(Roll,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"100%":_this$props$size;return react["createElement"]("svg",{id:"roll",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 420.995 420.995",width:size,height:size},react["createElement"]("g",{fill:"#010002"},react["createElement"]("path",{id:"svg-path",d:"M127.505,196.313c22.15,0,27.45-12.827,11.77-28.458l-31.165-31.197 c4.406-6.194,9.234-12.006,14.599-17.257c1.878-1.788,3.796-3.512,5.763-5.17c2.3-2.008,4.715-3.861,7.145-5.698 c2.146-1.561,4.292-3.146,6.487-4.593c3.65-2.341,7.364-4.511,11.226-6.454c1.723-0.87,3.438-1.626,5.194-2.439 c4.04-1.837,8.202-3.471,12.494-4.926c0.845-0.236,1.626-0.602,2.463-0.845c5.194-1.561,10.478-2.707,15.875-3.617 c1.39-0.244,2.78-0.455,4.17-0.634c5.601-0.764,11.25-1.301,17.013-1.301c0.179,0,0.358,0.065,0.536,0.065 c4.113,0,8.096,0.171,12.103,0.593c1.967,0.187,3.861,0.585,5.763,0.862c2.292,0.358,4.552,0.593,6.755,1.024 c1.626,0.366,3.195,0.813,4.771,1.203c2.552,0.602,5.154,1.211,7.657,2.016c1.138,0.333,2.235,0.813,3.349,1.179 c2.991,1.032,5.918,2.057,8.787,3.325c14.534,6.218,27.946,15.2,39.464,26.735c12.372,12.315,21.85,26.784,28.182,42.927 c6.942,17.607,26.776,26.223,44.358,19.313c17.623-6.901,26.255-26.751,19.305-44.317c-9.779-24.987-24.435-47.325-43.447-66.329 c-17.322-17.289-37.416-30.775-59.143-40.399c-0.301-0.154-0.536-0.333-0.845-0.455c-0.252-0.122-0.488-0.187-0.732-0.301 c-4.885-2.089-9.868-3.894-14.932-5.584c-1.211-0.423-2.382-0.935-3.617-1.292c-4.804-1.52-9.665-2.731-14.55-3.812 c-1.544-0.366-3.073-0.87-4.617-1.171c-4.885-0.992-9.836-1.65-14.81-2.252c-1.544-0.187-3.048-0.553-4.625-0.732 c-6.519-0.634-13.152-0.975-19.785-0.975c-0.358,0-0.788,0.065-1.179,0.065c-5.462,0-10.835,0.309-16.151,0.788 c-1.861,0.13-3.739,0.366-5.601,0.602c-4.081,0.488-8.12,1.097-12.128,1.821c-1.813,0.301-3.585,0.626-5.373,0.992 c-5.064,1.057-10.136,2.325-15.054,3.78c-0.463,0.146-0.943,0.236-1.423,0.382c-5.796,1.756-11.469,3.837-17.013,6.096 c-0.585,0.219-1.089,0.488-1.634,0.699c-5.259,2.227-10.437,4.674-15.452,7.332c-0.333,0.154-0.658,0.325-1.016,0.504 C95.69,50.6,75.409,67.191,58.997,87.602l-30.539-30.58C12.803,41.391,0,46.674,0,68.825v87.211 c0,22.183,18.102,40.277,40.228,40.277C40.228,196.313,127.505,196.313,127.505,196.313z",fill:color}),react["createElement"]("path",{id:"svg-path",d:"M380.783,224.706h-87.268c-22.118,0-27.393,12.786-11.77,28.45l31.197,31.206 c-4.406,6.121-9.161,11.86-14.542,17.111c-1.902,1.861-3.894,3.642-5.918,5.357c-2.235,1.935-4.536,3.715-6.844,5.43 c-2.3,1.691-4.593,3.406-6.999,4.926c-3.536,2.252-7.153,4.373-10.9,6.235c-1.74,0.894-3.495,1.723-5.267,2.536 c-4.024,1.821-8.12,3.438-12.282,4.828c-0.91,0.301-1.756,0.658-2.658,0.91c-5.162,1.593-10.445,2.715-15.843,3.617 c-1.39,0.236-2.812,0.423-4.202,0.658c-5.568,0.699-11.217,1.203-16.948,1.203c-4.284,0-8.511-0.179-12.729-0.602 c-1.788-0.179-3.56-0.536-5.316-0.788c-2.406-0.301-4.82-0.658-7.243-1.122c-1.504-0.26-3.016-0.788-4.519-1.105 c-2.626-0.675-5.251-1.276-7.852-2.065c-1.146-0.366-2.268-0.845-3.438-1.203c-2.894-1.024-5.763-2.048-8.633-3.284 c-14.534-6.243-27.97-15.2-39.489-26.702c-12.404-12.429-21.874-26.881-28.214-42.96c-6.877-17.623-26.767-26.255-44.358-19.346 c-17.566,6.917-26.263,26.767-19.313,44.39c9.803,24.857,24.435,47.186,43.504,66.248c17.322,17.33,37.391,30.848,59.144,40.383 c0.301,0.171,0.545,0.358,0.813,0.455c0.236,0.146,0.496,0.203,0.707,0.293c4.999,2.187,10.136,4.056,15.314,5.771 c1.097,0.358,2.113,0.813,3.211,1.154c4.975,1.561,10.047,2.772,15.135,3.95c1.333,0.317,2.658,0.723,4.048,0.992 c5.121,1.089,10.405,1.813,15.688,2.414c1.26,0.179,2.463,0.455,3.707,0.569c6.544,0.634,13.12,1.032,19.793,1.032 c0.358,0,0.691-0.073,1.049-0.073c5.527-0.033,10.99-0.325,16.387-0.813c1.788-0.154,3.601-0.366,5.406-0.577 c4.17-0.504,8.299-1.105,12.396-1.845c1.723-0.293,3.406-0.626,5.105-0.984c5.243-1.065,10.437-2.357,15.509-3.894 c0.358-0.057,0.658-0.163,1.024-0.236c5.82-1.756,11.591-3.869,17.2-6.153l1.325-0.585c5.373-2.219,10.616-4.731,15.753-7.446 c0.268-0.154,0.545-0.301,0.845-0.455c22.809-12.193,43.09-28.783,59.509-49.21l30.539,30.531 c15.664,15.696,28.45,10.372,28.45-11.762v-87.187C421.011,242.801,402.901,224.706,380.783,224.706z",fill:color})));}}]);return Roll;}(react["Component"]);/* harmony default export */ var icon_Roll = (Roll_Roll);
// CONCATENATED MODULE: ./src/client/styled/icon/X.js
var X_X=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(X,_React$Component);function X(){Object(classCallCheck["a" /* default */])(this,X);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(X).apply(this,arguments));}Object(createClass["a" /* default */])(X,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"80%":_this$props$size;return react["createElement"]("svg",{xmlns:"http://www.w3.org/2000/svg",id:"Capa_1",width:size,height:size,viewBox:"0 0 348.333 348.334"},react["createElement"]("path",{id:"svg-path",d:"M336.559,68.611L231.016,174.165l105.543,105.549c15.699,15.705,15.699,41.145,0,56.85 c-7.844,7.844-18.128,11.769-28.407,11.769c-10.296,0-20.581-3.919-28.419-11.769L174.167,231.003L68.609,336.563 c-7.843,7.844-18.128,11.769-28.416,11.769c-10.285,0-20.563-3.919-28.413-11.769c-15.699-15.698-15.699-41.139,0-56.85 l105.54-105.549L11.774,68.611c-15.699-15.699-15.699-41.145,0-56.844c15.696-15.687,41.127-15.687,56.829,0l105.563,105.554 L279.721,11.767c15.705-15.687,41.139-15.687,56.832,0C352.258,27.466,352.258,52.912,336.559,68.611z",fill:color}));}}]);return X;}(react["Component"]);/* harmony default export */ var icon_X = (X_X);
// CONCATENATED MODULE: ./src/client/styled/icon/Evade.js
var Evade_Evade=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(Evade,_React$Component);function Evade(){Object(classCallCheck["a" /* default */])(this,Evade);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Evade).apply(this,arguments));}Object(createClass["a" /* default */])(Evade,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"100%":_this$props$size;return react["createElement"]("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:size,height:size},react["createElement"]("path",{id:"svg-path",d:"M501.608,384.478L320.497,51.476C291.376,2.451,220.139,2.41,191.21,52.003L10.647,383.951 c-29.706,49.989,6.259,113.291,64.482,113.291h361.689C495.436,497.242,530.688,433.393,501.608,384.478z M331,332.242 c0,22.516-23.688,36.693-43.403,26.836L211,320.787v101.455c0,8.284-6.716,15-15,15h-30c-8.284,0-15-6.716-15-15v-150 c0-22.516,23.69-36.667,43.418-26.836L271,283.698V182.242c0-8.286,6.716-15,15-15h30c8.284,0,15,6.714,15,15V332.242z",fill:color}));}}]);return Evade;}(react["Component"]);/* harmony default export */ var icon_Evade = (Evade_Evade);/*
<svg xmlns='http://www.w3.org/2000/svg' id='Capa_1' viewBox='0 0 214.32 214.32'
width='512' height='512'>
    <path d='M183.673,128.681c-8.297,9.305-19.722,14.821-32.169,15.534c-12.432,0.712-24.425-3.466-33.73-11.764L81.312,99.937 c-8.919-7.954-22.649-7.17-30.603,1.751l-1.404,1.574c-7.953,8.919-7.167,22.647,1.752,30.602l35.191,31.382l5.02-5.532 c2.399-2.645,6.031-3.81,9.521-3.054c3.492,0.756,6.315,3.317,7.406,6.72l11.951,37.267c0.449,1.137,0.696,2.377,0.696,3.675 c0,5.488-4.421,9.943-9.896,9.999c-0.041,0.001-0.082,0.001-0.124,0.001c-0.704,0-1.413-0.074-2.116-0.227l-38.887-8.422 c-3.492-0.756-6.315-3.317-7.406-6.72s-0.284-7.128,2.117-9.773l4.917-5.419l-35.031-31.238 c-19.208-17.129-20.899-46.691-3.771-65.899l1.404-1.574c17.127-19.207,46.688-20.899,65.898-3.77l36.462,32.515 c8.92,7.954,22.648,7.17,30.603-1.751c7.954-8.92,7.168-22.647-1.751-30.602L126.96,49.067l-5.027,5.54 c-1.916,2.112-4.617,3.28-7.405,3.28c-0.704,0-1.413-0.074-2.117-0.227c-3.491-0.756-6.314-3.317-7.405-6.72L92.856,13.054 c-1.091-3.402-0.284-7.128,2.117-9.773c2.399-2.645,6.032-3.81,9.521-3.054l38.887,8.421c3.492,0.756,6.315,3.317,7.406,6.72 s0.284,7.128-2.117,9.773l-4.911,5.412l36.142,32.23C199.11,79.911,200.802,109.474,183.673,128.681z'
    fill='#D80027' />
</svg>
*/
// CONCATENATED MODULE: ./src/client/styled/icon/Pivot.js
var Pivot_Pivot=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(Pivot,_React$Component);function Pivot(){Object(classCallCheck["a" /* default */])(this,Pivot);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Pivot).apply(this,arguments));}Object(createClass["a" /* default */])(Pivot,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"100%":_this$props$size;return react["createElement"]("svg",{id:"pivot",xmlns:"http://www.w3.org/2000/svg",width:size,height:size,viewBox:"0 0 511.612 511.612"},react["createElement"]("path",{id:"svg-path",d:"M433.822,126.876l-113.28-113.28c-18.048-18.112-49.632-18.144-67.744,0c-18.752,18.752-18.752,49.312,0,68.064 l29.984,29.952h-18.976c-110.272,0-200,89.728-200,200s89.728,200,200,200h8c8.832,0,16-7.168,16-16v-64c0-8.832-7.168-16-16-16 h-8c-57.344,0-104-46.656-104-104s46.656-104,104-104h21.216l-32.224,32.192c-18.752,18.784-18.752,49.312,0,68.064 c17.984,17.952,50.304,17.536,67.744,0l113.312-113.28c8.864-8.896,13.952-21.152,13.952-33.696 C447.806,148.444,442.974,136.476,433.822,126.876z",fill:color}));}}]);return Pivot;}(react["Component"]);/* harmony default export */ var icon_Pivot = (Pivot_Pivot);
// CONCATENATED MODULE: ./src/client/styled/icon/Cancel.js
var Cancel_Cancel=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(Cancel,_React$Component);function Cancel(){Object(classCallCheck["a" /* default */])(this,Cancel);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Cancel).apply(this,arguments));}Object(createClass["a" /* default */])(Cancel,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"90%":_this$props$size;return react["createElement"]("svg",{xmlns:"http://www.w3.org/2000/svg",id:"cancel",viewBox:"0 0 512 512",width:size,height:size},react["createElement"]("path",{id:"svg-path",d:"M256,0C114.833,0,0,114.844,0,256s114.833,256,256,256s256-114.844,256-256S397.167,0,256,0z M256,426.667 c-94.104,0-170.667-76.563-170.667-170.667c0-31.596,8.785-61.112,23.814-86.52L342.52,402.853 C317.112,417.882,287.596,426.667,256,426.667z M402.853,342.52L169.48,109.147c25.408-15.029,54.923-23.814,86.52-23.814 c94.104,0,170.667,76.563,170.667,170.667C426.667,287.596,417.882,317.112,402.853,342.52z",fill:color}));}}]);return Cancel;}(react["Component"]);/* harmony default export */ var icon_Cancel = (Cancel_Cancel);
// CONCATENATED MODULE: ./src/client/styled/icon/CheckMark.js
var CheckMark_CheckMark=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(CheckMark,_React$Component);function CheckMark(){Object(classCallCheck["a" /* default */])(this,CheckMark);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CheckMark).apply(this,arguments));}Object(createClass["a" /* default */])(CheckMark,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"90%":_this$props$size;return react["createElement"]("svg",{id:"CheckMark",xmlns:"http://www.w3.org/2000/svg",width:size,height:size,viewBox:"0 0 442.533 442.533"},react["createElement"]("path",{d:"M434.539,98.499l-38.828-38.828c-5.324-5.328-11.799-7.993-19.41-7.993c-7.618,0-14.093,2.665-19.417,7.993L169.59,247.248 l-83.939-84.225c-5.33-5.33-11.801-7.992-19.412-7.992c-7.616,0-14.087,2.662-19.417,7.992L7.994,201.852 C2.664,207.181,0,213.654,0,221.269c0,7.609,2.664,14.088,7.994,19.416l103.351,103.349l38.831,38.828 c5.327,5.332,11.8,7.994,19.414,7.994c7.611,0,14.084-2.669,19.414-7.994l38.83-38.828L434.539,137.33 c5.325-5.33,7.994-11.802,7.994-19.417C442.537,110.302,439.864,103.829,434.539,98.499z",fill:color}));}}]);return CheckMark;}(react["Component"]);/* harmony default export */ var icon_CheckMark = (CheckMark_CheckMark);
// CONCATENATED MODULE: ./src/client/styled/icon/Play.js
var Play_Play=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(Play,_React$PureComponent);function Play(){Object(classCallCheck["a" /* default */])(this,Play);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Play).apply(this,arguments));}Object(createClass["a" /* default */])(Play,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"100%":_this$props$size;return react_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:size,height:size,viewBox:"0 0 373.008 373.008"},react_default.a.createElement("path",{d:"M61.792 2.588A19.258 19.258 0 0171.444 0c3.33 0 6.663.864 9.655 2.588l230.116 167.2a19.327 19.327 0 019.656 16.719 19.293 19.293 0 01-9.656 16.713L81.099 370.427a19.336 19.336 0 01-19.302 0 19.333 19.333 0 01-9.66-16.724V19.305a19.308 19.308 0 019.655-16.717z",fill:color}));}}]);return Play;}(react_default.a.PureComponent);/* harmony default export */ var icon_Play = (Play_Play);
// CONCATENATED MODULE: ./src/client/styled/icon/Pause.js
var Pause_Pause=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(Pause,_React$PureComponent);function Pause(){Object(classCallCheck["a" /* default */])(this,Pause);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Pause).apply(this,arguments));}Object(createClass["a" /* default */])(Pause,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"100%":_this$props$size;return react_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:size,height:size,viewBox:"0 0 792 792"},react_default.a.createElement("path",{d:"M282.856 0H169.714c-31.228 0-56.571 25.344-56.571 56.571v678.857c0 31.228 25.344 56.571 56.571 56.571h113.143c31.256 0 56.572-25.315 56.572-56.571V56.571C339.428 25.344 314.112 0 282.856 0zm339.429 0H509.143c-31.256 0-56.572 25.344-56.572 56.571v678.857c0 31.228 25.316 56.571 56.572 56.571h113.143c31.256 0 56.572-25.315 56.572-56.571V56.571C678.857 25.344 653.541 0 622.285 0z",fill:color}));}}]);return Pause;}(react_default.a.PureComponent);/* harmony default export */ var icon_Pause = (Pause_Pause);
// CONCATENATED MODULE: ./src/client/styled/icon/Replay.js
var Replay_Replay=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(Replay,_React$PureComponent);function Replay(){Object(classCallCheck["a" /* default */])(this,Replay);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Replay).apply(this,arguments));}Object(createClass["a" /* default */])(Replay,[{key:"render",value:function render(){var _this$props=this.props,_this$props$color=_this$props.color,color=_this$props$color===void 0?"#fff":_this$props$color,_this$props$size=_this$props.size,size=_this$props$size===void 0?"100%":_this$props$size;return react_default.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:size,height:size,viewBox:"0 0 400.548 400.548"},react_default.a.createElement("path",{d:"M383.86 99.79a27.04 27.04 0 00-29.466 5.86l-51.507 51.512v-31.397c0-22.359-18.13-40.491-40.493-40.491H40.493C18.131 85.274 0 103.406 0 125.765v149.018c0 22.359 18.131 40.491 40.493 40.491h221.901c22.363 0 40.493-18.132 40.493-40.491v-31.398l51.507 51.512a27.04 27.04 0 0019.126 7.924c3.481 0 6.995-.678 10.34-2.063a27.04 27.04 0 0016.688-24.978V124.767A27.037 27.037 0 00383.86 99.79zM190.309 210.764l-55.191 42.403a13.21 13.21 0 01-8.06 2.738 13.223 13.223 0 01-13.226-13.228V157.87a13.22 13.22 0 017.38-11.864 13.22 13.22 0 0113.905 1.375l55.191 42.402a13.228 13.228 0 01.001 20.981z",fill:color}));}}]);return Replay;}(react_default.a.PureComponent);/* harmony default export */ var icon_Replay = (Replay_Replay);
// CONCATENATED MODULE: ./src/client/styled/icon/index.js

// CONCATENATED MODULE: ./src/client/styled/IconAndLabel.js
function IconAndLabel_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  box-sizing: border-box;\n  width: 30px;\n  height: 30px;\n\n  background-color: \"transparent\";\n  background-image: ",";\n  background-size: cover;\n  display: flex;\n  align-items: flex-end;\n  justify-content: center;\n  font-family: arial;\n  font-size: 10px;\n"]);IconAndLabel_templateObject=function _templateObject(){return data;};return data;}var IconAndLabel=styled_components_browser_esm["b" /* default */].div(IconAndLabel_templateObject(),function(props){return"url(".concat(props.background,")");});/* harmony default export */ var styled_IconAndLabel = (IconAndLabel);
// CONCATENATED MODULE: ./src/client/styled/Container.js
function _templateObject11(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  margin: 0;\n  flex-grow: 1;\n  flex-basis: calc(50% - 16px);\n"]);_templateObject11=function _templateObject11(){return data;};return data;}function _templateObject10(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  flex-grow: 1;\n  justify-content: flex-end;\n"]);_templateObject10=function _templateObject10(){return data;};return data;}function _templateObject9(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  margin: 0;\n  padding: 0;\n  flex-wrap: wrap;\n"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n  background-color: ","\n"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 500px;\n"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  padding: 10px;\n"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border-radius: 30px 0px 0px 30px;\n  box-shadow: 5px 5px 10px black;\n"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border-radius: 0px 0px 30px 30px;\n  box-shadow: 5px 5px 10px black;\n"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border-radius: 0px 0px 30px 0px;\n  box-shadow: 5px 5px 10px black;\n"]);_templateObject3=function _templateObject3(){return data;};return data;}function Container_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: 99999;\n  background-color: rgba(0, 0, 0, 0.5);\n"]);Container_templateObject2=function _templateObject2(){return data;};return data;}function Container_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-direction: column;\n  border: 1px solid #496791;\n  color: #deebff;\n  background-color: #0a3340;\n  font-family: arial;\n  margin-bottom: 10px;\n\n  :last-child {\n    margin-bottom: 0;\n  }\n"]);Container_templateObject=function _templateObject(){return data;};return data;}var Container=styled_components_browser_esm["b" /* default */].div(Container_templateObject());var Backdrop=styled_components_browser_esm["b" /* default */].div(Container_templateObject2());var ContainerRoundedRightBottom=Object(styled_components_browser_esm["b" /* default */])(Container)(_templateObject3());var ContainerRounded=Object(styled_components_browser_esm["b" /* default */])(Container)(_templateObject4());var ContainerRoundedRightSide=Object(styled_components_browser_esm["b" /* default */])(Container)(_templateObject5());var defaultPadding=Object(styled_components_browser_esm["a" /* css */])(_templateObject6());var defaultWidth=Object(styled_components_browser_esm["a" /* css */])(_templateObject7());var DarkContainer=Object(styled_components_browser_esm["b" /* default */])(Container)(_templateObject8(),defaultPadding,darkBlue);var Section=styled_components_browser_esm["b" /* default */].div(_templateObject9());var SectionRight=Object(styled_components_browser_esm["b" /* default */])(Section)(_templateObject10());var Cell50=styled_components_browser_esm["b" /* default */].div(_templateObject11());
// CONCATENATED MODULE: ./src/client/styled/Text.js
function Text_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: ",";\n  padding: 0;\n  margin: 0;\n  padding-left: 5px;\n"]);Text_templateObject3=function _templateObject3(){return data;};return data;}function Text_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  font-family: arial;\n  font-size: 12px;\n  color: white;\n"]);Text_templateObject2=function _templateObject2(){return data;};return data;}function Text_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  font-family: arial;\n  font-size: 12px;\n  color: #deebff;\n  padding: 10px;\n"]);Text_templateObject=function _templateObject(){return data;};return data;}var Paragraph=styled_components_browser_esm["b" /* default */].p(Text_templateObject());var Label=styled_components_browser_esm["b" /* default */].span(Text_templateObject2());var Value=styled_components_browser_esm["b" /* default */].span(Text_templateObject3(),lightBlue);
// CONCATENATED MODULE: ./src/client/styled/Title.js
function Title_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  font-weight: normal;\n"]);Title_templateObject2=function _templateObject2(){return data;};return data;}function Title_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  font-family: arial;\n  font-size: 16px;\n  text-transform: uppercase;\n  color: #deebff;\n  padding: 10px;\n  font-weight: bold;\n"]);Title_templateObject=function _templateObject(){return data;};return data;}var Title=styled_components_browser_esm["b" /* default */].span(Title_templateObject());var SubTitle=Object(styled_components_browser_esm["b" /* default */])(Title)(Title_templateObject2());
// CONCATENATED MODULE: ./src/client/styled/Clickable.js
function Clickable_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n\n  &:hover {\n    text-shadow: white 0 0 10px, white 0 0 3px;\n    opacity: 2;\n    ","\n    color: #deebff;\n  }\n"]);Clickable_templateObject=function _templateObject(){return data;};return data;}var Clickable=Object(styled_components_browser_esm["a" /* css */])(Clickable_templateObject(),function(props){return!props.disabled&&"cursor: pointer;";},function(props){return props.disabled&&"opacity: 0.5;";});
// CONCATENATED MODULE: ./src/client/styled/Error.js
function Error_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: ",";\n  font-size: 12px;\n  height: 18px;\n  overflow: hidden;\n  font-weight: bolder;\n"]);Error_templateObject=function _templateObject(){return data;};return data;}var Error_Error=Object(styled_components_browser_esm["b" /* default */])(Section)(Error_templateObject(),Colors_namespaceObject.textDanger);
// CONCATENATED MODULE: ./src/client/styled/InputAndLabel.js
function InputAndLabel_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  color: #0a3340;\n  background-color: white;\n  padding: 3px 6px;\n  border: 1px solid #04161c;\n  border-radius: 3px;\n  width: calc(70% - 12px);\n  height: 16px;\n\n  min-width: 150px;\n  max-width: 100%;\n  flex-grow: 1;\n"]);InputAndLabel_templateObject4=function _templateObject4(){return data;};return data;}function InputAndLabel_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  max-width: 300px;\n  color: #deebff;\n  align-items: center;\n  padding: 4px 10px 4px 0;\n"]);InputAndLabel_templateObject3=function _templateObject3(){return data;};return data;}function InputAndLabel_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  display: flex;\n  flex: 1 1 100%;\n  margin: 0;\n  padding: 0;\n  flex-wrap: wrap;\n  align-items: center;\n"]);InputAndLabel_templateObject2=function _templateObject2(){return data;};return data;}function InputAndLabel_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  box-sizing: border-box;\n  flex-direction: column;\n  flex-grow: 1;\n  margin: 5px 8px;\n"]);InputAndLabel_templateObject=function _templateObject(){return data;};return data;}var InputAndLabel_InputAndLabel=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(InputAndLabel,_React$Component);function InputAndLabel(){Object(classCallCheck["a" /* default */])(this,InputAndLabel);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(InputAndLabel).apply(this,arguments));}Object(createClass["a" /* default */])(InputAndLabel,[{key:"render",value:function render(){var _this$props=this.props,id=_this$props.id,label=_this$props.label,type=_this$props.type,value=_this$props.value,placeholder=_this$props.placeholder,onKeyDown=_this$props.onKeyDown,onChange=_this$props.onChange,error=_this$props.error,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["id","label","type","value","placeholder","onKeyDown","onChange","error"]);return react["createElement"](InputAndLabel_Container,null,react["createElement"](SubContainer,null,label&&react["createElement"](InputAndLabel_Label,{htmlFor:id},label),react["createElement"](Input,Object.assign({id:id,type:type||"text",value:value,placeholder:placeholder,onKeyDown:onKeyDown,onChange:onChange,tabIndex:"0"},rest))),react["createElement"](Error_Error,null,error));}}]);return InputAndLabel;}(react["Component"]);var InputAndLabel_Container=styled_components_browser_esm["b" /* default */].div(InputAndLabel_templateObject());var SubContainer=styled_components_browser_esm["b" /* default */].div(InputAndLabel_templateObject2());var InputAndLabel_Label=styled_components_browser_esm["b" /* default */].div(InputAndLabel_templateObject3());var Input=styled_components_browser_esm["b" /* default */].input(InputAndLabel_templateObject4());
// CONCATENATED MODULE: ./src/client/styled/Tooltip.js
function _templateObject18(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  top: 0px;\n\n  ","\n\n  width: 202px;\n\n  ","\n  transition: width 0.25s;\n  transition-timing-function: ease-in-out;\n"]);_templateObject18=function _templateObject18(){return data;};return data;}function _templateObject17(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border: none;\n  width: 40px;\n  height: 40px;\n  background-color: transparent;\n  margin: 0;\n  cursor: pointer;\n  background-image: ",";\n  background-size: cover;\n  opacity: 0.5;\n  filter: brightness(3) grayscale(100%);\n\n  ","\n\n  ","\n\n  &:hover {\n    ","\n  }\n\n  &:focus {\n    outline: 0;\n  }\n\n  svg #svg-path {\n    fill: white;\n    ","\n  }\n"]);_templateObject17=function _templateObject17(){return data;};return data;}function _templateObject16(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  opacity: 1;\n  filter: brightness(5) grayscale(100%);\n"]);_templateObject16=function _templateObject16(){return data;};return data;}function _templateObject15(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  filter: brightness(0.25) grayscale(100%);\n"]);_templateObject15=function _templateObject15(){return data;};return data;}function _templateObject14(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  filter: brightness(5) grayscale(100%);\n  opacity: 1;\n"]);_templateObject14=function _templateObject14(){return data;};return data;}function _templateObject13(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin: 0 8px;\n  display: flex;\n"]);_templateObject13=function _templateObject13(){return data;};return data;}function _templateObject12(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n"]);_templateObject12=function _templateObject12(){return data;};return data;}function Tooltip_templateObject11(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  justify-content: center;\n  "," {\n    padding-right: 0;\n  }\n"]);Tooltip_templateObject11=function _templateObject11(){return data;};return data;}function Tooltip_templateObject10(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n        border: 1px solid white;\n      "]);Tooltip_templateObject10=function _templateObject10(){return data;};return data;}function Tooltip_templateObject9(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n      cursor: pointer;\n      color: white;\n      background-color: ",";\n      border: 1px solid black;\n    "]);Tooltip_templateObject9=function _templateObject9(){return data;};return data;}function Tooltip_templateObject8(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  box-sizing: border-box;\n  margin: 2px 8px;\n\n  ","\n  font-weight: ",";\n  font-size: ",";\n  ",";\n  text-align: left;\n  color: #5e85bc;\n  font-family: arial;\n  \n  ","\n\n  &:hover {\n    ","\n  }\n"]);Tooltip_templateObject8=function _templateObject8(){return data;};return data;}function Tooltip_templateObject7(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  padding-right: 5px;\n  color: white;\n"]);Tooltip_templateObject7=function _templateObject7(){return data;};return data;}function Tooltip_templateObject6(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  border-bottom: 1px solid #aaaaaa;\n  width: calc(100% - 16px);\n  margin: 5px 8px;\n  font-weight: bold;\n  font-size: 12px;\n  color: white;\n"]);Tooltip_templateObject6=function _templateObject6(){return data;};return data;}function Tooltip_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  justify-content: space-between;\n  text-transform: uppercase;\n  border-bottom: 1px solid #aaaaaa;\n  width: calc(100% - 16px);\n  margin: 5px 8px;\n  font-weight: bold;\n  font-size: 12px;\n"]);Tooltip_templateObject5=function _templateObject5(){return data;};return data;}function Tooltip_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: ",";\n"]);Tooltip_templateObject4=function _templateObject4(){return data;};return data;}function Tooltip_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  z-index: 20000;\n  ","\n  text-align: left;\n  filter: brightness(1);\n"]);Tooltip_templateObject3=function _templateObject3(){return data;};return data;}function Tooltip_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  z-index: 7001;\n  position: absolute;\n"]);Tooltip_templateObject2=function _templateObject2(){return data;};return data;}function Tooltip_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-direction: column;\n  opacity: 0.95;\n  text-align: center;\n  font-family: arial;\n  font-size: 12px;\n  color: white;\n  background-color: black;\n  border-radius: 7px;\n  padding: 3px 8px 8px 8px;\n  border: 1px solid #121212;\n  filter: brightness(1);\n  cursor: initial;\n"]);Tooltip_templateObject=function _templateObject(){return data;};return data;}var TooltipContainer=styled_components_browser_esm["b" /* default */].div(Tooltip_templateObject());var Tooltip=Object(styled_components_browser_esm["b" /* default */])(TooltipContainer)(Tooltip_templateObject2());var RelativeTooltipContainer=Object(styled_components_browser_esm["b" /* default */])(Tooltip)(Tooltip_templateObject3(),function(props){return Object.keys(props.position).reduce(function(style,key){return style+"\n"+key+":"+props.position[key]+"px;";},"");});var TooltipValue=styled_components_browser_esm["b" /* default */].div(Tooltip_templateObject4(),Colors_namespaceObject.lightBlue);var Tooltip_RelativeTooltip=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(RelativeTooltip,_React$Component);function RelativeTooltip(){Object(classCallCheck["a" /* default */])(this,RelativeTooltip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RelativeTooltip).apply(this,arguments));}Object(createClass["a" /* default */])(RelativeTooltip,[{key:"render",value:function render(){var _this$props=this.props,element=_this$props.element,children=_this$props.children,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["element","children"]);var getPosition=function getPosition(element){var boundingBox=element.getBoundingClientRect?element.getBoundingClientRect():element.get(0).getBoundingClientRect();var position={};if(boundingBox.top>window.innerHeight/2){position.bottom=32;}else{position.top=32;}if(boundingBox.left>window.innerWidth/2){position.right=0;}else{position.left=0;}return position;};return react["createElement"](RelativeTooltipContainer,Object.assign({position:getPosition(element)},rest),children);}}]);return RelativeTooltip;}(react["Component"]);var TooltipHeader=styled_components_browser_esm["b" /* default */].div(Tooltip_templateObject5());var TooltipSubHeader=styled_components_browser_esm["b" /* default */].div(Tooltip_templateObject6());var TooltipValueHeader=styled_components_browser_esm["b" /* default */].div(Tooltip_templateObject7());var TooltipEntry=styled_components_browser_esm["b" /* default */].div(Tooltip_templateObject8(),function(props){return props.noMargin&&"margin: 0;";},function(props){return props.important?"bold":"inherit";},function(props){return props.important?"14px":"11px";},function(props){return props.space&&"margin-top: 14px";},function(props){return props.clickable&&Object(styled_components_browser_esm["a" /* css */])(Tooltip_templateObject9(),tooltipButtonColor);},function(props){return props.clickable&&Object(styled_components_browser_esm["a" /* css */])(Tooltip_templateObject10());});var CenteredTooltipEntry=Object(styled_components_browser_esm["b" /* default */])(TooltipEntry)(Tooltip_templateObject11(),TooltipValueHeader);var InlineTooltipEntry=styled_components_browser_esm["b" /* default */].div(_templateObject12());var TooltipMenu=styled_components_browser_esm["b" /* default */].div(_templateObject13());var selectedTooltipButton=Object(styled_components_browser_esm["a" /* css */])(_templateObject14());var disabledTooltipButton=Object(styled_components_browser_esm["a" /* css */])(_templateObject15());var hoverTooltipButton=Object(styled_components_browser_esm["a" /* css */])(_templateObject16());var TooltipButton=styled_components_browser_esm["b" /* default */].button(_templateObject17(),function(props){return props.img&&"url(".concat(props.img,")");},function(props){return props.selected&&!props.disabled&&selectedTooltipButton;},function(props){return props.disabled&&disabledTooltipButton;},function(props){return!props.disabled&&hoverTooltipButton;},function(props){return props.disabled&&"fill:#ff0000;";});var Tooltip_buildTooltipEntries=function buildTooltipEntries(entries){var componentHandler=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var subKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var noMargin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;return entries.sort(function(a,b){if(!a.sort&&b.sort){return 1;}if(a.sort&&!b.sort){return-1;}if(a.sort>b.sort){return 1;}if(a.sort<b.sort){return-1;}return 0;}).map(function(_ref,index){var value=_ref.value,header=_ref.header,component=_ref.component,props=_ref.props;var isValue=function isValue(value){return value!==undefined&&value!==null;};if(value&&value.replace){value=value.replace(/<br>/gm,"\n");}if(component&&componentHandler){return componentHandler(component,props,"shiptoolitip-".concat(index,"-").concat(subKey));}return react["createElement"](TooltipEntry,{noMargin:subKey!==""||noMargin,key:"shiptoolitip-".concat(index,"-").concat(subKey)},header&&react["createElement"](TooltipValueHeader,null,header,": "),isValue(value)&&Array.isArray(value)&&react["createElement"](InlineTooltipEntry,null,buildTooltipEntries(value,componentHandler,subKey+"-"+index)),isValue(value)&&!Array.isArray(value)&&react["createElement"](TooltipValue,null,value));});};var SystemTooltip=Object(styled_components_browser_esm["b" /* default */])(Tooltip)(_templateObject18(),function(props){return props.right?"right: 340px;":"left: 340px;";},function(props){return props.tab&&"width: 302px;";});var Tooltip_RelativeOrStaticTooltip=function RelativeOrStaticTooltip(_ref2){var relative=_ref2.relative,children=_ref2.children,rest=Object(objectWithoutProperties["a" /* default */])(_ref2,["relative","children"]);if(relative){return react["createElement"](Tooltip_RelativeTooltip,rest,children);}return react["createElement"](SystemTooltip,rest,children);};
// CONCATENATED MODULE: ./src/client/styled/Button.js
function Button_templateObject7(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  height: 10px;\n  width: 10px;\n  padding: 0;\n  margin-left: 5px;\n\n  & svg {\n    width: 100%;\n    height: 100%;\n  }\n"]);Button_templateObject7=function _templateObject7(){return data;};return data;}function Button_templateObject6(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  cursor: pointer;\n  position: relative;\n  margin: 3px 5px;\n\n  ","\n"]);Button_templateObject6=function _templateObject6(){return data;};return data;}function Button_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 25px;\n  height: 25px;\n"]);Button_templateObject5=function _templateObject5(){return data;};return data;}function Button_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  text-transform: uppercase;\n  color: #0a3340;\n  border: 1px solid black;\n  background-color: #6792ce;\n  max-width: 240px;\n  justify-content: center;\n  box-shadow: 2px 3px 5px 2px rgba(0, 0, 0, 0.5);\n  border-radius: 1px;\n  padding: 3px;\n  font-weight: bold;\n  font-size: 16px;\n\n  &:hover,\n  &:active {\n    box-shadow: 0px 0px 3px 3px rgba(222, 235, 255, 0.5);\n    color: #0a3340;\n    background-color: #deebff;\n  }\n"]);Button_templateObject4=function _templateObject4(){return data;};return data;}function Button_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  border: 0;\n  padding: 3px;\n  font-weight: bold;\n  font-size: 16px;\n  background-color: transparent;\n\n  &:hover,\n  &:active {\n    color: #0a3340;\n  }\n"]);Button_templateObject3=function _templateObject3(){return data;};return data;}function Button_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  background-color: #222;\n  padding: 5px 0px;\n  color: white;\n  text-decoration: none;\n  font-family: arial;\n  font-size: 12px;\n  text-transform: uppercase;\n  display: flex;\n  flex-grow: 1;\n  flex-basis: 100%;\n  border: none;\n  margin: 0 8px;\n\n  flex-grow: 1;\n  flex-basis: calc(50% - 16px);\n\n  justify-content: center;\n\n  &:hover,\n  &:active {\n    background-color: #deebff;\n    color: black;\n    text-decoration: none;\n  }\n"]);Button_templateObject2=function _templateObject2(){return data;};return data;}function Button_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: inline;\n  border: none;\n  background-color: transparent;\n  color: #deebff;\n\n  &:hover,\n  &:active {\n    text-shadow: white 0 0 10px, white 0 0 3px;\n    opacity: 2;\n    color: #deebff;\n  }\n"]);Button_templateObject=function _templateObject(){return data;};return data;}var Button_text=Object(styled_components_browser_esm["a" /* css */])(Button_templateObject());var greyButton=Object(styled_components_browser_esm["a" /* css */])(Button_templateObject2());var iconStyle=Object(styled_components_browser_esm["a" /* css */])(Button_templateObject3());var Button_button=Object(styled_components_browser_esm["a" /* css */])(Button_templateObject4());var IconContainer=styled_components_browser_esm["b" /* default */].div(Button_templateObject5());var ButtonContainer=styled_components_browser_esm["b" /* default */].button(Button_templateObject6(),function(props){if(props.icon){return iconStyle;}switch(props.buttonStyle){case"text":return Button_text;case"button-grey":return greyButton;default:return Button_button;}});var Button_Button=function Button(props){return react_default.a.createElement(ButtonContainer,props,props.icon&&react_default.a.createElement(IconContainer,null,react_default.a.createElement(props.icon,{color:"#deebff"})),props.children);};var CloseButtonContainer=Object(styled_components_browser_esm["b" /* default */])(TooltipButton)(Button_templateObject7());var Button_CloseButton=function CloseButton(props){return react_default.a.createElement(CloseButtonContainer,props,react_default.a.createElement(icon_X,null));};
// CONCATENATED MODULE: ./src/client/styled/Link.js
function Link_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  text-decoration: none;\n  color: inherit;\n"]);Link_templateObject2=function _templateObject2(){return data;};return data;}function Link_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  text-decoration: none;\n  width: 100%;\n  display: flex;\n"]);Link_templateObject=function _templateObject(){return data;};return data;}var Link=Object(styled_components_browser_esm["b" /* default */])(react_router_dom["b" /* Link */])(Link_templateObject());var LinkInline=Object(styled_components_browser_esm["b" /* default */])(react_router_dom["b" /* Link */])(Link_templateObject2());
// CONCATENATED MODULE: ./src/client/styled/index.js

// CONCATENATED MODULE: ./src/client/view/game/ui/electronicWarfare/OEWButtons.js
function OEWButtons_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 25px;\n  height: 25px;\n"]);OEWButtons_templateObject4=function _templateObject4(){return data;};return data;}function OEWButtons_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n  padding: 0 5px 0 30px;\n  width: 200px;\n  overflow: hidden;\n"]);OEWButtons_templateObject3=function _templateObject3(){return data;};return data;}function OEWButtons_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: white;\n  font-size: 18px;\n  font-weight: bold;\n  font-family: arial;\n  font-size: 16px;\n  text-transform: uppercase;\n"]);OEWButtons_templateObject2=function _templateObject2(){return data;};return data;}function OEWButtons_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  align-items: center;\n"]);OEWButtons_templateObject=function _templateObject(){return data;};return data;}var OEWButtons_Container=styled_components_browser_esm["b" /* default */].div(OEWButtons_templateObject());var Text=Object(styled_components_browser_esm["a" /* css */])(OEWButtons_templateObject2());var ShipName=styled_components_browser_esm["b" /* default */].div(OEWButtons_templateObject3(),Text);var Amount=styled_components_browser_esm["b" /* default */].div(OEWButtons_templateObject4(),Text);var OEWButtons_OEWButtons=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(OEWButtons,_React$PureComponent);function OEWButtons(){Object(classCallCheck["a" /* default */])(this,OEWButtons);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OEWButtons).apply(this,arguments));}Object(createClass["a" /* default */])(OEWButtons,[{key:"render",value:function render(){var _this$props=this.props,name=_this$props.name,ship=_this$props.ship,target=_this$props.target,uiState=_this$props.uiState,oew=_this$props.oew;return react["createElement"](OEWButtons_Container,null,name&&react["createElement"](ShipName,null,name),react["createElement"](TooltipButton,{img:"/img/removeOEW.png",onClick:function onClick(){if(ship.electronicWarfare.canAssignOffensiveEw(target,-1)){ship.electronicWarfare.assignOffensiveEw(target,-1);uiState.shipStateChanged(ship);}}}),react["createElement"](Amount,null,oew),react["createElement"](TooltipButton,{img:"/img/addOEW.png",onClick:function onClick(){if(ship.electronicWarfare.canAssignOffensiveEw(target,1)){ship.electronicWarfare.assignOffensiveEw(target,1);uiState.shipStateChanged(ship);}}}));}}]);return OEWButtons;}(react["PureComponent"]);/* harmony default export */ var electronicWarfare_OEWButtons = (OEWButtons_OEWButtons);
// CONCATENATED MODULE: ./src/client/view/game/ui/GamePositionComponent.js
function GamePositionComponent_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  top: 0px;\n  left: 0px;\n"]);GamePositionComponent_templateObject=function _templateObject(){return data;};return data;}var GamePositionComponent_Container=styled_components_browser_esm["b" /* default */].div(GamePositionComponent_templateObject());var GamePositionComponent_GamePositionComponent=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(GamePositionComponent,_React$Component);function GamePositionComponent(props){var _this;Object(classCallCheck["a" /* default */])(this,GamePositionComponent);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GamePositionComponent).call(this,props));_this.containerRef=react["createRef"]();_this.renderCallback=_this.onGameRender.bind(Object(assertThisInitialized["a" /* default */])(_this));_this.position=null;_this.state={position:null};return _this;}Object(createClass["a" /* default */])(GamePositionComponent,[{key:"onGameRender",value:function onGameRender(){var _this$props=this.props,getPosition=_this$props.getPosition,_this$props$marginTop=_this$props.marginTop,marginTop=_this$props$marginTop===void 0?0:_this$props$marginTop,_this$props$marginLef=_this$props.marginLeft,marginLeft=_this$props$marginLef===void 0?0:_this$props$marginLef;if(!this.containerRef.current){return;}var newPosition=getPosition();if(!this.position||this.position.x!==newPosition.x||this.position.y!==newPosition.y){this.position=newPosition;this.containerRef.current.style.left="".concat(newPosition.x+marginLeft,"px");this.containerRef.current.style.top="".concat(newPosition.y+marginTop,"px");}}},{key:"componentDidMount",value:function componentDidMount(){var uiState=this.props.uiState;uiState.subscribeToRender(this.renderCallback);}},{key:"componentWillUnmount",value:function componentWillUnmount(){var uiState=this.props.uiState;uiState.unsubscribeFromRender(this.renderCallback);}},{key:"render",value:function render(){var children=this.props.children;/*
    style={{
          top: position.y + marginTop + "px",
          left: position.x + marginLeft + "px"
        }}
        */return react["createElement"](GamePositionComponent_Container,{ref:this.containerRef},children);}}]);return GamePositionComponent;}(react["Component"]);/* harmony default export */ var ui_GamePositionComponent = (GamePositionComponent_GamePositionComponent);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemInfoWeaponTargeting.js
function SystemInfoWeaponTargeting_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: ",";\n"]);SystemInfoWeaponTargeting_templateObject5=function _templateObject5(){return data;};return data;}function SystemInfoWeaponTargeting_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: white;\n"]);SystemInfoWeaponTargeting_templateObject4=function _templateObject4(){return data;};return data;}function SystemInfoWeaponTargeting_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  text-align: left;\n  color: #5e85bc;\n  font-family: arial;\n  font-size: 11px;\n"]);SystemInfoWeaponTargeting_templateObject3=function _templateObject3(){return data;};return data;}function SystemInfoWeaponTargeting_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  z-index: 20000;\n  ","\n  width: ",";\n  text-align: left;\n  filter: brightness(1);\n"]);SystemInfoWeaponTargeting_templateObject2=function _templateObject2(){return data;};return data;}function SystemInfoWeaponTargeting_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  font-size: 12px;\n"]);SystemInfoWeaponTargeting_templateObject=function _templateObject(){return data;};return data;}var InfoHeader=Object(styled_components_browser_esm["b" /* default */])(TooltipHeader)(SystemInfoWeaponTargeting_templateObject());var SystemInfoTooltip=Object(styled_components_browser_esm["b" /* default */])(Tooltip)(SystemInfoWeaponTargeting_templateObject2(),function(props){return Object.keys(props.position).reduce(function(style,key){return style+"\n"+key+":"+props.position[key]+"px;";},"");},function(props){return props.ship?"300px":"200px";});var Entry=Object(styled_components_browser_esm["b" /* default */])(TooltipEntry)(SystemInfoWeaponTargeting_templateObject3());var Header=styled_components_browser_esm["b" /* default */].span(SystemInfoWeaponTargeting_templateObject4());var InfoValue=styled_components_browser_esm["b" /* default */].span(SystemInfoWeaponTargeting_templateObject5(),Colors_namespaceObject.lightBlue);var SystemInfoWeaponTargeting_SystemInfoWeaponTargeting=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(SystemInfoWeaponTargeting,_React$Component);function SystemInfoWeaponTargeting(){Object(classCallCheck["a" /* default */])(this,SystemInfoWeaponTargeting);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SystemInfoWeaponTargeting).apply(this,arguments));}Object(createClass["a" /* default */])(SystemInfoWeaponTargeting,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,system=_this$props.system,uiState=_this$props.uiState,target=_this$props.target,hitChance=_this$props.hitChance;return react["createElement"](react["Fragment"],null,react["createElement"](InfoHeader,null,"TARGET: ",target.name),react["createElement"](Entry,null,react["createElement"](Header,null,"Base hit change: "),react["createElement"](InfoValue,null,hitChance.baseToHit,"%")),react["createElement"](Entry,null,react["createElement"](Header,null,"Fire control: "),react["createElement"](InfoValue,null,"+",hitChance.fireControl," to hit")),react["createElement"](Entry,null,react["createElement"](Header,null,"Distance: "),react["createElement"](InfoValue,null,hitChance.distance," hexes,"," ",hitChance.outOfRange?"out of range":"".concat(Math.round(hitChance.rangeModifier)," to hit"))),react["createElement"](Entry,null,react["createElement"](Header,null,"Evasion: "),react["createElement"](InfoValue,null,"+".concat(hitChance.evasion*10,"% range penalty (").concat(Math.round(hitChance.evasionPenalty),")"))),react["createElement"](Entry,null,react["createElement"](Header,null,"OEW: "),react["createElement"](InfoValue,null,"+",hitChance.oew*5," to hit")),react["createElement"](Entry,null,react["createElement"](Header,null,"DEW: "),react["createElement"](InfoValue,null,"-",hitChance.dew*5," to hit")),react["createElement"](Entry,null,react["createElement"](Header,null,"Your evasion: "),react["createElement"](InfoValue,null,"".concat(hitChance.ownEvasionPenalty," to hit"))),hitChance.noLockPenalty!==0&&react["createElement"](Entry,null,react["createElement"](Header,null,"No lock on target: "),react["createElement"](InfoValue,null,"".concat(hitChance.noLockPenalty," to hit"))),react["createElement"](Entry,null,react["createElement"](Header,null,"FINAL HIT CHANCE: "),react["createElement"](InfoValue,null,hitChance.result,"%")));}}]);return SystemInfoWeaponTargeting;}(react["Component"]);/* harmony default export */ var system_SystemInfoWeaponTargeting = (SystemInfoWeaponTargeting_SystemInfoWeaponTargeting);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/cargo/CargoTooltip.js
function CargoTooltip_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 200px;\n"]);CargoTooltip_templateObject=function _templateObject(){return data;};return data;}var CargoTooltipContainer=Object(styled_components_browser_esm["b" /* default */])(Tooltip_RelativeOrStaticTooltip)(CargoTooltip_templateObject());var CargoTooltip_CargoTooltip=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(CargoTooltip,_React$Component);function CargoTooltip(){Object(classCallCheck["a" /* default */])(this,CargoTooltip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CargoTooltip).apply(this,arguments));}Object(createClass["a" /* default */])(CargoTooltip,[{key:"render",value:function render(){var _this$props=this.props,element=_this$props.element,cargo=_this$props.cargo,additionalContent=_this$props.additionalContent,absoluteTooltip=_this$props.absoluteTooltip;return react_default.a.createElement(CargoTooltipContainer,{relative:!absoluteTooltip,right:absoluteTooltip==="right",element:element},react_default.a.createElement(TooltipHeader,null,cargo.getDisplayName()),cargo.getCargoInfo().map(CargoTooltip_getEntry),additionalContent);}}]);return CargoTooltip;}(react_default.a.Component);var CargoTooltip_getEntry=function getEntry(_ref,i){var header=_ref.header,value=_ref.value;if(value.replace){value=value.replace(/<br>/gm,"\n");}return react_default.a.createElement(TooltipEntry,{key:"cargoTooltipEntry-".concat(header,"-").concat(i)},header&&react_default.a.createElement(TooltipValueHeader,null,header,": "),value&&react_default.a.createElement(TooltipValue,null,value));};/* harmony default export */ var cargo_CargoTooltip = (CargoTooltip_CargoTooltip);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/cargo/CargoItem.js
function CargoItem_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  margin: 0;\n  padding: 0;\n  ","\n"]);CargoItem_templateObject=function _templateObject(){return data;};return data;}var CargoItem_Container=styled_components_browser_esm["b" /* default */].div(CargoItem_templateObject(),function(props){return props.onClick&&"cursor: pointer;";});var CargoItem_CargoItem=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(CargoItem,_React$Component);function CargoItem(props){var _this;Object(classCallCheck["a" /* default */])(this,CargoItem);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CargoItem).call(this,props));_this.element=react_default.a.createRef();_this.state={mouseOveredCargo:null};return _this;}Object(createClass["a" /* default */])(CargoItem,[{key:"onCargoMouseOver",value:function onCargoMouseOver(event){var _this$props$handleMou=this.props.handleMouseOver,handleMouseOver=_this$props$handleMou===void 0?function(){}:_this$props$handleMou;event.stopPropagation();event.preventDefault();this.setState({mouseOveredCargo:this.element});handleMouseOver();}},{key:"onCargoMouseOut",value:function onCargoMouseOut(event){var _this$props$handleMou2=this.props.handleMouseOut,handleMouseOut=_this$props$handleMou2===void 0?function(){}:_this$props$handleMou2;event.stopPropagation();event.preventDefault();this.setState({mouseOveredCargo:null});handleMouseOut();}},{key:"render",value:function render(){var _this2=this;var _this$props=this.props,cargo=_this$props.cargo,amount=_this$props.amount,_this$props$handleOnC=_this$props.handleOnClick,handleOnClick=_this$props$handleOnC===void 0?function(){}:_this$props$handleOnC,tooltipAdditionalContent=_this$props.tooltipAdditionalContent,text=_this$props.text,absoluteTooltip=_this$props.absoluteTooltip,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["cargo","amount","handleOnClick","tooltipAdditionalContent","text","absoluteTooltip"]);var mouseOveredCargo=this.state.mouseOveredCargo;return react_default.a.createElement(react_default.a.Fragment,null,absoluteTooltip&&mouseOveredCargo&&react_default.a.createElement(cargo_CargoTooltip,{absoluteTooltip:absoluteTooltip,element:mouseOveredCargo,cargo:cargo,additionalContent:tooltipAdditionalContent}),react_default.a.createElement(CargoItem_Container,Object.assign({onClick:handleOnClick,onMouseOver:this.onCargoMouseOver.bind(this),onMouseOut:this.onCargoMouseOut.bind(this)},rest),!absoluteTooltip&&mouseOveredCargo&&react_default.a.createElement(cargo_CargoTooltip,{absoluteTooltip:absoluteTooltip,element:mouseOveredCargo,cargo:cargo,additionalContent:tooltipAdditionalContent}),react_default.a.createElement(styled_IconAndLabel,{ref:function ref(c){return _this2.element=c;},background:cargo.getBackgroundImage()},text?text:amount)));}}]);return CargoItem;}(react_default.a.Component);/* harmony default export */ var cargo_CargoItem = (CargoItem_CargoItem);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/cargo/CargoList.js
function CargoList_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n"]);CargoList_templateObject=function _templateObject(){return data;};return data;}var CargoListContainer=styled_components_browser_esm["b" /* default */].div(CargoList_templateObject());var CargoList_CargoList=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(CargoList,_React$Component);function CargoList(){Object(classCallCheck["a" /* default */])(this,CargoList);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CargoList).apply(this,arguments));}Object(createClass["a" /* default */])(CargoList,[{key:"onSystemMouseOver",value:function onSystemMouseOver(event){event.stopPropagation();event.preventDefault();var _this$props=this.props,uiState=_this$props.uiState,system=_this$props.system,ship=_this$props.ship;uiState.customEvent("systemMouseOver",{ship:ship,system:system,element:this.element});this.setState({mouseOveredSystem:this.element});}},{key:"onSystemMouseOut",value:function onSystemMouseOut(event){event.stopPropagation();event.preventDefault();var uiState=this.props.uiState;uiState.customEvent("systemMouseOut");this.setState({mouseOveredSystem:null});}},{key:"render",value:function render(){var list=this.props.list;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipSubHeader,null,"Current cargo"),react_default.a.createElement(CargoListContainer,null,list.map(function(_ref,i){var object=_ref.object,amount=_ref.amount;return react_default.a.createElement(cargo_CargoItem,{key:"cargo-item-".concat(i),cargo:object,amount:amount});})));}}]);return CargoList;}(react_default.a.Component);/* harmony default export */ var cargo_CargoList = (CargoList_CargoList);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/torpedo/TorpedoLauncher.js
function TorpedoLauncher_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  "," {\n    ","\n  }\n"]);TorpedoLauncher_templateObject2=function _templateObject2(){return data;};return data;}function TorpedoLauncher_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n"]);TorpedoLauncher_templateObject=function _templateObject(){return data;};return data;}var TorpedoList=styled_components_browser_esm["b" /* default */].div(TorpedoLauncher_templateObject());var TorpedoCargoItem=Object(styled_components_browser_esm["b" /* default */])(cargo_CargoItem)(TorpedoLauncher_templateObject2(),styled_IconAndLabel,function(props){var target=props.target;if(target){return"filter: hue-rotate(0deg) brightness(4) grayscale(0);";}});var TorpedoLauncher_TorpedoLauncher=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(TorpedoLauncher,_React$PureComponent);function TorpedoLauncher(){Object(classCallCheck["a" /* default */])(this,TorpedoLauncher);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoLauncher).apply(this,arguments));}Object(createClass["a" /* default */])(TorpedoLauncher,[{key:"systemChangedCallback",value:function systemChangedCallback(ship,system){if(ship.id===this.props.ship.id&&system.id===this.props.launcher.system.id){this.forceUpdate();}}},{key:"componentDidMount",value:function componentDidMount(){var uiState=this.props.uiState;this.systemChangedCallbackInstance=this.systemChangedCallback.bind(this);uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);}},{key:"componentWillUnmount",value:function componentWillUnmount(){var uiState=this.props.uiState;uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);}},{key:"unloadAmmo",value:function unloadAmmo(){var _this=this;return function(e){e.preventDefault();e.stopPropagation();var _this$props=_this.props,ship=_this$props.ship,launcher=_this$props.launcher,uiState=_this$props.uiState,launcherIndex=_this$props.launcherIndex;launcher.unloadAmmo({launcherIndex:launcherIndex});uiState.shipSystemStateChanged(ship,launcher.system);};}},{key:"loadTorpedo",value:function loadTorpedo(torpedo){var _this2=this;return function(e){e.preventDefault();e.stopPropagation();var _this2$props=_this2.props,ship=_this2$props.ship,launcher=_this2$props.launcher,uiState=_this2$props.uiState,launcherIndex=_this2$props.launcherIndex;launcher.loadAmmo({ammo:torpedo,launcherIndex:launcherIndex});uiState.shipSystemStateChanged(ship,launcher.system);};}},{key:"torpedoMouseOut",value:function torpedoMouseOut(ship,torpedo){var _this3=this;return function(){var uiState=_this3.props.uiState;uiState.customEvent("torpedoMouseOut",{ship:ship,torpedo:torpedo});};}},{key:"torpedoMouseOver",value:function torpedoMouseOver(ship,torpedo){var _this4=this;return function(){var uiState=_this4.props.uiState;uiState.customEvent("torpedoMouseOver",{ship:ship,torpedo:torpedo,target:_this4.getLoadedTorpedoTarget()});};}},{key:"getLoadedTorpedoTarget",value:function getLoadedTorpedoTarget(){var _this$props2=this.props,loadedTorpedo=_this$props2.loadedTorpedo,launcher=_this$props2.launcher,uiState=_this$props2.uiState;if(!loadedTorpedo){return null;}var targetId=launcher.launchTarget;if(!targetId){return null;}var gameData=uiState.gameData;return gameData.ships.getShipById(targetId);}},{key:"render",value:function render(){var _this5=this;var _this$props3=this.props,launcherIndex=_this$props3.launcherIndex,loadedTorpedo=_this$props3.loadedTorpedo,loadingTime=_this$props3.loadingTime,turnsLoaded=_this$props3.turnsLoaded,launcher=_this$props3.launcher;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipHeader,null,"Torpedo tube ",launcherIndex),react_default.a.createElement(InlineTooltipEntry,null,react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Loading: "),react_default.a.createElement(TooltipValue,null,"".concat(turnsLoaded,"/").concat(loadingTime))),react_default.a.createElement(InlineTooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Loaded torpedo:"),react_default.a.createElement(TorpedoCargoItem,{cargo:loadedTorpedo?loadedTorpedo:new ammunition_NoAmmunitionLoaded(),amount:null,target:this.getLoadedTorpedoTarget(),handleMouseOver:this.torpedoMouseOver(launcher.system.shipSystems.ship,loadedTorpedo).bind(this),handleMouseOut:this.torpedoMouseOut(launcher.system.shipSystems.ship,loadedTorpedo).bind(this)}))),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Select torpedo to load: ")),react_default.a.createElement(TorpedoList,null,launcher.getPossibleTorpedosToLoad().map(function(_ref,i){var object=_ref.object,amount=_ref.amount;return react_default.a.createElement(cargo_CargoItem,{handleOnClick:_this5.loadTorpedo(object).bind(_this5),key:"torpedo-launcer-".concat(i,"-possible-torpedo-").concat(object.constructor.name),cargo:object,amount:amount,handleMouseOver:_this5.torpedoMouseOver(launcher.system.shipSystems.ship,object).bind(_this5),handleMouseOut:_this5.torpedoMouseOut(launcher.system.shipSystems.ship,object).bind(_this5)});}),loadedTorpedo&&react_default.a.createElement(cargo_CargoItem,{handleOnClick:this.unloadAmmo().bind(this),key:"torpedo-launcer-unload",cargo:new ammunition_NoAmmunitionLoaded(),amount:null})));}}]);return TorpedoLauncher;}(react_default.a.PureComponent);/* harmony default export */ var torpedo_TorpedoLauncher = (TorpedoLauncher_TorpedoLauncher);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/ammo/Ammo.js
function Ammo_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 20px;\n  height: 20px;\n"]);Ammo_templateObject4=function _templateObject4(){return data;};return data;}function Ammo_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  justify-content: flex-start;\n"]);Ammo_templateObject3=function _templateObject3(){return data;};return data;}function Ammo_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  align-items: center;\n"]);Ammo_templateObject2=function _templateObject2(){return data;};return data;}function Ammo_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n"]);Ammo_templateObject=function _templateObject(){return data;};return data;}var LoadingList=styled_components_browser_esm["b" /* default */].div(Ammo_templateObject());var NewTargetContainer=styled_components_browser_esm["b" /* default */].div(Ammo_templateObject2());var MagazineTooltipEntry=Object(styled_components_browser_esm["b" /* default */])(InlineTooltipEntry)(Ammo_templateObject3());var LoadingButton=Object(styled_components_browser_esm["b" /* default */])(TooltipButton)(Ammo_templateObject4());var ammo_Ammo_Ammo=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(Ammo,_React$Component);function Ammo(props){var _this;Object(classCallCheck["a" /* default */])(this,Ammo);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Ammo).call(this,props));_this.state={loadingOpen:false};return _this;}Object(createClass["a" /* default */])(Ammo,[{key:"systemChangedCallback",value:function systemChangedCallback(ship,system){if(ship.id===this.props.ship.id&&system.id===this.props.ammoStrategy.system.id){this.forceUpdate();}}},{key:"componentDidMount",value:function componentDidMount(){var uiState=this.props.uiState;this.systemChangedCallbackInstance=this.systemChangedCallback.bind(this);uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);}},{key:"componentWillUnmount",value:function componentWillUnmount(){var uiState=this.props.uiState;uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);}},{key:"getNewLoadOutButtons",value:function getNewLoadOutButtons(){var _this2=this;var _this$props=this.props,ammoStrategy=_this$props.ammoStrategy,uiState=_this$props.uiState,ship=_this$props.ship;var loadingTarget=ammoStrategy.getLoadingTarget();ammoStrategy.ammunitionClasses.filter(function(className){return!loadingTarget.find(function(entry){return entry.object instanceof className;});}).forEach(function(notFound){loadingTarget.push({object:new notFound(),amount:0});});loadingTarget.sort(function(a,b){if(a.object.constructor.name>b.object.constructor.name){return 1;}if(a.object.constructor.name<b.object.constructor.name){return-1;}return 0;});return react_default.a.createElement(LoadingList,null,loadingTarget.map(function(_ref,i){var object=_ref.object,amount=_ref.amount;return react_default.a.createElement(NewTargetContainer,{key:"new-loading-".concat(i)},react_default.a.createElement(LoadingButton,{img:"/img/minus.png",onClick:function onClick(e){e.preventDefault();e.stopPropagation();ammoStrategy.addToLoading({object:object,amount:-1});_this2.forceUpdate();}}),react_default.a.createElement(cargo_CargoItem,{key:"torpedo-launcer-".concat(i,"-possible-torpedo-").concat(object.constructor.name),cargo:object,amount:amount}),react_default.a.createElement(LoadingButton,{img:"/img/plus.png",onClick:function onClick(e){e.preventDefault();e.stopPropagation();ammoStrategy.addToLoading({object:object,amount:1});_this2.forceUpdate();}}));}));}},{key:"render",value:function render(){var _this3=this;var _this$props2=this.props,ammoStrategy=_this$props2.ammoStrategy,uiState=_this$props2.uiState,ship=_this$props2.ship;var loadingOpen=this.state.loadingOpen;if(!ship.player.isUsers(uiState.services.currentUser)){return null;}return react_default.a.createElement(react_default.a.Fragment,null,!loadingOpen&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipHeader,null,"AMMO MAGAZINE"),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Ammo needed to fire"),react_default.a.createElement(TooltipValue,null,ammoStrategy.ammoPerFireOrder)),react_default.a.createElement(MagazineTooltipEntry,null,react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Current ammo: "),react_default.a.createElement(TooltipValue,null,ammoStrategy.getSelectedAmmo().getShortDisplayName()))),react_default.a.createElement(MagazineTooltipEntry,null,react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Ammo in magazine: ")),ammoStrategy.getAmmoInMagazine().map(function(_ref2,i){var object=_ref2.object,amount=_ref2.amount;return react_default.a.createElement(cargo_CargoItem,{key:"torpedo-launcer-".concat(i,"-possible-torpedo-").concat(object.constructor.name),cargo:object,amount:amount});})),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValue,null,"NOTE: Magazine reloaded only offline")),react_default.a.createElement(CenteredTooltipEntry,{clickable:true,onClick:function onClick(e){e.preventDefault();e.stopPropagation();_this3.setState({loadingOpen:true});}},react_default.a.createElement(TooltipValueHeader,null,"CLICK TO LOAD NEW AMMO"))),loadingOpen&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipHeader,null,"New loadout"),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValue,null,"NOTE: Magazine reloaded only offline")),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Cooldown before loading:"),react_default.a.createElement(TooltipValue,null,ammoStrategy.startLoadingAfter," turn(s)")),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Turns offline:"),react_default.a.createElement(TooltipValue,null,ammoStrategy.turnsOffline," turn(s)")),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Ammo transfer per turn:"),react_default.a.createElement(TooltipValue,null,ammoStrategy.intakeInTurn)),react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Magazine capacity:"),react_default.a.createElement(TooltipValue,null,"".concat(ammoStrategy.getLoadingTargetAmount(),"/").concat(ammoStrategy.capacity))),this.getNewLoadOutButtons(),react_default.a.createElement(CenteredTooltipEntry,{clickable:true,onClick:function onClick(e){e.preventDefault();e.stopPropagation();_this3.setState({loadingOpen:false});}},react_default.a.createElement(TooltipValueHeader,null,"CLOSE")),react_default.a.createElement(CenteredTooltipEntry,{clickable:true,onClick:function onClick(e){e.preventDefault();e.stopPropagation();ship.systems.getSystems().filter(function(system){return system.constructor===ammoStrategy.system.constructor;}).forEach(function(system){return system.callHandler("setNewLoadingTarget",ammoStrategy.getLoadingTarget());});_this3.setState({loadingOpen:false});}},react_default.a.createElement(TooltipValueHeader,null,"COPY FOR ALL WEAPONS"))));}}]);return Ammo;}(react_default.a.Component);/* harmony default export */ var ammo_Ammo = (ammo_Ammo_Ammo);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/range/RangePenalty.js
function RangePenalty_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 1%;\n  height: 100%;\n  background-image: url(\"/img/lightBluePixel.png\");\n  background-size: 100% ",";\n  background-repeat: no-repeat;\n  background-position: bottom 0 left 0;\n  opacity: 0.25;\n  filter: blur(1px);\n\n  &:hover {\n    opacity: 0.5;\n  }\n"]);RangePenalty_templateObject3=function _templateObject3(){return data;};return data;}function RangePenalty_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: calc(100% - 16px);\n  margin: 0 8px;\n  display: flex;\n  justify-content: space-between;\n"]);RangePenalty_templateObject2=function _templateObject2(){return data;};return data;}function RangePenalty_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  width: calc(100% - 16px);\n  height: 32px;\n  align-items: flex-end;\n  margin: 0 8px;\n"]);RangePenalty_templateObject=function _templateObject(){return data;};return data;}var RangeContainer=styled_components_browser_esm["b" /* default */].div(RangePenalty_templateObject());var RangeNumbersContainer=styled_components_browser_esm["b" /* default */].div(RangePenalty_templateObject2());var RangeStep=styled_components_browser_esm["b" /* default */].div(RangePenalty_templateObject3(),function(props){return"".concat(props.height,"%");});var RangePenalty_RangePenalty=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(RangePenalty,_React$Component);function RangePenalty(){Object(classCallCheck["a" /* default */])(this,RangePenalty);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RangePenalty).apply(this,arguments));}Object(createClass["a" /* default */])(RangePenalty,[{key:"render",/*
  constructor(props) {
    super(props);

    this.state = { mouseOveredStep: null };
  }
  systemChangedCallback(ship, system) {
    if (
      ship.id === this.props.ship.id &&
      system.id === this.props.rangeStrategy.system.id
    ) {
      this.forceUpdate();
    }
  }

  componentDidMount() {
    const { uiState } = this.props;
    this.systemChangedCallbackInstance = this.systemChangedCallback.bind(this);
    uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);
  }

  componentWillUnmount() {
    const { uiState } = this.props;
    uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);
  }
*/value:function render(){var rangeStrategy=this.props.rangeStrategy;var step=getMaxRange(rangeStrategy)/100;var steps=[];for(var i=0;i<100;i++){var rangePenalty=rangeStrategy.getRangeModifier({distance:i*step});steps.push({range:i,rangePenalty:rangePenalty,height:Math.abs(rangePenalty/200)*100});}return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Range penalty:")),react_default.a.createElement(RangeContainer,null,steps.map(function(entry,i){return react_default.a.createElement(RangeStep,{key:"rangestep-".concat(i),height:entry.height});})),react_default.a.createElement(RangeNumbersContainer,null,react_default.a.createElement(TooltipValue,null,"0"),react_default.a.createElement(TooltipValue,null,"distance"),react_default.a.createElement(TooltipValue,null,getMaxRange(rangeStrategy))));}}]);return RangePenalty;}(react_default.a.Component);var getMaxRange=function getMaxRange(rangeStrategy){var ranges=rangeStrategy.rangesAndPenalties;return ranges[ranges.length-1].range;};/* harmony default export */ var range_RangePenalty = (RangePenalty_RangePenalty);
// CONCATENATED MODULE: ./src/client/view/game/ui/HeatBar/Bar.js
function Bar_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border-right: 3px solid white;\n  margin: 0 1px;\n  background-color: transparent;\n  height: 100%;\n  z-index: 4;\n"]);Bar_templateObject5=function _templateObject5(){return data;};return data;}function Bar_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  background-color: ",";\n  z-index: ",";\n  ","\n"]);Bar_templateObject4=function _templateObject4(){return data;};return data;}function Bar_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  height: 8px;\n  margin: 1px;\n  width: ",";\n  background-color: ",";\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  bottom: 0px;\n  z-index: 2;\n"]);Bar_templateObject3=function _templateObject3(){return data;};return data;}function Bar_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n    width: 100%\n    border: 1px solid ",";\n    display: flex;\n    height: 10px;\n    position: relative;\n"]);Bar_templateObject2=function _templateObject2(){return data;};return data;}function Bar_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  width: 100%;\n"]);Bar_templateObject=function _templateObject(){return data;};return data;}var Bar_Container=styled_components_browser_esm["b" /* default */].div(Bar_templateObject());var BarContainer=styled_components_browser_esm["b" /* default */].div(Bar_templateObject2(),systemWindowPrimaryBorder);var Bar=styled_components_browser_esm["b" /* default */].div(Bar_templateObject3(),function(_ref){var percent=_ref.percent;return"calc(".concat(percent*100,"% - 2px);");},function(_ref2){var color=_ref2.color;return color;});var ChangeBar=Object(styled_components_browser_esm["b" /* default */])(Bar)(Bar_templateObject4(),function(_ref3){var more=_ref3.more,barDecreaseColor=_ref3.barDecreaseColor,barIncreaseColor=_ref3.barIncreaseColor;return more?barIncreaseColor:barDecreaseColor;},function(_ref4){var more=_ref4.more;return more?1:3;},function(_ref5){var more=_ref5.more,oldPercent=_ref5.oldPercent,percent=_ref5.percent;return!more&&"width:calc(".concat((oldPercent-percent)*100,"% - 2px); left:calc(").concat(percent*100,"% - 0px);");});var DividerBar=Object(styled_components_browser_esm["b" /* default */])(Bar)(Bar_templateObject5());var Bar_HeatBar=function HeatBar(_ref6){var percent=_ref6.percent,newPercent=_ref6.newPercent,_ref6$divider=_ref6.divider,divider=_ref6$divider===void 0?null:_ref6$divider,_ref6$barColor=_ref6.barColor,barColor=_ref6$barColor===void 0?hitpointsCritical:_ref6$barColor,_ref6$barDecreaseColo=_ref6.barDecreaseColor,barDecreaseColor=_ref6$barDecreaseColo===void 0?hitpoints:_ref6$barDecreaseColo,_ref6$barIncreaseColo=_ref6.barIncreaseColor,barIncreaseColor=_ref6$barIncreaseColo===void 0?red:_ref6$barIncreaseColo;if(percent>1){percent=1;}if(newPercent>1){newPercent=1;}if(newPercent<0){newPercent=0;}return react_default.a.createElement(Bar_Container,null,react_default.a.createElement(BarContainer,null,react_default.a.createElement(Bar,{percent:percent,color:barColor}),newPercent!==undefined&&react_default.a.createElement(ChangeBar,{percent:newPercent,oldPercent:percent,more:newPercent>percent,barDecreaseColor:barDecreaseColor,barIncreaseColor:barIncreaseColor}),Boolean(divider)&&react_default.a.createElement(DividerBar,{percent:divider})));};var Bar_FuelBar=function FuelBar(props){return react_default.a.createElement(Bar_HeatBar,Object.assign({},props,{barColor:Colors_fuel,barIncreaseColor:hitpoints,barDecreaseColor:red}));};
// CONCATENATED MODULE: ./src/client/view/game/ui/HeatBar/SystemHeatBar.js
function SystemHeatBar_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])([""]);SystemHeatBar_templateObject2=function _templateObject2(){return data;};return data;}function SystemHeatBar_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  "," {\n    margin-left: 0;\n  }\n"]);SystemHeatBar_templateObject=function _templateObject(){return data;};return data;}var SystemHeatBar_Container=styled_components_browser_esm["b" /* default */].div(SystemHeatBar_templateObject(),TooltipEntry);var HeatBarContainer=styled_components_browser_esm["b" /* default */].div(SystemHeatBar_templateObject2());var SystemHeatBar_SystemHeatBar=function SystemHeatBar(_ref){var className=_ref.className,system=_ref.system,currentOverheat=_ref.currentOverheat,prediction=_ref.prediction;var _useState=Object(react["useState"])(false),_useState2=Object(slicedToArray["a" /* default */])(_useState,2),details=_useState2[0],setDetails=_useState2[1];var overheat=prediction.overheat,overheatPercentage=prediction.overheatPercentage,cooling=prediction.cooling,overHeatThreshold=prediction.overHeatThreshold,newHeat=prediction.newHeat,maximumPossibleOverheatReduction=prediction.maximumPossibleOverheatReduction,maxCooling=prediction.maxCooling;var messages=Object(react["useMemo"])(function(){return details?[{header:"Predicted cooling",value:"".concat(Math.round(cooling),"/").concat(Math.round(maxCooling))},{header:"Predicted heat generation",value:Math.round(newHeat)},{header:"Predicted overheat",value:"".concat(Math.round(overheat)," (").concat(Math.round(overheatPercentage*100),"%)")},{header:"Maximum overheat cooling",value:"".concat(Math.round(maximumPossibleOverheatReduction*100),"%")}]:[];},[details,prediction]);return react_default.a.createElement(SystemHeatBar_Container,null,react_default.a.createElement(InlineTooltipEntry,null,react_default.a.createElement(TooltipEntry,{noMargin:true},react_default.a.createElement(TooltipValueHeader,null,"Overheat: "),react_default.a.createElement(TooltipValue,null,"".concat(formatNumber(system.heat.getOverheat()),"/").concat(formatNumber(overHeatThreshold)," (").concat(Math.round(system.heat.getOverheatPercentage()*100),"%)"))),react_default.a.createElement(TooltipEntry,{noMargin:true},react_default.a.createElement(HeaderMenuItem,{onClick:function onClick(){return setDetails(!details);},active:details},"?"))),react_default.a.createElement(HeatBarContainer,null,react_default.a.createElement(Bar_HeatBar,{className:className,percent:currentOverheat*0.5,newPercent:overheatPercentage*0.5,divider:0.5})),Tooltip_buildTooltipEntries(messages,null,""));};/* harmony default export */ var HeatBar_SystemHeatBar = (SystemHeatBar_SystemHeatBar);
// CONCATENATED MODULE: ./src/client/view/game/ui/HeatBar/SystemFuelBar.js
function SystemFuelBar_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-grow: 1;\n"]);SystemFuelBar_templateObject2=function _templateObject2(){return data;};return data;}function SystemFuelBar_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  margin: 0 8px;\n\n  "," {\n    display: flex;\n    flex-grow: 1;\n    margin-left: 0;\n    margin-right: 0;\n  }\n"]);SystemFuelBar_templateObject=function _templateObject(){return data;};return data;}var SystemFuelBar_Container=styled_components_browser_esm["b" /* default */].div(SystemFuelBar_templateObject(),TooltipEntry);var FuelBarContainer=styled_components_browser_esm["b" /* default */].div(SystemFuelBar_templateObject2());var SystemFuelBar_SystemFuelBar=function SystemFuelBar(_ref){var space=_ref.space,fuel=_ref.fuel;var percent=fuel/space;return react_default.a.createElement(SystemFuelBar_Container,null,react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipValueHeader,null,"Fuel: "),react_default.a.createElement(TooltipValue,null,"".concat(fuel,"/").concat(space))),react_default.a.createElement(FuelBarContainer,null,react_default.a.createElement(Bar_FuelBar,{percent:percent})));};/* harmony default export */ var HeatBar_SystemFuelBar = (SystemFuelBar_SystemFuelBar);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/SystemStrategyUiComponent.js
var SystemStrategyUiComponent_SystemStrategyUiComponent=function SystemStrategyUiComponent(_ref){var name=_ref.name,props=Object(objectWithoutProperties["a" /* default */])(_ref,["name"]);switch(name){case"RangePenalty":return react_default.a.createElement(range_RangePenalty,props);case"Ammo":return react_default.a.createElement(ammo_Ammo,props);case"CargoList":return react_default.a.createElement(cargo_CargoList,props);case"TorpedoLauncher":return react_default.a.createElement(torpedo_TorpedoLauncher,props);case"SystemHeatBar":return react_default.a.createElement(HeatBar_SystemHeatBar,props);case"SystemFuelBar":return react_default.a.createElement(HeatBar_SystemFuelBar,props);default:throw Error("SystemUiComponent \"".concat(name,"\" not found"));}};/* harmony default export */ var SystemStrategyUi_SystemStrategyUiComponent = (SystemStrategyUiComponent_SystemStrategyUiComponent);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemStrategyUi/index.js
var SystemStrategyUi_SystemStrategyUi=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(SystemStrategyUi,_React$Component);function SystemStrategyUi(){Object(classCallCheck["a" /* default */])(this,SystemStrategyUi);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SystemStrategyUi).apply(this,arguments));}Object(createClass["a" /* default */])(SystemStrategyUi,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,uiState=_this$props.uiState,system=_this$props.system;var currentUser=uiState.services.currentUser;var myShip=ship.player.is(currentUser);return system.callHandler("getUiComponents",{myShip:myShip},[]).map(function(_ref,i){var name=_ref.name,props=_ref.props;return react_default.a.createElement(SystemStrategyUi_SystemStrategyUiComponent,Object.assign({key:"system-stragey-".concat(name,"-").concat(system.id,"-").concat(i),uiState:uiState,ship:ship,system:system,name:name},props));});}}]);return SystemStrategyUi;}(react_default.a.Component);/* harmony default export */ var system_SystemStrategyUi = (SystemStrategyUi_SystemStrategyUi);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemInfo.js
function SystemInfo_templateObject6(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  overflow-y: scroll;\n  scrollbar-width: 0;\n\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"]);SystemInfo_templateObject6=function _templateObject6(){return data;};return data;}function SystemInfo_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin: 0 8px;\n  position: relative;\n"]);SystemInfo_templateObject5=function _templateObject5(){return data;};return data;}function SystemInfo_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  cursor: pointer;\n  font-weight: bolder;\n  margin-right: 4px;\n  font-size: 12px;\n\n  ","\n  &:last-child {\n    margin: 0;\n  }\n  :hover {\n    color: white;\n  }\n"]);SystemInfo_templateObject4=function _templateObject4(){return data;};return data;}function SystemInfo_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  line-height: 14px;\n  display: flex;\n  flex-direction: row;\n  color: #5e85bc;\n"]);SystemInfo_templateObject3=function _templateObject3(){return data;};return data;}function SystemInfo_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: ",";\n  font-weight: bold;\n\n  animation: blinker 2s linear infinite;\n\n  @keyframes blinker {\n    50% {\n      opacity: 0.5;\n    }\n  }\n"]);SystemInfo_templateObject2=function _templateObject2(){return data;};return data;}function SystemInfo_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  max-height: 85vh;\n"]);SystemInfo_templateObject=function _templateObject(){return data;};return data;}var SystemInfo_TooltipContainer=Object(styled_components_browser_esm["b" /* default */])(Tooltip_RelativeOrStaticTooltip)(SystemInfo_templateObject());var Warning=styled_components_browser_esm["b" /* default */].div(SystemInfo_templateObject2(),Colors_namespaceObject.textDanger);var HeaderMenu=styled_components_browser_esm["b" /* default */].div(SystemInfo_templateObject3());var HeaderMenuItem=styled_components_browser_esm["b" /* default */].div(SystemInfo_templateObject4(),function(props){return props.active&&"color: white;";});var SystemStrategyUiComponentContainer=styled_components_browser_esm["b" /* default */].div(SystemInfo_templateObject5());var LogContainer=styled_components_browser_esm["b" /* default */].div(SystemInfo_templateObject6());var SystemInfo_SystemInfo=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(SystemInfo,_React$Component);function SystemInfo(props){var _this;Object(classCallCheck["a" /* default */])(this,SystemInfo);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SystemInfo).call(this,props));_this.state={tab:null};return _this;}Object(createClass["a" /* default */])(SystemInfo,[{key:"systemChangedCallback",value:function systemChangedCallback(ship,system){if(ship.id===this.props.ship.id&&system.id===this.props.system.id){this.forceUpdate();}}},{key:"componentDidMount",value:function componentDidMount(){var uiState=this.props.uiState;this.systemChangedCallbackInstance=this.systemChangedCallback.bind(this);uiState.subscribeToSystemChange(this.systemChangedCallbackInstance);}},{key:"componentWillUnmount",value:function componentWillUnmount(){var uiState=this.props.uiState;uiState.unsubscribeFromSystemChange(this.systemChangedCallbackInstance);}},{key:"getWarnings",value:function getWarnings(){var system=this.props.system;var warnings=[];if(system.isDestroyed()){warnings.push("DESTROYED");}if(system.power.isOffline()){warnings.push("OFFLINE");}var criticals=system.damage.getCriticals().map(function(critical){return critical.getMessage();});return[].concat(warnings,Object(toConsumableArray["a" /* default */])(criticals)).join(", ");}},{key:"getComponentHandler",value:function getComponentHandler(){var _this$props=this.props,system=_this$props.system,uiState=_this$props.uiState,ship=_this$props.ship;return function(component,props,key){return react["createElement"](SystemStrategyUiComponentContainer,{key:key},react["createElement"](SystemStrategyUi_SystemStrategyUiComponent,Object.assign({name:component,system:system,uiState:uiState,ship:ship},props)));};}},{key:"getInfoTab",value:function getInfoTab(){var system=this.props.system;return Tooltip_buildTooltipEntries([{value:system.getSystemDescription()}]);}},{key:"getLogTab",value:function getLogTab(){var system=this.props.system;var messages=system.log.getWithTurns();return messages.reverse().map(function(_ref,index){var turn=_ref.turn,messages=_ref.messages;return react["createElement"](LogContainer,{key:"systemlog-turn-".concat(turn,"-").concat(index)},react["createElement"](TooltipSubHeader,null,"Log, turn ".concat(turn)),messages.map(function(message,messageIndex){return react["createElement"](TooltipEntry,{key:"logmessage-".concat(turn,"-").concat(index,"-").concat(messageIndex)},react["createElement"](TooltipValue,null,message));}));});}},{key:"getDefaultTab",value:function getDefaultTab(){var _this$props2=this.props,ship=_this$props2.ship,system=_this$props2.system,systemInfoMenuProvider=_this$props2.systemInfoMenuProvider,uiState=_this$props2.uiState,weaponTargeting=_this$props2.weaponTargeting;var Menu=systemInfoMenuProvider?systemInfoMenuProvider():null;var warnings=this.getWarnings();return react["createElement"](react["Fragment"],null,Menu&&react["createElement"](Menu,{uiState:uiState,ship:ship,system:system}),warnings&&react["createElement"](TooltipEntry,null,react["createElement"](Warning,null,warnings)),Tooltip_buildTooltipEntries(system.getSystemInfo(ship),this.getComponentHandler()),react["createElement"](system_SystemStrategyUi,{ship:ship,system:system,uiState:uiState}),weaponTargeting&&react["createElement"](system_SystemInfoWeaponTargeting,{uiState:uiState,ship:ship,system:system,target:weaponTargeting.target,hitChance:weaponTargeting.hitChance}));}},{key:"render",value:function render(){var _this2=this;var _this$props3=this.props,system=_this$props3.system,element=_this$props3.element,scs=_this$props3.scs,right=_this$props3.right;var tab=this.state.tab;return react["createElement"](SystemInfo_TooltipContainer,{relative:!scs,element:element,right:right,onClick:function onClick(e){e.stopPropagation();e.preventDefault();}},react["createElement"](TooltipHeader,null,system.getDisplayName(),react["createElement"](HeaderMenu,null,react["createElement"](HeaderMenuItem,{active:tab==="log",onClick:function onClick(e){e.preventDefault();e.stopPropagation();_this2.setState({tab:"log"});}},"L"),react["createElement"](HeaderMenuItem,{active:tab==="info",onClick:function onClick(e){e.preventDefault();e.stopPropagation();_this2.setState({tab:"info"});}},"?"),react["createElement"](HeaderMenuItem,{active:!tab,onClick:function onClick(e){e.preventDefault();e.stopPropagation();_this2.setState({tab:null});}},"D"))),!tab&&this.getDefaultTab(),tab==="log"&&this.getLogTab(),tab==="info"&&this.getInfoTab());}}]);return SystemInfo;}(react["Component"]);/* harmony default export */ var system_SystemInfo = (SystemInfo_SystemInfo);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemIcon.js
function SystemIcon_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  cursor: pointer;\n  position: relative;\n  margin: 3px 0px;\n  padding: 0 1px;\n"]);SystemIcon_templateObject5=function _templateObject5(){return data;};return data;}function SystemIcon_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  opacity: 0.95;\n  background-image: url(/img/overheat.png);\n\n  ","\n"]);SystemIcon_templateObject4=function _templateObject4(){return data;};return data;}function SystemIcon_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  box-sizing: border-box;\n  width: 30px;\n  height: 30px;\n\n  background-color: \"transparent\";\n  background-image: ",";\n  background-size: cover;\n  filter: ",";\n  cursor: pointer;\n\n  "," {\n    display: ",";\n  }\n\n  ","\n\n  :before {\n    content: \"\";\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    opacity: ",";\n\n    background-color: transparent;\n\n    background-image: ",";\n  }\n"]);SystemIcon_templateObject3=function _templateObject3(){return data;};return data;}function SystemIcon_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  top: 0px;\n  width: 100%;\n  height: calc(100% - 5px);\n  font-family: arial;\n  font-size: 10px;\n  color: white;\n  display: flex;\n  ","\n  align-items: flex-end;\n  justify-content: center;\n  text-shadow: black 0 0 6px, black 0 0 6px, black 0 0 6px, black 0 0 6px;\n"]);SystemIcon_templateObject2=function _templateObject2(){return data;};return data;}function SystemIcon_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 7px;\n  border: 2px solid black;\n  box-sizing: border-box;\n\n  ","\n  background-color: #7a2020;\n\n  :before {\n    content: \"\";\n    position: absolute;\n    width: ",";\n    height: 100%;\n    left: 0;\n    bottom: 0;\n    background-color: ",";\n  }\n"]);SystemIcon_templateObject=function _templateObject(){return data;};return data;}var HealthBar=styled_components_browser_esm["b" /* default */].div(SystemIcon_templateObject(),function(props){return props.destroyed&&"display: none;";},function(props){return"".concat(props.health,"%");},function(props){return props.criticals?Colors_namespaceObject.hitpointsCritical:Colors_namespaceObject.hitpoints;});var SystemText=styled_components_browser_esm["b" /* default */].div(SystemIcon_templateObject2(),function(props){return props.destroyed&&"display: none;";});var System=styled_components_browser_esm["b" /* default */].div(SystemIcon_templateObject3(),function(props){return"url(".concat(props.background,")");},function(props){if(props.targeting){return"hue-rotate(0deg) brightness(4) grayscale(0)";}else if(props.reserved){return"hue-rotate(0deg) brightness(1) grayscale(0.7)";}else if(props.firing){return"hue-rotate(0deg) brightness(4) grayscale(0)";//"grayscale(100%) brightness(6) drop-shadow(0px 0px 5px white)";
}else if(props.destroyed){return"blur(1px) brightness(0.5)";}else{return"none";}},SystemText,function(props){return props.offline?"none":"flex";},function(_ref){var boosted=_ref.boosted;return boosted&&"\n    :before {\n      content: \"\";\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      opacity: 0.95;\n      background-image: url(/img/boosted.png);\n    ";},function(props){if(props.destroyed||props.offline||props.loading){return"0.8";}return"0";},function(props){if(props.offline){return"url(/img/offline.png)";}return"none";});var Overheat=styled_components_browser_esm["b" /* default */].div(SystemIcon_templateObject4(),function(_ref2){var overheat=_ref2.overheat;return overheat>=1&&"\n    animation: blinker 1s linear infinite;\n\n    @keyframes blinker {\n      50% {\n        opacity: 0.3;\n      }\n    }\n  ";});var SystemIcon_Container=styled_components_browser_esm["b" /* default */].div(SystemIcon_templateObject5());var SystemIcon_SystemIcon=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(SystemIcon,_React$Component);function SystemIcon(props){var _this;Object(classCallCheck["a" /* default */])(this,SystemIcon);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SystemIcon).call(this,props));_this.element=react["createRef"]();_this.state={mouseOveredSystem:null,clickedSystem:null};return _this;}Object(createClass["a" /* default */])(SystemIcon,[{key:"clickSystem",value:function clickSystem(event){event.stopPropagation();event.preventDefault();var _this$props=this.props,uiState=_this$props.uiState,system=_this$props.system,ship=_this$props.ship,scs=_this$props.scs;uiState.customEvent("systemClicked",{ship:ship,system:system,element:this.element,scs:scs});}},{key:"onSystemMouseOver",value:function onSystemMouseOver(event){event.stopPropagation();event.preventDefault();var _this$props2=this.props,uiState=_this$props2.uiState,system=_this$props2.system,ship=_this$props2.ship,target=_this$props2.target;var weaponFireService=uiState.services.weaponFireService;var gameData=uiState.gameData;if(!target){var targetId=weaponFireService.getSystemFireOrderTargetId(system);if(targetId){target=gameData.ships.getShipById(targetId);}}uiState.customEvent("systemMouseOver",{ship:ship,system:system,element:this.element,target:target});this.setState({mouseOveredSystem:this.element});}},{key:"onSystemMouseOut",value:function onSystemMouseOut(event){event.stopPropagation();event.preventDefault();var uiState=this.props.uiState;uiState.customEvent("systemMouseOut");this.setState({mouseOveredSystem:null});}},{key:"onContextMenu",value:function onContextMenu(e){e.stopPropagation();e.preventDefault();var _this$props3=this.props,uiState=_this$props3.uiState,system=_this$props3.system,ship=_this$props3.ship;uiState.customEvent("systemRightClicked",{system:system,ship:ship});}},{key:"render",value:function render(){var _this2=this;var _this$props4=this.props,uiState=_this$props4.uiState,system=_this$props4.system,ship=_this$props4.ship,scs=_this$props4.scs,destroyed=_this$props4.destroyed,_this$props4$systemMe=_this$props4.systemMenu;_this$props4$systemMe=_this$props4$systemMe===void 0?{systemInfoMenuProvider:null,activeSystem:null,activeSystemElement:null}:_this$props4$systemMe;var systemInfoMenuProvider=_this$props4$systemMe.systemInfoMenuProvider,activeSystem=_this$props4$systemMe.activeSystem,activeSystemElement=_this$props4$systemMe.activeSystemElement,_this$props4$onSystem=_this$props4.onSystemClicked,onSystemClicked=_this$props4$onSystem===void 0?this.clickSystem:_this$props4$onSystem,_this$props4$selected=_this$props4.selected,selected=_this$props4$selected===void 0?false:_this$props4$selected,_this$props4$text=_this$props4.text,text=_this$props4$text===void 0?null:_this$props4$text,_this$props4$target=_this$props4.target,target=_this$props4$target===void 0?null:_this$props4$target,rest=Object(objectWithoutProperties["a" /* default */])(_this$props4,["uiState","system","ship","scs","destroyed","systemMenu","onSystemClicked","selected","text","target"]);var mouseOveredSystem=this.state.mouseOveredSystem;var weaponFireService=uiState.services.weaponFireService;if(!text){text=system.getIconText();}var menu=activeSystem?systemInfoMenuProvider:null;var displayMenu=Boolean(!activeSystem&&mouseOveredSystem||activeSystem&&activeSystem===system&&activeSystemElement===this.element);var firing=weaponFireService.systemHasFireOrder(system);var reserved=target&&weaponFireService.systemHasFireOrder(system)&&!weaponFireService.systemHasFireOrderAgainstShip(system,target);var targeting=target&&weaponFireService.systemHasFireOrderAgainstShip(system,target);var disabled=system.isDisabled();var oldOverheat=system.heat.getOverheatPercentage();var _system$heat$predictH=system.heat.predictHeatChange(),newOverheat=_system$heat$predictH.overheatPercentage;var overheat=newOverheat>oldOverheat?newOverheat:oldOverheat;return react["createElement"](react["Fragment"],null,displayMenu&&scs&&react["createElement"](system_SystemInfo,Object.assign({scs:true,uiState:uiState,ship:ship,system:system,systemInfoMenuProvider:menu,element:mouseOveredSystem||activeSystemElement,target:target},rest)),react["createElement"](SystemIcon_Container,{onClick:onSystemClicked.bind(this),onMouseOver:this.onSystemMouseOver.bind(this),onMouseOut:this.onSystemMouseOut.bind(this),onContextMenu:this.onContextMenu.bind(this),scs:true},displayMenu&&!scs&&react["createElement"](system_SystemInfo,Object.assign({scs:true,uiState:uiState,ship:ship,system:system,systemInfoMenuProvider:menu,element:mouseOveredSystem||activeSystemElement,target:target},rest)),react["createElement"](System,{ref:function ref(c){return _this2.element=c;},scs:scs,background:system.getBackgroundImage(),offline:isOffline(ship,system),loading:isLoading(system),selected:selected,firing:firing,targeting:targeting,reserved:reserved,destroyed:system.isDestroyed(),boosted:system.callHandler("getBoost",0,false)},overheat>0.25&&Boolean(!disabled)&&react["createElement"](Overheat,{overheat:overheat})),react["createElement"](SystemText,{destroyed:system.isDestroyed(),selected:selected},text),react["createElement"](HealthBar,{destroyed:system.isDestroyed(),criticals:system.hasAnyCritical(),health:getStructureLeft(system)})));}}]);return SystemIcon;}(react["Component"]);var isLoading=function isLoading(system){return undefined;};//ASK FROM SYSTEM system.weapon && !weaponManager.isLoaded(system);
var isOffline=function isOffline(ship,system){return system.power.isOffline();};var getStructureLeft=function getStructureLeft(system){return(system.hitpoints-system.getTotalDamage())/system.hitpoints*100;};/* harmony default export */ var system_SystemIcon = (SystemIcon_SystemIcon);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/StructureIcon.js
function StructureIcon_templateObject6(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n  width: calc(100% - 4px);\n  height: 16px;\n  background-color: #081313;\n  color: ",";\n  font-family: arial;\n  font-size: 11px;\n  text-shadow: black 0 0 6px, black 0 0 6px;\n  margin: 1px;\n  filter: ",";\n  border: 1px solid black;\n\n  :before {\n    box-sizing: border-box;\n    content: \"\";\n    position: absolute;\n    width: ",";\n    height: 100%;\n    left: 0;\n    bottom: 0;\n    z-index: 0;\n    background-color: ",";\n  }\n"]);StructureIcon_templateObject6=function _templateObject6(){return data;};return data;}function StructureIcon_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  z-index: 1;\n"]);StructureIcon_templateObject5=function _templateObject5(){return data;};return data;}function StructureIcon_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  cursor: pointer;\n  position: relative;\n  margin: 3px 1px;\n"]);StructureIcon_templateObject4=function _templateObject4(){return data;};return data;}function StructureIcon_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  box-sizing: border-box;\n  width: 30px;\n  height: 30px;\n\n  background-color: \"transparent\";\n  background-image: ",";\n  background-size: cover;\n  filter: ",";\n  cursor: pointer;\n\n  "," {\n    display: ",";\n  }\n\n  :before {\n    content: \"\";\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    opacity: ",";\n\n    background-color: ",";\n\n    background-image: ",";\n  }\n"]);StructureIcon_templateObject3=function _templateObject3(){return data;};return data;}function StructureIcon_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  top: 0px;\n  width: 100%;\n  height: calc(100% - 5px);\n  font-family: arial;\n  font-size: 10px;\n  color: white;\n  display: flex;\n  align-items: flex-end;\n  justify-content: center;\n  text-shadow: black 0 0 6px, black 0 0 6px, black 0 0 6px, black 0 0 6px;\n"]);StructureIcon_templateObject2=function _templateObject2(){return data;};return data;}function StructureIcon_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 7px;\n  border: 2px solid black;\n  box-sizing: border-box;\n\n  background-color: #7a2020;\n\n  :before {\n    content: \"\";\n    position: absolute;\n    width: ",";\n    height: 100%;\n    left: 0;\n    bottom: 0;\n    background-color: ",";\n  }\n"]);StructureIcon_templateObject=function _templateObject(){return data;};return data;}var StructureIcon_HealthBar=styled_components_browser_esm["b" /* default */].div(StructureIcon_templateObject(),function(props){return"".concat(props.health,"%");},function(props){return props.criticals?"#ed6738":"#427231";});var StructureIcon_SystemText=styled_components_browser_esm["b" /* default */].div(StructureIcon_templateObject2());var StructureIcon_System=styled_components_browser_esm["b" /* default */].div(StructureIcon_templateObject3(),function(props){return"url(".concat(props.background,")");},function(props){if(props.targeting){return"hue-rotate(0deg) brightness(4) grayscale(0)";}else if(props.reserved){return"hue-rotate(0deg) brightness(1) grayscale(0.7)";}else if(props.firing){return"hue-rotate(0deg) brightness(4) grayscale(0)";//"grayscale(100%) brightness(6) drop-shadow(0px 0px 5px white)";
}else if(props.destroyed){return"blur(1px)";}else{return"none";}},StructureIcon_SystemText,function(props){return props.offline?"none":"flex";},function(props){if(props.destroyed||props.offline||props.loading){return"0.5";}return"0";},function(props){if(props.destroyed||props.offline){return"black";}else if(props.loading){return"orange";}return"transparent";},function(props){if(props.offline){return"url(/img/offline.png)";}return"none";});var StructureIcon_Container=styled_components_browser_esm["b" /* default */].div(StructureIcon_templateObject4());var StructureText=styled_components_browser_esm["b" /* default */].div(StructureIcon_templateObject5());var StructureContainer=styled_components_browser_esm["b" /* default */].div(StructureIcon_templateObject6(),function(props){return props.health===0?"transparent":"white";},function(props){return props.health===0?"blur(1px)":"none";},function(props){return"".concat(props.health,"%");},function(props){return props.criticals?"#ed6738":"#427231";});var StructureIcon_StructureIcon=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(StructureIcon,_React$Component);function StructureIcon(props){var _this;Object(classCallCheck["a" /* default */])(this,StructureIcon);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StructureIcon).call(this,props));_this.element=react["createRef"]();_this.state={mouseOveredSystem:null,clickedSystem:null};return _this;}Object(createClass["a" /* default */])(StructureIcon,[{key:"clickSystem",value:function clickSystem(event){event.stopPropagation();event.preventDefault();var _this$props=this.props,uiState=_this$props.uiState,system=_this$props.system,ship=_this$props.ship;uiState.customEvent("systemClicked",{ship:ship,system:system,element:this.element,scs:true});}},{key:"onSystemMouseOver",value:function onSystemMouseOver(event){event.stopPropagation();event.preventDefault();var _this$props2=this.props,uiState=_this$props2.uiState,system=_this$props2.system,ship=_this$props2.ship;uiState.customEvent("systemMouseOver",{ship:ship,system:system,element:this.element});this.setState({mouseOveredSystem:this.element});}},{key:"onSystemMouseOut",value:function onSystemMouseOut(event){event.stopPropagation();event.preventDefault();var uiState=this.props.uiState;uiState.customEvent("systemMouseOut");this.setState({mouseOveredSystem:null});}},{key:"onContextMenu",value:function onContextMenu(e){e.stopPropagation();e.preventDefault();var _this$props3=this.props,uiState=_this$props3.uiState,system=_this$props3.system,ship=_this$props3.ship;uiState.customEvent("systemRightClicked",{system:system,ship:ship});}},{key:"render",value:function render(){var _this2=this;var _this$props4=this.props,uiState=_this$props4.uiState,system=_this$props4.system,ship=_this$props4.ship,scs=_this$props4.scs,destroyed=_this$props4.destroyed,_this$props4$systemMe=_this$props4.systemMenu;_this$props4$systemMe=_this$props4$systemMe===void 0?{systemInfoMenuProvider:null,activeSystem:null,activeSystemElement:null}:_this$props4$systemMe;var systemInfoMenuProvider=_this$props4$systemMe.systemInfoMenuProvider,activeSystem=_this$props4$systemMe.activeSystem,activeSystemElement=_this$props4$systemMe.activeSystemElement,_this$props4$onSystem=_this$props4.onSystemClicked,onSystemClicked=_this$props4$onSystem===void 0?this.clickSystem:_this$props4$onSystem,_this$props4$selected=_this$props4.selected,selected=_this$props4$selected===void 0?false:_this$props4$selected,_this$props4$text=_this$props4.text,text=_this$props4$text===void 0?null:_this$props4$text,_this$props4$target=_this$props4.target,target=_this$props4$target===void 0?null:_this$props4$target,rest=Object(objectWithoutProperties["a" /* default */])(_this$props4,["uiState","system","ship","scs","destroyed","systemMenu","onSystemClicked","selected","text","target"]);var mouseOveredSystem=this.state.mouseOveredSystem;var menu=activeSystem?systemInfoMenuProvider:null;var displayMenu=Boolean(!activeSystem&&mouseOveredSystem||activeSystem&&activeSystem===system&&activeSystemElement===this.element);return react["createElement"](react["Fragment"],null,displayMenu&&react["createElement"](system_SystemInfo,Object.assign({scs:true,uiState:uiState,ship:ship,system:system,systemInfoMenuProvider:menu,element:mouseOveredSystem||activeSystemElement,target:target},rest)),react["createElement"](StructureContainer,{ref:function ref(c){return _this2.element=c;},onClick:onSystemClicked.bind(this),onMouseOver:this.onSystemMouseOver.bind(this),onMouseOut:this.onSystemMouseOut.bind(this),onContextMenu:this.onContextMenu.bind(this),health:StructureIcon_getStructureLeft(system),criticals:system.hasAnyCritical()},react["createElement"](StructureText,null,system.getRemainingHitpoints()," / ",system.hitpoints," A"," ",system.getArmor())));}}]);return StructureIcon;}(react["Component"]);var StructureIcon_getStructureLeft=function getStructureLeft(system){return(system.hitpoints-system.getTotalDamage())/system.hitpoints*100;};/* harmony default export */ var system_StructureIcon = (StructureIcon_StructureIcon);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipWindow/ShipSection.js
function ShipSection_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing: border-box;\n  width: calc(100% - 4px);\n  height: 16px;\n  background-color: #081313;\n  color: ",";\n  font-family: arial;\n  font-size: 11px;\n  text-shadow: black 0 0 6px, black 0 0 6px;\n  margin: 1px;\n  filter: ",";\n  border: 1px solid black;\n\n  :before {\n    box-sizing: border-box;\n    content: \"\";\n    position: absolute;\n    width: ",";\n    height: 100%;\n    left: 0;\n    bottom: 0;\n    z-index: 0;\n    background-color: ",";\n  }\n"]);ShipSection_templateObject3=function _templateObject3(){return data;};return data;}function ShipSection_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  z-index: 1;\n"]);ShipSection_templateObject2=function _templateObject2(){return data;};return data;}function ShipSection_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap-reverse;\n  width: calc(100% - 2px);\n  align-items: end;\n  justify-content: space-around;\n  box-sizing: border-box;\n  margin: 1px;\n  flex-grow: 1;\n\n  border: ",";\n"]);ShipSection_templateObject=function _templateObject(){return data;};return data;}var ShipSectionContainer=styled_components_browser_esm["b" /* default */].div(ShipSection_templateObject(),function(props){switch(props.location){case 0:return"1px solid ".concat(Colors_namespaceObject.systemWindowPrimaryBorder);default:return"1px dashed ".concat(Colors_namespaceObject.systemWindowBorder);}});var ShipSection_StructureText=styled_components_browser_esm["b" /* default */].div(ShipSection_templateObject2());var ShipSection_StructureContainer=styled_components_browser_esm["b" /* default */].div(ShipSection_templateObject3(),function(props){return props.health===0?"transparent":"white";},function(props){return props.health===0?"blur(1px)":"none";},function(props){return"".concat(props.health,"%");},function(props){return props.criticals?"#ed6738":"#427231";});var ShipSection_ShipSection=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(ShipSection,_React$Component);function ShipSection(){Object(classCallCheck["a" /* default */])(this,ShipSection);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipSection).apply(this,arguments));}Object(createClass["a" /* default */])(ShipSection,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,section=_this$props.section,uiState=_this$props.uiState,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["ship","section","uiState"]);var location=section.location;var structure=section.getStructure();return react["createElement"](ShipSectionContainer,{location:location},section.getNonStructureSystems().map(function(system){return react["createElement"](system_SystemIcon,Object.assign({scs:true,uiState:uiState,key:"system-scs-".concat(location,"-").concat(ship.id,"-").concat(system.id),system:system,ship:ship,selected:uiState.isSelectedSystem(system)},rest));}),structure&&react["createElement"](system_StructureIcon,Object.assign({uiState:uiState,system:structure,ship:ship,selected:uiState.isSelectedSystem(structure)},rest)));}}]);return ShipSection;}(react["Component"]);/* harmony default export */ var shipWindow_ShipSection = (ShipSection_ShipSection);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipWindow/ShipWindow.js
function ShipWindow_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 50%;\n"]);ShipWindow_templateObject3=function _templateObject3(){return data;};return data;}function ShipWindow_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 25%;\n  max-height: calc(33.3333333% - 11px);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"]);ShipWindow_templateObject2=function _templateObject2(){return data;};return data;}function ShipWindow_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n  max-width: 400px;\n  height: auto;\n  opacity: 0.95;\n  z-index: 10001;\n  font-size: 10px;\n  color: white;\n  font-family: arial;\n  max-height: 100vh;\n  overflow-y: scroll;\n  margin: 0 8px;\n  scrollbar-width: 0;\n\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"]);ShipWindow_templateObject=function _templateObject(){return data;};return data;}var ShipWindowContainer=styled_components_browser_esm["b" /* default */].div(ShipWindow_templateObject());var Column=styled_components_browser_esm["b" /* default */].div(ShipWindow_templateObject2());var ColumnMiddle=Object(styled_components_browser_esm["b" /* default */])(Column)(ShipWindow_templateObject3());var ShipWindow_ShipWindow=function ShipWindow(_ref){var ship=_ref.ship,uiState=_ref.uiState,rest=Object(objectWithoutProperties["a" /* default */])(_ref,["ship","uiState"]);var shipWindowClicked=Object(react["useCallback"])(function(){uiState.customEvent("closeSystemInfo");},[]);return react_default.a.createElement(ShipWindowContainer,{onClick:shipWindowClicked,onContextMenu:function onContextMenu(e){e.preventDefault();e.stopPropagation();},team:ship.team},react_default.a.createElement(Column,null,react_default.a.createElement(shipWindow_ShipSection,Object.assign({uiState:uiState,ship:ship,section:ship.systems.sections.getPortFrontSection()},rest)),react_default.a.createElement(shipWindow_ShipSection,Object.assign({uiState:uiState,ship:ship,section:ship.systems.sections.getPortAftSection()},rest))),react_default.a.createElement(ColumnMiddle,null,react_default.a.createElement(shipWindow_ShipSection,Object.assign({uiState:uiState,section:ship.systems.sections.getFrontSection(),ship:ship},rest)),react_default.a.createElement(shipWindow_ShipSection,Object.assign({uiState:uiState,ship:ship,section:ship.systems.sections.getPrimarySection()},rest)),react_default.a.createElement(shipWindow_ShipSection,Object.assign({uiState:uiState,ship:ship,section:ship.systems.sections.getAftSection()},rest))),react_default.a.createElement(Column,null,react_default.a.createElement(shipWindow_ShipSection,Object.assign({uiState:uiState,ship:ship,section:ship.systems.sections.getStarboardFrontSection()},rest)),react_default.a.createElement(shipWindow_ShipSection,Object.assign({uiState:uiState,ship:ship,section:ship.systems.sections.getStarboardAftSection()},rest))));};/* harmony default export */ var shipWindow_ShipWindow = (ShipWindow_ShipWindow);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/WeaponTargeting.js
function WeaponTargeting_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n"]);WeaponTargeting_templateObject=function _templateObject(){return data;};return data;}var WeaponTargeting_Container=styled_components_browser_esm["b" /* default */].div(WeaponTargeting_templateObject());var WeaponTargeting_WeaponTargeting=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(WeaponTargeting,_React$Component);function WeaponTargeting(){Object(classCallCheck["a" /* default */])(this,WeaponTargeting);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(WeaponTargeting).apply(this,arguments));}Object(createClass["a" /* default */])(WeaponTargeting,[{key:"render",value:function render(){var _this$props=this.props,uiState=_this$props.uiState,ship=_this$props.ship,target=_this$props.target,system=_this$props.system,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["uiState","ship","target","system"]);var weaponFireService=uiState.services.weaponFireService;if(!weaponFireService.canFire(ship,target,system)){return null;}var hitChance=system.callHandler("getHitChance",{shooter:ship,target:target});return react["createElement"](WeaponTargeting_Container,null,react["createElement"](system_SystemIcon,Object.assign({scs:true,targeting:true,uiState:uiState,key:"system-weaponTargeting-".concat(ship.id,"-").concat(system.id),system:system,ship:ship,selected:false,target:target,weaponTargeting:{target:target,hitChance:hitChance},text:hitChance.result+"%"},rest)));}}]);return WeaponTargeting;}(react["Component"]);/* harmony default export */ var shipTooltip_WeaponTargeting = (WeaponTargeting_WeaponTargeting);
// CONCATENATED MODULE: ./src/model/unit/TorpedoFlight.mjs
var TorpedoFlight_TorpedoFlight=/*#__PURE__*/function(){function TorpedoFlight(torpedo,targetId,shooterId,weaponId,launcherIndex){Object(classCallCheck["a" /* default */])(this,TorpedoFlight);this.id=v4();this.torpedo=torpedo;this.targetId=targetId;this.shooterId=shooterId;this.weaponId=weaponId;this.launcherIndex=launcherIndex;this.launchPosition=new utils_Vector();this.strikePosition=new utils_Vector();this.intercepted=false;this.done=false;}Object(createClass["a" /* default */])(TorpedoFlight,[{key:"setDone",value:function setDone(){this.done=true;}},{key:"isDone",value:function isDone(){return this.done;}},{key:"setIntercepted",value:function setIntercepted(){this.intercepted=true;}},{key:"getStrikeDistance",value:function getStrikeDistance(target){return this.torpedo.getStrikeDistance(this,target);}},{key:"setStrikePosition",value:function setStrikePosition(position){this.strikePosition=position;return this;}},{key:"setLaunchPosition",value:function setLaunchPosition(position){this.launchPosition=position;return this;}},{key:"serialize",value:function serialize(){return{id:this.id,torpedo:this.torpedo.constructor.name,targetId:this.targetId,strikePosition:this.strikePosition,shooterId:this.shooterId,weaponId:this.weaponId,launcherIndex:this.launcherIndex,intercepted:this.intercepted,launchPosition:this.launchPosition};}},{key:"deserialize",value:function deserialize(data){this.id=data.id;this.torpedo=new cargoClasses[data.torpedo]();this.targetId=data.targetId;this.strikePosition=new utils_Vector(data.strikePosition);this.launchPosition=new utils_Vector(data.launchPosition);this.shooterId=data.shooterId;this.weaponId=data.weaponId;this.launcherIndex=data.launcherIndex;this.intercepted=data.intercepted||false;return this;}},{key:"clone",value:function clone(){return new TorpedoFlight().deserialize(this.serialize());}}]);return TorpedoFlight;}();/* harmony default export */ var unit_TorpedoFlight = (TorpedoFlight_TorpedoFlight);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/TorpedoLauncherStrategy.mjs
var TorpedoLauncherStrategy_TorpedoLauncherStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(TorpedoLauncherStrategy,_ShipSystemStrategy);function TorpedoLauncherStrategy(launcherIndex,loadedTorpedo,torpedoClass,loadingTime){var _this;Object(classCallCheck["a" /* default */])(this,TorpedoLauncherStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoLauncherStrategy).call(this));_this.loadingTime=loadingTime;_this.launcherIndex=launcherIndex;_this.loadedTorpedo=loadedTorpedo;_this.nextTorpedoClass=null;_this.torpedoClass=torpedoClass;_this.turnsLoaded=loadingTime;_this.changeAmmo=null;_this.previousTorpedo=null;_this.launchTarget=null;return _this;}Object(createClass["a" /* default */])(TorpedoLauncherStrategy,[{key:"getUiComponents",value:function getUiComponents(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{name:"TorpedoLauncher",props:{launcherIndex:this.launcherIndex,loadedTorpedo:this.loadedTorpedo,loadingTime:this.loadingTime,turnsLoaded:this.turnsLoaded>this.loadingTime?this.loadingTime:this.turnsLoaded,torpedoClass:this.torpedoClass,launchTarget:this.launchTarget,launcher:this}}]);}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var response=Object(objectSpread2["a" /* default */])({},previousResponse);response["torpedoLauncherStrategy".concat(this.launcherIndex)]={turnsLoaded:this.turnsLoaded,loadedTorpedo:this.loadedTorpedo?this.loadedTorpedo.constructor.name:null,changeAmmo:this.changeAmmo,launchTarget:this.launchTarget};return response;}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var launcherData=data["torpedoLauncherStrategy".concat(this.launcherIndex)]||{};this.turnsLoaded=launcherData.turnsLoaded||0;this.loadedTorpedo=launcherData.loadedTorpedo?new cargoClasses[launcherData.loadedTorpedo]():null;this.changeAmmo=launcherData.changeAmmo||null;this.launchTarget=launcherData.launchTarget||null;return this;}},{key:"loadAmmoInstant",value:function loadAmmoInstant(_ref){var ammo=_ref.ammo,launcherIndex=_ref.launcherIndex;if(launcherIndex!==this.launcherIndex||this.loadedTorpedo&&this.loadedTorpedo.constructor.name===ammo.constructor.name){return;}this.loadedTorpedo=ammo;this.turnsLoaded=this.loadingTime;}},{key:"unloadAmmo",value:function unloadAmmo(_ref2){var launcherIndex=_ref2.launcherIndex;if(launcherIndex!==this.launcherIndex){return;}//TODO: unload ammo
}},{key:"canLaunchAgainst",value:function canLaunchAgainst(_ref3){var target=_ref3.target;if(this.turnsLoaded<this.loadingTime||!this.loadedTorpedo){return false;}var distance=this.system.shipSystems.ship.hexDistanceTo(target);if(this.loadedTorpedo.minRange>distance||this.loadedTorpedo.maxRange<distance){return false;}return true;}},{key:"setLaunchTarget",value:function setLaunchTarget(shipId){if(this.turnsLoaded<this.loadingTime||!this.loadedTorpedo){return;}this.launchTarget=shipId;}},{key:"launchTorpedo",value:function launchTorpedo(payload,previousResponse){var _this2=this;if(this.turnsLoaded<this.loadingTime||!this.loadedTorpedo||!this.launchTarget){return previousResponse;}var result=new unit_TorpedoFlight(this.loadedTorpedo,this.launchTarget,this.system.shipSystems.ship.id,this.system.id,this.launcherIndex);var possibleNewTorpedos=this.getPossibleTorpedosToLoad();var newAmmo=null;var same=possibleNewTorpedos.find(function(torpedo){return torpedo.object.constructor===_this2.loadedTorpedo.constructor;});if(same){var cargoBay=this.system.shipSystems.getSystems().find(function(system){return system.callHandler("hasCargo",{object:same.object},false);});newAmmo={ammo:same.object.constructor.name,from:cargoBay.id};}else if(possibleNewTorpedos.length>0){var newTorpedo=possibleNewTorpedos.pop().object;var _cargoBay=this.system.shipSystems.getSystems().find(function(system){return system.callHandler("hasCargo",{object:newTorpedo},false);});newAmmo={ammo:newTorpedo.constructor.name,from:_cargoBay.id};}this.loadedTorpedo=null;this.turnsLoaded=0;if(newAmmo){this.receiveAmmoChange(newAmmo);}return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[result]);}},{key:"loadAmmo",value:function loadAmmo(_ref4){var ammo=_ref4.ammo,launcherIndex=_ref4.launcherIndex;if(launcherIndex!==this.launcherIndex||this.loadedTorpedo&&this.loadedTorpedo.constructor.name===ammo.constructor.name){return;}var system=this.system.shipSystems.getSystems().find(function(system){return system.callHandler("hasCargo",{object:ammo},false);});system.callHandler("removeCargo",{object:ammo});if(this.loadedTorpedo){system.callHandler("addCargo",{object:this.loadedTorpedo});}if(this.previousTorpedo&&this.previousTorpedo.constructor.name===ammo.constructor.name){this.loadedTorpedo=this.previousTorpedo;this.turnsLoaded=this.previousTurnsLoaded;this.changeAmmo=null;}else{if(!this.previousTorpedo){this.previousTorpedo=this.loadedTorpedo;this.previousTurnsLoaded=this.turnsLoaded;}this.turnsLoaded=0;this.changeAmmo={ammo:ammo.constructor.name,from:system.id};this.loadedTorpedo=ammo;}this.launchTarget=null;}},{key:"getLoadedLaunchers",value:function getLoadedLaunchers(payload,previousResponse){if(this.turnsLoaded>=this.loadingTime&&this.loadedTorpedo){return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[this]);}return previousResponse;}},{key:"receiveAmmoChange",value:function receiveAmmoChange(changeAmmo){var ammo=new cargoClasses[changeAmmo.ammo]();var cargoBay=this.system.shipSystems.getSystemById(changeAmmo.from);if(!cargoBay.callHandler("hasCargo",{object:ammo})){throw new Error("Trying to take cargo form ".concat(cargoBay.id,", but no appropriate cargo found"));}cargoBay.callHandler("removeCargo",{object:ammo});if(this.loadedTorpedo){cargoBay.callHandler("addCargo",{object:this.loadedTorpedo});}this.loadedTorpedo=ammo;this.turnsLoaded=0;}},{key:"receivePlayerData",value:function receivePlayerData(_ref5){var clientSystem=_ref5.clientSystem,gameData=_ref5.gameData,phase=_ref5.phase;if(phase!==1){return;}if(!clientSystem){return;}if(this.system.isDisabled()){return;}var clientStrategy=getThisStrategy(clientSystem,this.launcherIndex);var changeAmmo=clientStrategy.changeAmmo;if(changeAmmo){this.receiveAmmoChange(changeAmmo);}if(clientStrategy.launchTarget){var target=gameData.ships.getShipById(clientStrategy.launchTarget);if(!target){throw new Error("Did not find launch target ship id '".concat(clientStrategy.launchTarget,"'"));}if(!this.canLaunchAgainst({target:target})){throw new Error("Can not launch torpedo");}this.launchTarget=clientStrategy.launchTarget;}}},{key:"getPossibleTorpedosToLoad",value:function getPossibleTorpedosToLoad(){var _this3=this;var ammo=[];this.system.shipSystems.getSystems().forEach(function(system){var possibleAmmo=system.callHandler("getCargoByParentClass",_this3.torpedoClass,[]);possibleAmmo.forEach(function(cargo){var entry=ammo.find(function(ammoEntry){return ammoEntry.object.constructor.name===cargo.object.constructor.name;});if(entry){entry.amount+=cargo.amount;}else{ammo.push({object:cargo.object,amount:cargo.amount});}});});return ammo;}},{key:"advanceTurn",value:function advanceTurn(){this.changeAmmo=null;this.previousTorpedo=null;this.launchTarget=null;if(this.system.isDisabled()||!this.loadedTorpedo){this.turnsLoaded=0;return;}this.turnsLoaded++;}}]);return TorpedoLauncherStrategy;}(strategy_ShipSystemStrategy);var getThisStrategy=function getThisStrategy(system,launcherIndex){return system.strategies.find(function(strategy){return strategy instanceof TorpedoLauncherStrategy_TorpedoLauncherStrategy&&strategy.launcherIndex===launcherIndex;});};/* harmony default export */ var weapon_TorpedoLauncherStrategy = (TorpedoLauncherStrategy_TorpedoLauncherStrategy);
// CONCATENATED MODULE: ./src/model/weapon/TorpedoAttackService.mjs
var TorpedoAttackService_TorpedoAttackService=/*#__PURE__*/function(){function TorpedoAttackService(){Object(classCallCheck["a" /* default */])(this,TorpedoAttackService);}Object(createClass["a" /* default */])(TorpedoAttackService,[{key:"update",value:function update(gameData){this.gameData=gameData;return this;}},{key:"getPossibleInterceptors",value:function getPossibleInterceptors(ship,torpedoFlight){return ship.systems.getSystems().filter(function(system){return!system.isDisabled();}).filter(function(system){return system.callHandler("canIntercept");}).filter(function(weapon){// only weapons that have arcs facing to the correct direction
return weapon.callHandler("isPositionOnArc",{targetPosition:torpedoFlight.strikePosition},true);}).filter(function(weapon){var fireOrders=weapon.callHandler("getFireOrders",null,[]);return fireOrders.length===0;});}},{key:"getPossibleTorpedosFrom",value:function getPossibleTorpedosFrom(ship,target){var allLaunchers=[];ship.systems.getSystems().forEach(function(system){var launchers=system.callHandler("getLoadedLaunchers",null,[]).filter(function(launcher){return launcher.canLaunchAgainst({target:target});});if(launchers.length===0){return;}allLaunchers=[].concat(Object(toConsumableArray["a" /* default */])(allLaunchers),Object(toConsumableArray["a" /* default */])(launchers));});return allLaunchers;}},{key:"getPossibleTorpedos",value:function getPossibleTorpedos(currentUser,target){var _this=this;var torpedoAttackShips=[];if(target.player.isUsers(currentUser)){return[];}this.gameData.ships.getShips().filter(function(ship){return ship.player.isUsers(currentUser);}).forEach(function(ship){ship.systems.getSystems().forEach(function(system){var launchers=system.callHandler("getLoadedLaunchers",null,[]);if(launchers.length===0){return;}var entry=torpedoAttackShips.find(function(attack){return attack.ship===ship;});if(entry){entry.launchers=[].concat(Object(toConsumableArray["a" /* default */])(entry.launchers),Object(toConsumableArray["a" /* default */])(launchers));}else{torpedoAttackShips.push({ship:ship,launchers:launchers,distance:_this.target.getHexPosition().distanceTo(ship.getHexPosition()),deltaDistance:getDeltaVelocty(_this.target,ship)});}});});torpedoAttackShips.sort(function(a,b){if(a.distance>b.distance){return 1;}if(a.distance<b.distance){return-1;}return 0;});return torpedoAttackShips;}}]);return TorpedoAttackService;}();var getDeltaVelocty=function getDeltaVelocty(a,b){var distance=a.getHexPosition().distanceTo(b.getHexPosition());var aLastMove=a.movement.getLastMove();var bLastMove=b.movement.getLastMove();if(!aLastMove||!bLastMove){return 0;}var aPosition=a.getHexPosition().add(aLastMove.getHexVelocity());var bPosition=b.getHexPosition().add(bLastMove.getHexVelocity());var newDistance=aPosition.distanceTo(bPosition);return newDistance-distance;};/* harmony default export */ var weapon_TorpedoAttackService = (TorpedoAttackService_TorpedoAttackService);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/TorpedoAttackTooltip.js
var getTorpedoTooltip=function getTorpedoTooltip(shooter,target,torpedo,strikePrediction){if(strikePrediction){var entries=[{value:"Following prediction depends on relative velocity, position of target, launched torpedo and is subject to change"},{header:"Impact in",value:"+".concat(Math.floor(strikePrediction.impactTurn)," turns")},{header:"Relative velocity",value:"".concat(strikePrediction.impactVelocity," h/t")}/*
      {
        header: "Strike position",
        value: coordinateConverter
          .fromGameToHex(strikePrediction.impactPosition)
          .toString()
      },
      {
        header: "Strike effectiveness",
        value: `${Math.round(strikePrediction.effectiveness * 100)}%`
      }
      */];if(strikePrediction.note){entries.push({value:strikePrediction.note});}return entries;}return[];};var TorpedoAttackTooltip_TorpedoAttackTooltip=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(TorpedoAttackTooltip,_React$Component);function TorpedoAttackTooltip(){Object(classCallCheck["a" /* default */])(this,TorpedoAttackTooltip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoAttackTooltip).apply(this,arguments));}Object(createClass["a" /* default */])(TorpedoAttackTooltip,[{key:"render",value:function render(){var _this$props=this.props,shooter=_this$props.shooter,target=_this$props.target,torpedo=_this$props.torpedo;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipHeader,null,"TARGET: ",target.name),getTorpedoTooltip(shooter,target,torpedo).map(TorpedoAttackTooltip_getEntry));}}]);return TorpedoAttackTooltip;}(react_default.a.Component);var TorpedoAttackTooltip_getEntry=function getEntry(_ref,i){var header=_ref.header,value=_ref.value;if(value.replace){value=value.replace(/<br>/gm,"\n");}return react_default.a.createElement(TooltipEntry,{key:"cargoTooltipEntry-".concat(header,"-").concat(i)},header&&react_default.a.createElement(TooltipValueHeader,null,header,": "),value&&react_default.a.createElement(TooltipValue,null,value));};/* harmony default export */ var shipTooltip_TorpedoAttackTooltip = (TorpedoAttackTooltip_TorpedoAttackTooltip);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/TorpedoAttackEntry.js
function TorpedoAttackEntry_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  "," {\n    ","\n  }\n"]);TorpedoAttackEntry_templateObject=function _templateObject(){return data;};return data;}var TorpedoAttackEntry_TorpedoCargoItem=Object(styled_components_browser_esm["b" /* default */])(cargo_CargoItem)(TorpedoAttackEntry_templateObject(),styled_IconAndLabel,function(props){var launcher=props.launcher,target=props.target;if(launcher.launchTarget===target.id){return"filter: hue-rotate(0deg) brightness(4) grayscale(0);";}else if(launcher.launchTarget!==null&&launcher.launchTarget!==target.id){return"filter: hue-rotate(0deg) brightness(1) grayscale(0.7);";}});var TorpedoAttackEntry_TorpedoAttackEntry=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(TorpedoAttackEntry,_React$Component);function TorpedoAttackEntry(){Object(classCallCheck["a" /* default */])(this,TorpedoAttackEntry);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoAttackEntry).apply(this,arguments));}Object(createClass["a" /* default */])(TorpedoAttackEntry,[{key:"torpedoMouseOut",value:function torpedoMouseOut(){var _this$props=this.props,uiState=_this$props.uiState,launcher=_this$props.launcher,target=_this$props.target;uiState.customEvent("torpedoMouseOut",{ship:launcher.system.shipSystems.ship,torpedo:launcher.loadedTorpedo,target:target});}},{key:"torpedoMouseOver",value:function torpedoMouseOver(){var _this$props2=this.props,uiState=_this$props2.uiState,launcher=_this$props2.launcher,target=_this$props2.target;uiState.customEvent("torpedoMouseOver",{ship:launcher.system.shipSystems.ship,torpedo:launcher.loadedTorpedo,target:target});}},{key:"launcherClick",value:function launcherClick(){var _this$props3=this.props,target=_this$props3.target,launcher=_this$props3.launcher,_this$props3$onLaunch=_this$props3.onLauncherClick,onLauncherClick=_this$props3$onLaunch===void 0?function(){}:_this$props3$onLaunch;if(launcher.launchTarget===null||launcher.launchTarget!==target.id){launcher.setLaunchTarget(target.id);}else if(launcher.launchTarget&&launcher.launchTarget===target.id){launcher.setLaunchTarget(null);}this.forceUpdate();onLauncherClick();}},{key:"render",value:function render(){var _this$props4=this.props,target=_this$props4.target,launcher=_this$props4.launcher,absoluteTooltip=_this$props4.absoluteTooltip;return react_default.a.createElement(TorpedoAttackEntry_TorpedoCargoItem,{launcher:launcher,target:target,ship:launcher.system.shipSystems.ship,handleOnClick:this.launcherClick.bind(this),handleMouseOver:this.torpedoMouseOver.bind(this),handleMouseOut:this.torpedoMouseOut.bind(this),cargo:launcher.loadedTorpedo,amount:null,text:"",absoluteTooltip:absoluteTooltip,tooltipAdditionalContent:react_default.a.createElement(shipTooltip_TorpedoAttackTooltip,{shooter:launcher.system.shipSystems.ship,target:target,torpedo:launcher.loadedTorpedo})});}}]);return TorpedoAttackEntry;}(react_default.a.Component);/* harmony default export */ var shipTooltip_TorpedoAttackEntry = (TorpedoAttackEntry_TorpedoAttackEntry);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/WeaponTargetingList.js
function WeaponTargetingList_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n  margin: 0 8px;\n"]);WeaponTargetingList_templateObject2=function _templateObject2(){return data;};return data;}function WeaponTargetingList_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border: none;\n  margin-bottom: 0;\n  font-size: 12px;\n"]);WeaponTargetingList_templateObject=function _templateObject(){return data;};return data;}var WeaponTargetingList_InfoHeader=Object(styled_components_browser_esm["b" /* default */])(TooltipHeader)(WeaponTargetingList_templateObject());var WeaponTargetingList_Container=styled_components_browser_esm["b" /* default */].div(WeaponTargetingList_templateObject2());var WeaponTargetingList_WeaponTargetingList=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(WeaponTargetingList,_React$Component);function WeaponTargetingList(props){var _this;Object(classCallCheck["a" /* default */])(this,WeaponTargetingList);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(WeaponTargetingList).call(this,props));_this.torpedoAttackService=new weapon_TorpedoAttackService();return _this;}Object(createClass["a" /* default */])(WeaponTargetingList,[{key:"getSystemIcons",value:function getSystemIcons(systems,weaponFireService,uiState,shooter,ship,rest){var _this2=this;return systems.map(function(system,i){if(system instanceof weapon_TorpedoLauncherStrategy){return react["createElement"](shipTooltip_TorpedoAttackEntry,{key:"weaponTargeting-torpedo-".concat(i),target:ship,launcher:system,uiState:uiState,absoluteTooltip:"right"});}return react["createElement"](shipTooltip_WeaponTargeting,Object.assign({key:"weaponTargeting-".concat(system.id),uiState:uiState,system:system,target:ship,ship:shooter,onSystemClicked:!weaponFireService.systemHasFireOrderAgainstShip(system,ship)?_this2.targetShip(system,shooter,ship,uiState):_this2.unTargetShip(system,shooter,ship,uiState)},rest));});}},{key:"targetShip",value:function targetShip(system,ship,target,uiState){var weaponFireService=uiState.services.weaponFireService;return function(){weaponFireService.removeFireOrders(ship,system);weaponFireService.addFireOrder(ship,target,system);uiState.shipSystemStateChanged(ship,system);uiState.shipStateChanged(ship);};}},{key:"unTargetShip",value:function unTargetShip(system,ship,target,uiState){var weaponFireService=uiState.services.weaponFireService;return function(){weaponFireService.removeFireOrders(ship,system);uiState.shipSystemStateChanged(ship,system);uiState.shipStateChanged(ship);};}},{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,uiState=_this$props.uiState,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["ship","uiState"]);var shooter=this.props.shooter;var weaponFireService=uiState.services.weaponFireService;if(!shooter){shooter=uiState.getSelectedShip();}if(!shooter||uiState.gameData.ships.isSameTeam(ship,shooter)){return null;}var systems=[].concat(Object(toConsumableArray["a" /* default */])(shooter.systems.getSystems().filter(function(system){return weaponFireService.canFire(shooter,ship,system)&&system.callHandler("getHitChance",{shooter:shooter,target:ship}).result>0;})),Object(toConsumableArray["a" /* default */])(this.torpedoAttackService.getPossibleTorpedosFrom(shooter,ship).sort(function(a,b){if(a.loadedTorpedo.maxRange<b.loadedTorpedo.maxRange){return 1;}if(a.loadedTorpedo.maxRange>b.loadedTorpedo.maxRange){return-1;}if(a.loadedTorpedo.damageStrategy.constructor.name<b.loadedTorpedo.damageStrategy.constructor.name){return 1;}if(a.loadedTorpedo.damageStrategy.constructor.name>b.loadedTorpedo.damageStrategy.constructor.name){return-1;}if(a.loadedTorpedo.getDisplayName()<b.loadedTorpedo.getDisplayName()){return 1;}if(a.loadedTorpedo.getDisplayName()>b.loadedTorpedo.getDisplayName()){return-1;}return 0;})));if(systems.length===0){return null;}var icons=this.getSystemIcons(systems,weaponFireService,uiState,shooter,ship,rest);return react["createElement"](react["Fragment"],null,react["createElement"](TooltipHeader,null,ship.name," ",react["createElement"](TooltipValue,null,"available weapons")),react["createElement"](WeaponTargetingList_Container,null,icons));}}]);return WeaponTargetingList;}(react["Component"]);/* harmony default export */ var shipTooltip_WeaponTargetingList = (WeaponTargetingList_WeaponTargetingList);
// CONCATENATED MODULE: ./src/model/movement/TorpedoMovementService.mjs
var TorpedoMovementService_TorpedoMovementService=/*#__PURE__*/function(){function TorpedoMovementService(){Object(classCallCheck["a" /* default */])(this,TorpedoMovementService);}Object(createClass["a" /* default */])(TorpedoMovementService,[{key:"reachesTargetThisTurn",value:function reachesTargetThisTurn(flight,target){var _this$torpedoMath=this.torpedoMath(flight.position,flight.velocity,target.getPosition(),target.getVelocity(),flight.getTorpedoGameDeltaVelocity()),impactTurn=_this$torpedoMath.impactTurn;return impactTurn<1;}},{key:"moveTorpedo",value:function moveTorpedo(flight,target){var _this$torpedoMath2=this.torpedoMath(flight.position,flight.velocity,target.getPosition().sub(target.getVelocity()),target.getVelocity(),flight.getTorpedoGameDeltaVelocity()),accelerationVector=_this$torpedoMath2.accelerationVector,rest=Object(objectWithoutProperties["a" /* default */])(_this$torpedoMath2,["accelerationVector"]);flight.position=flight.position.add(flight.velocity).add(accelerationVector.multiplyScalar(0.5*flight.getTorpedoGameDeltaVelocity()));flight.velocity=flight.velocity.add(accelerationVector.multiplyScalar(flight.getTorpedoGameDeltaVelocity()));}},{key:"buildPredictions",value:function buildPredictions(flight,result){var maxInterceptVelocity=flight.torpedo.maxInterceptVelocity;var velocity=result.impactVelocity/HexagonMath.getHexWidth();if(velocity>maxInterceptVelocity){velocity=maxInterceptVelocity;}var effectiveness=velocity/maxInterceptVelocity;var notes="";if(Math.floor(result.impactTurn)+flight.turnsActive<flight.torpedo.armingTime){effectiveness=0;notes="Insufficient time to arm torpedo";}if(Math.floor(result.impactTurn)+flight.turnsActive>flight.torpedo.turnsToLive){effectiveness=0;notes="Out of range";}return Object(objectSpread2["a" /* default */])({},result,{notes:notes,impactVelocity:Math.round(result.impactVelocity/HexagonMath.getHexWidth()),effectiveness:effectiveness});}},{key:"predictTorpedoHitPositionAndTurnAfterMovement",value:function predictTorpedoHitPositionAndTurnAfterMovement(flight,target){var result=this.torpedoMath(flight.position,flight.velocity,target.getPosition().sub(target.getVelocity()),target.getVelocity(),flight.getTorpedoGameDeltaVelocity());return this.buildPredictions(flight,result);}},{key:"predictTorpedoHitPositionAndTurn",value:function predictTorpedoHitPositionAndTurn(flight,target){var result=this.torpedoMath(flight.position,flight.velocity,target.getPosition(),target.getVelocity(),flight.getTorpedoGameDeltaVelocity());return this.buildPredictions(flight,result);}},{key:"standardize",value:function standardize(shooterPosition,shooterVelocity,targetPosition,targetVelocity){var Δpos=targetPosition.sub(shooterPosition);var φ=Math.atan2(Δpos.y,Δpos.x);var rotationMatrix=new three.Matrix4().makeRotationZ(-φ);var newTargetPosition=Δpos.applyMatrix4(rotationMatrix);var newShooterVelocity=shooterVelocity.sub(targetVelocity).applyMatrix4(rotationMatrix);return{newTargetPosition:newTargetPosition,newShooterVelocity:newShooterVelocity,φ:φ};}},{key:"torpedoMath",value:function torpedoMath(shooterPosition,shooterVelocity,targetPosition,targetVelocity,torpedoAcceleration){if(torpedoAcceleration<=0){throw new Error("Torpedoacceleration is <= 0");}if(shooterPosition.equals(targetPosition)){throw new Error("Shooter and target positions can not be same");}var _this$standardize=this.standardize(shooterPosition,shooterVelocity,targetPosition,targetVelocity),newTargetPosition=_this$standardize.newTargetPosition,newShooterVelocity=_this$standardize.newShooterVelocity,φ=_this$standardize.φ;var x=newTargetPosition.x;var result=null;if(Math.pow(newShooterVelocity.y,2)/(torpedoAcceleration*x)<Math.pow(10,-7)){var impactTurn=(-newShooterVelocity.x+Math.sqrt(Math.pow(newShooterVelocity.x,2)+2*torpedoAcceleration*x))/torpedoAcceleration;result={accelerationAngle:φ,impactTurn:impactTurn};}else if(newShooterVelocity.y>0){var θ=this.findRoot(newTargetPosition.x,newShooterVelocity.x,newShooterVelocity.y,torpedoAcceleration);var _impactTurn=-(2*newShooterVelocity.y)/(torpedoAcceleration*Math.sin(θ));result={accelerationAngle:θ+φ,impactTurn:_impactTurn};}else{var _=this.findRoot(newTargetPosition.x,newShooterVelocity.x,-newShooterVelocity.y,torpedoAcceleration);var _impactTurn2=2*newShooterVelocity.y/(torpedoAcceleration*Math.sin(_));result={accelerationAngle:2*Math.PI-_+φ,impactTurn:_impactTurn2};}var impactVelocity=Math.sqrt(Math.pow(-newShooterVelocity.x+targetVelocity.x-torpedoAcceleration*result.impactTurn*Math.cos(result.accelerationAngle),2)+Math.pow(-newShooterVelocity.y+targetVelocity.y-torpedoAcceleration*result.impactTurn*Math.sin(result.accelerationAngle),2));var accelerationVector=new utils_Vector(Math.cos(result.accelerationAngle),Math.sin(result.accelerationAngle)).normalize();if(Number.isNaN(result.accelerationAngle)||Number.isNaN(result.impactTurn)||Number.isNaN(accelerationVector)||Number.isNaN(impactVelocity)){throw new Error("Torpedo math encountered NaN with values '".concat(shooterPosition.toString(),", '").concat(shooterVelocity.toString(),", '").concat(targetPosition.toString(),", '").concat(targetVelocity.toString(),",'").concat(torpedoAcceleration,"'"));}var impactPosition=shooterPosition.add(shooterVelocity.multiplyScalar(result.impactTurn)).add(accelerationVector.multiplyScalar(0.5*torpedoAcceleration*Math.pow(result.impactTurn,2)));return Object(objectSpread2["a" /* default */])({},result,{accelerationVector:accelerationVector,impactVelocity:impactVelocity,impactPosition:impactPosition});}},{key:"findRoot",value:function findRoot(x,vx,vy,a){if(vx/vy-a*x/(2*Math.pow(vy,2)<0)){return this.findRoot2(x,vx,vy,a,3*Math.PI/2,this.findUpperLimit(x,vx,vy,a));}return this.findRoot2(x,vx,vy,a,this.findLowerLimit(x,vx,vy,a),3*Math.PI/2);}},{key:"f",value:function f(x,vx,vy,a,θ){return Math.cos(θ)/Math.pow(Math.sin(θ),2)-vx/(vy*Math.sin(θ))-a*x/(2*Math.pow(vy,2));}},{key:"findRoot2",value:function findRoot2(x,vx,vy,a,θ1,θ2){var θlow=θ1;var θhigh=θ2;var θmid=0;while(θhigh-θlow>Math.pow(10,-8)){θmid=(θlow+θhigh)/2;if(this.f(x,vx,vy,a,θmid)>0){θhigh=θmid;}else{θlow=θmid;}}return(θlow+θhigh)/2;}},{key:"findUpperLimit",value:function findUpperLimit(x,vx,vy,a){var i=1;while(true){var argument=2*Math.PI-Math.PI/Math.pow(2,i);var result=this.f(x,vx,vy,a,argument);if(result>0){return argument;}i++;}}},{key:"findLowerLimit",value:function findLowerLimit(x,vx,vy,a){var i=1;while(true){var argument=Math.PI+Math.PI/Math.pow(2,i);var result=this.f(x,vx,vy,a,argument);if(result<0){return argument;}i++;}}}]);return TorpedoMovementService;}();/* harmony default export */ var movement_TorpedoMovementService = (TorpedoMovementService_TorpedoMovementService);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/TorpedoAttack.js
function TorpedoAttack_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n"]);TorpedoAttack_templateObject3=function _templateObject3(){return data;};return data;}function TorpedoAttack_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 25%;\n  display: flex;\n\n  justify-content: center;\n\n  :first-child {\n    width: 50%;\n    justify-content: flex-start;\n  }\n\n  :last-child {\n    justify-content: flex-end;\n  }\n"]);TorpedoAttack_templateObject2=function _templateObject2(){return data;};return data;}function TorpedoAttack_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  z-index: 3;\n"]);TorpedoAttack_templateObject=function _templateObject(){return data;};return data;}var TorpedoAttack_Container=styled_components_browser_esm["b" /* default */].div(TorpedoAttack_templateObject());var Cell=styled_components_browser_esm["b" /* default */].div(TorpedoAttack_templateObject2());var TorpedoAttack_TorpedoList=styled_components_browser_esm["b" /* default */].div(TorpedoAttack_templateObject3());var TorpedoAttack_TorpedoAttack=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(TorpedoAttack,_React$Component);function TorpedoAttack(){Object(classCallCheck["a" /* default */])(this,TorpedoAttack);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoAttack).apply(this,arguments));}Object(createClass["a" /* default */])(TorpedoAttack,[{key:"render",value:function render(){var _this$props=this.props,uiState=_this$props.uiState,target=_this$props.ship;var gameData=uiState.gameData;var ships=gameData.ships.getShips().filter(function(otherShip){return!gameData.ships.isSameTeam(target,otherShip);}).sort(function(a,b){if(a.distanceTo(target)<b.distanceTo(target)){return 1;}if(a.distanceTo(target)>b.distanceTo(target)){return-1;}return 0;});return react_default.a.createElement(TorpedoAttack_Container,null,ships.map(function(shooter){return react_default.a.createElement(shipTooltip_WeaponTargetingList,{shooter:shooter,uiState:uiState,ship:target,key:"weaponTargetingList-".concat(shooter.id)});}));}}]);return TorpedoAttack;}(react_default.a.Component);/* harmony default export */ var shipTooltip_TorpedoAttack = (TorpedoAttack_TorpedoAttack);
// CONCATENATED MODULE: ./src/client/view/game/ui/HeatBar/ShipHeatBar.js
function ShipHeatBar_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])([""]);ShipHeatBar_templateObject2=function _templateObject2(){return data;};return data;}function ShipHeatBar_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-grow: 1;\n  "," {\n    width: 50px;\n    display: flex;\n    flex-grow: 1;\n    margin-left: 0;\n    margin-right: 0;\n  }\n"]);ShipHeatBar_templateObject=function _templateObject(){return data;};return data;}var ShipHeatBar_Container=styled_components_browser_esm["b" /* default */].div(ShipHeatBar_templateObject(),TooltipEntry);var ShipHeatBar_HeatBarContainer=styled_components_browser_esm["b" /* default */].div(ShipHeatBar_templateObject2());var ShipHeatBar_ShipHeatBar=function ShipHeatBar(_ref){var percent=_ref.percent,newPercent=_ref.newPercent;return react_default.a.createElement(ShipHeatBar_Container,null,react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipEntry,{noMargin:true},react_default.a.createElement(TooltipValueHeader,null,"Heat: ")),react_default.a.createElement(Bar_HeatBar,{percent:percent,newPercent:newPercent})));};/* harmony default export */ var HeatBar_ShipHeatBar = (ShipHeatBar_ShipHeatBar);
// CONCATENATED MODULE: ./src/client/view/game/ui/HeatBar/ShipFuelBar.js
function ShipFuelBar_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-grow: 1;\n  "," {\n    width: 50px;\n    display: flex;\n    flex-grow: 1;\n    margin-left: 0;\n    margin-right: 0;\n  }\n"]);ShipFuelBar_templateObject=function _templateObject(){return data;};return data;}var ShipFuelBar_Container=styled_components_browser_esm["b" /* default */].div(ShipFuelBar_templateObject(),TooltipEntry);var ShipFuelBar_ShipFuelBar=function ShipFuelBar(_ref){var fuel=_ref.fuel,space=_ref.space,newFuel=_ref.newFuel;var percent=fuel/space;var newPercent=newFuel/space;return react_default.a.createElement(ShipFuelBar_Container,null,react_default.a.createElement(TooltipEntry,null,react_default.a.createElement(TooltipEntry,{noMargin:true},react_default.a.createElement(TooltipValueHeader,null,"Fuel: ")),react_default.a.createElement(Bar_FuelBar,{percent:percent,newPercent:newPercent})));};/* harmony default export */ var HeatBar_ShipFuelBar = (ShipFuelBar_ShipFuelBar);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/ShipTooltipDetails.js
function ShipTooltipDetails_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin: 2px 0;\n"]);ShipTooltipDetails_templateObject3=function _templateObject3(){return data;};return data;}function ShipTooltipDetails_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin: 0 8px 5px 8px;\n"]);ShipTooltipDetails_templateObject2=function _templateObject2(){return data;};return data;}function ShipTooltipDetails_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]);ShipTooltipDetails_templateObject=function _templateObject(){return data;};return data;}var Row=styled_components_browser_esm["b" /* default */].div(ShipTooltipDetails_templateObject());var ShipTooltipDetails_Container=styled_components_browser_esm["b" /* default */].div(ShipTooltipDetails_templateObject2());var ShipDetailsTooltipEntry=Object(styled_components_browser_esm["b" /* default */])(TooltipEntry)(ShipTooltipDetails_templateObject3());var ShipTooltipDetails_ShipTooltipDetails=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(ShipTooltipDetails,_React$Component);function ShipTooltipDetails(){Object(classCallCheck["a" /* default */])(this,ShipTooltipDetails);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipTooltipDetails).apply(this,arguments));}Object(createClass["a" /* default */])(ShipTooltipDetails,[{key:"getEntry",value:function getEntry(header,value){return react["createElement"](ShipDetailsTooltipEntry,null,header&&react["createElement"](TooltipValueHeader,null,header,": "),value&&react["createElement"](TooltipValue,null,value));}},{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,uiState=_this$props.uiState;var currentUser=uiState.services.currentUser;var heatPercent=ship.systems.getTotalHeatStored()/ship.systems.getTotalHeatStorage();var heatChange=ship.systems.getPassiveHeatChange();var newHeatPercent=(ship.systems.getTotalHeatStored()+heatChange)/ship.systems.getTotalHeatStorage();var shipFuel=ship.movement.getFuel();var shipFuelSpace=ship.movement.getFuelSpace();var shipNewFuel=shipFuel-ship.movement.getFuelCost();return react["createElement"](ShipTooltipDetails_Container,null,react["createElement"](Row,null,this.getEntry("Hit profile","Front: ".concat(ship.getFrontHitProfile(),", Side: ").concat(ship.getSideHitProfile())),this.getEntry("DEW",ship.electronicWarfare.inEffect.getDefensiveEw()),this.getEntry("CCEW",ship.electronicWarfare.inEffect.getCcEw())),react["createElement"](Row,null,this.getEntry("Movement costs","Acc: ".concat(ship.accelcost,", Pivot: ").concat(ship.pivotcost,", Evasion: ").concat(ship.evasioncost,", Roll: ").concat(ship.rollcost))),react["createElement"](Row,null,ship.player.isUsers(currentUser)&&this.getEntry("Power available",ship.systems.power.getRemainingPowerOutput()),ship.player.isUsers(currentUser)&&this.getEntry("Planned DEW",ship.electronicWarfare.getDefensiveEw()),ship.player.isUsers(currentUser)&&this.getEntry("Planned CCEW",ship.electronicWarfare.getCcEw())),react["createElement"](Row,null,react["createElement"](HeatBar_ShipHeatBar,{percent:heatPercent,newPercent:newHeatPercent})),react["createElement"](Row,null,react["createElement"](HeatBar_ShipFuelBar,{fuel:shipFuel,space:shipFuelSpace,newFuel:shipNewFuel})));}}]);return ShipTooltipDetails;}(react["Component"]);/* harmony default export */ var shipTooltip_ShipTooltipDetails = (ShipTooltipDetails_ShipTooltipDetails);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/GameShipTooltipMenuBack.js
function GameShipTooltipMenuBack_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  transform: rotate(180deg);\n  height: 30px;\n"]);GameShipTooltipMenuBack_templateObject2=function _templateObject2(){return data;};return data;}function GameShipTooltipMenuBack_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])([""]);GameShipTooltipMenuBack_templateObject=function _templateObject(){return data;};return data;}var BackTooltipMenu=Object(styled_components_browser_esm["b" /* default */])(TooltipMenu)(GameShipTooltipMenuBack_templateObject());var RotatedButton=Object(styled_components_browser_esm["b" /* default */])(TooltipButton)(GameShipTooltipMenuBack_templateObject2());var GameShipTooltipMenuBack_GameShipTooltipMenuBack=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(GameShipTooltipMenuBack,_React$PureComponent);function GameShipTooltipMenuBack(){Object(classCallCheck["a" /* default */])(this,GameShipTooltipMenuBack);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameShipTooltipMenuBack).apply(this,arguments));}Object(createClass["a" /* default */])(GameShipTooltipMenuBack,[{key:"render",value:function render(){var selectTooltipTab=this.props.selectTooltipTab;return react["createElement"](BackTooltipMenu,null,react["createElement"](RotatedButton,{onClick:function onClick(){return selectTooltipTab(null);}},react["createElement"](icon_Play,null)));}}]);return GameShipTooltipMenuBack;}(react["PureComponent"]);/* harmony default export */ var shipTooltip_GameShipTooltipMenuBack = (GameShipTooltipMenuBack_GameShipTooltipMenuBack);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/TorpedoDefense/TorpedoDefenseTooltip.js
var TorpedoDefenseTooltip_getAttackRunMessages=function getAttackRunMessages(shooter,target,torpedoFlight){return[].concat(Object(toConsumableArray["a" /* default */])(torpedoFlight.torpedo.damageStrategy.getAttackRunMessages({shooter:shooter,target:target,torpedoFlight:torpedoFlight})),[{header:"CCEW",value:shooter.electronicWarfare.getCcEw()}]);};var getInterceptors=function getInterceptors(shooter,target,torpedoFlight,uiState){var interceptors=uiState.services.torpedoAttackService.getPossibleInterceptors(shooter,torpedoFlight);var interceptChance=interceptors.map(function(interceptor){return{interceptor:interceptor,interceptChance:interceptor.callHandler("getInterceptChance",{target:target,torpedoFlight:torpedoFlight})};}).sort(function(a,b){if(a.interceptChance.result>b.interceptChance.result){return 1;}if(a.interceptChance.result<b.interceptChance.result){return-1;}return 0;});var interceptorGroups=[];interceptChance.forEach(function(intercept){var entry=interceptorGroups.find(function(group){return group.name===intercept.interceptor.getDisplayName();});if(!entry){entry={name:intercept.interceptor.getDisplayName(),intercepts:intercept.interceptor.callHandler("getNumberOfIntercepts",null,1),min:null,max:null,amount:0};interceptorGroups.push(entry);}if(intercept.interceptChance.result<entry.min||entry.min===null){entry.min=intercept.interceptChance.result;}if(intercept.interceptChance.result>entry.max||entry.max===null){entry.max=intercept.interceptChance.result;}entry.amount++;});var getInterceptValue=function getInterceptValue(min,max){if(min<0){min=0;}if(max<0){max=0;}if(min===max){return"".concat(max,"%");}return"".concat(min,"% - ").concat(max,"%");};return interceptorGroups.map(function(group){return{header:"".concat(group.amount*group.intercepts,"x ").concat(group.name),value:getInterceptValue(group.min,group.max)};});};var TorpedoDefenseTooltip_TorpedoDefenseTooltip=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(TorpedoDefenseTooltip,_React$Component);function TorpedoDefenseTooltip(){Object(classCallCheck["a" /* default */])(this,TorpedoDefenseTooltip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoDefenseTooltip).apply(this,arguments));}Object(createClass["a" /* default */])(TorpedoDefenseTooltip,[{key:"render",value:function render(){var _this$props=this.props,shooter=_this$props.shooter,target=_this$props.target,torpedoFlight=_this$props.torpedoFlight,uiState=_this$props.uiState;var interceptorEntries=Tooltip_buildTooltipEntries(getInterceptors(shooter,target,torpedoFlight,uiState));return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipHeader,null,"TORPEDO DEFENSE"),Tooltip_buildTooltipEntries(TorpedoDefenseTooltip_getAttackRunMessages(shooter,target,torpedoFlight)),react_default.a.createElement(TooltipHeader,null,"INTERCEPTORS"),interceptorEntries.length>0?interceptorEntries:"No available interceptors");}}]);return TorpedoDefenseTooltip;}(react_default.a.Component);/* harmony default export */ var TorpedoDefense_TorpedoDefenseTooltip = (TorpedoDefenseTooltip_TorpedoDefenseTooltip);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/TorpedoDefense/IncomingTorpedo.js
function IncomingTorpedo_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: inline-flex;\n"]);IncomingTorpedo_templateObject=function _templateObject(){return data;};return data;}var IncomingTorpedo_TorpedoCargoItem=Object(styled_components_browser_esm["b" /* default */])(cargo_CargoItem)(IncomingTorpedo_templateObject());function IncomingTorpedo(_ref){var uiState=_ref.uiState,torpedoFlight=_ref.torpedoFlight,ship=_ref.ship,shooter=_ref.shooter;var torpedoMouseOut=function torpedoMouseOut(){/*
    uiState.customEvent("torpedoMouseOut", {
      ship: launcher.system.shipSystems.ship,
      torpedo: launcher.loadedTorpedo,
      target
    });
    */};var torpedoMouseOver=function torpedoMouseOver(){/*
    uiState.customEvent("torpedoMouseOver", {
      ship: launcher.system.shipSystems.ship,
      torpedo: launcher.loadedTorpedo,
      target
    });
    */};return react_default.a.createElement(IncomingTorpedo_TorpedoCargoItem,{ship:ship,handleOnClick:function handleOnClick(){},handleMouseOver:torpedoMouseOver,handleMouseOut:torpedoMouseOut,cargo:torpedoFlight.torpedo,amount:null,text:"",absoluteTooltip:"left",tooltipAdditionalContent:react_default.a.createElement(TorpedoDefense_TorpedoDefenseTooltip,{shooter:shooter,target:ship,torpedoFlight:torpedoFlight,uiState:uiState})});}
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/TorpedoDefense/TorpedoDefense.js
function TorpedoDefense_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n"]);TorpedoDefense_templateObject=function _templateObject(){return data;};return data;}var TorpedoDefense_TorpedoList=styled_components_browser_esm["b" /* default */].div(TorpedoDefense_templateObject());var sortFlights=function sortFlights(a,b){if(a.torpedo.maxRange<b.torpedo.maxRange){return 1;}if(a.torpedo.maxRange>b.torpedo.maxRange){return-1;}if(a.torpedo.damageStrategy.constructor.name<b.torpedo.damageStrategy.constructor.name){return 1;}if(a.torpedo.damageStrategy.constructor.name>b.torpedo.damageStrategy.constructor.name){return-1;}if(a.torpedo.getDisplayName()<b.torpedo.getDisplayName()){return 1;}if(a.torpedo.getDisplayName()>b.torpedo.getDisplayName()){return-1;}return 0;};var getTorpedosAgainstThisShip=function getTorpedosAgainstThisShip(ship,gameData){return gameData.torpedos.getTorpedoFlights().filter(function(flight){return flight.targetId===ship.id;}).sort(sortFlights);};var getTorpedosAgainstFriendlyShips=function getTorpedosAgainstFriendlyShips(ship,gameData,torpedoAttackService){var entries=[];gameData.torpedos.getTorpedoFlights().filter(function(flight){return flight.targetId!==ship.id&&gameData.ships.isSameTeam(ship,gameData.ships.getShipById(flight.targetId));}).forEach(function(flight){var target=gameData.ships.getShipById(flight.targetId);var entry=entries.find(function(_ref){var entryShip=_ref.ship;return entryShip.id===target.id;});if(!entry){entry={ship:target,flights:[]};entries.push(entry);}entry.flights.push(flight);});return entries.filter(function(_ref2){var targetShip=_ref2.ship,flights=_ref2.flights;return flights.some(function(flight){torpedoAttackService.getPossibleInterceptors(ship,flight).some(function(interceptor){return interceptor.callHandler("getInterceptChance",{target:targetShip,torpedoFlight:flight},0)>0;});});}).map(function(_ref3){var targetShip=_ref3.ship,flights=_ref3.flights;return{ship:targetShip,flights:flights.sort(sortFlights)};});};var TorpedoDefense_TorpedoDefense=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(TorpedoDefense,_React$Component);function TorpedoDefense(){Object(classCallCheck["a" /* default */])(this,TorpedoDefense);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoDefense).apply(this,arguments));}Object(createClass["a" /* default */])(TorpedoDefense,[{key:"render",value:function render(){var _this$props=this.props,uiState=_this$props.uiState,ship=_this$props.ship;var gameData=uiState.gameData;var torpedos=getTorpedosAgainstThisShip(ship,gameData);var friendlyEntries=getTorpedosAgainstFriendlyShips(ship,gameData,uiState.services.torpedoAttackService);console.log("friendlyEntries",friendlyEntries);return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipHeader,null,ship.name," ",react_default.a.createElement(TooltipValue,null,"This ship")),react_default.a.createElement("div",null,torpedos.map(function(flight){return react_default.a.createElement(IncomingTorpedo,{key:"incoming-torpedo-".concat(flight.id),ship:ship,torpedoFlight:flight,shooter:ship,uiState:uiState});})),react_default.a.createElement("div",null,friendlyEntries.map(function(_ref4){var targetShip=_ref4.ship,flights=_ref4.flights;return react_default.a.createElement("div",{key:"incoming-torpedo-friendly-defense-".concat(ship.id,"-").concat(targetShip.id)},react_default.a.createElement(TooltipHeader,null,targetShip.name),flights.map(function(flight){return react_default.a.createElement(IncomingTorpedo,{key:"incoming-torpedo-friendly-".concat(flight.id),ship:targetShip,torpedoFlight:flight,shooter:ship,uiState:uiState});}));})));}}]);return TorpedoDefense;}(react_default.a.Component);/* harmony default export */ var shipTooltip_TorpedoDefense_TorpedoDefense = (TorpedoDefense_TorpedoDefense);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/TorpedoDefense/index.js
/* harmony default export */ var shipTooltip_TorpedoDefense = (shipTooltip_TorpedoDefense_TorpedoDefense);
// EXTERNAL MODULE: ./node_modules/axios/index.js
var axios = __webpack_require__(33);
var axios_default = /*#__PURE__*/__webpack_require__.n(axios);

// CONCATENATED MODULE: ./src/client/config.js
var SERVER_URL="http://localhost:4000";var SERVER_WEBSOCKET_URL="ws://localhost:4000/game/";
// CONCATENATED MODULE: ./src/client/api/user.js
var axiosConfig={withCredentials:true,headers:{"Content-Type":"application/json"}};var login=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(username,password){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios_default.a.post("".concat(SERVER_URL,"/login"),{username:username,password:password},axiosConfig);case 3:return _context.abrupt("return",_context.sent);case 6:_context.prev=6;_context.t0=_context["catch"](0);throw _context.t0.response;case 9:case"end":return _context.stop();}}},_callee,null,[[0,6]]);}));return function login(_x,_x2){return _ref.apply(this,arguments);};}();var register=/*#__PURE__*/function(){var _ref2=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(username,password){return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios_default.a.post("".concat(SERVER_URL,"/register"),{username:username,password:password},axiosConfig);case 3:return _context2.abrupt("return",_context2.sent);case 6:_context2.prev=6;_context2.t0=_context2["catch"](0);throw _context2.t0.response;case 9:case"end":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function register(_x3,_x4){return _ref2.apply(this,arguments);};}();var getCurrentUser=/*#__PURE__*/function(){var _ref3=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee3(){return regenerator_default.a.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios_default.a.get("".concat(SERVER_URL,"/user"),axiosConfig);case 3:return _context3.abrupt("return",_context3.sent);case 6:_context3.prev=6;_context3.t0=_context3["catch"](0);throw _context3.t0.response;case 9:case"end":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function getCurrentUser(){return _ref3.apply(this,arguments);};}();var logout=/*#__PURE__*/function(){var _ref4=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee4(){return regenerator_default.a.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios_default.a.get("".concat(SERVER_URL,"/logout"),axiosConfig);case 3:return _context4.abrupt("return",_context4.sent);case 6:_context4.prev=6;_context4.t0=_context4["catch"](0);throw _context4.t0.response;case 9:case"end":return _context4.stop();}}},_callee4,null,[[0,6]]);}));return function logout(){return _ref4.apply(this,arguments);};}();
// CONCATENATED MODULE: ./src/client/api/game.js
var game_axiosConfig={withCredentials:true,headers:{"Content-Type":"application/json"}};var game_createGame=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(gameData){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;return _context.abrupt("return",axios_default.a.post("".concat(SERVER_URL,"/game"),gameData.serialize(),game_axiosConfig));case 4:_context.prev=4;_context.t0=_context["catch"](0);throw _context.t0.response;case 7:case"end":return _context.stop();}}},_callee,null,[[0,4]]);}));return function createGame(_x){return _ref.apply(this,arguments);};}();var createTestGameGame=/*#__PURE__*/function(){var _ref2=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(gameData){return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;return _context2.abrupt("return",axios_default.a.post("".concat(SERVER_URL,"/testGame"),{},game_axiosConfig));case 4:_context2.prev=4;_context2.t0=_context2["catch"](0);throw _context2.t0.response;case 7:case"end":return _context2.stop();}}},_callee2,null,[[0,4]]);}));return function createTestGameGame(_x2){return _ref2.apply(this,arguments);};}();
// CONCATENATED MODULE: ./src/client/api/index.js

// CONCATENATED MODULE: ./src/client/state/actions.js
var actionTypes={GET_CURRENT_USER:"GET_CURRENT_USER"};var actions_getCurrentUser=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(dispatch){var payload;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return user_namespaceObject.getCurrentUser();case 2:payload=_context.sent;dispatch({type:actionTypes.GET_CURRENT_USER,payload:payload});case 4:case"end":return _context.stop();}}},_callee);}));return function getCurrentUser(_x){return _ref.apply(this,arguments);};}();var actions_reducer=function reducer(state,action){switch(action.type){case"GET_CURRENT_USER":var _user=action.payload.data?new model_User().deserialize(action.payload.data):null;return Object(objectSpread2["a" /* default */])({},state,{currentUser:_user});default:return state;}};
// CONCATENATED MODULE: ./src/client/state/StoreProvider.js
var StateStore=react_default.a.createContext({});var DispatchStore=react_default.a.createContext({});var initialState={currentUser:undefined};var StoreProvider_StoreProvider=function StoreProvider(_ref){var children=_ref.children;var _useReducer=Object(react["useReducer"])(actions_reducer,initialState),_useReducer2=Object(slicedToArray["a" /* default */])(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];Object(react["useEffect"])(function(){actions_getCurrentUser(dispatch);},[]);return react_default.a.createElement(DispatchStore.Provider,{value:dispatch},react_default.a.createElement(StateStore.Provider,{value:state},children));};/* harmony default export */ var state_StoreProvider = (StoreProvider_StoreProvider);
// CONCATENATED MODULE: ./src/client/view/game/ui/ShipName.js
function ShipName_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: ",";\n"]);ShipName_templateObject=function _templateObject(){return data;};return data;}var ShipNameContainer=styled_components_browser_esm["b" /* default */].span(ShipName_templateObject(),function(props){return props.isMine?Colors_namespaceObject.lightBlue:Colors_namespaceObject.textDanger;});function ShipName_ShipName(_ref){var ship=_ref.ship;var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;var isMine=ship.player.isUsers(currentUser);return react_default.a.createElement(ShipNameContainer,{isMine:isMine},ship.name||"Unnamed ship");}
// CONCATENATED MODULE: ./src/client/view/game/ui/electronicWarfare/CCEWButtons.js
function CCEWButtons_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 25px;\n  height: 25px;\n"]);CCEWButtons_templateObject4=function _templateObject4(){return data;};return data;}function CCEWButtons_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n  padding: 0 5px 0 30px;\n  width: 200px;\n  overflow: hidden;\n"]);CCEWButtons_templateObject3=function _templateObject3(){return data;};return data;}function CCEWButtons_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: white;\n  font-size: 18px;\n  font-weight: bold;\n  font-family: arial;\n  font-size: 16px;\n  text-transform: uppercase;\n"]);CCEWButtons_templateObject2=function _templateObject2(){return data;};return data;}function CCEWButtons_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  align-items: center;\n"]);CCEWButtons_templateObject=function _templateObject(){return data;};return data;}var CCEWButtons_Container=styled_components_browser_esm["b" /* default */].div(CCEWButtons_templateObject());var CCEWButtons_Text=Object(styled_components_browser_esm["a" /* css */])(CCEWButtons_templateObject2());var CCEWButtons_ShipName=styled_components_browser_esm["b" /* default */].div(CCEWButtons_templateObject3(),CCEWButtons_Text);var CCEWButtons_Amount=styled_components_browser_esm["b" /* default */].div(CCEWButtons_templateObject4(),CCEWButtons_Text);var CCEWButtons_CCEWButtons=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(CCEWButtons,_React$PureComponent);function CCEWButtons(){Object(classCallCheck["a" /* default */])(this,CCEWButtons);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CCEWButtons).apply(this,arguments));}Object(createClass["a" /* default */])(CCEWButtons,[{key:"render",value:function render(){var _this$props=this.props,name=_this$props.name,ship=_this$props.ship,uiState=_this$props.uiState,ccew=_this$props.ccew,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["name","ship","uiState","ccew"]);return react["createElement"](CCEWButtons_Container,rest,name&&react["createElement"](CCEWButtons_ShipName,null,name),react["createElement"](TooltipButton,{img:"/img/removeCCEW.png",onClick:function onClick(){if(ship.electronicWarfare.canAssignCcEw(-1)){ship.electronicWarfare.assignCcEw(-1);uiState.shipStateChanged(ship);}}}),react["createElement"](CCEWButtons_Amount,null,ccew),react["createElement"](TooltipButton,{img:"/img/addCCEW.png",onClick:function onClick(){if(ship.electronicWarfare.canAssignCcEw(1)){ship.electronicWarfare.assignCcEw(1);uiState.shipStateChanged(ship);}}}));}}]);return CCEWButtons;}(react["PureComponent"]);/* harmony default export */ var electronicWarfare_CCEWButtons = (CCEWButtons_CCEWButtons);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/GameShipTooltipMenuTorpedoDefense.js
function GameShipTooltipMenuTorpedoDefense_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  transform: rotate(180deg);\n  height: 30px;\n"]);GameShipTooltipMenuTorpedoDefense_templateObject2=function _templateObject2(){return data;};return data;}function GameShipTooltipMenuTorpedoDefense_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])([""]);GameShipTooltipMenuTorpedoDefense_templateObject=function _templateObject(){return data;};return data;}var GameShipTooltipMenuTorpedoDefense_BackTooltipMenu=Object(styled_components_browser_esm["b" /* default */])(TooltipMenu)(GameShipTooltipMenuTorpedoDefense_templateObject());var GameShipTooltipMenuTorpedoDefense_RotatedButton=Object(styled_components_browser_esm["b" /* default */])(TooltipButton)(GameShipTooltipMenuTorpedoDefense_templateObject2());var GameShipTooltipMenuTorpedoDefense_GameShipTooltipMenuTorpedoDefense=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(GameShipTooltipMenuTorpedoDefense,_React$PureComponent);function GameShipTooltipMenuTorpedoDefense(){Object(classCallCheck["a" /* default */])(this,GameShipTooltipMenuTorpedoDefense);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameShipTooltipMenuTorpedoDefense).apply(this,arguments));}Object(createClass["a" /* default */])(GameShipTooltipMenuTorpedoDefense,[{key:"render",value:function render(){var _this$props=this.props,selectTooltipTab=_this$props.selectTooltipTab,ship=_this$props.ship,uiState=_this$props.uiState;return react["createElement"](GameShipTooltipMenuTorpedoDefense_BackTooltipMenu,null,react["createElement"](GameShipTooltipMenuTorpedoDefense_RotatedButton,{onClick:function onClick(){return selectTooltipTab(null);}},react["createElement"](icon_Play,null)),react["createElement"](electronicWarfare_CCEWButtons,{ship:ship,uiState:uiState,ccew:ship.electronicWarfare.getCcEw()}));}}]);return GameShipTooltipMenuTorpedoDefense;}(react["PureComponent"]);/* harmony default export */ var shipTooltip_GameShipTooltipMenuTorpedoDefense = (GameShipTooltipMenuTorpedoDefense_GameShipTooltipMenuTorpedoDefense);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/ShipTooltip.js
function ShipTooltip_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: white;\n"]);ShipTooltip_templateObject4=function _templateObject4(){return data;};return data;}function ShipTooltip_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  text-align: left;\n  color: #5e85bc;\n  font-family: arial;\n  font-size: 11px;\n"]);ShipTooltip_templateObject3=function _templateObject3(){return data;};return data;}function ShipTooltip_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 315px;\n  text-align: left;\n  opacity: 0.95;\n  position: absolute;\n  top: 50px;\n  ","\n\n  ","\n"]);ShipTooltip_templateObject2=function _templateObject2(){return data;};return data;}function ShipTooltip_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  justify-content: space-between;\n"]);ShipTooltip_templateObject=function _templateObject(){return data;};return data;}var ShipTooltip_InfoHeader=Object(styled_components_browser_esm["b" /* default */])(TooltipHeader)(ShipTooltip_templateObject());var ShipTooltipContainer=Object(styled_components_browser_esm["b" /* default */])(Tooltip)(ShipTooltip_templateObject2(),function(props){return props.right?"right: 220px;":"left: 220px;";},function(props){return props.interactable?"z-index: 4;":"z-index: 1;";});var ShipTooltip_Entry=Object(styled_components_browser_esm["b" /* default */])(TooltipEntry)(ShipTooltip_templateObject3());var ShipTooltip_Header=styled_components_browser_esm["b" /* default */].span(ShipTooltip_templateObject4());var TOOLTIP_TAB_TORPEDO_ATTACK="tooltip_tab_torpedo_attack";var TOOLTIP_TAB_TORPEDO_DEFENSE="tooltip_tab_torpedo_defense";var ShipTooltip_ShipTooltip=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(ShipTooltip,_React$Component);function ShipTooltip(props){var _this;Object(classCallCheck["a" /* default */])(this,ShipTooltip);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipTooltip).call(this,props));_this.state={tooltipTab:null};return _this;}Object(createClass["a" /* default */])(ShipTooltip,[{key:"selectTooltipTab",value:function selectTooltipTab(name){this.setState({tooltipTab:name});}},{key:"getMenu",value:function getMenu(){var _this$props=this.props,ui=_this$props.ui,shipTooltipMenuProvider=_this$props.shipTooltipMenuProvider;var tooltipTab=this.getTooltipTab();if(!tooltipTab){var Menu=ui&&shipTooltipMenuProvider?shipTooltipMenuProvider():null;return Menu;}if(tooltipTab&&ui){if(tooltipTab===TOOLTIP_TAB_TORPEDO_DEFENSE){return shipTooltip_GameShipTooltipMenuTorpedoDefense;}return shipTooltip_GameShipTooltipMenuBack;}return null;}},{key:"getTabHeader",value:function getTabHeader(){var tooltipTab=this.state.tooltipTab;switch(tooltipTab){case TOOLTIP_TAB_TORPEDO_ATTACK:return"Weapon assignment";case TOOLTIP_TAB_TORPEDO_DEFENSE:return"Torpedo defense";default:return"Ship details";}}},{key:"getTooltipTab",value:function getTooltipTab(){var _this$props2=this.props,ship=_this$props2.ship,uiState=_this$props2.uiState;var tooltipTab=this.state.tooltipTab;var currentUser=uiState.services.currentUser;var myShip=ship.player.isUsers(currentUser);if(tooltipTab===TOOLTIP_TAB_TORPEDO_ATTACK&&myShip){return null;}return tooltipTab;}},{key:"render",value:function render(){var _this$props3=this.props,ship=_this$props3.ship,getPosition=_this$props3.getPosition,uiState=_this$props3.uiState,ui=_this$props3.ui,shipTooltipMenuProvider=_this$props3.shipTooltipMenuProvider,className=_this$props3.className,rest=Object(objectWithoutProperties["a" /* default */])(_this$props3,["ship","getPosition","uiState","ui","shipTooltipMenuProvider","className"]);var tooltipTab=this.getTooltipTab();var Menu=this.getMenu();var interactable=Boolean(Menu)||tooltipTab;return react["createElement"](ShipTooltipContainer,{right:rest.right,className:className,interactable:interactable},react["createElement"](ShipTooltip_InfoHeader,null,react["createElement"]("div",null,react["createElement"](ShipName_ShipName,{ship:ship}))," ",react["createElement"]("div",null,this.getTabHeader()," ",react["createElement"](Button_CloseButton,{onClick:function onClick(){uiState.hideShipTooltip(ship);uiState.customEvent("shipTooltipClosed",ship);}}))),Menu&&react["createElement"](Menu,Object.assign({uiState:uiState,ship:ship,selectTooltipTab:this.selectTooltipTab.bind(this)},rest)),!tooltipTab&&react["createElement"](react["Fragment"],null,Menu&&react["createElement"](shipTooltip_WeaponTargetingList,Object.assign({uiState:uiState,ship:ship},rest)),react["createElement"](shipTooltip_ShipTooltipDetails,{ship:ship,uiState:uiState}),react["createElement"](shipWindow_ShipWindow,Object.assign({ship:ship,uiState:uiState},rest))),tooltipTab===TOOLTIP_TAB_TORPEDO_ATTACK&&react["createElement"](shipTooltip_TorpedoAttack,Object.assign({ship:ship,uiState:uiState},rest)),tooltipTab===TOOLTIP_TAB_TORPEDO_DEFENSE&&react["createElement"](shipTooltip_TorpedoDefense,Object.assign({ship:ship,uiState:uiState},rest)));}}]);return ShipTooltip;}(react["Component"]);/* harmony default export */ var shipTooltip_ShipTooltip = (ShipTooltip_ShipTooltip);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/GameShipTooltipMenu.js
var toggleRadiators=function toggleRadiators(ship,uiState){var on=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;ship.systems.getSystems().filter(function(system){return!system.isDestroyed();}).filter(function(system){return system.callHandler("isRadiator",null,false);}).filter(function(system){if(on){return system.power.canSetOnline();}else{return system.power.canSetOffline();}}).forEach(function(system){if(on){system.power.setOnline();}else{system.power.setOffline();}uiState.shipSystemStateChanged(ship,system);});};var hasRadiators=function hasRadiators(ship){return ship.systems.getSystems().filter(function(system){return!system.isDestroyed();}).filter(function(system){return system.callHandler("isRadiator",null,false);}).length>0;};var hasOnlineradiators=function hasOnlineradiators(ship){return ship.systems.getSystems().filter(function(system){return!system.isDestroyed();}).filter(function(system){return system.callHandler("isRadiator",null,false);}).filter(function(system){return system.power.canSetOffline();}).filter(function(system){return system.power.isOnline();}).length>0;};var toggleInterceptors=function toggleInterceptors(ship,uiState){var on=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;ship.systems.getSystems().filter(function(system){return!system.isDestroyed();}).filter(function(system){return system.callHandler("canIntercept",null,false);}).filter(function(system){if(on){return system.power.canSetOnline();}else{return system.power.canSetOffline();}}).forEach(function(system){if(on){system.power.setOnline();}else{system.power.setOffline();}uiState.shipSystemStateChanged(ship,system);});};var hasInterceptors=function hasInterceptors(ship){return ship.systems.getSystems().filter(function(system){return!system.isDestroyed();}).filter(function(system){return system.callHandler("canIntercept",null,false);}).length>0;};var hasOnlineInterceptors=function hasOnlineInterceptors(ship){return ship.systems.getSystems().filter(function(system){return!system.isDestroyed();}).filter(function(system){return system.callHandler("canIntercept",null,false);}).filter(function(system){return system.power.canSetOffline();}).filter(function(system){return system.power.isOnline();}).length>0;};var GameShipTooltipMenu_GameShipTooltipMenu=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(GameShipTooltipMenu,_React$PureComponent);function GameShipTooltipMenu(){Object(classCallCheck["a" /* default */])(this,GameShipTooltipMenu);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameShipTooltipMenu).apply(this,arguments));}Object(createClass["a" /* default */])(GameShipTooltipMenu,[{key:"render",value:function render(){var _this=this;var _this$props=this.props,ship=_this$props.ship,uiState=_this$props.uiState,selectTooltipTab=_this$props.selectTooltipTab;var currentUser=uiState.services.currentUser;var selectedShip=uiState.getSelectedShip();return react["createElement"](TooltipMenu,null,ship.player.isUsers(currentUser)&&!uiState.isSelected(ship)&&react["createElement"](TooltipButton,{img:"/img/selectShip.png",onClick:function onClick(){return uiState.selectShip(ship);}}),ship.player.isUsers(currentUser)&&selectedShip&&react["createElement"](electronicWarfare_CCEWButtons,{ship:ship,uiState:uiState,ccew:selectedShip.electronicWarfare.getCcEw()}),!ship.player.isUsers(currentUser)&&selectedShip&&react["createElement"](electronicWarfare_OEWButtons,{ship:selectedShip,target:ship,uiState:uiState,oew:selectedShip.electronicWarfare.getOffensiveEw(ship)}),ship.player.isUsers(currentUser)&&hasRadiators(ship)&&react["createElement"](TooltipButton,{img:"/img/system/radiator.png",onClick:function onClick(e){e.preventDefault();e.stopPropagation();toggleRadiators(ship,uiState,hasOnlineradiators(ship)?false:true);uiState.shipStateChanged(ship);_this.forceUpdate();}}),ship.player.isUsers(currentUser)&&hasInterceptors(ship)&&react["createElement"](TooltipButton,{img:"/img/system/gatlingPulseCannon.png",onClick:function onClick(e){e.preventDefault();e.stopPropagation();toggleInterceptors(ship,uiState,hasOnlineInterceptors(ship)?false:true);uiState.shipStateChanged(ship);_this.forceUpdate();}}),!ship.player.isUsers(currentUser)&&react["createElement"](TooltipButton,{img:"/img/system/missile1.png",onClick:function onClick(){return selectTooltipTab(TOOLTIP_TAB_TORPEDO_ATTACK);}}),ship.player.isUsers(currentUser)&&react["createElement"](TooltipButton,{img:"/img/torpedoDefense.png",onClick:function onClick(){return selectTooltipTab(TOOLTIP_TAB_TORPEDO_DEFENSE);}}));}}]);return GameShipTooltipMenu;}(react["PureComponent"]);/* harmony default export */ var shipTooltip_GameShipTooltipMenu = (GameShipTooltipMenu_GameShipTooltipMenu);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/GameShipTooltipMenuStrategy.js
var GameShipTooltipMenuStrategy_GameShipTooltipMenuStrategy=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(GameShipTooltipMenuStrategy,_UiStrategy);function GameShipTooltipMenuStrategy(){Object(classCallCheck["a" /* default */])(this,GameShipTooltipMenuStrategy);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameShipTooltipMenuStrategy).apply(this,arguments));}Object(createClass["a" /* default */])(GameShipTooltipMenuStrategy,[{key:"activate",value:function activate(services){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(GameShipTooltipMenuStrategy.prototype),"activate",this).call(this,services);var uiState=this.services.uiState;uiState.setTooltipMenuProvider(this.getTooltipComponent);}},{key:"deactivate",value:function deactivate(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(GameShipTooltipMenuStrategy.prototype),"deactivate",this).call(this);var uiState=this.services.uiState;uiState.setTooltipMenuProvider(null);}},{key:"getTooltipComponent",value:function getTooltipComponent(){return shipTooltip_GameShipTooltipMenu;}}]);return GameShipTooltipMenuStrategy;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_GameShipTooltipMenuStrategy = (GameShipTooltipMenuStrategy_GameShipTooltipMenuStrategy);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowUiModeButtons.js
var ShowUiModeButtons_ShowUiModeButtons=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(ShowUiModeButtons,_UiStrategy);function ShowUiModeButtons(){Object(classCallCheck["a" /* default */])(this,ShowUiModeButtons);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowUiModeButtons).apply(this,arguments));}Object(createClass["a" /* default */])(ShowUiModeButtons,[{key:"activate",value:function activate(services){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowUiModeButtons.prototype),"activate",this).call(this,services);var uiState=this.services.uiState;uiState.showUiModeButtons(true);}},{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.showUiModeButtons(false);}}]);return ShowUiModeButtons;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_ShowUiModeButtons = (ShowUiModeButtons_ShowUiModeButtons);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/electronicWarfare/OwnedShipEw.js
var OwnedShipEw_OwnedShipEw=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(OwnedShipEw,_UiStrategy);function OwnedShipEw(){Object(classCallCheck["a" /* default */])(this,OwnedShipEw);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OwnedShipEw).apply(this,arguments));}Object(createClass["a" /* default */])(OwnedShipEw,[{key:"deactivate",value:function deactivate(){var electronicWarfareIndicatorService=this.services.electronicWarfareIndicatorService;electronicWarfareIndicatorService.hideAll();}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(OwnedShipEw.prototype),"update",this).call(this,gameData);this.show();}},{key:"uiStateChanged",value:function uiStateChanged(){if(!this.gameData){return;}this.show();}},{key:"shipStateChanged",value:function shipStateChanged(ship){var _this$services=this.services,electronicWarfareIndicatorService=_this$services.electronicWarfareIndicatorService,uiState=_this$services.uiState;if(!this.gameData){return;}if(!uiState.hasGameUiMode(EW)&&uiState.getSelectedShip()!==ship){return;}electronicWarfareIndicatorService.showForShip(ship);}},{key:"mouseOutShip",value:function mouseOutShip(){this.show();}},{key:"show",value:function show(){var _this$services2=this.services,electronicWarfareIndicatorService=_this$services2.electronicWarfareIndicatorService,uiState=_this$services2.uiState,currentUser=_this$services2.currentUser;electronicWarfareIndicatorService.hideAll();if(uiState.hasGameUiMode(EW)){this.gameData.ships.getUsersShips(currentUser).forEach(function(ship){return electronicWarfareIndicatorService.showForShip(ship);});}if(!uiState.hasGameUiMode([ENEMY_WEAPONS,WEAPONS])){var ship=uiState.getSelectedShip();if(ship){electronicWarfareIndicatorService.showForShip(ship);}}}}]);return OwnedShipEw;}(uiStrategy_UiStrategy);/* harmony default export */ var electronicWarfare_OwnedShipEw = (OwnedShipEw_OwnedShipEw);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/electronicWarfare/MouseOverShowsElectronicWarfare.js
var MouseOverShowsElectronicWarfare_MouseOverShowsElectronicWarfare=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(MouseOverShowsElectronicWarfare,_UiStrategy);function MouseOverShowsElectronicWarfare(){Object(classCallCheck["a" /* default */])(this,MouseOverShowsElectronicWarfare);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(MouseOverShowsElectronicWarfare).apply(this,arguments));}Object(createClass["a" /* default */])(MouseOverShowsElectronicWarfare,[{key:"deactivate",value:function deactivate(){var electronicWarfareIndicatorService=this.services.electronicWarfareIndicatorService;electronicWarfareIndicatorService.hideAll();}},{key:"mouseOverShip",value:function mouseOverShip(payload){var electronicWarfareIndicatorService=this.services.electronicWarfareIndicatorService;electronicWarfareIndicatorService.hideAll();electronicWarfareIndicatorService.showForShip(payload.entity.ship);}},{key:"mouseOutShip",value:function mouseOutShip(){var electronicWarfareIndicatorService=this.services.electronicWarfareIndicatorService;electronicWarfareIndicatorService.hideAll();}}]);return MouseOverShowsElectronicWarfare;}(uiStrategy_UiStrategy);/* harmony default export */ var electronicWarfare_MouseOverShowsElectronicWarfare = (MouseOverShowsElectronicWarfare_MouseOverShowsElectronicWarfare);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShipClickSelectsShip.js
var ShipClickSelectsShip_ShipClickSelectsShip=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(ShipClickSelectsShip,_UiStrategy);function ShipClickSelectsShip(){Object(classCallCheck["a" /* default */])(this,ShipClickSelectsShip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipClickSelectsShip).apply(this,arguments));}Object(createClass["a" /* default */])(ShipClickSelectsShip,[{key:"shipClicked",value:function shipClicked(payload){var _this$services=this.services,uiState=_this$services.uiState,currentUser=_this$services.currentUser;var ship=payload.entity.ship;if(ship.player.isUsers(currentUser)&&!uiState.isSelected(ship)){uiState.selectShip(ship);}}}]);return ShipClickSelectsShip;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_ShipClickSelectsShip = (ShipClickSelectsShip_ShipClickSelectsShip);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/electronicWarfare/CurrentEW.js
var CurrentEW_CurrentEW=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(CurrentEW,_UiStrategy);function CurrentEW(){Object(classCallCheck["a" /* default */])(this,CurrentEW);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CurrentEW).apply(this,arguments));}Object(createClass["a" /* default */])(CurrentEW,[{key:"deactivate",value:function deactivate(){var electronicWarfareIndicatorService=this.services.electronicWarfareIndicatorService;electronicWarfareIndicatorService.hideAllCurrent();}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(CurrentEW.prototype),"update",this).call(this,gameData);this.show();}},{key:"uiStateChanged",value:function uiStateChanged(){if(!this.gameData){return;}this.show();}},{key:"mouseOutShip",value:function mouseOutShip(){this.show();}},{key:"show",value:function show(){var _this$services=this.services,electronicWarfareIndicatorService=_this$services.electronicWarfareIndicatorService,uiState=_this$services.uiState,currentUser=_this$services.currentUser;electronicWarfareIndicatorService.hideAllCurrent();if(uiState.hasGameUiMode(ENEMY_WEAPONS)){this.gameData.ships.getShipsEnemyTeams(currentUser).forEach(function(ship){return electronicWarfareIndicatorService.showCurrentForShip(ship);});}if(uiState.hasGameUiMode(WEAPONS)){this.gameData.ships.getShipsInSameTeam(currentUser).forEach(function(ship){return electronicWarfareIndicatorService.showCurrentForShip(ship);});}}}]);return CurrentEW;}(uiStrategy_UiStrategy);/* harmony default export */ var electronicWarfare_CurrentEW = (CurrentEW_CurrentEW);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/weapon/WeaponArcsOnSystemMouseOver.js
var WeaponArcsOnSystemMouseOver_WeaponArcsOnSystemMouseOver=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(WeaponArcsOnSystemMouseOver,_UiStrategy);function WeaponArcsOnSystemMouseOver(){var _this;Object(classCallCheck["a" /* default */])(this,WeaponArcsOnSystemMouseOver);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(WeaponArcsOnSystemMouseOver).call(this));_this.weaponArcs=[];return _this;}Object(createClass["a" /* default */])(WeaponArcsOnSystemMouseOver,[{key:"deactivate",value:function deactivate(){this.hide();}},{key:"systemMouseOver",value:function systemMouseOver(_ref){var ship=_ref.ship,system=_ref.system;if(!system.callHandler("hasArcs")){return;}this.show(ship,system);}},{key:"torpedoMouseOver",value:function torpedoMouseOver(_ref2){var ship=_ref2.ship,torpedo=_ref2.torpedo;var _this$services=this.services,coordinateConverter=_this$services.coordinateConverter,shipIconContainer=_this$services.shipIconContainer;var icon=shipIconContainer.getByShip(ship);var maxRange=torpedo.maxRange;var distance=maxRange*coordinateConverter.getHexDistance();var canvas=abstractCanvas.create(maxRange+1,1);var context=canvas.getContext("2d");for(var range=0;range<=maxRange;range++){var opacity=range<torpedo.minRange?0:0.5;context.fillStyle="rgba("+2+","+80+","+128+","+opacity+")";context.fillRect(range,0,1,1);}var texture=new three_module["CanvasTexture"](canvas);var material=new three_module["MeshBasicMaterial"]({color:new three_module["Color"]("rgb(20,80,128)"),opacity:1,transparent:true,map:texture});var geometry=new three_module["CircleGeometry"](distance,32,degreeToRadian(0),degreeToRadian(360));geometry.faceVertexUvs=[geometry.faceVertexUvs[0].map(function(_){return[new three_module["Vector2"](1,0),new three_module["Vector2"](1,0),new three_module["Vector2"](0,0)];})];geometry.uvsNeedUpdate=true;var circle=new three_module["Mesh"](geometry,material);circle.position.z=-1;icon.mesh.add(circle);this.weaponArcs.push({mesh:icon.mesh,circle:circle});}},{key:"torpedoMouseOut",value:function torpedoMouseOut(){this.hide();}},{key:"systemMouseOut",value:function systemMouseOut(){this.hide();}},{key:"hide",value:function hide(){var scene=this.services.scene;this.weaponArcs=this.weaponArcs.filter(function(_ref3){var mesh=_ref3.mesh,circle=_ref3.circle;mesh.remove(circle);});}},{key:"show",value:function show(ship,system){var _this2=this;var _this$services2=this.services,coordinateConverter=_this$services2.coordinateConverter,shipIconContainer=_this$services2.shipIconContainer;var icon=shipIconContainer.getByShip(ship);var maxRange=system.callHandler("getMaxRange");var distance=maxRange*coordinateConverter.getHexDistance();var arcsList=system.callHandler("getArcs",{facing:icon.getFacing()});var canvas=abstractCanvas.create(maxRange+1,1);var context=canvas.getContext("2d");for(var range=0;range<=maxRange;range++){var rangePenalty=system.callHandler("getRangeModifier",{distance:range});var opacity=(100+rangePenalty)/100;if(opacity<0){opacity=0;}context.fillStyle="rgba("+2+","+80+","+128+","+opacity+")";context.fillRect(range,0,1,1);}var texture=new three_module["CanvasTexture"](canvas);var material=new three_module["MeshBasicMaterial"]({color:new three_module["Color"]("rgb(20,80,128)"),opacity:1,transparent:true,map:texture});arcsList.forEach(function(arcs){var arcLenght=arcs.start===arcs.end?360:getArcLength(arcs.start,arcs.end);var geometry=new three_module["CircleGeometry"](distance,32,degreeToRadian(addToDirection(360,-arcs.end)),degreeToRadian(arcLenght));geometry.faceVertexUvs=[geometry.faceVertexUvs[0].map(function(intial){return[new three_module["Vector2"](1,0),new three_module["Vector2"](1,0),new three_module["Vector2"](0,0)];})];geometry.uvsNeedUpdate=true;var circle=new three_module["Mesh"](geometry,material);circle.position.z=-1;icon.mesh.add(circle);_this2.weaponArcs.push({mesh:icon.mesh,circle:circle});});}}]);return WeaponArcsOnSystemMouseOver;}(uiStrategy_UiStrategy);/* harmony default export */ var weapon_WeaponArcsOnSystemMouseOver = (WeaponArcsOnSystemMouseOver_WeaponArcsOnSystemMouseOver);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/weapon/SelectWeaponOnSystemClick.js
var SelectWeaponOnSystemClick_material=new three_module["MeshBasicMaterial"]({color:new three_module["Color"]("rgb(20,80,128)"),opacity:0.5,transparent:true});var SelectWeaponOnSystemClick_SelectWeaponOnSystemClick=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectWeaponOnSystemClick,_UiStrategy);function SelectWeaponOnSystemClick(){var _this;Object(classCallCheck["a" /* default */])(this,SelectWeaponOnSystemClick);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectWeaponOnSystemClick).call(this));_this.weaponArcs=[];return _this;}Object(createClass["a" /* default */])(SelectWeaponOnSystemClick,[{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.deselectAllSystems();}},{key:"systemClicked",value:function systemClicked(_ref){var ship=_ref.ship,system=_ref.system,scs=_ref.scs;var _this$services=this.services,uiState=_this$services.uiState,currentUser=_this$services.currentUser;if(scs||!system.isWeapon()||!ship.player.is(currentUser)){return;}if(uiState.isSelectedSystem(system)){uiState.deselectSystem(system);}else{uiState.selectSystem(ship,system);}uiState.updateState();}}]);return SelectWeaponOnSystemClick;}(uiStrategy_UiStrategy);/* harmony default export */ var weapon_SelectWeaponOnSystemClick = (SelectWeaponOnSystemClick_SelectWeaponOnSystemClick);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/weapon/SelectedShipSystemList.js
var SelectedShipSystemList_SelectedShipSystemList=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectedShipSystemList,_UiStrategy);function SelectedShipSystemList(){Object(classCallCheck["a" /* default */])(this,SelectedShipSystemList);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectedShipSystemList).apply(this,arguments));}Object(createClass["a" /* default */])(SelectedShipSystemList,[{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.setSystemList([]);}},{key:"update",value:function update(gameData){var uiState=this.services.uiState;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(SelectedShipSystemList.prototype),"update",this).call(this,gameData);var ship=uiState.getSelectedShip();if(ship){uiState.setSystemList(ship.systems.getSystems().filter(function(system){return system.showOnSystemList();}));}}},{key:"shipSelected",value:function shipSelected(ship){var uiState=this.services.uiState;if(!this.gameData){return;}uiState.setSystemList(ship.systems.getSystems().filter(function(system){return system.showOnSystemList();}));}}]);return SelectedShipSystemList;}(uiStrategy_UiStrategy);/* harmony default export */ var weapon_SelectedShipSystemList = (SelectedShipSystemList_SelectedShipSystemList);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/GameSystemTooltipMenu.js
var GameSystemTooltipMenu_GameSystemTooltipMenu=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(GameSystemTooltipMenu,_React$Component);function GameSystemTooltipMenu(){Object(classCallCheck["a" /* default */])(this,GameSystemTooltipMenu);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameSystemTooltipMenu).apply(this,arguments));}Object(createClass["a" /* default */])(GameSystemTooltipMenu,[{key:"render",value:function render(){var _this=this;var _this$props=this.props,ship=_this$props.ship,system=_this$props.system,uiState=_this$props.uiState;var currentUser=uiState.services.currentUser;var myShip=ship.player.is(currentUser);var selectedShip=uiState.getSelectedShip();if(system.isDestroyed()){return null;}return react["createElement"](TooltipMenu,null,system.callHandler("getTooltipMenuButton",{uiState:uiState,myShip:myShip,selectedShip:selectedShip},[]).sort(function(a,b){if(a.sort>b.sort){return 1;}if(a.sort<b.sort){return-1;}return 0;}).map(function(_ref,i){var img=_ref.img,disabledHandler=_ref.disabledHandler,onClickHandler=_ref.onClickHandler;return react["createElement"](TooltipButton,{key:"custom-system-tooltip-button-".concat(i),img:img,disabled:disabledHandler?disabledHandler():false,onClick:function onClick(e){e.preventDefault();e.stopPropagation();onClickHandler();uiState.shipSystemStateChanged(ship,system);uiState.shipStateChanged(ship);_this.forceUpdate();}});}));}}]);return GameSystemTooltipMenu;}(react["Component"]);/* harmony default export */ var system_GameSystemTooltipMenu = (GameSystemTooltipMenu_GameSystemTooltipMenu);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/GameSystemInfoMenuStrategy.js
var GameSystemInfoMenuStrategy_GameSystemInfoMenuStrategy=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(GameSystemInfoMenuStrategy,_UiStrategy);function GameSystemInfoMenuStrategy(){Object(classCallCheck["a" /* default */])(this,GameSystemInfoMenuStrategy);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameSystemInfoMenuStrategy).apply(this,arguments));}Object(createClass["a" /* default */])(GameSystemInfoMenuStrategy,[{key:"activate",value:function activate(services){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(GameSystemInfoMenuStrategy.prototype),"activate",this).call(this,services);var uiState=this.services.uiState;uiState.setSystemInfoMenuProvider(this.getTooltipComponent);}},{key:"deactivate",value:function deactivate(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(GameSystemInfoMenuStrategy.prototype),"deactivate",this).call(this);var uiState=this.services.uiState;uiState.setSystemInfoMenuProvider(null);}},{key:"getTooltipComponent",value:function getTooltipComponent(){return system_GameSystemTooltipMenu;}}]);return GameSystemInfoMenuStrategy;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_GameSystemInfoMenuStrategy = (GameSystemInfoMenuStrategy_GameSystemInfoMenuStrategy);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/SystemClickShowsSystemMenu.js
var SystemClickShowsSystemMenu_SystemClickShowsSystemMenu=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SystemClickShowsSystemMenu,_UiStrategy);function SystemClickShowsSystemMenu(){var _this;Object(classCallCheck["a" /* default */])(this,SystemClickShowsSystemMenu);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SystemClickShowsSystemMenu).call(this));_this.clickedSystem=null;return _this;}Object(createClass["a" /* default */])(SystemClickShowsSystemMenu,[{key:"shipStateChanged",value:function shipStateChanged(){var uiState=this.services.uiState;if(this.clickedSystem){uiState.setSystemMenuActiveSystem(this.clickedSystem,this.element);}}},{key:"closeSystemInfo",value:function closeSystemInfo(){this.hide();}},{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;if(this.clickedShip){uiState.setSystemMenuActiveSystem(null,null);}}},{key:"systemClicked",value:function systemClicked(_ref){var system=_ref.system,element=_ref.element,scs=_ref.scs;var uiState=this.services.uiState;if(!scs){return;}this.clickedSystem=system;this.element=element;uiState.setSystemMenuActiveSystem(this.clickedSystem,this.element);}},{key:"hexClicked",value:function hexClicked(){this.hide();}},{key:"mouseOverShip",value:function mouseOverShip(payload){this.hide();}},{key:"mouseOutShip",value:function mouseOutShip(){this.hide();}},{key:"hide",value:function hide(){if(!this.clickedSystem){return;}var uiState=this.services.uiState;uiState.setSystemMenuActiveSystem(null,null);this.clickedSystem=null;this.element=null;}}]);return SystemClickShowsSystemMenu;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_SystemClickShowsSystemMenu = (SystemClickShowsSystemMenu_SystemClickShowsSystemMenu);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/electronicWarfare/SelectedShipEwList.js
var SelectedShipEwList_SelectedShipEwList=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(SelectedShipEwList,_UiStrategy);function SelectedShipEwList(){Object(classCallCheck["a" /* default */])(this,SelectedShipEwList);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SelectedShipEwList).apply(this,arguments));}Object(createClass["a" /* default */])(SelectedShipEwList,[{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;uiState.setEwList([]);}},{key:"shipStateChanged",value:function shipStateChanged(){var uiState=this.services.uiState;var ship=uiState.getSelectedShip();uiState.setEwList(ship.electronicWarfare.getAllOew());}},{key:"shipSelected",value:function shipSelected(ship){var uiState=this.services.uiState;if(!this.gameData){return;}uiState.setEwList(ship.electronicWarfare.getAllOew());}}]);return SelectedShipEwList;}(uiStrategy_UiStrategy);/* harmony default export */ var electronicWarfare_SelectedShipEwList = (SelectedShipEwList_SelectedShipEwList);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/UnderHexForShips.js
var UnderHexForShips_UnderHexForShips=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(UnderHexForShips,_UiStrategy);function UnderHexForShips(){var _this;Object(classCallCheck["a" /* default */])(this,UnderHexForShips);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(UnderHexForShips).call(this));_this.showing=false;return _this;}Object(createClass["a" /* default */])(UnderHexForShips,[{key:"show",value:function show(){var _this$services=this.services,shipIconContainer=_this$services.shipIconContainer,currentUser=_this$services.currentUser;shipIconContainer.getArray().forEach(function(icon){icon.hexSpriteContainer.visible=true;var color=icon.ship.player.isUsers(currentUser)?COLOR_FRIENDLY:COLOR_ENEMY;icon.hexSprites.forEach(function(sprite){return sprite.setOverlayColor(color);});icon.line.setColor(color);icon.line.show();});this.showing=true;}},{key:"hide",value:function hide(){var shipIconContainer=this.services.shipIconContainer;shipIconContainer.getArray().forEach(function(icon){icon.hexSpriteContainer.visible=false;icon.line.hide();});this.showing=false;}},{key:"update",value:function update(gameData){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(UnderHexForShips.prototype),"update",this).call(this,gameData);this.show();}},{key:"render",value:function render(_ref){var zoom=_ref.zoom;if(zoom>ZOOM_FOR_MAPICONS&&this.showing){this.hide();}if(zoom<=ZOOM_FOR_MAPICONS&&!this.showing){this.show();}}},{key:"deactivate",value:function deactivate(){this.hide();}}]);return UnderHexForShips;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_UnderHexForShips = (UnderHexForShips_UnderHexForShips);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowMapIcons.js
var ShowMapIcons_ShowMapIcons=/*#__PURE__*/function(_AnimationUiStrategy){Object(inherits["a" /* default */])(ShowMapIcons,_AnimationUiStrategy);function ShowMapIcons(){var _this;Object(classCallCheck["a" /* default */])(this,ShowMapIcons);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowMapIcons).call(this));_this.zoom=1;_this.showingIcons=false;return _this;}Object(createClass["a" /* default */])(ShowMapIcons,[{key:"showHighligh",value:function showHighligh(icon){var currentUser=this.services.currentUser;var color=icon.ship.player.isUsers(currentUser)?COLOR_FRIENDLY_HIGHLIGHT:COLOR_ENEMY_HIGHLIGHT;icon.mapIcon.replaceColor(color);}},{key:"hideHighligh",value:function hideHighligh(){var _this$services=this.services,shipIconContainer=_this$services.shipIconContainer,currentUser=_this$services.currentUser;shipIconContainer.getArray().forEach(function(icon){var ghost=shipIconContainer.getGhostShipIconByShip(icon.ship);ghost.mapIcon.revertColor();icon.mapIcon.revertColor();});}},{key:"mouseOverShip",value:function mouseOverShip(payload){var icon=payload.entity;this.showHighligh(icon);}},{key:"uiStateChanged",value:function uiStateChanged(){this.shouldShow(this.zoom,true);}},{key:"shipStateChanged",value:function shipStateChanged(){this.shouldShow(this.zoom,true);}},{key:"mouseOutShip",value:function mouseOutShip(){this.hideHighligh();this.shouldShow(this.zoom,true);}},{key:"mouseOut",value:function mouseOut(){this.hideHighligh();}},{key:"showIcons",value:function showIcons(){this.changeScale(1);var _this$services2=this.services,shipIconContainer=_this$services2.shipIconContainer,currentUser=_this$services2.currentUser,gameCamera=_this$services2.gameCamera;shipIconContainer.getArray().forEach(function(icon){var color=icon.ship.player.isUsers(currentUser)?COLOR_FRIENDLY:COLOR_ENEMY;var ghost=shipIconContainer.getGhostShipIconByShip(icon.ship);ghost.showMapIcon(color);icon.showMapIcon(color);});this.showingIcons=true;gameCamera.changeToMapView();}},{key:"hideIcons",value:function hideIcons(){this.changeScale(1);var _this$services3=this.services,shipIconContainer=_this$services3.shipIconContainer,gameCamera=_this$services3.gameCamera;shipIconContainer.getArray().forEach(function(icon){icon.hideMapIcon();var ghost=shipIconContainer.getGhostShipIconByShip(icon.ship);ghost.hideMapIcon();});this.showingIcons=false;gameCamera.changeToCloseView();}},{key:"changeScale",value:function changeScale(scale){var shipIconContainer=this.services.shipIconContainer;shipIconContainer.getArray().forEach(function(icon){icon.mapIcon.setScale(scale);var ghost=shipIconContainer.getGhostShipIconByShip(icon.ship);ghost.mapIcon.setScale(scale);});}},{key:"shouldShow",value:function shouldShow(zoom){var force=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.services){return;}if(zoom>ZOOM_FOR_MAPICONS&&(force||!this.showingIcons)){this.showIcons();}if(zoom<=ZOOM_FOR_MAPICONS&&(force||this.showingIcons)){this.hideIcons();}if(zoom>ZOOM_FOR_MAPICONS){/*
      const extraScale =
        ((zoom - ZOOM_FOR_MAPICONS) / (ZOOM_MAX - ZOOM_FOR_MAPICONS)) * 5 + 1;
        */var extraScale=zoom;this.changeScale(extraScale);}}},{key:"render",value:function render(_ref){var zoom=_ref.zoom;if(zoom===this.zoom){return;}this.zoom=zoom;this.shouldShow(zoom);}},{key:"deactivate",value:function deactivate(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowMapIcons.prototype),"deactivate",this).call(this);this.hideIcons();}}]);return ShowMapIcons;}(uiStrategy_AnimationUiStrategy);/* harmony default export */ var uiStrategy_ShowMapIcons = (ShowMapIcons_ShowMapIcons);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowShipBadges.js
var ShowShipBadges_ShowShipBadges=/*#__PURE__*/function(_AnimationUiStrategy){Object(inherits["a" /* default */])(ShowShipBadges,_AnimationUiStrategy);function ShowShipBadges(){var _this;Object(classCallCheck["a" /* default */])(this,ShowShipBadges);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowShipBadges).call(this));_this.zoom=1;_this.showing=false;_this.showingName=false;return _this;}/*
  uiStateChanged() {
    this.shouldShow(this.zoom, true);
  }*/Object(createClass["a" /* default */])(ShowShipBadges,[{key:"shipStateChanged",value:function shipStateChanged(ship){this.show(ship);}},{key:"updateShip",value:function updateShip(ship){var _this$services=this.services,shipIconContainer=_this$services.shipIconContainer,uiState=_this$services.uiState;if(ship.isDestroyed()){return;}var icon=shipIconContainer.getByShip(ship);uiState.showShipBadge(icon);}/*

  mouseOutShip() {
    this.shouldShow(this.zoom, true);
  }
  */},{key:"show",value:function show(showName){var _this$services2=this.services,shipIconContainer=_this$services2.shipIconContainer,uiState=_this$services2.uiState;shipIconContainer.getArray().filter(function(icon){return!icon.ship.isDestroyed();}).forEach(function(icon){uiState.showShipBadge(icon,showName);});this.showing=true;this.showingName=showName;}},{key:"hide",value:function hide(){var _this$services3=this.services,shipIconContainer=_this$services3.shipIconContainer,uiState=_this$services3.uiState;shipIconContainer.getArray().forEach(function(icon){uiState.hideShipBadge(icon);});this.showing=false;}},{key:"shouldShow",value:function shouldShow(zoom){var force=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.services){return;}if(zoom>ZOOM_FOR_SHIPBADGE&&(force||this.showing)){this.hide();}if(zoom<=ZOOM_FOR_SHIPBADGE){//const showName = zoom <= ZOOM_FOR_SHIPBADGE_NAME;
if(/* this.showingName !== showName || */force||!this.showing){this.show();}}}},{key:"render",value:function render(_ref){var zoom=_ref.zoom;this.zoom=zoom;this.shouldShow(zoom);}},{key:"deactivate",value:function deactivate(){var _this$services4=this.services,shipIconContainer=_this$services4.shipIconContainer,uiState=_this$services4.uiState;shipIconContainer.getArray().forEach(function(icon){uiState.removeShipBadge(icon);});}}]);return ShowShipBadges;}(uiStrategy_AnimationUiStrategy);/* harmony default export */ var uiStrategy_ShowShipBadges = (ShowShipBadges_ShowShipBadges);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowTorpedoObjects.js
var ShowTorpedoObjects_TEXTURE=new three_module["TextureLoader"]().load("/img/torpedoMarker.png");var ShowTorpedoObjects_ShowTorpedoObjects=/*#__PURE__*/function(_AnimationUiStrategy){Object(inherits["a" /* default */])(ShowTorpedoObjects,_AnimationUiStrategy);function ShowTorpedoObjects(){var _this;Object(classCallCheck["a" /* default */])(this,ShowTorpedoObjects);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowTorpedoObjects).call(this));_this.movementService=new movement_MovementService();_this.lines=[];_this.hexes=[];_this.zoom=1;return _this;}Object(createClass["a" /* default */])(ShowTorpedoObjects,[{key:"markHexes",value:function markHexes(gameData){var _this2=this;var hexPositions=[];var _this$services=this.services,scene=_this$services.scene,currentUser=_this$services.currentUser;gameData.torpedos.getTorpedoFlights().forEach(function(flight){var hexPosition=flight.strikePosition.toOffset();var target=gameData.ships.getShipById(flight.targetId);var spriteFacing=getCompassHeadingOfPoint(flight.strikePosition,target.movement.getLastEndMoveOrSurrogate().position);if(!hexPositions.find(function(_ref){var position=_ref.position,target=_ref.target,facing=_ref.facing;return position.equals(hexPosition)&&target===target&&facing===spriteFacing;})){hexPositions.push({position:hexPosition,target:target,facing:spriteFacing});}});hexPositions.forEach(function(_ref2){var position=_ref2.position,target=_ref2.target,facing=_ref2.facing;var pos=position.toVector();var color=gameData.slots.isShipInUsersTeam(currentUser,target)?COLOR_ENEMY:COLOR_FRIENDLY;if(!_this2.hexes.find(function(hex){return hex.isPosition(pos)&&hex.isOverlayColor(color);})){var sprite=new sprite_Sprite(ShowTorpedoObjects_TEXTURE,{width:HexagonMath.getTextureWidth()*0.8,height:HexagonMath.getTextureHeight()*0.8},0).setPosition(pos).setOpacity(0.5).setOverlayColorAlpha(1).setOverlayColor(color).setFacing(-facing).show();_this2.hexes.push(sprite);scene.add(sprite.mesh);}});this.hexes=this.hexes.filter(function(sprite){if(!hexPositions.find(function(_ref3){var position=_ref3.position;return sprite.isPosition(position.toVector());})){scene.remove(sprite.mesh);return false;}return true;});}},{key:"update",value:function update(gameData){var _this3=this;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowTorpedoObjects.prototype),"update",this).call(this,gameData);gameData.torpedos.getTorpedoFlights().forEach(function(flight){var target=gameData.ships.getShipById(flight.targetId);_this3.handleImpactingTorpedo(flight,target);});this.markHexes(gameData);}},{key:"shipStateChanged",value:function shipStateChanged(ship){var _this4=this;if(!this.gameData){return;}this.gameData.torpedos.getTorpedoFlights().filter(function(flight){return flight.targetId===ship.id;}).forEach(function(flight){_this4.handleImpactingTorpedo(flight,ship);});this.markHexes(this.gameData);}},{key:"handleImpactingTorpedo",value:function handleImpactingTorpedo(flight,target){var _this$services2=this.services,torpedoIconContainer=_this$services2.torpedoIconContainer,scene=_this$services2.scene,shipIconContainer=_this$services2.shipIconContainer;var icon=torpedoIconContainer.getIconByTorpedoFlight(flight);var getRandom=getSeededRandomGenerator(icon.torpedoFlight.id);var variance=new utils_Vector(getRandom()*25-12.5,getRandom()*25-12.5,getRandom()*10-5);var targetPosition=target.movement.getLastEndMoveOrSurrogate().position;var torpedoPosition=flight.strikePosition.setZ(shipIconContainer.getByShip(target).shipZ).add(variance);icon.setPosition(torpedoPosition);icon.setFacing(-getCompassHeadingOfPoint(torpedoPosition,targetPosition));var line=this.lines.find(function(_ref4){var flightId=_ref4.flightId,targetId=_ref4.targetId;return flightId===flight.id&&targetId===target.id;});if(!line){line=new renderer_Line(scene,{start:torpedoPosition,end:targetPosition.setZ(shipIconContainer.getByShip(target).shipZ),width:2,color:new three_module["Color"](255/255,40/255,40/255),opacity:0.01,pulseAmount:1});line.show();this.lines.push({targetId:target.id,flightId:flight.id,line:line});}else{line.line.update(torpedoPosition,targetPosition.setZ(shipIconContainer.getByShip(target).shipZ),2);}icon.show();}},{key:"deactivate",value:function deactivate(){var _this$services3=this.services,torpedoIconContainer=_this$services3.torpedoIconContainer,scene=_this$services3.scene;torpedoIconContainer.getArray().forEach(function(icon){icon.hide();},this);this.lines.forEach(function(line){return line.line.destroy();});this.hexes.forEach(function(sprite){return scene.remove(sprite.mesh);});return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowTorpedoObjects.prototype),"deactivate",this).call(this);}},{key:"render",value:function render(_ref5){var zoom=_ref5.zoom;if(zoom===this.zoom){return;}this.zoom=zoom;if(zoom>1){this.hexes.forEach(function(sprite){sprite.setScale(zoom*0.8,zoom*0.8);});}else{this.hexes.forEach(function(sprite){sprite.setScale(1,1);});}}}]);return ShowTorpedoObjects;}(uiStrategy_AnimationUiStrategy);/* harmony default export */ var uiStrategy_ShowTorpedoObjects = (ShowTorpedoObjects_ShowTorpedoObjects);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/weapon/WeaponTargetingMouseoverShowsLine.js
var WeaponTargetingMouseoverShowsLine_WeaponTargetingMouseoverShowsLine=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(WeaponTargetingMouseoverShowsLine,_UiStrategy);function WeaponTargetingMouseoverShowsLine(){var _this;Object(classCallCheck["a" /* default */])(this,WeaponTargetingMouseoverShowsLine);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(WeaponTargetingMouseoverShowsLine).call(this));_this.lines=[];return _this;}Object(createClass["a" /* default */])(WeaponTargetingMouseoverShowsLine,[{key:"systemMouseOver",value:function systemMouseOver(_ref){var ship=_ref.ship,target=_ref.target;this.show(ship,target);}},{key:"torpedoMouseOver",value:function torpedoMouseOver(_ref2){var ship=_ref2.ship,target=_ref2.target;this.show(ship,target);}},{key:"systemMouseOut",value:function systemMouseOut(){this.hide();}},{key:"torpedoMouseOut",value:function torpedoMouseOut(){this.hide();}},{key:"hide",value:function hide(){this.lines.forEach(function(line){return line.destroy();});this.lines=[];}},{key:"show",value:function show(shooter,target){if(!target){return;}var _this$services=this.services,scene=_this$services.scene,shipIconContainer=_this$services.shipIconContainer;var shooterIcon=shipIconContainer.getByShip(shooter);var targetIcon=shipIconContainer.getByShip(target);var line=new renderer_Line(scene,{start:Object(objectSpread2["a" /* default */])({},shooterIcon.getPosition(),{z:shooterIcon.shipZ}),end:Object(objectSpread2["a" /* default */])({},targetIcon.getPosition(),{z:targetIcon.shipZ}),width:20,color:new three_module["Color"](196/255,196/255,39/255),opacity:0.1,pulseAmount:1,dashSize:0});this.lines.push(line);}},{key:"deactivate",value:function deactivate(){var uiState=this.services.uiState;if(this.clickedShip){uiState.hideShipTooltip(this.clickedShip);}if(this.clickedEnemy){uiState.hideShipTooltip(this.clickedEnemy);}}}]);return WeaponTargetingMouseoverShowsLine;}(uiStrategy_UiStrategy);/* harmony default export */ var weapon_WeaponTargetingMouseoverShowsLine = (WeaponTargetingMouseoverShowsLine_WeaponTargetingMouseoverShowsLine);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/ShowShipDEWandCCEW.js
var ShowShipDEWandCCEW_ShowShipDEWandCCEW=/*#__PURE__*/function(_UiStrategy){Object(inherits["a" /* default */])(ShowShipDEWandCCEW,_UiStrategy);function ShowShipDEWandCCEW(){Object(classCallCheck["a" /* default */])(this,ShowShipDEWandCCEW);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShowShipDEWandCCEW).call(this));}Object(createClass["a" /* default */])(ShowShipDEWandCCEW,[{key:"update",value:function update(gamedata){var _this=this;Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowShipDEWandCCEW.prototype),"update",this).call(this,gamedata);var shipIconContainer=this.services.shipIconContainer;shipIconContainer.getArray().forEach(/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(icon){var ship;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return icon.isShipObjectLoaded;case 2:ship=icon.ship;_this.show(ship);case 4:case"end":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}},{key:"shipStateChanged",value:function shipStateChanged(ship){this.show(ship);}//shipSystemStateChanged({ ship, system }) {}
},{key:"show",value:function show(ship){var _this$services=this.services,shipIconContainer=_this$services.shipIconContainer,currentUser=_this$services.currentUser;var icon=shipIconContainer.getByShip(ship);var dew,ccew,evasion;if(ship.player.isUsers(currentUser)){dew=ship.electronicWarfare.getDefensiveEw();ccew=ship.electronicWarfare.getCcEw();evasion=ship.movement.getEvasion();}else{dew=ship.electronicWarfare.inEffect.getDefensiveEw();ccew=ship.electronicWarfare.inEffect.getCcEw();evasion=ship.movement.getActiveEvasion();}icon.showEwSprite(dew,ccew,evasion);}},{key:"deactivate",value:function deactivate(){var shipIconContainer=this.services.shipIconContainer;shipIconContainer.getArray().forEach(function(icon){icon.hideEwSprite();},this);return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShowShipDEWandCCEW.prototype),"deactivate",this).call(this);}}]);return ShowShipDEWandCCEW;}(uiStrategy_UiStrategy);/* harmony default export */ var uiStrategy_ShowShipDEWandCCEW = (ShowShipDEWandCCEW_ShowShipDEWandCCEW);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/index.js

// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/DeploymentPhaseStrategy.js
var DeploymentPhaseStrategy_DeploymentPhaseStrategy=/*#__PURE__*/function(_PhaseStrategy){Object(inherits["a" /* default */])(DeploymentPhaseStrategy,_PhaseStrategy);function DeploymentPhaseStrategy(services){var _this;Object(classCallCheck["a" /* default */])(this,DeploymentPhaseStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(DeploymentPhaseStrategy).call(this,services));_this.strategies=[new uiStrategy_ShipClickSelectsShip(),new uiStrategy_RightClickShowsShipWindow(),new uiStrategy_ShowDeploymentAreas(),new uiStrategy_MouseOverHighlightsShip(),new uiStrategy_MouseOverShowsMovementPath(),new uiStrategy_ShowShipObjects(),new uiStrategy_MouseOverShowsShipTooltip(),new deployment_SelectUndeployedShip(),new uiStrategy_HighlightSelectedShip(),new deployment_DeployShipOnHexClick(),new deployment_AllowSubmittingWhenDeploymentDone(),//new SelectedShipNavigationPath(),
new deployment_SelectedShipDeploymentMovementUi()];return _this;}Object(createClass["a" /* default */])(DeploymentPhaseStrategy,[{key:"commitTurn",value:function commitTurn(gameConnector){gameConnector.commitDeployment(this.gameData);}}]);return DeploymentPhaseStrategy;}(phaseStrategy_PhaseStrategy);/* harmony default export */ var phaseStrategy_DeploymentPhaseStrategy = (DeploymentPhaseStrategy_DeploymentPhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/ReplayPhaseStrategy.js
var ReplayPhaseStrategy_ReplayPhaseStrategy=/*#__PURE__*/function(_PhaseStrategy){Object(inherits["a" /* default */])(ReplayPhaseStrategy,_PhaseStrategy);function ReplayPhaseStrategy(){Object(classCallCheck["a" /* default */])(this,ReplayPhaseStrategy);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ReplayPhaseStrategy).apply(this,arguments));}return ReplayPhaseStrategy;}(phaseStrategy_PhaseStrategy);/* harmony default export */ var phaseStrategy_ReplayPhaseStrategy = (ReplayPhaseStrategy_ReplayPhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/WaitingPhaseStrategy.js
var WaitingPhaseStrategy_WaitingPhaseStrategy=/*#__PURE__*/function(_PhaseStrategy){Object(inherits["a" /* default */])(WaitingPhaseStrategy,_PhaseStrategy);function WaitingPhaseStrategy(services){var _this;Object(classCallCheck["a" /* default */])(this,WaitingPhaseStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(WaitingPhaseStrategy).call(this,services));_this.strategies=[new uiStrategy_ShowWaitingStatus(),new uiStrategy_RightClickShowsShipWindow(),new uiStrategy_MouseOverHighlightsShip(),new uiStrategy_MouseOverShowsMovementPath(),new uiStrategy_ShowShipObjects(),new uiStrategy_MouseOverShowsShipTooltip(),new uiStrategy_SystemClickShowsSystemMenu(),new weapon_WeaponArcsOnSystemMouseOver(),new uiStrategy_UnderHexForShips(),new uiStrategy_ShowMapIcons()];return _this;}return WaitingPhaseStrategy;}(phaseStrategy_PhaseStrategy);/* harmony default export */ var phaseStrategy_WaitingPhaseStrategy = (WaitingPhaseStrategy_WaitingPhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/GamePhaseStrategy.js
var GamePhaseStrategy_GamePhaseStrategy=/*#__PURE__*/function(_PhaseStrategy){Object(inherits["a" /* default */])(GamePhaseStrategy,_PhaseStrategy);function GamePhaseStrategy(services){var _this;Object(classCallCheck["a" /* default */])(this,GamePhaseStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GamePhaseStrategy).call(this,services));_this.strategies=[new weapon_WeaponTargetingMouseoverShowsLine(),new uiStrategy_ShipClickSelectsShip(),new uiStrategy_MouseOverHighlightsShip(),new uiStrategy_ShowShipObjects(),new uiStrategy_MouseOverShowsShipTooltip(),new uiStrategy_SelectFirstActiveShip(),new uiStrategy_HighlightSelectedShip(),new movement_SelectedShipMovementUi(),new uiStrategy_AllShipsMovementPaths(),new uiStrategy_AllowSubmittingOnValidGameState(),new uiStrategy_GameShipTooltipMenuStrategy(),new uiStrategy_ShowUiModeButtons(),new electronicWarfare_OwnedShipEw(),new electronicWarfare_CurrentEW(),new weapon_WeaponArcsOnSystemMouseOver(),new weapon_SelectWeaponOnSystemClick(),new weapon_SelectedShipSystemList(),new uiStrategy_GameSystemInfoMenuStrategy(),new uiStrategy_SystemClickShowsSystemMenu(),new electronicWarfare_SelectedShipEwList(),new uiStrategy_UnderHexForShips(),new uiStrategy_ShowMapIcons(),new uiStrategy_ShowShipBadges(),new uiStrategy_ShowTorpedoObjects(),new uiStrategy_ShowShipDEWandCCEW()];return _this;}Object(createClass["a" /* default */])(GamePhaseStrategy,[{key:"commitTurn",value:function commitTurn(gameConnector){gameConnector.commitTurn(this.gameData);}}]);return GamePhaseStrategy;}(phaseStrategy_PhaseStrategy);/* harmony default export */ var phaseStrategy_GamePhaseStrategy = (GamePhaseStrategy_GamePhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipVelocityAnimation.js
var ShipVelocityAnimation_ShipVelocityAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(ShipVelocityAnimation,_Animation);function ShipVelocityAnimation(shipIcon,endMove,start,end){var _this;Object(classCallCheck["a" /* default */])(this,ShipVelocityAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipVelocityAnimation).call(this));_this.shipIcon=shipIcon;_this.endMove=endMove;_this.start=start;_this.end=end;_this.duration=end-start;_this.positionCurve=_this.buildPositionCurve(endMove.position,endMove.position.add(endMove.velocity));animation_Animation.call(Object(assertThisInitialized["a" /* default */])(_this));return _this;}Object(createClass["a" /* default */])(ShipVelocityAnimation,[{key:"deactivate",value:function deactivate(){}},{key:"update",value:function update(gameData){}},{key:"cleanUp",value:function cleanUp(){}},{key:"getPositionAt",value:function getPositionAt(time){var turnDone=this.getMovementTurnDone({total:time});if(turnDone===-1){throw new Error("Don't ask ShipVelocityAnimation");}var percentDone=turnDone<1?turnDone%1:1;return{facing:this.endMove.facing,position:this.positionCurve.getPoint(percentDone)};}},{key:"getMovementTurnDone",value:function getMovementTurnDone(_ref){var total=_ref.total;if(total<this.start){return-1;}if(total>this.end){return 1;}var time=total-this.start;return time/this.duration;}},{key:"render",value:function render(payload){var turnDone=this.getMovementTurnDone(payload);if(turnDone===-1){return;}var percentDone=turnDone<1?turnDone%1:1;this.shipIcon.setPosition(this.positionCurve.getPoint(percentDone));this.shipIcon.setFacing(-hexFacingToAngle(this.endMove.facing));}},{key:"buildPositionCurve",value:function buildPositionCurve(start,end){var point1=start.roundToHexCenter();var control1=start.roundToHexCenter();var control2=end.roundToHexCenter();var point2=end.roundToHexCenter();return new three_module["CubicBezierCurve3"](new three_module["Vector3"](point1.x,point1.y,point1.z),new three_module["Vector3"](control1.x,control1.y,control1.z),new three_module["Vector3"](control2.x,control2.y,control2.z),new three_module["Vector3"](point2.x,point2.y,point2.z));}}]);return ShipVelocityAnimation;}(animation_Animation);/* harmony default export */ var animation_ShipVelocityAnimation = (ShipVelocityAnimation_ShipVelocityAnimation);
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/AutomaticReplayPhaseStrategy/ReplayContext.js
var ReplayContext_ReplayContext=/*#__PURE__*/function(){function ReplayContext(phaseStrategy){Object(classCallCheck["a" /* default */])(this,ReplayContext);this.firingDuration=0;this.movementDuration=0;this.torpedoAttackDuration=0;this.destroyedShipsDuration=0;this.phaseStrategy=phaseStrategy;this.systemsDestroyed=[];}Object(createClass["a" /* default */])(ReplayContext,[{key:"getDestroyedShipsStart",value:function getDestroyedShipsStart(){return this.firingDuration+this.torpedoAttackDuration+this.movementDuration+this.destroyedShipsDuration;}},{key:"addDestroyedShipsDuration",value:function addDestroyedShipsDuration(duration){this.destroyedShipsDuration+=duration;}},{key:"getDestroyedShipsDuration",value:function getDestroyedShipsDuration(){return this.destroyedShipsDuration;}},{key:"getMovementStart",value:function getMovementStart(){return this.firingDuration+this.torpedoAttackDuration;}},{key:"setMovementDuration",value:function setMovementDuration(duration){this.movementDuration=duration;}},{key:"getNextFireStart",value:function getNextFireStart(){return this.firingDuration;}},{key:"addFireAnimationDuration",value:function addFireAnimationDuration(duration){this.firingDuration+=duration;}},{key:"getNextTorpedoAttackStart",value:function getNextTorpedoAttackStart(){return this.movementDuration+this.firingDuration;}},{key:"addTorpedoAttackAnimationDuration",value:function addTorpedoAttackAnimationDuration(duration){this.torpedoAttackDuration+=duration;}},{key:"resumeReplayRewind",value:function resumeReplayRewind(){this.phaseStrategy.unpauseAndRewindAnimation();}},{key:"pauseReplay",value:function pauseReplay(){this.phaseStrategy.pauseAnimation();}},{key:"resumeReplay",value:function resumeReplay(){this.phaseStrategy.unpauseAnimation();}},{key:"rewindToFiring",value:function rewindToFiring(){this.phaseStrategy.setAnimationTime(this.firingDuration+this.torpedoAttackDuration+this.movementDuration);}},{key:"rewindToMovement",value:function rewindToMovement(){}},{key:"getTurnLength",value:function getTurnLength(){return this.firingDuration+this.torpedoAttackDuration+this.movementDuration+this.destroyedShipsDuration;}},{key:"noteDestroyedSystem",value:function noteDestroyedSystem(ship,time,systems){this.systemsDestroyed.push({ship:ship,time:time,systems:systems});}},{key:"getDestroyedStructuresByShip",value:function getDestroyedStructuresByShip(ship){return this.systemsDestroyed.filter(function(_ref){var systemShip=_ref.ship;return ship===systemShip;}).filter(function(_ref2){var systems=_ref2.systems;return systems.some(function(system){return system instanceof structure_Structure;});});}}]);return ReplayContext;}();/* harmony default export */ var AutomaticReplayPhaseStrategy_ReplayContext = (ReplayContext_ReplayContext);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/replay/ShipWeaponAnimationService.js
var ShipWeaponAnimationService_boltEffect=new effect_BoltEffect();var ShipWeaponAnimationService_ShipWeaponAnimationService=/*#__PURE__*/function(){function ShipWeaponAnimationService(getRandom,particleEmitterContainer){Object(classCallCheck["a" /* default */])(this,ShipWeaponAnimationService);this.getRandom=getRandom;this.particleEmitterContainer=particleEmitterContainer;}Object(createClass["a" /* default */])(ShipWeaponAnimationService,[{key:"getBoltEffect",value:function getBoltEffect(startTime,startPosition,endPosition,speed,fade,duration,args,context){return ShipWeaponAnimationService_boltEffect.create(startTime,startPosition,endPosition,speed,fade,duration,args,this.getRandom,this.particleEmitterContainer,context);}},{key:"getDamageExplosion",value:function getDamageExplosion(size){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"glow";var endPosition=arguments.length>2?arguments[2]:undefined;var startTime=arguments.length>3?arguments[3]:undefined;var context=arguments.length>4?arguments[4]:undefined;return new effect_ExplosionEffect(this.particleEmitterContainer,this.getRandom,{position:endPosition.clone(),time:startTime,duration:250+this.getRandom()*250,type:type,size:size||10},context);}}]);return ShipWeaponAnimationService;}();/* harmony default export */ var replay_ShipWeaponAnimationService = (ShipWeaponAnimationService_ShipWeaponAnimationService);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogShipMovement.mjs
var CombatLogShipMovement_CombatLogShipMovement=/*#__PURE__*/function(){function CombatLogShipMovement(shipId){Object(classCallCheck["a" /* default */])(this,CombatLogShipMovement);this.shipId=shipId;this.replayOrder=20;}Object(createClass["a" /* default */])(CombatLogShipMovement,[{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,shipId:this.shipId};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.shipId=data.shipId;return this;}}]);return CombatLogShipMovement;}();/* harmony default export */ var combatLog_CombatLogShipMovement = (CombatLogShipMovement_CombatLogShipMovement);
// CONCATENATED MODULE: ./src/client/view/game/animation/CameraPositionAnimation.js
var CameraPositionAnimation_CameraPositionAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(CameraPositionAnimation,_Animation);function CameraPositionAnimation(position,time,endTime,gameCamera){var _this;Object(classCallCheck["a" /* default */])(this,CameraPositionAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CameraPositionAnimation).call(this));animation_Animation.call(Object(assertThisInitialized["a" /* default */])(_this));_this.time=time;_this.position=position;_this.lastTime=null;_this.endTime=0;_this.gameCamera=gameCamera;_this.duration=1000;if(endTime===undefined){_this.endTime=300;}_this.startPosition=null;_this.curve=new three_module["CubicBezierCurve"](new three_module["Vector2"](0,0),new three_module["Vector2"](0.5,0.0),new three_module["Vector2"](0.5,1),new three_module["Vector2"](1,1));return _this;}Object(createClass["a" /* default */])(CameraPositionAnimation,[{key:"render",value:function render(_ref){var now=_ref.now,total=_ref.total,last=_ref.last,delta=_ref.delta,zoom=_ref.zoom,back=_ref.back,paused=_ref.paused;this.smoothMove(now,total,last,delta,zoom,back);}},{key:"smoothMove",value:function smoothMove(now,total,last,delta,zoom,back,paused){if(back){return;}if(total>this.time&&total<this.time+this.duration&&!paused){if(this.startPosition===null){this.startPosition=this.gameCamera.getLookAtPosition();}var done=1-(this.time+this.duration-total)/this.duration;var point=this.curve.getPoint(done).y;var position=getPointBetween(this.startPosition,this.position,point,true);this.doMove(position);}else{this.startPosition=null;}}},{key:"instantMove",value:function instantMove(now,total,last,delta,zoom,back){if(back){return;}if(this.lastTime!==null&&this.lastTime<this.time&&total>this.time){this.doMove(this.position);}this.lastTime=total;}},{key:"doMove",value:function doMove(position){this.gameCamera.setByLookAtPosition(position);}}]);return CameraPositionAnimation;}(animation_Animation);/* harmony default export */ var animation_CameraPositionAnimation = (CameraPositionAnimation_CameraPositionAnimation);
// CONCATENATED MODULE: ./src/model/weapon/WeaponHitChance.mjs
var WeaponHitChance_WeaponHitChance=/*#__PURE__*/function(){function WeaponHitChance(data){Object(classCallCheck["a" /* default */])(this,WeaponHitChance);this.deserialize(data);}Object(createClass["a" /* default */])(WeaponHitChance,[{key:"serialize",value:function serialize(){return{baseToHit:this.baseToHit,fireControl:this.fireControl,dew:this.dew,oew:this.oew,distance:this.distance,evasion:this.evasion,rangeModifier:this.rangeModifier,result:this.result,absoluteResult:this.absoluteResult,outOfRange:this.outOfRange,rollingPenalty:this.rollingPenalty,noLockPenalty:this.noLockPenalty,ownEvasionPenalty:this.ownEvasionPenalty,evasionPenalty:this.evasionPenalty};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.baseToHit=data.baseToHit||0;this.fireControl=data.fireControl||0;this.dew=data.dew||0;this.oew=data.oew||0;this.distance=data.distance||0;this.rangeModifier=data.rangeModifier||0;this.result=data.result||0;this.absoluteResult=data.absoluteResult||0;this.outOfRange=data.outOfRange||false;this.evasion=data.evasion||0;this.rollingPenalty=data.rollingPenalty||0;this.noLockPenalty=data.noLockPenalty||0;this.ownEvasionPenalty=data.ownEvasionPenalty||0;this.evasionPenalty=data.evasionPenalty||0;return this;}}]);return WeaponHitChance;}();/* harmony default export */ var weapon_WeaponHitChance = (WeaponHitChance_WeaponHitChance);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogWeaponFireHitResult.mjs
var CombatLogWeaponFireHitResult_CombatLogWeaponFireHitResult=/*#__PURE__*/function(){function CombatLogWeaponFireHitResult(result,hitChance,hitRoll){Object(classCallCheck["a" /* default */])(this,CombatLogWeaponFireHitResult);this.result=result;this.hitChance=hitChance;this.hitRoll=hitRoll;}Object(createClass["a" /* default */])(CombatLogWeaponFireHitResult,[{key:"serialize",value:function serialize(){return{result:this.result,hitChance:this.hitChance.serialize(),hitRoll:this.hitRoll};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.result=data.result||false;this.hitChance=new weapon_WeaponHitChance().deserialize(data.hitChance);this.hitRoll=data.hitRoll||1;return this;}}]);return CombatLogWeaponFireHitResult;}();/* harmony default export */ var combatLog_CombatLogWeaponFireHitResult = (CombatLogWeaponFireHitResult_CombatLogWeaponFireHitResult);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogWeaponFire.mjs
var CombatLogWeaponFire_CombatLogWeaponFire=/*#__PURE__*/function(){function CombatLogWeaponFire(fireOrderId,targetId,shooterId,ammo){Object(classCallCheck["a" /* default */])(this,CombatLogWeaponFire);this.fireOrderId=fireOrderId;this.targetId=targetId;this.shooterId=shooterId;this.damages=[];this.notes=[];this.hitResult=null;this.ammoName=ammo?ammo.getShortDisplayName():null;}Object(createClass["a" /* default */])(CombatLogWeaponFire,[{key:"addNote",value:function addNote(note){this.notes.push(note);}},{key:"addDamage",value:function addDamage(damageEntry){this.damages.push(damageEntry);}},{key:"addHitResult",value:function addHitResult(hitResult){this.hitResult=hitResult;}},{key:"setShots",value:function setShots(shotsHit,totalShots){this.shotsHit=shotsHit;this.totalShots=totalShots;}},{key:"causedDamage",value:function causedDamage(){return this.damages.length>0;}},{key:"getDamages",value:function getDamages(target){return this.damages.reduce(function(all,current){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(current.entries.reduce(function(all,damageEntry){var system=target.systems.getSystemById(damageEntry.systemId);return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(damageEntry.damageIds.map(function(id){return system.damage.getDamageById(id);})));},[])));},[]);}},{key:"getDestroyedSystems",value:function getDestroyedSystems(target){return this.getDamages(target).filter(function(damage){return damage.destroyedSystem;}).map(function(damage){return damage.system;});}},{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,fireOrderId:this.fireOrderId,targetId:this.targetId,shooterId:this.shooterId,damages:this.damages.map(function(damage){return damage.serialize();}),notes:this.notes,hitResult:this.hitResult?this.hitResult.serialize():null,shotsHit:this.shotsHit,totalShots:this.totalShots,ammoName:this.ammoName};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.fireOrderId=data.fireOrderId;this.targetId=data.targetId;this.shooterId=data.shooterId;this.damages=data.damages.map(function(damage){return new combatLog_CombatLogDamageEntry().deserialize(damage);});this.notes=data.notes||[];this.hitResult=data.hitResult?new combatLog_CombatLogWeaponFireHitResult().deserialize(data.hitResult):null;this.shotsHit=data.shotsHit||0;this.totalShots=data.totalShots||0;this.ammoName=data.ammoName||null;return this;}}]);return CombatLogWeaponFire;}();/* harmony default export */ var combatLog_CombatLogWeaponFire = (CombatLogWeaponFire_CombatLogWeaponFire);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogGroupedWeaponFire.mjs
var CombatLogGroupedWeaponFire_CombatLogGroupedWeaponFire=/*#__PURE__*/function(){function CombatLogGroupedWeaponFire(targetId){Object(classCallCheck["a" /* default */])(this,CombatLogGroupedWeaponFire);this.targetId=targetId;this.entries=[];this.replayOrder=5;}Object(createClass["a" /* default */])(CombatLogGroupedWeaponFire,[{key:"addEntry",value:function addEntry(fire){this.entries.push(fire);}},{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,entries:this.entries.map(function(entry){return entry.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.targetId=data.targetId;this.entries=data.entries?data.entries.map(function(entry){return new combatLog_CombatLogWeaponFire().deserialize(entry);}):[];return this;}}]);return CombatLogGroupedWeaponFire;}();/* harmony default export */ var combatLog_CombatLogGroupedWeaponFire = (CombatLogGroupedWeaponFire_CombatLogGroupedWeaponFire);
// CONCATENATED MODULE: ./src/client/view/game/animation/SystemDestroyedTextAnimation.js
var SystemDestroyedTextAnimation_TEXTURE_SIZE=256;var getKey=function getKey(position,time){return time+"-"+position.x+"-"+position.y;};var SystemDestroyedTextAnimation_getSprite=function getSprite(name,position,scene){var sprite=null;if(name.structure){sprite=new sprite_TextSprite(name.toUpperCase(),"rgba(255, 100, 45, 0.7)",position.z+30,{fontSize:"24px",size:512});}else{sprite=new sprite_TextSprite(name.toUpperCase(),"rgba(255, 255, 255, 0.7)",position.z+30,{fontSize:"18px",size:512});}sprite.setPosition(position);sprite.setOpacity(0);scene.add(sprite.mesh);return sprite;};var changeTimeIfNeccessary=function changeTimeIfNeccessary(position,time,texts){var inSameHex=SystemDestroyedTextAnimation_getInSameHex(position,texts);if(inSameHex.length===0){return time;}while(isTooClose(time,inSameHex)){time+=200;}return time;};var SystemDestroyedTextAnimation_getInSameHex=function getInSameHex(position,texts){var gamePosition=utils_CoordinateConverter.fromGameToHex(position);return texts.filter(function(text){return utils_CoordinateConverter.fromGameToHex(text.position).equals(gamePosition);});};var isTooClose=function isTooClose(time,texts){return texts.some(function(text){return text.time-time<200&&text.time-time>-200;});};var SystemDestroyedTextAnimation_SystemDestroyedTextAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(SystemDestroyedTextAnimation,_Animation);function SystemDestroyedTextAnimation(scene){var _this;Object(classCallCheck["a" /* default */])(this,SystemDestroyedTextAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SystemDestroyedTextAnimation).call(this));_this.scene=scene;_this.duration=1000;_this.fadeOutSpeed=2000;_this.velocity=0.1;_this.destroyedTexts=[];return _this;}Object(createClass["a" /* default */])(SystemDestroyedTextAnimation,[{key:"deactivate",value:function deactivate(){var _this2=this;this.destroyedTexts.forEach(function(destroyedText){_this2.scene.remove(destroyedText.sprite.mesh);destroyedText.sprite.destroy();},this);this.destroyedTexts=[];}},{key:"add",value:function add(position,names,time){var _this3=this;names=[].concat(names);names.filter(Boolean).forEach(function(name){_this3.destroyedTexts.push({time:changeTimeIfNeccessary(position,time,_this3.destroyedTexts),position:position,sprite:SystemDestroyedTextAnimation_getSprite(name,position,_this3.scene)});},this);}},{key:"render",value:function render(_ref){var _this4=this;var now=_ref.now,total=_ref.total,last=_ref.last,delta=_ref.delta,zoom=_ref.zoom;this.destroyedTexts.forEach(function(text){var time=text.time;var sprite=text.sprite;if(total<time||total>time+_this4.duration+_this4.fadeOutSpeed){sprite.setOpacity(0);return;}sprite.setScale(zoom,zoom);var ellapsedTime=total-time;var newPos=Object(objectSpread2["a" /* default */])({},text.position,{y:text.position.y+_this4.velocity*zoom*ellapsedTime});sprite.setPosition(newPos);var fadeTime=total-(time+_this4.duration);if(fadeTime<0){sprite.setOpacity(1);}else{var opacity=1-fadeTime/_this4.fadeOutSpeed;sprite.setOpacity(opacity);}},this);}},{key:"getDuration",value:function getDuration(){return 0;}}]);return SystemDestroyedTextAnimation;}(animation_Animation);/* harmony default export */ var animation_SystemDestroyedTextAnimation = (SystemDestroyedTextAnimation_SystemDestroyedTextAnimation);
// CONCATENATED MODULE: ./src/client/view/game/animation/TorpedoMovementAnimation.js
var TorpedoMovementAnimation_TorpedoMovementAnimation=/*#__PURE__*/function(_Animation){Object(inherits["a" /* default */])(TorpedoMovementAnimation,_Animation);function TorpedoMovementAnimation(icon,startPosition,endPosition,start,end){var _this;var launch=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;var interceptTime=arguments.length>6&&arguments[6]!==undefined?arguments[6]:null;var impact=arguments.length>7&&arguments[7]!==undefined?arguments[7]:false;Object(classCallCheck["a" /* default */])(this,TorpedoMovementAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoMovementAnimation).call(this));_this.icon=icon;_this.start=start;_this.end=end;_this.duration=end-start;_this.startPosition=startPosition;_this.endPosition=endPosition;_this.interceptTime=interceptTime;_this.launch=launch;_this.impact=impact;_this.positionCurve=_this.buildPositionCurve(startPosition,endPosition);var getRandom=getSeededRandomGenerator(icon.torpedoFlight.id);_this.variance=new utils_Vector(getRandom()*30-15,getRandom()*30-15);animation_Animation.call(Object(assertThisInitialized["a" /* default */])(_this));return _this;}Object(createClass["a" /* default */])(TorpedoMovementAnimation,[{key:"deactivate",value:function deactivate(){this.icon.hide();}},{key:"update",value:function update(gameData){}},{key:"cleanUp",value:function cleanUp(){}},{key:"getPositionAt",value:function getPositionAt(time){var turnDone=this.getMovementTurnDone({total:time});if(turnDone===-1){throw new Error("Don't ask ShipVelocityAnimation");}var percentDone=turnDone<1?turnDone%1:1;return{facing:this.endMove.facing,position:this.positionCurve.getPoint(percentDone)};}},{key:"getInterceptPosition",value:function getInterceptPosition(){var turnDone=this.getMovementTurnDone({total:this.interceptTime});var percentDone=turnDone<1?turnDone%1:1;var position=this.positionCurve.getPoint(percentDone);return new utils_Vector(position);}},{key:"getMovementTurnDone",value:function getMovementTurnDone(_ref){var total=_ref.total;if(total<this.start){return 0;}if(total>this.end){return 1;}var time=total-this.start;return time/this.duration;}},{key:"render",value:function render(_ref2){var total=_ref2.total;var turnDone=this.getMovementTurnDone({total:total});if(this.interceptTime!==null&&total>this.interceptTime){this.icon.hide();return;}if(turnDone===0&&this.launch){this.icon.hide();return;}var percentDone=turnDone<1?turnDone%1:1;if(turnDone===1&&this.impact){this.icon.hide();return;}this.icon.show();var position=this.positionCurve.getPoint(percentDone);this.icon.setPosition({x:position.x+this.variance.x,y:position.y+this.variance.y,z:position.z});this.icon.setFacing(-getCompassHeadingOfPoint(this.startPosition,this.endPosition));}},{key:"buildPositionCurve",value:function buildPositionCurve(start,end){/*
    const point1 = start.roundToHexCenter();
    const control1 = start.roundToHexCenter();
    const control2 = end.roundToHexCenter();
    const point2 = end.roundToHexCenter();
    */var point1=start;var control1=start;var control2=end;var point2=end;if(!this.impact){return new three_module["CubicBezierCurve3"](new three_module["Vector3"](point1.x,point1.y,point1.z),new three_module["Vector3"](control1.x,control1.y,control1.z),new three_module["Vector3"](control2.x,control2.y,control2.z),new three_module["Vector3"](point2.x,point2.y,point2.z));}return new three_module["LineCurve3"](new three_module["Vector3"](point1.x,point1.y,point1.z),new three_module["Vector3"](point2.x,point2.y,point2.z));}}]);return TorpedoMovementAnimation;}(animation_Animation);/* harmony default export */ var animation_TorpedoMovementAnimation = (TorpedoMovementAnimation_TorpedoMovementAnimation);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogTorpedoAttack.mjs
var CombatLogTorpedoAttack_CombatLogTorpedoAttack=/*#__PURE__*/function(){function CombatLogTorpedoAttack(torpedoFlightId,targetId){Object(classCallCheck["a" /* default */])(this,CombatLogTorpedoAttack);this.torpedoFlightId=torpedoFlightId;this.targetId=targetId;this.damages=[];this.notes=[];}Object(createClass["a" /* default */])(CombatLogTorpedoAttack,[{key:"addNote",value:function addNote(note){this.notes.push(note);}},{key:"addDamage",value:function addDamage(damageEntry){this.damages.push(damageEntry);}},{key:"getDamages",value:function getDamages(target){return this.damages.reduce(function(all,current){return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(current.entries.reduce(function(all,damageEntry){var system=target.systems.getSystemById(damageEntry.systemId);return[].concat(Object(toConsumableArray["a" /* default */])(all),Object(toConsumableArray["a" /* default */])(damageEntry.damageIds.map(function(id){return system.damage.getDamageById(id);})));},[])));},[]);}},{key:"getDestroyedSystems",value:function getDestroyedSystems(target){return this.getDamages(target).filter(function(damage){return damage.destroyedSystem;}).map(function(damage){return damage.system;});}},{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,torpedoFlightId:this.torpedoFlightId,damages:this.damages.map(function(damage){return damage.serialize();}),notes:this.notes,targetId:this.targetId};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.torpedoFlightId=data.torpedoFlightId;this.targetId=data.targetId;this.damages=data.damages.map(function(damage){return new combatLog_CombatLogDamageEntry().deserialize(damage);});this.notes=data.notes||[];return this;}}]);return CombatLogTorpedoAttack;}();/* harmony default export */ var combatLog_CombatLogTorpedoAttack = (CombatLogTorpedoAttack_CombatLogTorpedoAttack);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogGroupedTorpedoAttack.mjs
var CombatLogGroupedTorpedoAttack_CombatLogGroupedTorpedoAttack=/*#__PURE__*/function(){function CombatLogGroupedTorpedoAttack(targetId){Object(classCallCheck["a" /* default */])(this,CombatLogGroupedTorpedoAttack);this.targetId=targetId;this.entries=[];this.replayOrder=10;}Object(createClass["a" /* default */])(CombatLogGroupedTorpedoAttack,[{key:"addEntry",value:function addEntry(attack){this.entries.push(attack);}},{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,entries:this.entries.map(function(entry){return entry.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.targetId=data.targetId;this.entries=data.entries?data.entries.map(function(entry){return new combatLog_CombatLogTorpedoAttack().deserialize(entry);}):[];return this;}}]);return CombatLogGroupedTorpedoAttack;}();/* harmony default export */ var combatLog_CombatLogGroupedTorpedoAttack = (CombatLogGroupedTorpedoAttack_CombatLogGroupedTorpedoAttack);
// CONCATENATED MODULE: ./src/client/view/game/animation/TorpedoExplosion/TorpedoExplosionHE.js
var TorpedoExplosionHE_TorpedoExplosionHE=/*#__PURE__*/function(_ShipWeaponAnimation){Object(inherits["a" /* default */])(TorpedoExplosionHE,_ShipWeaponAnimation);function TorpedoExplosionHE(getPosition,time,particleEmitterContainer,getRandom,torpedo,targetIcon){var _this;Object(classCallCheck["a" /* default */])(this,TorpedoExplosionHE);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoExplosionHE).call(this,{getRandom:getRandom,particleEmitterContainer:particleEmitterContainer}));_this.animations=[];var _getPosition=getPosition(targetIcon.ship),targetPosition=_getPosition.position,facing=_getPosition.facing;var position=_this.getRandomLocationOnShip(targetIcon,facing).add(targetPosition);var explosionSize=torpedo.visuals.explosionSize;_this.animations.push(new effect_ExplosionEffect(particleEmitterContainer,getRandom,{position:position,time:time,duration:250+getRandom()*250,type:"gas",size:getRandom()*(explosionSize*0.3)+explosionSize,color:new three_module["Color"](51/255,163/255,255/255)},Object(assertThisInitialized["a" /* default */])(_this)));_this.animations.push(new effect_ExplosionEffect(particleEmitterContainer,getRandom,{position:position,time:time,duration:250+getRandom()*250,type:"glow",size:getRandom()*(explosionSize*0.2)+explosionSize*0.4},Object(assertThisInitialized["a" /* default */])(_this)));return _this;}Object(createClass["a" /* default */])(TorpedoExplosionHE,[{key:"deactivate",value:function deactivate(){this.particleEmitterContainer.release(this);return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(TorpedoExplosionHE.prototype),"deactivate",this).call(this);}}]);return TorpedoExplosionHE;}(animation_ShipWeaponAnimation_ShipWeaponAnimation);/* harmony default export */ var TorpedoExplosion_TorpedoExplosionHE = (TorpedoExplosionHE_TorpedoExplosionHE);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/readOnlyError.js
var readOnlyError = __webpack_require__(148);

// CONCATENATED MODULE: ./src/client/view/game/animation/TorpedoExplosion/TorpedoExplosionMSV.js
var TorpedoExplosionMSV_TorpedoExplosionMSV=/*#__PURE__*/function(_ShipWeaponAnimation){Object(inherits["a" /* default */])(TorpedoExplosionMSV,_ShipWeaponAnimation);function TorpedoExplosionMSV(position,startTime,time,particleEmitterContainer,getRandom,torpedo,damages,targetIcon,getPosition,msvPosition){var _this;var speed=arguments.length>10&&arguments[10]!==undefined?arguments[10]:0.2;Object(classCallCheck["a" /* default */])(this,TorpedoExplosionMSV);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoExplosionMSV).call(this,{getRandom:getRandom,particleEmitterContainer:particleEmitterContainer}));_this.particleEmitterContainer=particleEmitterContainer;_this.animations=[];var amount=damages.length;var color=new three_module["Color"](torpedo.visuals.engineColor[0]*1.5,torpedo.visuals.engineColor[1]*1.5,torpedo.visuals.engineColor[2]*1.5);var boltArgs={color:[color.r,color.g,color.b],size:3,length:4,coreOpacity:0.01};var boltEffect=new effect_BoltEffect();var _getPosition=getPosition(targetIcon.ship),targetPosition=_getPosition.position,facing=_getPosition.facing;damages.forEach(function(damage){var system=targetIcon.ship.systems.getSystemById(damage.entries[0].systemId);var explosionPosition=_this.getLocationForSystemOrRandomLocationOnSection(system,targetIcon,facing).add(targetPosition);var duration=msvPosition.distanceTo(explosionPosition)/speed;boltEffect.create(startTime,msvPosition,explosionPosition.clone(),speed,200,duration,boltArgs,getRandom,particleEmitterContainer,Object(assertThisInitialized["a" /* default */])(_this));_this.animations.push(new effect_ExplosionEffect(particleEmitterContainer,getRandom,{position:explosionPosition,time:startTime+duration,duration:100+getRandom()*250,type:"gas",size:8,opacity:0.25},Object(assertThisInitialized["a" /* default */])(_this)));});var missAmount=torpedo.damageStrategy.numberOfShots-amount;if(amount<0){amount=(Object(readOnlyError["a" /* default */])("amount"),0);}for(var i=0;i<missAmount;i++){var explosionPosition=_this.getRandomLocationOnShip(targetIcon,facing).add(targetPosition);boltEffect.create(startTime,msvPosition,explosionPosition,speed,1000,time-startTime+getRandom()*1000+500,boltArgs,getRandom,particleEmitterContainer,Object(assertThisInitialized["a" /* default */])(_this));}return _this;}Object(createClass["a" /* default */])(TorpedoExplosionMSV,[{key:"deactivate",value:function deactivate(){this.particleEmitterContainer.release(this);return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(TorpedoExplosionMSV.prototype),"deactivate",this).call(this);}}]);return TorpedoExplosionMSV;}(animation_ShipWeaponAnimation_ShipWeaponAnimation);/* harmony default export */ var TorpedoExplosion_TorpedoExplosionMSV = (TorpedoExplosionMSV_TorpedoExplosionMSV);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogTorpedoLaunch.mjs
var CombatLogTorpedoLaunch_CombatLogTorpedoLaunch=/*#__PURE__*/function(){function CombatLogTorpedoLaunch(torpedoFlightId){Object(classCallCheck["a" /* default */])(this,CombatLogTorpedoLaunch);this.torpedoFlightId=torpedoFlightId;this.replayOrder=15;}Object(createClass["a" /* default */])(CombatLogTorpedoLaunch,[{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,torpedoFlightId:this.torpedoFlightId};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.torpedoFlightId=data.torpedoFlightId;return this;}}]);return CombatLogTorpedoLaunch;}();/* harmony default export */ var combatLog_CombatLogTorpedoLaunch = (CombatLogTorpedoLaunch_CombatLogTorpedoLaunch);
// CONCATENATED MODULE: ./src/client/view/game/renderer/sprite/EffectSprite.js
var EffectSprite_TEXTURE_GAS=0;var EffectSprite_TEXTURE_BOLT=1;var EffectSprite_TEXTURE_GLOW=2;var EffectSprite_TEXTURE_RING=3;var EffectSprite_TEXTURE_STARLINE=4;var TEXTURE_FILLED_RING=5;var EffectSprite_textureLoader=new three_module["TextureLoader"]();var EffectSprite_texture=EffectSprite_textureLoader.load("/img/effect/effectTextures1024.png");var EffectSprite_EffecSprite=/*#__PURE__*/function(){function EffecSprite(scene){var args=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Object(classCallCheck["a" /* default */])(this,EffecSprite);this.activationTime=args.activationTime||0;this.fadeInDuration=args.fadeInDuration||0;this.fadeOutDuration=args.fadeOutDuration||0;this.fadeOutTime=args.fadeOutTime||null;this.blending=args.blending||three_module["AdditiveBlending"];this.scale=args.scale||{width:1,height:1};this.position=args.position.toThree()||three_module["Vector3"](0,0,0);this.textureNumber=args.texture||0;this.color=args.color||new three_module["Color"](1,1,1);this.opacity=args.opacity||1.0;this.scaleChange=args.scaleChange||null;this.mesh=null;this.scene=scene;this.uniforms={texture:{type:"t",value:EffectSprite_texture},overlayColor:{type:"v3",value:this.color},opacity:{type:"f",value:1.0},textureNumber:{type:"f",value:this.textureNumber}};this.mesh=this.create();this.setPosition(this.position);this.setScale(this.scale.width,this.scale.height);}Object(createClass["a" /* default */])(EffecSprite,[{key:"getOpacity",value:function getOpacity(total){if(this.fadeOutTime!==null&&total>=this.activationTime+this.fadeOutTime+this.fadeOutDuration){return 0.0;}if(this.fadeOutTime!==null&&total>this.activationTime+this.fadeOutTime&&total<this.activationTime+this.fadeOutTime+this.fadeOutDuration){return(this.activationTime+this.fadeOutTime+this.fadeOutDuration-total)/this.fadeOutDuration;}if(total>this.activationTime+this.fadeInDuration){return 1.0;}if(total>this.activationTime&&total<this.activationTime+this.fadeInDuration){return 1-(this.activationTime+this.fadeInDuration-total)/this.fadeInDuration;}return 0;}},{key:"render",value:function render(_ref){var total=_ref.total;if(this.activationTime>total){this.hide();return;}var activeTime=total-this.activationTime;var opacity=this.getOpacity(total);if(opacity===0){this.hide();return;}this.setOpacity(opacity);if(this.scaleChange!==null){this.setScale(this.scale.width*this.scaleChange*activeTime,this.scale.height*this.scaleChange*activeTime);}this.show();}},{key:"setTexture",value:function setTexture(tex){this.uniforms.textureNumber.value=tex;return this;}},{key:"hide",value:function hide(){this.mesh.visible=false;return this;}},{key:"show",value:function show(){this.mesh.visible=true;return this;}},{key:"setPosition",value:function setPosition(pos){this.mesh.position.x=pos.x;this.mesh.position.y=pos.y;this.mesh.position.z=pos.z;return this;}},{key:"getPosition",value:function getPosition(){return this.mesh.position;}},{key:"isPosition",value:function isPosition(position){return this.mesh.position.x===position.x&&this.mesh.position.y===position.y&&this.mesh.position.z===position.z;}},{key:"setOpacity",value:function setOpacity(opacity){this.uniforms.opacity.value=opacity*this.opacity;return this;}},{key:"multiplyOpacity",value:function multiplyOpacity(m){this.uniforms.opacity.value=this.opacity*m;return this;}},{key:"setColor",value:function setColor(color){this.color=color;this.uniforms.overlayColor.value=color;return this;}},{key:"setScale",value:function setScale(width,height){this.mesh.scale.set(width,height,1);return this;}},{key:"destroy",value:function destroy(){this.mesh.material.dispose();this.scene.remove(this.mesh);}},{key:"setFacing",value:function setFacing(facing){this.mesh.rotation.z=degreeToRadian(facing);return this;}},{key:"getFacing",value:function getFacing(){return radianToDegree(this.mesh.rotation.z);}},{key:"create",value:function create(){this.material=new three_module["ShaderMaterial"]({vertexShader:shader_effectSpriteVertexShader,fragmentShader:shader_effectSpriteFragmentShader,transparent:true,depthWrite:false,depthTest:false,blending:this.blending});var geometry=new three_module["PlaneGeometry"](1,1,1,1);this.material.uniforms=this.uniforms;var mesh=new three_module["Mesh"](geometry,this.material);this.scene.add(mesh);return mesh;}}]);return EffecSprite;}();/* harmony default export */ var EffectSprite = (EffectSprite_EffecSprite);
// CONCATENATED MODULE: ./src/client/view/game/animation/ShipDestroyedAnimation.js
var ShipDestroyedAnimation_boltEffect=new effect_BoltEffect();var ShipDestroyedAnimation_ShipDestroyedAnimation=/*#__PURE__*/function(_ShipWeaponAnimation){Object(inherits["a" /* default */])(ShipDestroyedAnimation,_ShipWeaponAnimation);function ShipDestroyedAnimation(icon,facing,position,start,getRandom,particleEmitterContainer,scene){var _this;Object(classCallCheck["a" /* default */])(this,ShipDestroyedAnimation);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ShipDestroyedAnimation).call(this,{getRandom:getRandom,particleEmitterContainer:particleEmitterContainer}));_this.animations=[];var size=icon.dimensions.x>icon.dimensions.y?icon.dimensions.x:icon.dimensions.y;_this.hideTime=2500;_this.icon=icon;_this.start=start;var explosionCount=Math.ceil(_this.icon.dimensions.x*_this.icon.dimensions.y*_this.icon.dimensions.z/10000)+Math.round(getRandom()*5);while(explosionCount--){var explosionPosition=_this.getRandomLocationOnShip(_this.icon,facing).add(position);new effect_ExplosionEffect(_this.particleEmitterContainer,_this.getRandom,{position:explosionPosition,time:start+_this.getRandom()*3000,duration:250+getRandom()*250,type:"gas",size:getRandom()*30+10,color:new three_module["Color"](51/255,163/255,255/255)},Object(assertThisInitialized["a" /* default */])(_this));}var mainExplosionGlow=new EffectSprite(scene,{position:position.setZ(icon.shipZ),scale:{width:size*4,height:size*4},color:new three_module["Color"](51/255,163/255,255/255),texture:EffectSprite_TEXTURE_GLOW,fadeInDuration:500,fadeOutTime:1000,fadeOutDuration:1000,activationTime:start+2000,scaleChange:0.001,blending:three_module["NormalBlending"],opacity:1.0});_this.animations.push(mainExplosionGlow);var secondaryExplosionGlow=new EffectSprite(scene,{position:position.setZ(icon.shipZ),scale:{width:size*3,height:size*3},color:new three_module["Color"](1,1,1),texture:EffectSprite_TEXTURE_GLOW,fadeInDuration:500,fadeOutTime:1000,fadeOutDuration:1000,activationTime:start+2000,scaleChange:0.001,blending:three_module["AdditiveBlending"],opacity:1.0});_this.animations.push(secondaryExplosionGlow);var ring=new EffectSprite(scene,{position:position.setZ(icon.shipZ),scale:{width:size*0.8,height:size*0.8},color:new three_module["Color"](51/255,163/255,255/255),texture:TEXTURE_FILLED_RING,fadeInDuration:0,fadeOutTime:200,fadeOutDuration:300,activationTime:start+3000,scaleChange:0.03,opacity:0.5});_this.animations.push(ring);/*
    let shootOffs = getRandom() * 100 + 50;

    while (shootOffs--) {
      boltEffect.create(
        this.hideTime,
        position.setZ(icon.shipZ),
        new Vector(endPosition),
        speed * 1.5,
        args.fadeOutSpeed || Math.random() * 500 + 250,
        Math.floor(Math.random() * 500 + 250) / this.speed,
        {
          size: radius / 3,
          color: [color.r, color.g, color.b],
          coreOpacity: 0.1,
          repeat: this.repeat,
        },
        this.getRandom,
        this.emitterContainer,
        this.context
      );
    }

    */return _this;}Object(createClass["a" /* default */])(ShipDestroyedAnimation,[{key:"render",value:function render(payload){if(payload.total>this.start+this.hideTime){this.icon.hide();}else{this.icon.show();}this.animations.forEach(function(a){return a.render(payload);});}},{key:"deactivate",value:function deactivate(){this.particleEmitterContainer.release(this);this.animations.forEach(function(a){return a.destroy();});return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ShipDestroyedAnimation.prototype),"deactivate",this).call(this);}}]);return ShipDestroyedAnimation;}(animation_ShipWeaponAnimation_ShipWeaponAnimation);/* harmony default export */ var animation_ShipDestroyedAnimation = (ShipDestroyedAnimation_ShipDestroyedAnimation);
// CONCATENATED MODULE: ./src/client/view/game/ui/uiStrategy/replay/ReplayTurnActions.js
var ReplayTurnActions_getMovesForShip=function getMovesForShip(gameDatas,ship){return gameDatas.reduce(function(moves,gameData){return[].concat(Object(toConsumableArray["a" /* default */])(moves),Object(toConsumableArray["a" /* default */])(gameData.ships.getShipById(ship.id).movement.getMovement()));},[]);};var getEndMoveForShip=function getEndMoveForShip(gameDatas,ship){return ReplayTurnActions_getMovesForShip(gameDatas,ship).pop();};var getStartMoveForShip=function getStartMoveForShip(gameDatas,ship){return ReplayTurnActions_getMovesForShip(gameDatas,ship).shift();};var getShipStartPositionAndFacingForShip=function getShipStartPositionAndFacingForShip(gameDatas,ship){var move=getStartMoveForShip(gameDatas,ship);return{position:move.position,facing:move.facing};};var ReplayTurnActions_ReplayTurnActions=/*#__PURE__*/function(_AnimationUiStrategy){Object(inherits["a" /* default */])(ReplayTurnActions,_AnimationUiStrategy);function ReplayTurnActions(replayContext){var _this;Object(classCallCheck["a" /* default */])(this,ReplayTurnActions);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ReplayTurnActions).call(this));_this.replayContext=replayContext;_this.systemDestroyedTextAnimation=null;_this.ready=false;return _this;}Object(createClass["a" /* default */])(ReplayTurnActions,[{key:"newTurn",value:function(){var _newTurn=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(gameDatas){var _this2=this;var _this$services,shipIconContainer,particleEmitterContainer,uiState,scene,gameData;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$services=this.services,shipIconContainer=_this$services.shipIconContainer,particleEmitterContainer=_this$services.particleEmitterContainer,uiState=_this$services.uiState,scene=_this$services.scene;_context.next=3;return shipIconContainer.shipsLoaded();case 3:_context.next=5;return particleEmitterContainer.ready();case 5:gameData=gameDatas[0];this.getRandom=getSeededRandomGenerator("id"+gameData.id+"turn"+gameData.turn);uiState.startCombatLog(this.replayContext,gameData);this.systemDestroyedTextAnimation=new animation_SystemDestroyedTextAnimation(scene);this.animations.push(this.systemDestroyedTextAnimation);gameData.combatLog.getForReplay().forEach(function(combatLogEntry){if(combatLogEntry instanceof combatLog_CombatLogShipMovement){_this2.buildMovementAnimation(combatLogEntry,gameDatas);}else if(combatLogEntry instanceof combatLog_CombatLogGroupedWeaponFire){_this2.buildWeaponFireAnimation(combatLogEntry,gameDatas);}else if(combatLogEntry instanceof combatLog_CombatLogTorpedoLaunch){_this2.buildTorpedoMoveAnimation(combatLogEntry,gameDatas);}else if(combatLogEntry instanceof combatLog_CombatLogGroupedTorpedoAttack){_this2.buildTorpedoAttackAnimation(combatLogEntry,gameDatas);}});this.buildShipDamageAnimations(gameDatas);case 12:case"end":return _context.stop();}}},_callee,this);}));function newTurn(_x){return _newTurn.apply(this,arguments);}return newTurn;}()},{key:"buildDestroyedShipsAnimation",value:function buildDestroyedShipsAnimation(gameDatas,ship){var _this$services2=this.services,gameCamera=_this$services2.gameCamera,shipIconContainer=_this$services2.shipIconContainer,particleEmitterContainer=_this$services2.particleEmitterContainer,scene=_this$services2.scene;var start=this.replayContext.getDestroyedShipsStart();var cameraDuration=2000;var effectStart=start+cameraDuration;var endMove=getEndMoveForShip(gameDatas,ship);var position=endMove.getPosition();var icon=shipIconContainer.getByShip(ship);this.animations.push(new animation_CameraPositionAnimation(position,start,effectStart,gameCamera));this.animations.push(new animation_ShipDestroyedAnimation(icon,endMove.getFacing(),endMove.getPosition(),effectStart,this.getRandom,particleEmitterContainer,scene));this.replayContext.addDestroyedShipsDuration(cameraDuration+5000);}},{key:"buildShipDamageAnimations",value:function buildShipDamageAnimations(gameDatas){var _this3=this;var shipIconContainer=this.services.shipIconContainer;gameDatas[0].ships.getShips().forEach(function(ship){var icon=shipIconContainer.getByShip(ship);var systemsDestroyed=_this3.replayContext.getDestroyedStructuresByShip(ship);var end=null;if(ship.isDestroyedThisTurn()){end=_this3.replayContext.getDestroyedShipsStart()+2000;_this3.buildDestroyedShipsAnimation(gameDatas,ship);}var destroyedSections=ship.systems.sections.getSectionsWithStructure().filter(function(section){var structure=section.getStructure();return structure.isDestroyed()&&systemsDestroyed.every(function(_ref){var systems=_ref.systems;return systems.every(function(system){return system.id!==structure.id;});});});var destroyedAnimations=[];if(destroyedSections.length>0){destroyedAnimations.push({sections:destroyedSections,start:0,end:null});}systemsDestroyed.forEach(function(_ref2){var time=_ref2.time,systems=_ref2.systems;var newDestroyed=ship.systems.sections.getSectionsWithStructure().filter(function(section){var structure=section.getStructure();return systems.some(function(system){return system.id===structure.id;});});time+=_this3.getRandom()*500+500;destroyedSections=[].concat(Object(toConsumableArray["a" /* default */])(destroyedSections),Object(toConsumableArray["a" /* default */])(newDestroyed));if(destroyedAnimations[destroyedAnimations.length-1]){destroyedAnimations[destroyedAnimations.length-1].end=time;}destroyedAnimations.push({sections:destroyedSections,start:time,end:end});});destroyedAnimations.forEach(function(_ref3){var sections=_ref3.sections,start=_ref3.start,end=_ref3.end;_this3.animations.push(new animation_ShipDamageAnimation(icon,sections,start,end));});});}},{key:"buildInterceptAnimation",value:function buildInterceptAnimation(gameData,targetIcon,intercepts,interceptTime,interceptPosition,gameDatas){var _this4=this;var _this$services3=this.services,particleEmitterContainer=_this$services3.particleEmitterContainer,shipIconContainer=_this$services3.shipIconContainer;var weaponAnimationService=new replay_ShipWeaponAnimationService(this.getRandom,particleEmitterContainer);intercepts.forEach(function(intercept){var ship=gameData.ships.getShipById(intercept.shipId);var weapon=ship.systems.getSystemById(intercept.weaponId);if(!intercept.isSucessfull()){return;}var animationName=weapon.callHandler("getWeaponFireAnimationName");if(!animationName){return;}var animation=new animation_ShipWeaponAnimation["ShipWeapon".concat(animationName.charAt(0).toUpperCase()+animationName.slice(1),"Animation")]({getRandom:_this4.getRandom,particleEmitterContainer:particleEmitterContainer,weapon:weapon,getPosition:function getPosition(ship){return getShipStartPositionAndFacingForShip(gameDatas,ship);},args:weapon.callHandler("getWeaponFireAnimationArguments"),weaponAnimationService:weaponAnimationService,targetIcon:targetIcon,shooterIcon:shipIconContainer.getByShip(ship),animationStartTime:0,impactPosition:interceptPosition,impactTime:interceptTime,totalShots:weapon.callHandler("getTotalBurstSize",null,1),shotsHit:intercept.isSucessfull()?1:0,omitHitExplosion:true});_this4.animations.push(animation);});}},{key:"buildTorpedoAttackAnimation",value:function buildTorpedoAttackAnimation(combatLogEntry,gameDatas){var _this5=this;var _this$services4=this.services,shipIconContainer=_this$services4.shipIconContainer,gameCamera=_this$services4.gameCamera,particleEmitterContainer=_this$services4.particleEmitterContainer,torpedoIconContainer=_this$services4.torpedoIconContainer,uiState=_this$services4.uiState;var gameData=gameDatas[0];var attackDuration=3000;var start=this.replayContext.getNextTorpedoAttackStart();var cameraDuration=2000;var fireStart=start+cameraDuration;var longestDuration=attackDuration;var target=gameData.ships.getShipById(combatLogEntry.targetId);var targetIcon=shipIconContainer.getByShip(target);var position=getStartMoveForShip(gameDatas,targetIcon.ship).getPosition();this.animations.push(new animation_CameraPositionAnimation(position,start,fireStart,gameCamera));combatLogEntry.entries.forEach(function(torpedoEntry){var flight=gameData.torpedos.getTorpedoFlightById(torpedoEntry.torpedoFlightId);uiState.addToCombatLog(torpedoEntry);var intercepts=gameData.combatLog.getInterceptsFor(torpedoEntry);var intercepted=intercepts.some(function(intercept){return intercept.isSucessfull();});var interceptTime=intercepted?fireStart+(attackDuration-1000)+_this5.getRandom()*1000:null;var targetPosition=new utils_Vector(position).setZ(targetIcon.shipZ).add(new utils_Vector(_this5.getRandom()*30-15,_this5.getRandom()*30-15,0));var attackDistance=1000;var launchPosition=flight.launchPosition;var torpedoPosition=launchPosition.sub(targetPosition).normalize().multiplyScalar(attackDistance).add(targetPosition).setZ(TORPEDO_Z);var msvDistance=_this5.getRandom()*200+300;var msvPosition=flight.torpedo.damageStrategy.msv&&!intercepted?launchPosition.sub(targetPosition).normalize().multiplyScalar(msvDistance).add(targetPosition).setZ(TORPEDO_Z):null;var flightDuration=msvPosition?attackDuration*((attackDistance-msvDistance)/attackDistance):attackDuration;var randomFlightDuration=_this5.getRandom()*500;var endTime=fireStart+attackDuration+randomFlightDuration;var flightEndTime=fireStart+flightDuration+randomFlightDuration;var speed=attackDistance/attackDuration;var animation=new animation_TorpedoMovementAnimation(torpedoIconContainer.getIconByTorpedoFlight(flight),torpedoPosition,msvPosition?msvPosition:targetPosition,fireStart,flightEndTime,flight.turnsActive===1,interceptTime,true);var systemsDestroyed=torpedoEntry.getDestroyedSystems(target);if(systemsDestroyed.length>0){_this5.systemDestroyedTextAnimation.add(new utils_Vector(targetPosition.x,targetPosition.y,targetPosition.z),systemsDestroyed.map(function(system){return system.getDisplayName();}),endTime);}var velocity=targetPosition.sub(launchPosition).normalize().multiplyScalar(attackDistance/attackDuration).multiplyScalar(0.5);var interceptPosition=animation.getInterceptPosition();_this5.animations.push(animation);_this5.buildInterceptAnimation(gameData,targetIcon,intercepts,interceptTime,interceptPosition,gameDatas);if(intercepted){_this5.animations.push(new effect_ExplosionEffect(particleEmitterContainer,_this5.getRandom,{position:interceptPosition,time:interceptTime,duration:250+_this5.getRandom()*250,type:"glow",size:_this5.getRandom()*5+5,color:new three_module["Color"](1.0,0.9,0.8),velocity:velocity},_this5));}else{switch(flight.torpedo.visuals.explosionType){case"MSV":_this5.animations.push(new TorpedoExplosion_TorpedoExplosionMSV(targetPosition,flightEndTime,endTime,particleEmitterContainer,_this5.getRandom,flight.torpedo,torpedoEntry.damages,targetIcon,function(ship){return getShipStartPositionAndFacingForShip(gameDatas,ship);},msvPosition,speed));break;case"HE":default:_this5.animations.push(new TorpedoExplosion_TorpedoExplosionHE(function(ship){return getShipStartPositionAndFacingForShip(gameDatas,ship);},endTime,particleEmitterContainer,_this5.getRandom,flight.torpedo,targetIcon));break;}}});this.replayContext.addTorpedoAttackAnimationDuration(cameraDuration+longestDuration+1000);}},{key:"buildTorpedoMoveAnimation",value:function buildTorpedoMoveAnimation(combatLogEntry,gameDatas){var torpedoIconContainer=this.services.torpedoIconContainer;var duration=5000;var start=this.replayContext.getMovementStart();this.replayContext.setMovementDuration(duration);var flight=gameDatas[0].torpedos.getTorpedoFlightById(combatLogEntry.torpedoFlightId);var startTime=start+this.getRandom()*2000;var endTime=start+duration+this.getRandom()*1000;var animation=new animation_TorpedoMovementAnimation(torpedoIconContainer.getIconByTorpedoFlight(flight),flight.launchPosition.setZ(TORPEDO_Z),flight.strikePosition.setZ(TORPEDO_Z),startTime,endTime,true);this.animations.push(animation);}},{key:"buildWeaponFireAnimation",value:function buildWeaponFireAnimation(combatLogEntry,gameDatas){var _this6=this;var _this$services5=this.services,shipIconContainer=_this$services5.shipIconContainer,gameCamera=_this$services5.gameCamera,particleEmitterContainer=_this$services5.particleEmitterContainer,uiState=_this$services5.uiState;var gameData=gameDatas[0];var weaponFireService=new weapon_WeaponFireService().update(gameData);var weaponAnimationService=new replay_ShipWeaponAnimationService(this.getRandom,particleEmitterContainer);var start=this.replayContext.getNextFireStart();var cameraDuration=2000;var fireStart=start+cameraDuration;var longestDuration=0;var target=gameData.ships.getShipById(combatLogEntry.targetId);var targetIcon=shipIconContainer.getByShip(target);var position=getStartMoveForShip(gameDatas,targetIcon.ship).getPosition();this.animations.push(new animation_CameraPositionAnimation(position,start,fireStart,gameCamera));combatLogEntry.entries.forEach(function(fireEntry){var fireOrder=weaponFireService.getFireOrderById(fireEntry.fireOrderId);uiState.addToCombatLog(fireEntry);var shooter=gameData.ships.getShipById(fireOrder.shooterId);var weapon=shooter.systems.getSystemById(fireOrder.weaponId);var animationName=weapon.callHandler("getWeaponFireAnimationName");if(!animationName){return;}var animation=new animation_ShipWeaponAnimation["ShipWeapon".concat(animationName.charAt(0).toUpperCase()+animationName.slice(1),"Animation")]({getRandom:_this6.getRandom,particleEmitterContainer:particleEmitterContainer,weapon:weapon,getPosition:function getPosition(ship){return getShipStartPositionAndFacingForShip(gameDatas,ship);},args:weapon.callHandler("getWeaponFireAnimationArguments"),weaponAnimationService:weaponAnimationService,targetIcon:targetIcon,shooterIcon:shipIconContainer.getByShip(shooter),animationStartTime:fireStart,totalShots:fireEntry.totalShots,shotsHit:fireEntry.shotsHit,fireEntry:fireEntry});_this6.animations.push(animation);var duration=animation.getDuration();if(duration>longestDuration){longestDuration=duration;}var systemsDestroyed=fireEntry.getDestroyedSystems(target);if(systemsDestroyed.length>0){var systemDestroyedTime=fireStart+duration-1000;_this6.replayContext.noteDestroyedSystem(target,systemDestroyedTime,systemsDestroyed);_this6.systemDestroyedTextAnimation.add(new utils_Vector(position.x,position.y,position.z+targetIcon.shipZ),systemsDestroyed.map(function(system){return system.getDisplayName();}),systemDestroyedTime);}});this.replayContext.addFireAnimationDuration(cameraDuration+longestDuration);}},{key:"buildMovementAnimation",value:function buildMovementAnimation(combatLogEntry,gameDatas){var shipIconContainer=this.services.shipIconContainer;var duration=5000;var start=this.replayContext.getMovementStart();var icon=shipIconContainer.getById(combatLogEntry.shipId);var ship=icon.ship;icon.show();var animation=new animation_ShipMovementAnimation(icon,ReplayTurnActions_getMovesForShip(gameDatas,ship),start,start+duration);if(animation.doesMove()){this.replayContext.setMovementDuration(duration);}this.animations.push(animation);this.animations.push(new animation_ShipSystemAnimation(icon,gameDatas[0].ships.getShipById(icon.ship.id)));}},{key:"deactivate",value:function deactivate(){var _this$services6=this.services,shipIconContainer=_this$services6.shipIconContainer,uiState=_this$services6.uiState,particleEmitterContainer=_this$services6.particleEmitterContainer;shipIconContainer.getArray().forEach(function(icon){icon.hide();},this);uiState.hideCombatLog();particleEmitterContainer.release(this);this.animations.forEach(function(animation){return animation.deactivate();});return Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(ReplayTurnActions.prototype),"deactivate",this).call(this);}}]);return ReplayTurnActions;}(uiStrategy_AnimationUiStrategy);/* harmony default export */ var replay_ReplayTurnActions = (ReplayTurnActions_ReplayTurnActions);
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/AutomaticReplayPhaseStrategy/AutomaticReplayPhaseStrategy.js
var AutomaticReplayPhaseStrategy_AutomaticReplayPhaseStrategy=/*#__PURE__*/function(_PhaseStrategy){Object(inherits["a" /* default */])(AutomaticReplayPhaseStrategy,_PhaseStrategy);function AutomaticReplayPhaseStrategy(services){var _this;Object(classCallCheck["a" /* default */])(this,AutomaticReplayPhaseStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AutomaticReplayPhaseStrategy).call(this,services));_this.emitterContainer=services.particleEmitterContainer;_this.replayContext=new AutomaticReplayPhaseStrategy_ReplayContext(Object(assertThisInitialized["a" /* default */])(_this));_this.replayTurnActions=new replay_ReplayTurnActions(_this.replayContext);_this.strategies=[_this.replayTurnActions,new replay_AutomaticReplay(Object(assertThisInitialized["a" /* default */])(_this),_this.replayContext),new replay_ShowReplayUi(_this.replayContext),new uiStrategy_MouseOverShowsShipTooltip(),new uiStrategy_UnderHexForShips(),new uiStrategy_ShowMapIcons()];return _this;}Object(createClass["a" /* default */])(AutomaticReplayPhaseStrategy,[{key:"render",value:function render(coordinateConverter,scene,zoom){var payload=Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(AutomaticReplayPhaseStrategy.prototype),"render",this).call(this,coordinateConverter,scene,zoom);this.emitterContainer.render(payload);}},{key:"canDisturb",value:function canDisturb(){return false;}},{key:"update",value:function update(gamedata){this.updateStrategies(gamedata);return this;}},{key:"deactivate",value:function deactivate(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(AutomaticReplayPhaseStrategy.prototype),"deactivate",this).call(this);}}]);return AutomaticReplayPhaseStrategy;}(phaseStrategy_PhaseStrategy);/* harmony default export */ var phaseStrategy_AutomaticReplayPhaseStrategy_AutomaticReplayPhaseStrategy = (AutomaticReplayPhaseStrategy_AutomaticReplayPhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/phase/phaseStrategy/AutomaticReplayPhaseStrategy/index.js
/* harmony default export */ var phaseStrategy_AutomaticReplayPhaseStrategy = (phaseStrategy_AutomaticReplayPhaseStrategy_AutomaticReplayPhaseStrategy);
// CONCATENATED MODULE: ./src/client/view/game/phase/GameDataCache.js
var GameDataCache_GameDataCache=/*#__PURE__*/function(){function GameDataCache(){Object(classCallCheck["a" /* default */])(this,GameDataCache);this.replays=[];this.currentGameData=null;}Object(createClass["a" /* default */])(GameDataCache,[{key:"getGameDatasForAutomaticReplay",value:function getGameDatasForAutomaticReplay(){var _this=this;if(!this.currentGameData){return null;}var lastGameData=this.replays.find(function(replay){return replay.turn===_this.currentGameData.turn-1;});if(!lastGameData){return null;}return[lastGameData,this.currentGameData];}},{key:"setCurrent",value:function setCurrent(gameData){this.currentGameData=gameData;}},{key:"getCurrent",value:function getCurrent(){return this.currentGameData;}},{key:"setReplays",value:function setReplays(replays){this.replays=this.replays.filter(function(replay){return!replays.find(function(newReplay){return newReplay.turn===replay.turn;});});this.replays=[].concat(Object(toConsumableArray["a" /* default */])(this.replays),Object(toConsumableArray["a" /* default */])(replays));}}]);return GameDataCache;}();/* harmony default export */ var phase_GameDataCache = (GameDataCache_GameDataCache);
// CONCATENATED MODULE: ./src/model/game/GameSlot.mjs
var GameSlot_GameSlot=/*#__PURE__*/function(){function GameSlot(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var gameData=arguments.length>1?arguments[1]:undefined;Object(classCallCheck["a" /* default */])(this,GameSlot);this.id=v4();this.gameData=gameData;this.deserialize(data);}Object(createClass["a" /* default */])(GameSlot,[{key:"getShips",value:function getShips(){var _this=this;if(!this.gameData){return[];}return this.gameData.ships.getShips().filter(function(ship){return _this.shipIds.includes(ship.id);});}},{key:"includesShip",value:function includesShip(ship){return this.shipIds.includes(ship.id);}},{key:"isUsers",value:function isUsers(user){return this.userId===user.id;}},{key:"addShip",value:function addShip(ship){this.shipIds.push(ship.id);}},{key:"isTaken",value:function isTaken(){return Boolean(this.userId);}},{key:"takeSlot",value:function takeSlot(user){this.userId=user.id;}},{key:"leaveSlot",value:function leaveSlot(user){if(this.userId!==user.id){throw Error("Trying to leave slot that is not occupied by player");}this.userId=null;}},{key:"isOccupiedBy",value:function isOccupiedBy(user){return user&&this.userId===user.id;}},{key:"setBought",value:function setBought(){this.bought=true;}},{key:"isBought",value:function isBought(){return this.bought;}},{key:"validate",value:function validate(){if(!this.name){return"Slot needs to have a name";}if(!(this.deploymentLocation instanceof hexagon.Offset)){return"Slot needs to have deploymentlocation of type hexagon.Offset";}if(this.deploymentRadius!==parseInt(this.deploymentRadius,10)||this.deploymentRadius<0){return"Slot needs to have greater than zero deploymentRadius";}if(this.team!==parseInt(this.team,10)||this.team<0){return"Slot needs to have greater than zero numeric team";}if(!(this.deploymentVector instanceof hexagon.Offset)){return"Slot needs to have deploymentVector of type hexagon.Offset";}if(this.points!==parseInt(this.points,10)||this.points<=0){return"Slot needs to have points more than 0";}}},{key:"isValidShipDeployment",value:function isValidShipDeployment(ship,hex){return this.includesShip(ship)&&hex.distanceTo(this.deploymentLocation)<=this.deploymentRadius;}},{key:"serialize",value:function serialize(){return{id:this.id,name:this.name,userId:this.userId,deploymentLocation:this.deploymentLocation,deploymentRadius:this.deploymentRadius,deploymentVector:this.deploymentVector,points:this.points,shipIds:this.shipIds,team:this.team,bought:this.bought,facing:this.facing};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.id=data.id||this.id;this.name=data.name;this.userId=data.userId||null;this.deploymentLocation=data.deploymentLocation?new hexagon.Offset(data.deploymentLocation):new hexagon.Offset(0,0);this.deploymentVector=data.deploymentVector?new hexagon.Offset(data.deploymentVector):new hexagon.Offset(0,0);this.deploymentRadius=data.deploymentRadius||10;//this.deploymentRadius = 10000;
this.shipIds=data.shipIds||[];this.points=data.points||0;this.bought=data.bought||false;this.team=data.team||1;this.facing=data.facing||0;return this;}}]);return GameSlot;}();/* harmony default export */ var game_GameSlot = (GameSlot_GameSlot);
// CONCATENATED MODULE: ./src/model/game/GameSlots.mjs
var GameSlots_GameSlots=/*#__PURE__*/function(){function GameSlots(gameData){Object(classCallCheck["a" /* default */])(this,GameSlots);this.gameData=gameData;this.slots=[];}Object(createClass["a" /* default */])(GameSlots,[{key:"getTeamForShip",value:function getTeamForShip(ship){var slot=this.slots.find(function(slot){return slot.includesShip(ship);});return slot.team;}},{key:"getSlotsByTeams",value:function getSlotsByTeams(){var teams=[];this.slots.forEach(function(slot){var team=teams.find(function(t){return t.team===slot.team;});if(!team){team={team:slot.team,slots:[slot]};teams.push(team);}else{team.slots.push(slot);}});return teams;}},{key:"isShipInUsersTeam",value:function isShipInUsersTeam(user,ship){var userSlot=this.slots.find(function(s){return s.userId===user.id;});if(!userSlot){return false;}return this.getSlotByShip(ship).team===userSlot.team;}},{key:"isUsersTeam",value:function isUsersTeam(user,team){var userSlot=this.slots.find(function(s){return s.userId===user.id;});if(!userSlot){return false;}return team===userSlot.team;}},{key:"isUsersTeamSlot",value:function isUsersTeamSlot(slot,user){var userSlot=this.slots.find(function(s){return s.userId===user;});if(!userSlot){return false;}return slot.team===userSlot.team;}},{key:"getUsersSlots",value:function getUsersSlots(user){return this.slots.filter(function(slot){return slot.isUsers(user);});}},{key:"getSlotByShip",value:function getSlotByShip(ship){return this.slots.find(function(slot){return slot.includesShip(ship);});}},{key:"getSlotById",value:function getSlotById(id){return this.slots.find(function(slot){return slot.id===id;});}},{key:"setSlots",value:function setSlots(slots){slots.forEach(this.addSlot.bind(this));}},{key:"getSlots",value:function getSlots(){return this.slots;}},{key:"addSlot",value:function addSlot(slot){this.slots.push(slot);return slot;}},{key:"serialize",value:function serialize(){return{slots:this.slots.map(function(slot){return slot.serialize();})};}},{key:"deserialize",value:function deserialize(){var _this=this;var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.slots=data.slots?data.slots.map(function(slotData){return new game_GameSlot(slotData,_this.gameData);}):[];return this;}}]);return GameSlots;}();/* harmony default export */ var game_GameSlots = (GameSlots_GameSlots);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/BoostableSystemStrategy.mjs
var BoostableSystemStrategy_BoostableSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(BoostableSystemStrategy,_ShipSystemStrategy);function BoostableSystemStrategy(){var _this;var power=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var maxLevel=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;Object(classCallCheck["a" /* default */])(this,BoostableSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(BoostableSystemStrategy).call(this));_this.power=power;_this.maxLevel=maxLevel;_this.boostLevel=0;return _this;}Object(createClass["a" /* default */])(BoostableSystemStrategy,[{key:"isBoostable",value:function isBoostable(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(previousResponse===false){return false;}return this.maxLevel!==0;}},{key:"canBoost",value:function canBoost(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(previousResponse===false){return false;}var remainginPower=this.system.shipSystems.power.getRemainingPowerOutput();if(this.system.isDisabled()){return false;}if(this.maxLevel!==null&&this.boostLevel>=this.maxLevel){return false;}return remainginPower>=this.getPowerRequiredForBoost();}},{key:"canDeBoost",value:function canDeBoost(payload,previousResponse){return this.boostLevel>0;}},{key:"getPowerRequiredForBoost",value:function getPowerRequiredForBoost(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return this.power+previousResponse;}},{key:"getBoost",value:function getBoost(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}return previousResponse+this.boostLevel;}},{key:"getPowerRequirement",value:function getPowerRequirement(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var power=this.boostLevel*this.power;return power+previousResponse;}},{key:"boost",value:function boost(payload,previousResponse){if(!this.canBoost(payload)){return false;}this.boostLevel++;this.system.callHandler("onSystemPowerLevelIncrease");}},{key:"deBoost",value:function deBoost(payload,previousResponse){if(this.boostLevel===0){return false;}this.boostLevel--;this.system.callHandler("onSystemPowerLevelDecrease");}},{key:"resetBoost",value:function resetBoost(){this.boostLevel=0;this.system.callHandler("onSystemPowerLevelDecrease");}},{key:"getRequiredPhasesForReceivingPlayerData",value:function getRequiredPhasesForReceivingPlayerData(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(previousResponse>2){return previousResponse;}return 2;}},{key:"receivePlayerData",value:function receivePlayerData(_ref){var clientSystem=_ref.clientSystem,phase=_ref.phase;if(!clientSystem){return;}if(this.system.isDisabled()){return;}var clientStrategy=clientSystem.getStrategiesByInstance(BoostableSystemStrategy)[0];var targetBoostlevel=clientStrategy.boostLevel;if(this.boostLevel>targetBoostlevel&&phase===2){while(true){if(this.boostLevel===targetBoostlevel){return;}if(!this.canDeBoost()){return;}this.deBoost();}}else if(this.boostLevel<targetBoostlevel&&phase===1){while(true){if(this.boostLevel===targetBoostlevel){return;}if(!this.canBoost()){return;}this.boost();}}}},{key:"getTooltipMenuButton",value:function getTooltipMenuButton(_ref2){var _this2=this;var myShip=_ref2.myShip;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!myShip){return previousResponse;}if(this.system.isDisabled()||!this.system.callHandler("isBoostable")){return previousResponse;}return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{sort:100,img:"/img/plus.png",onClickHandler:function onClickHandler(){return _this2.system.callHandler("boost");},disabledHandler:function disabledHandler(){return!_this2.system.callHandler("canBoost",null,null);}},{sort:100,img:"/img/minus.png",onClickHandler:function onClickHandler(){return _this2.system.callHandler("deBoost");},disabledHandler:function disabledHandler(){return!_this2.system.callHandler("canDeBoost",null,null);}}]);}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{boostableSystemStrategy:{boostLevel:this.boostLevel}});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.boostLevel=data.boostableSystemStrategy?data.boostableSystemStrategy.boostLevel:0;return this;}}]);return BoostableSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_BoostableSystemStrategy = (BoostableSystemStrategy_BoostableSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/ThrustOutputSystemStrategy.mjs
var ThrustOutputSystemStrategy_ThrustOutputSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(ThrustOutputSystemStrategy,_ShipSystemStrategy);function ThrustOutputSystemStrategy(output){var _this;Object(classCallCheck["a" /* default */])(this,ThrustOutputSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ThrustOutputSystemStrategy).call(this));_this.output=output||0;return _this;}Object(createClass["a" /* default */])(ThrustOutputSystemStrategy,[{key:"getOutputForBoost",value:function getOutputForBoost(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(previousResponse>this.output){return previousResponse;}return this.output;}},{key:"getThrustOutput",value:function getThrustOutput(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var output=this.output;output-=this.system.damage.getCriticals().filter(function(critical){return critical instanceof criticals_OutputReduced;}).reduce(function(total,current){return total+current.getOutputReduction();},0);if(output<0){output=0;}return previousResponse+this.system.callHandler("getBoost")+output;}},{key:"getPossibleCriticals",value:function getPossibleCriticals(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{severity:20,critical:new criticals_OutputReduced(2,2)},{severity:30,critical:new criticals_OutputReduced(Math.ceil(this.output/4),2)},{severity:60,critical:new criticals_OutputReduced(Math.ceil(this.output/3),2)},{severity:70,critical:new criticals_OutputReduced(Math.ceil(this.output/2),2)},{severity:30,critical:new criticals_OutputReduced(2)},{severity:70,critical:new criticals_OutputReduced(Math.ceil(this.output/4))},{severity:80,critical:new criticals_OutputReduced(Math.ceil(this.output/3))},{severity:90,critical:new criticals_OutputReduced(Math.ceil(this.output/2))}]);}},{key:"onSystemOffline",value:function onSystemOffline(){this.onSystemPowerLevelDecrease();}},{key:"onSystemPowerLevelDecrease",value:function onSystemPowerLevelDecrease(){if(!this.system||!this.system.shipSystems||!this.system.shipSystems.ship){return;}this.system.shipSystems.ship.movement.revertMovementsUntilValidMovement();}}]);return ThrustOutputSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_ThrustOutputSystemStrategy = (ThrustOutputSystemStrategy_ThrustOutputSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/RequiresPowerSystemStrategy.mjs
var RequiresPowerSystemStrategy_RequiresPowerSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(RequiresPowerSystemStrategy,_ShipSystemStrategy);function RequiresPowerSystemStrategy(power){var _this;var getsCriticals=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;Object(classCallCheck["a" /* default */])(this,RequiresPowerSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RequiresPowerSystemStrategy).call(this));_this.power=power||0;if(_this.power<=0){throw new Error("Power must be more than zero");}_this.getsCriticals=getsCriticals;return _this;}Object(createClass["a" /* default */])(RequiresPowerSystemStrategy,[{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({sort:"AAAA",header:"Power requirement",value:this.system.callHandler("getPowerRequirement",null,0)});return previousResponse;}},{key:"getPowerRequirement",value:function getPowerRequirement(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return this.power+previousResponse;}},{key:"canSetOffline",value:function canSetOffline(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return true;}},{key:"canSetOnline",value:function canSetOnline(){return true;}},{key:"shouldBeOffline",value:function shouldBeOffline(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(previousResponse===true){return true;}return this.system.hasCritical(criticals_ForcedOffline);}},{key:"getTooltipMenuButton",value:function getTooltipMenuButton(_ref){var _this2=this;var myShip=_ref.myShip;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!myShip){return previousResponse;}if(this.system.shipSystems.power.canSetOnline(this.system)){return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{sort:0,img:"/img/goOnline.png",onClickHandler:function onClickHandler(){return _this2.system.power.setOnline();}}]);}else if(this.system.shipSystems.power.canSetOffline(this.system)){return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{sort:0,img:"/img/goOffline.png",onClickHandler:function onClickHandler(){return _this2.system.power.setOffline();}}]);}return previousResponse;}},{key:"getPossibleCriticals",value:function getPossibleCriticals(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!this.getsCriticals){return previousResponse;}return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{severity:20,critical:new criticals_ForcedOffline(1)},{severity:40,critical:new criticals_ForcedOffline(2)},{severity:60,critical:new criticals_ForcedOffline(3)},{severity:80,critical:new criticals_ForcedOffline(4)}]);}}]);return RequiresPowerSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_RequiresPowerSystemStrategy = (RequiresPowerSystemStrategy_RequiresPowerSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/PowerOutputSystemStrategy.mjs
var PowerOutputSystemStrategy_PowerOutputSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(PowerOutputSystemStrategy,_ShipSystemStrategy);function PowerOutputSystemStrategy(output){var _this;Object(classCallCheck["a" /* default */])(this,PowerOutputSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(PowerOutputSystemStrategy).call(this));_this.output=output||0;return _this;}Object(createClass["a" /* default */])(PowerOutputSystemStrategy,[{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Power output",value:this.getPowerOutput()});return previousResponse;}},{key:"getPowerOutput",value:function getPowerOutput(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var output=this.output;if(this.system.hasCritical(criticals_OutputReduced2)){output-=2;}if(this.system.hasCritical(criticals_OutputReduced4)){output-=4;}if(this.system.hasCritical(criticals_OutputReduced6)){output-=6;}if(this.system.hasCritical(criticals_OutputReduced8)){output-=8;}if(output<0){output=0;}return previousResponse+output;}},{key:"getPossibleCriticals",value:function getPossibleCriticals(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{weight:10,className:criticals_OutputReduced2},{weight:7,className:criticals_OutputReduced4},{weight:3,className:criticals_OutputReduced6},{weight:1,className:criticals_OutputReduced8}]);}}]);return PowerOutputSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_PowerOutputSystemStrategy = (PowerOutputSystemStrategy_PowerOutputSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/ThrustChannelSystemStrategy.mjs
var directionsToString={0:"Thrust forward",3:"Thrust aft",1:"Thrust starboard",2:"Thrust starboard",4:"Thrust port",5:"Thrust port",6:"Pivot right",7:"Pivot left",8:"Roll, Evade"};var THRUSTER_MODE_FUSION="fusion";var THRUSTER_MODE_MANEUVER="maneuver";var THRUSTER_MODE_CHEMICAL="chemical";var ThrustChannelSystemStrategy_ThrustChannelSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(ThrustChannelSystemStrategy,_ShipSystemStrategy);function ThrustChannelSystemStrategy(output,direction){var _this;var _ref=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref$thrustHeatExtra=_ref.thrustHeatExtra,thrustHeatExtra=_ref$thrustHeatExtra===void 0?0.3:_ref$thrustHeatExtra,_ref$fuelExtra=_ref.fuelExtra,fuelExtra=_ref$fuelExtra===void 0?0.1:_ref$fuelExtra;var mode=arguments.length>3&&arguments[3]!==undefined?arguments[3]:THRUSTER_MODE_FUSION;var alternateModes=arguments.length>4&&arguments[4]!==undefined?arguments[4]:[];Object(classCallCheck["a" /* default */])(this,ThrustChannelSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ThrustChannelSystemStrategy).call(this));_this.output=output||0;_this.direction=direction||0;// 0, 3, [4,5], [1,2], 6
_this.channeled=0;_this.thrustHeatExtra=thrustHeatExtra;_this.fuelExtra=fuelExtra;_this.mode=mode;_this.newMode=null;_this.alternateModes=alternateModes;if(alternateModes.length>0&&!alternateModes.includes(mode)){alternateModes.push(mode);}return _this;}Object(createClass["a" /* default */])(ThrustChannelSystemStrategy,[{key:"getBaseHeatPerThrustChanneled",value:function getBaseHeatPerThrustChanneled(){switch(this.mode){case THRUSTER_MODE_FUSION:return 0.5;case THRUSTER_MODE_MANEUVER:return 0.75;case THRUSTER_MODE_CHEMICAL:return 0.1;}}},{key:"getFuelPerThrustChanneled",value:function getFuelPerThrustChanneled(){switch(this.mode){case THRUSTER_MODE_FUSION:return 1;case THRUSTER_MODE_MANEUVER:return 10;case THRUSTER_MODE_CHEMICAL:return 15;}}},{key:"isBoostable",value:function isBoostable(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(previousResponse===false){return false;}return this.mode===THRUSTER_MODE_FUSION;}},{key:"canBoost",value:function canBoost(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(previousResponse===false){return false;}return this.mode===THRUSTER_MODE_FUSION;}},{key:"canChangeMode",value:function canChangeMode(){return this.alternateModes.length>1;}},{key:"changeMode",value:function changeMode(){if(!this.canChangeMode()){throw new Error("Check validity first");}var index=this.alternateModes.indexOf(this.mode);if(index===this.alternateModes.length-1){index=0;}else{index++;}this.mode=this.alternateModes[index];this.newMode=this.mode;this.system.callHandler("resetBoost");}},{key:"getHeatTransferPerStructure",value:function getHeatTransferPerStructure(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.mode===THRUSTER_MODE_FUSION){var boost=this.system.callHandler("getBoost",null,0);return previousResponse+boost*0.12;}return previousResponse;}},{key:"getFuelRequirement",value:function getFuelRequirement(){var amount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var fuel=0;var extra=1;if(amount===null){amount=this.channeled;}while(amount--){var increase=this.getFuelPerThrustChanneled()*extra;fuel+=increase;extra+=this.fuelExtra;}return Math.round(fuel);}},{key:"resetChanneledThrust",value:function resetChanneledThrust(){this.channeled=0;}},{key:"addChanneledThrust",value:function addChanneledThrust(channel){this.channeled+=channel;}},{key:"setChanneledThrust",value:function setChanneledThrust(channel){this.channeled=channel;}},{key:"getChanneledThrust",value:function getChanneledThrust(){return this.channeled;}},{key:"getIconText",value:function getIconText(){return this.channeled+"/"+this.getThrustOutput();}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{thrustChannelSystemStrategy:{channeled:this.channeled,newMode:this.newMode,mode:this.mode}});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var thisData=data.thrustChannelSystemStrategy||{};this.channeled=thisData.channeled||0;this.newMode=thisData.newMode||null;this.mode=thisData.mode||this.mode;return this;}},{key:"getDirectionString",value:function getDirectionString(){if(Array.isArray(this.direction)){return this.direction.map(function(direction){return directionsToString[direction];}).join(", ");}return directionsToString[this.direction];}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Mode",value:this.mode.charAt(0).toUpperCase()+this.mode.substring(1)});previousResponse.push({header:"Output",value:this.getThrustOutput()});previousResponse.push({header:"Manouver(s)",value:this.getDirectionString()});previousResponse.push({header:"Channeled",value:this.channeled});previousResponse.push({header:"Fuel expended",value:this.getFuelRequirement()});return previousResponse;}},{key:"getBackgroundImage",value:function getBackgroundImage(){if(this.mode===THRUSTER_MODE_FUSION){if(this.callHandler("isDirection",3,false)){return"/img/system/thruster2.png";}else if(this.callHandler("isDirection",2,false)){return"/img/system/thruster4.png";}else if(this.callHandler("isDirection",5,false)){return"/img/system/thruster3.png";}return"/img/system/thruster1.png";}else{if(this.callHandler("isDirection",3,false)){return"/img/system/thrusterC2.png";}else if(this.callHandler("isDirection",2,false)){return"/img/system/thrusterC4.png";}else if(this.callHandler("isDirection",5,false)){return"/img/system/thrusterC3.png";}return"/img/system/thrusterC1.png";}}},{key:"getTooltipMenuButton",value:function getTooltipMenuButton(_ref2){var myShip=_ref2.myShip;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!myShip){return previousResponse;}if(this.system.isDisabled()){return previousResponse;}if(!this.canChangeMode()){return previousResponse;}return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{sort:50,img:this.mode===THRUSTER_MODE_FUSION?"/img/system/thrusterC1.png":"/img/system/thruster1.png",onClickHandler:this.changeMode.bind(this),onDisabledHandler:function onDisabledHandler(){return false;}}]);}},{key:"generatesHeat",value:function generatesHeat(){return true;}},{key:"getHeatPerThrustChanneled",value:function getHeatPerThrustChanneled(){var heat=this.getBaseHeatPerThrustChanneled();heat*=1+this.system.damage.getCriticals().filter(function(critical){return critical instanceof criticals_ThrustChannelHeatIncreased;}).reduce(function(total,current){return total+current.getHeatIncrease();},0);return heat;}},{key:"getHeatGenerated",value:function getHeatGenerated(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var count=this.channeled;var extra=1;var heat=0;var boost=this.system.callHandler("getBoost",null,0)*0.05;var extraIncrement=this.thrustHeatExtra-boost*0.01;if(extraIncrement<0.01){extraIncrement=0.01;}while(count--){var increase=this.getHeatPerThrustChanneled()*extra;heat+=increase;extra+=extraIncrement;}return previousResponse+heat;}},{key:"getThrustDirection",value:function getThrustDirection(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return this.direction;}},{key:"getThrustOutput",value:function getThrustOutput(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var output=this.output;output-=this.system.damage.getCriticals().filter(function(critical){return critical instanceof criticals_OutputReduced;}).reduce(function(total,current){return total+current.getOutputReduction();},0);output+=this.system.callHandler("getBoost",null,0);if(output<0){output=0;}return previousResponse+output;}},{key:"getMaxChannelAmount",value:function getMaxChannelAmount(){return this.getThrustOutput();}},{key:"canChannelAmount",value:function canChannelAmount(amount){return amount<=this.getMaxChannelAmount();}},{key:"getChannelCost",value:function getChannelCost(amount){return amount;}},{key:"isThruster",value:function isThruster(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return true;}},{key:"isDirection",value:function isDirection(direction){return this.direction===direction||Array.isArray(this.direction)&&this.direction.includes(direction);}},{key:"getRequiredPhasesForReceivingPlayerData",value:function getRequiredPhasesForReceivingPlayerData(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(previousResponse>3){return previousResponse;}return 3;}},{key:"receivePlayerData",value:function receivePlayerData(_ref3){var clientSystem=_ref3.clientSystem,phase=_ref3.phase;if(phase!==3){return;}if(!clientSystem){return;}if(this.system.isDisabled()){return;}var clientStrategy=clientSystem.getStrategiesByInstance(ThrustChannelSystemStrategy)[0];var targetMode=clientStrategy.newMode;if(targetMode===null){return;}if(!this.canChangeMode()||!this.alternateModes.includes(targetMode)){throw new Error("This system can not change mode to ".concat(targetMode));}this.mode=targetMode;this.targetMode=null;this.system.callHandler("resetBoost");}},{key:"advanceTurn",value:function advanceTurn(){this.channeled=0;this.targetMode=null;}},{key:"getPossibleCriticals",value:function getPossibleCriticals(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{severity:20,critical:new criticals_ThrustChannelHeatIncreased(0.5,1)},{severity:30,critical:new criticals_OutputReduced(Math.ceil(this.output/4),2)},{severity:40,critical:new criticals_ThrustChannelHeatIncreased(0.5,3)},{severity:60,critical:new criticals_ThrustChannelHeatIncreased(0.5)},{severity:70,critical:new criticals_OutputReduced(Math.ceil(this.output/4))},{severity:80,critical:new criticals_OutputReduced(Math.ceil(this.output/3))},{severity:90,critical:new criticals_OutputReduced(Math.ceil(this.output/2))}]);}},{key:"onSystemOffline",value:function onSystemOffline(){this.onSystemPowerLevelDecrease();}},{key:"onSystemPowerLevelIncrease",value:function onSystemPowerLevelIncrease(){this.onSystemPowerLevelDecrease();}},{key:"onSystemPowerLevelDecrease",value:function onSystemPowerLevelDecrease(){if(!this.system||!this.system.shipSystems||!this.system.shipSystems.ship){return;}this.system.shipSystems.ship.movement.revertMovementsUntilValidMovement();}}]);return ThrustChannelSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_ThrustChannelSystemStrategy = (ThrustChannelSystemStrategy_ThrustChannelSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/AllowsEvasionSystemStrategy.mjs
var AllowsEvasionSystemStrategy_AllowsEvasionSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(AllowsEvasionSystemStrategy,_ShipSystemStrategy);function AllowsEvasionSystemStrategy(evasion){var _this;Object(classCallCheck["a" /* default */])(this,AllowsEvasionSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AllowsEvasionSystemStrategy).call(this));_this.evasion=evasion||0;return _this;}Object(createClass["a" /* default */])(AllowsEvasionSystemStrategy,[{key:"getMaxEvasion",value:function getMaxEvasion(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}return previousResponse+this.evasion;}}]);return AllowsEvasionSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_AllowsEvasionSystemStrategy = (AllowsEvasionSystemStrategy_AllowsEvasionSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/ElectronicWarfareProvider.mjs
var ElectronicWarfareProvider_typeAsString=function typeAsString(type){switch(type){case EW_OFFENSIVE:return"Offensive EW";case EW_DEFENSIVE:return"Defensive EW";case EW_CC:return"Close combat EW";case EW_OFFENSIVE_SUPPORT:return"Offensive support EW";case EW_DEFENSIVE_SUPPORT:return"Defensive EW";case EW_DISRUPTION:return"Disruption EW";case EW_AREA_DEFENSIVE_SUPPORT:return"Area defensive EW";}};var ElectronicWarfareProvider_ElectronicWarfareProvider=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(ElectronicWarfareProvider,_ShipSystemStrategy);function ElectronicWarfareProvider(output,allowedEwTypes){var _this;Object(classCallCheck["a" /* default */])(this,ElectronicWarfareProvider);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ElectronicWarfareProvider).call(this));_this.output=output||0;_this.allowedEwTypes=allowedEwTypes||[EW_OFFENSIVE,EW_DEFENSIVE,EW_CC];_this.entries=[];return _this;}Object(createClass["a" /* default */])(ElectronicWarfareProvider,[{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{electronicWarfareProvider:Object(toConsumableArray["a" /* default */])(this.entries.map(function(entry){return entry.serialize();}))});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.entries=data.electronicWarfareProvider?data.electronicWarfareProvider.map(function(entry){return new electronicWarfare_ElectronicWarfareEntry(entry.type,entry.targetShipId,entry.amount);}):[];return this;}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Usage/Output",value:this.getUsageVsOutputText()});previousResponse.push({header:"EW type(s)",value:this.allowedEwTypes.map(ElectronicWarfareProvider_typeAsString).join(", ")});return previousResponse;}},{key:"getUsageVsOutputText",value:function getUsageVsOutputText(){return this.getTotalEwUsed()+"/"+this.getEwOutput();}},{key:"getValidEwTypes",value:function getValidEwTypes(){return this.getValidEwTypes;}},{key:"getEwEntry",value:function getEwEntry(type,targetId){return this.entries.find(function(entry){return entry.type===type&&entry.targetShipId===targetId;});}},{key:"assignEw",value:function assignEw(_ref){var type=_ref.type,target=_ref.target,amount=_ref.amount;if(target instanceof unit_Ship){target=target.id;}if(!this.canUseEw({type:type,amount:amount})){throw new Error("Check validity first!");}var entry=this.getEwEntry(type,target);if(!entry&&amount<=0){return;}else if(!entry){entry=new electronicWarfare_ElectronicWarfareEntry(type,target,amount);this.entries.push(entry);}else{entry.addAmount(amount);}}},{key:"getEwEntries",value:function getEwEntries(){return this.entries.map(function(entry){return entry.clone();});}},{key:"canUseEw",value:function canUseEw(_ref2){var type=_ref2.type,amount=_ref2.amount;return this.canUseEwType(type)&&this.canUseEwAmount(amount);}},{key:"canUseEwType",value:function canUseEwType(type){return this.allowedEwTypes.includes(type);}},{key:"canUseEwAmount",value:function canUseEwAmount(amount){return this.getEwOutput()>=this.getTotalEwUsed()+amount;}},{key:"getUnusedCapacity",value:function getUnusedCapacity(){return this.getEwOutput()-this.getTotalEwUsed();}},{key:"getTotalEwUsedByType",value:function getTotalEwUsedByType(type){if(type===EW_DEFENSIVE){if(!this.canUseEwType(EW_DEFENSIVE)){return 0;}return this.getUnusedCapacity();}return this.entries.filter(function(entry){return entry.type===type;}).reduce(function(total,entry){return total+entry.getAmount();},0);}},{key:"getTotalEwUsed",value:function getTotalEwUsed(){return this.entries.reduce(function(total,entry){return total+entry.getAmount();},0);}},{key:"getOutputForBoost",value:function getOutputForBoost(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(previousResponse>this.output){return previousResponse;}return this.output;}},{key:"getEwOutput",value:function getEwOutput(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var output=this.output;output-=this.system.damage.getCriticals().filter(function(critical){return critical instanceof criticals_OutputReduced;}).reduce(function(total,current){return total+current.getOutputReduction();},0);return previousResponse+this.system.callHandler("getBoost",null,0)+output;}},{key:"isEwArray",value:function isEwArray(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return true;}},{key:"resetEw",value:function resetEw(){this.entries=[];}},{key:"getPossibleCriticals",value:function getPossibleCriticals(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{severity:20,critical:new criticals_OutputReduced(1)},{severity:40,critical:new criticals_OutputReduced(Math.ceil(this.output/4),2)},{severity:50,critical:new criticals_OutputReduced(Math.ceil(this.output/3),2)},{severity:60,critical:new criticals_OutputReduced(Math.ceil(this.output/2),2)},{severity:80,critical:new criticals_OutputReduced(Math.ceil(this.output/4))},{severity:90,critical:new criticals_OutputReduced(Math.ceil(this.output/3))},{severity:100,critical:new criticals_OutputReduced(Math.ceil(this.output/2))}]);}},{key:"censorForUser",value:function censorForUser(_ref3){var mine=_ref3.mine;if(!mine){this.entries=[];}}},{key:"onSystemOffline",value:function onSystemOffline(){this.onSystemPowerLevelDecrease();}},{key:"onSystemPowerLevelDecrease",value:function onSystemPowerLevelDecrease(){if(!this.system||!this.system.shipSystems||!this.system.shipSystems.ship){return;}this.system.shipSystems.ship.electronicWarfare.repeatElectonicWarfare();}}]);return ElectronicWarfareProvider;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_ElectronicWarfareProvider = (ElectronicWarfareProvider_ElectronicWarfareProvider);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/LargerHitProfileOnlineSystemStrategy.mjs
var LargerHitProfileOnlineSystemStrategy_LargerHitProfileOnlineSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(LargerHitProfileOnlineSystemStrategy,_ShipSystemStrategy);function LargerHitProfileOnlineSystemStrategy(front,side){var _this;var hitSizeMultiplier=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;Object(classCallCheck["a" /* default */])(this,LargerHitProfileOnlineSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(LargerHitProfileOnlineSystemStrategy).call(this));_this.front=front;_this.side=side;_this.hitSizeMultiplier=hitSizeMultiplier;_this.turnsOffline=0;return _this;}Object(createClass["a" /* default */])(LargerHitProfileOnlineSystemStrategy,[{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{largerHitProfileOnlineSystemStrategy:{turnsOffline:this.turnsOffline}});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var thisData=data.largerHitProfileOnlineSystemStrategy||{};this.turnsOffline=thisData.turnsOffline||0;return this;}},{key:"getHitSystemSizeMultiplier",value:function getHitSystemSizeMultiplier(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(this.system.isDestroyed()&&this.turnsOffline>0||this.turnsOffline>1){return previousResponse;}return previousResponse+this.hitSizeMultiplier;}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Increases profile when online",value:"".concat(this.front,"/").concat(this.side)});previousResponse.push({header:"Modifies system hit allocation size",value:"x".concat(this.hitSizeMultiplier)});if(!this.system.isDestroyed()){if(this.turnsOffline>1){previousResponse.push({value:"NOTE: System has been offline long enough for the profile increase to cease."});}else{previousResponse.push({value:"NOTE: System has to be offline ".concat(2-this.turnsOffline," turn(s) before profile increase ceases.")});}}else{previousResponse.push({value:"NOTE: Destroyed system will not increase ship profile."});}return previousResponse;}},{key:"getHitProfile",value:function getHitProfile(_ref){var _ref$front=_ref.front,front=_ref$front===void 0?true:_ref$front;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDestroyed()&&this.turnsOffline>0||this.turnsOffline>1){return previousResponse;}if(front){return previousResponse+this.front;}else{return previousResponse+this.side;}}},{key:"advanceTurn",value:function advanceTurn(){if(this.system.isDisabled()){this.turnsOffline++;}else{this.turnsOffline=0;}}},{key:"onGameStart",value:function onGameStart(){console.log("is online",this.system.power.isOnline());if(this.system.power.isOnline()){console.log("set offline");this.system.power.setOffline();}this.turnsOffline=99;}}]);return LargerHitProfileOnlineSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_LargerHitProfileOnlineSystemStrategy = (LargerHitProfileOnlineSystemStrategy_LargerHitProfileOnlineSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/BoostablePlusOneOutputSystemStrategy.mjs
var BoostablePlusOneOutputSystemStrategy_BoostablePlusOneOutputSystemStrategy=/*#__PURE__*/function(_BoostableSystemStrat){Object(inherits["a" /* default */])(BoostablePlusOneOutputSystemStrategy,_BoostableSystemStrat);function BoostablePlusOneOutputSystemStrategy(){var _this;var maxLevel=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var basePowerRequirement=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;Object(classCallCheck["a" /* default */])(this,BoostablePlusOneOutputSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(BoostablePlusOneOutputSystemStrategy).call(this,0,maxLevel));_this.basePowerRequirement=basePowerRequirement;return _this;}Object(createClass["a" /* default */])(BoostablePlusOneOutputSystemStrategy,[{key:"getPowerRequiredForBoost",value:function getPowerRequiredForBoost(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var output=this.basePowerRequirement!==null?this.basePowerRequirement:this.system.callHandler("getOutputForBoost",null,0);return output+this.boostLevel+previousResponse+1;}},{key:"getPowerRequirement",value:function getPowerRequirement(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var output=this.basePowerRequirement!==null?this.basePowerRequirement:this.system.callHandler("getOutputForBoost",null,0);var power=this.boostLevel*output+this.boostLevel;return power+previousResponse;}}]);return BoostablePlusOneOutputSystemStrategy;}(strategy_BoostableSystemStrategy);/* harmony default export */ var strategy_BoostablePlusOneOutputSystemStrategy = (BoostablePlusOneOutputSystemStrategy_BoostablePlusOneOutputSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/ArmorBoostOfflineSystemStrategy.mjs
var ArmorBoostOfflineSystemStrategy_ArmorBoostOfflineSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(ArmorBoostOfflineSystemStrategy,_ShipSystemStrategy);function ArmorBoostOfflineSystemStrategy(){var _this;var armorBoost=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;Object(classCallCheck["a" /* default */])(this,ArmorBoostOfflineSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ArmorBoostOfflineSystemStrategy).call(this));_this.armorBoost=armorBoost;return _this;}Object(createClass["a" /* default */])(ArmorBoostOfflineSystemStrategy,[{key:"getArmorModifier",value:function getArmorModifier(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(!this.system.isDisabled()){return previousResponse;}return previousResponse+this.armorBoost;}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Increased armor when offline",value:"+".concat(this.armorBoost)});return previousResponse;}}]);return ArmorBoostOfflineSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_ArmorBoostOfflineSystemStrategy = (ArmorBoostOfflineSystemStrategy_ArmorBoostOfflineSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/OutputHeatOnlineStrategy.mjs
var OutputHeatOnlineStrategy_OutputHeatOnlineStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(OutputHeatOnlineStrategy,_ShipSystemStrategy);function OutputHeatOnlineStrategy(heatOutput){var _this;var heatOutputPerBoostLevel=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var overheatTransferRatio=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0.5;Object(classCallCheck["a" /* default */])(this,OutputHeatOnlineStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OutputHeatOnlineStrategy).call(this));_this.heatOutput=heatOutput;_this.heatOutputPerBoostLevel=heatOutputPerBoostLevel;_this.overheatTransferRatio=overheatTransferRatio;return _this;}Object(createClass["a" /* default */])(OutputHeatOnlineStrategy,[{key:"getOverheatTransferRatio",value:function getOverheatTransferRatio(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(previousResponse&&previousResponse<this.overheatTransferRatio){return previousResponse;}return this.overheatTransferRatio;}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return previousResponse;}},{key:"generatesHeat",value:function generatesHeat(){return true;}},{key:"getHeatGenerated",value:function getHeatGenerated(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.system.isDisabled()){return previousResponse;}var boostLevel=this.system.callHandler("getBoost",null,0);return previousResponse+this.heatOutput+boostLevel*this.heatOutputPerBoostLevel;}}]);return OutputHeatOnlineStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_OutputHeatOnlineStrategy = (OutputHeatOnlineStrategy_OutputHeatOnlineStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/FireOrderHeatStrategy.mjs
var FireOrderHeatStrategy_FireOrderHeatStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(FireOrderHeatStrategy,_ShipSystemStrategy);function FireOrderHeatStrategy(heatPerFireOrder){var _this;Object(classCallCheck["a" /* default */])(this,FireOrderHeatStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(FireOrderHeatStrategy).call(this));_this.heatPerFireOrder=heatPerFireOrder;return _this;}Object(createClass["a" /* default */])(FireOrderHeatStrategy,[{key:"generatesHeat",value:function generatesHeat(){return true;}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return previousResponse;}},{key:"getHeatGenerated",value:function getHeatGenerated(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var fireOrders=this.system.callHandler("getFireOrders",null,[]);if(fireOrders.length===0){return previousResponse;}return previousResponse+fireOrders*this.heatPerFireOrder;}}]);return FireOrderHeatStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_FireOrderHeatStrategy = (FireOrderHeatStrategy_FireOrderHeatStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/AlwaysTargetableSystemStrategy.mjs
var AlwaysTargetableSystemStrategy_AlwaysTargetableSystemStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(AlwaysTargetableSystemStrategy,_ShipSystemStrategy);function AlwaysTargetableSystemStrategy(){var _this;var turnsOfflineToCancel=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;Object(classCallCheck["a" /* default */])(this,AlwaysTargetableSystemStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AlwaysTargetableSystemStrategy).call(this));_this.turnsOfflineToCancel=turnsOfflineToCancel;_this.turnsOffline=0;return _this;}Object(createClass["a" /* default */])(AlwaysTargetableSystemStrategy,[{key:"canBeTargeted",value:function canBeTargeted(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(this.system.isDestroyed()){return previousResponse;}if(this.turnsOfflineToCancel!==null&&this.turnsOffline>=this.turnsOfflineToCancel){return previousResponse;}return true;}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{alwaysTargetableSystemStrategy:{turnsOffline:this.turnsOffline}});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var thisData=data.alwaysTargetableSystemStrategy||{};this.turnsOffline=thisData.turnsOffline||0;return this;}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(this.system.isDestroyed()){return previousResponse;}if(this.turnsOfflineToCancel===null){previousResponse.push({value:"This system can always be hit, regardless of attack direction"});}else{if(this.turnsOffline>=this.turnsOfflineToCancel){previousResponse.push({value:"This system has been ofline long enough to not be a valid target"});}else{previousResponse.push({value:"This system has to be ofline ".concat(this.turnsOfflineToCancel-this.turnsOffline," more turn to not be a valid target")});}}return previousResponse;}},{key:"advanceTurn",value:function advanceTurn(){if(this.system.isDisabled()){this.turnsOffline++;}else{this.turnsOffline=0;}}}]);return AlwaysTargetableSystemStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var strategy_AlwaysTargetableSystemStrategy = (AlwaysTargetableSystemStrategy_AlwaysTargetableSystemStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/StandardHitStrategy.mjs
var StandardHitStrategy_StandardHitStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(StandardHitStrategy,_ShipSystemStrategy);function StandardHitStrategy(){var _this;var fireControl=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var numberOfShots=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;Object(classCallCheck["a" /* default */])(this,StandardHitStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StandardHitStrategy).call(this));_this.fireControl=fireControl;_this.numberOfShots=numberOfShots;return _this;}Object(createClass["a" /* default */])(StandardHitStrategy,[{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Fire control",value:this.fireControl});return previousResponse;}},{key:"getBaseHitChance",value:function getBaseHitChance(_ref){var shooter=_ref.shooter,target=_ref.target;return target.getHitProfile(shooter.getPosition());}},{key:"checkFireOrderHits",value:function checkFireOrderHits(_ref2){var shooter=_ref2.shooter,target=_ref2.target,weaponSettings=_ref2.weaponSettings,combatLogEntry=_ref2.combatLogEntry;var toHit=this.getHitChance({shooter:shooter,target:target,weaponSettings:weaponSettings});var roll=Math.ceil(Math.random()*100);var hit=roll<=toHit.result;var result=new combatLog_CombatLogWeaponFireHitResult(hit,toHit,roll);combatLogEntry.addHitResult(result);return result;}},{key:"getFireControl",value:function getFireControl(){return this.fireControl;}},{key:"getHitChance",value:function getHitChance(_ref3){var shooter=_ref3.shooter,target=_ref3.target,_ref3$weaponSettings=_ref3.weaponSettings,weaponSettings=_ref3$weaponSettings===void 0?{}:_ref3$weaponSettings;var baseToHit=this.system.callHandler("getBaseHitChance",{shooter:shooter,target:target,weaponSettings:weaponSettings});var dew=target.electronicWarfare.inEffect.getDefensiveEw();var oew=shooter.electronicWarfare.inEffect.getOffensiveEw(target);var distance=shooter.hexDistanceTo(target);var initialRangeModifier=this.system.callHandler("getRangeModifier",{distance:distance,weaponSettings:weaponSettings});var rangeModifier=initialRangeModifier*(1+target.movement.getActiveEvasion()/10);var evasionPenalty=rangeModifier-initialRangeModifier;var rollingPenalty=shooter.movement.isRolling()?-20:0;var noLockPenalty=oew>=1?0:-this.getFireControl();var ownEvasionPenalty=-shooter.movement.getActiveEvasion()*5;var result=baseToHit+rollingPenalty+this.getFireControl()+oew*5-dew*5+rangeModifier+noLockPenalty+ownEvasionPenalty;if(rangeModifier===false){result=0;}var onRange=this.system.callHandler("isOnRange",{distance:distance});var absoluteResult=result;result=Math.floor(result);if(result<0){result=0;}return new weapon_WeaponHitChance({baseToHit:baseToHit,fireControl:this.fireControl,dew:dew,oew:oew,distance:distance,rangeModifier:rangeModifier,evasion:target.movement.getActiveEvasion(),evasionPenalty:evasionPenalty,result:onRange?result:0,absoluteResult:absoluteResult,outOfRange:!onRange,rollingPenalty:rollingPenalty,noLockPenalty:noLockPenalty,ownEvasionPenalty:ownEvasionPenalty});}}]);return StandardHitStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_StandardHitStrategy = (StandardHitStrategy_StandardHitStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/StandardRangeStrategy.mjs
var StandardRangeStrategy_StandardRangeStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(StandardRangeStrategy,_ShipSystemStrategy);function StandardRangeStrategy(rangesAndPenalties){var _this;Object(classCallCheck["a" /* default */])(this,StandardRangeStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StandardRangeStrategy).call(this));_this.rangesAndPenalties=rangesAndPenalties||[];return _this;}Object(createClass["a" /* default */])(StandardRangeStrategy,[{key:"getUiComponents",value:function getUiComponents(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{name:"RangePenalty",props:{rangeStrategy:this}}]);}},{key:"isOnRange",value:function isOnRange(_ref){var distance=_ref.distance;return distance<=this.getMaxRange();}},{key:"getMaxRange",value:function getMaxRange(){return this.rangesAndPenalties[this.rangesAndPenalties.length-1].range;}},{key:"getRangeModifier",value:function getRangeModifier(_ref2){var currentRange=_ref2.distance;var exactModifier=this.rangesAndPenalties.find(function(_ref3){var range=_ref3.range;return range===currentRange;});if(exactModifier){return exactModifier.modifier;}var start=null;var end=null;this.rangesAndPenalties.forEach(function(_ref4){var range=_ref4.range,modifier=_ref4.modifier;if((start===null||range>start.range)&&range<currentRange){start={range:range,modifier:modifier};}else if((end===null||range<end.range)&&range>currentRange){end={range:range,modifier:modifier};}});if(!end){return-200;}var difference=end.modifier-start.modifier;var distance=end.range-start.range;return Math.round(start.modifier+difference*(currentRange-start.range)/distance);}}]);return StandardRangeStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_StandardRangeStrategy = (StandardRangeStrategy_StandardRangeStrategy);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogWeaponOutOfArc.mjs
var CombatLogWeaponOutOfArc_CombatLogWeaponOutOfArc=/*#__PURE__*/function(){function CombatLogWeaponOutOfArc(fireOrderId){Object(classCallCheck["a" /* default */])(this,CombatLogWeaponOutOfArc);this.fireOrderId=fireOrderId;}Object(createClass["a" /* default */])(CombatLogWeaponOutOfArc,[{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,fireOrderId:this.fireOrderId};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.fireOrderId=data.fireOrderId;return this;}}]);return CombatLogWeaponOutOfArc;}();/* harmony default export */ var combatLog_CombatLogWeaponOutOfArc = (CombatLogWeaponOutOfArc_CombatLogWeaponOutOfArc);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/FireOrderStrategy.mjs
var FireOrderStrategy_FireOrderStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(FireOrderStrategy,_ShipSystemStrategy);function FireOrderStrategy(){var _this;var numberOfShots=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var resolutionPriority=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;Object(classCallCheck["a" /* default */])(this,FireOrderStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(FireOrderStrategy).call(this));_this.numberOfShots=numberOfShots;_this.resolutionPriority=resolutionPriority;_this.fireOrders=[];return _this;}Object(createClass["a" /* default */])(FireOrderStrategy,[{key:"executeFireOrders",value:function executeFireOrders(_ref){var _this2=this;var gameData=_ref.gameData;this.fireOrders.forEach(function(fireOrder){var weapon=_this2.system;var shooter=gameData.ships.getShipById(fireOrder.shooterId);var target=gameData.ships.getShipById(fireOrder.targetId);var weaponSettings=fireOrder.weaponSettings;/*
      if (!this.system.callHandler("isOnArc", { shooter, target })) {
        gameData.combatLog.addEntry(new CombatLogWeaponOutOfArc(fireOrder.id));
        return false;
      }
      */if(!_this2.system.callHandler("canFire",{shooter:shooter,target:target},true)){return false;}var combatLogEntry=new combatLog_CombatLogWeaponFire(fireOrder.id,fireOrder.targetId,fireOrder.shooterId,weapon.callHandler("getSelectedAmmo",null,null));var hitResolution=weapon.callHandler("checkFireOrderHits",{shooter:shooter,target:target,weaponSettings:weaponSettings,gameData:gameData,fireOrder:fireOrder,combatLogEntry:combatLogEntry});weapon.callHandler("applyDamageFromWeaponFire",{shooter:shooter,target:target,weaponSettings:weaponSettings,gameData:gameData,fireOrder:fireOrder,combatLogEntry:combatLogEntry,hitResolution:hitResolution});weapon.callHandler("onWeaponFired");fireOrder.setResolved();gameData.combatLog.addEntry(combatLogEntry);});}},{key:"usesFireOrders",value:function usesFireOrders(){return true;}},{key:"getNumberOfShots",value:function getNumberOfShots(){return this.numberOfShots;}},{key:"getFireOrderResolutionPriority",value:function getFireOrderResolutionPriority(){return this.resolutionPriority;}},{key:"hasFireOrder",value:function hasFireOrder(){return this.fireOrders.length>0;}},{key:"getFireOrders",value:function getFireOrders(){return this.fireOrders;}},{key:"removeFireOrders",value:function removeFireOrders(){this.fireOrders=[];}},{key:"addFireOrder",value:function addFireOrder(_ref2){var shooter=_ref2.shooter,target=_ref2.target,weaponSettings=_ref2.weaponSettings;this.fireOrders=[];var shots=this.numberOfShots;while(shots--){var order=new weapon_FireOrder(shooter,target,this.system,weaponSettings);this.fireOrders.push(order);}return this.fireOrders;}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{fireOrderStrategy:this.fireOrders.map(function(fire){return fire.serialize();})});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.fireOrders=data.fireOrderStrategy?data.fireOrderStrategy.map(function(entry){return new weapon_FireOrder().deserialize(entry);}):[];return this;}},{key:"advanceTurn",value:function advanceTurn(turn){this.fireOrders=[];}},{key:"censorForUser",value:function censorForUser(_ref3){var mine=_ref3.mine;if(!mine){this.fireOrders=[];}}},{key:"onSystemOffline",value:function onSystemOffline(){this.removeFireOrders();}}]);return FireOrderStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_FireOrderStrategy = (FireOrderStrategy_FireOrderStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/StandardLoadingStrategy.mjs
var StandardLoadingStrategy_StandardLoadingStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(StandardLoadingStrategy,_ShipSystemStrategy);function StandardLoadingStrategy(loadingTime){var _this;Object(classCallCheck["a" /* default */])(this,StandardLoadingStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(StandardLoadingStrategy).call(this));_this.loadingTime=loadingTime;_this.turnsLoaded=loadingTime;_this.firedThisTurn=false;return _this;}Object(createClass["a" /* default */])(StandardLoadingStrategy,[{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var boostLoading=this._getBoostLoading();var loading=1+boostLoading;if(!Number.isInteger(loading)){loading=loading.toFixed(1);}var turnsLoaded=this.turnsLoaded;if(!Number.isInteger(turnsLoaded)){turnsLoaded=turnsLoaded.toFixed(1);}var loadingTime=this.getLoadingTime();if(turnsLoaded>loadingTime){turnsLoaded=loadingTime;}previousResponse.push({header:"Charging",value:"".concat(turnsLoaded," / ").concat(loadingTime," +").concat(loading," per turn")});var boostPower=this.system.callHandler("getPowerRequiredForBoost",null,0);if(boostPower){previousResponse.push({header:"Charging boostable",value:"".concat(boostPower," power required")});}return previousResponse;}},{key:"_getTurnsUntilLoaded",value:function _getTurnsUntilLoaded(){var left=this.getLoadingTime()-this.turnsLoaded;var loadingPerTurn=1+this._getBoostLoading();return Math.ceil(left/loadingPerTurn);}},{key:"getIconText",value:function getIconText(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(this.system.isDisabled()){return previousResponse;}var left=this._getTurnsUntilLoaded();if(left<=0){return previousResponse;}return"-".concat(left,"T");}},{key:"canFire",value:function canFire(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(!this.isLoaded()){return false;}return previousResponse;}},{key:"usesLoading",value:function usesLoading(){return true;}},{key:"onWeaponFired",value:function onWeaponFired(){this.firedThisTurn=true;}},{key:"getLoadingTime",value:function getLoadingTime(){var extra=this.system.damage.getCriticals().filter(function(critical){return critical instanceof criticals_LoadingTimeIncreased;}).reduce(function(total,current){return total+current.getLoadingTimeIncrease();},0);return this.loadingTime+extra;}},{key:"getTurnsLoaded",value:function getTurnsLoaded(){return this.turnsLoaded;}},{key:"isReady",value:function isReady(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(previousResponse===false){return false;}return this.isLoaded();}},{key:"isLoaded",value:function isLoaded(){return this.turnsLoaded>=this.getLoadingTime();}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{standardLoadingStrategy:{turnsLoaded:this.turnsLoaded}});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.turnsLoaded=data.standardLoadingStrategy?data.standardLoadingStrategy.turnsLoaded:0;return this;}},{key:"advanceTurn",value:function advanceTurn(){if(this.system.isDisabled()){this.turnsLoaded=0;return;}if(this.firedThisTurn){this.turnsLoaded=0;this.firedThisTurn=false;}var loadingStep=1+this._getBoostLoading();this.turnsLoaded+=loadingStep;}},{key:"_getBoostLoading",value:function _getBoostLoading(){var boost=this.system.callHandler("getBoost",null,0);if(!boost){return 0;}var targetLoading=this.getLoadingTime()-boost;return this.getLoadingTime()/targetLoading-1;}},{key:"getPossibleCriticals",value:function getPossibleCriticals(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{severity:40,critical:new criticals_LoadingTimeIncreased(this.loadingTime,1)},{severity:80,critical:new criticals_LoadingTimeIncreased(this.loadingTime*3,1)},{severity:100,critical:new criticals_LoadingTimeIncreased(null,1)}]);}}]);return StandardLoadingStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_StandardLoadingStrategy = (StandardLoadingStrategy_StandardLoadingStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/WeaponArcStrategy.mjs
var WeaponArcStrategy_WeaponArcStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(WeaponArcStrategy,_ShipSystemStrategy);function WeaponArcStrategy(){var _this;var arcs=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];Object(classCallCheck["a" /* default */])(this,WeaponArcStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(WeaponArcStrategy).call(this));_this.arcs=[].concat(arcs);return _this;}Object(createClass["a" /* default */])(WeaponArcStrategy,[{key:"hasArcs",value:function hasArcs(){return true;}},{key:"isPositionOnArc",value:function isPositionOnArc(_ref){var targetPosition=_ref.targetPosition;var shooter=this.system.shipSystems.ship;var targetHeading=getCompassHeadingOfPoint(shooter.getPosition(),targetPosition);var shooterFacing=hexFacingToAngle(shooter.getFacing());var arcs=this.getArcs({facing:shooterFacing});return arcs.some(function(_ref2){var start=_ref2.start,end=_ref2.end;if(end===start){return true;}else if(end>start){return targetHeading>=start&&targetHeading<=end;}else if(start>end){return targetHeading<=end||targetHeading>=start;}return false;});}},{key:"isOnArc",value:function isOnArc(_ref3){var target=_ref3.target;return this.isPositionOnArc({targetPosition:target.getPosition()});}},{key:"getArcs",value:function getArcs(_ref4){var _this2=this;var _ref4$facing=_ref4.facing,facing=_ref4$facing===void 0?0:_ref4$facing;return this.arcs.map(function(_ref5){var start=_ref5.start,end=_ref5.end;if(_this2.system.shipSystems.ship.movement.isRolled()){return{start:addToDirection(addToDirection(0,-end),facing),end:addToDirection(addToDirection(0,-start),facing)};}return{start:addToDirection(start,facing),end:addToDirection(end,facing)};});}}]);return WeaponArcStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_WeaponArcStrategy = (WeaponArcStrategy_WeaponArcStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/reactor/Reactor.mjs
var Reactor_Reactor=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(Reactor,_ShipSystem);function Reactor(args,output){Object(classCallCheck["a" /* default */])(this,Reactor);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Reactor).call(this,args,[new strategy_PowerOutputSystemStrategy(output)]));}Object(createClass["a" /* default */])(Reactor,[{key:"getDisplayName",value:function getDisplayName(){return"Reactor";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/reactor.png";}},{key:"getIconText",value:function getIconText(){return this.callHandler("getPowerOutput");}}]);return Reactor;}(system_ShipSystem);/* harmony default export */ var reactor_Reactor = (Reactor_Reactor);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/TestDamageStrategy.mjs
var TestDamageStrategy_TestDamageStrategy=/*#__PURE__*/function(_StandardDamageStrate){Object(inherits["a" /* default */])(TestDamageStrategy,_StandardDamageStrate);function TestDamageStrategy(damage){var _this;Object(classCallCheck["a" /* default */])(this,TestDamageStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TestDamageStrategy).call(this));_this.damage=damage;return _this;}Object(createClass["a" /* default */])(TestDamageStrategy,[{key:"_getDamageForWeaponHit",value:function _getDamageForWeaponHit(_ref){var requiredToHit=_ref.requiredToHit,rolledToHit=_ref.rolledToHit;return this.damage;}},{key:"_chooseHitSystem",value:function _chooseHitSystem(_ref2){var target=_ref2.target,shooterPosition=_ref2.shooterPosition;var systems=target.systems.getSystemsForHit(shooterPosition);return systems.find(function(system){return system instanceof reactor_Reactor;});}},{key:"_getArmorPiercing",value:function _getArmorPiercing(){return 1000;}}]);return TestDamageStrategy;}(weapon_StandardDamageStrategy);/* harmony default export */ var weapon_TestDamageStrategy = (TestDamageStrategy_TestDamageStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/BurstDamageStrategy.mjs
var BurstDamageStrategy_BurstDamageStrategy=/*#__PURE__*/function(_StandardDamageStrate){Object(inherits["a" /* default */])(BurstDamageStrategy,_StandardDamageStrate);function BurstDamageStrategy(damageFormula,armorPiercingFormula){var _this;var shotsFormula=arguments.length>2&&arguments[2]!==undefined?arguments[2]:6;var maxShots=arguments.length>3&&arguments[3]!==undefined?arguments[3]:6;var grouping=arguments.length>4&&arguments[4]!==undefined?arguments[4]:10;Object(classCallCheck["a" /* default */])(this,BurstDamageStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(BurstDamageStrategy).call(this,damageFormula,armorPiercingFormula));_this.shotsFormula=shotsFormula;_this.maxShots=maxShots;_this.grouping=grouping;return _this;}Object(createClass["a" /* default */])(BurstDamageStrategy,[{key:"getTotalBurstSize",value:function getTotalBurstSize(){return this.maxShots;}},{key:"applyDamageFromWeaponFire",value:function applyDamageFromWeaponFire(payload){var _this2=this;var fireOrder=payload.fireOrder,combatLogEntry=payload.combatLogEntry;var shots=this._getNumberOfShots(payload);combatLogEntry.setShots(shots,this.maxShots);Array.from(Array(shots)).map(function(){var result=new combatLog_CombatLogDamageEntry();combatLogEntry.addDamage(result);_this2._doDamage(Object(objectSpread2["a" /* default */])({shooterPosition:payload.shooter.getPosition()},payload),result);return result;});}},{key:"_getDamageTypeMessage",value:function _getDamageTypeMessage(){return"Burst";}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Damage type",value:this._getDamageTypeMessage()});previousResponse.push({header:"Burst size",value:this.maxShots});previousResponse.push({header:"Burst grouping",value:this.grouping});previousResponse.push({header:"Damage",value:this._getDamageMessage()});previousResponse.push({header:"Armor piercing",value:this._getArmorPiercingMessage()});return previousResponse;}},{key:"_getNumberOfShots",value:function _getNumberOfShots(_ref){var hitResolution=_ref.hitResolution;var requiredToHit=hitResolution.hitChance.result;var rolledToHit=hitResolution.hitRoll;if(rolledToHit>requiredToHit){return 0;}if(rolledToHit<=requiredToHit-this.maxShots*this.grouping){return this.maxShots;}var shots=Math.floor((requiredToHit-rolledToHit)/this.grouping);if(Number.isInteger(this.shotsFormula)){shots+=this.shotsFormula;}else{shots+=this.diceRoller.roll(this.shotsFormula).total;}if(shots>this.maxShots){shots=this.maxShots;}if(shots<=0){shots=1;}return shots;}}]);return BurstDamageStrategy;}(weapon_StandardDamageStrategy);/* harmony default export */ var weapon_BurstDamageStrategy = (BurstDamageStrategy_BurstDamageStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/PiercingDamageStrategy.mjs
var PiercingDamageStrategy_PiercingDamageStrategy=/*#__PURE__*/function(_StandardDamageStrate){Object(inherits["a" /* default */])(PiercingDamageStrategy,_StandardDamageStrate);function PiercingDamageStrategy(damageFormula,armorPiercingFormula){Object(classCallCheck["a" /* default */])(this,PiercingDamageStrategy);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(PiercingDamageStrategy).call(this,damageFormula,armorPiercingFormula));}Object(createClass["a" /* default */])(PiercingDamageStrategy,[{key:"_getDamageTypeMessage",value:function _getDamageTypeMessage(){return"Piercing";}},{key:"getMessages",value:function getMessages(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];previousResponse.push({header:"Damage type",value:this._getDamageTypeMessage()});previousResponse.push({value:"Piercing will cause damage multiple times applying new damage each time, until it runs out of armor piercing."+" Piercing will not damage other than structures multiple times."});previousResponse.push({header:"Damage",value:this._getDamageMessage()});previousResponse.push({header:"Armor piercing",value:this._getArmorPiercingMessage()});return previousResponse;}},{key:"_getNumberOfShots",value:function _getNumberOfShots(){return this.maxDamages;}},{key:"_chooseHitSystem",value:function _chooseHitSystem(_ref,systemsHit){var target=_ref.target,shooterPosition=_ref.shooterPosition;var systems=target.systems.getSystemsForHit(shooterPosition).filter(function(system){return!systemsHit.some(function(hit){return system.id===hit.id;});});return this.hitSystemRandomizer.randomizeHitSystem(systems);}},{key:"_doDamage",value:function _doDamage(payload,damageResult){var armorPiercing=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;var shotsResolved=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var systemsHit=arguments.length>4&&arguments[4]!==undefined?arguments[4]:[];var target=payload.target,shooterPosition=payload.shooterPosition,combatLogEntry=payload.combatLogEntry;if(armorPiercing===0){combatLogEntry.addNote("Pierced ".concat(shotsResolved," times. Ran out of armor piercing."));return;}if(armorPiercing===undefined){armorPiercing=this._getArmorPiercing(payload);}var hitSystem=this._chooseHitSystem({target:target,shooterPosition:shooterPosition},systemsHit);if(!hitSystem){return;}var result=this._doDamageToSystem(payload,damageResult,hitSystem,armorPiercing,this._getDamageForWeaponHit(payload));armorPiercing=result.armorPiercing;if(!(hitSystem instanceof structure_Structure)){systemsHit.push(hitSystem);}return this._doDamage(payload,damageResult,armorPiercing,shotsResolved+1,systemsHit);}}]);return PiercingDamageStrategy;}(weapon_StandardDamageStrategy);/* harmony default export */ var weapon_PiercingDamageStrategy = (PiercingDamageStrategy_PiercingDamageStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/InterceptorStrategy.mjs
var InterceptorStrategy_InterceptorStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(InterceptorStrategy,_ShipSystemStrategy);function InterceptorStrategy(){var _this;var numberOfIntercepts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var heatPerIntercept=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;Object(classCallCheck["a" /* default */])(this,InterceptorStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(InterceptorStrategy).call(this));_this.numberOfIntercepts=numberOfIntercepts;_this.heatPerIntercept=heatPerIntercept;_this.timesIntercepted=0;return _this;}Object(createClass["a" /* default */])(InterceptorStrategy,[{key:"getInterceptHeat",value:function getInterceptHeat(){return this.timesIntercepted*this.heatPerIntercept;}},{key:"getHeatPerIntercept",value:function getHeatPerIntercept(){return this.heatPerIntercept;}},{key:"addTimesIntercepted",value:function addTimesIntercepted(){var amount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;this.timesIntercepted+=amount;}},{key:"getHeatGenerated",value:function getHeatGenerated(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return previousResponse+this.timesIntercepted*this.heatPerIntercept;}},{key:"canIntercept",value:function canIntercept(){return true;}},{key:"getNumberOfIntercepts",value:function getNumberOfIntercepts(){return this.numberOfIntercepts;}},{key:"getInterceptChance",value:function getInterceptChance(_ref){var target=_ref.target,torpedoFlight=_ref.torpedoFlight;var ship=this.system.shipSystems.ship;var distance=torpedoFlight.torpedo.damageStrategy.getStrikeDistance({target:target,torpedoFlight:torpedoFlight});if(target!==ship){distance=ship.getHexPosition().distanceTo(torpedoFlight.strikePosition.toOffset());}var rangeModifier=this.system.callHandler("getRangeModifier",{distance:distance})*(1+torpedoFlight.torpedo.getEvasion()/10);var fireControl=this.system.callHandler("getFireControl",null,0);var ccew=ship.electronicWarfare.getCcEw();var torpedoHitSize=torpedoFlight.torpedo.getHitSize();var rollingPenalty=ship.movement.isRolling()?-20:0;return new weapon_WeaponHitChance({baseToHit:torpedoHitSize,fireControl:fireControl,dew:0,oew:ccew,distance:distance,rangeModifier:rangeModifier,evasion:torpedoFlight.torpedo.getEvasion(),rollingPenalty:rollingPenalty,result:Math.round(torpedoHitSize+rangeModifier+fireControl+ccew*5+rollingPenalty),absoluteResult:torpedoHitSize+rangeModifier+fireControl+ccew*5+rollingPenalty});}},{key:"advanceTurn",value:function advanceTurn(){this.timesIntercepted=0;}}]);return InterceptorStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_InterceptorStrategy = (InterceptorStrategy_InterceptorStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/strategy/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/thruster/ManeuveringThruster.mjs
var ManeuveringThruster_ManeuveringThruster=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(ManeuveringThruster,_ShipSystem);function ManeuveringThruster(args,channel,evasion){Object(classCallCheck["a" /* default */])(this,ManeuveringThruster);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ManeuveringThruster).call(this,args,[new strategy_ThrustChannelSystemStrategy(channel,[6,7,8],{},THRUSTER_MODE_MANEUVER),new strategy_AllowsEvasionSystemStrategy(evasion)]));}Object(createClass["a" /* default */])(ManeuveringThruster,[{key:"getDisplayName",value:function getDisplayName(){return"Maneuvering Thruster";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/maneuveringThruster.png";}}]);return ManeuveringThruster;}(system_ShipSystem);/* harmony default export */ var thruster_ManeuveringThruster = (ManeuveringThruster_ManeuveringThruster);
// CONCATENATED MODULE: ./src/model/unit/system/thruster/Thruster.mjs
var Thruster_Thruster=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(Thruster,_ShipSystem);function Thruster(args,output,direction){var _this;var _ref=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},_ref$power=_ref.power,power=_ref$power===void 0?1:_ref$power,_ref$boostPower=_ref.boostPower,boostPower=_ref$boostPower===void 0?1:_ref$boostPower,_ref$maxBoost=_ref.maxBoost,maxBoost=_ref$maxBoost===void 0?null:_ref$maxBoost,thrustHeatExtra=_ref.thrustHeatExtra;Object(classCallCheck["a" /* default */])(this,Thruster);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Thruster).call(this,args,[new strategy_ThrustChannelSystemStrategy(output,direction,{thrustHeatExtra:thrustHeatExtra},THRUSTER_MODE_FUSION,[THRUSTER_MODE_CHEMICAL]),new strategy_RequiresPowerSystemStrategy(power)]));if(maxBoost!==0&&boostPower!==0){if(maxBoost===null){maxBoost=Math.round(output/2);}_this.addStrategy(new strategy_BoostableSystemStrategy(boostPower,maxBoost));}return _this;}Object(createClass["a" /* default */])(Thruster,[{key:"getDisplayName",value:function getDisplayName(){return"C/Fusion Hybrid Thruster";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return this.callHandler("getBackgroundImage");}}]);return Thruster;}(system_ShipSystem);/* harmony default export */ var thruster_Thruster = (Thruster_Thruster);
// CONCATENATED MODULE: ./src/model/unit/system/thruster/ManeuveringThrusterLeft.mjs
var ManeuveringThrusterLeft_ManeuveringThrusterLeft=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(ManeuveringThrusterLeft,_ShipSystem);function ManeuveringThrusterLeft(args,channel,evasion){Object(classCallCheck["a" /* default */])(this,ManeuveringThrusterLeft);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ManeuveringThrusterLeft).call(this,args,[new strategy_ThrustChannelSystemStrategy(channel,[6,8],{},THRUSTER_MODE_MANEUVER),new strategy_AllowsEvasionSystemStrategy(evasion)]));}Object(createClass["a" /* default */])(ManeuveringThrusterLeft,[{key:"getDisplayName",value:function getDisplayName(){return"Maneuvering Thruster";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/maneuveringThrusterLeft.png";}}]);return ManeuveringThrusterLeft;}(system_ShipSystem);/* harmony default export */ var thruster_ManeuveringThrusterLeft = (ManeuveringThrusterLeft_ManeuveringThrusterLeft);
// CONCATENATED MODULE: ./src/model/unit/system/thruster/ManeuveringThrusterRight.mjs
var ManeuveringThrusterRight_ManeuveringThrusterRight=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(ManeuveringThrusterRight,_ShipSystem);function ManeuveringThrusterRight(args,channel,evasion){Object(classCallCheck["a" /* default */])(this,ManeuveringThrusterRight);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ManeuveringThrusterRight).call(this,args,[new strategy_ThrustChannelSystemStrategy(channel,[7,8],{},THRUSTER_MODE_MANEUVER),new strategy_AllowsEvasionSystemStrategy(evasion)]));}Object(createClass["a" /* default */])(ManeuveringThrusterRight,[{key:"getDisplayName",value:function getDisplayName(){return"Maneuvering Thruster";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/maneuveringThrusterRight.png";}}]);return ManeuveringThrusterRight;}(system_ShipSystem);/* harmony default export */ var thruster_ManeuveringThrusterRight = (ManeuveringThrusterRight_ManeuveringThrusterRight);
// CONCATENATED MODULE: ./src/model/unit/system/thruster/ChemicalThruster.mjs
var ChemicalThruster_ChemicalThruster=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(ChemicalThruster,_ShipSystem);function ChemicalThruster(args,output,direction){Object(classCallCheck["a" /* default */])(this,ChemicalThruster);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ChemicalThruster).call(this,args,[new strategy_ThrustChannelSystemStrategy(output,direction,{},THRUSTER_MODE_CHEMICAL)]));}Object(createClass["a" /* default */])(ChemicalThruster,[{key:"getDisplayName",value:function getDisplayName(){return"Chemical Thruster";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return this.callHandler("getBackgroundImage");}}]);return ChemicalThruster;}(system_ShipSystem);/* harmony default export */ var thruster_ChemicalThruster = (ChemicalThruster_ChemicalThruster);
// CONCATENATED MODULE: ./src/model/unit/system/thruster/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/engine/Engine.mjs
var Engine_Engine=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(Engine,_ShipSystem);function Engine(args,output,power,boostPower){Object(classCallCheck["a" /* default */])(this,Engine);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Engine).call(this,args,[new strategy_BoostableSystemStrategy(boostPower),new strategy_ThrustOutputSystemStrategy(output),new strategy_RequiresPowerSystemStrategy(power)]));}Object(createClass["a" /* default */])(Engine,[{key:"getDisplayName",value:function getDisplayName(){return"Engine";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/engine.png";}},{key:"getIconText",value:function getIconText(){return this.callHandler("getThrustOutput");}}]);return Engine;}(system_ShipSystem);/* harmony default export */ var engine_Engine = (Engine_Engine);
// CONCATENATED MODULE: ./src/model/unit/system/engine/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/reactor/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/structure/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/electronicWarfare/EwArray.mjs
var EwArray_EwArray=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(EwArray,_ShipSystem);function EwArray(args,output){var _this;Object(classCallCheck["a" /* default */])(this,EwArray);var heat=args.heat,boostHeat=args.boostHeat,_args$boostable=args.boostable,boostable=_args$boostable===void 0?true:_args$boostable,_args$power=args.power,power=_args$power===void 0?5:_args$power,_args$overheatTransfe=args.overheatTransferRatio,overheatTransferRatio=_args$overheatTransfe===void 0?0.5:_args$overheatTransfe,_args$boostPower=args.boostPower,boostPower=_args$boostPower===void 0?null:_args$boostPower;_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(EwArray).call(this,args,[new strategy_ElectronicWarfareProvider(output),new strategy_RequiresPowerSystemStrategy(power),new strategy_OutputHeatOnlineStrategy(heat||Math.ceil(output/2),boostHeat||Math.ceil(output/3),overheatTransferRatio)]));if(boostable){_this.addStrategy(new strategy_BoostablePlusOneOutputSystemStrategy(null,boostPower));}return _this;}Object(createClass["a" /* default */])(EwArray,[{key:"getDisplayName",value:function getDisplayName(){return"Electronic Warfare array";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/scanner.png";}},{key:"getIconText",value:function getIconText(){return this.callHandler("getUsageVsOutputText");}}]);return EwArray;}(system_ShipSystem);/* harmony default export */ var electronicWarfare_EwArray = (EwArray_EwArray);
// CONCATENATED MODULE: ./src/model/unit/system/electronicWarfare/CQEWArray.mjs
var CQEWArray_CQEWArray=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(CQEWArray,_ShipSystem);function CQEWArray(args,output){Object(classCallCheck["a" /* default */])(this,CQEWArray);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CQEWArray).call(this,args,[new strategy_ElectronicWarfareProvider(output,[EW_CC])]));}Object(createClass["a" /* default */])(CQEWArray,[{key:"getDisplayName",value:function getDisplayName(){return"CQEW array";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/scanner.png";}},{key:"getIconText",value:function getIconText(){return this.callHandler("getUsageVsOutputText");}}]);return CQEWArray;}(system_ShipSystem);/* harmony default export */ var electronicWarfare_CQEWArray = (CQEWArray_CQEWArray);
// CONCATENATED MODULE: ./src/model/unit/system/electronicWarfare/ElintArray.mjs
var ElintArray_ElintArray=/*#__PURE__*/function(_EwArray){Object(inherits["a" /* default */])(ElintArray,_EwArray);function ElintArray(args,output){Object(classCallCheck["a" /* default */])(this,ElintArray);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ElintArray).call(this,args,[new strategy_ElectronicWarfareProvider(output,[EW_OFFENSIVE_SUPPORT,EW_DEFENSIVE_SUPPORT,EW_DISRUPTION,EW_AREA_DEFENSIVE_SUPPORT])]));}Object(createClass["a" /* default */])(ElintArray,[{key:"getDisplayName",value:function getDisplayName(){return"ELINT array";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/scanner.png";}},{key:"getIconText",value:function getIconText(){return this.callHandler("getUsageVsOutputText");}}]);return ElintArray;}(electronicWarfare_EwArray);/* harmony default export */ var electronicWarfare_ElintArray = (ElintArray_ElintArray);
// CONCATENATED MODULE: ./src/model/unit/system/electronicWarfare/OEWArray.mjs
var OEWArray_OEWArray=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(OEWArray,_ShipSystem);function OEWArray(args,output){var _this;Object(classCallCheck["a" /* default */])(this,OEWArray);var heat=args.heat,boostHeat=args.boostHeat,_args$boostable=args.boostable,boostable=_args$boostable===void 0?false:_args$boostable,_args$power=args.power,power=_args$power===void 0?5:_args$power,_args$overheatTransfe=args.overheatTransferRatio,overheatTransferRatio=_args$overheatTransfe===void 0?0.5:_args$overheatTransfe;_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OEWArray).call(this,args,[new strategy_ElectronicWarfareProvider(output,[EW_OFFENSIVE]),new strategy_RequiresPowerSystemStrategy(power),new strategy_OutputHeatOnlineStrategy(heat||Math.ceil(output/2),boostHeat||Math.ceil(output/3),overheatTransferRatio)]));if(boostable){_this.addStrategy(new strategy_BoostablePlusOneOutputSystemStrategy());}return _this;}Object(createClass["a" /* default */])(OEWArray,[{key:"getDisplayName",value:function getDisplayName(){return"Offensive Electronic Warfare array";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/OEWArray.png";}},{key:"getIconText",value:function getIconText(){return this.callHandler("getUsageVsOutputText");}}]);return OEWArray;}(system_ShipSystem);/* harmony default export */ var electronicWarfare_OEWArray = (OEWArray_OEWArray);
// CONCATENATED MODULE: ./src/model/unit/system/electronicWarfare/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/weapon/Weapon.mjs
var Weapon_Weapon=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(Weapon,_ShipSystem);function Weapon(args,strategies){var _this;Object(classCallCheck["a" /* default */])(this,Weapon);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Weapon).call(this,args,strategies));if(args.alwaysTargetable){_this.addStrategy(new strategy_AlwaysTargetableSystemStrategy());}return _this;}Object(createClass["a" /* default */])(Weapon,[{key:"isWeapon",value:function isWeapon(){return true;}},{key:"showOnSystemList",value:function showOnSystemList(){return true;}}]);return Weapon;}(system_ShipSystem);/* harmony default export */ var weapon_Weapon = (Weapon_Weapon);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/TestWeapon.mjs
var TestWeapon_TestWeapon=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(TestWeapon,_Weapon);function TestWeapon(args,arcs){Object(classCallCheck["a" /* default */])(this,TestWeapon);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TestWeapon).call(this,args,[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(10000),new weapon_StandardRangeStrategy([{range:0,modifier:0},{range:300,modifier:-200}]),new weapon_StandardLoadingStrategy(2),new weapon_TestDamageStrategy(10)]));}return TestWeapon;}(weapon_Weapon);/* harmony default export */ var weapon_TestWeapon = (TestWeapon_TestWeapon);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/OverPoweredTestWeapon.mjs
var OverPoweredTestWeapon_OverPoweredTestWeapon=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(OverPoweredTestWeapon,_Weapon);function OverPoweredTestWeapon(args,arcs){Object(classCallCheck["a" /* default */])(this,OverPoweredTestWeapon);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(OverPoweredTestWeapon).call(this,args,[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(10000),new weapon_StandardRangeStrategy([{range:0,modifier:0},{range:300,modifier:-200}]),new weapon_StandardLoadingStrategy(2),new weapon_StandardDamageStrategy(10000)]));}return OverPoweredTestWeapon;}(weapon_Weapon);/* harmony default export */ var weapon_OverPoweredTestWeapon = (OverPoweredTestWeapon_OverPoweredTestWeapon);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/WeaponAnimationStrategy.mjs
var WeaponAnimationStrategy_WeaponAnimationStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(WeaponAnimationStrategy,_ShipSystemStrategy);function WeaponAnimationStrategy(animationName){var _this;var animationArguments=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Object(classCallCheck["a" /* default */])(this,WeaponAnimationStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(WeaponAnimationStrategy).call(this));_this.animationName=animationName;_this.animationArguments=animationArguments;return _this;}Object(createClass["a" /* default */])(WeaponAnimationStrategy,[{key:"getWeaponFireAnimationName",value:function getWeaponFireAnimationName(){return this.animationName;}},{key:"getWeaponFireAnimationArguments",value:function getWeaponFireAnimationArguments(){return this.animationArguments;}}]);return WeaponAnimationStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_WeaponAnimationStrategy = (WeaponAnimationStrategy_WeaponAnimationStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/coilgun/CoilgunLightFixed.mjs
var CoilgunLightFixed_CoilgunLightFixed=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(CoilgunLightFixed,_Weapon);function CoilgunLightFixed(_ref,arcs){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,CoilgunLightFixed);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CoilgunLightFixed).call(this,{id:id,hitpoints:10,armor:5},[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(20),new weapon_StandardRangeStrategy([{range:0,modifier:-100},{range:Math.round(MEDIUM_WEAPON_RANGE*1.5),modifier:-20},{range:Math.round(MEDIUM_WEAPON_RANGE*2),modifier:-40},{range:Math.round(MEDIUM_WEAPON_RANGE*3),modifier:-200}]),new weapon_StandardLoadingStrategy(4),new strategy_RequiresPowerSystemStrategy(6),new strategy_BoostableSystemStrategy(6,2),new weapon_PiercingDamageStrategy("d7+1","d6+20"),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:12,length:2000,speed:5,color:[0.8,0.1,0.4],explosionSize:20,explosionType:"gas"}),new strategy_OutputHeatOnlineStrategy(4,2)]));}Object(createClass["a" /* default */])(CoilgunLightFixed,[{key:"getDisplayName",value:function getDisplayName(){return"Fixed light coilgun";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/matterCannon.png";}}]);return CoilgunLightFixed;}(weapon_Weapon);/* harmony default export */ var coilgun_CoilgunLightFixed = (CoilgunLightFixed_CoilgunLightFixed);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/coilgun/MediumCoilgunTurretedUC.mjs
var MediumCoilgunTurretedUC_MediumCoilgunTurretedUC=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(MediumCoilgunTurretedUC,_Weapon);function MediumCoilgunTurretedUC(_ref,arcs){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,MediumCoilgunTurretedUC);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(MediumCoilgunTurretedUC).call(this,{id:id,hitpoints:14,armor:5},[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(20),new weapon_StandardRangeStrategy([{range:0,modifier:-200},{range:Math.round(MEDIUM_WEAPON_RANGE*1.6),modifier:-20},{range:Math.round(MEDIUM_WEAPON_RANGE*2),modifier:-40},{range:Math.round(MEDIUM_WEAPON_RANGE*2.5),modifier:-60},{range:Math.round(MEDIUM_WEAPON_RANGE*4),modifier:-200}]),new weapon_StandardLoadingStrategy(4),new strategy_RequiresPowerSystemStrategy(10),new strategy_BoostableSystemStrategy(8,2),new weapon_PiercingDamageStrategy("d7+1","d9+25"),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:12,length:2000,speed:5,color:[0.8,0.1,0.4],explosionSize:20,explosionType:"gas"}),new strategy_OutputHeatOnlineStrategy(6,2)]));}Object(createClass["a" /* default */])(MediumCoilgunTurretedUC,[{key:"getDisplayName",value:function getDisplayName(){return"Medium coilgun";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/matterCannon.png";}}]);return MediumCoilgunTurretedUC;}(weapon_Weapon);/* harmony default export */ var coilgun_MediumCoilgunTurretedUC = (MediumCoilgunTurretedUC_MediumCoilgunTurretedUC);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/coilgun/RailgunTurreted64gw.mjs
var RailgunTurreted64gw_RailgunTurreted64gw=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(RailgunTurreted64gw,_Weapon);function RailgunTurreted64gw(args,arcs){Object(classCallCheck["a" /* default */])(this,RailgunTurreted64gw);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RailgunTurreted64gw).call(this,args,[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(35),new weapon_StandardRangeStrategy([{range:0,modifier:-100},{range:10,modifier:0},{range:300,modifier:-200}]),new weapon_StandardLoadingStrategy(4),new weapon_PiercingDamageStrategy("6d3","4d4 + 4"),new weapon_WeaponAnimationStrategy("Bolt",{size:18,length:2000,speed:6,color:[0.8,0.1,0.4]})]));}Object(createClass["a" /* default */])(RailgunTurreted64gw,[{key:"getDisplayName",value:function getDisplayName(){return"64Gw turreted railgun";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/matterCannon.png";}}]);return RailgunTurreted64gw;}(weapon_Weapon);/* harmony default export */ var coilgun_RailgunTurreted64gw = (RailgunTurreted64gw_RailgunTurreted64gw);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/coilgun/RailgunTurreted32gw.mjs
var RailgunTurreted32gw_RailgunTurreted32gw=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(RailgunTurreted32gw,_Weapon);function RailgunTurreted32gw(args,arcs){Object(classCallCheck["a" /* default */])(this,RailgunTurreted32gw);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RailgunTurreted32gw).call(this,args,[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(20),new weapon_StandardRangeStrategy([{range:0,modifier:-100},{range:10,modifier:0},{range:220,modifier:-200}]),new weapon_StandardLoadingStrategy(3),new weapon_PiercingDamageStrategy("4d3","3d3 + 4"),new weapon_WeaponAnimationStrategy("Bolt",{size:15,length:2000,speed:5,color:[0.8,0.1,0.4]})]));}Object(createClass["a" /* default */])(RailgunTurreted32gw,[{key:"getDisplayName",value:function getDisplayName(){return"32Gw turreted railgun";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/matterCannon.png";}}]);return RailgunTurreted32gw;}(weapon_Weapon);/* harmony default export */ var coilgun_RailgunTurreted32gw = (RailgunTurreted32gw_RailgunTurreted32gw);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/coilgun/index.mjs

// CONCATENATED MODULE: ./src/model/cargo/CargoService.mjs
var CargoService_CargoService=/*#__PURE__*/function(){function CargoService(){Object(classCallCheck["a" /* default */])(this,CargoService);}Object(createClass["a" /* default */])(CargoService,[{key:"divideCargo",value:function divideCargo(ship,cargo){if(!this.hasSpaceFor(ship,cargo)){throw new Error("Ship has no cargo space for this. Check validity first!");}var cargoBays=this.getBaysWithSpace(ship);var amount=cargo.amount;while(amount>0){cargoBays.forEach(function(system){if(amount>0&&system.callHandler("hasSpaceFor",{object:cargo.object,amount:1},false)){system.callHandler("addCargo",{object:cargo.object,amount:1});amount--;}});}}},{key:"hasSpaceForHowMany",value:function hasSpaceForHowMany(ship,cargo){var space=this.getShipWideCargoSpaceAvailable(ship);return Math.floor(space/cargo.object.getSpaceRequired());}},{key:"hasSpaceFor",value:function hasSpaceFor(ship,cargo){return this.getShipWideCargoSpaceAvailable(ship)>=cargo.object.getSpaceRequired()*cargo.amount;}},{key:"getShipWideCargoSpaceAvailable",value:function getShipWideCargoSpaceAvailable(ship){return this.getBaysWithSpace(ship).reduce(function(total,system){return total+system.callHandler("getAvailableCargoSpace",{},0);},0);}},{key:"getBaysWithSpace",value:function getBaysWithSpace(ship){return ship.systems.getSystems().filter(function(system){return system.callHandler("getAvailableCargoSpace",{},0)>0;});}}]);return CargoService;}();/* harmony default export */ var cargo_CargoService = (CargoService_CargoService);
// CONCATENATED MODULE: ./src/model/unit/system/strategy/weapon/AmmunitionStrategy.mjs
var AmmunitionStrategy_AmmunitionStrategy=/*#__PURE__*/function(_ShipSystemStrategy){Object(inherits["a" /* default */])(AmmunitionStrategy,_ShipSystemStrategy);function AmmunitionStrategy(ammunitionClasses,ammoPerFireOrder,capacity,intakeInTurn){var _this;var startLoadingAfter=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;Object(classCallCheck["a" /* default */])(this,AmmunitionStrategy);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AmmunitionStrategy).call(this));_this.ammunitionClasses=[].concat(ammunitionClasses);_this.capacity=capacity;_this.startLoadingAfter=startLoadingAfter;_this.intakeInTurn=intakeInTurn;_this.ammoPerFireOrder=ammoPerFireOrder;_this.selectedAmmo=new _this.ammunitionClasses[_this.ammunitionClasses.length-1]();_this.turnsOffline=0;_this.targetLoad=_this._buildInitialTargetLoad();_this.changeTargetLoad=null;_this.changeSelectedAmmo=null;_this.loaded=[];return _this;}Object(createClass["a" /* default */])(AmmunitionStrategy,[{key:"_buildInitialTargetLoad",value:function _buildInitialTargetLoad(){var _this2=this;var amountUsed=0;return this.ammunitionClasses.map(function(className,index){var amount=Math.floor(_this2.capacity/_this2.ammunitionClasses.length);var over=amount%_this2.ammoPerFireOrder;var under=over===0?0:_this2.ammoPerFireOrder-over;var last=index===_this2.ammunitionClasses.length-1;if(amount>_this2.capacity-amountUsed){amount=_this2.capacity-amountUsed;}else if(last){amount=_this2.capacity-amountUsed;}else if(over!==0&&over<=under){amount-=over;}else if(under!==0&&amountUsed+amount+under<=_this2.capacity){amount+=under;}amountUsed+=amount;return{object:new className(),amount:amount};});}},{key:"getIconText",value:function getIconText(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(this.system.isDisabled()){return previousResponse;}if(this.system.callHandler("isLoaded",null,null)===false){return previousResponse;}return this.getSelectedAmmo().getIconText();}},{key:"getUiComponents",value:function getUiComponents(_ref){var myShip=_ref.myShip;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!myShip){return previousResponse;}if(this.system.isDestroyed()){return previousResponse;}return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{name:"Ammo",props:{ammoStrategy:this}}]);}},{key:"getTooltipMenuButton",value:function getTooltipMenuButton(_ref2){var _this3=this;var myShip=_ref2.myShip;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!myShip){return previousResponse;}if(this.system.isDisabled()){return previousResponse;}return[].concat(Object(toConsumableArray["a" /* default */])(previousResponse),[{img:this.getSelectedAmmo().getBackgroundImage(),onClickHandler:function onClickHandler(){_this3.toggleSelectedAmmo();},onDisabledHandler:function onDisabledHandler(){return false;}}]);}},{key:"serialize",value:function serialize(payload){var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return Object(objectSpread2["a" /* default */])({},previousResponse,{ammunitionStrategy:{targetLoad:this.targetLoad.map(function(entry){return{className:entry.object.constructor.name,amount:entry.amount};}),loaded:this.loaded.map(function(entry){return{className:entry.object.constructor.name,amount:entry.amount};}),changeTargetLoad:this.changeTargetLoad?this.changeTargetLoad.map(function(entry){return{className:entry.object.constructor.name,amount:entry.amount};}):null,turnsOffline:this.turnsOffline,selectedAmmo:this.selectedAmmo.constructor.name,changeSelectedAmmo:this.changeSelectedAmmo?this.changeSelectedAmmo.constructor.name:null}});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var ammoData=data.ammunitionStrategy||{};this.targetLoad=ammoData.targetLoad?ammoData.targetLoad.map(function(entry){return{object:new cargoClasses[entry.className](),amount:entry.amount};}):[];this.loaded=ammoData.loaded?ammoData.loaded.map(function(entry){return{object:new cargoClasses[entry.className](),amount:entry.amount};}):[];this.changeTargetLoad=ammoData.changeTargetLoad?ammoData.changeTargetLoad.map(function(entry){return{object:new cargoClasses[entry.className](),amount:entry.amount};}):null;this.turnsOffline=ammoData.turnsOffline||0;this.selectedAmmo=ammoData.selectedAmmo?new cargoClasses[ammoData.selectedAmmo]():new this.ammunitionClasses[this.ammunitionClasses.length-1]();this.changeSelectedAmmo=ammoData.changeSelectedAmmo?new cargoClasses[ammoData.changeSelectedAmmo]():null;return this;}},{key:"toggleSelectedAmmo",value:function toggleSelectedAmmo(){var _this4=this;var index=null;this.loaded.forEach(function(entry,i){if(_this4.getSelectedAmmo().constructor===entry.object.constructor){index=i;}});if(index+1>this.loaded.length-1){index=0;}else{index=index+1;}this.changeSelectedAmmo=this.loaded[index].object;}},{key:"getSelectedAmmo",value:function getSelectedAmmo(){return this.changeSelectedAmmo||this.selectedAmmo;}},{key:"getLoadingTarget",value:function getLoadingTarget(){return this.changeTargetLoad||this.targetLoad;}},{key:"getAmmoInMagazine",value:function getAmmoInMagazine(){return this.loaded;}},{key:"loadTargetInstant",value:function loadTargetInstant(){this.loaded=this.targetLoad;}},{key:"getLoadingTargetAmount",value:function getLoadingTargetAmount(){return this.getLoadingTarget().reduce(function(total,_ref3){var amount=_ref3.amount;return total+amount;},0);}},{key:"addToLoading",value:function addToLoading(_ref4){var object=_ref4.object,amount=_ref4.amount;if(!this.changeTargetLoad){this.changeTargetLoad=this.targetLoad.map(function(entry){return Object(objectSpread2["a" /* default */])({},entry);});}var entry=this.changeTargetLoad.find(function(entry){return entry.object.constructor===object.constructor;});if(!entry&&amount>0){entry={object:object,amount:0};this.changeTargetLoad.push(entry);}else if(!entry&&amount<0){return;}if(this.getLoadingTargetAmount()+amount>this.capacity){return;}if(entry.amount+amount<0){return;}entry.amount+=amount;}},{key:"setNewLoadingTarget",value:function setNewLoadingTarget(target){this.changeTargetLoad=target;}},{key:"setNewSelectedAmmo",value:function setNewSelectedAmmo(ammo){this.changeSelectedAmmo=ammo;}},{key:"receivePlayerData",value:function receivePlayerData(_ref5){var _this5=this;var clientShip=_ref5.clientShip,clientSystem=_ref5.clientSystem;if(!clientSystem){return;}if(this.system.power.isOffline()){//this is fine
}else if(this.system.isDisabled()){return;}var clientStrategy=clientSystem.getStrategiesByInstance(AmmunitionStrategy)[0];var changeTargetLoad=clientStrategy.changeTargetLoad;var changeSelectedAmmo=clientStrategy.changeSelectedAmmo;if(changeTargetLoad){changeTargetLoad.forEach(function(entry){if(!_this5.ammunitionClasses.some(function(className){return entry.object instanceof className;})){throw new Error("Illegal ammo: '".concat(entry.object.constructor.name,"', allowed '").concat(_this5.ammunitionClasses.join(", "),"'"));}if(!Number.isInteger(entry.amount)||entry.amount<0){throw new Error("Illegal ammo amount: '".concat(entry.amount,"'"));}});if(changeTargetLoad.reduce(function(total,current){return total+current.amount;},0)>this.capacity){throw new Error("Total capacity exeeded");}this.targetLoad=changeTargetLoad;}if(changeSelectedAmmo){if(!this.ammunitionClasses.some(function(ammoClass){return changeSelectedAmmo instanceof ammoClass;})){throw new Error("Illegal selected ammo: '".concat(changeSelectedAmmo.constructor.name,"'"));}this.selectedAmmo=changeSelectedAmmo;}}},{key:"shouldBeOffline",value:function shouldBeOffline(payload){var _this6=this;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(previousResponse===true){return true;}return this.loaded.every(function(_ref6){var amount=_ref6.amount;return amount<_this6.ammoPerFireOrder;});}},{key:"canFire",value:function canFire(payload){var _this7=this;var previousResponse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var entry=this.loaded.find(function(load){return load.object.constructor===_this7.selectedAmmo.constructor;});if(!entry){return false;}if(entry.amount<this.ammoPerFireOrder){return false;}return previousResponse;}},{key:"onIntercept",value:function onIntercept(){this.onWeaponFired();}},{key:"onWeaponFired",value:function onWeaponFired(){var _this8=this;var entry=this.loaded.find(function(load){return load.object.constructor===_this8.selectedAmmo.constructor;});if(!entry){throw new Error("Seems like you fired a weapon without ammo. That is not good");}entry.amount-=this.ammoPerFireOrder;this.system.log.getGenericLogEntry().addMessage("Expended ordnance: ".concat(this.ammoPerFireOrder," x ").concat(this.selectedAmmo.getDisplayName()));this.loaded=this.loaded.filter(function(entry){return entry.amount>0;});this._changeSelectedAmmoIfOutOfAmmo();}},{key:"advanceTurn",value:function advanceTurn(){if(this.system.power.isOffline()){this.turnsOffline++;}else if(this.system.isDisabled()){return;}else{this.turnsOffline=0;}if(this.turnsOffline>this.startLoadingAfter){this._load();}}},{key:"_changeSelectedAmmoIfOutOfAmmo",value:function _changeSelectedAmmoIfOutOfAmmo(){var _this9=this;if(this.loaded.length===0){return;}if(!this.loaded.find(function(load){return load.object.constructor===_this9.selectedAmmo.constructor;})){var newAmmo=this.loaded.find(function(entry){return entry.amount>_this9.ammoPerFireOrder;});if(newAmmo){this.selectedAmmo=newAmmo.object;}}}},{key:"_load",value:function _load(){var _this10=this;var ammoTransferredIn=0;var ammoTransferredOut=0;var ship=this.system.shipSystems.ship;var cargoService=new cargo_CargoService();while(true){if(ammoTransferredOut===this.intakeInTurn){break;}if(this.loaded.every(function(loaded){var target=_this10.targetLoad.find(function(target){return target.object.constructor===loaded.object.constructor;});if(target&&target.amount>=loaded.amount){return true;}var extra=target?loaded.amount-target.amount:loaded.amount;if(extra>_this10.intakeInTurn-ammoTransferredOut){extra=_this10.intakeInTurn-ammoTransferredOut;}if(extra===0){return true;}var spaceAvailable=cargoService.hasSpaceForHowMany(ship,{object:loaded.object,amount:extra});if(spaceAvailable===0){return true;}else if(spaceAvailable<extra){extra=spaceAvailable;}cargoService.divideCargo(ship,{object:loaded.object,amount:extra});ammoTransferredOut+=extra;loaded.amount-=extra;return false;})){break;}}this.loaded=this.loaded.filter(function(entry){return entry.amount>0;});while(true){if(ammoTransferredIn===this.intakeInTurn){break;}if(this.targetLoad.every(function(target){var loaded=_this10.loaded.find(function(loaded){return target.object.constructor===loaded.object.constructor;});if(!loaded&&target.amount>0){loaded={object:target.object,amount:0};_this10.loaded.push(loaded);}else if(!loaded&&target.amount===0){return true;}if(loaded.amount>=target.amount){return true;}var cargoSystem=_this10.system.shipSystems.getSystems().find(function(system){return system.callHandler("getCargoEntry",target.object,null);});if(!cargoSystem){return true;}var cargo=cargoSystem.callHandler("getCargoEntry",target.object,null);var missing=target.amount-loaded.amount;if(missing>_this10.intakeInTurn-ammoTransferredIn){missing=_this10.intakeInTurn-ammoTransferredIn;}if(cargo.amount>=missing){loaded.amount+=missing;cargoSystem.callHandler("removeCargo",{object:cargo.object,amount:missing});ammoTransferredIn+=missing;}else if(cargo.amount<missing){loaded.amount+=cargo.amount;cargoSystem.callHandler("removeCargo",{object:cargo.object,amount:cargo.amount});ammoTransferredIn+=cargo.amount;}return false;})){break;}}this._changeSelectedAmmoIfOutOfAmmo();}}]);return AmmunitionStrategy;}(strategy_ShipSystemStrategy);/* harmony default export */ var weapon_AmmunitionStrategy = (AmmunitionStrategy_AmmunitionStrategy);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/pdc/PDC30mm.mjs
var PDC30mm_PDC30mm=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(PDC30mm,_Weapon);function PDC30mm(_ref,arcs){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,PDC30mm);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(PDC30mm).call(this,{id:id,armor:1,hitpoints:4},[new strategy_RequiresPowerSystemStrategy(1),new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(30),new weapon_StandardRangeStrategy([{range:0,modifier:0},{range:Math.round(MEDIUM_WEAPON_RANGE*0.3),modifier:-20},{range:Math.round(MEDIUM_WEAPON_RANGE*0.5),modifier:-50},{range:Math.round(MEDIUM_WEAPON_RANGE*0.6),modifier:-100},{range:Math.round(MEDIUM_WEAPON_RANGE*0.8),modifier:-200}]),new weapon_StandardLoadingStrategy(1),new weapon_BurstDamageStrategy(null,null,0,6,5),new weapon_InterceptorStrategy(1,2),new weapon_AmmunitionStrategy([conventional_Ammo30mm],6,24,12),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:6,speed:0.35,color:[1.0,0.9,0.8],explosionSize:3}),new strategy_ArmorBoostOfflineSystemStrategy(3),new strategy_FireOrderHeatStrategy(3)]));}Object(createClass["a" /* default */])(PDC30mm,[{key:"getDisplayName",value:function getDisplayName(){return"30mm PDC";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/gatlingPulseCannon.png";}},{key:"getSystemDescription",value:function getSystemDescription(){return"Fast tracking 30mm rotary autocannon for point defense. Uses conventional bullets with chemical propellant.";}}]);return PDC30mm;}(weapon_Weapon);/* harmony default export */ var pdc_PDC30mm = (PDC30mm_PDC30mm);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/railgun/RailgunFixed120mm.mjs
var RailgunFixed120mm_RailgunFixed120mm=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(RailgunFixed120mm,_Weapon);function RailgunFixed120mm(_ref,arcs){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,RailgunFixed120mm);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RailgunFixed120mm).call(this,{id:id,hitpoints:8,armor:4},[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(18),new weapon_StandardRangeStrategy([{range:0,modifier:-100},{range:Math.round(MEDIUM_WEAPON_RANGE*0.5),modifier:-20},{range:Math.round(MEDIUM_WEAPON_RANGE*1.2),modifier:-50},{range:Math.round(MEDIUM_WEAPON_RANGE*2),modifier:-200}]),new weapon_StandardLoadingStrategy(3),new strategy_RequiresPowerSystemStrategy(4),new strategy_BoostableSystemStrategy(3,1),new weapon_BurstDamageStrategy(null,null,0,2,20),new weapon_AmmunitionStrategy([conventional_Ammo120mmAP,conventional_Ammo120mmHE],1,12,4),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:13,length:25,speed:0.5,color:[1.0,0.8,0.4],explosionType:"gas",explosionSize:12}),new strategy_OutputHeatOnlineStrategy(3,2)]));}Object(createClass["a" /* default */])(RailgunFixed120mm,[{key:"getDisplayName",value:function getDisplayName(){return"120mm fixed railgun";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/stdParticleBeam.png";}}]);return RailgunFixed120mm;}(weapon_Weapon);/* harmony default export */ var railgun_RailgunFixed120mm = (RailgunFixed120mm_RailgunFixed120mm);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/railgun/RailgunTurreted2x140mm.mjs
var RailgunTurreted2x140mm_RailgunTurreted2x140mm=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(RailgunTurreted2x140mm,_Weapon);function RailgunTurreted2x140mm(_ref,arcs){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,RailgunTurreted2x140mm);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RailgunTurreted2x140mm).call(this,{id:id,hitpoints:12,armor:3},[new weapon_FireOrderStrategy(2),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(25),new weapon_StandardRangeStrategy([{range:0,modifier:-50},{range:Math.round(MEDIUM_WEAPON_RANGE*0.2),modifier:-20},{range:Math.round(MEDIUM_WEAPON_RANGE*1.4),modifier:-70},{range:Math.round(MEDIUM_WEAPON_RANGE*2.2),modifier:-200}]),new weapon_StandardLoadingStrategy(3),new strategy_RequiresPowerSystemStrategy(6),new strategy_BoostableSystemStrategy(6,1),new weapon_BurstDamageStrategy(null,null,0,3,20),new weapon_AmmunitionStrategy([conventional_Ammo140mmAP,conventional_Ammo140mmHE],1,9,4),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:13,length:30,speed:0.5,color:[1.0,0.8,0.4],explosionType:"gas"}),new strategy_OutputHeatOnlineStrategy(5,3)]));}Object(createClass["a" /* default */])(RailgunTurreted2x140mm,[{key:"getDisplayName",value:function getDisplayName(){return"2x140mm railgun";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/twinArray.png";}}]);return RailgunTurreted2x140mm;}(weapon_Weapon);/* harmony default export */ var railgun_RailgunTurreted2x140mm = (RailgunTurreted2x140mm_RailgunTurreted2x140mm);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/railgun/RailgunTurreted140mmUC.mjs
var RailgunTurreted140mmUC_RailgunTurreted140mmUC=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(RailgunTurreted140mmUC,_Weapon);function RailgunTurreted140mmUC(_ref,arcs){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,RailgunTurreted140mmUC);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RailgunTurreted140mmUC).call(this,{id:id,hitpoints:9,armor:3},[new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(25),new weapon_StandardRangeStrategy([{range:0,modifier:-50},{range:Math.round(MEDIUM_WEAPON_RANGE*0.2),modifier:-20},{range:Math.round(MEDIUM_WEAPON_RANGE*1.6),modifier:-70},{range:Math.round(MEDIUM_WEAPON_RANGE*2.4),modifier:-200}]),new weapon_StandardLoadingStrategy(3),new strategy_RequiresPowerSystemStrategy(4),new strategy_BoostableSystemStrategy(5,2),new weapon_BurstDamageStrategy(null,null,0,3,15),new weapon_AmmunitionStrategy([conventional_Ammo140mmAP,conventional_Ammo140mmHE],1,9,4),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:15,length:30,speed:0.6,color:[1.0,0.8,0.4],explosionType:"gas"}),new strategy_OutputHeatOnlineStrategy(3,2)]));}Object(createClass["a" /* default */])(RailgunTurreted140mmUC,[{key:"getDisplayName",value:function getDisplayName(){return"140mm railgun";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/turretMedium1.png";}}]);return RailgunTurreted140mmUC;}(weapon_Weapon);/* harmony default export */ var railgun_RailgunTurreted140mmUC = (RailgunTurreted140mmUC_RailgunTurreted140mmUC);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/railgun/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/weapon/launcher/TorpedoLauncher158.mjs
var TorpedoLauncher158_TorpedoLauncher158=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(TorpedoLauncher158,_Weapon);function TorpedoLauncher158(args){Object(classCallCheck["a" /* default */])(this,TorpedoLauncher158);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoLauncher158).call(this,args,[new weapon_TorpedoLauncherStrategy(1,null,torpedo_Torpedo158,10)]));}Object(createClass["a" /* default */])(TorpedoLauncher158,[{key:"getDisplayName",value:function getDisplayName(){return"1.53m torpedo launcher";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/missile1.png";}},{key:"getIconText",value:function getIconText(){return null;}}]);return TorpedoLauncher158;}(weapon_Weapon);/* harmony default export */ var launcher_TorpedoLauncher158 = (TorpedoLauncher158_TorpedoLauncher158);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/launcher/TorpedoLauncherDual72.mjs
var TorpedoLauncherDual72_TorpedoLauncherDual72=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(TorpedoLauncherDual72,_Weapon);function TorpedoLauncherDual72(args){Object(classCallCheck["a" /* default */])(this,TorpedoLauncherDual72);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoLauncherDual72).call(this,args,[new weapon_TorpedoLauncherStrategy(1,null,torpedo_Torpedo72,8),new weapon_TorpedoLauncherStrategy(2,null,torpedo_Torpedo72,8)]));}Object(createClass["a" /* default */])(TorpedoLauncherDual72,[{key:"getDisplayName",value:function getDisplayName(){return"0.72m dual torpedo launcher";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/missile2.png";}},{key:"getIconText",value:function getIconText(){return null;}}]);return TorpedoLauncherDual72;}(weapon_Weapon);/* harmony default export */ var launcher_TorpedoLauncherDual72 = (TorpedoLauncherDual72_TorpedoLauncherDual72);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/launcher/TorpedoLauncherDual158.mjs
var TorpedoLauncherDual158_TorpedoLauncherDual158=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(TorpedoLauncherDual158,_Weapon);function TorpedoLauncherDual158(args){Object(classCallCheck["a" /* default */])(this,TorpedoLauncherDual158);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoLauncherDual158).call(this,args,[new weapon_TorpedoLauncherStrategy(1,null,torpedo_Torpedo158,10),new weapon_TorpedoLauncherStrategy(2,null,torpedo_Torpedo158,10)]));}Object(createClass["a" /* default */])(TorpedoLauncherDual158,[{key:"getDisplayName",value:function getDisplayName(){return"1.53m dual torpedo launcher";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/missile2.png";}},{key:"getIconText",value:function getIconText(){return null;}}]);return TorpedoLauncherDual158;}(weapon_Weapon);/* harmony default export */ var launcher_TorpedoLauncherDual158 = (TorpedoLauncherDual158_TorpedoLauncherDual158);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/launcher/TorpedoLauncherQuadruple158.mjs
var TorpedoLauncherQuadruple158_TorpedoLauncherQuadruple158=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(TorpedoLauncherQuadruple158,_Weapon);function TorpedoLauncherQuadruple158(args){Object(classCallCheck["a" /* default */])(this,TorpedoLauncherQuadruple158);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TorpedoLauncherQuadruple158).call(this,args,[new weapon_TorpedoLauncherStrategy(1,null,torpedo_Torpedo158,12),new weapon_TorpedoLauncherStrategy(2,null,torpedo_Torpedo158,12),new weapon_TorpedoLauncherStrategy(3,null,torpedo_Torpedo158,12),new weapon_TorpedoLauncherStrategy(4,null,torpedo_Torpedo158,12)]));}Object(createClass["a" /* default */])(TorpedoLauncherQuadruple158,[{key:"getDisplayName",value:function getDisplayName(){return"4x 1.53m torpedo launcher";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/missile4.png";}},{key:"getIconText",value:function getIconText(){return null;}}]);return TorpedoLauncherQuadruple158;}(weapon_Weapon);/* harmony default export */ var launcher_TorpedoLauncherQuadruple158 = (TorpedoLauncherQuadruple158_TorpedoLauncherQuadruple158);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/launcher/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/weapon/autocannon/AutoCannon85mm.mjs
var AutoCannon85mm_AutoCannon85mm=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(AutoCannon85mm,_Weapon);function AutoCannon85mm(_ref,arcs){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,AutoCannon85mm);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(AutoCannon85mm).call(this,{id:id,armor:1,hitpoints:6},[new strategy_RequiresPowerSystemStrategy(2),new weapon_FireOrderStrategy(1),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(20),new weapon_StandardRangeStrategy([{range:0,modifier:0},{range:Math.round(MEDIUM_WEAPON_RANGE*0.5),modifier:-20},{range:MEDIUM_WEAPON_RANGE,modifier:-50},{range:Math.round(MEDIUM_WEAPON_RANGE*1.5),modifier:-200}]),new weapon_StandardLoadingStrategy(1),new weapon_BurstDamageStrategy(null,null,0,3,10),new weapon_InterceptorStrategy(),new weapon_AmmunitionStrategy([conventional_Ammo85mmAP,conventional_Ammo85mmHE],3,15,6),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:8,speed:0.5,color:[1.0,0.7,0.7],explosionSize:5}),new strategy_ArmorBoostOfflineSystemStrategy(3),new strategy_FireOrderHeatStrategy(8)]));}Object(createClass["a" /* default */])(AutoCannon85mm,[{key:"getDisplayName",value:function getDisplayName(){return"85mm Autocannon";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/lightParticleBeamShip.png";}}]);return AutoCannon85mm;}(weapon_Weapon);/* harmony default export */ var autocannon_AutoCannon85mm = (AutoCannon85mm_AutoCannon85mm);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/index.mjs
var merged=Object(objectSpread2["a" /* default */])({TestWeapon:weapon_TestWeapon,PDC30mm:pdc_PDC30mm},coilgun_namespaceObject,{},railgun_namespaceObject,{},launcher_namespaceObject,{AutoCannon85mm:autocannon_AutoCannon85mm,OverPoweredTestWeapon:weapon_OverPoweredTestWeapon});/* harmony default export */ var system_weapon = (merged);
// CONCATENATED MODULE: ./src/model/unit/system/heat/Radiator.mjs
var Radiator_Radiator=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(Radiator,_ShipSystem);function Radiator(args){var radiationCapacity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:40;var extraProfile=arguments.length>2&&arguments[2]!==undefined?arguments[2]:20;var armorBoost=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;Object(classCallCheck["a" /* default */])(this,Radiator);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Radiator).call(this,args,[new strategy_RequiresPowerSystemStrategy(1,false),new strategy_LargerHitProfileOnlineSystemStrategy(extraProfile,extraProfile,5),new strategy_RadiateHeatStrategy(radiationCapacity),new strategy_ArmorBoostOfflineSystemStrategy(armorBoost),new strategy_AlwaysTargetableSystemStrategy(2)]));}Object(createClass["a" /* default */])(Radiator,[{key:"getDisplayName",value:function getDisplayName(){return"Radiator";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/radiator.png";}},{key:"getIconText",value:function getIconText(){return"";}}]);return Radiator;}(system_ShipSystem);/* harmony default export */ var heat_Radiator = (Radiator_Radiator);
// CONCATENATED MODULE: ./src/model/unit/system/heat/HeatSink.mjs
var HeatSink_HeatSink=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(HeatSink,_ShipSystem);function HeatSink(args,heatStorage){Object(classCallCheck["a" /* default */])(this,HeatSink);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(HeatSink).call(this,args,[new strategy_StoreHeatStrategy(heatStorage)]));}Object(createClass["a" /* default */])(HeatSink,[{key:"getDisplayName",value:function getDisplayName(){return"Heat sink";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/heatSink.png";}},{key:"getIconText",value:function getIconText(){return"";}}]);return HeatSink;}(system_ShipSystem);/* harmony default export */ var heat_HeatSink = (HeatSink_HeatSink);
// CONCATENATED MODULE: ./src/model/unit/system/heat/Radiator5x40.mjs
var Radiator5x40_Radiator5x40=/*#__PURE__*/function(_Radiator){Object(inherits["a" /* default */])(Radiator5x40,_Radiator);function Radiator5x40(_ref){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,Radiator5x40);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Radiator5x40).call(this,{id:id,hitpoints:5,armor:0},10,10,5));}Object(createClass["a" /* default */])(Radiator5x40,[{key:"getDisplayName",value:function getDisplayName(){return"5x40m radiator sail";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/radiator.png";}}]);return Radiator5x40;}(heat_Radiator);/* harmony default export */ var heat_Radiator5x40 = (Radiator5x40_Radiator5x40);
// CONCATENATED MODULE: ./src/model/unit/system/heat/Radiator10x40.mjs
var Radiator10x40_Radiator10x40=/*#__PURE__*/function(_Radiator){Object(inherits["a" /* default */])(Radiator10x40,_Radiator);function Radiator10x40(_ref){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,Radiator10x40);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Radiator10x40).call(this,{id:id,hitpoints:10,armor:0},20,20,6));}Object(createClass["a" /* default */])(Radiator10x40,[{key:"getDisplayName",value:function getDisplayName(){return"10x40m radiator sail";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/radiator.png";}}]);return Radiator10x40;}(heat_Radiator);/* harmony default export */ var heat_Radiator10x40 = (Radiator10x40_Radiator10x40);
// CONCATENATED MODULE: ./src/model/unit/system/heat/Radiator10x50.mjs
var Radiator10x50_Radiator10x50=/*#__PURE__*/function(_Radiator){Object(inherits["a" /* default */])(Radiator10x50,_Radiator);function Radiator10x50(_ref){var id=_ref.id;Object(classCallCheck["a" /* default */])(this,Radiator10x50);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Radiator10x50).call(this,{id:id,hitpoints:12,armor:0},24,24,6));}Object(createClass["a" /* default */])(Radiator10x50,[{key:"getDisplayName",value:function getDisplayName(){return"10x50m radiator panels";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/radiator.png";}}]);return Radiator10x50;}(heat_Radiator);/* harmony default export */ var heat_Radiator10x50 = (Radiator10x50_Radiator10x50);
// CONCATENATED MODULE: ./src/model/unit/system/heat/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/cargo/CargoBay.mjs
var CargoBay_CargoBay=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(CargoBay,_ShipSystem);function CargoBay(args,space){Object(classCallCheck["a" /* default */])(this,CargoBay);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CargoBay).call(this,args,[new strategy_CargoBaySystemStrategy(space)]));}Object(createClass["a" /* default */])(CargoBay,[{key:"getDisplayName",value:function getDisplayName(){return"Cargo bay ".concat(this.callHandler("getTotalCargoSpace"),"m\xB3");}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/cargoBay.png";}}]);return CargoBay;}(system_ShipSystem);/* harmony default export */ var cargo_CargoBay = (CargoBay_CargoBay);
// CONCATENATED MODULE: ./src/model/unit/system/cargo/FuelTank.mjs
var FuelTank_FuelTank=/*#__PURE__*/function(_ShipSystem){Object(inherits["a" /* default */])(FuelTank,_ShipSystem);function FuelTank(args,space){Object(classCallCheck["a" /* default */])(this,FuelTank);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(FuelTank).call(this,args,[new strategy_FuelTankSystemStrategy(space)]));}Object(createClass["a" /* default */])(FuelTank,[{key:"getDisplayName",value:function getDisplayName(){return"Fuel tank ".concat(this.callHandler("getFuelSpace"),"m\xB3");}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/fuelTank.png";}}]);return FuelTank;}(system_ShipSystem);/* harmony default export */ var cargo_FuelTank = (FuelTank_FuelTank);
// CONCATENATED MODULE: ./src/model/unit/system/index.mjs
var system_merged=Object(objectSpread2["a" /* default */])({},thruster_namespaceObject,{},engine_namespaceObject,{},reactor_namespaceObject,{},structure_namespaceObject,{},electronicWarfare_namespaceObject,{},system_weapon,{},heat_namespaceObject,{CargoBay:cargo_CargoBay,FuelTank:cargo_FuelTank});/* harmony default export */ var unit_system = (system_merged);
// CONCATENATED MODULE: ./src/model/unit/ships/uc/UcRhino.mjs
var UcRhino_UcRhino=/*#__PURE__*/function(_Ship){Object(inherits["a" /* default */])(UcRhino,_Ship);function UcRhino(data){var _this;Object(classCallCheck["a" /* default */])(this,UcRhino);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(UcRhino).call(this,data));_this.shipTypeName='Conley Shipyards RX11 "Rhino"';_this.shipModel=_this.accelcost=3;_this.rollcost=3;_this.pivotcost=3;_this.evasioncost=3;_this.shipModel="Rhino";_this.pointCost=500;_this.systems.addFrontSystem([new unit_system.ManeuveringThruster({id:101,hitpoints:10,armor:3},3,2)]);_this.systems.addPrimarySystem([new unit_system.Thruster({id:1,hitpoints:10,armor:3},5,0),new unit_system.Thruster({id:2,hitpoints:10,armor:3},5,0),new unit_system.Thruster({id:8,hitpoints:10,armor:3},5,[1,2]),new unit_system.Thruster({id:9,hitpoints:10,armor:3},5,[4,5]),new unit_system.Thruster({id:3,hitpoints:10,armor:3},5,3),new unit_system.Thruster({id:4,hitpoints:10,armor:3},5,3),new unit_system.Engine({id:5,hitpoints:10,armor:3},12,6,2),new unit_system.Engine({id:6,hitpoints:10,armor:3},12,6,2),new unit_system.Reactor({id:7,hitpoints:10,armor:3},20),new unit_system.Structure({id:11,hitpoints:30,armor:4})]);_this.systems.addAftSystem([new unit_system.ManeuveringThruster({id:201,hitpoints:10,armor:3},3,2)]);return _this;}return UcRhino;}(unit_Ship);/* harmony default export */ var uc_UcRhino = (UcRhino_UcRhino);
// CONCATENATED MODULE: ./src/model/unit/ships/uc/Haka.mjs
var uc_Haka_Haka=/*#__PURE__*/function(_Ship){Object(inherits["a" /* default */])(Haka,_Ship);function Haka(){Object(classCallCheck["a" /* default */])(this,Haka);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Haka).apply(this,arguments));}Object(createClass["a" /* default */])(Haka,[{key:"setShipProperties",value:function setShipProperties(){this.shipTypeName="Haka XCD-33 Battleship";this.hexSizes=[new hexagon_Offset(2,0),new hexagon_Offset(1,0),new hexagon_Offset(0,0),new hexagon_Offset(-1,0)];this.accelcost=5;this.rollcost=12;this.pivotcost=10;this.evasioncost=10;this.frontHitProfile=60;this.sideHitProfile=80;this.description="";this.shipModel="Haka";this.pointCost=500;this.systems.addFrontSystem([new unit_system.ChemicalThruster({id:103,hitpoints:10,armor:3},15,0),new unit_system.RailgunTurreted140mmUC({id:118},{start:210,end:150}),new unit_system.RailgunTurreted140mmUC({id:119},{start:210,end:150}),new unit_system.ChemicalThruster({id:104,hitpoints:10,armor:3},15,0),new unit_system.PDC30mm({id:114,hitpoints:5,armor:3},{start:200,end:160}),new unit_system.PDC30mm({id:115,hitpoints:5,armor:3},{start:200,end:160}),new unit_system.PDC30mm({id:116,hitpoints:5,armor:3},{start:200,end:160}),new unit_system.PDC30mm({id:117,hitpoints:5,armor:3},{start:200,end:160}),new unit_system.EwArray({id:120,hitpoints:10,armor:5,boostable:false,heat:7,power:13,overheatTransferRatio:0.2},5),new unit_system.OEWArray({id:121,hitpoints:10,armor:5,boostable:false,heat:6,power:8,overheatTransferRatio:0.2},5),new unit_system.Structure({id:111,hitpoints:80,armor:4,cargoSpace:400,radiator:15})]);this.systems.addPrimarySystem([new unit_system.Reactor({id:7,hitpoints:10,armor:8},43),new unit_system.Reactor({id:5,hitpoints:10,armor:8},43),new unit_system.Structure({id:11,hitpoints:80,armor:6,cargoSpace:300,heatStorage:50}),new unit_system.EwArray({id:12,hitpoints:25,armor:6,heat:10},10),new unit_system.HeatSink({id:13,hitpoints:10,armor:3},100),new unit_system.HeatSink({id:14,hitpoints:10,armor:3},100)]);this.systems.addStarboardFrontSystem([new unit_system.ChemicalThruster({id:201,hitpoints:10,armor:3},5,[1,2]),new unit_system.ManeuveringThrusterRight({id:205,hitpoints:10,armor:3},10,0),new unit_system.RailgunTurreted2x140mm({id:202},{start:345,end:190}),new unit_system.TorpedoLauncherQuadruple158({id:210,hitpoints:15,armor:3}),new unit_system.TorpedoLauncherQuadruple158({id:211,hitpoints:15,armor:3}),new unit_system.TorpedoLauncherQuadruple158({id:212,hitpoints:15,armor:3}),new unit_system.TorpedoLauncherQuadruple158({id:213,hitpoints:15,armor:3})]);this.systems.addPortFrontSystem([new unit_system.Structure({id:600,hitpoints:60,armor:7,radiator:15}),new unit_system.ChemicalThruster({id:601,hitpoints:10,armor:3},5,[4,5]),new unit_system.MediumCoilgunTurretedUC({id:602},{start:165,end:0}),new unit_system.RailgunTurreted140mmUC({id:603},{start:195,end:3.75}),new unit_system.RailgunTurreted140mmUC({id:604},{start:195,end:3.75}),new unit_system.ManeuveringThrusterLeft({id:605,hitpoints:10,armor:3},10,0),new unit_system.MediumCoilgunTurretedUC({id:606},{start:190,end:15})]);this.systems.addAftSystem([new unit_system.Structure({id:411,hitpoints:80,armor:5,heatStorage:100,radiator:5,fuel:12000}),new unit_system.PDC30mm({id:450},{start:160,end:340}),new unit_system.Thruster({id:432,hitpoints:15,armor:3},15,3,{power:3,boostPower:2}),new unit_system.Thruster({id:433,hitpoints:15,armor:3},15,3,{power:3,boostPower:2}),new unit_system.PDC30mm({id:451},{start:40,end:200}),new unit_system.PDC30mm({id:452},{start:160,end:340}),new unit_system.PDC30mm({id:453},{start:160,end:340}),new unit_system.PDC30mm({id:456},{start:40,end:200}),new unit_system.PDC30mm({id:457},{start:40,end:200}),new unit_system.PDC30mm({id:454},{start:160,end:340}),new unit_system.PDC30mm({id:455},{start:40,end:200})]);this.systems.addPortAftSystem([new unit_system.Thruster({id:533,hitpoints:15,armor:3},15,3,{power:3,boostPower:2}),new unit_system.ManeuveringThrusterRight({id:501,hitpoints:10,armor:3},10,0),new unit_system.Radiator10x50({id:502}),new unit_system.Radiator10x50({id:503}),new unit_system.PDC30mm({id:550},{start:160,end:340}),new unit_system.PDC30mm({id:551},{start:160,end:340}),new unit_system.PDC30mm({id:554},{start:160,end:340}),new unit_system.PDC30mm({id:555},{start:160,end:340})]);this.systems.addStarboardAftSystem([new unit_system.ManeuveringThrusterLeft({id:305,hitpoints:10,armor:3},10,0),new unit_system.Thruster({id:333,hitpoints:15,armor:3},15,3,{power:3,boostPower:2}),new unit_system.Radiator10x50({id:301}),new unit_system.Radiator10x50({id:302}),new unit_system.PDC30mm({id:352},{start:40,end:200}),new unit_system.PDC30mm({id:353},{start:40,end:200}),new unit_system.PDC30mm({id:356},{start:40,end:200}),new unit_system.PDC30mm({id:357},{start:40,end:200})]);}},{key:"setShipLoadout",value:function setShipLoadout(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Haka.prototype),"setShipLoadout",this).call(this);var cargoService=new cargo_CargoService();cargoService.divideCargo(this,{object:new torpedo_Torpedo158MSV(),amount:24});cargoService.divideCargo(this,{object:new torpedo_Torpedo158MSV2(),amount:20});cargoService.divideCargo(this,{object:new torpedo_Torpedo158HE(),amount:36});cargoService.divideCargo(this,{object:new torpedo_Torpedo158Nuclear(),amount:6});cargoService.divideCargo(this,{object:new conventional_Ammo30mm(),amount:1700});cargoService.divideCargo(this,{object:new conventional_Ammo140mmAP(),amount:220});cargoService.divideCargo(this,{object:new conventional_Ammo140mmHE(),amount:550});var launchers=[this.systems.getSystemById(210),this.systems.getSystemById(211),this.systems.getSystemById(212),this.systems.getSystemById(213)];launchers.forEach(function(system){system.callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:1});system.callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:2});system.callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV2(),launcherIndex:3});system.callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158HE(),launcherIndex:4});});}}]);return Haka;}(unit_Ship);/* harmony default export */ var ships_uc_Haka = (uc_Haka_Haka);
// CONCATENATED MODULE: ./src/model/unit/ships/uc/index.mjs

// CONCATENATED MODULE: ./src/model/unit/ships/test/TestShip.mjs
var TestShip_TestShip=/*#__PURE__*/function(_Ship){Object(inherits["a" /* default */])(TestShip,_Ship);function TestShip(){Object(classCallCheck["a" /* default */])(this,TestShip);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TestShip).apply(this,arguments));}Object(createClass["a" /* default */])(TestShip,[{key:"setShipProperties",value:function setShipProperties(){this.accelcost=3;this.rollcost=3;this.pivotcost=3;this.evasioncost=3;this.frontHitProfile=100;this.sideHitProfile=100;this.pointCost=500;this.systems.addFrontSystem([new unit_system.OverPoweredTestWeapon({id:21,hitpoints:6,armor:2},[{start:270,end:90}]),new unit_system.TestWeapon({id:20,hitpoints:6,armor:2},[{start:0,end:180}]),new unit_system.RailgunTurreted2x140mm({id:101,hitpoints:6,armor:2},[{start:0,end:180}]),new unit_system.PDC30mm({id:102},[{start:0,end:0}]),new unit_system.PDC30mm({id:103},[{start:0,end:0}])]);this.systems.addPrimarySystem([new unit_system.Thruster({id:1,hitpoints:10,armor:3},5,0),new unit_system.Thruster({id:2,hitpoints:10,armor:3},5,0),new unit_system.Thruster({id:8,hitpoints:10,armor:3},5,[1,2]),new unit_system.Thruster({id:9,hitpoints:10,armor:3},5,[4,5]),new unit_system.Thruster({id:3,hitpoints:10,armor:3},15,3),new unit_system.Thruster({id:4,hitpoints:10,armor:3},15,3),new unit_system.ManeuveringThruster({id:10,hitpoints:10,armor:3},9,3),new unit_system.Engine({id:5,hitpoints:10,armor:3},12,6,2),new unit_system.Engine({id:6,hitpoints:10,armor:3},12,6,2),new unit_system.Reactor({id:7,hitpoints:20,armor:3},35),new unit_system.EwArray({id:11,hitpoints:10,armor:3},10),new unit_system.TorpedoLauncherDual158({id:202,hitpoints:20,armor:6}),new unit_system.TorpedoLauncherDual72({id:203,hitpoints:20,armor:6}),new unit_system.TorpedoLauncherDual72({id:206,hitpoints:20,armor:6}),new unit_system.CargoBay({id:204,hitpoints:20,armor:4},500),new unit_system.Structure({id:205,hitpoints:40,armor:5,heatStorage:200,radiator:5,fuel:4000})]);}},{key:"setShipLoadout",value:function setShipLoadout(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(TestShip.prototype),"setShipLoadout",this).call(this);this.systems.getSystemById(205).callHandler("setMaxFuel");var cargoBay=this.systems.getSystemById(204);cargoBay.callHandler("addCargo",{object:new torpedo_Torpedo158MSV(),amount:14});cargoBay.callHandler("addCargo",{object:new torpedo_Torpedo72MSV(),amount:14});this.systems.getSystemById(202).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:1});this.systems.getSystemById(202).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:2});this.systems.getSystemById(203).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72MSV(),launcherIndex:1});this.systems.getSystemById(203).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72MSV(),launcherIndex:2});this.systems.getSystemById(206).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72HE(),launcherIndex:1});this.systems.getSystemById(206).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72HE(),launcherIndex:2});return this;}}]);return TestShip;}(unit_Ship);/* harmony default export */ var test_TestShip = (TestShip_TestShip);
// CONCATENATED MODULE: ./src/model/unit/ships/test/index.mjs

// CONCATENATED MODULE: ./src/model/unit/ships/protectorate/Caliope.mjs
var protectorate_Caliope_Caliope=/*#__PURE__*/function(_Ship){Object(inherits["a" /* default */])(Caliope,_Ship);function Caliope(){Object(classCallCheck["a" /* default */])(this,Caliope);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Caliope).apply(this,arguments));}Object(createClass["a" /* default */])(Caliope,[{key:"setShipProperties",value:function setShipProperties(){this.shipTypeName="OuterLight Industries Caliope OI-E1 cruiser";this.hexSizes=[new hexagon_Offset(2,0),new hexagon_Offset(1,0),new hexagon_Offset(0,0),new hexagon_Offset(-1,0)];this.accelcost=3;this.rollcost=3;this.pivotcost=3;this.evasioncost=3;this.frontHitProfile=45;this.sideHitProfile=60;this.description="\n        Caliope cruiser was initially conceived with grandiose goals of including\n        battleship capabilities on cruiser tonnage class spaceframe. \n\n        First two Caliope A1 prototypes built by Patria Space were equipped with three Silverbreak 12 fusion engines,\n        two kinetic batteries, two light PDCs, three medium PDCs, two Hayfire 45MW railgun turrets and\n        eight 1.2m and two 3.5m missile tubes.  The spaceframes were built around and powered by \n        two Langban-Zukov class III fusion generators.\n\n        On field testing the new ships failed to meet the required specifications. The spaceframe turned out unable to\n        provide stable enough firing platform for the railgun turrets causing buildup of micro fractures\n        and resulting in subpar accuracy and reliability for the guns. Caliope was also found under armored for\n        fighting in the battleship class. \n\n        One of the prototypes where modified to Caliope A2 by substituting the railgun turrets with fixed mount railguns. \n        Filed testing of Caliope A2 showed the ship too unmanouverable to use the fixed railguns efficiently and this \n        modification failed to save the design.\n\n        Caliope project was abandoned as a failure, but subsequently aquired by OuterLight Industries when Patria Space \n        ran into finiancial difficulties. An experienced ship designed Markov Mohammed saw promise in the Caliope. \n\n        Caliope was repurposed to a long range cruiser by removing the railgun turrets. Freed space was used for extra\n        crew quarters, cargo and fuel space. The armor of the ship was reduced to gain much needed manouverability and\n        bring the spaceframe to safe structural stress levels. Abandoning the railguns left the ship with considerable\n        surplus of energy production and heat management capacity. This allowed the upgrade of the engines to more\n        powerful Silverbreak 15R model. Armament wise the new Caliope OI-B1 was equiped with four Maltech 210mm Twin kinetic\n        cannon turrets and seven 20mm Maltech PDCs. The missile launchers and magazines were left untouched.\n\n        These changes resulted in a ship considerably different from the initial design goals. First four Caliope OL-B3 cruisers\n        delivered to the Protectorate found great success in counter piracy role. Even tough Caliope is considered underarmored and\n        less than ideally manouverable for a mainstay cruiser, it can operate extended durations without resupply and it has an excellent\n        acceleration and heat management for extended chases. Perfect for running down pirates. Caliopes missile capabilities has\n        found use in fleet action as a missile picket ship. Caliopes engage in missile barrages but avoid close fighting. If \n        fleets close in, Caliopes are kept in reserve to chase down and finish damaged enemy vessels. Caliopes are also \n        suited to supplying smaller ships, altough more specialized ships can perform this role better.\n    ";this.shipModel="Caliope";this.pointCost=500;this.systems.addFrontSystem([new unit_system.ChemicalThruster({id:103,hitpoints:10,armor:3},15,0),new unit_system.PDC30mm({id:114,hitpoints:5,armor:3},{start:200,end:160}),new unit_system.PDC30mm({id:115,hitpoints:5,armor:3},{start:200,end:160}),new unit_system.ChemicalThruster({id:104,hitpoints:10,armor:3},15,0),new unit_system.Structure({id:111,hitpoints:40,armor:5,heatStorage:20,radiator:3}),new unit_system.ManeuveringThruster({id:101,hitpoints:10,armor:3},10,3)]);this.systems.addPrimarySystem([new unit_system.Reactor({id:7,hitpoints:10,armor:8},20),new unit_system.Structure({id:11,hitpoints:60,armor:4,cargoSpace:300,heatStorage:80,radiator:15,fuel:2000}),new unit_system.EwArray({id:12,hitpoints:15,armor:6},8),new unit_system.HeatSink({id:13,hitpoints:10,armor:3},100)]);this.systems.addStarboardFrontSystem([new unit_system.ChemicalThruster({id:201,hitpoints:10,armor:3},15,[1,2]),new unit_system.RailgunTurreted2x140mm({id:213,hitpoints:8,armor:4},{start:330,end:90}),new unit_system.PDC30mm({id:202,hitpoints:4,armor:3},{start:0,end:180}),new unit_system.AutoCannon85mm({id:203,hitpoints:6,armor:3},{start:330,end:160}),new unit_system.AutoCannon85mm({id:204,hitpoints:6,armor:3},{start:330,end:160})]);this.systems.addPortFrontSystem([new unit_system.RailgunTurreted2x140mm({id:612,hitpoints:8,armor:4},{start:270,end:30}),new unit_system.ChemicalThruster({id:601,hitpoints:10,armor:3},15,[4,5]),new unit_system.AutoCannon85mm({id:603,hitpoints:6,armor:3},{start:200,end:30}),new unit_system.PDC30mm({id:602,hitpoints:4,armor:3},{start:180,end:0}),new unit_system.AutoCannon85mm({id:604,hitpoints:6,armor:3},{start:200,end:30})]);this.systems.addAftSystem([new unit_system.ManeuveringThruster({id:401,hitpoints:10,armor:3},10,3),new unit_system.Thruster({id:431,hitpoints:15,armor:3},15,3),new unit_system.Thruster({id:432,hitpoints:15,armor:3},15,3),new unit_system.Thruster({id:433,hitpoints:15,armor:3},15,3),new unit_system.Structure({id:411,hitpoints:80,armor:4,heatStorage:100,radiator:5,fuel:4000}),new unit_system.Radiator10x40({id:412,hitpoints:10,armor:3}),new unit_system.Reactor({id:407,hitpoints:10,armor:3},30),new unit_system.AutoCannon85mm({id:421,hitpoints:6,armor:3},{start:0,end:0})]);this.systems.addPortAftSystem([new unit_system.Radiator10x40({id:501}),new unit_system.CargoBay({id:502,hitpoints:20,armor:4},150),new unit_system.TorpedoLauncher158({id:503,hitpoints:10,armor:4}),new unit_system.TorpedoLauncherDual72({id:504,hitpoints:10,armor:4}),new unit_system.AutoCannon85mm({id:521,hitpoints:6,armor:3},{start:160,end:30})]);this.systems.addStarboardAftSystem([new unit_system.Radiator10x40({id:301}),new unit_system.CargoBay({id:302,hitpoints:20,armor:4},150),new unit_system.TorpedoLauncher158({id:303,hitpoints:10,armor:4}),new unit_system.TorpedoLauncherDual72({id:304,hitpoints:10,armor:4}),new unit_system.AutoCannon85mm({id:321,hitpoints:6,armor:3},{start:330,end:200})]);}},{key:"setShipLoadout",value:function setShipLoadout(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Caliope.prototype),"setShipLoadout",this).call(this);var cargoService=new cargo_CargoService();cargoService.divideCargo(this,{object:new torpedo_Torpedo72MSV(),amount:12});cargoService.divideCargo(this,{object:new torpedo_Torpedo72HE(),amount:12});cargoService.divideCargo(this,{object:new torpedo_Torpedo158MSV(),amount:12});cargoService.divideCargo(this,{object:new torpedo_Torpedo158Nuclear(),amount:2});cargoService.divideCargo(this,{object:new conventional_Ammo30mm(),amount:800});cargoService.divideCargo(this,{object:new conventional_Ammo140mmAP(),amount:40});cargoService.divideCargo(this,{object:new conventional_Ammo140mmHE(),amount:80});cargoService.divideCargo(this,{object:new conventional_Ammo85mmAP(),amount:200});cargoService.divideCargo(this,{object:new conventional_Ammo85mmHE(),amount:400});this.systems.getSystemById(303).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:1});this.systems.getSystemById(503).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:1});this.systems.getSystemById(304).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72MSV(),launcherIndex:1});this.systems.getSystemById(304).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72HE(),launcherIndex:2});this.systems.getSystemById(504).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72MSV(),launcherIndex:1});this.systems.getSystemById(504).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72HE(),launcherIndex:2});}}]);return Caliope;}(unit_Ship);/* harmony default export */ var ships_protectorate_Caliope = (protectorate_Caliope_Caliope);
// CONCATENATED MODULE: ./src/model/unit/ships/protectorate/Mouros.mjs
var protectorate_Mouros_Mouros=/*#__PURE__*/function(_Ship){Object(inherits["a" /* default */])(Mouros,_Ship);function Mouros(){Object(classCallCheck["a" /* default */])(this,Mouros);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Mouros).apply(this,arguments));}Object(createClass["a" /* default */])(Mouros,[{key:"setShipProperties",value:function setShipProperties(){this.shipTypeName="OuterLight Industries Mouros 118-A mainstay battleship";this.accelcost=3;this.rollcost=3;this.pivotcost=3;this.evasioncost=3;this.hexSizes=[new hexagon_Offset(-2,0),new hexagon_Offset(-1,0),new hexagon_Offset(0,0),new hexagon_Offset(1,0),new hexagon_Offset(2,0),new hexagon_Offset(3,0)/*
      new Offset(1, 1),
      new Offset(2, 1),
      new Offset(1, -1),
      new Offset(2, -1),
      new Offset(-1, 1),
      new Offset(-0, 1),
      new Offset(-1, -1),
      new Offset(-0, -1)
      */];this.description="";this.shipModel="Mouros";this.pointCost=500;this.systems.addFrontSystem([new unit_system.ManeuveringThruster({id:101,hitpoints:10,armor:3},3,2),new unit_system.Structure({id:102,hitpoints:40,armor:6})]);this.systems.addPrimarySystem([new unit_system.Thruster({id:1,hitpoints:10,armor:3},5,0),new unit_system.Thruster({id:2,hitpoints:10,armor:3},5,0),new unit_system.EwArray({id:12,hitpoints:30,armor:4},8),new unit_system.Engine({id:5,hitpoints:10,armor:7},10,6,2),new unit_system.Reactor({id:7,hitpoints:10,armor:3},20),new unit_system.Structure({id:11,hitpoints:50,armor:5})]);this.systems.addAftSystem([new unit_system.ManeuveringThruster({id:201,hitpoints:10,armor:3},3,2),new unit_system.Engine({id:206,hitpoints:20,armor:7},15,6,2),new unit_system.Thruster({id:203,hitpoints:10,armor:3},5,3),new unit_system.Thruster({id:204,hitpoints:10,armor:3},5,3),new unit_system.Structure({id:202,hitpoints:80,armor:4})]);this.systems.addStarboardAftSystem([new coilgun_RailgunTurreted32gw({id:301,hitpoints:10,armor:3},{start:0,end:183}),new unit_system.Thruster({id:308,hitpoints:10,armor:3},5,[1,2])]);this.systems.addPortAftSystem([new coilgun_RailgunTurreted32gw({id:501,hitpoints:10,armor:3},{start:177,end:0}),new unit_system.Thruster({id:508,hitpoints:10,armor:3},5,[4,5])]);}}]);return Mouros;}(unit_Ship);/* harmony default export */ var ships_protectorate_Mouros = (protectorate_Mouros_Mouros);
// CONCATENATED MODULE: ./src/model/unit/ships/protectorate/Fulcrum.mjs
var protectorate_Fulcrum_Fulcrum=/*#__PURE__*/function(_Ship){Object(inherits["a" /* default */])(Fulcrum,_Ship);function Fulcrum(){Object(classCallCheck["a" /* default */])(this,Fulcrum);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Fulcrum).apply(this,arguments));}Object(createClass["a" /* default */])(Fulcrum,[{key:"setShipProperties",value:function setShipProperties(){this.shipTypeName="Arakaki Systems Fulcrum IV fleet destroyer";this.accelcost=2;this.rollcost=4;this.pivotcost=2;this.evasioncost=2;this.hexSizes=[new hexagon_Offset(1,0),new hexagon_Offset(0,0),new hexagon_Offset(-1,0)];this.description="\n       Fulcrum was ordered to fill the role of a fleet destroyer. A ship that packs enough of a punch in \n       sufficiently armored frame to engage in front line fleet combat. The design requirements allowed\n       a considerable defieciency in endurance making the Fulcrum a ship that needs a supporting fleet\n       to operate in a meaningful role on a modern battlefield. \n\n       Arakaki Systems won the contract with the Fulcrum design. Fulcrum sacrifices endurance, \n       heat management and some speed to bring on a battlefield a destroyed armed with a spinal\n       mounted railgun, three kinetic cannons on a fixed bow mount, considerable six light PDCs \n       and a two missile launchers. All this in well armored spaceframe. \n\n       A squadron of Fulcrums can turn a battle if employed properly, but their role and \n       commitment must be well planned. A Fulcrum can function in a role of escort, rail gun attack craft\n       or close attack craft, but lack the endurance and heat management to keep up sustained railgun fire\n       or the manouvers needed in close quarters. This forces Fulcrums to disengage under fleet\n       protection to extends radiators or in extreme cases to resupply fuel and ammunition.\n\n       While the Fulcrum has a considerable PDC grid its missile capacity is greatly lacking for anything\n       else than defense or employment against unarmed or disabled targets. Fulcrums are also considered\n       undercrewed by many fleet standards. In combat operations the crew must work and live in cramped \n       conditions in extended shifts. Crew compliment does not include any marines, and the ship \n       deck plan is not optimized for repeling boarders, nor does it have any capacity for holding prisoners.\n\n       Regardless of this long list of deficiencies, a Fulcrum can employ a combination of superior\n       weaponry and manouverability to create an engagement where Fulcrum can effectively either \n       out range or out gun its opponent. In close quarter battle a Fulcrum can engage an opponent\n       and with superior armor still disengage with neglible damage to critical systems.\n    ";this.shipModel="Fulcrum";this.pointCost=500;this.systems.addFrontSystem([new unit_system.Structure({id:100,hitpoints:30,armor:5,heatStorage:30,radiator:5}),new unit_system.CoilgunLightFixed({id:102},{start:330,end:30}),new unit_system.RailgunFixed120mm({id:103},{start:330,end:30}),new unit_system.RailgunFixed120mm({id:104},{start:330,end:30}),new unit_system.RailgunFixed120mm({id:105},{start:330,end:30}),new unit_system.ChemicalThruster({id:106,hitpoints:10,armor:3},10,0),new unit_system.ChemicalThruster({id:107,hitpoints:10,armor:3},10,0),new unit_system.ManeuveringThruster({id:101,hitpoints:10,armor:3},10,2),new unit_system.TorpedoLauncherDual72({id:108,hitpoints:10,armor:4})]);this.systems.addPrimarySystem([new unit_system.EwArray({id:12,hitpoints:12,armor:6,boostPower:5},7),new unit_system.Reactor({id:7,hitpoints:15,armor:7},35),new unit_system.Structure({id:11,hitpoints:30,armor:6,cargoSpace:100,heatStorage:70,radiator:5}),new unit_system.PDC30mm({id:14,alwaysTargetable:true},{start:0,end:0})]);this.systems.addAftSystem([new unit_system.Structure({id:200,hitpoints:40,armor:6,heatStorage:20,radiator:10,fuel:2000}),new unit_system.ManeuveringThruster({id:201,hitpoints:10,armor:3},10,2),new unit_system.Thruster({id:203,hitpoints:20,armor:3},15,3,{power:2,boostPower:1,maxBoost:10}),new unit_system.PDC30mm({id:214,alwaysTargetable:true},{start:0,end:0}),new unit_system.Radiator5x40({id:316}),new unit_system.CargoBay({id:317,hitpoints:10,armor:4},100)]);this.systems.addStarboardFrontSystem([new unit_system.PDC30mm({id:15,hitpoints:5,armor:3},{start:0,end:180})]);this.systems.addStarboardAftSystem([new unit_system.PDC30mm({id:215,hitpoints:5,armor:3},{start:0,end:180}),new unit_system.Radiator5x40({id:216})]);this.systems.addPortFrontSystem([new unit_system.PDC30mm({id:13,hitpoints:5,armor:3},{start:180,end:0})]);this.systems.addPortAftSystem([new unit_system.PDC30mm({id:213,hitpoints:5,armor:3},{start:180,end:0}),new unit_system.Radiator5x40({id:416})]);}},{key:"setShipLoadout",value:function setShipLoadout(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Fulcrum.prototype),"setShipLoadout",this).call(this);var cargoService=new cargo_CargoService();cargoService.divideCargo(this,{object:new torpedo_Torpedo72MSV(),amount:12});cargoService.divideCargo(this,{object:new conventional_Ammo30mm(),amount:120});cargoService.divideCargo(this,{object:new conventional_Ammo120mmAP(),amount:20});cargoService.divideCargo(this,{object:new conventional_Ammo120mmHE(),amount:20});this.systems.getSystemById(108).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72MSV(),launcherIndex:1});this.systems.getSystemById(108).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo72MSV(),launcherIndex:2});}}]);return Fulcrum;}(unit_Ship);/* harmony default export */ var ships_protectorate_Fulcrum = (protectorate_Fulcrum_Fulcrum);
// CONCATENATED MODULE: ./src/model/unit/ships/protectorate/index.mjs

// CONCATENATED MODULE: ./src/model/unit/system/weapon/pdc/X2PDC30mm.mjs
var X2PDC30mm_X2PDC30mm=/*#__PURE__*/function(_Weapon){Object(inherits["a" /* default */])(X2PDC30mm,_Weapon);function X2PDC30mm(args,arcs){Object(classCallCheck["a" /* default */])(this,X2PDC30mm);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(X2PDC30mm).call(this,args,[new strategy_RequiresPowerSystemStrategy(2),new weapon_FireOrderStrategy(2),new weapon_WeaponArcStrategy(arcs),new weapon_StandardHitStrategy(30),new weapon_StandardRangeStrategy([{range:0,modifier:0},{range:Math.round(MEDIUM_WEAPON_RANGE*0.3),modifier:-20},{range:Math.round(MEDIUM_WEAPON_RANGE*0.5),modifier:-50},{range:Math.round(MEDIUM_WEAPON_RANGE*0.6),modifier:-100},{range:Math.round(MEDIUM_WEAPON_RANGE*0.8),modifier:-200}]),new weapon_StandardLoadingStrategy(1),new weapon_BurstDamageStrategy("d2","d3+2",0,6,5),new weapon_InterceptorStrategy(2),new weapon_AmmunitionStrategy([conventional_Ammo30mm],6,36,12),new weapon_WeaponAnimationStrategy("UniversalBolt",{size:6,speed:0.35,color:[1.0,0.8,0.4],shots:6})]));}Object(createClass["a" /* default */])(X2PDC30mm,[{key:"getDisplayName",value:function getDisplayName(){return"2x30mm PDC";}},{key:"getBackgroundImage",value:function getBackgroundImage(){return"/img/system/gatlingPulseCannon.png";}}]);return X2PDC30mm;}(weapon_Weapon);/* harmony default export */ var pdc_X2PDC30mm = (X2PDC30mm_X2PDC30mm);
// CONCATENATED MODULE: ./src/model/unit/system/weapon/pdc/index.mjs

// CONCATENATED MODULE: ./src/model/unit/ships/federation/Impetous.mjs
var federation_Impetous_Impetous=/*#__PURE__*/function(_Ship){Object(inherits["a" /* default */])(Impetous,_Ship);function Impetous(){Object(classCallCheck["a" /* default */])(this,Impetous);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Impetous).apply(this,arguments));}Object(createClass["a" /* default */])(Impetous,[{key:"setShipProperties",value:function setShipProperties(){this.shipTypeName="Impetous";this.accelcost=3;this.rollcost=3;this.pivotcost=3;this.evasioncost=3;this.hexSizes=[new hexagon_Offset(3,0),new hexagon_Offset(2,0),new hexagon_Offset(1,0),new hexagon_Offset(0,0),new hexagon_Offset(-1,0),new hexagon_Offset(-2,0),new hexagon_Offset(-3,0),new hexagon_Offset(-4,0),new hexagon_Offset(3,1),new hexagon_Offset(2,1),new hexagon_Offset(1,1),new hexagon_Offset(0,1),new hexagon_Offset(-1,1),new hexagon_Offset(-2,1),new hexagon_Offset(-3,1),new hexagon_Offset(3,-1),new hexagon_Offset(2,-1),new hexagon_Offset(1,-1),new hexagon_Offset(0,-1),new hexagon_Offset(-1,-1),new hexagon_Offset(-2,-1),new hexagon_Offset(-3,-1)];this.description="";this.shipModel="Impetous";this.pointCost=500;this.systems.addFrontSystem([new unit_system.ManeuveringThruster({id:1,hitpoints:10,armor:3},3,2),new unit_system.Structure({id:100,hitpoints:90,armor:5})]);this.systems.addPrimarySystem([new unit_system.Thruster({id:601,hitpoints:10,armor:3},5,0),new unit_system.Thruster({id:602,hitpoints:10,armor:3},5,0),new unit_system.Thruster({id:603,hitpoints:10,armor:3},5,3),new unit_system.Thruster({id:604,hitpoints:10,armor:3},5,3),new unit_system.EwArray({id:612,hitpoints:30,armor:4},8),new unit_system.Engine({id:605,hitpoints:10,armor:3},12,6,2),new unit_system.Engine({id:606,hitpoints:10,armor:3},12,6,2),new unit_system.Reactor({id:607,hitpoints:10,armor:3},20),new unit_system.Structure({id:611,hitpoints:75,armor:6}),new coilgun_RailgunTurreted64gw({id:613,hitpoints:20,armor:3},[{start:30,end:150},{start:210,end:330}]),new coilgun_RailgunTurreted64gw({id:614,hitpoints:20,armor:3},[{start:30,end:150},{start:210,end:330}])]);this.systems.addAftSystem([new unit_system.ManeuveringThruster({id:201,hitpoints:10,armor:3},3,2),new unit_system.TorpedoLauncherDual158({id:202,hitpoints:20,armor:6}),new unit_system.TorpedoLauncherDual158({id:203,hitpoints:20,armor:6}),new unit_system.CargoBay({id:204,hitpoints:20,armor:4},500),new unit_system.Structure({id:200,hitpoints:90,armor:5})]);this.systems.addStarboardFrontSystem([new pdc_X2PDC30mm({id:101,hitpoints:5,armor:3},{start:0,end:180}),new pdc_X2PDC30mm({id:102,hitpoints:5,armor:3},{start:0,end:180}),new pdc_X2PDC30mm({id:103,hitpoints:5,armor:3},{start:0,end:180}),new unit_system.Thruster({id:104,hitpoints:10,armor:3},5,[1,2])]);this.systems.addPortFrontSystem([new pdc_X2PDC30mm({id:501,hitpoints:5,armor:3},{start:180,end:0}),new pdc_X2PDC30mm({id:502,hitpoints:5,armor:3},{start:180,end:0}),new pdc_X2PDC30mm({id:503,hitpoints:5,armor:3},{start:180,end:0}),new unit_system.Thruster({id:504,hitpoints:10,armor:3},5,[4,5])]);}},{key:"setShipLoadout",value:function setShipLoadout(){Object(get["a" /* default */])(Object(getPrototypeOf["a" /* default */])(Impetous.prototype),"setShipLoadout",this).call(this);var cargoBay=this.systems.getSystemById(204);cargoBay.callHandler("addCargo",{object:new torpedo_Torpedo158MSV(),amount:14});cargoBay.callHandler("addCargo",{object:new torpedo_Torpedo158Nuclear(),amount:2});this.systems.getSystemById(202).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:1});this.systems.getSystemById(202).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:2});this.systems.getSystemById(203).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:1});this.systems.getSystemById(203).callHandler("loadAmmoInstant",{ammo:new torpedo_Torpedo158MSV(),launcherIndex:2});}}]);return Impetous;}(unit_Ship);/* harmony default export */ var ships_federation_Impetous = (federation_Impetous_Impetous);
// CONCATENATED MODULE: ./src/model/unit/ships/federation/index.mjs

// CONCATENATED MODULE: ./src/model/unit/ships/index.mjs
var ships_merged=Object(objectSpread2["a" /* default */])({},uc_namespaceObject,{},protectorate_namespaceObject,{},test_namespaceObject,{},federation_namespaceObject);/* harmony default export */ var unit_ships = (ships_merged);
// CONCATENATED MODULE: ./src/model/unit/createShipObject.mjs
var createShipObject_createShipObject=function createShipObject(data){var shipClass=data.shipClass;if(!shipClass){throw new Error("Ship class missing, can not construct a ship");}try{return new unit_ships[shipClass](data);}catch(e){console.error("Unable to construct ship of class \"".concat(shipClass,"\""));throw e;}};var createShipObject_createBareShipObject=function createBareShipObject(data){var shipClass=data.shipClass;if(!shipClass){throw new Error("Ship class missing, can not construct a ship");}try{return new unit_ships[shipClass]();}catch(e){console.error("Unable to construct plain ship of class \"".concat(shipClass,"\""));throw e;}};
// CONCATENATED MODULE: ./src/model/game/GameShips.mjs
var GameShips_GameShips=/*#__PURE__*/function(){function GameShips(gameData){Object(classCallCheck["a" /* default */])(this,GameShips);this.gameData=gameData;this.ships=[];}Object(createClass["a" /* default */])(GameShips,[{key:"isSameTeam",value:function isSameTeam(shipA,shipB){return this.gameData.slots.getTeamForShip(shipA)===this.gameData.slots.getTeamForShip(shipB);}},{key:"addShip",value:function addShip(ship){if(ship.id&&this.getShipById(ship.id)){throw new Error("Duplicate ship id added to gamedata");}this.ships.push(ship);return this;}},{key:"getShips",value:function getShips(){return this.ships;}},{key:"getAliveShips",value:function getAliveShips(){return this.ships.filter(function(ship){return!ship.isDestroyed();});}},{key:"getShipById",value:function getShipById(id){return this.ships.find(function(ship){return ship.id===id;});}},{key:"getUsersShips",value:function getUsersShips(user){return this.ships.filter(function(ship){return ship.player.isUsers(user)&&!ship.isDestroyed();});}},{key:"getShipsInSameTeam",value:function getShipsInSameTeam(user){var _this=this;var slot=this.gameData.slots.getUsersSlots(user);if(!slot||slot.length===0){return[];}var team=slot.pop().team;return this.ships.filter(function(ship){return _this.gameData.slots.getSlotByShip(ship).team===team&&!ship.isDestroyed();});}},{key:"getShipsEnemyTeams",value:function getShipsEnemyTeams(user){var teamShips=this.getShipsInSameTeam(user);return this.ships.filter(function(ship){return!teamShips.includes(ship)&&!ship.isDestroyed();});}},{key:"serialize",value:function serialize(){return this.ships.map(function(ship){return ship.serialize();});}},{key:"deserialize",value:function deserialize(){var ships=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.ships=ships.map(function(shipData){return createShipObject_createShipObject(shipData);});return this;}},{key:"setShipLoadouts",value:function setShipLoadouts(){this.getShips().forEach(function(ship){return ship.setShipLoadout();});}}]);return GameShips;}();/* harmony default export */ var game_GameShips = (GameShips_GameShips);
// CONCATENATED MODULE: ./src/model/game/GameActiveShips.mjs
var GameActiveShips_GameActiveShips=/*#__PURE__*/function(){function GameActiveShips(gameData){Object(classCallCheck["a" /* default */])(this,GameActiveShips);this.gameData=gameData;this.shipIds=[];}Object(createClass["a" /* default */])(GameActiveShips,[{key:"isActive",value:function isActive(ship){return this.shipIds.includes(ship.id);}},{key:"setActive",value:function setActive(ship){if(this.isActive(ship)){return;}this.shipIds.push(ship.id);}},{key:"setInactive",value:function setInactive(ship){this.shipIds=this.shipIds.filter(function(id){return id!==ship.id;});}},{key:"serialize",value:function serialize(){return this.shipIds;}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.shipIds=data;return this;}}]);return GameActiveShips;}();/* harmony default export */ var game_GameActiveShips = (GameActiveShips_GameActiveShips);
// CONCATENATED MODULE: ./src/model/game/GameTerrainEntity.mjs
var TERRAIN_TYPE_SUN="sun";var GameTerrainEntity_GameTerrainEntity=/*#__PURE__*/function(){function GameTerrainEntity(data){Object(classCallCheck["a" /* default */])(this,GameTerrainEntity);this.deserialize(data);}Object(createClass["a" /* default */])(GameTerrainEntity,[{key:"getGravityVector",value:function getGravityVector(position){var distance=position.distanceTo(this.position);var actualGravity=this.gravity/Math.pow(distance,2);var gravityVector=this.position.sub(position).normalize().multiplyScalar(actualGravity);return gravityVector;}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.id=data.id||null;this.type=data.type||TERRAIN_TYPE_SUN;this.mass=10000000000;// data.mass || 1000000000;
this.position=new utils_Vector(data.position);this.velocity=new utils_Vector(data.velocity);this.diameter=7;// data.diameter || 1;
this.radius=this.affectedByGravity=this.type!==TERRAIN_TYPE_SUN;return this;}},{key:"serialize",value:function serialize(){return{id:this.id,type:this.type,position:this.position,velocity:this.velocity,radius:this.diameter,mass:this.mass};}}]);return GameTerrainEntity;}();/* harmony default export */ var game_GameTerrainEntity = (GameTerrainEntity_GameTerrainEntity);
// CONCATENATED MODULE: ./src/model/utils/ARKStep.mjs
var ARKStep_a=[[0,0,0,0,0],[1/4,0,0,0,0],[3/32,9/32,0,0,0],[1932/2197,-7200/2197,7296/2197,0,0],[439/216,-8,3680/513,-845/4104,0],[-8/27,2,-3544/2565,1859/4104,-11/40]];var bs=[16/135,0,6656/12825,28561/56430,-9/50,2/55];var bsx=[25/216,0,1408/2565,2197/4104,-1/5,0];var getCacheKey=function getCacheKey(stage,arkFunction){return arkFunction+stage;};var ARKStep_ARKStep=/*#__PURE__*/function(){function ARKStep(position,velocity,parentPosition,parentMass,dt){Object(classCallCheck["a" /* default */])(this,ARKStep);this.setValues(position,velocity,parentPosition,parentMass,dt);}Object(createClass["a" /* default */])(ARKStep,[{key:"derivativeVelocityX",value:function derivativeVelocityX(position){var r=this.parentPosition.sub(position);return this.parentMass/Math.pow(r.length(),3)*r.x;}},{key:"derivativeVelocityY",value:function derivativeVelocityY(position){var r=this.parentPosition.sub(position);return this.parentMass/Math.pow(r.length(),3)*r.y;}},{key:"sum",value:function sum(stage,f){var total=0;for(var i=0;i<stage;i++){total+=ARKStep_a[stage][i]*this.k(i,f);}return total;}},{key:"kx",value:function kx(stage){return this.dt*(this.velocity.x+this.sum(stage,"vx"));}},{key:"ky",value:function ky(stage){return this.dt*(this.velocity.y+this.sum(stage,"vy"));}},{key:"kvx",value:function kvx(stage){return this.dt*this.derivativeVelocityX(new utils_Vector(this.position.x+this.sum(stage,"x"),this.position.y+this.sum(stage,"y")));}},{key:"kvy",value:function kvy(stage){return this.dt*this.derivativeVelocityY(new utils_Vector(this.position.x+this.sum(stage,"x"),this.position.y+this.sum(stage,"y")));}},{key:"k",value:function k(stage,f){var cached=this.findCached(stage,f);if(cached!==null){this.cacheHit++;return cached;}this.cacheMiss++;var result=null;switch(f){case"x":result=this.kx(stage);break;case"y":result=this.ky(stage);break;case"vx":result=this.kvx(stage);break;case"vy":result=this.kvy(stage);break;}this.setCache(stage,f,result);return result;}},{key:"findCached",value:function findCached(stage,f){var key=getCacheKey(stage,f);return this.cache[key]!==undefined?this.cache[key]:null;}},{key:"setCache",value:function setCache(stage,f,result){var key=getCacheKey(stage,f);this.cache[key]=result;}},{key:"setValues",value:function setValues(position,velocity,parentPosition,parentMass,dt){this.position=position;this.velocity=velocity;this.parentPosition=parentPosition;this.parentMass=parentMass;this.dt=dt;this.cache={};this.cacheHit=0;this.cacheMiss=0;return this;}},{key:"getAllKs",value:function getAllKs(f){var result=[];for(var i=0;i<6;i++){result[i]=this.k(i,f);}return result;}},{key:"weightedSum",value:function weightedSum(values,k){return values.map(function(value,i){return value*k[i];}).reduce(function(accumulator,current){return accumulator+current;},0);}},{key:"subVectors",value:function subVectors(a,b){return a.map(function(valueA,i){return valueA-b[i];});}},{key:"calculate",value:function calculate(){var ks={x:this.getAllKs("x"),y:this.getAllKs("y"),vx:this.getAllKs("vx"),vy:this.getAllKs("vy")};var dPosition=new utils_Vector(this.weightedSum(bs,ks.x),this.weightedSum(bs,ks.y));var dVelocity=new utils_Vector(this.weightedSum(bs,ks.vx),this.weightedSum(bs,ks.vy));var error=new three.Vector4(this.weightedSum(this.subVectors(bs,bsx),ks.x),this.weightedSum(this.subVectors(bs,bsx),ks.y),this.weightedSum(this.subVectors(bs,bsx),ks.vx),this.weightedSum(this.subVectors(bs,bsx),ks.vy)).length();return{dPosition:dPosition,dVelocity:dVelocity,error:error};}},{key:"reportCache",value:function reportCache(){console.log("total:",this.cacheHit+this.cacheMiss,"hit ratio:",this.cacheHit/(this.cacheHit+this.cacheMiss),"hit:",this.cacheHit,"miss:",this.cacheMiss);}}]);return ARKStep;}();/* harmony default export */ var utils_ARKStep = (ARKStep_ARKStep);
// CONCATENATED MODULE: ./src/model/utils/ARK.mjs
var arkStep=new utils_ARKStep();var MAX_ERROR=0.001;var MIN_ERROR=MAX_ERROR/100;var ARK_ARK=/*#__PURE__*/function(){function ARK(gameTerrain){Object(classCallCheck["a" /* default */])(this,ARK);this.gameTerrain=gameTerrain;}Object(createClass["a" /* default */])(ARK,[{key:"calculateNewPositionVelocity",value:function calculateNewPositionVelocity(position,velocity,turn){var dt=0.1;var currentTime=0;var positions=[position.clone()];/*
    console.log(
      "startPosition",
      position.toString(),
      "startVelocity",
      velocity.toString()
    );
*/var parent=this.gameTerrain.getParentEntity(position,turn);if(!parent){var endPosition=position.add(velocity);positions.push(endPosition);return{position:endPosition,velocity:velocity,positions:positions,collision:false};}var parentMass=parent.mass;var parentPosition=parent.position;while(currentTime<1&&dt<=1){if(parent&&parentPosition.distanceTo(position)<100){positions.push(parentPosition.clone());return{position:parentPosition.clone(),velocity:new utils_Vector(0,0),positions:positions,collision:true};}var _arkStep$setValues$ca=arkStep.setValues(position,velocity,parentPosition,parentMass,dt).calculate(),dPosition=_arkStep$setValues$ca.dPosition,dVelocity=_arkStep$setValues$ca.dVelocity,error=_arkStep$setValues$ca.error;//console.log("dt", dt, "currentTime", currentTime);
if(error>MAX_ERROR){dt=dt*0.5;continue;}else if(error<MIN_ERROR){dt=dt*2;continue;}else if(currentTime+dt>1){break;}else{position=position.add(dPosition);velocity=velocity.add(dVelocity);positions.push(position.clone());//console.log("step", position.toString(), "delta time", dt);
currentTime+=dt;}}dt=1-currentTime;currentTime=1;var _arkStep$setValues$ca2=arkStep.setValues(position,velocity,parentPosition,parentMass,dt).calculate(),fDPosition=_arkStep$setValues$ca2.dPosition,fDVelocity=_arkStep$setValues$ca2.dVelocity;position=position.add(fDPosition);velocity=velocity.add(fDVelocity);positions.push(position.clone());/*
    console.log(currentTime);

    console.log(
      "endPosition",
      position.toString(),
      "endVelocity",
      velocity.toString()
    );
    */return{position:position,velocity:velocity,positions:positions,collision:false};}}]);return ARK;}();/* harmony default export */ var utils_ARK = (ARK_ARK);
// CONCATENATED MODULE: ./src/model/game/GameTerrain.mjs
var GameTerrain_GameTerrain=/*#__PURE__*/function(){function GameTerrain(gameData){Object(classCallCheck["a" /* default */])(this,GameTerrain);this.gameData=gameData;this.entities=[];this.ark=new utils_ARK(this);}Object(createClass["a" /* default */])(GameTerrain,[{key:"getEntities",value:function getEntities(){return this.entities;}},{key:"addEntity",value:function addEntity(entity){this.entities.push(entity);}},{key:"getGravityVectorForTurn",value:function getGravityVectorForTurn(position,velocity,turn){return this.ark.calculateNewPositionVelocity(position,velocity,turn);}},{key:"getParentEntity",value:function getParentEntity(position,time,turn){return this.entities[0];}},{key:"serialize",value:function serialize(){return this.entities.map(function(entity){return entity.serialize();});}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.entities=data.map(function(entry){return new game_GameTerrainEntity(entry);});return this;}}]);return GameTerrain;}();/* harmony default export */ var game_GameTerrain = (GameTerrain_GameTerrain);
// CONCATENATED MODULE: ./src/model/game/GameTorpedos.mjs
var GameTorpedos_GameTorpedos=/*#__PURE__*/function(){function GameTorpedos(){Object(classCallCheck["a" /* default */])(this,GameTorpedos);this.flights=[];}Object(createClass["a" /* default */])(GameTorpedos,[{key:"getTorpedoFlightById",value:function getTorpedoFlightById(id){return this.flights.find(function(flight){return flight.id===id;});}},{key:"addTorpedoFlights",value:function addTorpedoFlights(flights){flights=[].concat(flights);this.flights=[].concat(Object(toConsumableArray["a" /* default */])(this.flights),Object(toConsumableArray["a" /* default */])(flights));}},{key:"getTorpedoFlights",value:function getTorpedoFlights(){return Object(toConsumableArray["a" /* default */])(this.flights);}},{key:"serialize",value:function serialize(){return{flights:this.flights.map(function(flight){return flight.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{flights:[]};this.flights=data.flights.map(function(flight){return new unit_TorpedoFlight().deserialize(flight);});return this;}},{key:"advanceTurn",value:function advanceTurn(){this.flights=this.flights.filter(function(flight){return!flight.isDone();});}}]);return GameTorpedos;}();/* harmony default export */ var game_GameTorpedos = (GameTorpedos_GameTorpedos);
// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js
var defineProperty = __webpack_require__(16);

// CONCATENATED MODULE: ./src/model/combatLog/CombatLogTorpedoIntercept.mjs
var CombatLogTorpedoIntercept_CombatLogTorpedoIntercept=/*#__PURE__*/function(){function CombatLogTorpedoIntercept(torpedoFlightId,shipId,weaponId,interceptChange,roll){Object(classCallCheck["a" /* default */])(this,CombatLogTorpedoIntercept);this.torpedoFlightId=torpedoFlightId;this.shipId=shipId;this.weaponId=weaponId;this.interceptChange=interceptChange;this.roll=roll;}Object(createClass["a" /* default */])(CombatLogTorpedoIntercept,[{key:"isSucessfull",value:function isSucessfull(){return this.roll<=this.interceptChange.result;}},{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,torpedoFlightId:this.torpedoFlightId,weaponId:this.weaponId,roll:this.roll,shipId:this.shipId,interceptChange:this.interceptChange.serialize()};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.torpedoFlightId=data.torpedoFlightId;this.weaponId=data.weaponId;this.roll=data.roll;this.shipId=data.shipId;this.interceptChange=new weapon_WeaponHitChance().deserialize(data.interceptChange);return this;}}]);return CombatLogTorpedoIntercept;}();/* harmony default export */ var combatLog_CombatLogTorpedoIntercept = (CombatLogTorpedoIntercept_CombatLogTorpedoIntercept);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogTorpedoMove.mjs
var CombatLogTorpedoMove_CombatLogTorpedoMove=/*#__PURE__*/function(){function CombatLogTorpedoMove(torpedoFlightId,startPosition,endPosition,velocity){Object(classCallCheck["a" /* default */])(this,CombatLogTorpedoMove);this.torpedoFlightId=torpedoFlightId;this.startPosition=startPosition;this.endPosition=endPosition;this.velocity=velocity;this.replayOrder=30;}Object(createClass["a" /* default */])(CombatLogTorpedoMove,[{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,torpedoFlightId:this.torpedoFlightId,startPosition:this.startPosition,endPosition:this.endPosition,velocity:this.velocity};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.torpedoFlightId=data.torpedoFlightId;this.startPosition=new utils_Vector(data.startPosition);this.endPosition=new utils_Vector(data.endPosition);this.velocity=new utils_Vector(data.velocity);return this;}}]);return CombatLogTorpedoMove;}();/* harmony default export */ var combatLog_CombatLogTorpedoMove = (CombatLogTorpedoMove_CombatLogTorpedoMove);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogTorpedoOutOfTime.mjs
var CombatLogTorpedoOutOfTime_CombatLogTorpedoOutOfTime=/*#__PURE__*/function(){function CombatLogTorpedoOutOfTime(torpedoFlightId){Object(classCallCheck["a" /* default */])(this,CombatLogTorpedoOutOfTime);this.torpedoFlightId=torpedoFlightId;}Object(createClass["a" /* default */])(CombatLogTorpedoOutOfTime,[{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,torpedoFlightId:this.torpedoFlightId};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.torpedoFlightId=data.torpedoFlightId;return this;}}]);return CombatLogTorpedoOutOfTime;}();/* harmony default export */ var combatLog_CombatLogTorpedoOutOfTime = (CombatLogTorpedoOutOfTime_CombatLogTorpedoOutOfTime);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogShipVelocity.mjs
var CombatLogShipVelocity_CombatLogShipVelocity=/*#__PURE__*/function(){function CombatLogShipVelocity(shipId){Object(classCallCheck["a" /* default */])(this,CombatLogShipVelocity);this.shipId=shipId;this.replayOrder=10;}Object(createClass["a" /* default */])(CombatLogShipVelocity,[{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,shipId:this.shipId};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.shipId=data.shipId;return this;}}]);return CombatLogShipVelocity;}();/* harmony default export */ var combatLog_CombatLogShipVelocity = (CombatLogShipVelocity_CombatLogShipVelocity);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogTorpedoNotArmed.mjs
var CombatLogTorpedoNotArmed_CombatLogTorpedoNotArmed=/*#__PURE__*/function(){function CombatLogTorpedoNotArmed(torpedoFlightId,turnsActive,armingTime){Object(classCallCheck["a" /* default */])(this,CombatLogTorpedoNotArmed);this.torpedoFlightId=torpedoFlightId;this.turnsActive=turnsActive;this.armingTime=armingTime;}Object(createClass["a" /* default */])(CombatLogTorpedoNotArmed,[{key:"serialize",value:function serialize(){return{logEntryClass:this.constructor.name,torpedoFlightId:this.torpedoFlightId,turnsActive:this.turnsActive,armingTime:this.armingTime};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.torpedoFlightId=data.torpedoFlightId;this.turnsActive=data.turnsActive;this.armingTime=data.armingTime;return this;}}]);return CombatLogTorpedoNotArmed;}();/* harmony default export */ var combatLog_CombatLogTorpedoNotArmed = (CombatLogTorpedoNotArmed_CombatLogTorpedoNotArmed);
// CONCATENATED MODULE: ./src/model/combatLog/combatLogClasses.mjs
var combatLogClasses=Object(defineProperty["a" /* default */])({CombatLogTorpedoAttack:combatLog_CombatLogTorpedoAttack,CombatLogDamageEntry:combatLog_CombatLogDamageEntry,CombatLogTorpedoLaunch:combatLog_CombatLogTorpedoLaunch,CombatLogTorpedoIntercept:combatLog_CombatLogTorpedoIntercept,CombatLogTorpedoMove:combatLog_CombatLogTorpedoMove,CombatLogTorpedoOutOfTime:combatLog_CombatLogTorpedoOutOfTime,CombatLogWeaponOutOfArc:combatLog_CombatLogWeaponOutOfArc,CombatLogWeaponFire:combatLog_CombatLogWeaponFire,CombatLogShipMovement:combatLog_CombatLogShipMovement,CombatLogShipVelocity:combatLog_CombatLogShipVelocity,CombatLogTorpedoNotArmed:combatLog_CombatLogTorpedoNotArmed,CombatLogGroupedWeaponFire:combatLog_CombatLogGroupedWeaponFire},"CombatLogGroupedWeaponFire",combatLog_CombatLogGroupedWeaponFire);
// CONCATENATED MODULE: ./src/model/combatLog/CombatLogData.mjs
var CombatLogData_CombatLogData=/*#__PURE__*/function(){function CombatLogData(){Object(classCallCheck["a" /* default */])(this,CombatLogData);this.entries=[];}Object(createClass["a" /* default */])(CombatLogData,[{key:"addEntry",value:function addEntry(entry){this.entries.push(entry);}},{key:"serialize",value:function serialize(){return{entries:this.entries.map(function(entry){return entry.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.entries=data.entries?data.entries.map(function(entry){return new combatLogClasses[entry.logEntryClass]().deserialize(entry);}):[];return this;}},{key:"advanceTurn",value:function advanceTurn(){this.entries=[];}},{key:"getInterceptsFor",value:function getInterceptsFor(torpedoAttack){return this.entries.filter(function(entry){return entry instanceof combatLog_CombatLogTorpedoIntercept;}).filter(function(entry){return entry.torpedoFlightId===torpedoAttack.torpedoFlightId;});}},{key:"getForReplay",value:function getForReplay(){var entries=Object(toConsumableArray["a" /* default */])(this.entries);var groupedFires=[];entries.filter(function(entry){return entry instanceof combatLog_CombatLogWeaponFire;}).forEach(function(fire){var entry=groupedFires.find(function(grouped){return grouped.targetId===fire.targetId;});if(!entry){entry=new combatLog_CombatLogGroupedWeaponFire(fire.targetId);groupedFires.push(entry);}entry.addEntry(fire);});var groupedTorpedos=[];entries.filter(function(entry){return entry instanceof combatLog_CombatLogTorpedoAttack;}).forEach(function(torpedo){var entry=groupedTorpedos.find(function(grouped){return grouped.targetId===torpedo.targetId;});if(!entry){entry=new combatLog_CombatLogGroupedTorpedoAttack(torpedo.targetId);groupedTorpedos.push(entry);}entry.addEntry(torpedo);});return[].concat(Object(toConsumableArray["a" /* default */])(this.entries.filter(function(entry){return!(entry instanceof combatLog_CombatLogWeaponFire);})),groupedFires,groupedTorpedos).filter(function(entry){return entry.replayOrder;}).sort(function(a,b){if(a.replayOrder>b.replayOrder){return 1;}if(a.replayOrder<b.replayOrder){return-1;}return 0;});}}]);return CombatLogData;}();/* harmony default export */ var combatLog_CombatLogData = (CombatLogData_CombatLogData);
// CONCATENATED MODULE: ./src/model/game/GameData.mjs
var GameData_GameData=/*#__PURE__*/function(){function GameData(data){Object(classCallCheck["a" /* default */])(this,GameData);this.deserialize(data);}Object(createClass["a" /* default */])(GameData,[{key:"setStatus",value:function setStatus(status){this.status=status;}},{key:"setPhase",value:function setPhase(phase){this.phase=phase;}},{key:"advanceTurn",value:function advanceTurn(){this.turn++;}},{key:"addPlayer",value:function addPlayer(user){if(this.players.find(function(player){return player.id===user.id;})){return;}this.players.push(user);}},{key:"removePlayer",value:function removePlayer(user){this.players=this.players.filter(function(player){return player.id!==user.id;});}},{key:"isPlayerInGame",value:function isPlayerInGame(user){return this.players.find(function(player){return player.id===user.id;});}},{key:"isPlayerActive",value:function isPlayerActive(user){return this.activePlayerIds.includes(user.id);}},{key:"setPlayerActive",value:function setPlayerActive(user){var requireShips=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(this.isPlayerActive(user)){return;}if(requireShips&&this.ships.getUsersShips(user).length===0){return;}this.activePlayerIds.push(user.id);}},{key:"setPlayerInactive",value:function setPlayerInactive(user){this.activePlayerIds=this.activePlayerIds.filter(function(id){return id!==user.id;});}},{key:"validateForGameCreate",value:function validateForGameCreate(user){if(!this.name){return"Game needs a name";}var slots=this.slots.getSlots();if(slots.length<2){return"Game has to have atleast two slots";}var teams={};slots.forEach(function(slot){return teams[slot.team]=true;});if(Object.keys(teams).length<2){return"Game has to have atleast two teams";}var error=undefined;slots.forEach(function(slot){var slotError=slot.validate();if(slotError){error=slotError;}});if(error){return error;}if(!slots.some(function(slot){return slot.userId===user.id;})){return"Game creator has to occupy atleast one slot";}if(slots.some(function(slot){return slot.userId&&slot.userId!==user.id;})){return"Other players can not occupy slots at this stage";}}},{key:"getActiveShips",value:function getActiveShips(){var _this=this;return this.ships.getShips().filter(function(ship){return _this.activeShips.isActive(ship);});}},{key:"getActiveShipsForUser",value:function getActiveShipsForUser(user){var _this2=this;return this.ships.getShips().filter(function(ship){return _this2.activeShips.isActive(ship)&&ship.player.isUsers(user);});}},{key:"isActiveShip",value:function isActiveShip(ship){return this.activeShips.isActive(ship);}},{key:"setActiveShip",value:function setActiveShip(ship){this.activeShips.setActive(ship);}},{key:"setInactiveShip",value:function setInactiveShip(ship){this.activeShips.setInactive(ship);}},{key:"getShipsForUser",value:function getShipsForUser(user){return this.ships.getShips().filter(function(ship){return ship.player.isUsers(user);});}},{key:"serialize",value:function serialize(){return{id:this.id,phase:this.phase,name:this.name,turn:this.turn,data:Object(objectSpread2["a" /* default */])({activePlayerIds:this.activePlayerIds},this.slots.serialize(),{terrain:this.terrain.serialize(),combatLog:this.combatLog.serialize(),torpedos:this.torpedos.serialize()}),ships:this.ships.serialize(),activeShips:this.activeShips.serialize(),creatorId:this.creatorId,status:this.status,players:this.players.map(function(player){return player.serialize();})};}},{key:"deserialize",value:function deserialize(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var gameData=data.data||{};this.id=data.id||null;this.name=data.name;this.phase=data.phase||DEPLOYMENT;this.turn=data.turn||1;this.players=data.players?data.players.map(function(player){return new model_User().deserialize(player);}):[];this.activePlayerIds=gameData.activePlayerIds||[];this.slots=new game_GameSlots(this).deserialize(gameData);this.ships=new game_GameShips(this).deserialize(data.ships);this.activeShips=new game_GameActiveShips(this).deserialize(data.activeShips);this.creatorId=data.creatorId;this.status=data.status||LOBBY;this.torpedos=new game_GameTorpedos().deserialize(gameData.torpedos);this.terrain=new game_GameTerrain(this).deserialize(gameData.terrain);this.combatLog=new combatLog_CombatLogData().deserialize(gameData.combatLog);return this;}},{key:"clone",value:function clone(){return new GameData(this.serialize());}},{key:"censorForUser",value:function censorForUser(user){var _this3=this;this.ships.getShips().forEach(function(ship){ship.movement.removeMovementForOtherTurns(_this3.turn);var mine=user&&ship.player.is(user);ship.censorForUser(user,mine);});return this;}},{key:"endTurn",value:function endTurn(){var _this4=this;this.ships.getShips().forEach(function(ship){ship.endTurn(_this4.turn);});}},{key:"advanceTurn",value:function advanceTurn(){var _this5=this;this.turn++;this.players.forEach(function(player){return _this5.setPlayerActive(player,true);});this.combatLog.advanceTurn();this.torpedos.advanceTurn();this.ships.getShips().filter(function(ship){return!ship.isDestroyed();}).forEach(function(ship){ship.advanceTurn(_this5.turn);_this5.setActiveShip(ship);});}}]);return GameData;}();/* harmony default export */ var game_GameData = (GameData_GameData);
// CONCATENATED MODULE: ./src/client/view/game/renderer/ships/TorpedoObject.js
var torpedoMesh=loadObject("/img/3d/torpedo/scene.gltf");var TorpedoObject_TorpedoObject=/*#__PURE__*/function(){function TorpedoObject(torpedoFlight,scene){Object(classCallCheck["a" /* default */])(this,TorpedoObject);this.torpedoFlight=torpedoFlight;this.scene=scene;this.torpedo=null;this.object=new three_module["Object3D"]();this.particleEmitter=new particle_ParticleEmitter(this.object,10);this.create();this.lastAnimationTime=null;this.totalAnimationTime=0;this.hidden=true;}Object(createClass["a" /* default */])(TorpedoObject,[{key:"hide",value:function hide(){if(this.hidden){return;}this.scene.remove(this.object);this.hidden=true;}},{key:"show",value:function show(){if(!this.hidden){return;}this.scene.add(this.object);this.hidden=false;}},{key:"setFacing",value:function setFacing(facing){this.object.quaternion.setFromAxisAngle(new three_module["Vector3"](0,0,1),degreeToRadian(facing));}},{key:"setPosition",value:function setPosition(position){this.object.position.set(position.x,position.y,position.z);return this;}},{key:"getEnginePosition",value:function getEnginePosition(){var slot=this.torpedo.children.find(function(child){if(!child.name){return false;}if(child.name==="thrustEffect"){return true;}});if(!slot){return new utils_Vector();}return new utils_Vector(slot.position);}},{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var scene,torpedo,visuals,color,enginePosition,getRandom,size,sineFrequency,angle,shines,angleChange;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return torpedoMesh;case 2:scene=_context.sent;torpedo=scene.scene.children[0].clone();this.torpedo=torpedo;visuals=this.torpedoFlight.torpedo.visuals;color=new three_module["Color"](visuals.engineColor[0],visuals.engineColor[1],visuals.engineColor[2]);//this.torpedo.position.x = 100;
//this.torpedo.position.z = 50;
/*
    this.line = new Line(this.object, {
      start: new Vector(0, 0, 0),
      end: new Vector(0, 0, -30),
      width: 0.5,
      color: new THREE.Color(1, 1, 1),
      opacity: 0.2
      //type: "cylinder"
    });
    */enginePosition=this.getEnginePosition();this.particleEmitter.mesh.position.set(enginePosition.x,enginePosition.y,enginePosition.z);getRandom=getSeededRandomGenerator(this.torpedoFlight.id);size=10;sineFrequency=getRandom()*50+200;this.particleEmitter.getParticle().setSize(size).setOpacity(0.5).setFadeIn(0,0).setFadeOut(0,0).setColor(color)//.setVelocity(this.movement)
.setPosition({x:0,y:0,z:0}).setTexture(TEXTURE_GLOW).setActivationTime(0);//.setSine(100, 0.99);
this.particleEmitter.getParticle().setSize(size).setOpacity(0.1).setFadeIn(0,0).setFadeOut(0,0).setColor(color)//.setVelocity(this.movement)
.setPosition({x:0,y:0,z:0}).setTexture(TEXTURE_GLOW).setActivationTime(0).setSine(sineFrequency,0.99);this.particleEmitter.getParticle().setSize(size*0.3).setOpacity(0.8).setFadeIn(0,0).setFadeOut(0,0).setColor(new three_module["Color"](1,1,1))//.setVelocity(this.movement)
.setPosition({x:0,y:0,z:0}).setTexture(TEXTURE_GLOW).setActivationTime(0);angle=90;shines=2;angleChange=0;// getRandom() * 0.05 - 0.025;
while(shines--){angle+=90;/*
      this.particleEmitter
        .getParticle()
        .setActivationTime(0)
        .setFadeIn(0, 0)
        .setFadeOut(0, 0)
        .setSize(getRandom() * 10 + size * 5)
        .setOpacity(getRandom() * 0.05 + 0.2)
        .setPosition({
          x: 0,
          y: 0,
          z: 0
        })
        .setColor(new THREE.Color(51 / 255, 163 / 255, 255 / 255))
        //.setSine(getRandom() * 200 + 100, 0.1)
        .setAngle(angle, angleChange)
        .setTexture(TEXTURE_STARLINE);
      //.setSine(100, 0.5);
      */this.particleEmitter.getParticle().setActivationTime(0).setFadeIn(0,0).setFadeOut(0,0).setSize(getRandom()*10+size*3).setOpacity(0.1).setPosition({x:0,y:0,z:0}).setColor(color)//.setSine(getRandom() * 200 + 100, 0.1)
.setAngle(angle,angleChange).setTexture(TEXTURE_STARLINE).setSine(sineFrequency,0.99);}this.object.add(torpedo);case 20:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()},{key:"render",value:function render(_ref){var zoom=_ref.zoom;if(this.lastAnimationTime===null){this.lastAnimationTime=Date.now();}var deltaTime=Date.now()-this.lastAnimationTime;this.totalAnimationTime+=deltaTime;this.particleEmitter.render({delta:0,total:this.totalAnimationTime,last:0,zoom:zoom});this.lastAnimationTime=Date.now();}},{key:"destroy",value:function destroy(){this.scene.remove(this.object);}},{key:"update",value:function update(torpedoFlight){this.torpedoFlight=torpedoFlight;}}]);return TorpedoObject;}();/* harmony default export */ var ships_TorpedoObject = (TorpedoObject_TorpedoObject);
// CONCATENATED MODULE: ./src/client/view/game/renderer/icon/TorpedoIconContainer.js
var TorpedoIconContainer_TorpedoIconContainer=/*#__PURE__*/function(){function TorpedoIconContainer(scene){Object(classCallCheck["a" /* default */])(this,TorpedoIconContainer);this.scene=scene;this.icons=[];}Object(createClass["a" /* default */])(TorpedoIconContainer,[{key:"getArray",value:function getArray(){return this.icons;}},{key:"hasIcon",value:function hasIcon(id){return Boolean(this.getIconById(id));}},{key:"getIconByTorpedoFlight",value:function getIconByTorpedoFlight(flight){var icon=this.getIconById(flight.id);if(!icon){icon=new ships_TorpedoObject(flight,this.scene);this.icons.push(icon);}return icon;}},{key:"getIconById",value:function getIconById(id){return this.icons.find(function(icon){return icon.torpedoFlight.id===id;});}},{key:"render",value:function render(renderPayload){this.icons.forEach(function(icon){return icon.render(renderPayload);});}}]);return TorpedoIconContainer;}();/* harmony default export */ var icon_TorpedoIconContainer = (TorpedoIconContainer_TorpedoIconContainer);
// CONCATENATED MODULE: ./src/client/view/game/phase/PhaseDirector.js
var PhaseDirector_PhaseDirector=/*#__PURE__*/function(){function PhaseDirector(uiState,currentUser,coordinateConverter,gameConnector){Object(classCallCheck["a" /* default */])(this,PhaseDirector);this.uiState=uiState;this.currentUser=currentUser;this.shipIconContainer=null;this.torpedoIconContainer=null;this.electronicWarfareIndicatorService=null;this.timeline=[];this.phaseStrategy=null;this.coordinateConverter=coordinateConverter;this.shipWindowManager=null;this.movementService=new movement_MovementService();this.weaponFireService=new weapon_WeaponFireService();this.torpedoAttackService=new weapon_TorpedoAttackService();this.movementPathService=null;this.terrainRenderer=null;this.phaseState=new phase_PhaseState();this.gameConnector=gameConnector;this.gameConnector.init(this);this.scene=null;this.emitterContainer=null;this.camera=null;this.gameDataCache=new phase_GameDataCache();}Object(createClass["a" /* default */])(PhaseDirector,[{key:"init",value:function init(scene,emitterContainer,camera){this.scene=scene;this.emitterContainer=emitterContainer;this.camera=camera;this.shipIconContainer=new icon_ShipIconContainer(scene,this.currentUser);this.torpedoIconContainer=new icon_TorpedoIconContainer(scene);this.electronicWarfareIndicatorService=new electronicWarfare_ElectronicWarfareIndicatorService(scene,this.shipIconContainer,this.currentUser);this.shipWindowManager=new shipWindow_ShipWindowManager(this.uiState,this.movementService);this.movementPathService=new movement_MovementPathService(scene,this.shipIconContainer,this.currentUser);this.terrainRenderer=new renderer_TerrainRenderer(scene);this.uiState.setPhaseDirector(this);}},{key:"closeReplay",value:function closeReplay(){this.phaseStrategy.deactivate();this.phaseStrategy=null;this.resolvePhaseStrategy();}},{key:"startReplay",value:function startReplay(){var gameDatas=this.gameDataCache.getGameDatasForAutomaticReplay();if(!gameDatas){return;}this.activatePhaseStrategy(phaseStrategy_AutomaticReplayPhaseStrategy);this.relayEvent("newTurn",gameDatas);}},{key:"receiveGameData",value:function receiveGameData(gameData){window.gameData=this.gameDataCache;this.gameDataCache.setCurrent(gameData);this.resolvePhaseStrategy();}},{key:"receiveReplay",value:function receiveReplay(gameDatas){this.receiveTurnChange(gameDatas);}},{key:"receiveTurnChange",value:function receiveTurnChange(gameDatas){this.gameDataCache.setCurrent(gameDatas[gameDatas.length-1]);var replays=Object(toConsumableArray["a" /* default */])(gameDatas);replays.splice(-1,1);this.gameDataCache.setReplays(replays);if(!this.phaseStrategy||this.phaseStrategy.canDisturb()){this.activatePhaseStrategy(phaseStrategy_AutomaticReplayPhaseStrategy);}if(this.phaseStrategy){this.relayEvent("newTurn",gameDatas);}}},{key:"relayEvent",value:function relayEvent(name,payload){if(!this.phaseStrategy||this.phaseStrategy.inactive){return;}this.phaseStrategy.onEvent(name,payload);this.shipIconContainer.onEvent(name,payload);}},{key:"commitTurn",value:function commitTurn(){this.phaseStrategy.commitTurn(this.gameConnector);return this.activatePhaseStrategy(phaseStrategy_WaitingPhaseStrategy);}},{key:"render",value:function render(scene,coordinateConverter,zoom){if(!this.phaseStrategy||this.phaseStrategy.inactive){return;}this.phaseStrategy.render(coordinateConverter,scene,zoom);this.electronicWarfareIndicatorService.render(zoom);this.uiState.render();}},{key:"resolvePhaseStrategy",value:function resolvePhaseStrategy(){var gameData=this.gameDataCache.getCurrent();if(this.phaseStrategy&&!this.phaseStrategy.canDisturb()){return;}if(gameData.status===LOBBY){return this.activatePhaseStrategy(phaseStrategy_LobbyPhaseStrategy,gameData);}if(!this.currentUser||!gameData.isPlayerInGame(this.currentUser)||this.uiState.isReplay()||gameData.status===FINISHED){return this.activatePhaseStrategy(phaseStrategy_ReplayPhaseStrategy,gameData);}if(!gameData.isPlayerActive(this.currentUser)){return this.activatePhaseStrategy(phaseStrategy_WaitingPhaseStrategy,gameData);}if(gameData.phase===DEPLOYMENT){return this.activatePhaseStrategy(phaseStrategy_DeploymentPhaseStrategy,gameData);}if(!gameData.isPlayerActive(this.currentUser)){return this.activatePhaseStrategy(phaseStrategy_WaitingPhaseStrategy,gameData);}return this.activatePhaseStrategy(phaseStrategy_GamePhaseStrategy,gameData);}},{key:"activatePhaseStrategy",value:function activatePhaseStrategy(phaseStrategy){var gameData=this.gameDataCache.getCurrent();this.uiState.update(gameData);this.shipIconContainer.update(gameData);this.movementService.update(gameData,this);this.movementPathService.update(gameData);this.terrainRenderer.update(gameData.terrain);this.weaponFireService.update(gameData);this.torpedoAttackService.update(gameData);if(this.phaseStrategy&&this.phaseStrategy instanceof phaseStrategy){this.phaseStrategy.update(gameData);return;}if(this.phaseStrategy){this.phaseStrategy.deactivate();}this.phaseStrategy=new phaseStrategy(this.getServices());this.phaseStrategy.activate().update(gameData);}},{key:"getServices",value:function getServices(){return{phaseState:this.phaseState,shipIconContainer:this.shipIconContainer,torpedoIconContainer:this.torpedoIconContainer,electronicWarfareIndicatorService:this.electronicWarfareIndicatorService,scene:this.scene,shipWindowManager:this.shipWindowManager,movementService:this.movementService,coordinateConverter:this.coordinateConverter,uiState:this.uiState,currentUser:this.currentUser,gameConnector:this.gameConnector,movementPathService:this.movementPathService,weaponFireService:this.weaponFireService,particleEmitterContainer:this.emitterContainer,gameCamera:this.camera,torpedoAttackService:this.torpedoAttackService};}},{key:"deactivate",value:function deactivate(){}}]);return PhaseDirector;}();/* harmony default export */ var phase_PhaseDirector = (PhaseDirector_PhaseDirector);
// CONCATENATED MODULE: ./src/client/view/game/utils/PositionObject.js
var PositionObject_PositionObject=function PositionObject(view,game,hex){var entity=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;Object(classCallCheck["a" /* default */])(this,PositionObject);this.view=view;this.game=game;this.hex=hex;this.entity=entity;};/* harmony default export */ var utils_PositionObject = (PositionObject_PositionObject);
// CONCATENATED MODULE: ./src/client/view/game/GameSettings.js
var GameSettings_GameSettings=/*#__PURE__*/function(){function GameSettings(settings){Object(classCallCheck["a" /* default */])(this,GameSettings);this.matchEvent=function(event){return Object.keys(this.settings).find(function(action){var def=this.settings[action];if(!def||!def.keyCode){return false;}return def.keyCode===event.keyCode&&def.shiftKey===event.shiftKey&&def.altKey===event.altKey&&def.ctrlKey===event.ctrlKey&&def.metaKey===event.metaKey;},this);};this.populate(settings);}Object(createClass["a" /* default */])(GameSettings,[{key:"populate",value:function populate(){var settings=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.settings={ShowAllEW:settings.ShowAllEW||{keyCode:87,shiftKey:false,altKey:false,ctrlKey:false,metaKey:false},ShowFriendlyEW:settings.ShowFriendlyEW||{keyCode:88,shiftKey:false,altKey:false,ctrlKey:false,metaKey:false},ShowEnemyEW:settings.ShowEnemyEW||{keyCode:89,shiftKey:false,altKey:false,ctrlKey:false,metaKey:false},ZoomLevelToStrategic:0.2};}},{key:"set",value:function set(key,value){if(this.settings[key]===undefined){throw new Error("Unrecognized settings key '"+key+"'");}console.log("setting key",key,"to",value,typeof value);this.settings[key]=value;}},{key:"save",value:function save(){localStorage.setItem("settings",JSON.stringify(this.settings));}},{key:"load",value:function load(){var settings=localStorage.getItem("settings")||"{}";this.populate(JSON.parse(settings));return this;}}]);return GameSettings;}();/* harmony default export */ var game_GameSettings = (GameSettings_GameSettings);
// CONCATENATED MODULE: ./src/model/game/gameMessage.mjs
var MESSAGE_TAKE_SLOT="takeSlot";var MESSAGE_LEAVE_SLOT="leaveSlot";var MESSAGE_BUY_SHIPS="buyShips";var MESSAGE_COMMIT_TURN="commitTurn";var MESSAGE_COMMIT_DEPLOYMENT="commitDeployment";var MESSAGE_REQUEST_REPLAY="requestReplay";var MESSAGE_REPLAY="replay";var MESSAGE_GAMEDATA="gameData";var MESSAGE_TURN_CHANGED="turnChanged";
// CONCATENATED MODULE: ./src/client/view/game/GameConnector.js
var GameConnector_GameConnector=/*#__PURE__*/function(){function GameConnector(gameId){Object(classCallCheck["a" /* default */])(this,GameConnector);this.gameId=gameId;this.phaseDirector=null;this.webSocket=null;this.open=false;this.connection=null;this.connectionResolve=null;}Object(createClass["a" /* default */])(GameConnector,[{key:"init",value:function init(phaseDirector){this.phaseDirector=phaseDirector;}},{key:"deactivate",value:function(){var _deactivate=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var connection;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.connection;case 2:connection=_context.sent;connection.close();case 4:case"end":return _context.stop();}}},_callee,this);}));function deactivate(){return _deactivate.apply(this,arguments);}return deactivate;}()},{key:"connect",value:function connect(){var _this=this;var timeout=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;this.connection=new Promise(function(resolve){setTimeout(function(){_this.webSocket=new WebSocket(SERVER_WEBSOCKET_URL+_this.gameId);_this.connectionResolve=resolve;_this.webSocket.onerror=_this.onError.bind(_this);_this.webSocket.onmessage=_this.onMessage.bind(_this);_this.webSocket.onclose=_this.onClose.bind(_this);_this.webSocket.onopen=_this.onOpen.bind(_this);},timeout);});}},{key:"commitTurn",value:function(){var _commitTurn=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee2(gameData){var connection;return regenerator_default.a.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.connection;case 2:connection=_context2.sent;connection.send(JSON.stringify({type:MESSAGE_COMMIT_TURN,payload:gameData.serialize()}));case 4:case"end":return _context2.stop();}}},_callee2,this);}));function commitTurn(_x){return _commitTurn.apply(this,arguments);}return commitTurn;}()},{key:"commitDeployment",value:function(){var _commitDeployment=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee3(gameData){var connection;return regenerator_default.a.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.connection;case 2:connection=_context3.sent;connection.send(JSON.stringify({type:MESSAGE_COMMIT_DEPLOYMENT,payload:gameData.serialize()}));case 4:case"end":return _context3.stop();}}},_callee3,this);}));function commitDeployment(_x2){return _commitDeployment.apply(this,arguments);}return commitDeployment;}()},{key:"takeSlot",value:function(){var _takeSlot=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee4(slotId){var connection;return regenerator_default.a.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.connection;case 2:connection=_context4.sent;connection.send(JSON.stringify({type:MESSAGE_TAKE_SLOT,payload:slotId}));case 4:case"end":return _context4.stop();}}},_callee4,this);}));function takeSlot(_x3){return _takeSlot.apply(this,arguments);}return takeSlot;}()},{key:"leaveSlot",value:function(){var _leaveSlot=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee5(slotId){var connection;return regenerator_default.a.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this.connection;case 2:connection=_context5.sent;connection.send(JSON.stringify({type:MESSAGE_LEAVE_SLOT,payload:slotId}));case 4:case"end":return _context5.stop();}}},_callee5,this);}));function leaveSlot(_x4){return _leaveSlot.apply(this,arguments);}return leaveSlot;}()},{key:"buyShips",value:function(){var _buyShips=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee6(slotId,ships){var connection;return regenerator_default.a.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return this.connection;case 2:connection=_context6.sent;connection.send(JSON.stringify({type:MESSAGE_BUY_SHIPS,payload:{slotId:slotId,ships:ships.map(function(ship){return ship.serialize();})}}));case 4:case"end":return _context6.stop();}}},_callee6,this);}));function buyShips(_x5,_x6){return _buyShips.apply(this,arguments);}return buyShips;}()},{key:"disconnect",value:function(){var _disconnect=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee7(){return regenerator_default.a.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:this.open=false;_context7.next=3;return this.connection;case 3:_context7.sent.close();case 4:case"end":return _context7.stop();}}},_callee7,this);}));function disconnect(){return _disconnect.apply(this,arguments);}return disconnect;}()},{key:"onOpen",value:function onOpen(){this.open=true;this.connectionResolve(this.webSocket);}},{key:"onError",value:function onError(){console.log("error");}},{key:"onClose",value:function onClose(){if(this.open){this.connect(2000);}}},{key:"onMessage",value:function onMessage(_ref){var data=_ref.data;var _JSON$parse=JSON.parse(data),type=_JSON$parse.type,payload=_JSON$parse.payload;console.log("message received",type);switch(type){case MESSAGE_GAMEDATA:this.phaseDirector.receiveGameData(new game_GameData(payload));break;case MESSAGE_TURN_CHANGED:this.phaseDirector.receiveTurnChange(payload.map(function(entry){return new game_GameData(entry);}));break;case MESSAGE_REPLAY:this.phaseDirector.receiveReplay(payload.map(function(entry){return new game_GameData(entry);}));break;default:throw new Error("Unrecognized websocket message type: '".concat(type,"'"));}}}]);return GameConnector;}();/* harmony default export */ var game_GameConnector = (GameConnector_GameConnector);
// CONCATENATED MODULE: ./src/client/view/game/renderer/hexgrid/HexGridRender.js
var HEX_COUNT_WIDTH=9999;var HEX_COUNT_HEIGHT=9999;var HEX_LINE_COLOR="rgba(255,255,255,255)";var HEX_FILL_COLOR="rgba(0,0,0,0)";var HEX_LINE_WIDTH=20;var HEX_CANVAS_SIZE=1024;var HEX_OPACITY=0.05;//const HEX_MAX_OPACITY = 0.3;
var HexGridRender_getGeometryWidth=function getGeometryWidth(){return HexagonMath.getGridWidth(HEX_COUNT_WIDTH);};var HexGridRender_getGeometryHeight=function getGeometryHeight(){return HexagonMath.getGridHeight(HEX_COUNT_HEIGHT);};var HexGridRender_HexGridRenderer=/*#__PURE__*/function(){function HexGridRenderer(){Object(classCallCheck["a" /* default */])(this,HexGridRenderer);this.onZoom=function(zoom){if(zoom>1){//this.material.opacity = (HEX_MAX_OPACITY - HEX_OPACITY) * ((zoom - 1) / (this.maxZoom - 1)) + HEX_OPACITY;
}else{//this.material.opacity = zoom * HEX_OPACITY;
}};this.material=null;this.mesh=null;this.minZoom=0;this.maxZoom=0;this.hexSize=128;}Object(createClass["a" /* default */])(HexGridRenderer,[{key:"renderHexGrid",value:function renderHexGrid(scene,minZoom,maxZoom){this.minZoom=minZoom;this.maxZoom=maxZoom;var width=HexGridRender_getGeometryWidth();var height=HexGridRender_getGeometryHeight();var texture=HexagonTexture.getHexGridTexture(HEX_CANVAS_SIZE,HEX_COUNT_WIDTH,HEX_COUNT_HEIGHT,HEX_LINE_COLOR,HEX_FILL_COLOR,HEX_LINE_WIDTH);var geometry=new three_module["PlaneGeometry"](width,height,1,1);this.material=new three_module["MeshBasicMaterial"]({map:texture,transparent:true,opacity:HEX_OPACITY,depthWrite:false});this.mesh=new three_module["Mesh"](geometry,this.material);this.mesh.position.x+=HexagonMath.getHexB()/2;this.mesh.name="hexgrid";scene.add(this.mesh);}}]);return HexGridRenderer;}();/* harmony default export */ var HexGridRender = (HexGridRender_HexGridRenderer);
// CONCATENATED MODULE: ./src/client/view/game/terrain/StarField.js
var StarField_StarField=/*#__PURE__*/function(){function StarField(scene,gameId){Object(classCallCheck["a" /* default */])(this,StarField);this.starCount=5000;this.emitterContainer=new particle_ParticleEmitterContainer(scene,this.starCount);this.scene=scene;this.lastAnimationTime=null;this.totalAnimationTime=0;this.zoomChanged=0;this.gameId=gameId;this.getRandom=null;this.create();}Object(createClass["a" /* default */])(StarField,[{key:"create",value:function(){var _create=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var width,height,stars;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.emitterContainer.ready();case 2://this.scene.background = new THREE.Color(10 / 255, 10 / 255, 30 / 255);
//this.webglScene.scene.background = new THREE.Color(10/255, 10/255, 30/255);
width=3000;//this.webglScene.width * 1.5;
height=2000;// this.webglScene.height * 1.5;
this.getRandom=getSeededRandomGenerator(this.gameId);//var stars = Math.floor(this.starCount * (width / 4000));
stars=this.starCount;while(stars--){this.createStar(width,height);if(this.getRandom()>0.98){this.createShiningStar(width,height);}}//var gas = Math.floor(this.getRandom() * 5) + 8;
/*
        while(gas--){
            this.createGasCloud(width, height)
        }
        */this.lastAnimationTime=new Date().getTime();this.totalAnimationTime=0;this.zoomChanged=1;return _context.abrupt("return",this);case 11:case"end":return _context.stop();}}},_callee,this);}));function create(){return _create.apply(this,arguments);}return create;}()},{key:"resize",value:function resize(){}},{key:"cleanUp",value:function cleanUp(){this.emitterContainer.release(this);}},{key:"render",value:function render(){if(!this.emitterContainer.isReady()){return;}var deltaTime=new Date().getTime()-this.lastAnimationTime;this.totalAnimationTime+=deltaTime;this.emitterContainer.render({delta:0,total:this.totalAnimationTime,last:0,zoom:this.zoomChanged});if(this.zoomChanged===1){this.zoomChanged=0;}this.lastAnimationTime=new Date().getTime();}},{key:"createStar",value:function createStar(width,height){var particle=this.emitterContainer.getStarParticle(this);var x=(this.getRandom()-0.5)*width*1.5;var y=(this.getRandom()-0.5)*height*1.5;particle.setActivationTime(0).setSize(2+this.getRandom()*2).setOpacity(this.getRandom()*0.2+0.9).setPosition({x:x,y:y}).setColor(new three_module["Color"](1,1,1)).setParallaxFactor(0.1+this.getRandom()*0.1);if(this.getRandom()>0.9){particle.setSineFrequency(this.getRandom()*200+50).setSineAmplitude(this.getRandom());}}},{key:"createShiningStar",value:function createShiningStar(width,height){var particle=this.emitterContainer.getStarParticle(this);var x=(this.getRandom()-0.5)*width*1.5;var y=(this.getRandom()-0.5)*height*1.5;var size=6+this.getRandom()*6;var parallaxFactor=0.1+this.getRandom()*0.1;var color=new three_module["Color"](this.getRandom()*0.4+0.6,this.getRandom()*0.2+0.8,this.getRandom()*0.4+0.6);particle.setActivationTime(0).setSize(size*0.5).setOpacity(this.getRandom()*0.2+0.9).setPosition({x:x,y:y}).setColor(new three_module["Color"](1,1,1)).setParallaxFactor(parallaxFactor);particle=this.emitterContainer.getStarParticle(this);particle.setActivationTime(0).setSize(size).setOpacity(this.getRandom()*0.1+0.1).setPosition({x:x,y:y}).setColor(color).setParallaxFactor(parallaxFactor).setSineFrequency(this.getRandom()*200+100).setSineAmplitude(this.getRandom()*0.4);var shines=Math.round(this.getRandom()*8)-3;if(shines<=2){return;}var angle=this.getRandom()*360;var angleChange=(this.getRandom()-0.5)*0.01;while(shines--){angle+=this.getRandom()*60+40;particle=this.emitterContainer.getStarParticle(this);particle.setActivationTime(0).setSize(size*this.getRandom()*10+10).setOpacity(this.getRandom()*0.1+0.1).setPosition({x:x,y:y}).setColor(color).setParallaxFactor(parallaxFactor).setSineFrequency(this.getRandom()*200+100).setSineAmplitude(0.1).setAngle(angle).setAngleChange(angleChange).setTexture(particle.texture.starLine);}}},{key:"createGasCloud",value:function createGasCloud(width,height){var position={x:(this.getRandom()-0.5)*width,y:(this.getRandom()-0.5)*height};var vector={x:this.getRandomBand(0.5,1)*width/100,y:this.getRandomBand(0.5,1)*width/100};var iterations=Math.floor(this.getRandom()*3)+5;while(iterations--){this.createGasCloudPart({x:position.x,y:position.y},width);position.x+=this.getRandomBand(0,1)*50+vector.x;position.y+=this.getRandomBand(0,1)*50+vector.y;}}},{key:"getRandomBand",value:function getRandomBand(min,max){var random=this.getRandom()*(max-min)+min;return this.getRandom()>0.5?random*-1:random;}},{key:"createGasCloudPart",value:function createGasCloudPart(position,width){var gas=Math.floor(this.getRandom()*5+5);var baseRotation=(this.getRandom()-0.5)*0.002;while(gas--){this.createGas(position,baseRotation,this.getRandom()*width*0.4+width*0.4);}}},{key:"createGas",value:function createGas(position,baseRotation,size){var particle=this.emitterContainer.getStarParticle(this);position.x+=(this.getRandom()-0.5)*100;position.y+=(this.getRandom()-0.5)*100;particle.setActivationTime(0).setSize(this.getRandom()*size*0.5+size*0.5).setOpacity(this.getRandom()*0.005+0.005).setPosition({x:position.x,y:position.y}).setColor(new three_module["Color"](104/255,204/255,249/255)).setTexture(particle.texture.gas).setAngle(this.getRandom()*360).setAngleChange(baseRotation+(this.getRandom()-0.5)*0.001).setParallaxFactor(0.1+this.getRandom()*0.1);if(this.getRandom()>0.9){particle.setActivationTime(0).setSize(this.getRandom()*size*0.25+size*0.25).setOpacity(0).setPosition({x:position.x,y:position.y}).setColor(new three_module["Color"](1,1,1)).setTexture(particle.texture.gas).setAngle(this.getRandom()*360).setAngleChange(baseRotation+(this.getRandom()-0.5)*0.01).setParallaxFactor(0.1+this.getRandom()*0.1).setSineFrequency(this.getRandom()*200+200).setSineAmplitude(this.getRandom()*0.02);}}}]);return StarField;}();/* harmony default export */ var terrain_StarField = (StarField_StarField);
// CONCATENATED MODULE: ./src/client/view/game/GameCamera.js
var GameCamera_GameCamera=/*#__PURE__*/function(){function GameCamera(zoom,width,height,z){Object(classCallCheck["a" /* default */])(this,GameCamera);this.ortho=new three_module["OrthographicCamera"](zoom*width/-2,zoom*width/2,zoom*height/2,zoom*height/-2,-40000,40000);this.z=z;this.ortho.position.set(0,0,z);this.orthoCameraAngle=0;this.perspectiveRatio=10;this.perspectiveFieldOfView=25;this.perspective=new three_module["PerspectiveCamera"](this.perspectiveFieldOfView,width/height,1,100000);this.perspectiveCameraDistance=1;this.closeAngle=-z*0.5;this.setCameraAngle(this.closeAngle);this.current=this.perspective;window.gameCamera=this;}Object(createClass["a" /* default */])(GameCamera,[{key:"changeToMapView",value:function changeToMapView(){this.setCameraAngle(0);this.current=this.ortho;}},{key:"changeToCloseView",value:function changeToCloseView(){this.setCameraAngle(this.closeAngle);this.current=this.perspective;}},{key:"solvePerspectiveSize",value:function solvePerspectiveSize(){var adjacent=this.perspective.position.z;var hypotenuse=adjacent/Math.cos(degreeToRadian(this.perspectiveFieldOfView/2));var opposite=Math.sin(degreeToRadian(this.perspectiveFieldOfView/2))*hypotenuse;return{width:opposite*3*this.perspective.aspect,height:opposite*2};}},{key:"changeCamera",value:function changeCamera(){if(this.current===this.perspective){this.current=this.ortho;}else{this.current=this.perspective;}}},{key:"zoomPerspective",value:function zoomPerspective(zoom,width,height){var current=this.solvePerspectiveSize();var perspectiveZoom=current.height/(height*zoom);this.perspectiveCameraDistance/=perspectiveZoom;if(this.perspectiveCameraDistance<ZOOM_PERSPECTIVE_MIN){this.perspectiveCameraDistance=ZOOM_PERSPECTIVE_MIN;}this.setPerspectiveCameraPositionByLookat(this.getLookAtPosition());}},{key:"zoomCamera",value:function zoomCamera(zoom,width,height){this.ortho.left=zoom*width/-2;this.ortho.right=zoom*width/2;this.ortho.top=zoom*height/2;this.ortho.bottom=zoom*height/-2;this.perspective.aspect=width/height;this.perspective.zoom=1;this.zoomPerspective(zoom,width,height);//this.perspective.position.z = 1000;
this.perspective.updateProjectionMatrix();this.ortho.updateProjectionMatrix();this.ortho.updateMatrixWorld();}},{key:"getPosition",value:function getPosition(){return new utils_Vector(this.current.position);}},{key:"getLookAtPosition",value:function getLookAtPosition(){return new utils_Vector(this.ortho.position.x,this.ortho.position.y-this.orthoCameraAngle,this.ortho.position.z-this.z);}},{key:"setByLookAtPosition",value:function setByLookAtPosition(position){this.ortho.position.x=position.x;this.ortho.position.y=position.y+this.orthoCameraAngle;this.setPerspectiveCameraPositionByLookat(this.getLookAtPosition());}},{key:"addPosition",value:function addPosition(position){this.ortho.position.x+=position.x;this.ortho.position.y+=position.y;this.perspective.position.x+=position.x;this.perspective.position.y+=position.y;}},{key:"setPosition",value:function setPosition(position){this.ortho.position.x=position.x;this.ortho.position.y=position.y;this.perspective.position.x+=position.x;this.perspective.position.y+=position.y;}},{key:"getCamera",value:function getCamera(){return this.current;}},{key:"setPerspectiveCameraPositionByLookat",value:function setPerspectiveCameraPositionByLookat(lookAt){var perspectivePositionVector=new utils_Vector(0,this.orthoCameraAngle/this.perspectiveRatio,this.z/this.perspectiveRatio).normalize();var perspectivePosition=new utils_Vector(lookAt).add(perspectivePositionVector.multiplyScalar(this.perspectiveCameraDistance));this.perspective.position.set(perspectivePosition.x,perspectivePosition.y,perspectivePosition.z);this.perspective.lookAt(new utils_Vector(lookAt).toThree());}},{key:"setCameraAngle",value:function setCameraAngle(newAngle){if(newAngle>0){newAngle=0;}if(newAngle<-this.z){newAngle=-this.z;}var currentLookat=this.getLookAtPosition().toThree();var delta=this.orthoCameraAngle-newAngle;this.ortho.position.set(this.ortho.position.x,this.ortho.position.y-delta,this.ortho.position.z);this.ortho.lookAt(currentLookat);this.orthoCameraAngle=newAngle;this.setPerspectiveCameraPositionByLookat(currentLookat);}}]);return GameCamera;}();/* harmony default export */ var game_GameCamera = (GameCamera_GameCamera);
// CONCATENATED MODULE: ./src/client/view/game/GameScene.js
window.THREE=three_module;var GameScene_GameScene=/*#__PURE__*/function(){function GameScene(phaseDirector,coordinateConverter){Object(classCallCheck["a" /* default */])(this,GameScene);this.phaseDirector=phaseDirector;this.coordinateConverter=coordinateConverter;this.hexGridRenderer=new HexGridRender();this.particleEmitterContainer=null;this.scene=null;this.camera=null;this.starFieldScene=null;this.starFieldCamera=null;this.starField=null;this.width=null;this.height=null;this.element=null;this.initialized=false;this.zoom=1;this.zoomTarget=this.zoom;this.cameraAngle=0;//-500;
this.deactivated=false;}Object(createClass["a" /* default */])(GameScene,[{key:"init",value:function init(element,_ref,gameId){var width=_ref.width,height=_ref.height;this.element=element;this.scene=new three_module["Scene"]();this.particleEmitterContainer=new particle_ParticleEmitterContainer(this.scene,2000);this.width=width;this.height=height;this.camera=new game_GameCamera(this.zoom,this.width,this.height,10000);this.coordinateConverter.init(this.camera,this.scene);this.phaseDirector.init(this.scene,this.particleEmitterContainer,this.camera);this.starFieldScene=new three_module["Scene"]();this.starFieldCamera=new three_module["OrthographicCamera"](this.zoom*this.width/-2,this.zoom*this.width/2,this.zoom*this.height/2,this.zoom*this.height/-2,-4000,30000);this.starFieldCamera.position.set(0,0,500);this.starFieldCamera.lookAt(0,0,100);this.light=new three_module["PointLight"](0xffffff,1.0,0);this.light.position.set(0,0,100000);this.scene.add(this.light);var directionalLight=new three_module["DirectionalLight"](0x35527a,0.005);directionalLight.position.set(0,0,1).normalize();this.scene.add(directionalLight);/*
    const directionalLight3 = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight3.position.set(0, 1, 1).normalize();
    directionalLight3.castShadow = true;
    //this.scene.add(directionalLight3);
    this.directionalLight3 = directionalLight3;

    //const directionalLight4 = new THREE.DirectionalLight(0x609dc1, 0.5);
    const directionalLight4 = new THREE.DirectionalLight(0xfff3a6, 0.02);
    directionalLight4.position.set(0, -1, 1);
    //this.scene.add(directionalLight4);
*/ /*
    const line = new Line(
      this.scene,
      { x: 406.5864317029974, y: 534.742785792575, z: 0 },
      { x: 567.692147554496, y: 627.757214207425, z: 0 },
      2,
      new THREE.Color(1, 0, 0)
    );

    new Line(
      this.scene,
      { x: 0, y: 0, z: 0 },
      { x: 0, y: 0, z: 100 },
      2,
      new THREE.Color(1, 0, 0)
    );

    */ /*
    const line2 = new Line(
      { x: 0, y: 0, z: 0 },
      { x: 0, y: 2000, z: 0 },
      10,
      new THREE.Color(1, 0, 0)
    );
    this.scene.add(line2.mesh);
    */ /*
    const helper = new THREE.DirectionalLightHelper(directionalLight4, 5);

    this.scene.add(helper);
    */ //this.scene.add(new THREE.AmbientLight(0x0a0f17));
this.renderer=new three_module["WebGLRenderer"]({alpha:true,antialias:true});this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(this.width,this.height);this.renderer.autoClear=false;this.renderer.context.getExtension("OES_standard_derivatives");this.renderer.context.getExtension("GL_OES_standard_derivatives");var gl=this.renderer.domElement.getContext("webgl")||this.renderer.domElement.getContext("experimental-webgl");gl.getExtension("OES_standard_derivatives");this.renderer.shadowMap.enabled=true;this.renderer.shadowMap.type=three_module["PCFShadowMap"];this.renderer.gammaOutput=true;this.renderer.gammaFactor=2.2;element.appendChild(this.renderer.domElement);this.initialized=true;this.hexGridRenderer.renderHexGrid(this.scene,ZOOM_MIN,ZOOM_MAX);this.starField=new terrain_StarField(this.starFieldScene,gameId);this.render();}},{key:"scroll",value:function scroll(delta){this.moveCamera({x:delta.x*(1/this.zoom),y:delta.y*(1/this.zoom)});}},{key:"moveCamera",value:function moveCamera(position){if(!this.initialized){return;}this.camera.addPosition({x:position.x*this.zoom*this.zoom*-1,y:position.y*this.zoom*this.zoom});//this.camera.position.x -= position.x * this.zoom * this.zoom;
//this.camera.position.y += position.y * this.zoom * this.zoom;
this.starFieldCamera.position.x-=position.x*this.zoom*this.zoom*0.05;this.starFieldCamera.position.y+=position.y*this.zoom*this.zoom*0.05;this.phaseDirector.relayEvent("ScrollEvent",this.camera.getPosition());}},{key:"moveCameraTo",value:function moveCameraTo(position){if(!this.initialized){return;}this.camera.setPosition({x:position.x,y:position.y});//this.camera.position.x = position.x;
//this.camera.position.y = position.y;
this.starFieldCamera.position.x=position.x*0.1;this.starFieldCamera.position.y=position.y*0.1;this.phaseDirector.relayEvent("ScrollEvent",this.camera.getPosition());}},{key:"zoomCamera",value:function zoomCamera(zoom,animationReady){this.zoom=zoom;if(!this.initialized){return;}this.camera.zoomCamera(this.zoom,this.width,this.height);this.coordinateConverter.onZoom(this.zoom);this.hexGridRenderer.onZoom(this.zoom);this.phaseDirector.relayEvent("ZoomEvent",{zoom:this.zoom,animationReady:Boolean(animationReady)});}},{key:"render",value:function render(){if(this.deactivated){return;}this.phaseDirector.render(this.scene,this.coordinateConverter,this.zoom);this.renderer.clear();this.renderer.render(this.starFieldScene,this.starFieldCamera);this.renderer.clearDepth();this.renderer.render(this.scene,this.camera.getCamera());this.animateZoom();this.starField.render();requestAnimationFrame(this.render.bind(this));}},{key:"animateZoom",value:function animateZoom(){if(this.zoomTarget&&this.zoomTarget!==this.zoom){var change=(this.zoomTarget-this.zoom)*0.1;if(Math.abs(change)<0.00001||this.zoomTarget===1&&Math.abs(change)<0.00001){this.zoomCamera(this.zoomTarget,true);}else{this.zoomCamera(this.zoom+change);}}}},{key:"onResize",value:function onResize(_ref2){var width=_ref2.width,height=_ref2.height;this.width=width;this.height=height;this.zoomCamera(this.zoom);this.renderer.setSize(window.innerWidth,window.innerHeight);this.starField.resize();}},{key:"changeZoom",value:function changeZoom(zoom){zoom*=0.5;if(zoom<-0.5)zoom=-0.5;this.zoominprogress=false;var newzoom=this.zoom+this.zoom*zoom;if(newzoom<ZOOM_MIN)newzoom=ZOOM_MIN;if(newzoom>ZOOM_MAX)newzoom=ZOOM_MAX;this.zoomTarget=newzoom;}},{key:"deactivate",value:function deactivate(){if(this.deactivated){return;}this.deactivated=true;this.element.removeChild(this.renderer.domElement);this.renderer.clear();this.renderer.forceContextLoss();this.renderer.domElement=null;this.renderer.dispose();this.renderer=null;}}]);return GameScene;}();/* harmony default export */ var game_GameScene = (GameScene_GameScene);
// CONCATENATED MODULE: ./src/client/view/game/Game.js
var Game_Game=/*#__PURE__*/function(){function Game(gameId,user,uiState){Object(classCallCheck["a" /* default */])(this,Game);this.gameId=gameId;this.currentUser=user;this.uiState=uiState;this.coordinateConverter=utils_CoordinateConverter;this.gameConnector=new game_GameConnector(gameId);this.phaseDirector=new phase_PhaseDirector(this.uiState,this.currentUser,this.coordinateConverter,this.gameConnector);this.gameScene=new game_GameScene(this.phaseDirector,this.coordinateConverter);this.gameSettings=new game_GameSettings().load();this.sceneElement=null;this.init=false;this.mouseOvered=null;this.mouseOveredHex=null;}Object(createClass["a" /* default */])(Game,[{key:"getUiState",value:function getUiState(){return this.uiState;}},{key:"initRender",value:function initRender(element){this.sceneElement=element;this.init=true;this.gameScene.init(element,this.getDimensions(),this.gameId);this.gameConnector.connect();this.onResize();}},{key:"onMouseWheel",value:function onMouseWheel(step){this.gameScene.changeZoom(step);}},{key:"onKeyDown",value:function onKeyDown(event){var action=this.gameSettings.matchEvent(event);this.uiState.customEvent(action,{up:false});}},{key:"onKeyUp",value:function onKeyUp(event){var action=this.gameSettings.matchEvent(event);this.uiState.customEvent(action,{up:true});}},{key:"onMouseUp",value:function onMouseUp(position,button){if(!this.init){return;}var gamePos=this.coordinateConverter.fromViewPortToGame(position);var entity=this.coordinateConverter.getEntitiesIntersected(position,true).shift();var hexPos=this.coordinateConverter.fromGameToHex(gamePos,true);var payload=new utils_PositionObject(position,gamePos,hexPos,entity);console.log(payload.hex);if(button&&button===2&&entity){this.phaseDirector.relayEvent("shipRightClicked",payload);}else if(entity){this.phaseDirector.relayEvent("shipClicked",payload);}else{this.phaseDirector.relayEvent("hexClicked",payload);}}},{key:"onDrag",value:function onDrag(position,delta){this.gameScene.scroll(delta);}},{key:"onMouseMove",value:function onMouseMove(position){var gamePos=this.coordinateConverter.fromViewPortToGame(position);var hexPos=this.coordinateConverter.fromGameToHex(gamePos);var entity=this.coordinateConverter.getEntitiesIntersected(position).shift();var payload=new utils_PositionObject(position,gamePos,hexPos,entity);if(this.mouseOvered&&entity&&this.mouseOvered!=entity){this.phaseDirector.relayEvent("mouseOutShip",Object(objectSpread2["a" /* default */])({},payload,{entity:this.mouseOvered}));this.phaseDirector.relayEvent("mouseOverShip",payload);this.mouseOvered=entity;}else if(this.mouseOvered==null&&entity){this.phaseDirector.relayEvent("mouseOverShip",payload);this.mouseOvered=entity;}else if(this.mouseOvered&&!entity){this.phaseDirector.relayEvent("mouseOutShip",Object(objectSpread2["a" /* default */])({},payload,{entity:this.mouseOvered}));this.mouseOvered=null;}if(!entity){if(this.mouseOveredHex&&!this.mouseOveredHex.equals(payload.hex)){this.phaseDirector.relayEvent("mouseOutHex",this.mouseOveredHex);this.phaseDirector.relayEvent("mouseOverHex",payload.hex);this.mouseOveredHex=payload.hex;}else if(!this.mouseOveredHex){this.phaseDirector.relayEvent("mouseOverHex",payload.hex);this.mouseOveredHex=payload.hex;}}else if(entity&&this.mouseOveredHex){this.phaseDirector.relayEvent("mouseOutHex",this.mouseOveredHex);this.mouseOveredHex=null;}}},{key:"onMouseOut",value:function onMouseOut(){this.phaseDirector.relayEvent("mouseOut");}},{key:"onResize",value:function onResize(){if(!this.sceneElement){return;}var dimensions=this.getDimensions();this.coordinateConverter.onResize(dimensions);this.gameScene.onResize(dimensions);}},{key:"getDimensions",value:function getDimensions(){return{width:this.sceneElement.offsetWidth,height:this.sceneElement.offsetHeight};}},{key:"deactivate",value:function deactivate(){this.gameConnector.deactivate();this.phaseDirector.deactivate();this.gameScene.deactivate();}}]);return Game;}();/* harmony default export */ var game_Game = (Game_Game);
// CONCATENATED MODULE: ./src/client/view/game/ui/UIState.js
var UIState_UIState=/*#__PURE__*/function(){function UIState(){Object(classCallCheck["a" /* default */])(this,UIState);this.phaseDirector=null;this.services=null;this.renderListeners=[];this.systemChangeListeners=[];this.state={lobby:false,gameData:null,selectedShip:null,selectedSystems:[],systemInfo:null,systemInfoMenu:null,shipMovement:null,shipTooltip:[],turnReady:false,shipTooltipMenuProvider:null,systemMenu:{systemInfoMenuProvider:null,activeSystem:null,activeSystemElement:null},shipBadges:[],gameUiMode:{},gameUiModeButtons:false,replayUi:false,combatLog:false,systemList:[],ewList:[],stateVersion:0};this.state.gameUiMode[EW]=false;this.state.gameUiMode[ENEMY_WEAPONS]=false;this.state.gameUiMode[WEAPONS]=false;this.state.gameUiMode[MOVEMENT]=false;}Object(createClass["a" /* default */])(UIState,[{key:"setDispatch",value:function setDispatch(dispatch){this.dispatch=dispatch;}},{key:"getReducer",value:function getReducer(){return this.reducer.bind(this);}},{key:"getInitialState",value:function getInitialState(){return this.state;}},{key:"reducer",value:function reducer(state,action){this.state=Object(objectSpread2["a" /* default */])({},state,{},action);return this.state;}},{key:"showShipBadge",value:function showShipBadge(icon,showName){var entry=this.state.shipBadges.find(function(badge){return badge.icon.ship.id===icon.ship.id;});if(entry){entry.icon=icon;entry.version++;entry.showName=showName;entry.visible=true;}else{this.state.shipBadges.push({icon:icon,version:0,showName:showName,visible:true});}this.updateState();}},{key:"hideShipBadge",value:function hideShipBadge(icon){var entry=this.state.shipBadges.find(function(badge){return badge.icon.ship.id===icon.ship.id;});if(entry){entry.visible=false;entry.version++;this.updateState();}}},{key:"removeShipBadge",value:function removeShipBadge(icon){this.state.shipBadges=this.state.shipBadges.filter(function(entry){return entry.icon.ship.id!==icon.ship.id;});this.updateState();}},{key:"setEwList",value:function setEwList(entries){this.state.ewList=entries;}},{key:"setSystemList",value:function setSystemList(systems){this.state.systemList=systems;this.updateState();}},{key:"isSelectedSystem",value:function isSelectedSystem(system){return this.state.selectedSystems.includes(system);}},{key:"selectSystem",value:function selectSystem(ship,systems){var _this=this;if(this.getSelectedShip()!==ship){this.selectShip(ship);}systems=[].concat(systems).filter(function(system){return!_this.isSelectedSystem(system);}).forEach(function(system){return _this.state.selectedSystems.push(system);});this.updateState();this.customEvent("systemSelected",{systems:systems});}},{key:"deselectSystem",value:function deselectSystem(systems){systems=[].concat(systems);this.state.selectedSystems=this.state.selectedSystems.filter(function(selected){return systems.every(function(system){return system.id!==selected.id;});});this.updateState();this.customEvent("systemDeselected",{systems:systems});}},{key:"deselectAllSystems",value:function deselectAllSystems(){var systems=this.state.selectedSystems;this.state.selectedSystems=[];this.updateState();this.customEvent("systemDeselected",{systems:systems});}},{key:"getSelectedSystems",value:function getSelectedSystems(){return this.state.selectedSystems;}},{key:"hasGameUiMode",value:function hasGameUiMode(values){var _this2=this;values=[].concat(values);return values.some(function(value){return _this2.state.gameUiMode[value];});}},{key:"toggleGameUiMode",value:function toggleGameUiMode(value){this.state.gameUiMode[value]=!this.state.gameUiMode[value];this.updateState();}},{key:"showUiModeButtons",value:function showUiModeButtons(value){this.state.gameUiModeButtons=value;this.updateState();}},{key:"showReplayUi",value:function showReplayUi(value){this.state.replayUi=value;this.updateState();}},{key:"startCombatLog",value:function startCombatLog(replayContext,gameData){this.state.combatLog={gameData:gameData,replayContext:replayContext,log:[]};}},{key:"addToCombatLog",value:function addToCombatLog(value){if(this.state.combatLog===false){throw new Error("Start combat log first");}this.state.combatLog.log.push(value);this.updateState();}},{key:"hideCombatLog",value:function hideCombatLog(){this.state.combatLog=false;this.updateState();}},{key:"startReplay",value:function startReplay(){this.phaseDirector.startReplay();this.updateState();}},{key:"closeReplay",value:function closeReplay(){this.phaseDirector.closeReplay();this.updateState();}},{key:"isReplay",value:function isReplay(){return this.state.replay;}},{key:"update",value:function update(gameData){var _this3=this;this.gameData=gameData;if(this.state.selectedShip){this.selectShip(this.gameData.ships.getShipById(this.state.selectedShip.id));this.selectSystem(this.getSelectedShip(),this.state.selectedSystems.map(function(system){return _this3.getSelectedShip().systems.getSystemById(system.id);}));}}},{key:"setTurnReady",value:function setTurnReady(ready){this.state.turnReady=ready;this.updateState();}},{key:"setWaiting",value:function setWaiting(waiting){this.state.waiting=waiting;this.updateState();}},{key:"setPhaseDirector",value:function setPhaseDirector(phaseDirector){this.phaseDirector=phaseDirector;this.services=phaseDirector.getServices();}},{key:"customEvent",value:function customEvent(name,payload){if(!this.phaseDirector){return;}this.phaseDirector.relayEvent(name,payload);}},{key:"commitTurn",value:function commitTurn(){this.phaseDirector.commitTurn();}},{key:"selectShip",value:function selectShip(ship){if(this.getSelectedShip()===ship){return;}this.deselectShip();this.state.selectedShip=ship;this.updateState();this.customEvent("shipSelected",ship);}},{key:"deselectShip",value:function deselectShip(){var ship=this.state.selectedShip;this.state.selectedShip=null;this.updateState();this.deselectAllSystems();if(ship){this.customEvent("shipDeselected",ship);}}},{key:"getSelectedShip",value:function getSelectedShip(){return this.state.selectedShip;}},{key:"isSelected",value:function isSelected(ship){return this.state.selectedShip===ship;}},{key:"updateState",value:function updateState(){//this.state.stateVersion++;
this.dispatch(this.state);this.customEvent("uiStateChanged");}},{key:"setTooltipMenuProvider",value:function setTooltipMenuProvider(callBack){this.state.shipTooltipMenuProvider=callBack;this.updateState();}},{key:"setSystemInfoMenuProvider",value:function setSystemInfoMenuProvider(callBack){this.state.systemMenu.systemInfoMenuProvider=callBack;this.updateState();}},{key:"setSystemMenuActiveSystem",value:function setSystemMenuActiveSystem(system,element){this.state.systemMenu.activeSystem=system;this.state.systemMenu.activeSystemElement=element;this.updateState();}},{key:"setGameData",value:function setGameData(gameData){this.state.gameData=gameData.serialize();this.updateState();}},{key:"setLobby",value:function setLobby(status){this.state.lobby=status;this.updateState();}},{key:"getState",value:function getState(){return this.state;}},{key:"showSystemInfo",value:function showSystemInfo(args){this.state.systemInfo=args;this.updateState();}},{key:"hideSystemInfo",value:function hideSystemInfo(){this.state.systemInfo=null;this.updateState();}},{key:"showSystemInfoMenu",value:function showSystemInfoMenu(args){this.state.systemInfoMenu=args;this.updateState();}},{key:"hideSystemInfoMenu",value:function hideSystemInfoMenu(){this.state.systemInfoMenu=null;this.updateState();}},{key:"shipStateChanged",value:function shipStateChanged(ship){this.customEvent("shipStateChanged",ship);}},{key:"shipSystemStateChanged",value:function shipSystemStateChanged(ship,system){this.customEvent("shipSystemStateChanged",{ship:ship,system:system});this.systemChangeListeners.forEach(function(callBack){return callBack(ship,system);});}},{key:"showShipTooltip",value:function showShipTooltip(ship){var ui=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var right=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;this.hideShipTooltip(ship);this.state.shipTooltip.push({ship:ship,ui:ui,right:!right});this.updateState();}},{key:"hideShipTooltip",value:function hideShipTooltip(ship){this.state.shipTooltip=this.state.shipTooltip.filter(function(tooltip){return tooltip.ship.id!==ship.id;});this.customEvent("shipTooltipHidden",ship);this.updateState();}},{key:"showShipDeploymentMovement",value:function showShipDeploymentMovement(ship){var _this$services=this.services,shipIconContainer=_this$services.shipIconContainer,coordinateConverter=_this$services.coordinateConverter,movementService=_this$services.movementService;this.state.shipMovement={ship:ship,type:"deploy",movementService:movementService,getPosition:function getPosition(){return coordinateConverter.fromGameToViewPort(shipIconContainer.getByShip(ship).getPosition());}};this.updateState();}},{key:"showShipMovement",value:function showShipMovement(ship){var _this$services2=this.services,shipIconContainer=_this$services2.shipIconContainer,coordinateConverter=_this$services2.coordinateConverter,movementService=_this$services2.movementService;this.state.shipMovement={ship:ship,type:"game",movementService:movementService,getPosition:function getPosition(){return coordinateConverter.fromGameToViewPort(shipIconContainer.getByShip(ship).getPosition());}};this.updateState();}},{key:"hideShipMovement",value:function hideShipMovement(){this.state.shipMovement=null;this.updateState();}},{key:"render",value:function render(){this.renderListeners.forEach(function(listener){return listener();});}},{key:"subscribeToRender",value:function subscribeToRender(callBack){this.renderListeners.push(callBack);}},{key:"unsubscribeFromRender",value:function unsubscribeFromRender(callBack){this.renderListeners=this.renderListeners.filter(function(listener){return listener!==callBack;});}},{key:"subscribeToSystemChange",value:function subscribeToSystemChange(callBack){this.systemChangeListeners.push(callBack);}},{key:"unsubscribeFromSystemChange",value:function unsubscribeFromSystemChange(callBack){this.systemChangeListeners=this.systemChangeListeners.filter(function(listener){return listener!==callBack;});}}]);return UIState;}();/* harmony default export */ var ui_UIState = (UIState_UIState);
// CONCATENATED MODULE: ./src/client/view/game/components/lobby/PurchasedShip.js
function PurchasedShip_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border: 1px solid black;\n  width: 200px;\n  padding: 8px;\n"]);PurchasedShip_templateObject=function _templateObject(){return data;};return data;}var PurchasedShip_Container=styled_components_browser_esm["b" /* default */].div(PurchasedShip_templateObject());function PurchasedShip(_ref){var ship=_ref.ship,uiState=_ref.uiState;var openShipWindow=Object(react["useCallback"])(function(){uiState.showShipTooltip(ship,true,true);},[uiState,ship]);var _useState=Object(react["useState"])("Ship must have a name"),_useState2=Object(slicedToArray["a" /* default */])(_useState,2),error=_useState2[0],setError=_useState2[1];return react_default.a.createElement(PurchasedShip_Container,null,react_default.a.createElement(Button_Button,{buttonStyle:"text",onClick:openShipWindow},ship.shipTypeName," ",react_default.a.createElement(Value,null,ship.pointCost)," points"),react_default.a.createElement(InputAndLabel_InputAndLabel,{error:error,label:"Name",onChange:function onChange(e){ship.name=e.target.value;if(!ship.name){setError("Ship must have a name");}else{setError(null);}}}));}
// CONCATENATED MODULE: ./src/client/view/game/components/lobby/FleetList.js
function FleetList_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-wrap: wrap;\n  width: 440px;\n  justify-content: space-around;\n  margin-top: 16px;\n"]);FleetList_templateObject=function _templateObject(){return data;};return data;}var FleetContainer=styled_components_browser_esm["b" /* default */].div(FleetList_templateObject());var FleetList_FleetList=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(FleetList,_Component);function FleetList(){Object(classCallCheck["a" /* default */])(this,FleetList);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(FleetList).apply(this,arguments));}Object(createClass["a" /* default */])(FleetList,[{key:"openShipWindow",value:function openShipWindow(ship){var _this=this;return function(){var uiState=_this.props.uiState;uiState.showShipTooltip(ship,true,true);};}},{key:"render",value:function render(){var _this$props=this.props,ships=_this$props.ships,onReady=_this$props.onReady,bought=_this$props.bought,uiState=_this$props.uiState;return react_default.a.createElement(DarkContainer,null,react_default.a.createElement(Section,null,react_default.a.createElement(SubTitle,null,"Current fleet for slot"),react_default.a.createElement(SectionRight,null,!bought&&ships.length>0&&react_default.a.createElement(Button_Button,{buttonStyle:"button",onClick:onReady},"Ready"))),react_default.a.createElement(FleetContainer,null,ships.map(function(ship,i){return react_default.a.createElement(PurchasedShip,{key:"fleetlist-ship-".concat(i),ship:ship,uiState:uiState});})));}}]);return FleetList;}(react["Component"]);/* harmony default export */ var lobby_FleetList = (FleetList_FleetList);
// CONCATENATED MODULE: ./src/client/view/createGame/Slot.js
function Slot_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n"]);Slot_templateObject2=function _templateObject2(){return data;};return data;}function Slot_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  box-shadow: 0px 0px 3px 3px rgba(222, 235, 255, 0.5);\n  color: #0a3340;\n  background-color: ",";\n  border-color: ",";\n"]);Slot_templateObject=function _templateObject(){return data;};return data;}var Slot_selected=Object(styled_components_browser_esm["a" /* css */])(Slot_templateObject(),Colors_namespaceObject.border,Colors_namespaceObject.blue);var SlotContainer=Object(styled_components_browser_esm["b" /* default */])(Container)(Slot_templateObject2(),function(props){return props.selected?Slot_selected:"";});var Slot_Slot=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(Slot,_Component);function Slot(){Object(classCallCheck["a" /* default */])(this,Slot);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Slot).apply(this,arguments));}Object(createClass["a" /* default */])(Slot,[{key:"handleChange",value:function handleChange(){}},{key:"getPlayerName",value:function getPlayerName(slot){var gameData=this.props.gameData;var user=gameData.players.find(function(user){return user.id===slot.userId;});return user.username;}},{key:"leaveSlot",value:function leaveSlot(slot){var _this=this;return function(){var uiState=_this.props.uiState;uiState.customEvent("leaveSlot",slot);};}},{key:"takeSlot",value:function takeSlot(slot){var _this2=this;return function(){var uiState=_this2.props.uiState;uiState.customEvent("takeSlot",slot);};}},{key:"render",value:function render(){var _this$props=this.props,slot=_this$props.slot,edit=_this$props.edit,take=_this$props.take,currentUser=_this$props.currentUser,selectedSlot=_this$props.selectedSlot,children=_this$props.children;return react_default.a.createElement(SlotContainer,{selected:selectedSlot&&selectedSlot.id===slot.id},react_default.a.createElement(Section,null,edit?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(InputAndLabel_InputAndLabel,{label:"Slot name",id:"slotName-".concat(slot.name),placeholder:"slot name",value:slot.name,onChange:this.handleChange,error:!slot.name?"Name is required":false}),react_default.a.createElement(InputAndLabel_InputAndLabel,{label:"Points",id:"slotPoints-".concat(slot.name),placeholder:"5000",value:slot.points,onChange:this.handleChange,error:slot.points!==parseInt(slot.points,10)||slot.points<=0?"Points must be a positive number":false})):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Title,null,slot.name),react_default.a.createElement(Title,null,"Points: ",react_default.a.createElement(Value,null,slot.points)),react_default.a.createElement(SectionRight,null,slot.isTaken()&&react_default.a.createElement(Title,null,"Player: ",react_default.a.createElement(Value,null,this.getPlayerName(slot))),currentUser&&!slot.isTaken()&&take&&react_default.a.createElement(Button_Button,{onClick:this.takeSlot(slot),type:"button",buttonStyle:"button-grey"},"Take slot"),take&&currentUser&&slot.isOccupiedBy(currentUser)&&react_default.a.createElement(Button_Button,{onClick:this.leaveSlot(slot),type:"button",icon:icon_namespaceObject.X})))),react_default.a.createElement(Section,null,edit?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(InputAndLabel_InputAndLabel,{label:"Deployment position (X,Y):",id:"deploymentPosition-".concat(slot.name),placeholder:"0",value:"".concat(slot.deploymentLocation.q,",").concat(slot.deploymentLocation.r),onChange:this.handleChange}),react_default.a.createElement(InputAndLabel_InputAndLabel,{label:"Deployment vector (X,Y):",id:"deploymentVector-".concat(slot.name),placeholder:"0",value:"".concat(slot.deploymentVector.q,",").concat(slot.deploymentVector.r),onChange:this.handleChange})):react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Label,null,"Deployment position:",react_default.a.createElement(Value,null," ".concat(slot.deploymentLocation.q,",").concat(slot.deploymentLocation.r))),react_default.a.createElement(Label,null,"Deployment vector:",react_default.a.createElement(Value,null,"".concat(slot.deploymentVector.q,",").concat(slot.deploymentVector.r))),react_default.a.createElement(Label,null,"Deployment radius: ",react_default.a.createElement(Value,null," ",slot.deploymentRadius)))),react_default.a.createElement(Section,null,edit&&react_default.a.createElement(InputAndLabel_InputAndLabel,{label:"Deployment radius:",id:"deploymentRadius-".concat(slot.name),placeholder:"0",value:slot.deploymentRadius,onChange:this.handleChange})),children);}}]);return Slot;}(react["Component"]);/* harmony default export */ var createGame_Slot = (Slot_Slot);
// CONCATENATED MODULE: ./src/client/view/game/components/lobby/LobbySlots.js
var LobbySlots_LobbySlots=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(LobbySlots,_Component);function LobbySlots(){Object(classCallCheck["a" /* default */])(this,LobbySlots);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(LobbySlots).apply(this,arguments));}Object(createClass["a" /* default */])(LobbySlots,[{key:"mapTeamsToComponents",value:function mapTeamsToComponents(){var _this=this;var _this$props=this.props,gameData=_this$props.gameData,selectedSlot=_this$props.selectedSlot,ships=_this$props.ships,uiState=_this$props.uiState,onReady=_this$props.onReady;return gameData.slots.getSlotsByTeams().map(function(team){return react_default.a.createElement(DarkContainer,{key:"team-".concat(team.team)},react_default.a.createElement(Title,null,"TEAM: ",team.team),team.slots.map(function(slot){if(selectedSlot&&slot.id===selectedSlot.id){return react_default.a.createElement(createGame_Slot,Object.assign({key:slot.id,slot:slot},_this.props),react_default.a.createElement(lobby_FleetList,{bought:slot.isBought(),onReady:onReady,uiState:uiState,ships:ships}));}else{return react_default.a.createElement(createGame_Slot,Object.assign({key:slot.id,slot:slot},_this.props));}}));});}},{key:"render",value:function render(){return react_default.a.createElement(react_default.a.Fragment,null,this.mapTeamsToComponents());}}]);return LobbySlots;}(react["Component"]);/* harmony default export */ var lobby_LobbySlots = (LobbySlots_LobbySlots);
// CONCATENATED MODULE: ./src/model/unit/ships/factions.mjs
var factions_Faction=function Faction(name,ships){Object(classCallCheck["a" /* default */])(this,Faction);this.name=name;this.ships=ships;};/* harmony default export */ var factions = ([new factions_Faction("United Colonies",["UcRhino","Haka"]),new factions_Faction("The Expanse Protecorate",["Caliope","Fulcrum","Mouros"]),new factions_Faction("Federation Navy",["Impetous"])]);
// CONCATENATED MODULE: ./src/client/view/game/components/lobby/Faction.js
var Faction_Faction=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(Faction,_Component);function Faction(){Object(classCallCheck["a" /* default */])(this,Faction);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Faction).apply(this,arguments));}Object(createClass["a" /* default */])(Faction,[{key:"buyShip",value:function buyShip(className){var buyShip=this.props.buyShip;return function(){buyShip(className);};}},{key:"openShipWindow",value:function openShipWindow(ship){var _this=this;return function(){var uiState=_this.props.uiState;uiState.showShipTooltip(ship,true,true);};}},{key:"render",value:function render(){var _this2=this;var faction=this.props.faction;return react_default.a.createElement("div",null,react_default.a.createElement(SubTitle,null,faction.name),faction.ships.map(function(ship){return new unit_ships[ship]();}).map(function(ship){return react_default.a.createElement(Section,{key:"fleetStoreEntry-".concat(ship.shipClass)},react_default.a.createElement(Button_Button,{buttonStyle:"text",onClick:_this2.openShipWindow(ship)},ship.shipTypeName," ",react_default.a.createElement(Value,null,ship.pointCost)," points"),react_default.a.createElement(Button_Button,{buttonStyle:"button",onClick:_this2.buyShip(ship.shipClass)},"Add to fleet"));}));}}]);return Faction;}(react["Component"]);/* harmony default export */ var lobby_Faction = (Faction_Faction);
// CONCATENATED MODULE: ./src/client/view/game/components/lobby/FleetStore.js
function FleetStore_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  flex-grow: 1;\n  margin-left: 10px;\n"]);FleetStore_templateObject=function _templateObject(){return data;};return data;}var FleetStore_FleetContainer=Object(styled_components_browser_esm["b" /* default */])(DarkContainer)(FleetStore_templateObject());var FleetStore_FleetStore=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(FleetStore,_Component);function FleetStore(){Object(classCallCheck["a" /* default */])(this,FleetStore);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(FleetStore).apply(this,arguments));}Object(createClass["a" /* default */])(FleetStore,[{key:"render",value:function render(){var _this=this;return react_default.a.createElement(FleetStore_FleetContainer,null,factions.map(function(faction){return react_default.a.createElement(lobby_Faction,Object.assign({key:faction.name,faction:faction},_this.props));}));}}]);return FleetStore;}(react["Component"]);/* harmony default export */ var lobby_FleetStore = (FleetStore_FleetStore);
// CONCATENATED MODULE: ./src/client/view/baseView/HomeScene.js
window.THREE=three_module;var HomeScene_HomeScene=/*#__PURE__*/function(){function HomeScene(){Object(classCallCheck["a" /* default */])(this,HomeScene);this.starFieldScene=null;this.starFieldCamera=null;this.starField=null;this.width=null;this.height=null;this.element=null;this.initialized=false;this.zoom=1;}Object(createClass["a" /* default */])(HomeScene,[{key:"init",value:function init(element,_ref){var width=_ref.width,height=_ref.height;this.element=element;this.scene=new three_module["Scene"]();this.width=width;this.height=height;this.starFieldScene=new three_module["Scene"]();this.starFieldCamera=new three_module["OrthographicCamera"](this.zoom*this.width/-2,this.zoom*this.width/2,this.zoom*this.height/2,this.zoom*this.height/-2,-4000,30000);this.starFieldCamera.position.set(0,0,500);this.starFieldCamera.lookAt(0,0,100);this.renderer=new three_module["WebGLRenderer"]({alpha:true,antialias:true});this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(this.width,this.height);this.renderer.autoClear=false;this.renderer.context.getExtension("OES_standard_derivatives");this.renderer.gammaOutput=true;this.renderer.gammaFactor=2.2;element.appendChild(this.renderer.domElement);this.initialized=true;this.starField=new terrain_StarField(this.starFieldScene,"home");this.render();}},{key:"render",value:function render(){this.renderer.clear();this.renderer.render(this.starFieldScene,this.starFieldCamera);this.starField.render();requestAnimationFrame(this.render.bind(this));}},{key:"onResize",value:function onResize(_ref2){var width=_ref2.width,height=_ref2.height;this.width=width;this.height=height;this.renderer.setSize(window.innerWidth,window.innerHeight);this.starField.resize();}}]);return HomeScene;}();/* harmony default export */ var baseView_HomeScene = (HomeScene_HomeScene);
// CONCATENATED MODULE: ./src/client/view/baseView/HomeSceneComponent.js
function HomeSceneComponent_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: fixed;\n  top: 0px;\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  display: flex;\n  background-size: cover;\n  background-color: #0b121a;\n  box-shadow: inset 0px 0px 200px rgba(0, 0, 0, 1);\n  z-index: -2;\n"]);HomeSceneComponent_templateObject=function _templateObject(){return data;};return data;}var HomeSceneComponent_WebglCanvas=styled_components_browser_esm["b" /* default */].div(HomeSceneComponent_templateObject());var HomeSceneComponent_HomeSceneComponent=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(HomeSceneComponent,_React$Component);function HomeSceneComponent(props){var _this;Object(classCallCheck["a" /* default */])(this,HomeSceneComponent);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(HomeSceneComponent).call(this,props));_this.canvasRef=react["createRef"]();_this.scene=new baseView_HomeScene();return _this;}Object(createClass["a" /* default */])(HomeSceneComponent,[{key:"componentDidMount",value:function componentDidMount(){window.addEventListener("resize",this.onResize.bind(this));var sceneElement=this.canvasRef.current;this.scene.init(sceneElement,this.getDimensions());}},{key:"getDimensions",value:function getDimensions(){return{width:this.canvasRef.current.offsetWidth,height:this.canvasRef.current.offsetHeight};}},{key:"componentWillUnmount",value:function componentWillUnmount(){window.removeEventListener("resize",this.onResize.bind(this));}},{key:"onResize",value:function onResize(){if(!this.canvasRef.current){return;}var dimensions=this.getDimensions();this.scene.onResize(dimensions);}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(nextProps,nextState){return false;}},{key:"render",value:function render(){return react["createElement"](HomeSceneComponent_WebglCanvas,{ref:this.canvasRef});}}]);return HomeSceneComponent;}(react["Component"]);/* harmony default export */ var baseView_HomeSceneComponent = (HomeSceneComponent_HomeSceneComponent);
// CONCATENATED MODULE: ./src/client/view/createGame/Slots.js
function Slots_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin: 0 8px 8px 8px;\n"]);Slots_templateObject=function _templateObject(){return data;};return data;}var Slots_Container=styled_components_browser_esm["b" /* default */].div(Slots_templateObject());var Slots_Slots=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(Slots,_Component);function Slots(){Object(classCallCheck["a" /* default */])(this,Slots);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Slots).apply(this,arguments));}Object(createClass["a" /* default */])(Slots,[{key:"mapTeamsToComponents",value:function mapTeamsToComponents(){var _this=this;var gameData=this.props.gameData;return gameData.slots.getSlotsByTeams().map(function(team){return react_default.a.createElement(Slots_Container,null,react_default.a.createElement(DarkContainer,{key:"team-".concat(team.team)},react_default.a.createElement(Title,null,"TEAM: ",team.team),team.slots.map(function(slot){return react_default.a.createElement(createGame_Slot,Object.assign({key:slot.id,slot:slot},_this.props));})));});}},{key:"handleChange",value:function handleChange(){}},{key:"render",value:function render(){return react_default.a.createElement(react_default.a.Fragment,null,this.mapTeamsToComponents());}}]);return Slots;}(react["Component"]);/* harmony default export */ var createGame_Slots = (Slots_Slots);
// CONCATENATED MODULE: ./src/client/view/createGame/CreateGame.js
function CreateGame_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 1200px;\n"]);CreateGame_templateObject=function _templateObject(){return data;};return data;}var CreateGame_Container=styled_components_browser_esm["b" /* default */].div(CreateGame_templateObject());var CreateGame_CreateGame=function CreateGame(_ref){var location=_ref.location;var state=Object(react["useContext"])(StateStore);var user=state.currentUser;var _useState=Object(react["useState"])(new game_GameData()),_useState2=Object(slicedToArray["a" /* default */])(_useState,2),gameData=_useState2[0],setGameData=_useState2[1];Object(react["useEffect"])(function(){gameData.slots.addSlot(new game_GameSlot({name:"Blue",team:1,points:3000,userId:user.id,deploymentLocation:new hexagon.Offset(-150,0),deploymentVector:new hexagon.Offset(10,0)}));gameData.slots.addSlot(new game_GameSlot({name:"Red",team:2,points:3000,userId:null,deploymentLocation:new hexagon.Offset(150,0),deploymentVector:new hexagon.Offset(-10,0)}));gameData.addPlayer(user);gameData.name="Test game";setGameData(gameData.clone());},[setGameData]);var changeGameName=Object(react["useCallback"])(function(e){gameData.name=e.target.value;setGameData(gameData.clone());},[gameData,setGameData]);var createGameCallBack=Object(react["useCallback"])(function(){Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var response;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return game_createGame(gameData);case 3:response=_context.sent;gameData.id=response.data.gameId;setGameData(gameData.clone());_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);console.error(_context.t0);case 11:case"end":return _context.stop();}}},_callee,null,[[0,8]]);}))();},[gameData,setGameData]);if(gameData.id){return react_default.a.createElement(react_router["a" /* Redirect */],{to:{pathname:"/game/".concat(gameData.id),state:{from:location}}});}return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(TooltipContainer,null,react_default.a.createElement(TooltipHeader,null,"Create game",react_default.a.createElement(LinkInline,{to:"/"},react_default.a.createElement(Button_CloseButton,null))),react_default.a.createElement(InputAndLabel_InputAndLabel,{placeholder:"name",value:gameData.name,onChange:changeGameName,error:!gameData.name?"Name is required":false}),react_default.a.createElement(createGame_Slots,{gameData:gameData}),react_default.a.createElement(Button_Button,{buttonStyle:"button-grey",onClick:createGameCallBack},"Create game")));};/* harmony default export */ var createGame_CreateGame = (CreateGame_CreateGame);
// CONCATENATED MODULE: ./src/client/view/createGame/index.js
/* harmony default export */ var view_createGame = (createGame_CreateGame);
// CONCATENATED MODULE: ./src/client/view/home/Home.js
function Home_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin: 8px;\n  text-transform: uppercase;\n"]);Home_templateObject=function _templateObject(){return data;};return data;}var GameIdContainer=styled_components_browser_esm["b" /* default */].div(Home_templateObject());var Home_Home=function Home(){var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;var _useState=Object(react["useState"])(null),_useState2=Object(slicedToArray["a" /* default */])(_useState,2),gameId=_useState2[0],setGameId=_useState2[1];var createGame=Object(react["useCallback"])(function(){var callApi=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var response;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return createTestGameGame();case 2:response=_context.sent;console.log(response);setGameId(response.data.gameId);case 5:case"end":return _context.stop();}}},_callee);}));return function callApi(){return _ref.apply(this,arguments);};}();callApi();},[setGameId,createTestGameGame]);return react_default.a.createElement(TooltipContainer,null,react_default.a.createElement(TooltipHeader,null,"Home"),currentUser&&(currentUser.id===1||currentUser.id===2)&&react_default.a.createElement(Button_Button,{type:"button",buttonStyle:"button-grey",onClick:createGame},"Create test game"),gameId&&react_default.a.createElement(GameIdContainer,null,react_default.a.createElement(Label,null,"Game created:"),react_default.a.createElement(Value,null,react_default.a.createElement(LinkInline,{to:"/game/".concat(gameId)},"/game/".concat(gameId)))));};/* harmony default export */ var home_Home = (Home_Home);
// CONCATENATED MODULE: ./src/client/view/home/index.js
/* harmony default export */ var home = (home_Home);
// EXTERNAL MODULE: ./node_modules/formik/dist/formik.esm.js + 114 modules
var formik_esm = __webpack_require__(152);

// EXTERNAL MODULE: ./node_modules/yup/lib/index.js
var lib = __webpack_require__(68);

// CONCATENATED MODULE: ./src/client/view/login/Login.js
function Login_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin: 0 8px 8px 8px;\n"]);Login_templateObject=function _templateObject(){return data;};return data;}var ErrorContainer=styled_components_browser_esm["b" /* default */].div(Login_templateObject());var Login_Login=function Login(_ref){var className=_ref.className;var dispatch=Object(react["useContext"])(DispatchStore);var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;var _useState=Object(react["useState"])(null),_useState2=Object(slicedToArray["a" /* default */])(_useState,2),error=_useState2[0],setError=_useState2[1];var onSubmit=/*#__PURE__*/function(){var _ref2=Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(values,_ref3){var setSubmitting;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setSubmitting=_ref3.setSubmitting;_context.prev=1;_context.next=4;return login(values.username,values.password);case 4:_context.next=6;return actions_getCurrentUser(dispatch);case 6:setSubmitting(false);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](1);if(_context.t0.status===401){setError("Wrong password or user not found.");}case 12:setSubmitting(false);case 13:case"end":return _context.stop();}}},_callee,null,[[1,9]]);}));return function onSubmit(_x,_x2){return _ref2.apply(this,arguments);};}();if(currentUser){return react_default.a.createElement(TooltipContainer,null,react_default.a.createElement(TooltipHeader,null,"You are logged in as ",react_default.a.createElement(Value,null,currentUser.username)),react_default.a.createElement(Link,{to:"/logout"},react_default.a.createElement(Button_Button,{buttonStyle:"button-grey"},"Log out")));}return react_default.a.createElement(formik_esm["a" /* Formik */],{initialValues:{username:"",password:""},onSubmit:onSubmit,validationSchema:lib["object"]().shape({username:lib["string"]().required("Required"),password:lib["string"]().required("Required")})},function(props){var values=props.values,touched=props.touched,errors=props.errors,isSubmitting=props.isSubmitting,handleChange=props.handleChange,handleBlur=props.handleBlur,handleSubmit=props.handleSubmit;var wrappedHandleChange=function wrappedHandleChange(event){setError(null);handleChange(event);};return react_default.a.createElement(TooltipContainer,{className:className,as:"form",onSubmit:handleSubmit},react_default.a.createElement(TooltipHeader,null,"Login"),react_default.a.createElement(Section,null,react_default.a.createElement(Cell50,null,react_default.a.createElement(InputAndLabel_InputAndLabel,{label:"Username",id:"username",placeholder:"Username",value:values.username,onChange:wrappedHandleChange,onBlur:handleBlur,error:touched.username&&errors.username})),react_default.a.createElement(Cell50,null,react_default.a.createElement(InputAndLabel_InputAndLabel,{label:"Password",id:"password",placeholder:"Password",value:values.password,onChange:wrappedHandleChange,onBlur:handleBlur,error:touched.password&&errors.password,type:"password"}))),error&&react_default.a.createElement(ErrorContainer,null,react_default.a.createElement(Error_Error,null,error)),react_default.a.createElement(Section,null,react_default.a.createElement(Button_Button,{buttonStyle:"button-grey",type:"submit",disabled:isSubmitting||Object.entries(errors).length!==0},"Login"),react_default.a.createElement(Button_Button,{buttonStyle:"button-grey",onClick:function onClick(e){e.preventDefault();e.stopPropagation();alert("not implemented");}},"Register")));});};/* harmony default export */ var login_Login = (Login_Login);
// CONCATENATED MODULE: ./src/client/view/baseView/index.js
function baseView_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 21%;\n  min-width: 200px;\n  margin: 5px;\n"]);baseView_templateObject4=function _templateObject4(){return data;};return data;}function baseView_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 40%;\n  min-width: 800px;\n  margin: 5px;\n"]);baseView_templateObject3=function _templateObject3(){return data;};return data;}function baseView_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  justify-content: flex-end;\n  flex-wrap: wrap-reverse;\n  margin: 5px;\n"]);baseView_templateObject2=function _templateObject2(){return data;};return data;}function baseView_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  height: 58px;\n  width: 412px;\n  background-image: url(img/coldvoid.png);\n  position: absolute;\n  top: 45px;\n  left: 30px;\n  opacity: 0.8;\n  z-index: -1;\n"]);baseView_templateObject=function _templateObject(){return data;};return data;}var Logo=styled_components_browser_esm["b" /* default */].div(baseView_templateObject());var SuperContainer=styled_components_browser_esm["b" /* default */].div(baseView_templateObject2());var ContainerLeft=styled_components_browser_esm["b" /* default */].div(baseView_templateObject3());var ContainerRight=styled_components_browser_esm["b" /* default */].div(baseView_templateObject4());var baseView_BaseView=function BaseView(){return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(Logo,null),react_default.a.createElement(baseView_HomeSceneComponent,null),react_default.a.createElement(SuperContainer,null,react_default.a.createElement(ContainerLeft,null,react_default.a.createElement(react_router["b" /* Route */],{exact:true,path:"/",component:home}),react_default.a.createElement(Router_PrivateRoute,{exact:true,path:"/createGame",component:view_createGame})),react_default.a.createElement(ContainerRight,null,react_default.a.createElement(login_Login,null))));};
// CONCATENATED MODULE: ./src/client/view/game/components/lobby/Lobby.js
function Lobby_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 50%;\n  min-width: 200px;\n  margin: 5px;\n  z-index: 3;\n"]);Lobby_templateObject3=function _templateObject3(){return data;};return data;}function Lobby_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 50%;\n  min-width: 800px;\n  margin: 5px;\n  z-index: 3;\n"]);Lobby_templateObject2=function _templateObject2(){return data;};return data;}function Lobby_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  position: absolute;\n  top: 5px;\n  max-height: calc(100vh - 40px);\n  left: calc(50vw - 400px);\n  right: 5px;\n  bottom: 5px;\n  z-index: 3;\n"]);Lobby_templateObject=function _templateObject(){return data;};return data;}var LobbyContainer=styled_components_browser_esm["b" /* default */].div(Lobby_templateObject());var Lobby_ContainerLeft=styled_components_browser_esm["b" /* default */].div(Lobby_templateObject2());var Lobby_ContainerRight=styled_components_browser_esm["b" /* default */].div(Lobby_templateObject3());var Lobby_Lobby=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(Lobby,_Component);function Lobby(props){var _this;Object(classCallCheck["a" /* default */])(this,Lobby);_this=Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Lobby).call(this,props));_this.state={selectedSlot:null,ships:[]};return _this;}Object(createClass["a" /* default */])(Lobby,[{key:"selectSlot",value:function selectSlot(){}},{key:"buyShip",value:function buyShip(shipClass){var ship=new unit_ships[shipClass]();var _this$state=this.state,selectedSlot=_this$state.selectedSlot,ships=_this$state.ships;if(!selectedSlot){return;}var totalCost=[].concat(Object(toConsumableArray["a" /* default */])(ships),[ship]).reduce(function(acc,ship){return acc+ship.getPointCost();},0);if(totalCost>selectedSlot.points){alert("Too costly");return;}this.setState({ships:[].concat(Object(toConsumableArray["a" /* default */])(ships),[ship])});}},{key:"onReady",value:function onReady(){var uiState=this.props.uiState;var _this$state2=this.state,selectedSlot=_this$state2.selectedSlot,ships=_this$state2.ships;uiState.customEvent("buyShips",{slot:selectedSlot,ships:ships});}},{key:"render",value:function render(){var _this$props=this.props,uiState=_this$props.uiState,gameData=_this$props.gameData,currentUser=_this$props.currentUser,game=_this$props.game;var _this$state3=this.state,selectedSlot=_this$state3.selectedSlot,ships=_this$state3.ships;if(!gameData){return null;}gameData=new game_GameData(gameData);return react_default.a.createElement(LobbyContainer,null,react_default.a.createElement(Lobby_ContainerLeft,null,react_default.a.createElement(TooltipContainer,null,react_default.a.createElement(TooltipHeader,null,"GAME: ",gameData.name),react_default.a.createElement(lobby_LobbySlots,{gameData:gameData,edit:false,currentUser:currentUser,take:true,select:true,selectedSlot:selectedSlot,game:game,ships:ships,uiState:uiState,onReady:this.onReady.bind(this)}))),react_default.a.createElement(Lobby_ContainerRight,null,react_default.a.createElement(TooltipContainer,null,react_default.a.createElement(TooltipHeader,null,"Buy your fleet"),react_default.a.createElement(lobby_FleetStore,{uiState:uiState,buyShip:this.buyShip.bind(this)}))));}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,prevState){var gameData=nextProps.gameData,currentUser=nextProps.currentUser;if(!gameData){return prevState;}gameData=new game_GameData(gameData);if(!prevState.selectedSlot){var selectedSlot=gameData.slots.getSlots().find(function(slot){return slot.isOccupiedBy(currentUser);})||null;var ships=selectedSlot?selectedSlot.getShips():[];return Object(objectSpread2["a" /* default */])({},prevState,{selectedSlot:selectedSlot,ships:ships});}return prevState;}}]);return Lobby;}(react["Component"]);/*

      <LobbyContainer>
        <Section>
          <div>
            <Title>GAME: '{gameData.name}'</Title>
            <Title>Take a slot and buy ships</Title>
            <LobbySlots
              gameData={gameData}
              edit={false}
              currentUser={currentUser}
              take={true}
              select={true}
              selectedSlot={selectedSlot}
              game={game}
              ships={ships}
              uiState={uiState}
              onReady={this.onReady.bind(this)}
            />
          </div>
          <FleetStore uiState={uiState} buyShip={this.buyShip.bind(this)} />
        </Section>
      </LobbyContainer>

      *//* harmony default export */ var lobby_Lobby = (Lobby_Lobby);
// CONCATENATED MODULE: ./src/client/view/game/components/lobby/index.js
/* harmony default export */ var lobby = (lobby_Lobby);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipTooltip/index.js
/* harmony default export */ var shipTooltip = (shipTooltip_ShipTooltip);
// CONCATENATED MODULE: ./src/client/view/game/ui/TurnHeader.js
function TurnHeader_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n"]);TurnHeader_templateObject3=function _templateObject3(){return data;};return data;}function TurnHeader_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  align-items: center;\n"]);TurnHeader_templateObject2=function _templateObject2(){return data;};return data;}function TurnHeader_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  padding-right: 10px;\n  z-index: 3;\n"]);TurnHeader_templateObject=function _templateObject(){return data;};return data;}var TurnHeaderContainer=styled_components_browser_esm["b" /* default */].div(TurnHeader_templateObject());var ReadySection=Object(styled_components_browser_esm["b" /* default */])(SectionRight)(TurnHeader_templateObject2());var ReadyContainer=styled_components_browser_esm["b" /* default */].div(TurnHeader_templateObject3(),function(props){return props.ready?"cursor:pointer;":"cursor:not-allowed;";});var TurnHeader_TurnHeader=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(TurnHeader,_React$PureComponent);function TurnHeader(){Object(classCallCheck["a" /* default */])(this,TurnHeader);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(TurnHeader).apply(this,arguments));}Object(createClass["a" /* default */])(TurnHeader,[{key:"onReady",value:function onReady(){var _this$props=this.props,uiState=_this$props.uiState,ready=_this$props.ready;if(!ready){return;}uiState.commitTurn();}},{key:"render",value:function render(){var _this$props2=this.props,gameData=_this$props2.gameData,ready=_this$props2.ready,waiting=_this$props2.waiting;return react["createElement"](TurnHeaderContainer,null,react["createElement"](Section,null,react["createElement"](Title,null,"TURN: ".concat(gameData.turn)," ",gameData.phase===DEPLOYMENT&&"DEPLOYMENT",waiting&&" Waiting"),!waiting&&ready&&react["createElement"](ReadySection,null,react["createElement"](TooltipButton,{onClick:this.onReady.bind(this)},react["createElement"](icon_namespaceObject.CheckMark,null)))));}}]);return TurnHeader;}(react["PureComponent"]);/* harmony default export */ var ui_TurnHeader = (TurnHeader_TurnHeader);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/Movement.js
function Movement_templateObject6(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  font-size: 14px;\n  text-transform: none;\n"]);Movement_templateObject6=function _templateObject6(){return data;};return data;}function Movement_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  margin: 5px 0 0 0;\n\n  div {\n    padding: 0 5px;\n    white-space: nowrap;\n  }\n"]);Movement_templateObject5=function _templateObject5(){return data;};return data;}function Movement_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n  font-size: 36px;\n  font-weight: bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  width: 50px;\n  height: 60px;\n  left: -25px;\n  bottom: -30px;\n"]);Movement_templateObject4=function _templateObject4(){return data;};return data;}function Movement_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  ","\n  position: absolute;\n  width: 600px;\n  left: calc(50% - 300px);\n  bottom: 0;\n  padding: 2px 0;\n  /* background-color: rgba(0, 0, 0, 0.5); */\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  text-shadow: black 0px 0px 13px, black 0px 0px 13px, black 0px 0px 13px;\n  cursor: default;\n"]);Movement_templateObject3=function _templateObject3(){return data;};return data;}function Movement_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: white;\n  font-family: arial;\n  font-size: 16px;\n  text-transform: uppercase;\n"]);Movement_templateObject2=function _templateObject2(){return data;};return data;}function Movement_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  left: 50%;\n  bottom: 125px;\n  opacity: 0.85;\n  user-select: none;\n  z-index: 3;\n"]);Movement_templateObject=function _templateObject(){return data;};return data;}var Movement_Container=styled_components_browser_esm["b" /* default */].div(Movement_templateObject());var Movement_Text=Object(styled_components_browser_esm["a" /* css */])(Movement_templateObject2());var TextContainer=styled_components_browser_esm["b" /* default */].div(Movement_templateObject3(),Movement_Text);var Power=styled_components_browser_esm["b" /* default */].div(Movement_templateObject4(),Movement_Text);var TextRow=styled_components_browser_esm["b" /* default */].div(Movement_templateObject5());var TextRowSmall=Object(styled_components_browser_esm["b" /* default */])(TextRow)(Movement_templateObject6());var Movement_Movement=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(Movement,_React$Component);function Movement(){Object(classCallCheck["a" /* default */])(this,Movement);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(Movement).apply(this,arguments));}Object(createClass["a" /* default */])(Movement,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,children=_this$props.children,_this$props$ui=_this$props.ui,ui=_this$props$ui===void 0?true:_this$props$ui;return react["createElement"](react["Fragment"],null,react["createElement"](Movement_Container,{id:"shipMovementActual"},children));}}]);return Movement;}(react["Component"]);/* harmony default export */ var movement_Movement = (Movement_Movement);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/Container.js
function movement_Container_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n      animation: blinker 1s linear infinite;\n\n      @keyframes blinker {\n        50% {\n          opacity: 0;\n        }\n      }\n    "]);movement_Container_templateObject2=function _templateObject2(){return data;};return data;}function movement_Container_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0.5;\n\n  svg #svg-path {\n    fill: white;\n    ","\n    ","\n  }\n  ","\n\n  ","\n"]);movement_Container_templateObject=function _templateObject(){return data;};return data;}var Container_Container=styled_components_browser_esm["b" /* default */].div(movement_Container_templateObject(),function(props){return props.overChannel&&"fill:#4c7ca8;";},function(props){return props.disabled&&"fill: #8f2626;";},Clickable,function(props){return props.active&&Object(styled_components_browser_esm["a" /* css */])(movement_Container_templateObject2());});/* harmony default export */ var movement_Container = (Container_Container);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/ThrustButton.js
function ThrustButton_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n\n  ","\n\n  ","\n  ","\n"]);ThrustButton_templateObject=function _templateObject(){return data;};return data;}var ThrustButton_ButtonContainer=Object(styled_components_browser_esm["b" /* default */])(movement_Container)(ThrustButton_templateObject(),function(props){return"transform: rotate(".concat(props.direction+90,"deg);");},function(props){return"left: calc(".concat(props.x,"px - 16px);");},function(props){return"top: calc(".concat(props.y,"px - 16px);");});var ThrustButton_ThrustButton=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(ThrustButton,_React$Component);function ThrustButton(){Object(classCallCheck["a" /* default */])(this,ThrustButton);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ThrustButton).apply(this,arguments));}Object(createClass["a" /* default */])(ThrustButton,[{key:"getPosition",value:function getPosition(direction){return getPointInDirection(75,-hexFacingToAngle(direction),0,0);}},{key:"canThrust",value:function canThrust(){var _this$props=this.props,ship=_this$props.ship,movementService=_this$props.movementService,direction=_this$props.direction;return movementService.canThrust(ship,direction);}},{key:"thrust",value:function thrust(can){if(!can){return;}var _this$props2=this.props,ship=_this$props2.ship,movementService=_this$props2.movementService,direction=_this$props2.direction;return movementService.thrust(ship,direction);}},{key:"render",value:function render(){var direction=this.props.direction;var can=this.canThrust();var overChannel=can.overChannel;return react["createElement"](ThrustButton_ButtonContainer,Object.assign({overChannel:overChannel,disabled:!can,direction:hexFacingToAngle(direction),onClick:this.thrust.bind(this,can)},this.getPosition(direction)),react["createElement"](icon_Arrow,null));}}]);return ThrustButton;}(react["Component"]);/* harmony default export */ var movement_ThrustButton = (ThrustButton_ThrustButton);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/RevertButton.js
function RevertButton_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  width: 32px;\n  height: 32px;\n  left: 125px;\n  top: 53px;\n  ","\n"]);RevertButton_templateObject=function _templateObject(){return data;};return data;}var RevertButton_Container=styled_components_browser_esm["b" /* default */].div(RevertButton_templateObject(),Clickable);var RevertButton_RevertButton=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(RevertButton,_React$Component);function RevertButton(){Object(classCallCheck["a" /* default */])(this,RevertButton);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RevertButton).apply(this,arguments));}Object(createClass["a" /* default */])(RevertButton,[{key:"canRevert",value:function canRevert(){var _this$props=this.props,movementService=_this$props.movementService,ship=_this$props.ship;return movementService.canRevert(ship);}},{key:"revert",value:function revert(){var _this$props2=this.props,movementService=_this$props2.movementService,ship=_this$props2.ship;return movementService.revert(ship);}},{key:"render",value:function render(){if(!this.canRevert()){return null;}return react["createElement"](RevertButton_Container,{onClick:this.revert.bind(this)},react["createElement"](icon_Cancel,null));}}]);return RevertButton;}(react["Component"]);/* harmony default export */ var movement_RevertButton = (RevertButton_RevertButton);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/CancelButton.js
function CancelButton_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  left: -175px;\n  top: 53px;\n"]);CancelButton_templateObject=function _templateObject(){return data;};return data;}var CancelButton_ButtonContainer=Object(styled_components_browser_esm["b" /* default */])(movement_Container)(CancelButton_templateObject());var CancelButton_CancelButton=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(CancelButton,_React$Component);function CancelButton(){Object(classCallCheck["a" /* default */])(this,CancelButton);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CancelButton).apply(this,arguments));}Object(createClass["a" /* default */])(CancelButton,[{key:"canCancel",value:function canCancel(){var _this$props=this.props,movementService=_this$props.movementService,ship=_this$props.ship;return movementService.canCancel(ship);}},{key:"cancel",value:function cancel(){var _this$props2=this.props,movementService=_this$props2.movementService,ship=_this$props2.ship;return movementService.cancel(ship);}},{key:"render",value:function render(){if(!this.canCancel()){return null;}return react["createElement"](CancelButton_ButtonContainer,{onClick:this.cancel.bind(this)},react["createElement"](icon_X,null));}}]);return CancelButton;}(react["Component"]);/* harmony default export */ var movement_CancelButton = (CancelButton_CancelButton);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/PivotButton.js
function PivotButton_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  left: 25px;\n  top: -16px;\n\n  ",";\n"]);PivotButton_templateObject=function _templateObject(){return data;};return data;}var PivotButton_ButtonContainer=Object(styled_components_browser_esm["b" /* default */])(movement_Container)(PivotButton_templateObject(),function(props){return props.pivotDirection===1?"left: -57px;":"transform: rotate(-180deg) scaleY(-1);";});var PivotButton_PivotButton=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(PivotButton,_React$Component);function PivotButton(){Object(classCallCheck["a" /* default */])(this,PivotButton);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(PivotButton).apply(this,arguments));}Object(createClass["a" /* default */])(PivotButton,[{key:"canPivot",value:function canPivot(){var _this$props=this.props,ship=_this$props.ship,movementService=_this$props.movementService,pivotDirection=_this$props.pivotDirection;return movementService.canPivot(ship,pivotDirection);}},{key:"pivot",value:function pivot(){var _this$props2=this.props,ship=_this$props2.ship,movementService=_this$props2.movementService,pivotDirection=_this$props2.pivotDirection;if(!movementService.canPivot(ship,pivotDirection)){return;}return movementService.pivot(ship,pivotDirection);}},{key:"render",value:function render(){var pivotDirection=this.props.pivotDirection;var can=this.canPivot();return react["createElement"](PivotButton_ButtonContainer,{pivotDirection:pivotDirection,onClick:this.pivot.bind(this),disabled:!can},react["createElement"](icon_Pivot,null));}}]);return PivotButton;}(react["Component"]);/* harmony default export */ var movement_PivotButton = (PivotButton_PivotButton);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/RollButton.js
function RollButton_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  width: 32px;\n  height: 32px;\n  left: -16px;\n  top: -65px;\n  ","\n"]);RollButton_templateObject=function _templateObject(){return data;};return data;}var RollContainer=Object(styled_components_browser_esm["b" /* default */])(movement_Container)(RollButton_templateObject(),Clickable);var RollButton_RollButton=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(RollButton,_React$Component);function RollButton(){Object(classCallCheck["a" /* default */])(this,RollButton);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(RollButton).apply(this,arguments));}Object(createClass["a" /* default */])(RollButton,[{key:"canRoll",value:function canRoll(){var _this$props=this.props,movementService=_this$props.movementService,ship=_this$props.ship;return movementService.canRoll(ship);}},{key:"roll",value:function roll(){var _this$props2=this.props,movementService=_this$props2.movementService,ship=_this$props2.ship;if(!movementService.canRoll(ship)){return;}return movementService.roll(ship);}},{key:"render",value:function render(){var ship=this.props.ship;return react["createElement"](RollContainer,{active:ship.movement.isRolling(),onClick:this.roll.bind(this),disabled:!this.canRoll()},react["createElement"](icon_Roll,null));}}]);return RollButton;}(react["Component"]);/* harmony default export */ var movement_RollButton = (RollButton_RollButton);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/EvadeButton.js
function EvadeButton_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: white;\n  font-family: arial;\n  font-size: 24px;\n  text-transform: uppercase;\n  font-weight: bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  width: 50px;\n  height: 20px;\n  left: -25px;\n  top: 57px;\n"]);EvadeButton_templateObject3=function _templateObject3(){return data;};return data;}function EvadeButton_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  transform: rotate(180deg);\n  top: 79px;\n"]);EvadeButton_templateObject2=function _templateObject2(){return data;};return data;}function EvadeButton_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  width: 26px;\n  height: 26px;\n  left: -13px;\n  top: 28px;\n  ","\n"]);EvadeButton_templateObject=function _templateObject(){return data;};return data;}var EvadeContainer=Object(styled_components_browser_esm["b" /* default */])(movement_Container)(EvadeButton_templateObject(),Clickable);var RotatedContainer=Object(styled_components_browser_esm["b" /* default */])(EvadeContainer)(EvadeButton_templateObject2());var Evasion=styled_components_browser_esm["b" /* default */].div(EvadeButton_templateObject3());var EvadeButton_EvadeButton=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(EvadeButton,_React$Component);function EvadeButton(){Object(classCallCheck["a" /* default */])(this,EvadeButton);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(EvadeButton).apply(this,arguments));}Object(createClass["a" /* default */])(EvadeButton,[{key:"canEvade",value:function canEvade(step){var _this$props=this.props,movementService=_this$props.movementService,ship=_this$props.ship;return movementService.canEvade(ship,step);}},{key:"evade",value:function evade(step){var _this$props2=this.props,movementService=_this$props2.movementService,ship=_this$props2.ship;if(!movementService.canEvade(ship,step)){return;}return movementService.evade(ship,step);}},{key:"render",value:function render(){var ship=this.props.ship;var canMore=this.canEvade(1);var canLess=this.canEvade(-1);return react["createElement"](react["Fragment"],null,react["createElement"](EvadeContainer,{key:"evade-more",onClick:this.evade.bind(this,1),disabled:!canMore},react["createElement"](icon_Evade,null)),react["createElement"](Evasion,null,ship.movement.getEvasion()),react["createElement"](RotatedContainer,{key:"evade-less",onClick:this.evade.bind(this,-1),disabled:!canLess},react["createElement"](icon_Evade,null)));}}]);return EvadeButton;}(react["Component"]);/* harmony default export */ var movement_EvadeButton = (EvadeButton_EvadeButton);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/GameMovement.js
var GameMovement_GameMovement=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(GameMovement,_React$PureComponent);function GameMovement(){Object(classCallCheck["a" /* default */])(this,GameMovement);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameMovement).apply(this,arguments));}Object(createClass["a" /* default */])(GameMovement,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,movementService=_this$props.movementService,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["ship","movementService"]);return react["createElement"](movement_Movement,Object.assign({ship:ship,movementService:movementService},rest),react["createElement"](movement_ThrustButton,{ship:ship,movementService:movementService,direction:0}),react["createElement"](movement_ThrustButton,{ship:ship,movementService:movementService,direction:1}),react["createElement"](movement_ThrustButton,{ship:ship,movementService:movementService,direction:2}),react["createElement"](movement_ThrustButton,{ship:ship,movementService:movementService,direction:3}),react["createElement"](movement_ThrustButton,{ship:ship,movementService:movementService,direction:4}),react["createElement"](movement_ThrustButton,{ship:ship,movementService:movementService,direction:5}),react["createElement"](movement_RevertButton,{ship:ship,movementService:movementService}),react["createElement"](movement_CancelButton,{ship:ship,movementService:movementService}),react["createElement"](movement_PivotButton,{ship:ship,movementService:movementService,pivotDirection:-1}),react["createElement"](movement_PivotButton,{ship:ship,movementService:movementService,pivotDirection:1}),react["createElement"](movement_RollButton,{ship:ship,movementService:movementService}),react["createElement"](movement_EvadeButton,{ship:ship,movementService:movementService}));}}]);return GameMovement;}(react["PureComponent"]);/* harmony default export */ var movement_GameMovement = (GameMovement_GameMovement);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/DeploymentPivotButton.js
function DeploymentPivotButton_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  left: 125px;\n  top: 103px;\n\n  ","\n"]);DeploymentPivotButton_templateObject=function _templateObject(){return data;};return data;}var DeploymentPivotButton_ButtonContainer=Object(styled_components_browser_esm["b" /* default */])(movement_Container)(DeploymentPivotButton_templateObject(),function(props){return props.pivotDirection===1?"left: -175px; transform: rotate(-90deg);":"transform: rotate(-90deg) scaleY(-1);";});var DeploymentPivotButton_DeploymentPivotButton=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(DeploymentPivotButton,_React$Component);function DeploymentPivotButton(){Object(classCallCheck["a" /* default */])(this,DeploymentPivotButton);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(DeploymentPivotButton).apply(this,arguments));}Object(createClass["a" /* default */])(DeploymentPivotButton,[{key:"pivot",value:function pivot(){var _this$props=this.props,ship=_this$props.ship,movementService=_this$props.movementService,pivotDirection=_this$props.pivotDirection;return movementService.doDeploymentTurn(ship,pivotDirection);}},{key:"render",value:function render(){var pivotDirection=this.props.pivotDirection;return react["createElement"](DeploymentPivotButton_ButtonContainer,{pivotDirection:pivotDirection,onClick:this.pivot.bind(this)},react["createElement"](icon_Pivot,null));}}]);return DeploymentPivotButton;}(react["Component"]);/* harmony default export */ var movement_DeploymentPivotButton = (DeploymentPivotButton_DeploymentPivotButton);
// CONCATENATED MODULE: ./src/client/view/game/ui/movement/DeploymentMovement.js
var DeploymentMovement_DeploymentMovementButtons=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(DeploymentMovementButtons,_React$PureComponent);function DeploymentMovementButtons(){Object(classCallCheck["a" /* default */])(this,DeploymentMovementButtons);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(DeploymentMovementButtons).apply(this,arguments));}Object(createClass["a" /* default */])(DeploymentMovementButtons,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,movementService=_this$props.movementService,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["ship","movementService"]);return react["createElement"](movement_Movement,Object.assign({ship:ship,movementService:movementService,ui:false},rest),react["createElement"](movement_DeploymentPivotButton,{ship:ship,movementService:movementService,pivotDirection:-1}),react["createElement"](movement_DeploymentPivotButton,{ship:ship,movementService:movementService,pivotDirection:1}));}}]);return DeploymentMovementButtons;}(react["PureComponent"]);/* harmony default export */ var DeploymentMovement = (DeploymentMovement_DeploymentMovementButtons);
// CONCATENATED MODULE: ./src/client/view/game/ui/GameUiModeButtons.js
function GameUiModeButtons_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin-left: 32px;\n"]);GameUiModeButtons_templateObject2=function _templateObject2(){return data;};return data;}function GameUiModeButtons_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  top: 0;\n  left: 500px;\n  display: flex;\n  z-index: 3;\n"]);GameUiModeButtons_templateObject=function _templateObject(){return data;};return data;}var GameUiModeButtons_Container=styled_components_browser_esm["b" /* default */].div(GameUiModeButtons_templateObject());var ReplayButton=Object(styled_components_browser_esm["b" /* default */])(TooltipButton)(GameUiModeButtons_templateObject2());var GameUiModeButtons_GameUiModeButtons=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(GameUiModeButtons,_React$PureComponent);function GameUiModeButtons(){Object(classCallCheck["a" /* default */])(this,GameUiModeButtons);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(GameUiModeButtons).apply(this,arguments));}Object(createClass["a" /* default */])(GameUiModeButtons,[{key:"render",value:function render(){var _this$props=this.props,ew=_this$props.ew,movement=_this$props.movement,weapons=_this$props.weapons,enemy_weapons=_this$props.enemy_weapons,uiState=_this$props.uiState;return react["createElement"](GameUiModeButtons_Container,null,react["createElement"](TooltipButton,{selected:enemy_weapons,img:"/img/targetShip.png",onClick:function onClick(){return uiState.toggleGameUiMode(ENEMY_WEAPONS);}}),react["createElement"](TooltipButton,{selected:weapons,img:"/img/firing.png",onClick:function onClick(){return uiState.toggleGameUiMode(WEAPONS);}}),react["createElement"](TooltipButton,{selected:ew,img:"/img/addOEW.png",onClick:function onClick(){return uiState.toggleGameUiMode(EW);}}),react["createElement"](TooltipButton,{selected:movement,img:"/img/selectShip.png",onClick:function onClick(){return uiState.toggleGameUiMode(MOVEMENT);}}),react["createElement"](ReplayButton,{onClick:function onClick(){return uiState.startReplay();}},react["createElement"](icon_Replay,null)));}}]);return GameUiModeButtons;}(react["PureComponent"]);/* harmony default export */ var ui_GameUiModeButtons = (GameUiModeButtons_GameUiModeButtons);
// CONCATENATED MODULE: ./src/client/view/game/ui/system/SystemList.js
var SystemList_SystemList=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(SystemList,_React$Component);function SystemList(props){Object(classCallCheck["a" /* default */])(this,SystemList);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(SystemList).call(this,props));}Object(createClass["a" /* default */])(SystemList,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,uiState=_this$props.uiState,systems=_this$props.systems,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["ship","uiState","systems"]);if(!ship){return null;}return systems.map(function(system){return react["createElement"](system_SystemIcon,Object.assign({scs:true,uiState:uiState,key:"system-list-".concat(system.id),system:system,ship:ship},rest));});}}]);return SystemList;}(react["Component"]);/* harmony default export */ var system_SystemList = (SystemList_SystemList);
// CONCATENATED MODULE: ./src/client/view/game/ui/electronicWarfare/EwList.js
var EwList_EwList=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(EwList,_React$Component);function EwList(props){Object(classCallCheck["a" /* default */])(this,EwList);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(EwList).call(this,props));}Object(createClass["a" /* default */])(EwList,[{key:"render",value:function render(){var _this$props=this.props,ship=_this$props.ship,uiState=_this$props.uiState,ewList=_this$props.ewList,selectedShip=_this$props.selectedShip;var gameData=uiState.gameData;if(!ship){return null;}return ewList.map(function(entry,index){var target=gameData.ships.getShipById(entry.targetShipId);return react["createElement"](electronicWarfare_OEWButtons,{highlight:true,name:target.name,uiState:uiState,key:"ew-list-".concat(index),ship:selectedShip,target:target,oew:selectedShip.electronicWarfare.getOffensiveEw(entry.targetShipId)});});}}]);return EwList;}(react["Component"]);/* harmony default export */ var electronicWarfare_EwList = (EwList_EwList);
// CONCATENATED MODULE: ./src/client/view/game/ui/leftPanel/LeftPanel.js
function LeftPanel_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap-reverse;\n"]);LeftPanel_templateObject2=function _templateObject2(){return data;};return data;}function LeftPanel_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  width: calc(50% - 100px);\n  display: flex;\n  flex-direction: column;\n  z-index: 3;\n"]);LeftPanel_templateObject=function _templateObject(){return data;};return data;}var LeftPanel_Container=styled_components_browser_esm["b" /* default */].div(LeftPanel_templateObject());var LeftPanel_SubContainer=styled_components_browser_esm["b" /* default */].div(LeftPanel_templateObject2());var LeftPanel_LeftPanel=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(LeftPanel,_React$PureComponent);function LeftPanel(){Object(classCallCheck["a" /* default */])(this,LeftPanel);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(LeftPanel).apply(this,arguments));}Object(createClass["a" /* default */])(LeftPanel,[{key:"render",value:function render(){var _this$props=this.props,uiState=_this$props.uiState,systemList=_this$props.systemList,ewList=_this$props.ewList,rest=Object(objectWithoutProperties["a" /* default */])(_this$props,["uiState","systemList","ewList"]);if(!uiState.state.selectedShip){return null;}return react["createElement"](LeftPanel_Container,null,react["createElement"](LeftPanel_SubContainer,null,ewList&&react["createElement"](electronicWarfare_EwList,Object.assign({ship:uiState.state.selectedShip,uiState:uiState,ewList:ewList},rest))),react["createElement"](shipTooltip_GameShipTooltipMenu,Object.assign({ship:uiState.state.selectedShip,uiState:uiState},rest)));}}]);return LeftPanel;}(react["PureComponent"]);/* harmony default export */ var leftPanel_LeftPanel = (LeftPanel_LeftPanel);
// CONCATENATED MODULE: ./src/client/view/game/ui/replay/ReplayUI.js
function ReplayUI_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  transform: rotate(180deg);\n"]);ReplayUI_templateObject2=function _templateObject2(){return data;};return data;}function ReplayUI_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  top: 0;\n  left: 500px;\n  display: flex;\n  z-index: 3;\n"]);ReplayUI_templateObject=function _templateObject(){return data;};return data;}var ReplayUI_Container=styled_components_browser_esm["b" /* default */].div(ReplayUI_templateObject());var ReplayUI_RotatedButton=Object(styled_components_browser_esm["b" /* default */])(TooltipButton)(ReplayUI_templateObject2());var ReplayUI_ReplayUi=/*#__PURE__*/function(_React$PureComponent){Object(inherits["a" /* default */])(ReplayUi,_React$PureComponent);function ReplayUi(){Object(classCallCheck["a" /* default */])(this,ReplayUi);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(ReplayUi).apply(this,arguments));}Object(createClass["a" /* default */])(ReplayUi,[{key:"render",value:function render(){var _this$props=this.props,uiState=_this$props.uiState,replayContext=_this$props.replayContext;return react["createElement"](ReplayUI_Container,null,react["createElement"](Button_Button,{onClick:function onClick(){return replayContext.rewindToFiring();}},"Firing"),react["createElement"](ReplayUI_RotatedButton,{onClick:function onClick(){return replayContext.resumeReplayRewind();}},react["createElement"](icon_Play,null)),react["createElement"](TooltipButton,{onClick:function onClick(){return replayContext.pauseReplay();}},react["createElement"](icon_Pause,null)),react["createElement"](TooltipButton,{onClick:function onClick(){return replayContext.resumeReplay();}},react["createElement"](icon_Play,null)),react["createElement"](TooltipButton,{onClick:function onClick(){return uiState.closeReplay();}},react["createElement"](icon_X,null)));}}]);return ReplayUi;}(react["PureComponent"]);/* harmony default export */ var ReplayUI = (ReplayUI_ReplayUi);
// CONCATENATED MODULE: ./src/client/view/game/ui/combatLog/styled.js
function styled_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: #db4949;\n  font-weight: bold;\n"]);styled_templateObject2=function _templateObject2(){return data;};return data;}function styled_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: #6daaff;\n"]);styled_templateObject=function _templateObject(){return data;};return data;}var Highlight=styled_components_browser_esm["b" /* default */].span(styled_templateObject());var DangerHighlight=styled_components_browser_esm["b" /* default */].span(styled_templateObject2());
// CONCATENATED MODULE: ./src/client/view/game/ui/combatLog/HitChance.js
function HitChance_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin-left: 5px;\n"]);HitChance_templateObject=function _templateObject(){return data;};return data;}var HitChanceContainer=styled_components_browser_esm["b" /* default */].div(HitChance_templateObject());var HitChance_HitChance=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(HitChance,_React$Component);function HitChance(){Object(classCallCheck["a" /* default */])(this,HitChance);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(HitChance).apply(this,arguments));}Object(createClass["a" /* default */])(HitChance,[{key:"render",value:function render(){var _this$props=this.props,resolution=_this$props.resolution,totalShots=_this$props.totalShots,shotsHit=_this$props.shotsHit;return react_default.a.createElement(HitChanceContainer,null,"Change to hit: ",react_default.a.createElement(Highlight,null,resolution.hitChance.result),". Hit roll: ",react_default.a.createElement(Highlight,null,resolution.hitRoll),".",resolution.result?react_default.a.createElement(Highlight,null,react_default.a.createElement("b",null," ".concat(shotsHit,"/").concat(totalShots," Hit!"))):react_default.a.createElement(DangerHighlight,null,react_default.a.createElement("b",null," Miss!")));}}]);return HitChance;}(react_default.a.Component);/* harmony default export */ var combatLog_HitChance = (HitChance_HitChance);
// CONCATENATED MODULE: ./src/client/view/game/ui/combatLog/DamageLine.js
function DamageLine_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])([""]);DamageLine_templateObject=function _templateObject(){return data;};return data;}var DamageContainer=styled_components_browser_esm["b" /* default */].div(DamageLine_templateObject());var DamageLine_DamageLine=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(DamageLine,_React$Component);function DamageLine(){Object(classCallCheck["a" /* default */])(this,DamageLine);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(DamageLine).apply(this,arguments));}Object(createClass["a" /* default */])(DamageLine,[{key:"render",value:function render(){var _this$props=this.props,target=_this$props.target,gameData=_this$props.gameData,combatLogEntry=_this$props.combatLogEntry;var damages=combatLogEntry.getDamages(target);var systemsDestroyed=combatLogEntry.getDestroyedSystems(target);var totalDamage=damages.reduce(function(total,current){return total+current.amount;},0);var totalArmor=damages.reduce(function(total,current){return total+current.armor;},0);return react_default.a.createElement(DamageContainer,null,"Damage caused: ",react_default.a.createElement(DangerHighlight,null,totalDamage),". Mitigated by armor ",react_default.a.createElement(Highlight,null,totalArmor),".",systemsDestroyed.length>0&&react_default.a.createElement(react_default.a.Fragment,null," ","Systems destroyed:"," ",react_default.a.createElement(DangerHighlight,null,systemsDestroyed.map(function(system){return system.getDisplayName();}).join(", "))));}}]);return DamageLine;}(react_default.a.Component);/* harmony default export */ var combatLog_DamageLine = (DamageLine_DamageLine);
// CONCATENATED MODULE: ./src/client/view/game/ui/combatLog/CombatLogLine.js
function CombatLogLine_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  margin-left: 50px;\n  margin-top: 4px;\n"]);CombatLogLine_templateObject3=function _templateObject3(){return data;};return data;}function CombatLogLine_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n"]);CombatLogLine_templateObject2=function _templateObject2(){return data;};return data;}function CombatLogLine_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  color: #d6d6d6;\n  font-family: arial;\n  font-size: 12px;\n  padding: 8px 8px 8px 8px;\n  display: flex;\n  flex-direction: column;\n  border-bottom: 1px dashed gray;\n"]);CombatLogLine_templateObject=function _templateObject(){return data;};return data;}var LineContainer=styled_components_browser_esm["b" /* default */].div(CombatLogLine_templateObject());var SubLine=styled_components_browser_esm["b" /* default */].div(CombatLogLine_templateObject2());var IndentedSubline=Object(styled_components_browser_esm["b" /* default */])(SubLine)(CombatLogLine_templateObject3());var CombatLogLine_CombatLogLine=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(CombatLogLine,_React$Component);function CombatLogLine(){Object(classCallCheck["a" /* default */])(this,CombatLogLine);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CombatLogLine).apply(this,arguments));}Object(createClass["a" /* default */])(CombatLogLine,[{key:"getTorpedoAttackLine",value:function getTorpedoAttackLine(){var _this$props=this.props,combatLogEntry=_this$props.combatLogEntry,gameData=_this$props.gameData,replayContext=_this$props.replayContext;var target=gameData.ships.getShipById(combatLogEntry.targetId);var flight=gameData.torpedos.getTorpedoFlightById(combatLogEntry.torpedoFlightId);var targetName=target.name.trim();return react_default.a.createElement(LineContainer,null,react_default.a.createElement(SubLine,null,react_default.a.createElement(DangerHighlight,null,"TORPEDO STRIKE:\xA0"),react_default.a.createElement(Highlight,null,"\xA0",flight.torpedo.getDisplayName(),"\xA0"),"strikes ",targetName),combatLogEntry.notes.length>0&&react_default.a.createElement(IndentedSubline,null,combatLogEntry.notes.join(". ")),combatLogEntry.damages.length>0&&react_default.a.createElement(IndentedSubline,null,react_default.a.createElement(combatLog_DamageLine,{target:target,gameData:gameData,combatLogEntry:combatLogEntry})));}},{key:"getWeaponFireLine",value:function getWeaponFireLine(){var _this$props2=this.props,combatLogEntry=_this$props2.combatLogEntry,gameData=_this$props2.gameData,replayContext=_this$props2.replayContext;var weaponFireService=new weapon_WeaponFireService().update(gameData);var fireOrder=weaponFireService.getFireOrderById(combatLogEntry.fireOrderId);var target=gameData.ships.getShipById(fireOrder.targetId);var shooter=gameData.ships.getShipById(fireOrder.shooterId);var weapon=shooter.systems.getSystemById(fireOrder.weaponId);var hit=combatLogEntry.hitResult.result;var shooterName=shooter.name.trim();var targetName=target.name.trim();var weaponName=weapon.getDisplayName();return react_default.a.createElement(LineContainer,null,react_default.a.createElement(SubLine,null,react_default.a.createElement(DangerHighlight,null,"FIRE:\xA0"),shooterName," fires"," ",react_default.a.createElement(Highlight,null,"\xA0",weaponName,"\xA0",combatLogEntry.ammoName&&"(".concat(combatLogEntry.ammoName,")"),"\xA0")," ","at ",targetName,".",react_default.a.createElement(combatLog_HitChance,{resolution:combatLogEntry.hitResult,totalShots:combatLogEntry.totalShots,shotsHit:combatLogEntry.shotsHit})),combatLogEntry.notes.length>0&&react_default.a.createElement(IndentedSubline,null,combatLogEntry.notes.join(" ")),hit&&react_default.a.createElement(IndentedSubline,null,react_default.a.createElement(combatLog_DamageLine,{target:target,gameData:gameData,combatLogEntry:combatLogEntry})));}},{key:"render",value:function render(){var combatLogEntry=this.props.combatLogEntry;if(combatLogEntry instanceof combatLog_CombatLogWeaponFire){return this.getWeaponFireLine();}else if(combatLogEntry instanceof combatLog_CombatLogTorpedoAttack){return this.getTorpedoAttackLine();}else{return null;}}}]);return CombatLogLine;}(react_default.a.Component);/* harmony default export */ var combatLog_CombatLogLine = (CombatLogLine_CombatLogLine);
// CONCATENATED MODULE: ./src/client/view/game/ui/combatLog/CombatLog.js
function CombatLog_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  height: 150px;\n  width: 33%;\n  background: rgba(0, 0, 0, 0.5);\n  overflow-y: scroll;\n  padding-top: 8px;\n  z-index: 3;\n  scrollbar-width: 0;\n\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"]);CombatLog_templateObject=function _templateObject(){return data;};return data;}var CombatLog_LogContainer=styled_components_browser_esm["b" /* default */].div(CombatLog_templateObject());var CombatLog_CombatLog=/*#__PURE__*/function(_React$Component){Object(inherits["a" /* default */])(CombatLog,_React$Component);function CombatLog(){Object(classCallCheck["a" /* default */])(this,CombatLog);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(CombatLog).apply(this,arguments));}Object(createClass["a" /* default */])(CombatLog,[{key:"render",value:function render(){var _this$props=this.props,replayContext=_this$props.replayContext,gameData=_this$props.gameData,log=_this$props.log;return react_default.a.createElement(CombatLog_LogContainer,null,log.map(function(logEntry,i){return react_default.a.createElement(combatLog_CombatLogLine,{gameData:gameData,replayContext:replayContext,key:"combatlog-line-".concat(i),combatLogEntry:logEntry});}));}}]);return CombatLog;}(react_default.a.Component);/* harmony default export */ var combatLog_CombatLog = (CombatLog_CombatLog);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipBadge/ShipBadge.js
function ShipBadge_templateObject9(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  animation: blinker 1s linear infinite;\n\n  @keyframes blinker {\n    50% {\n      opacity: 0;\n    }\n  }\n"]);ShipBadge_templateObject9=function _templateObject9(){return data;};return data;}function ShipBadge_templateObject8(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  hieght: 100%;\n\n  "," {\n    margin-left: 5px;\n\n    &:first-child {\n      margin-left: 0px;\n    }\n  }\n"]);ShipBadge_templateObject8=function _templateObject8(){return data;};return data;}function ShipBadge_templateObject7(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  "," {\n    margin: 0;\n  }\n"]);ShipBadge_templateObject7=function _templateObject7(){return data;};return data;}function ShipBadge_templateObject6(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  height: 100%;\n  align-items: center;\n"]);ShipBadge_templateObject6=function _templateObject6(){return data;};return data;}function ShipBadge_templateObject5(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  width: 15px;\n  height: 15px;\n  background-size: cover;\n  background-color: transparent;\n  background-image: ",";\n  margin: 0 3px 0 0;\n"]);ShipBadge_templateObject5=function _templateObject5(){return data;};return data;}function ShipBadge_templateObject4(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  display: flex;\n  flex-direction: row;\n  background-color: rgba(0, 0, 0, 0.5);\n  align-items: center;\n  padding: 3px 5px;\n"]);ShipBadge_templateObject4=function _templateObject4(){return data;};return data;}function ShipBadge_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  /* background-color: rgba(0, 0, 0, 0.5);\n  padding: 3px 5px; */\n  margin-right: 5px;\n"]);ShipBadge_templateObject3=function _templateObject3(){return data;};return data;}function ShipBadge_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  margin: 0 1px;\n"]);ShipBadge_templateObject2=function _templateObject2(){return data;};return data;}function ShipBadge_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  text-align: left;\n  position: relative;\n  z-index: 0;\n  display: flex;\n  flex-direction: row;\n  color: white;\n  font-family: arial;\n  margin-left: -50%;\n  font-size: 12px;\n"]);ShipBadge_templateObject=function _templateObject(){return data;};return data;}var ShipBadgeContainer=styled_components_browser_esm["b" /* default */].div(ShipBadge_templateObject());var DewBadge=Object(styled_components_browser_esm["b" /* default */])(styled_IconAndLabel)(ShipBadge_templateObject2());var ShipBadge_ShipName=styled_components_browser_esm["b" /* default */].div(ShipBadge_templateObject3());var BackgroundContainer=styled_components_browser_esm["b" /* default */].div(ShipBadge_templateObject4());var Icon=styled_components_browser_esm["b" /* default */].div(ShipBadge_templateObject5(),function(props){return"url(".concat(props.background,")");});var BadgeIconAndLabel=styled_components_browser_esm["b" /* default */].div(ShipBadge_templateObject6());var BadgeIcon=Object(styled_components_browser_esm["b" /* default */])(BadgeIconAndLabel)(ShipBadge_templateObject7(),Icon);var Badges=styled_components_browser_esm["b" /* default */].div(ShipBadge_templateObject8(),BadgeIconAndLabel);var WarningBadge=Object(styled_components_browser_esm["b" /* default */])(BadgeIcon)(ShipBadge_templateObject9());var ShipBadge_getNumberOfMissilesImpacting=function getNumberOfMissilesImpacting(ship,gameData){var gameDataObject=new game_GameData(gameData);return gameDataObject.torpedos.getTorpedoFlights().filter(function(flight){return flight.targetId===ship.id;}).length;};var ShipBadge_ShipBadge=function ShipBadge(_ref){var icon=_ref.icon,uiState=_ref.uiState,showName=_ref.showName,visible=_ref.visible;var currentUser=uiState.services.currentUser;var isMine=icon.ship.player.is(currentUser);var getPosition=function getPosition(){return utils_CoordinateConverter.fromGameToViewPort(icon.getPosition());};var missiles=ShipBadge_getNumberOfMissilesImpacting(icon.ship,uiState.state.gameData);var validPower=icon.ship.systems.power.isValidPower();if(!isMine||missiles===0&&validPower){visible=false;}var memoizedComponent=Object(react["useMemo"])(function(){return visible&&react_default.a.createElement(ShipBadgeContainer,null,react_default.a.createElement(BackgroundContainer,null, false&&false,react_default.a.createElement(Badges,null,isMine&&missiles>0&&react_default.a.createElement(WarningBadge,null,react_default.a.createElement(Icon,{background:"/img/system/missile1.png"}),missiles),isMine&&!icon.ship.systems.power.isValidPower()&&react_default.a.createElement(WarningBadge,null,react_default.a.createElement(Icon,{background:"/img/offline.png"})))));},[visible,isMine,missiles,validPower]);return react_default.a.createElement(ui_GamePositionComponent,{getPosition:getPosition,uiState:uiState,marginTop:0,marginLeft:0},memoizedComponent);};/* harmony default export */ var shipBadge_ShipBadge = (ShipBadge_ShipBadge);
// CONCATENATED MODULE: ./src/client/view/game/GameStoreProvider.js
var GameStateStore=react_default.a.createContext({});var GameDispatchStore=react_default.a.createContext({});var GameStoreProvider_GameStoreProvider=function GameStoreProvider(_ref){var uiState=_ref.uiState,children=_ref.children;var _useReducer=Object(react["useReducer"])(uiState.getReducer(),uiState.getInitialState()),_useReducer2=Object(slicedToArray["a" /* default */])(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];uiState.setDispatch(dispatch);return react_default.a.createElement(GameDispatchStore.Provider,{value:dispatch},react_default.a.createElement(GameStateStore.Provider,{value:state},children));};/* harmony default export */ var game_GameStoreProvider = (GameStoreProvider_GameStoreProvider);
// CONCATENATED MODULE: ./src/client/view/game/ui/shipList/ShipFleetBadge.js
function ShipFleetBadge_templateObject3(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  padding-left: 8px;\n"]);ShipFleetBadge_templateObject3=function _templateObject3(){return data;};return data;}function ShipFleetBadge_templateObject2(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  border-bottom: none;\n"]);ShipFleetBadge_templateObject2=function _templateObject2(){return data;};return data;}function ShipFleetBadge_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  width: 200px;\n  box-sizing: border-box;\n  text-align: left;\n  margin-top: 5px;\n  cursor: pointer;\n\n  :hover {\n    border: 1px solid\n      ",";\n  }\n\n  &:first-child {\n    margin-top: 0;\n  }\n\n  ","\n"]);ShipFleetBadge_templateObject=function _templateObject(){return data;};return data;}var ShipFleetBadge_Container=Object(styled_components_browser_esm["b" /* default */])(TooltipContainer)(ShipFleetBadge_templateObject(),function(props){return props.isMine?Colors_namespaceObject.lightBlue:Colors_namespaceObject.textDanger;},function(props){return props.isSelected&&"background-color: ".concat(Colors_namespaceObject.mediumBlue,"; border: 1px solid ").concat(Colors_namespaceObject.lightBlue,";");});var ShipFleetBadge_Header=Object(styled_components_browser_esm["b" /* default */])(TooltipHeader)(ShipFleetBadge_templateObject2());var Fleet=Object(styled_components_browser_esm["b" /* default */])(TooltipValueHeader)(ShipFleetBadge_templateObject3());function ShipFleetBadge(_ref){var ship=_ref.ship,uiState=_ref.uiState;var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;var isMine=ship.player.isUsers(currentUser);var selectedShip=uiState.getSelectedShip();var isSelected=selectedShip&&selectedShip.id===ship.id;var scrollToShip=Object(react["useCallback"])(function(){var _uiState$services=uiState.services,gameCamera=_uiState$services.gameCamera,shipIconContainer=_uiState$services.shipIconContainer;var icon=shipIconContainer.getByShip(ship);gameCamera.setByLookAtPosition(icon.getPosition());uiState.customEvent("shipClicked",{entity:icon});},[]);var mouseOver=Object(react["useCallback"])(function(){var shipIconContainer=uiState.services.shipIconContainer;var icon=shipIconContainer.getByShip(ship);uiState.customEvent("mouseOverShip",{entity:icon});},[]);var mouseOut=Object(react["useCallback"])(function(){var shipIconContainer=uiState.services.shipIconContainer;var icon=shipIconContainer.getByShip(ship);uiState.customEvent("mouseOutShip",{entity:icon});},[]);var Component=Object(react["useMemo"])(function(){return react_default.a.createElement(ShipFleetBadge_Container,{isMine:isMine,onClick:scrollToShip,onMouseOver:mouseOver,onMouseOut:mouseOut,isSelected:isSelected},react_default.a.createElement(ShipFleetBadge_Header,null,react_default.a.createElement(ShipName_ShipName,{ship:ship})),react_default.a.createElement(Fleet,null,"Second fleet"));},[isSelected]);return Component;}
// CONCATENATED MODULE: ./src/client/view/game/ui/shipList/ShipList.js
function ShipList_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  top: 50px;\n  ","\n\n  z-index: 3;\n"]);ShipList_templateObject=function _templateObject(){return data;};return data;}var ShipList_Container=styled_components_browser_esm["b" /* default */].div(ShipList_templateObject(),function(props){return props.right?"right: 10px;":"left: 10px;";});function ShipListActual(_ref){var uiState=_ref.uiState,_ref$primary=_ref.primary,primary=_ref$primary===void 0?[]:_ref$primary,_ref$secondary=_ref.secondary,secondary=_ref$secondary===void 0?[]:_ref$secondary,_ref$right=_ref.right,right=_ref$right===void 0?false:_ref$right;return react_default.a.createElement(ShipList_Container,{right:right},primary.map(function(ship){return react_default.a.createElement(ShipFleetBadge,{key:"ship-fleet-list-".concat(ship.id),ship:ship,uiState:uiState});}));}function ShipList(_ref2){var gameData=_ref2.gameData,uiState=_ref2.uiState;var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;if(!gameData){return null;}gameData=new game_GameData(gameData);var myShips=gameData.ships.getUsersShips(currentUser).filter(function(ship){return!ship.isDestroyed();});var alliedShips=gameData.ships.getShipsInSameTeam(currentUser).filter(function(ship){return!ship.isDestroyed();}).filter(function(ship){return!myShips.includes(ship);});var enemyShips=gameData.ships.getShipsEnemyTeams(currentUser).filter(function(ship){return!ship.isDestroyed();});return react_default.a.createElement(react_default.a.Fragment,null,myShips.length>0&&react_default.a.createElement(ShipListActual,{uiState:uiState,primary:Object(toConsumableArray["a" /* default */])(myShips),secondary:alliedShips}),myShips.length>0&&react_default.a.createElement(ShipListActual,{uiState:uiState,primary:Object(toConsumableArray["a" /* default */])(enemyShips),right:true}));}
// CONCATENATED MODULE: ./src/client/view/game/components/GameUiComponent.js
var GameUiComponent_GameUiComponent=function GameUiComponent(_ref){var game=_ref.game;var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;var state=Object(react["useContext"])(GameStateStore);var uiState=game.getUiState();return react_default.a.createElement(react_default.a.Fragment,null,state.lobby&&react_default.a.createElement(lobby,{uiState:uiState,gameData:state.gameData,game:game,currentUser:currentUser}),state.shipTooltip.map(function(tooltip){return react_default.a.createElement(shipTooltip,Object.assign({key:"tooltip-ship-".concat(tooltip.ship.id),uiState:uiState},state,tooltip));}),state.gameData&&(state.gameData.phase===GAME||state.gameData.phase===DEPLOYMENT)&&react_default.a.createElement(ui_TurnHeader,{uiState:uiState,gameData:uiState.state.gameData,ready:uiState.state.turnReady,waiting:uiState.state.waiting}),state.shipMovement&&state.shipMovement.type==="deploy"&&react_default.a.createElement(DeploymentMovement,Object.assign({},state.shipMovement,{uiState:uiState})),state.shipMovement&&state.shipMovement.type==="game"&&uiState.hasGameUiMode(MOVEMENT)&&react_default.a.createElement(movement_GameMovement,Object.assign({},state.shipMovement,{uiState:uiState})),state.gameUiModeButtons&&react_default.a.createElement(ui_GameUiModeButtons,Object.assign({uiState:uiState},state.gameUiMode)),state.replayUi&&react_default.a.createElement(ReplayUI,{uiState:uiState,replayContext:state.replayUi}),!state.replayUi&&react_default.a.createElement(leftPanel_LeftPanel,Object.assign({uiState:uiState},state)),uiState.state.combatLog&&react_default.a.createElement(combatLog_CombatLog,{uiState:uiState,replayContext:state.combatLog.replayContext,gameData:state.combatLog.gameData,log:state.combatLog.log}),state.shipBadges.map(function(_ref2){var version=_ref2.version,icon=_ref2.icon,visible=_ref2.visible,showName=_ref2.showName;return react_default.a.createElement(shipBadge_ShipBadge,{key:"ship-badge-".concat(icon.ship.id),icon:icon,version:version,visible:visible,uiState:uiState,showName:showName});}),react_default.a.createElement(ShipList,{uiState:uiState,gameData:uiState.state.gameData}));};/* harmony default export */ var components_GameUiComponent = (GameUiComponent_GameUiComponent);
// CONCATENATED MODULE: ./src/client/view/login/LoginFloater.js
function LoginFloater_templateObject(){var data=Object(taggedTemplateLiteral["a" /* default */])(["\n  position: absolute;\n  width: 20%;\n  min-width: 200px;\n  right: 10px;\n  top: 10px;\n  z-index: 3;\n"]);LoginFloater_templateObject=function _templateObject(){return data;};return data;}var LoginFloaterContainer=Object(styled_components_browser_esm["b" /* default */])(login_Login)(LoginFloater_templateObject());var LoginFloater_LoginFloater=function LoginFloater(){var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;if(currentUser){return null;}return react_default.a.createElement(LoginFloaterContainer,null);};/* harmony default export */ var login_LoginFloater = (LoginFloater_LoginFloater);
// CONCATENATED MODULE: ./src/client/view/game/components/GameComponent.js
var GameComponent_GameComponent=function GameComponent(_ref){var match=_ref.match;var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;var _useState=Object(react["useState"])(null),_useState2=Object(slicedToArray["a" /* default */])(_useState,2),uiState=_useState2[0],setUiState=_useState2[1];var _useState3=Object(react["useState"])(null),_useState4=Object(slicedToArray["a" /* default */])(_useState3,2),game=_useState4[0],setGame=_useState4[1];Object(react["useEffect"])(function(){var newUiState=new ui_UIState();var newGame=new game_Game(match.params.gameid,currentUser,newUiState);setUiState(newUiState);setGame(newGame);},[currentUser,setUiState,setGame]);if(!uiState||!game||currentUser===undefined){return null;}return react_default.a.createElement(game_GameStoreProvider,{uiState:uiState},react_default.a.createElement(components_GameSceneComponent,{game:game,currentUser:currentUser}),react_default.a.createElement(components_GameUiComponent,{game:game}),react_default.a.createElement(login_LoginFloater,null));};/* harmony default export */ var components_GameComponent = (GameComponent_GameComponent);
// CONCATENATED MODULE: ./src/client/view/game/index.js
/* harmony default export */ var view_game = (components_GameComponent);
// CONCATENATED MODULE: ./src/client/view/logout/Logout.js
var Logout_Logout=function Logout(_ref){var location=_ref.location;var dispatch=Object(react["useContext"])(DispatchStore);var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;Object(react["useEffect"])(function(){Object(asyncToGenerator["a" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return logout();case 2:_context.next=4;return actions_getCurrentUser(dispatch);case 4:case"end":return _context.stop();}}},_callee);}))();},[dispatch]);if(!currentUser){return react_default.a.createElement(react_router["a" /* Redirect */],{to:{pathname:"/",state:{from:location}}});}return null;};/* harmony default export */ var logout_Logout = (Logout_Logout);
// CONCATENATED MODULE: ./src/client/view/logout/index.js
/* harmony default export */ var view_logout = (logout_Logout);
// CONCATENATED MODULE: ./src/client/Router.js
var Router_PrivateRoute=function PrivateRoute(_ref){var Component=_ref.component,rest=Object(objectWithoutProperties["a" /* default */])(_ref,["component"]);var _useContext=Object(react["useContext"])(StateStore),currentUser=_useContext.currentUser;var authed=Boolean(currentUser);return react_default.a.createElement(react_router["b" /* Route */],Object.assign({},rest,{render:function render(props){return authed===true?react_default.a.createElement(Component,props):react_default.a.createElement(react_router["a" /* Redirect */],{to:{pathname:"/",state:{from:props.location}}});}}));};var Router_Routes=function Routes(){var _useContext2=Object(react["useContext"])(StateStore),currentUser=_useContext2.currentUser;if(currentUser===undefined){return null;}return react_default.a.createElement(react_router_dom["a" /* BrowserRouter */],null,react_default.a.createElement(Router_PrivateRoute,{exact:true,path:"/game/:gameid",component:view_game}),react_default.a.createElement(react_router["b" /* Route */],{exact:true,path:"/logout",component:view_logout}),react_default.a.createElement(react_router["b" /* Route */],{path:"*",component:baseView_BaseView}));};/* harmony default export */ var Router = (Router_Routes);
// CONCATENATED MODULE: ./src/client/App.js
var App_App=/*#__PURE__*/function(_Component){Object(inherits["a" /* default */])(App,_Component);function App(){Object(classCallCheck["a" /* default */])(this,App);return Object(possibleConstructorReturn["a" /* default */])(this,Object(getPrototypeOf["a" /* default */])(App).apply(this,arguments));}Object(createClass["a" /* default */])(App,[{key:"render",value:function render(){return react_default.a.createElement(state_StoreProvider,null,react_default.a.createElement(Router,null));}}]);return App;}(react["Component"]);/* harmony default export */ var client_App = (App_App);
// CONCATENATED MODULE: ./src/client/serviceWorker.js
// This optional code is used to register a service worker.
// register() is not called by default.
// This lets the app load faster on subsequent visits in production, and gives
// it offline capabilities. However, it also means that developers (and users)
// will only see deployed updates on subsequent visits to a page, after all the
// existing tabs open on the page have been closed, since previously cached
// resources are updated in the background.
// To learn more about the benefits of this model and instructions on how to
// opt-in, read https://bit.ly/CRA-PWA
var isLocalhost=Boolean(window.location.hostname==='localhost'||// [::1] is the IPv6 localhost address.
window.location.hostname==='[::1]'||// 127.0.0.1/8 is considered localhost for IPv4.
window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function serviceWorker_register(config){if( true&&'serviceWorker'in navigator){// The URL constructor is available in all browsers that support SW.
var publicUrl=new URL("",window.location.href);if(publicUrl.origin!==window.location.origin){// Our service worker won't work if PUBLIC_URL is on a different origin
// from what our page is served on. This might happen if a CDN is used to
// serve assets; see https://github.com/facebook/create-react-app/issues/2374
return;}window.addEventListener('load',function(){var swUrl="".concat("","/service-worker.js");if(isLocalhost){// This is running on localhost. Let's check if a service worker still exists or not.
checkValidServiceWorker(swUrl,config);// Add some additional logging to localhost, pointing developers to the
// service worker/PWA documentation.
navigator.serviceWorker.ready.then(function(){console.log('This web app is being served cache-first by a service '+'worker. To learn more, visit https://bit.ly/CRA-PWA');});}else{// Is not localhost. Just register service worker
registerValidSW(swUrl,config);}});}}function registerValidSW(swUrl,config){navigator.serviceWorker.register(swUrl).then(function(registration){registration.onupdatefound=function(){var installingWorker=registration.installing;if(installingWorker==null){return;}installingWorker.onstatechange=function(){if(installingWorker.state==='installed'){if(navigator.serviceWorker.controller){// At this point, the updated precached content has been fetched,
// but the previous service worker will still serve the older
// content until all client tabs are closed.
console.log('New content is available and will be used when all '+'tabs for this page are closed. See https://bit.ly/CRA-PWA.');// Execute callback
if(config&&config.onUpdate){config.onUpdate(registration);}}else{// At this point, everything has been precached.
// It's the perfect time to display a
// "Content is cached for offline use." message.
console.log('Content is cached for offline use.');// Execute callback
if(config&&config.onSuccess){config.onSuccess(registration);}}}};};}).catch(function(error){console.error('Error during service worker registration:',error);});}function checkValidServiceWorker(swUrl,config){// Check if the service worker can be found. If it can't reload the page.
fetch(swUrl).then(function(response){// Ensure service worker exists, and that we really are getting a JS file.
var contentType=response.headers.get('content-type');if(response.status===404||contentType!=null&&contentType.indexOf('javascript')===-1){// No service worker found. Probably a different app. Reload the page.
navigator.serviceWorker.ready.then(function(registration){registration.unregister().then(function(){window.location.reload();});});}else{// Service worker found. Proceed as normal.
registerValidSW(swUrl,config);}}).catch(function(){console.log('No internet connection found. App is running in offline mode.');});}function unregister(){if('serviceWorker'in navigator){navigator.serviceWorker.ready.then(function(registration){registration.unregister();});}}
// CONCATENATED MODULE: ./src/index.js
react_dom_default.a.render(react_default.a.createElement(client_App,null),document.getElementById("root"));// If you want your app to work offline and load faster, you can change
// unregister() to register() below. Note this comes with some pitfalls.
// Learn more about service workers: https://bit.ly/CRA-PWA
unregister();

/***/ })

},[[156,1,2]]]);
//# sourceMappingURL=main.f67988ea.chunk.js.map